;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  ComponentRegistry,
  webAliases,
  nodeAliases
) {
  var c = new ComponentRegistry();


  c.registerMany([
    {
      module: require("./util/component-loader"),
      as: "component-loader"
    },

    {
      module: require("./util/periodic"),
      as: "periodic"
    },

    {
      module: require("./util/retryable"),
      as: "retryable"
    },

    {
      module: require("./util/timer"),
      as: "timer"
    },

    {
      module: require("./core/dispatcher"),
      as: "dispatcher"
    },

    {
      module: require("./core/countdown-latch"),
      as: "countdown-latch"
    },

    {
      module: require("./core/options"),
      as: "options"
    },

    {
      module: require("./core/lang"),
      as: "lang"
    },

    {
      module: require("./core/ref"),
      as: "ref"
    },

    {
      module: require("./core/state-guard"),
      as: "state-guard"
    },


    {
      module: require("./core/pub-sub"),
      as: "pub-sub"
    },

    {
      module: require("./core/sequencer/unit-sequencer"),
      as: ["unit-sequencer", "sequencer"]
    },


    {
      module: require("./core/sequencer/clock-sequencer"),
      as: "clock-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-composite-sequencer"),
      as: "delegating-composite-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-forwarding-sequencer"),
      as: "delegating-forwarding-sequencer"
    },

    {
      module: require("./collection/doubly-linked-list"),
      as: "doubly-linked-list"
    },

    {
      module: require("./collection/object-hash-map"),
      as: ["hash-map", "object-hash-map"]
    },

    {
      module: require("./collection/defaulting-hash-map"),
      as: "defaulting-hash-map"
    },

    {
      module: require("./collection/multi-map"),
      as: "multi-map"
    },

    {
      module: require("./collection/lru-hash-map"),
      as: "lru-hash-map"
    },

    {
      module: require("./storage/caching-data-store"),
      as: "caching-data-store"
    },

    {
      module: require("./storage/in-memory-data-store"),
      as: "in-memory-data-store"
    },

    {
      module: require("./storage/lru-data-store"),
      as: "lru-data-store"
    },

    {
      module: require("./storage/signaling-data-store"),
      as: "signaling-data-store"
    },

    {
      module: require("./time/clock/logical-clock"),
      as: "logical-clock"
    },

    {
      module: require("./time/clock/system-clock"),
      as: "system-clock"
    },

    {
      module: require("./appkit/configuration-magic"),
      as: "configuration-magic"
    },

    {
      module: require("./appkit/config/scoped-configuration-resolver"),
      as: "scoped-configuration-resolver"
    },

    {
      module: require("./appkit/config/scoped-configuration"),
      as: ["scoped-configuration", "config/scoped-configuration"]
    },

    {
      module: require("./appkit/app"),
      as: "app"
    },

    {
      module: require("./runtime"),
      as: "runtime"
    },

    {
      module: require("./core/logging/logger"),
      as: "logger"
    },

    {
      module: require("./core/logging/appenders/console-log-appender"),
      as: ["appenders/console-log", "console-log-appender"]
    },

    {
      module: require("./core/channel/channel"),
      as: "channel"
    },

    {
      module: require("./core/channel/chained-channel"),
      as: "chained-channel"
    },

    {
      module: require("./core/channel/composite-channel"),
      as: "composite-channel"
    },

    {
      module: require("./messaging/exchange"),
      as: "messaging/exchange"
    },

    {
      module: require("./messaging/courier"),
      as: "messaging/courier"
    },

    {
      module: require("./messaging/fiber/in-memory-fiber"),
      as: "messaging/fibers/in-memory"
    },

    {
      module: require("./messaging/fiber/linkable-fiber"),
      as: "messaging/fibers/linkable"
    },

    {
      module: require("./core/uuid"),
      as: "uuid"
    },

    {
      module: require("./core/serde/json-serde"),
      as: ["serde/json", "json-serde"]
    },

    {
      module: require("./platform/client-builder/client-builder"),
      as: "experimental/platform/client-builder"
    },

    {
      module: require("./platform/client-builder/client-spec"),
      as: "experimental/platform/client-spec"
    }
  ]);

  c.selfRegister({
    as: "component-registry"
  });

  webAliases(c);
  nodeAliases(c);

  return c;
};

var g = (typeof window === "undefined" ? {} : window);
g.thicket = module.exports = mod(
  require("./util/component-registry"),
  require("./web"),
  require("./node")
);

})()
},{"./util/component-loader":2,"./util/periodic":3,"./util/timer":4,"./util/retryable":5,"./core/dispatcher":6,"./core/options":7,"./core/countdown-latch":8,"./core/lang":9,"./core/state-guard":10,"./core/pub-sub":11,"./core/sequencer/unit-sequencer":12,"./core/sequencer/clock-sequencer":13,"./core/sequencer/delegating-composite-sequencer":14,"./core/sequencer/delegating-forwarding-sequencer":15,"./collection/doubly-linked-list":16,"./collection/object-hash-map":17,"./collection/defaulting-hash-map":18,"./collection/multi-map":19,"./collection/lru-hash-map":20,"./storage/caching-data-store":21,"./storage/in-memory-data-store":22,"./storage/lru-data-store":23,"./storage/signaling-data-store":24,"./time/clock/logical-clock":25,"./time/clock/system-clock":26,"./appkit/configuration-magic":27,"./appkit/config/scoped-configuration-resolver":28,"./appkit/config/scoped-configuration":29,"./appkit/app":30,"./core/logging/logger":31,"./core/logging/appenders/console-log-appender":32,"./core/channel/channel":33,"./core/channel/chained-channel":34,"./core/channel/composite-channel":35,"./messaging/exchange":36,"./messaging/courier":37,"./messaging/fiber/in-memory-fiber":38,"./messaging/fiber/linkable-fiber":39,"./core/uuid":40,"./core/serde/json-serde":41,"./platform/client-builder/client-builder":42,"./platform/client-builder/client-spec":43,"./util/component-registry":44,"./web":45,"./node":46,"./core/ref":47,"./runtime":48}],46:[function(require,module,exports){
module.exports = function(c) {};

},{}],45:[function(require,module,exports){
module.exports = function(c) {
  c.registerMany([
    {
      module: require("./appkit/bootstrapper"),
      as: "bootstrapper"
    },
    {
      module: require("./appkit/web-app-container"),
      as: "app-container"
    },
    {
      module: require("./scheduler/web-scheduler"),
      as: "scheduler"
    }
  ]);

  require("./browserify2-list");
};

},{"./appkit/bootstrapper":49,"./appkit/web-app-container":50,"./scheduler/web-scheduler":51,"./browserify2-list":52}],48:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

module.exports = require("./default-runtime");

})()
},{"./default-runtime":53}],52:[function(require,module,exports){
(function(){require("./runtime/default-runtime.js");
require("./runtime/index.js");
require("./node.js");
require("./core/serde/json-serde.js");
require("./core/uuid.js");
require("./core/logging/logger.js");
require("./core/logging/appenders/console-log-appender.js");
require("./core/options.js");
require("./core/pub-sub.js");
require("./core/dispatcher.js");
require("./core/ref/delegating-ref.js");
require("./core/ref/ref.js");
require("./core/ref/index.js");
require("./core/sequencer/delegating-forwarding-sequencer.js");
require("./core/sequencer/clock-sequencer.js");
require("./core/sequencer/unit-sequencer.js");
require("./core/sequencer/delegating-composite-sequencer.js");
require("./core/state-guard.js");
require("./core/scheduler/set-timeout-scheduler.js");
require("./core/countdown-latch.js");
require("./core/lang.js");
require("./core/channel/chained-channel.js");
require("./core/channel/channel.js");
require("./core/channel/composite-channel.js");
require("./web.js");
require("./storage/signaling-data-store.js");
require("./storage/lru-data-store.js");
require("./storage/in-memory-data-store.js");
require("./storage/internals/expiring-entry.js");
require("./storage/caching-data-store.js");
require("./platform/client-builder/base-client.js");
require("./platform/client-builder/client-builder.js");
require("./platform/client-builder/client-spec.js");
require("./platform/client-builder/method-spec.js");
require("./util/component-loader.js");
require("./util/component-registry.js");
require("./util/timer.js");
require("./util/retryable.js");
require("./util/periodic.js");
require("./messaging/internals/mailbox.js");
require("./messaging/courier.js");
require("./messaging/fiber/linkable-fiber.js");
require("./messaging/fiber/in-memory-fiber.js");
require("./messaging/exchange.js");
require("./appkit/app.js");
require("./appkit/internal/process-keep-alive.js");
require("./appkit/config/scoped-configuration-resolver.js");
require("./appkit/config/scoped-configuration.js");
require("./appkit/web-app-container.js");
require("./appkit/configuration-magic.js");
require("./appkit/bootstrapper.js");
require("./scheduler/web-scheduler.js");
require("./scheduler/index.js");
require("./index.js");
require("./time/clock/logical-clock.js");
require("./time/clock/system-clock.js");
require("./collection/lru-hash-map.js");
require("./collection/defaulting-hash-map.js");
require("./collection/object-hash-map.js");
require("./collection/multi-map.js");
require("./collection/doubly-linked-list.js");

})()
},{"./runtime/default-runtime.js":53,"./runtime/index.js":48,"./node.js":46,"./core/serde/json-serde.js":41,"./core/uuid.js":40,"./core/logging/logger.js":31,"./core/logging/appenders/console-log-appender.js":32,"./core/options.js":7,"./core/pub-sub.js":11,"./core/dispatcher.js":6,"./core/ref/delegating-ref.js":54,"./core/ref/ref.js":55,"./core/ref/index.js":47,"./core/sequencer/delegating-forwarding-sequencer.js":15,"./core/sequencer/clock-sequencer.js":13,"./core/sequencer/unit-sequencer.js":12,"./core/sequencer/delegating-composite-sequencer.js":14,"./core/state-guard.js":10,"./core/scheduler/set-timeout-scheduler.js":56,"./core/lang.js":9,"./core/countdown-latch.js":8,"./core/channel/chained-channel.js":34,"./core/channel/channel.js":33,"./core/channel/composite-channel.js":35,"./web.js":45,"./storage/signaling-data-store.js":24,"./storage/lru-data-store.js":23,"./storage/in-memory-data-store.js":22,"./storage/internals/expiring-entry.js":57,"./storage/caching-data-store.js":21,"./platform/client-builder/base-client.js":58,"./platform/client-builder/client-builder.js":42,"./platform/client-builder/client-spec.js":43,"./platform/client-builder/method-spec.js":59,"./util/component-loader.js":2,"./util/component-registry.js":44,"./util/retryable.js":5,"./util/periodic.js":3,"./messaging/internals/mailbox.js":60,"./util/timer.js":4,"./messaging/courier.js":37,"./messaging/fiber/linkable-fiber.js":39,"./messaging/fiber/in-memory-fiber.js":38,"./messaging/exchange.js":36,"./appkit/app.js":30,"./appkit/internal/process-keep-alive.js":61,"./appkit/config/scoped-configuration-resolver.js":28,"./appkit/web-app-container.js":50,"./appkit/configuration-magic.js":27,"./appkit/bootstrapper.js":49,"./appkit/config/scoped-configuration.js":29,"./scheduler/web-scheduler.js":51,"./scheduler/index.js":62,"./index.js":1,"./time/clock/logical-clock.js":25,"./time/clock/system-clock.js":26,"./collection/lru-hash-map.js":20,"./collection/defaulting-hash-map.js":18,"./collection/object-hash-map.js":17,"./collection/multi-map.js":19,"./collection/doubly-linked-list.js":16}],59:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  Lang
) {

  var MethodSpec = Lang.pojoClass(["args", "defaults", "mType", "requestReply"], {
    defaults: {
      args:         [],
      defaults:     {},
      requestReply: true
    }
  });

  return MethodSpec;
};

module.exports = mod(
  require("../../core/lang")
);

})()
},{"../../core/lang":9}],2:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Options
) {

  /**
   * Like a `ComponentRegistry`, but modules are loaded on-demand rather than eagerly required and aliased. This is
   * done by providing the top-level `require` method as an initialization parameter, which maintains the appropriate
   * path context for resolving relative imports later.
   *
   * Note this only works in Node, not environments like Browserify, which need to eagerly resolve all required
   * modules via static analysis. For that, use the `ComponentRegistry`.
   */
  var ComponentLoader = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentLoader.prototype, {
    initialize: function(requireFun) {
      this._requireFun = requireFun;
      this._aliases = {};
      this._pathTransform = function(id) { return id;};
    },

    setPathTransform: function(pathTransform) {
      this._pathTransform = pathTransform;
      return this;
    },

    alias: function(opts) {
      opts = Options.fromObject(opts);
      var aliasName  = opts.getOrError("as");
      this._aliases[aliasName] = opts.getOrError("module");
    },

    bulkAlias: function(aliases) {
      _.each(aliases, function(aliasNames, moduleName) {
        if (!_.isArray(aliasNames)) {
          aliasNames = [aliasNames]
        }
        _.each(aliasNames, function(aliasName) {
          this.alias({module: moduleName, as: aliasName});
        }, this);
      }, this);
    },

    component: function(alias) {
      var mod = this._aliases[alias];
      if (!mod) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return this._requireFun(this._pathTransform(mod));
    },

    c: function(alias) {
      return this.component.apply(this, arguments);
    }
  });

  return ComponentLoader;
};

module.exports = factory(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":7,"underscore":63}],3:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  StateGuard,
  Channel,
  ChainedChannel,
  Logger
) {

  /**
   * Upon `start()`, runs the provided Promisified `task` every `interval` milliseconds until `stop()` is called. The results
   * of each `task` are sent along the `egressChannel()`, as `msg.result` or `msg.err`.
   *
   * @constructor
   */
  var Periodic = function() {
    this.initialize.apply(this, arguments);
  };

  var Log = Logger.create("Periodic");

  _.extend(Periodic.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._schedulerRef = opts.getOrError("scheduler");
      this._task         = opts.getOrElse("task");
      this._interval     = opts.getOrError("interval");

      this._stateGuard   = new StateGuard(["disposed", "started"]);
      this._channel      = new Channel({ sentinel: this });
      this._taskId       = null;

      _.bindAll(this, "_runTask");
    },


    start: function(){
      this._stateGuard
        .deny("disposed", "started")
        .apply("started");

      this._scheduleNext(true);
    },


    stop: function() {
      this._cancelPending();
      this._cancelOutstanding();
      this._stateGuard.unapply("started");
    },

    egressChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._channel
      });
    },

    _runTask: function() {
      var results = {
        mT: "results",
        result: null,
        err: null
      };

      this._taskId = null;
      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          results.result = result;
        })
        .caught(Promise.CancellationError, function() {
          // Let it be. Don't want it to trickle into the results.
        })
        .caught(function(err) {
          results.err = err;
        })
        .lastly(function() {
          this._currentRun = null;
          this._notifyResults(results);
          this._scheduleNext();
        });
    },


    _notifyResults: function(results) {
      this._schedulerRef.get().runSoon(_.bind(function() {

        if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
          return;
        }

        if (Log.isTraceEnabled()) {
          Log.trace("Notifying results", results);
        }

        this._channel.publish(this, results);
      }, this));
    },


    _scheduleNext: function(now) {
      if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
        return;
      }
      this._taskId = this._schedulerRef.get().schedule(this._runTask, now ? 0 : this._interval);
      Log.trace("Scheduled task", this._taskId);
    },


    _cancelPending: function() {
      Log.trace("cancelPending requested, looking for pending task.");
      if (this._taskId) {
        Log.trace("Found pending task; cancelling", this._taskId);
        this._schedulerRef.get().unschedule(this._taskId);
        this._taskId = null;
      }
    },

    _cancelOutstanding: function() {
      Log.trace("cancelOutstanding requested, looking for outstanding work.");
      if (this._currentRun) {
        Log.trace("Outstanding work found; cancelling");
        this._currentRun.cancel();
        this._currentRun = null;
      }
    },

    dispose: function(){
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._cancelPending();
      this._cancelOutstanding();

      this._stateGuard.apply("disposed");
    }
  });

  return Periodic;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/logging/logger")
);

})()
},{"../core/options":7,"../core/state-guard":10,"../core/channel/channel":33,"../core/channel/chained-channel":34,"../core/logging/logger":31,"underscore":63,"bluebird":64}],4:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A simple timer.
   *
   * Start it, stop it, get the delta.
   *
   * Or, start it, and repeatedly call `lap` for the time between the last `lap` call and now.
   *
   */
  var Timer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Timer.prototype, {
    initialize: function() {
      this._startTime = null;
      this._endTime = null;
      this._lastLap = null;
    },


    start: function() {
      this._startTime = this._lastLap = +new Date();
      return this;
    },


    stop: function() {
      this._endTime = +new Date();
      return this;
    },

    lap: function() {
      if (!this._lastLap) return 0;

      var oldLastLap = this._lastLap;
      this._lastLap = +new Date();
      return (this._lastLap - oldLastLap);
    },


    delta: function() {
      return (this._endTime - this._startTime);
    }
  });

  return Timer;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],5:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Lang,
  StateGuard,
  Logger
) {

  var Log = Logger.create("Retryable");

  var DEFAULT_BACKOFF_CEILING = 60 * 1000 * 10; // 10 minutes


  /**
   * A device which retries the provided Promisified `task` until it completes without error, or `retries` times
   * (default is forever). The results of the `task` are accessible via the `result()` promise, which will be fulfilled
   * or rejected on success or error (such as Retryable.Error.MaxRetriesError or Promise.CancellationError).
   *
   * If an error occurs, the `task` is retried after some time, as determined by the `backoff` `strategy`, of which two
   * are supported: `Retryable.Backoff.Linear` and `Retryable.Backoff.Exponential`. The default strategy is
   * `Retryable.Backoff.Linear`, with the period determined by:
   *
   * `coefficient * attemptNum * factor`
   *
   * Default options for Linear backoff are: `factor` = 1, `coefficient` = 250.
   *
   * For `Retryable.Backoff.Exponential, the period is determined by:
   *
   * `coefficient * Math.pow(base, attemptNum)`
   *
   * Default options for Exponential backoff are: `coefficient = 250`, `base = 2`.
   *
   * Regardless of backoff strategy, a `backoffCeiling` can be provided. If provided, this is the upper bound of
   * the period between unsuccessful task runs. This allows, for example, an exponential backoff up to a ceiling (e.g.,
   * five minutes), after which point the period will simply be the ceiling (e.g., five minutes).
   *
   */
  var Retryable = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Retryable.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler  = opts.getOrError("scheduler");
      this._task       = opts.getOrError("task");
      // If not provided, go on forever.
      this._retries    = opts.getOrElse("retries");
      this._currentTry = 0;
      this._deferred   = Lang.deferred();

      var backoff = Options.fromObject(opts.getOrElseFn("backoff", function() {
        return {
          strategy: Retryable.Backoff.Linear,
          factor: 1,
          coefficient: 250
        };
      }));

      var StrategyClass = BackoffStrategy[backoff.getOrError("strategy")];

      this._backoffStrategy = new StrategyClass(backoff.toObject());
      this._backoffCeiling  = opts.getOrElse("backoffCeiling", DEFAULT_BACKOFF_CEILING);
      this._disposedGuard   = StateGuard.scoped("disposed");

      _.bindAll(this, "_attempt");
      this._currentRun = null;
      this._scheduler.get().runSoon(this._attempt);
    },

    dispose: function() {
      if (this._disposedGuard.applied()) {
        return;
      }

      if (this._currentRun) {
        this._currentRun.cancel(new Retryable.Error.DisposedError());
        this._currentRun = null;
      }

      this._task = null;

      this._disposedGuard.apply();
    },

    result: function() {
      return this._deferred.promise;
    },

    _attempt: function() {
      if (this._disposedGuard.applied()) {
        return;
      }

      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          if (this._deferred.promise.isPending()) {
            this._deferred.resolve(result);
          }
        })
        .caught(Retryable.Error.DisposedError, function() {
          this._deferred.promise.cancel(new Promise.CancellationError());
        })
        .caught(function(err) {
          if (this._disposedGuard.applied()) {
            Log.warn("Caught retryable run error, but retryable is already disposed");
            return;
          }

          Log.debug("Received error in attempt", this._currentTry);
          var nextTry = this._currentTry + 1;

          if (this._retries >= 0 && nextTry > this._retries) {
            Log.debug("Hit max number of retries:", this._retries);
            var e = new Retryable.Error.MaxRetriesError();
            e.cause = err;
            throw e;
          }

          // Schedule us up to try again;
          this._currentRun = null;
          this._currentTry = nextTry;

          var time = this._backoffStrategy.time(this._currentTry);
          this._scheduler.get().schedule(this._attempt, Math.min(time, this._backoffCeiling));
        })
        .caught(Retryable.Error.MaxRetriesError, function(err) {
          if (this._deferred.promise.isPending()) {
            this._deferred.reject(err.cause);
          }
        });
    }
  });

  _.extend(Retryable, {
    Backoff: {
      Linear:      "linear",
      Exponential: "exponential"
    },
    Error: {
      DisposedError: Lang.makeErrorClass("DisposedError", "Retryable was disposed"),
      MaxRetriesError: Lang.makeErrorClass("MaxRetriesError", "Retryable was retried too many times")
    }
  })

  var BackoffStrategy = (function() {
    var Linear = function() {
      this.initialize.apply(this, arguments);
    };

    _.extend(Linear.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);
        this._factor        = opts.getOrElse("factor", 1);
        this._coefficient   = opts.getOrElse("coefficient", 250);
      },

      time: function(iteration) {
        return this._factor * this._coefficient * iteration;
      }
    });

    var Exponential = function() {
      this.initialize.apply(this, arguments);
    };

    _.extend(Exponential.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._base        = opts.getOrElse("base", 2);
        this._coefficient = opts.getOrElse("coefficient", 250);
      },

      time: function(iteration) {
        return this._coefficient * (Math.pow(this._base, iteration));
      }
    })


    var backoffs = {};

    backoffs[Retryable.Backoff.Linear]      = Linear;
    backoffs[Retryable.Backoff.Exponential] = Exponential;

    return backoffs;
  }());

  return Retryable;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/lang"),
  require("../core/state-guard"),
  require("../core/logging/logger")
);

})()
},{"../core/options":7,"../core/state-guard":10,"../core/lang":9,"../core/logging/logger":31,"underscore":63,"bluebird":64}],6:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  StateGuard
) {

  /**
   * Attempts to intelligently dispatch an object with an mT attribute, using
   * the rules provided at instantiation.
   *
   * For a given mTyped object, searches the provided `delegate` for a method
   * named [prefix][camel-cased mT], and if present, calls it. If not found,
   * looks for [prefix]Else. If the mT attribute isn't found, dispatches to
   * [prefix]Malformed.
   */
  var Dispatcher = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_CONTEXT_DELEGATE = function() {
    return {};
  };

  _.extend(Dispatcher.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegate        = opts.getOrError("delegate"),
      this._prefix          = opts.getOrElse("prefix", "onMsg");
      this._elseSuffix      = opts.getOrElse("elseSuffix", "else");
      this._malformedSuffix = opts.getOrElse("malformedSuffix", "malformed");
      this._contextDelegate = opts.getOrElse("contextDelegate", DEFAULT_CONTEXT_DELEGATE);
      this._stateGuard      = new StateGuard(["disposed"]);
      this._subs            = M.hash_map();

      var channels = opts.getOrElse("listen", []);

      if (!_.isArray(channels)) {
        channels = [channels];
      }

      _.each(channels, _.bind(function(c) {
        this.listen(c)
      }, this));
    },

    listen: function(channel) {
      this._stateGuard.deny("disposed");

      var sub = channel.subscribe(_.bind(function(msg) {
        this.dispatch(msg);
      }, this));

      this._subs = M.assoc(this._subs, sub.id(), sub);

      return {
        dispose: _.bind(function(){
          var nSub = M.get(this._subs, sub.id());
          if (nSub) {
            this._subs = M.dissoc(this._subs, sub.id());
            nSub.dispose();
          }
        }, this)
      }
    },

    dispatch: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);

      if (handler) {
        this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    /**
     * Like `dispatch`, but expects delegate to return a Promise<object>
     */
    dispatchAsync: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);
      if (handler) {
        return this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var subs = this._subs;
      this._subs = M.hash_map();

      M.each(subs, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _getHandlerName: function(prefix, suffix) {
      return prefix + suffix.charAt(0).toUpperCase() + suffix.substr(1);
    },

    // FIXME: Check for "reserved" mTypes (_elseSuffix, _malformedSuffix, etc), log warning
    _getVettedHandlerName: function(mTyped) {
      var mT = mTyped.mT,
          prefix = this._prefix,
          potentialHandlerName,
          finalHandlerName;

      if (!mT) {
        finalHandlerName = this._getHandlerName(prefix, this._malformedSuffix);
      } else {
        potentialHandlerName = this._getHandlerName(prefix, mT);
        if (_.isFunction(this._delegate[potentialHandlerName])) {
          finalHandlerName = potentialHandlerName;
        } else {
          finalHandlerName = this._getHandlerName(prefix, this._elseSuffix);
        }
      }

      if (_.isFunction(this._delegate[finalHandlerName])) {
        return finalHandlerName;
      }
    }
  });

  return Dispatcher;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("./options"),
  require("./state-guard")
);

})()
},{"./options":7,"./state-guard":10,"underscore":63,"mori":65}],7:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _
) {

  /**
   *
   * Helper for dealing with hash-style function arguments, which can be useful
   * in methods with optional/default values.
   *
   * Usage:
   *
   *   var foo = function(opts) {
   *       opts = Options.fromObject(opts);
   *
   *       var one = opts.getOrError("one"),
   *           two = opts.getOrElse("two", 2),
   *           three = opts.getOrElseFn("three", function() {
   *             return 3;
   *           });
   *
   *     console.log(one, two, three);
   *   };
   *
   *   foo({ one: 1 }); // logs "1, 2, 3"
   *   foo(); // throws Error
   *   foo({one: 1, two: false, three: 4}); // logs "1, false, 4"
   *
   */
  var Options = function(opts) {
    this.initialize.apply(this, arguments);
  }

  _.extend(Options.prototype, {
    initialize: function(opts) {
      this._providedOpts = opts || {};
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead returns the provided `fallbackValue`.
     *
     * @param key (required) attribute to be read
     * @param fallbackValue  returned if `key` attribute is null or undefined
     *
     * @returns requested value for `key`, or fallbackValue`
     */
    getOrElse: function(key, defaultValue) {
      if (this._isUndefOrNull(key)) {
        return defaultValue;
      } else {
        return this._providedOpts[key];
      }
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, throws an error.
     *
     * @param key (required) attribute to be read
     * @param err            message provided to Error constructor if `key`
     *                       is null or not defined
     *
     * @returns the value for the requested key
     */
    getOrError: function(key, errorMsg) {
      if (this._isUndefOrNull(key)) {
        errorMsg = errorMsg || "Option requested but not found: `"+key+"`";
        throw new Error(errorMsg);
      }

      return this._providedOpts[key];
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead evaluates `fallbackValueFn` and returns
     * its value.
     *
     * This is useful for simulating non-strict evaluation.
     *
     * @param key (required)  attribute to be read
     * @param fallbackValueFn evaluated and return value returned if `key`
     *                        attribute is null or undefined
     *
     * @returns requested value for `key` or the return value of evaluated
     *          `fallbackValueFn`
     */
    getOrElseFn: function(key, defaultValueFn) {
      if (typeof defaultValueFn !== "function") {
        throw new Error("Options#getOrElseFn requires a defaultValueFn");
      }

      if (this._isUndefOrNull(key)) {
        return defaultValueFn();
      } else {
        return this._providedOpts[key];
      }
    },


    toObject: function() {
      return _.clone(this._providedOpts);
    },

    scope: function(prefix) {
      return Options.fromObjectWithPrefix(this.toObject(), prefix);
    },

    _isUndefOrNull: function(key) {
      return typeof this._providedOpts[key] === "undefined" || this._providedOpts[key] === null;
    }
  });

  _.extend(Options, {
    fromObject: function(opts) {
      return new Options(opts);
    },


    fromObjectWithPrefix: function(opts, prefix) {
      opts = _.reduce(opts, function(memo, val, key) {
        var rest, newKey;
        if (key.indexOf(prefix) === 0) {
          rest = key.substr(prefix.length);
          if (rest.length > 1) {
            newKey = rest.charAt(0).toLowerCase() + rest.substr(1);
            memo[newKey] = val;
          }
        }
        return memo;
      }, {});

      return new Options(opts);
    }
  })

  return Options;
};

module.exports = factory(
  require("underscore")
);

})()
},{"underscore":63}],8:[function(require,module,exports){
(function(){/*global require: false, module: false */

var mod = function (
  _
  ) {

  /**
   * A device which calls the provided completionCallback after `steps` calls to `CountdownLatch#step()`.
   *
   */

  var CountdownLatch = function () {
        this.initialize.apply(this, arguments);
      },
      noop = function() {};

  _.extend(CountdownLatch.prototype, {
    initialize: function (steps, completionCallback) {
      this._steps = steps || 0;
      this._completionCallback = completionCallback || noop;
      _.bindAll(this, "_completionCallback", "_triggerCompletion");
      if(isNaN(this._steps) || this._steps < 0) {
        throw new Error("CountdownLatch: Number of steps are invalid.");
      }
      this._current = 0;
      this._complete = false;
      this._error = null;
      if(this._steps === 0) {
        _.defer(this._triggerCompletion);
        return;
      }
    },
    step: function (steps) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._current += steps || 1;
      if (this._current >= this._steps) {
        this._triggerCompletion();
      }
    },
    error: function (err) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._error = err;
      this._triggerCompletion();
    },
    _triggerCompletion: function () {
      if (this._complete) {
        return;
      }
      this._complete = true;
      if (this._error) {
        _.defer(_.bind(this._completionCallback, null, this._error));
      } else {
        _.defer(this._completionCallback);
      }
    }
  });

  return CountdownLatch;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],9:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Promise,
  Options
) {

  /**
   * A utility singleton for "language extensions".
   */
  var Lang = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Lang.prototype, {
    initialize: function(){}
  });

  _.extend(Lang, {
    noop: function() {},

    partiallyApply: function() {
      var args = _.toArray(arguments),
          fun  = args.shift();

      return function() {
        return fun.apply(null, args.concat(arguments));
      };
    },

    makeErrorClass: function(name, defaultMessage) {
      if (!name) {
        throw new Error("makeErrorClass requires `name`");
      }

      var klass = function(message) {
        this.name    = name;
        this.message = this.name + ": " + (message || defaultMessage || "An unexpected error occurred");

        if (Error.captureStackTrace) {
          Error.captureStackTrace(this, klass);
        }
      };

      klass.prototype = Object.create(Error.prototype);
      klass.prototype.constructor = klass;
      return klass;
    },

    pojoClass: function(attributes, options) {
      if (!_.isArray(attributes)) {
        throw new Error("Lang#pojoClass requires attributes array");
      }

      var options = Options.fromObject(options),
          // optional specifies keys that are optional, with values that are default if not provided
          defaults = options.getOrElse("defaults", {}),
          optionalAttributes = _.keys(defaults);

      var toAttributeName = function(attr) {
            return "_" + attr;
          },
          toGetter = function(attr) {
            return attr;
          },
          toSetter = function(attr) {
            return "set" + attr.charAt(0).toUpperCase() + attr.substr(1);
          };

      var klass = function() {
        this.initialize.apply(this, arguments);
      };

      _.extend(klass.prototype, {
        initialize: function(opts) {
          opts = Options.fromObject(opts);
          _.each(attributes, function(attr) {
            if (_.contains(optionalAttributes, attr)) {
              this[toAttributeName(attr)] = opts.getOrElse(attr, defaults[attr]);
            } else {
              this[toAttributeName(attr)] = opts.getOrError(attr);
            }
          }, this);
        }
      });

      _.each(attributes, function(attr) {
        klass.prototype[toGetter(attr)] = function() {
          return this[toAttributeName(attr)];
        };
        klass.prototype[toSetter(attr)] = function(v) {
          this[toAttributeName(attr)] = v;
        };
      });

      return klass;
    },

    deferred: function(promiseClass) {
      promiseClass = promiseClass || Promise;
      var res = null, rej = null;
      var p = new promiseClass(function() {
        res = arguments[0];
        rej = arguments[1];
      });

      return {
        promise: p,
        resolve: res,
        reject:  rej
      };
    }
  });

  return Lang;
};

module.exports = factory(
  require("underscore"),
  require("bluebird"),
  require("./options")
);

})()
},{"./options":7,"underscore":63,"bluebird":64}],10:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A StateGuard does what its name implies. Valid states are provided during instantiation, and are applied, ensured,
   * denied, etc, through the course of the owner's lifetime.
   *
   * For example, if you'd like to ensure that Foo#bar raises an error after Foo#dispose is called, you might do the
   * following:
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = new StateGuard(["disposed"]);
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied("disposed")) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply("disposed");
   *     },
   *     bar: function() {
   *       this._stateGuard.deny("disposed"); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   * In this case, where we have only one state, it's useful to simply create a scoped StateGuard, which behaves
   * identically to a regular one, except every enforcement/query method has the scope provided during instantiation
   * as a first, implicit argument:
   *
   *   // Identical to previous version.
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = StateGuard.scoped("disposed");
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied()) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply();
   *     },
   *     bar: function() {
   *       this._stateGuard.deny(); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   */
  var StateGuard = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StateGuard.prototype, {
    initialize: function(states) {
      this._validStates = _.reduce(states, function(memo, state) {
        memo[state] = true;
        return memo;
      }, {});

      this._appliedStates = {};
    },

    scope: function(state) {
      var skip = ["scope", "initialize"],
          self = this,
          scoped = {};

      _.each(StateGuard.prototype, function(fun, methodName) {
        if (_.contains(skip, methodName)) {
          return;
        }

        scoped[methodName] = function() {
          var args = _.toArray(arguments);
          args.unshift(state);
          return fun.apply(self, args);
        };
      });

      return scoped;
    },

    apply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        this._appliedStates[state] = true;
      }, this);

      return this;
    },

    applyAsync: Promise.method(function() {
      return this.apply.apply(this, arguments);
    }),

    applyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.applyAsync.apply(this, args);
      }, this);
    },

    unapply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        if (this._appliedStates[state]) {
          delete this._appliedStates[state];
        }
      }, this);

      return this;
    },

    unapplyAsync: Promise.method(function() {
      return this.unapply.apply(this, arguments);
    }),

    unapplyAsyncFn: function(states) {
      var args = arguments;
      return _.bind(function() {
        return this.unapplyAsync.apply(this, args)
      }, this);
    },

    deny: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      var applied = _.filter(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (applied.length > 0) {
        throw new Error("State denial requested, but applied: " + pretty(applied));
      }

      return this;
    },

    denyAsync: Promise.method(function() {
      return this.deny.apply(this, arguments);
    }),

    denyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.denyAsync.apply(this, args)
      }, this);
    },

    ensure: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);
      var missing = _.reject(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (missing.length > 0) {
        throw new Error("State ensurance requested, but not applied: " + pretty(missing));
      }
      return this;
    },

    ensureAsync: Promise.method(function() {
      return this.ensure.apply(this, arguments);
    }),

    ensureAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.ensureAsync.apply(this, args);
      }, this);
    },

    applied: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      return _.every(states, function(state) {
        return this._appliedStates[state];
      }, this);
    },

    appliedAsync: Promise.method(function() {
      return this.applied.apply(this, arguments);
    }),

    appliedAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.appliedAsync.apply(this, args)
      }, this);
    }
  });

  var aryOrVariadicToArray = function(args) {
    return _.chain(args).toArray().flatten().value();
  };

  var checkValidStatesOrThrow = function(validStatesMap, states) {
    var invalidStates = _.reject(states, function(state) {
      return !!validStatesMap[state];
    });

    if (invalidStates.length > 0) {
      throw new Error("Invalid states provided: " + pretty(invalidStates));
    }
  };

  var pretty = function(states) {
    return "["+states.join(",")+"]";
  };

  _.extend(StateGuard, {
    scoped: function(scope) {
      return (new StateGuard([scope])).scope(scope);
    }
  })

  return StateGuard;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"underscore":63,"bluebird":64}],11:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A mixin enabling pubsub on an object. To use, copy the singleton methods into the object or object prototype:
   *
   *     var myObj = _.extend({}, PubSub);
   *     myObj.on('foo', function(evt) { console.log(evt) }); // logs `{ 'some': 'data' }`
   *     myObj.notify('foo', { some: 'data' });
   *
   */
  var PubSub = {
    on: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.subscribe(handler, context);
    },
    off: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.unsubscribe(handler, context);
    },
    notify: function() {
      var args      = _.toArray(arguments),
          eventName = args.shift();

      var bucket = this.__pubSubBucket(eventName);
      bucket.notify(args);
    },
    __pubSubBucket: function(eventName) {
      this.__pubSubEvents = this.__pubSubEvents || {};
      this.__pubSubEvents[eventName] = this.__pubSubEvents[eventName] || new EventBucket(eventName);
      return this.__pubSubEvents[eventName];
    }
  };

  var EventBucket = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(EventBucket.prototype, {
    initialize: function(eventName) {
      this._eventName = eventName;
      this._subscriptions = [];
    },
    subscribe: function(handler, context) {
      if (handler) {
        this._subscriptions.push(new Subscription(handler, context));
      } else {
        throw new Error("Subscription requires handler: " + this._eventName);
      }
    },
    unsubscribe: function(handler, context) {
      var subs;
      if (handler) {
        subs = _.filter(this._subscriptions, function(sub) {
          return sub.matches(handler, context);
        });
      } else {
        subs = this._subscriptions;
      }

      _.each(subs, function(sub) {
        sub.dispose();
      });

      this._subscriptions = _.difference(this._subscriptions, subs);
    },
    notify: function(args) {
      _.invoke(this._subscriptions, "notify", args);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(handler, context) {
      this._handler = handler;
      this._context = context;
    },
    matches: function(handler, context) {
      if (this._context) {
        // Compare context refs as refs iff we have a context object
        return (handler === this._handler && context === this._context);
      } else {
        // Otherwise, just make sure we don't have a context (null or undefined are fine)
        return (handler === this._handler && !context);
      }
    },
    notify: function(args) {
      // We shouldn't be called after dispose, but
      // just in case...
      if (this._handler) {
        this._handler.apply(this._context, args);
      } else {
        // Something went wrong here...
      }
    },
    dispose: function() {
      this._handler = null;
      this._context = null;
    }
  })

  return PubSub;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],16:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * A doubly-linked list implementation.
   *
   */
  var DoublyLinkedList = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DoublyLinkedList.prototype, {
    initialize: function() {
      this._front = null;
      this._back = null;
      this._size = 0;
    },

    get: function(idx) {
      this._checkElementIdxOrThrow(idx);
      var node = this._walkToIdx(idx);
      return node.value();
    },

    exists: function(value) {
      var node = this._walkToValue(value);
      return !!node;
    },

    size: function() {
      return this._size;
    },

    add: function(value) {
      return this.addBack.apply(this, arguments);
    },

    addFront: function(value) {
      this._linkFront(value);
    },

    addBack: function(value) {
      this._linkBack(value);
    },

    remove: function(value) {
      var node = this._walkToValue(value);
      return this._unlink(node);
    },

    removeFront: function() {
      if (this._front === null) {
        throw new Error("No such element");
      }
      return this._unlinkFront(this._front);
    },

    removeBack: function() {
      if (this._back === null) {
        throw new Error("No such element");
      }
      return this._unlinkBack(this._back);
    },

    insertAtIndex: function(idx, value) {
      this._checkIsElementPositionOrThrow(idx);

      if (idx === this._size) {
        this.addBack(value);
      } else {
        var node = this._walkToIdx(idx);
        this._linkBefore(value, node);
      }
    },

    removeAtIndex: function(idx) {
      this._checkElementIdxOrThrow(idx);
      if (idx === 0) {
        return this._unlinkFront(this._front);
      } else if ( idx === (this._size - 1) ) {
        return this._unlinkBack(this._back);
      } else {
        var node = this._walkToIdx(idx);
        return this._unlink(node);
      }
    },

    clear: function() {
      var node = this._front,
          next;

      while (node !== null) {
        next = node.next();
        node.dispose();
        node = next;
      }
      this._front = null;
      this._back  = null;
      this._size = 0;
    },

    _linkFront: function(value) {
      var oldFront = this._front,
          newNode = new Node({value: value});
      this._front = newNode;

      if (oldFront === null) {
        this._back = newNode;
      } else {
        oldFront.setPrev(newNode);
        newNode.setNext(oldFront);
      }

      this._size++;
      return newNode;
    },

    _linkBack: function(value) {
      var oldBack = this._back,
          newNode = new Node({value: value});

      this._back = newNode;
      if (oldBack === null) {
        this._front = newNode;
      } else {
        oldBack.setNext(newNode);
        newNode.setPrev(oldBack);
      }

      this._size++;
      return newNode;
    },

    _linkBefore: function(value, node) {
      var pred    = node.prev(),
          newNode = new Node({value: value, prev: pred, next: node});

      node.setPrev(newNode);
      if (pred === null) {
        this._front = newNode;
      } else {
        pred.setNext(newNode);
      }
      this._size++;
      return newNode;
    },

    _unlinkFront: function(node) {
      var value    = node.value(),
          newFront = node.next();

      node.dispose();
      this._front = newFront;
      if (newFront === null) {
        this._back = null;
      } else {
        newFront.setPrev(null);
      }
      this._size--;
      return value;
    },

    _unlinkBack: function(node) {
      var value   = node.value(),
          newBack = node.prev();

      node.dispose();
      this._back = newBack;
      if (newBack == null) {
        this._front = null;
      } else {
        newBack.setNext(null);
      }
      this._size--;
      return value;
    },

    _unlink: function(node) {
      var prev  = node.prev(),
          next  = node.next(),
          value = node.value();

      if (prev === null) {
        this._front = next;
      } else {
        prev.setNext(next);
      }

      if (next === null) {
        this._back = prev;
      } else {
        next.setPrev(prev);
      }

      node.dispose();
      this._size--;
      return value;
    },

    _walkToIdx: function(idx) {
      var node, current;
      if (idx < this._size / 2) {
        node = this._front;
        current = 0;
        while(current !== idx) {
          node = node.next();
          current++;
        }
      } else {
        node = this._back;
        current = this._size - 1;

        while(current !== idx) {
          node = node.prev();
          current--;
        }
      }
      return node;
    },

    _walkToValue: function(value) {
      var n = this._front;
      while (n !==null ) {
        if (n.match(value)) {
          return n;
        }
        n = n.next();
      }
      return null;
    },

    _isElementIdx: function(idx) {
      return (idx >= 0 && idx < this._size);
    },

    _isElementPosition: function(idx) {
      return (idx >= 0 && idx <= this._size);
    },

    _checkElementIdxOrThrow: function(idx) {
      if (!this._isElementIdx(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    },

    _checkIsElementPositionOrThrow: function(idx) {
      if (!this._isElementPosition(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    }

  });

  var Node = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Node.prototype, {
    initialize: function(opts) {
      opts        = Options.fromObject(opts);
      this._next  = opts.getOrElse("next", null);
      this._prev  = opts.getOrElse("prev", null);
      this._value = opts.getOrElse("value", null);
    },

    next: function() {
      return this._next;
    },

    prev: function() {
      return this._prev;
    },

    setNext: function(node) {
      this._next = node;
    },

    setPrev: function(node) {
      this._prev = node;
    },

    value: function() {
      return this._value;
    },

    dispose: function() {
      this._next  = null;
      this._prev  = null;
      this._value = null;
    },

    match: function(value) {
      return this._value === value;
    }
  });

  return DoublyLinkedList;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":7,"underscore":63}],17:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * Delegates storage to a JS object.
   */
  var ObjectHashMap = function() {
    this.initialize.apply(this, arguments);
  };


  _.extend(ObjectHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._store = {};
      this._keyPrefix = opts.getOrElse("keyPrefix", "ohm-");
    },
    get: function(key){
      return this._store[this._makeKey(key)];
    },
    put: function(key, val) {
      this._store[this._makeKey(key)] = val;
    },
    remove: function(key) {
      var val;
      key = this._makeKey(key);
      if (_.has(this._store, key)) {
        val = this._store[key];
        delete this._store[key];
      }
      return val;
    },
    exists: function(key) {
      return _.has(this._store, this._makeKey(key));
    },
    size: function() {
      return _.size(this._store);
    },
    clear: function() {
      this._store = {};
    },
    keys: function() {
      return _
        .chain(this._store)
        .keys()
        .map(_.bind(function(key) {
          return this._unmakeKey(key);
        }, this))
        .value();
    },
    values: function() {
      return _.values(this._store);
    },
    _makeKey: function(key) {
      return this._keyPrefix + key;
    },
    _unmakeKey: function(madeKey) {
      return madeKey.substr(this._keyPrefix.length);
    }
  });


  return ObjectHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":7,"underscore":63}],18:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  ObjectHashMap
) {

  var DEFAULT_DEFAULT_FN = function(key) {
    return null;
  };

  var DefaultingHashmap = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DefaultingHashmap.prototype, ObjectHashMap.prototype, {
    initialize: function(opts) {
      ObjectHashMap.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);
      this._defaultFn = opts.getOrElse("defaultFn", DEFAULT_DEFAULT_FN);
    },
    get: function(key) {
      var realKey = this._makeKey(key);
      var v = this._store[realKey];
      if (typeof v === "undefined") {
        v = this._store[realKey] = this._defaultFn(key);
      }
      return v;
    }
  });

  return DefaultingHashmap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./object-hash-map")
);

})()
},{"./object-hash-map":17,"../core/options":7,"underscore":63}],19:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  DefaultingHashMap
) {

  var MultiMap = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(MultiMap.prototype, {
    initialize: function() {
      this._store = new DefaultingHashMap({
        defaultFn: function(key) {
          return [];
        }
      });
    },
    get: function(key) {
      return this._store.get(key);
    },
    put: function(key, val) {
      var v = this._store.get(key);
      v.push(val);
    },
    remove: function(key, val) {
      var v = this._store.get(key);
      var idx = v.indexOf(val);
      if (idx !== -1) {
        v.splice(idx, 1);
        return v;
      }
      return void 0;
    },
    removeAll: function(key) {
      var v = this._store.get(key);
      this._store.remove(key);
      return v;
    },
    exists: function(key, val) {
      return this._store.exists(key) && _.contains(this._store.get(key), val)
    },
    keys: function() {
      return this._store.keys();
    },
    values: function() {
      return _
        .chain(this._store.keys())
        .map(_.bind(function(key) {
          return this._store.get(key);
        }, this))
        .flatten()
        .value();
    },
    size: function() {
      return _.size(this.values());
    },
    clear: function() {
      this._store.clear();
    }
  });

  return MultiMap;
};

module.exports = mod(
  require("underscore"),
  require("./defaulting-hash-map")
);

})()
},{"./defaulting-hash-map":18,"underscore":63}],20:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  ObjectHashMap,
  DoublyLinkedList
) {

  /**
   * An in-memory hash map with an LRU eviction policy.
   *
   */
  var LRUHashMap = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._capacity = opts.getOrError("capacity");
      this._keyAccessList = new DoublyLinkedList();
      // TODO: Really need a proper HashMap at some point...
      this._store = new ObjectHashMap();
    },
    get: function(key) {
      var entry = this._store.get(key);
      if (!entry) {
        return;
      }

      // As a perf optimization, we keep a ref
      // to the node in the entry.
      var node = entry.node();
      this._keyAccessList._unlink(node);

      // Get the new node
      node = this._keyAccessList._linkFront(entry.key());

      // Save it
      entry.setNode(node);
      // Return the value
      return entry.value();
    },

    put: function(key, val) {
      var entry = this._store.get(key),
          node;
      if (!entry) {
        // If no entry, make a new entry
        if (this._keyAccessList.size() >= this._capacity) {
          // Have to make room for it
          var evictedKey = this._keyAccessList.removeBack(),
              evictedEntry = this._store.get(evictedKey);

          evictedEntry.dispose();
          this._store.remove(evictedKey);
        }

        node = this._keyAccessList._linkFront(key);
        entry = new Entry({
          key: key,
          value: val,
          node: node
        });
        this._store.put(key, entry);
      } else {
        // "Touch" the entry, set new value
        node = entry.node();
        this._keyAccessList._unlink(node);
        node = this._keyAccessList._linkFront(entry.key());
        // Update with the new node and value
        entry.setNode(node);
        entry.setValue(val);
      }
    },

    remove: function(key) {
      var entry = this._store.get(key),
          value,
          node;
      if (entry) {
        value = entry.value();
        node = entry.node();
        this._keyAccessList._unlink(node);
        entry.dispose();
        this._store.remove(key);
        return value;
      }
    },

    exists: function(key) {
      return this._store.exists(key);
    },

    size: function() {
      return this._store.size();
    },

    clear: function() {
      this._store.clear();
      this._keyAccessList.clear();
    }
  });

  var Entry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Entry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Though the Node should have the key, if the node
      // is unlinked from the list, its boxed value will disappear
      this._key   = opts.getOrError("key");
      this._value = opts.getOrError("value");
      this._node  = opts.getOrError("node");
    },
    node: function() {
      return this._node;
    },
    setNode: function(node) {
      this._node = node;
    },
    value: function() {
      return this._value;
    },
    setValue: function(value) {
      this._value = value;
    },
    key: function() {
      return this._key;
    },
    dispose: function() {
      this._key = null;
      this._value = null;
      this._node = null;
    }
  });

  return LRUHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./object-hash-map"),
  require("./doubly-linked-list")
);

})()
},{"../core/options":7,"./object-hash-map":17,"./doubly-linked-list":16,"underscore":63}],21:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  InMemoryDataStore,
  UnitSequencer,
  Entry
) {

  // Appropriate for the default sequencer (non-temporal)
  var DEFAULT_TTL = 1;


  /**
   * A look-aside caching data store. Note: it's generally not useful to allow
   * null/undefined stored values. When an item is evicted from the cache, a
   * subsequent `get` call will return `undefined`, so it can be difficult to
   * determine if there was a cache miss if the value you're storing is, in fact,
   * `undefined`, unless you prefix every check with `exists`, which also does
   * cache eviction on check.
   */
  var CachingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CachingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      // Default sequencer is a linear/unit sequencer. The default TTL is
      // 1. Therefore, all values will expire with single advance of the
      // sequencer. Note that the data store doesn't advance the
      // sequencer itself. The store owner is responsible for doing
      // this.
      //
      // This is especially important to note for time-based sequencers.
      // Time will not advance automatically. The store owner is responsible
      // for scheduling the sequencer to advance with time. This keeps the
      // CachingDataStore's lifecycle simple with respect to time.
      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      // By default, we delegate to an in-memory store. Fine for simple
      // cases, but not optimal.
      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      // Updates the lastUpdated time to "now" on read - keeps entries
      // from expiring when they're being accessed, but can cause
      // staleness issues.
      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);
    },

    sequencer: function() {
      return this._sequencer;
    },


    /**
     * Gets the value associated with the provided key. If the object has
     * expired, it will be evicted from the cache, and `undefined` will
     * be returned instead.
     *
     * @param key {string} (required)
     * @async
     * @returns {Promise<Object>} requested value
     */
    get: Promise.method(function(key) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry){
          if (!entry) {
            return;
          }

          if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
            if (this._shouldTouchOnRead) {
              entry.touch(this._sequencer.value());
            }
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .return(entry.value());
          } else {
            return Promise
              .bind(this)
              .then(function() {
                return this.remove(key)
              })
              .then(function() {
                // .thenReturn is a lie.
                return;
              });
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`
     *
     * @param `key` {string}  (required) identifier for value to be stored
     * @param `val` {dynamic} (required) value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          // If we have an entry, we should just update
          // Else, we make new one.
          // Pesist, then return nothing.
          if (entry) {
            entry.update(val, this._sequencer.value());
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value()
            });
          }

          return Promise
            .bind(this)
            .then(function() {
              return this._backingStore.put(key, entry)
            })
            .then(function() {
              return;
            });
        });
    }),

    /**
     * Removes the value associated with the provided `key`
     *
     * @param `key` {string} (required) identifier for value to be removed
     * @async
     * @returns {Promise<dynamic>} Removed value, if present in store.
     */
    remove: Promise.method(function(key) {
      var val;
      return this._backingStore
        .remove(key)
        .then(function(entry) {
          if (entry) {
            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),

    exists: Promise.method(function(key){
      // It's not sufficient to delegate this call to the underlying
      // backing store. We need to perform eviction, as a subsequent call
      // to get would do the same. If the `exists` check says it exists,
      // bet it doesn't when we `get`, then `exists` is a worthless operation.
      //
      // Note that if you're using a CachingDataStore backed by an InMemoryDataStore
      // backed by an LRUHashMap, this will cause the entry to be "touched", whereas
      // a normal "exists" check would not.
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
            if (!entry) {
              return false;
            } else {
              if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
                return true;
              } else {
                return this._backingStore.remove(key)
                  .then(function() {
                    entry.dispose();
                  })
                  .thenReturn(false);
              }
            }
        });
    }),

    clear: Promise.method(function() {
      return this._backingStore.clear();
    })
  });

  return CachingDataStore;

};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../core/sequencer/unit-sequencer"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":7,"./in-memory-data-store":22,"../core/sequencer/unit-sequencer":12,"./internals/expiring-entry":57,"underscore":63,"bluebird":64}],22:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  ObjectHashMap
) {

  /**
   * InMemoryDataStore delegates to a backing HashMap. By default, this
   * will be a "poor man's HashMap", a.k.a., the ObjectHashMap.
   */
  var InMemoryDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._map = opts.getOrElseFn("backingHashMap", function() {
        return new ObjectHashMap();
      });
    },

    get: Promise.method(function(key) {
      return this._map.get(key);
    }),

    put: Promise.method(function(key, val) {
      return this._map.put(key, val);
    }),

    remove: Promise.method(function(key) {
      return this._map.remove(key);
    }),

    exists: Promise.method(function(key){
      return this._map.exists(key);
    }),

    clear: Promise.method(function() {
      return this._map.clear();
    })
  });

  return InMemoryDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../collection/object-hash-map")
);

})()
},{"../core/options":7,"../collection/object-hash-map":17,"underscore":63,"bluebird":64}],23:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  InMemoryDataStore,
  LRUHashMap
) {

  /**
   * A Data Store with an LRU eviction policy.
   *
   */
  var LRUDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUDataStore.prototype, InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      var map = new LRUHashMap({
        capacity: opts.getOrError("capacity")
      });
      InMemoryDataStore.prototype.initialize.call(this, {
        backingHashMap: map
      });
    }
  });

  return LRUDataStore;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../collection/lru-hash-map")
);

})()
},{"../core/options":7,"./in-memory-data-store":22,"../collection/lru-hash-map":20,"underscore":63}],24:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  Channel,
  ChainedChannel,
  UnitSequencer,
  DelegatingForwardingSequencer,
  InMemoryDataStore,
  Entry
) {

  /**
   * Semantically similar to a CachingDataStore, except:
   *   1) Expiry is check both on access, and whenever `advance` is
   *      called on the `sentrySequencer`.
   *   2) Records are not automatically removed; instead, a signal is sent
   *      along the `signalChannel`. The signal dispatch is deferred, so
   *      an access-triggered evocation signal won't be received until a
   *      subsequent tick. Since promises are asynchronous, this means
   *      the caller may receive a value from the store, and may also
   *      receive an event from the Store indicating expiry - in non-deterministic
   *      order. It's up to the caller to choose a resolution.
   *      Additionally, there is no guarantee that a single expiry event
   *      will be sent for a given key; instead, the event will continue
   *      to be dispatched for as long as the key remains in the store.
   * @constructor
   */
  var SignalingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_TTL = 1;

  _.extend(SignalingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      _.bindAll(this, "_doCheck");

      this._sentrySequencer = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [{
          advance: this._doCheck
        }]
      });

      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);

      this._signalChannel = new Channel({ sentinel: this });

      this._keys = M.set();
    },

    sequencer: function() {
      return this._sequencer;
    },

    sentrySequencer: function() {
      return this._sentrySequencer;
    },

    signalChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._signalChannel
      });
    },

    _doCheck: function() {
      var work = M.map(_.bind(function(key) {
        return Promise
          .bind(this)
          .then(function() {
            return this._backingStore.get(key);
          })
          .then(function(entry) {
            if (entry && entry.isExpired(this._sequencer.value(), this._ttl)) {
              this._signalExpirySoon(key, this._sequencer.value());
            }
          });
        }, this), this._keys);

      return Promise.all(M.into_array(work));
    },

    /**
     * Gets the value associated with the provided `key`. If the object
     * has expired, it will still be returned from the Store, but an mT:expired
     * message will be sent along the `signalChannel`.
     *
     * @param key {string}
     * @async
     * @returns {Promise<object>} requested value
     */
    get: Promise.method(function(key){
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (!entry) {
            return;
          }

          var isExpired = entry.isExpired(this._sequencer.value(), this._ttl);

          if (isExpired) {
            this._signalExpirySoon(key, this._sequencer.value());
          }

          if (!isExpired && this._shouldTouchOnRead) {
            entry.touch(this._sequencer.value());
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .thenReturn(entry.value());
          } else {
            return entry.value();
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`, with a TTL optionally
     * supplied by `opts.ttl` (overrides pre-configured Store TTL.
     *
     * @param key {String}
     * @param val {object} value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val, opts) {
      opts = Options.fromObject(opts);

      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (entry) {
            entry.update(val, this._sequencer.value(), {
              ttl: opts.getOrElse("ttl")
            });
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value(),
              ttl: opts.getOrElse("ttl")
            });
          }
          return Promise
            .bind(this)
            .then(function () {
              return this._backingStore.put(key, entry);
            })
            .then(function() {
              this._keys = M.conj(this._keys, key);
              return; // Because thenReturn doesn't work with an empty value.
            });
        });
    }),


    /**
     * Removes the value associated with the provided `key`
     */
    remove: Promise.method(function(key){
      var val;
      return this._backingStore
        .remove(key)
        .bind(this)
        .then(function(entry) {
          if (entry) {
            this._keys = M.disj(this._keys, key);

            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),


    exists: Promise.method(function(key){
      // Unlike in the CachingDataStore, where we have to perform eviction rules before
      // returning the answer, here we can just delegate straight to the backing store.
      return this._backingStore.exists(key);
    }),


    clear: Promise.method(function(){
      return this._backingStore.clear();
    }),


    _signalExpirySoon: function(key, sequence) {
      _.defer(_.bind(function(){
        this._signalChannel.publish(this, {
          mT: "expired",
          key: key,
          sequence: sequence
        });
      }, this));
    }
  });

  return SignalingDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/sequencer/unit-sequencer"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("./in-memory-data-store"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":7,"../core/channel/channel":33,"../core/channel/chained-channel":34,"../core/sequencer/unit-sequencer":12,"../core/sequencer/delegating-forwarding-sequencer":15,"./internals/expiring-entry":57,"./in-memory-data-store":22,"bluebird":64,"underscore":63,"mori":65}],27:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfigurationResolver
) {

  /**
   * A utility "class" for configuration-related functionality.
   * @constructor
   */
  var ConfigurationMagic = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ConfigurationMagic.prototype, {
    initialize: function() {}
  });

  _.extend(ConfigurationMagic, {
    /**
     * Returns a resolved configuration, given multiple configuration documents and a set of scopes. See
     * `ScopedConfigurationResolver`.
     */
    resolveConfig: function(scopes, configObjects) {
      var r = new ScopedConfigurationResolver();
      _.each(configObjects, function(c) {
        r.add(c);
      });
      return r.resolve(scopes);
    }
  });

  return ConfigurationMagic;
};

module.exports = mod(
  require("underscore"),
  require("./config/scoped-configuration-resolver")
);

})()
},{"./config/scoped-configuration-resolver":28,"underscore":63}],30:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Logger,
  Options,
  StateGuard,
  Runtime,
  ProcessKeepAlive
) {
  var Log = Logger.create("App");

  var App = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(App.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._guard = new StateGuard(["starting", "started", "stopping", "stopped"]);
      this._rawConfig = opts.getOrError("configuration");
      this._config = Options.fromObject(this._rawConfig);

      // The default Runtime has sensible defaults.
      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._keepAlive = new ProcessKeepAlive({
        scheduler: this._runtime.scheduler()
      });

      var up   = opts.getOrElse("up"),
          down = opts.getOrElse("down");

      if (up) {
        this.up = Promise.method(_.bind(function() {
          return up.call(this, this._config);
        }, this));
      }

      if (down) {
        this.down = Promise.method(_.bind(function() {
          return down.call(this, this._config);
        }, this));
      }

    },

    start: Promise.method(function() {
      Log.debug("Starting App");
      this._guard
        .deny("starting")
        .apply("starting");

      this._keepAlive.start();
      Log.debug("Calling App#up()");

      return this.up()
        .then(this._guard.applyAsyncFn("started"));
    }),

    stop: Promise.method(function() {
      Log.debug("Stopping App");
      this._guard
        .deny("stopping")
        .apply("stopping");

      this._keepAlive.stop();
      Log.debug("Calling App#down()");

      return this.down()
        .then(this._guard.applyAsyncFn("stopped"));
    }),

    /**
     * Returns the requested configuration value, or throws an error.
     * @param key the configuration key request from the Configuration.
     * @returns {Object}
     */
    config: function(key) {
      return this._config.getOrError(key);
    },

    /**
     * TODO: Doc. Subclass should override.
     */
    up: Promise.method(function() {}),

    /**
     * TODO: Doc. Subclass should override.
     */
    down: Promise.method(function() {})
  });

  return App;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../runtime"),
  require("./internal/process-keep-alive")
);

})()
},{"../core/logging/logger":31,"../core/options":7,"../core/state-guard":10,"./internal/process-keep-alive":61,"../runtime":48,"underscore":63,"bluebird":64}],36:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Logger,
  Options,
  UUID,
  DelegatingForwardingSequencer,
  UnitSequencer,
  InMemoryFiber,
  Mailbox,
  Dispatcher,
  SignalingDataStore,
  Periodic,
  ClockSequencer,
  SystemClock,
  Runtime
  ) {

  /**
   * An `Exchange` vends mailboxes. Messages sent from a mailbox are managed by the Exchange which vended the mailbox.
   * The Exchange handles the work of:
   *
   *   1. Wrapping the message in the appropriate message envelope for the verb used (`send`, `sendAndReceive`,
   *      `reply`)
   *   2. Pairing a given `reply` with the originating `sendAndReceive` call, and fulfilling the associated result
   *      promise.
   *   3. Handling message timeouts for `sendAndReceive` calls. When a message times out, the promise associated with
   *      the result is canceled.
   *
   * The actual work of sending messages is handled by an Exchange's underlying `Fiber`. The default fiber is
   * an `InMemoryFiber`, which performs only local dispatch.
   *
   * Generally speaking, mailboxes sharing an underlying fiber (either by both being spawned from the same mailbox,
   * or being spawned by exchanges sharing the same fiber) can send messages to each other, provided they know
   * each other's addresses.
   *
   */
  var Exchange = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_SEND             = Exchange.MSG_SEND             = "send",
      MSG_SEND_AND_RECEIVE = Exchange.MSG_SEND_AND_RECEIVE = "sendAndReceive",
      MSG_REPLY            = Exchange.MSG_REPLY            = "reply";

  // 7.5 seconds is reasonable, yes?
  var DEFAULT_REPLY_TIMEOUT = 7500;

  var Log = Logger.create("Exchange");


  _.extend(Exchange.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrElse("identity", UUID.v4());

      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._mailboxFiberDelegate = {
        receiveFiberMessage: this._receiveMailboxFiberMessage.bind(this)
      };

      this._mailboxes = M.hash_map();

      this._fiber     = opts.getOrElseFn("fiber", function() {
        return new InMemoryFiber();
      });

      this._fiber.registerEntity({
        identity: this._identity,
        delegate: this
      });

      this._mailboxDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onMbx"
      });

      var usedDefaultClock = false;

      // For requester-provided requestId to messageId mapping.
      // Used for cancelling outstanding sendAndReceive requests.
      this._reqToMsg = M.hash_map();

      // Data store for pending requests
      this._outstandingRequests = new SignalingDataStore({
        ttl: opts.getOrElse("replyTimeout", DEFAULT_REPLY_TIMEOUT),
        sequencer: new ClockSequencer({
          clock: opts.getOrElseFn("clock", function() {
            usedDefaultClock = true;
            return new SystemClock();
          }),
          // Hax - Since we want time to be async, but provide a default system clock
          // we need to get the initial clock sequence sync, by bypassing the clock call.
          // If you provide an async clock, you should either provide an initial time, or
          // ensure that the first getTime has resolved before instantiating the exchange.
          // OR, in the future, we have to add a start()/stop() to Exchange.
          initialSequence: opts.getOrElse("initialSequence", (usedDefaultClock ? +new Date() : undefined))
        })
      });

      // Dispatches store signals (e.g., expiry)
      this._expiryDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onStoreSignal",
        listen: this._outstandingRequests.signalChannel()
      });

      this._compositeSeq = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [this._outstandingRequests.sequencer(), this._outstandingRequests.sentrySequencer()]
      })

      // This guy triggers periodic expiry checks in the store
      this._checkExpiry = new Periodic({
        scheduler: this._runtime.scheduler(),
        task: _.bind(function() {
          return this._compositeSeq.advance();
        }, this),
        interval: opts.getOrElse("expiryInterval", 1000)
      });

      this._checkExpiry.start();
    },


    dispose: function() {
      // TODO: Cancel outstanding requests

      this._expiryDispatcher.dispose();

      this._outstandingRequests.clear();

      // TODO: Dispose all the things
      this._checkExpiry.dispose();
    },


    /**
     * Builds a Mailbox for the provided `requesterIdentity`. The
     * `RequesterIdentity` must never have been used for requesting
     * a mailbox previously.
     *
     * We attempt to validate unique mailbox names, but because mailbox names
     * are global and there is no checking between fibers, it's only a best-effort.
     *
     * @param requesterIdentity
     * @returns {Mailbox}
     */
    mailbox: function(requesterIdentity) {
      this._assertUniqueOwner(requesterIdentity);

      var mailbox = new Mailbox({
        exchange:      this,
        ownerIdentity: requesterIdentity
      });

      this._mailboxes = M.assoc(this._mailboxes, requesterIdentity, mailbox);

      this._fiber.registerEntity({
        identity: requesterIdentity,
        delegate: this._mailboxFiberDelegate
      });

      return mailbox;
    },


    send: function(env) {
      env = Options.fromObject(env);

      return this._fiber.send({
        from:  env.getOrError("from"),
        to:    env.getOrError("to"),
        body:  env.getOrError("body"),
        mT:    MSG_SEND,
        msgId: UUID.v4()
      });
    },


    reply: function(env) {
      env = Options.fromObject(env);
      return this._fiber.send({
        from:   env.getOrError("from"),
        to:     env.getOrError("to"),
        body:   env.getOrError("body"),
        mT:     MSG_REPLY,
        msgId:  UUID.v4(),
        rMsgId: env.getOrError("rMsgId")
      });
    },


    sendAndReceive: function(env, opts) {
      env  = Options.fromObject(env);
      opts = Options.fromObject(opts);

      var msgId = UUID.v4(),
          reqId    = opts.getOrError("reqId"),
          deferred = defer(),
          fibEnv   = {
            from:  env.getOrError("from"),
            to:    env.getOrError("to"),
            body:  env.getOrError("body"),
            mT:    MSG_SEND_AND_RECEIVE,
            msgId: msgId
          },
          req      = {
            reqId:    reqId,
            deferred: deferred,
            fibEnv:   fibEnv
          };

      this._reqToMsg = M.assoc(this._reqToMsg, reqId, msgId);

      return this
        ._outstandingRequests
        .put(msgId, req, {ttl: opts.getOrElse("replyTimeout")})
        .bind(this)
        .then(function() {
          return this._fiber.send(fibEnv);
        })
        .then(function() {
          return req.deferred.promise;
        });
    },

    cancelSendAndReceive: Promise.method(function(reqId) {
      var msgId = M.get(this._reqToMsg, reqId);

      if (msgId) {
        Log.debug("Canceling request", reqId, "with msgId", msgId);
        this._reqToMsg = M.dissoc(this._reqToMsg, reqId);

        return Promise
          .bind(this)
          .then(function() {
            return this._outstandingRequests.remove(msgId);
          })
          .then(function(req) {
            if (req) {
              req.deferred.reject(new Promise.CancellationError());
            }
          })
      } else {
        Log.warn("Tried to cancel request, but no oustanding request with that ID found;", reqId);
      }
    }),


    _assertUniqueOwner: function(identity) {
      if (M.get(this._mailboxes, identity)) {
        throw new Error("Mailbox registration requires a unique identity");
      }
    },


    /**
     * Fiber delegate protocol method for a message bound for a Mailbox owned by
     * this exchange.
     *
     * @param env
     * @private
     */
    _receiveMailboxFiberMessage: function(env) {
      this._mailboxDispatcher.dispatch(env);
    },


    _onMbxSend: function(env) {
      var oEnv     = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body     = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveOneShot(env);
      }
    },

    // TODO: Should this go along the mailbox ingress channel?
    // Or should it be cb-based?
    _onMbxSendAndReceive: function(env) {
      var oEnv = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveRequestReply(env);
      }
    },


    _onMbxReply: function(env) {
      var oEnv     = Options.fromObject(env),
          rMsgId   = oEnv.getOrElse("rMsgId");



      // Don't dispatch vetted replies. Just fulfill the promise
      Promise
        .bind(this)
        .then(function(){
          return this._outstandingRequests.remove(rMsgId);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.resolve(env);
          }
        });
    },


    /**
     * Fired when a request in the outstanding requests store is past due.
     */
    _onStoreSignalExpired: function(sig) {
      Log.debug("Expired entry in store", sig);
      Promise
        .bind(this)
        .then(function() {
          return this._outstandingRequests.remove(sig.key);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.reject(new Promise.TimeoutError());
          }
        });
    },


    /**
     * Fiber delegate protocol method for a message bound for this Exchange directly.
     *
     * @param env
     * @private
     */
    receiveFiberMessage: function(env) {
      throw new Error("Not implemented");
    }
  });


  var defer = function(){
    var res, rej;
    var p = new Promise(function() {
      res = arguments[0];
      rej = arguments[1];
    });

    return {
      promise: p,
      resolve: res,
      reject: rej
    };
  };

  return Exchange;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("../core/sequencer/unit-sequencer"),
  require("./fiber/in-memory-fiber"),
  require("./internals/mailbox"),
  require("../core/dispatcher"),
  require("../storage/signaling-data-store"),
  require("../util/periodic"),
  require("../core/sequencer/clock-sequencer"),
  require("../time/clock/system-clock"),
  require("../runtime")
);

})()
},{"../core/logging/logger":31,"../core/options":7,"../core/uuid":40,"../core/sequencer/delegating-forwarding-sequencer":15,"../core/sequencer/unit-sequencer":12,"./internals/mailbox":60,"../core/dispatcher":6,"../storage/signaling-data-store":24,"../util/periodic":3,"./fiber/in-memory-fiber":38,"../core/sequencer/clock-sequencer":13,"../time/clock/system-clock":26,"../runtime":48,"underscore":63,"bluebird":64,"mori":65}],37:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger,
  Dispatcher
) {

  /**
   * A Courier makes it easy for a maibox owner to deal with sending and receiving messages. It has a slightly more
   * natural interface for sending messages (`send(to, msg)`, `sendAndReceive(to, msg, opts)`), and automatically
   * dispatches incoming messages to delegate methods.
   *
   * Common usage is for a mailbox owner (let's call it "owner A") to create a new Courier ("courier A"), setting the
   * `delegate` to itself, and the `mailbox` to the mailbox ("mailbox A") it owns. When a remote mailbox's
   * ("mailbox B") courier ("courier B") performs a `courier.send("A", { mT: "foo" })`, it will be automatically
   * dispatched to "owner A"'s `onMsgFoo` method, if present.
   *
   * If "courier B" performs a `courier.sendAndReceive("A", { mT: "bar" })`, it will get set to "owner A"'s
   * `onReqBar` method, and the resulting promise's fulfilled value will be dispatched back to "courier B" as the
   * fulfilled result of the originating `sendAndReceive`.
   *
   * A `send` or `sendAndReceive` call initiated on CourierB will result in a method call on DelegateA, and vice versa.
   *
   *  DelegateA <-> CourierA <-> MailboxA <-> ExchangeA
   *                                            ^
   *                                             \
   *                                              v
   *                                           Fiber
   *                                            ^
   *                                             \
   *                                              v
   *                                           ExchangeB <-> MailboxB <-> CourierB <-> DelegateB
   *
   *
   *
   */
  var Courier = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_REPLY = Courier.MSG_REPLY = "cReply";

  var Log = Logger.create("Courier");

  _.extend(Courier.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._id         = UUID.v4();
      this._delegate   = opts.getOrError("delegate");
      this._mailbox    = opts.getOrError("mailbox");
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "_onOneShotMessage", "_onRequestReplyMessage", "_defaultContextDelegate");

      this._contextDelegate = opts.getOrElse("contextDelegate", this._defaultContextDelegate);

      this._oneShotDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("oneShotPrefix", "onMsg"),
        contextDelegate: this._contextDelegate
      });

      this._requestReplyDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("requestReplyPrefix", "onReq"),
        contextDelegate: this._contextDelegate
      });

      this._subs = M.vector(
        this._mailbox.oneShotChannel().subscribe(this._onOneShotMessage),
        this._mailbox.requestReplyChannel().subscribe(this._onRequestReplyMessage)
      );
    },


    id: function() {
      return this._id;
    },

    send: Promise.method(function(to, msg) {
      this._stateGuard.deny("disposed");

      return this._mailbox.send({
        to: to,
        body: msg
      });
    }),

    sendAndReceive: Promise.method(function(to, msg, opts) {
      this._stateGuard.deny("disposed");

      return this._mailbox
        .sendAndReceive({
          to: to,
          body: msg
        }, opts)
        .then(function(res) {

          if (res.body && res.body.mT === MSG_REPLY && res.body.body) {
            // Unwrap the remote message
            if (res.body.body.err) {
              throw new Error(res.body.body.err);
            }
            return res.body.body.res;
          } else {
            // Someone is misbehaving
            Log.warn("Received sendAndReceive reply, but it isn't Courier-compatible", this._mailbox.ownerIdentity(), res);
            return res;
          }
        })
    }),

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }


      M.each(this._subs, function(sub) {
        sub.dispose();
      });

      this._subs     = null;
      this._mailbox  = null;
      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _defaultContextDelegate: function(mTyped) {
      return {
        mailbox: this._mailbox
      };
    },

    _onOneShotMessage: function(msg) {
      this._oneShotDispatcher.dispatch(msg.body, msg);
    },


    _onRequestReplyMessage: function(msg) {
      this._requestReplyDispatcher
        .dispatchAsync(msg.body, msg)
        .bind({
          mbox: this._mailbox,
          err: null,
          result: null
        })
        .then(function(result){
          this.result = result;
        })
        .caught(function(err) {
          this.err = err.message;
        })
        .lastly(function() {
          this.mbox.reply(msg.msgId, {
            to: msg.from,
            body: {
              mT: MSG_REPLY,
              body: {
                err: this.err,
                res: this.result
              }
            }
          });
        });
    }
  });

  return Courier;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/state-guard"),
  require("../core/logging/logger"),
  require("../core/dispatcher")
);

})()
},{"../core/uuid":40,"../core/options":7,"../core/state-guard":10,"../core/logging/logger":31,"../core/dispatcher":6,"underscore":63,"bluebird":64,"mori":65}],40:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

/**
 * Utility for generating V4 UUIDs. Exports a singleton.
 */

var mod = function(
  _
) {

  var UUID = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UUID.prototype, {
    initialize: function() {},
    // See: http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29
    v4: function() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0;
        // 0x3       = 0b00011
        // 0x8       = 0b01000
        // 0x3 | 0x8 = 0b01011
        // r & 0x3   = (0b00000 | 0b00001 | 0b00010 | 0b00011)
        var v = (c == 'x' ? r : (r & 0x3 | 0x8));
        return v.toString(16);
      });
    }
  });

  return new UUID();
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],44:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * A registry for modules. Allows an NPM package to expose internal modules without needing to know the explicit
   * file path, which may change from release to release. Each module may have one or more aliases which can be
   * used to request it later.
   *
   */
  var ComponentRegistry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentRegistry.prototype, {
    initialize: function() {
      this._modules = {};
    },


    register: function(opts) {
      opts = Options.fromObject(opts);
      var aliases   = opts.getOrError("as"),
          modObject = opts.getOrError("module");

      if (!_.isArray(aliases)) {
        aliases = [ aliases ];
      }

      _.each(aliases, _.bind(function(alias) {
        this._modules[alias] = modObject;
      }, this));

      return this;
    },

    selfRegister: function(opts) {
      opts = Options.fromObject(opts);

      return this.register({
        as: opts.getOrError("as"),
        module: ComponentRegistry
      });
    },


    registerMany: function(aliasesAry) {
      _.each(aliasesAry, _.bind(function(alias) {
        this.register(alias);
      }, this));
      return this;
    },

    component: function(alias) {
      var m = this._modules[alias];
      if (!m) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return m;
    }

  });

  ComponentRegistry.prototype.c = ComponentRegistry.prototype.component;

  return ComponentRegistry;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":7,"underscore":63}],62:[function(require,module,exports){
"use strict";

module.exports = require("./web-scheduler");

},{"./web-scheduler":51}],63:[function(require,module,exports){
(function(){//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

(function() {

  // Baseline setup
  // --------------

  // Establish the root object, `window` in the browser, or `exports` on the server.
  var root = this;

  // Save the previous value of the `_` variable.
  var previousUnderscore = root._;

  // Establish the object that gets returned to break out of a loop iteration.
  var breaker = {};

  // Save bytes in the minified (but not gzipped) version:
  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;

  // Create quick reference variables for speed access to core prototypes.
  var
    push             = ArrayProto.push,
    slice            = ArrayProto.slice,
    concat           = ArrayProto.concat,
    toString         = ObjProto.toString,
    hasOwnProperty   = ObjProto.hasOwnProperty;

  // All **ECMAScript 5** native function implementations that we hope to use
  // are declared here.
  var
    nativeForEach      = ArrayProto.forEach,
    nativeMap          = ArrayProto.map,
    nativeReduce       = ArrayProto.reduce,
    nativeReduceRight  = ArrayProto.reduceRight,
    nativeFilter       = ArrayProto.filter,
    nativeEvery        = ArrayProto.every,
    nativeSome         = ArrayProto.some,
    nativeIndexOf      = ArrayProto.indexOf,
    nativeLastIndexOf  = ArrayProto.lastIndexOf,
    nativeIsArray      = Array.isArray,
    nativeKeys         = Object.keys,
    nativeBind         = FuncProto.bind;

  // Create a safe reference to the Underscore object for use below.
  var _ = function(obj) {
    if (obj instanceof _) return obj;
    if (!(this instanceof _)) return new _(obj);
    this._wrapped = obj;
  };

  // Export the Underscore object for **Node.js**, with
  // backwards-compatibility for the old `require()` API. If we're in
  // the browser, add `_` as a global object via a string identifier,
  // for Closure Compiler "advanced" mode.
  if (typeof exports !== 'undefined') {
    if (typeof module !== 'undefined' && module.exports) {
      exports = module.exports = _;
    }
    exports._ = _;
  } else {
    root._ = _;
  }

  // Current version.
  _.VERSION = '1.6.0';

  // Collection Functions
  // --------------------

  // The cornerstone, an `each` implementation, aka `forEach`.
  // Handles objects with the built-in `forEach`, arrays, and raw objects.
  // Delegates to **ECMAScript 5**'s native `forEach` if available.
  var each = _.each = _.forEach = function(obj, iterator, context) {
    if (obj == null) return obj;
    if (nativeForEach && obj.forEach === nativeForEach) {
      obj.forEach(iterator, context);
    } else if (obj.length === +obj.length) {
      for (var i = 0, length = obj.length; i < length; i++) {
        if (iterator.call(context, obj[i], i, obj) === breaker) return;
      }
    } else {
      var keys = _.keys(obj);
      for (var i = 0, length = keys.length; i < length; i++) {
        if (iterator.call(context, obj[keys[i]], keys[i], obj) === breaker) return;
      }
    }
    return obj;
  };

  // Return the results of applying the iterator to each element.
  // Delegates to **ECMAScript 5**'s native `map` if available.
  _.map = _.collect = function(obj, iterator, context) {
    var results = [];
    if (obj == null) return results;
    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);
    each(obj, function(value, index, list) {
      results.push(iterator.call(context, value, index, list));
    });
    return results;
  };

  var reduceError = 'Reduce of empty array with no initial value';

  // **Reduce** builds up a single result from a list of values, aka `inject`,
  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.
  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {
    var initial = arguments.length > 2;
    if (obj == null) obj = [];
    if (nativeReduce && obj.reduce === nativeReduce) {
      if (context) iterator = _.bind(iterator, context);
      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);
    }
    each(obj, function(value, index, list) {
      if (!initial) {
        memo = value;
        initial = true;
      } else {
        memo = iterator.call(context, memo, value, index, list);
      }
    });
    if (!initial) throw new TypeError(reduceError);
    return memo;
  };

  // The right-associative version of reduce, also known as `foldr`.
  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.
  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {
    var initial = arguments.length > 2;
    if (obj == null) obj = [];
    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {
      if (context) iterator = _.bind(iterator, context);
      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);
    }
    var length = obj.length;
    if (length !== +length) {
      var keys = _.keys(obj);
      length = keys.length;
    }
    each(obj, function(value, index, list) {
      index = keys ? keys[--length] : --length;
      if (!initial) {
        memo = obj[index];
        initial = true;
      } else {
        memo = iterator.call(context, memo, obj[index], index, list);
      }
    });
    if (!initial) throw new TypeError(reduceError);
    return memo;
  };

  // Return the first value which passes a truth test. Aliased as `detect`.
  _.find = _.detect = function(obj, predicate, context) {
    var result;
    any(obj, function(value, index, list) {
      if (predicate.call(context, value, index, list)) {
        result = value;
        return true;
      }
    });
    return result;
  };

  // Return all the elements that pass a truth test.
  // Delegates to **ECMAScript 5**'s native `filter` if available.
  // Aliased as `select`.
  _.filter = _.select = function(obj, predicate, context) {
    var results = [];
    if (obj == null) return results;
    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(predicate, context);
    each(obj, function(value, index, list) {
      if (predicate.call(context, value, index, list)) results.push(value);
    });
    return results;
  };

  // Return all the elements for which a truth test fails.
  _.reject = function(obj, predicate, context) {
    return _.filter(obj, function(value, index, list) {
      return !predicate.call(context, value, index, list);
    }, context);
  };

  // Determine whether all of the elements match a truth test.
  // Delegates to **ECMAScript 5**'s native `every` if available.
  // Aliased as `all`.
  _.every = _.all = function(obj, predicate, context) {
    predicate || (predicate = _.identity);
    var result = true;
    if (obj == null) return result;
    if (nativeEvery && obj.every === nativeEvery) return obj.every(predicate, context);
    each(obj, function(value, index, list) {
      if (!(result = result && predicate.call(context, value, index, list))) return breaker;
    });
    return !!result;
  };

  // Determine if at least one element in the object matches a truth test.
  // Delegates to **ECMAScript 5**'s native `some` if available.
  // Aliased as `any`.
  var any = _.some = _.any = function(obj, predicate, context) {
    predicate || (predicate = _.identity);
    var result = false;
    if (obj == null) return result;
    if (nativeSome && obj.some === nativeSome) return obj.some(predicate, context);
    each(obj, function(value, index, list) {
      if (result || (result = predicate.call(context, value, index, list))) return breaker;
    });
    return !!result;
  };

  // Determine if the array or object contains a given value (using `===`).
  // Aliased as `include`.
  _.contains = _.include = function(obj, target) {
    if (obj == null) return false;
    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;
    return any(obj, function(value) {
      return value === target;
    });
  };

  // Invoke a method (with arguments) on every item in a collection.
  _.invoke = function(obj, method) {
    var args = slice.call(arguments, 2);
    var isFunc = _.isFunction(method);
    return _.map(obj, function(value) {
      return (isFunc ? method : value[method]).apply(value, args);
    });
  };

  // Convenience version of a common use case of `map`: fetching a property.
  _.pluck = function(obj, key) {
    return _.map(obj, _.property(key));
  };

  // Convenience version of a common use case of `filter`: selecting only objects
  // containing specific `key:value` pairs.
  _.where = function(obj, attrs) {
    return _.filter(obj, _.matches(attrs));
  };

  // Convenience version of a common use case of `find`: getting the first object
  // containing specific `key:value` pairs.
  _.findWhere = function(obj, attrs) {
    return _.find(obj, _.matches(attrs));
  };

  // Return the maximum element or (element-based computation).
  // Can't optimize arrays of integers longer than 65,535 elements.
  // See [WebKit Bug 80797](https://bugs.webkit.org/show_bug.cgi?id=80797)
  _.max = function(obj, iterator, context) {
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {
      return Math.max.apply(Math, obj);
    }
    var result = -Infinity, lastComputed = -Infinity;
    each(obj, function(value, index, list) {
      var computed = iterator ? iterator.call(context, value, index, list) : value;
      if (computed > lastComputed) {
        result = value;
        lastComputed = computed;
      }
    });
    return result;
  };

  // Return the minimum element (or element-based computation).
  _.min = function(obj, iterator, context) {
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {
      return Math.min.apply(Math, obj);
    }
    var result = Infinity, lastComputed = Infinity;
    each(obj, function(value, index, list) {
      var computed = iterator ? iterator.call(context, value, index, list) : value;
      if (computed < lastComputed) {
        result = value;
        lastComputed = computed;
      }
    });
    return result;
  };

  // Shuffle an array, using the modern version of the
  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher–Yates_shuffle).
  _.shuffle = function(obj) {
    var rand;
    var index = 0;
    var shuffled = [];
    each(obj, function(value) {
      rand = _.random(index++);
      shuffled[index - 1] = shuffled[rand];
      shuffled[rand] = value;
    });
    return shuffled;
  };

  // Sample **n** random values from a collection.
  // If **n** is not specified, returns a single random element.
  // The internal `guard` argument allows it to work with `map`.
  _.sample = function(obj, n, guard) {
    if (n == null || guard) {
      if (obj.length !== +obj.length) obj = _.values(obj);
      return obj[_.random(obj.length - 1)];
    }
    return _.shuffle(obj).slice(0, Math.max(0, n));
  };

  // An internal function to generate lookup iterators.
  var lookupIterator = function(value) {
    if (value == null) return _.identity;
    if (_.isFunction(value)) return value;
    return _.property(value);
  };

  // Sort the object's values by a criterion produced by an iterator.
  _.sortBy = function(obj, iterator, context) {
    iterator = lookupIterator(iterator);
    return _.pluck(_.map(obj, function(value, index, list) {
      return {
        value: value,
        index: index,
        criteria: iterator.call(context, value, index, list)
      };
    }).sort(function(left, right) {
      var a = left.criteria;
      var b = right.criteria;
      if (a !== b) {
        if (a > b || a === void 0) return 1;
        if (a < b || b === void 0) return -1;
      }
      return left.index - right.index;
    }), 'value');
  };

  // An internal function used for aggregate "group by" operations.
  var group = function(behavior) {
    return function(obj, iterator, context) {
      var result = {};
      iterator = lookupIterator(iterator);
      each(obj, function(value, index) {
        var key = iterator.call(context, value, index, obj);
        behavior(result, key, value);
      });
      return result;
    };
  };

  // Groups the object's values by a criterion. Pass either a string attribute
  // to group by, or a function that returns the criterion.
  _.groupBy = group(function(result, key, value) {
    _.has(result, key) ? result[key].push(value) : result[key] = [value];
  });

  // Indexes the object's values by a criterion, similar to `groupBy`, but for
  // when you know that your index values will be unique.
  _.indexBy = group(function(result, key, value) {
    result[key] = value;
  });

  // Counts instances of an object that group by a certain criterion. Pass
  // either a string attribute to count by, or a function that returns the
  // criterion.
  _.countBy = group(function(result, key) {
    _.has(result, key) ? result[key]++ : result[key] = 1;
  });

  // Use a comparator function to figure out the smallest index at which
  // an object should be inserted so as to maintain order. Uses binary search.
  _.sortedIndex = function(array, obj, iterator, context) {
    iterator = lookupIterator(iterator);
    var value = iterator.call(context, obj);
    var low = 0, high = array.length;
    while (low < high) {
      var mid = (low + high) >>> 1;
      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;
    }
    return low;
  };

  // Safely create a real, live array from anything iterable.
  _.toArray = function(obj) {
    if (!obj) return [];
    if (_.isArray(obj)) return slice.call(obj);
    if (obj.length === +obj.length) return _.map(obj, _.identity);
    return _.values(obj);
  };

  // Return the number of elements in an object.
  _.size = function(obj) {
    if (obj == null) return 0;
    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;
  };

  // Array Functions
  // ---------------

  // Get the first element of an array. Passing **n** will return the first N
  // values in the array. Aliased as `head` and `take`. The **guard** check
  // allows it to work with `_.map`.
  _.first = _.head = _.take = function(array, n, guard) {
    if (array == null) return void 0;
    if ((n == null) || guard) return array[0];
    if (n < 0) return [];
    return slice.call(array, 0, n);
  };

  // Returns everything but the last entry of the array. Especially useful on
  // the arguments object. Passing **n** will return all the values in
  // the array, excluding the last N. The **guard** check allows it to work with
  // `_.map`.
  _.initial = function(array, n, guard) {
    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));
  };

  // Get the last element of an array. Passing **n** will return the last N
  // values in the array. The **guard** check allows it to work with `_.map`.
  _.last = function(array, n, guard) {
    if (array == null) return void 0;
    if ((n == null) || guard) return array[array.length - 1];
    return slice.call(array, Math.max(array.length - n, 0));
  };

  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.
  // Especially useful on the arguments object. Passing an **n** will return
  // the rest N values in the array. The **guard**
  // check allows it to work with `_.map`.
  _.rest = _.tail = _.drop = function(array, n, guard) {
    return slice.call(array, (n == null) || guard ? 1 : n);
  };

  // Trim out all falsy values from an array.
  _.compact = function(array) {
    return _.filter(array, _.identity);
  };

  // Internal implementation of a recursive `flatten` function.
  var flatten = function(input, shallow, output) {
    if (shallow && _.every(input, _.isArray)) {
      return concat.apply(output, input);
    }
    each(input, function(value) {
      if (_.isArray(value) || _.isArguments(value)) {
        shallow ? push.apply(output, value) : flatten(value, shallow, output);
      } else {
        output.push(value);
      }
    });
    return output;
  };

  // Flatten out an array, either recursively (by default), or just one level.
  _.flatten = function(array, shallow) {
    return flatten(array, shallow, []);
  };

  // Return a version of the array that does not contain the specified value(s).
  _.without = function(array) {
    return _.difference(array, slice.call(arguments, 1));
  };

  // Split an array into two arrays: one whose elements all satisfy the given
  // predicate, and one whose elements all do not satisfy the predicate.
  _.partition = function(array, predicate) {
    var pass = [], fail = [];
    each(array, function(elem) {
      (predicate(elem) ? pass : fail).push(elem);
    });
    return [pass, fail];
  };

  // Produce a duplicate-free version of the array. If the array has already
  // been sorted, you have the option of using a faster algorithm.
  // Aliased as `unique`.
  _.uniq = _.unique = function(array, isSorted, iterator, context) {
    if (_.isFunction(isSorted)) {
      context = iterator;
      iterator = isSorted;
      isSorted = false;
    }
    var initial = iterator ? _.map(array, iterator, context) : array;
    var results = [];
    var seen = [];
    each(initial, function(value, index) {
      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {
        seen.push(value);
        results.push(array[index]);
      }
    });
    return results;
  };

  // Produce an array that contains the union: each distinct element from all of
  // the passed-in arrays.
  _.union = function() {
    return _.uniq(_.flatten(arguments, true));
  };

  // Produce an array that contains every item shared between all the
  // passed-in arrays.
  _.intersection = function(array) {
    var rest = slice.call(arguments, 1);
    return _.filter(_.uniq(array), function(item) {
      return _.every(rest, function(other) {
        return _.contains(other, item);
      });
    });
  };

  // Take the difference between one array and a number of other arrays.
  // Only the elements present in just the first array will remain.
  _.difference = function(array) {
    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));
    return _.filter(array, function(value){ return !_.contains(rest, value); });
  };

  // Zip together multiple lists into a single array -- elements that share
  // an index go together.
  _.zip = function() {
    var length = _.max(_.pluck(arguments, 'length').concat(0));
    var results = new Array(length);
    for (var i = 0; i < length; i++) {
      results[i] = _.pluck(arguments, '' + i);
    }
    return results;
  };

  // Converts lists into objects. Pass either a single array of `[key, value]`
  // pairs, or two parallel arrays of the same length -- one of keys, and one of
  // the corresponding values.
  _.object = function(list, values) {
    if (list == null) return {};
    var result = {};
    for (var i = 0, length = list.length; i < length; i++) {
      if (values) {
        result[list[i]] = values[i];
      } else {
        result[list[i][0]] = list[i][1];
      }
    }
    return result;
  };

  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),
  // we need this function. Return the position of the first occurrence of an
  // item in an array, or -1 if the item is not included in the array.
  // Delegates to **ECMAScript 5**'s native `indexOf` if available.
  // If the array is large and already in sort order, pass `true`
  // for **isSorted** to use binary search.
  _.indexOf = function(array, item, isSorted) {
    if (array == null) return -1;
    var i = 0, length = array.length;
    if (isSorted) {
      if (typeof isSorted == 'number') {
        i = (isSorted < 0 ? Math.max(0, length + isSorted) : isSorted);
      } else {
        i = _.sortedIndex(array, item);
        return array[i] === item ? i : -1;
      }
    }
    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);
    for (; i < length; i++) if (array[i] === item) return i;
    return -1;
  };

  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.
  _.lastIndexOf = function(array, item, from) {
    if (array == null) return -1;
    var hasIndex = from != null;
    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {
      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);
    }
    var i = (hasIndex ? from : array.length);
    while (i--) if (array[i] === item) return i;
    return -1;
  };

  // Generate an integer Array containing an arithmetic progression. A port of
  // the native Python `range()` function. See
  // [the Python documentation](http://docs.python.org/library/functions.html#range).
  _.range = function(start, stop, step) {
    if (arguments.length <= 1) {
      stop = start || 0;
      start = 0;
    }
    step = arguments[2] || 1;

    var length = Math.max(Math.ceil((stop - start) / step), 0);
    var idx = 0;
    var range = new Array(length);

    while(idx < length) {
      range[idx++] = start;
      start += step;
    }

    return range;
  };

  // Function (ahem) Functions
  // ------------------

  // Reusable constructor function for prototype setting.
  var ctor = function(){};

  // Create a function bound to a given object (assigning `this`, and arguments,
  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if
  // available.
  _.bind = function(func, context) {
    var args, bound;
    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));
    if (!_.isFunction(func)) throw new TypeError;
    args = slice.call(arguments, 2);
    return bound = function() {
      if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));
      ctor.prototype = func.prototype;
      var self = new ctor;
      ctor.prototype = null;
      var result = func.apply(self, args.concat(slice.call(arguments)));
      if (Object(result) === result) return result;
      return self;
    };
  };

  // Partially apply a function by creating a version that has had some of its
  // arguments pre-filled, without changing its dynamic `this` context. _ acts
  // as a placeholder, allowing any combination of arguments to be pre-filled.
  _.partial = function(func) {
    var boundArgs = slice.call(arguments, 1);
    return function() {
      var position = 0;
      var args = boundArgs.slice();
      for (var i = 0, length = args.length; i < length; i++) {
        if (args[i] === _) args[i] = arguments[position++];
      }
      while (position < arguments.length) args.push(arguments[position++]);
      return func.apply(this, args);
    };
  };

  // Bind a number of an object's methods to that object. Remaining arguments
  // are the method names to be bound. Useful for ensuring that all callbacks
  // defined on an object belong to it.
  _.bindAll = function(obj) {
    var funcs = slice.call(arguments, 1);
    if (funcs.length === 0) throw new Error('bindAll must be passed function names');
    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });
    return obj;
  };

  // Memoize an expensive function by storing its results.
  _.memoize = function(func, hasher) {
    var memo = {};
    hasher || (hasher = _.identity);
    return function() {
      var key = hasher.apply(this, arguments);
      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));
    };
  };

  // Delays a function for the given number of milliseconds, and then calls
  // it with the arguments supplied.
  _.delay = function(func, wait) {
    var args = slice.call(arguments, 2);
    return setTimeout(function(){ return func.apply(null, args); }, wait);
  };

  // Defers a function, scheduling it to run after the current call stack has
  // cleared.
  _.defer = function(func) {
    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));
  };

  // Returns a function, that, when invoked, will only be triggered at most once
  // during a given window of time. Normally, the throttled function will run
  // as much as it can, without ever going more than once per `wait` duration;
  // but if you'd like to disable the execution on the leading edge, pass
  // `{leading: false}`. To disable execution on the trailing edge, ditto.
  _.throttle = function(func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    options || (options = {});
    var later = function() {
      previous = options.leading === false ? 0 : _.now();
      timeout = null;
      result = func.apply(context, args);
      context = args = null;
    };
    return function() {
      var now = _.now();
      if (!previous && options.leading === false) previous = now;
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
        context = args = null;
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  };

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.
  _.debounce = function(func, wait, immediate) {
    var timeout, args, context, timestamp, result;

    var later = function() {
      var last = _.now() - timestamp;
      if (last < wait) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        if (!immediate) {
          result = func.apply(context, args);
          context = args = null;
        }
      }
    };

    return function() {
      context = this;
      args = arguments;
      timestamp = _.now();
      var callNow = immediate && !timeout;
      if (!timeout) {
        timeout = setTimeout(later, wait);
      }
      if (callNow) {
        result = func.apply(context, args);
        context = args = null;
      }

      return result;
    };
  };

  // Returns a function that will be executed at most one time, no matter how
  // often you call it. Useful for lazy initialization.
  _.once = function(func) {
    var ran = false, memo;
    return function() {
      if (ran) return memo;
      ran = true;
      memo = func.apply(this, arguments);
      func = null;
      return memo;
    };
  };

  // Returns the first function passed as an argument to the second,
  // allowing you to adjust arguments, run code before and after, and
  // conditionally execute the original function.
  _.wrap = function(func, wrapper) {
    return _.partial(wrapper, func);
  };

  // Returns a function that is the composition of a list of functions, each
  // consuming the return value of the function that follows.
  _.compose = function() {
    var funcs = arguments;
    return function() {
      var args = arguments;
      for (var i = funcs.length - 1; i >= 0; i--) {
        args = [funcs[i].apply(this, args)];
      }
      return args[0];
    };
  };

  // Returns a function that will only be executed after being called N times.
  _.after = function(times, func) {
    return function() {
      if (--times < 1) {
        return func.apply(this, arguments);
      }
    };
  };

  // Object Functions
  // ----------------

  // Retrieve the names of an object's properties.
  // Delegates to **ECMAScript 5**'s native `Object.keys`
  _.keys = function(obj) {
    if (!_.isObject(obj)) return [];
    if (nativeKeys) return nativeKeys(obj);
    var keys = [];
    for (var key in obj) if (_.has(obj, key)) keys.push(key);
    return keys;
  };

  // Retrieve the values of an object's properties.
  _.values = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var values = new Array(length);
    for (var i = 0; i < length; i++) {
      values[i] = obj[keys[i]];
    }
    return values;
  };

  // Convert an object into a list of `[key, value]` pairs.
  _.pairs = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var pairs = new Array(length);
    for (var i = 0; i < length; i++) {
      pairs[i] = [keys[i], obj[keys[i]]];
    }
    return pairs;
  };

  // Invert the keys and values of an object. The values must be serializable.
  _.invert = function(obj) {
    var result = {};
    var keys = _.keys(obj);
    for (var i = 0, length = keys.length; i < length; i++) {
      result[obj[keys[i]]] = keys[i];
    }
    return result;
  };

  // Return a sorted list of the function names available on the object.
  // Aliased as `methods`
  _.functions = _.methods = function(obj) {
    var names = [];
    for (var key in obj) {
      if (_.isFunction(obj[key])) names.push(key);
    }
    return names.sort();
  };

  // Extend a given object with all the properties in passed-in object(s).
  _.extend = function(obj) {
    each(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          obj[prop] = source[prop];
        }
      }
    });
    return obj;
  };

  // Return a copy of the object only containing the whitelisted properties.
  _.pick = function(obj) {
    var copy = {};
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));
    each(keys, function(key) {
      if (key in obj) copy[key] = obj[key];
    });
    return copy;
  };

   // Return a copy of the object without the blacklisted properties.
  _.omit = function(obj) {
    var copy = {};
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));
    for (var key in obj) {
      if (!_.contains(keys, key)) copy[key] = obj[key];
    }
    return copy;
  };

  // Fill in a given object with default properties.
  _.defaults = function(obj) {
    each(slice.call(arguments, 1), function(source) {
      if (source) {
        for (var prop in source) {
          if (obj[prop] === void 0) obj[prop] = source[prop];
        }
      }
    });
    return obj;
  };

  // Create a (shallow-cloned) duplicate of an object.
  _.clone = function(obj) {
    if (!_.isObject(obj)) return obj;
    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);
  };

  // Invokes interceptor with the obj, and then returns obj.
  // The primary purpose of this method is to "tap into" a method chain, in
  // order to perform operations on intermediate results within the chain.
  _.tap = function(obj, interceptor) {
    interceptor(obj);
    return obj;
  };

  // Internal recursive comparison function for `isEqual`.
  var eq = function(a, b, aStack, bStack) {
    // Identical objects are equal. `0 === -0`, but they aren't identical.
    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).
    if (a === b) return a !== 0 || 1 / a == 1 / b;
    // A strict comparison is necessary because `null == undefined`.
    if (a == null || b == null) return a === b;
    // Unwrap any wrapped objects.
    if (a instanceof _) a = a._wrapped;
    if (b instanceof _) b = b._wrapped;
    // Compare `[[Class]]` names.
    var className = toString.call(a);
    if (className != toString.call(b)) return false;
    switch (className) {
      // Strings, numbers, dates, and booleans are compared by value.
      case '[object String]':
        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is
        // equivalent to `new String("5")`.
        return a == String(b);
      case '[object Number]':
        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for
        // other numeric values.
        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);
      case '[object Date]':
      case '[object Boolean]':
        // Coerce dates and booleans to numeric primitive values. Dates are compared by their
        // millisecond representations. Note that invalid dates with millisecond representations
        // of `NaN` are not equivalent.
        return +a == +b;
      // RegExps are compared by their source patterns and flags.
      case '[object RegExp]':
        return a.source == b.source &&
               a.global == b.global &&
               a.multiline == b.multiline &&
               a.ignoreCase == b.ignoreCase;
    }
    if (typeof a != 'object' || typeof b != 'object') return false;
    // Assume equality for cyclic structures. The algorithm for detecting cyclic
    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.
    var length = aStack.length;
    while (length--) {
      // Linear search. Performance is inversely proportional to the number of
      // unique nested structures.
      if (aStack[length] == a) return bStack[length] == b;
    }
    // Objects with different constructors are not equivalent, but `Object`s
    // from different frames are.
    var aCtor = a.constructor, bCtor = b.constructor;
    if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&
                             _.isFunction(bCtor) && (bCtor instanceof bCtor))
                        && ('constructor' in a && 'constructor' in b)) {
      return false;
    }
    // Add the first object to the stack of traversed objects.
    aStack.push(a);
    bStack.push(b);
    var size = 0, result = true;
    // Recursively compare objects and arrays.
    if (className == '[object Array]') {
      // Compare array lengths to determine if a deep comparison is necessary.
      size = a.length;
      result = size == b.length;
      if (result) {
        // Deep compare the contents, ignoring non-numeric properties.
        while (size--) {
          if (!(result = eq(a[size], b[size], aStack, bStack))) break;
        }
      }
    } else {
      // Deep compare objects.
      for (var key in a) {
        if (_.has(a, key)) {
          // Count the expected number of properties.
          size++;
          // Deep compare each member.
          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;
        }
      }
      // Ensure that both objects contain the same number of properties.
      if (result) {
        for (key in b) {
          if (_.has(b, key) && !(size--)) break;
        }
        result = !size;
      }
    }
    // Remove the first object from the stack of traversed objects.
    aStack.pop();
    bStack.pop();
    return result;
  };

  // Perform a deep comparison to check if two objects are equal.
  _.isEqual = function(a, b) {
    return eq(a, b, [], []);
  };

  // Is a given array, string, or object empty?
  // An "empty" object has no enumerable own-properties.
  _.isEmpty = function(obj) {
    if (obj == null) return true;
    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;
    for (var key in obj) if (_.has(obj, key)) return false;
    return true;
  };

  // Is a given value a DOM element?
  _.isElement = function(obj) {
    return !!(obj && obj.nodeType === 1);
  };

  // Is a given value an array?
  // Delegates to ECMA5's native Array.isArray
  _.isArray = nativeIsArray || function(obj) {
    return toString.call(obj) == '[object Array]';
  };

  // Is a given variable an object?
  _.isObject = function(obj) {
    return obj === Object(obj);
  };

  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.
  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {
    _['is' + name] = function(obj) {
      return toString.call(obj) == '[object ' + name + ']';
    };
  });

  // Define a fallback version of the method in browsers (ahem, IE), where
  // there isn't any inspectable "Arguments" type.
  if (!_.isArguments(arguments)) {
    _.isArguments = function(obj) {
      return !!(obj && _.has(obj, 'callee'));
    };
  }

  // Optimize `isFunction` if appropriate.
  if (typeof (/./) !== 'function') {
    _.isFunction = function(obj) {
      return typeof obj === 'function';
    };
  }

  // Is a given object a finite number?
  _.isFinite = function(obj) {
    return isFinite(obj) && !isNaN(parseFloat(obj));
  };

  // Is the given value `NaN`? (NaN is the only number which does not equal itself).
  _.isNaN = function(obj) {
    return _.isNumber(obj) && obj != +obj;
  };

  // Is a given value a boolean?
  _.isBoolean = function(obj) {
    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';
  };

  // Is a given value equal to null?
  _.isNull = function(obj) {
    return obj === null;
  };

  // Is a given variable undefined?
  _.isUndefined = function(obj) {
    return obj === void 0;
  };

  // Shortcut function for checking if an object has a given property directly
  // on itself (in other words, not on a prototype).
  _.has = function(obj, key) {
    return hasOwnProperty.call(obj, key);
  };

  // Utility Functions
  // -----------------

  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its
  // previous owner. Returns a reference to the Underscore object.
  _.noConflict = function() {
    root._ = previousUnderscore;
    return this;
  };

  // Keep the identity function around for default iterators.
  _.identity = function(value) {
    return value;
  };

  _.constant = function(value) {
    return function () {
      return value;
    };
  };

  _.property = function(key) {
    return function(obj) {
      return obj[key];
    };
  };

  // Returns a predicate for checking whether an object has a given set of `key:value` pairs.
  _.matches = function(attrs) {
    return function(obj) {
      if (obj === attrs) return true; //avoid comparing an object to itself.
      for (var key in attrs) {
        if (attrs[key] !== obj[key])
          return false;
      }
      return true;
    }
  };

  // Run a function **n** times.
  _.times = function(n, iterator, context) {
    var accum = Array(Math.max(0, n));
    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);
    return accum;
  };

  // Return a random integer between min and max (inclusive).
  _.random = function(min, max) {
    if (max == null) {
      max = min;
      min = 0;
    }
    return min + Math.floor(Math.random() * (max - min + 1));
  };

  // A (possibly faster) way to get the current timestamp as an integer.
  _.now = Date.now || function() { return new Date().getTime(); };

  // List of HTML entities for escaping.
  var entityMap = {
    escape: {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#x27;'
    }
  };
  entityMap.unescape = _.invert(entityMap.escape);

  // Regexes containing the keys and values listed immediately above.
  var entityRegexes = {
    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),
    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')
  };

  // Functions for escaping and unescaping strings to/from HTML interpolation.
  _.each(['escape', 'unescape'], function(method) {
    _[method] = function(string) {
      if (string == null) return '';
      return ('' + string).replace(entityRegexes[method], function(match) {
        return entityMap[method][match];
      });
    };
  });

  // If the value of the named `property` is a function then invoke it with the
  // `object` as context; otherwise, return it.
  _.result = function(object, property) {
    if (object == null) return void 0;
    var value = object[property];
    return _.isFunction(value) ? value.call(object) : value;
  };

  // Add your own custom functions to the Underscore object.
  _.mixin = function(obj) {
    each(_.functions(obj), function(name) {
      var func = _[name] = obj[name];
      _.prototype[name] = function() {
        var args = [this._wrapped];
        push.apply(args, arguments);
        return result.call(this, func.apply(_, args));
      };
    });
  };

  // Generate a unique integer id (unique within the entire client session).
  // Useful for temporary DOM ids.
  var idCounter = 0;
  _.uniqueId = function(prefix) {
    var id = ++idCounter + '';
    return prefix ? prefix + id : id;
  };

  // By default, Underscore uses ERB-style template delimiters, change the
  // following template settings to use alternative delimiters.
  _.templateSettings = {
    evaluate    : /<%([\s\S]+?)%>/g,
    interpolate : /<%=([\s\S]+?)%>/g,
    escape      : /<%-([\s\S]+?)%>/g
  };

  // When customizing `templateSettings`, if you don't want to define an
  // interpolation, evaluation or escaping regex, we need one that is
  // guaranteed not to match.
  var noMatch = /(.)^/;

  // Certain characters need to be escaped so that they can be put into a
  // string literal.
  var escapes = {
    "'":      "'",
    '\\':     '\\',
    '\r':     'r',
    '\n':     'n',
    '\t':     't',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  var escaper = /\\|'|\r|\n|\t|\u2028|\u2029/g;

  // JavaScript micro-templating, similar to John Resig's implementation.
  // Underscore templating handles arbitrary delimiters, preserves whitespace,
  // and correctly escapes quotes within interpolated code.
  _.template = function(text, data, settings) {
    var render;
    settings = _.defaults({}, settings, _.templateSettings);

    // Combine delimiters into one regular expression via alternation.
    var matcher = new RegExp([
      (settings.escape || noMatch).source,
      (settings.interpolate || noMatch).source,
      (settings.evaluate || noMatch).source
    ].join('|') + '|$', 'g');

    // Compile the template source, escaping string literals appropriately.
    var index = 0;
    var source = "__p+='";
    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {
      source += text.slice(index, offset)
        .replace(escaper, function(match) { return '\\' + escapes[match]; });

      if (escape) {
        source += "'+\n((__t=(" + escape + "))==null?'':_.escape(__t))+\n'";
      }
      if (interpolate) {
        source += "'+\n((__t=(" + interpolate + "))==null?'':__t)+\n'";
      }
      if (evaluate) {
        source += "';\n" + evaluate + "\n__p+='";
      }
      index = offset + match.length;
      return match;
    });
    source += "';\n";

    // If a variable is not specified, place data values in local scope.
    if (!settings.variable) source = 'with(obj||{}){\n' + source + '}\n';

    source = "var __t,__p='',__j=Array.prototype.join," +
      "print=function(){__p+=__j.call(arguments,'');};\n" +
      source + "return __p;\n";

    try {
      render = new Function(settings.variable || 'obj', '_', source);
    } catch (e) {
      e.source = source;
      throw e;
    }

    if (data) return render(data, _);
    var template = function(data) {
      return render.call(this, data, _);
    };

    // Provide the compiled function source as a convenience for precompilation.
    template.source = 'function(' + (settings.variable || 'obj') + '){\n' + source + '}';

    return template;
  };

  // Add a "chain" function, which will delegate to the wrapper.
  _.chain = function(obj) {
    return _(obj).chain();
  };

  // OOP
  // ---------------
  // If Underscore is called as a function, it returns a wrapped object that
  // can be used OO-style. This wrapper holds altered versions of all the
  // underscore functions. Wrapped objects may be chained.

  // Helper function to continue chaining intermediate results.
  var result = function(obj) {
    return this._chain ? _(obj).chain() : obj;
  };

  // Add all of the Underscore functions to the wrapper object.
  _.mixin(_);

  // Add all mutator Array functions to the wrapper.
  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      var obj = this._wrapped;
      method.apply(obj, arguments);
      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];
      return result.call(this, obj);
    };
  });

  // Add all accessor Array functions to the wrapper.
  each(['concat', 'join', 'slice'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      return result.call(this, method.apply(this._wrapped, arguments));
    };
  });

  _.extend(_.prototype, {

    // Start chaining a wrapped Underscore object.
    chain: function() {
      this._chain = true;
      return this;
    },

    // Extracts the result from a wrapped and chained object.
    value: function() {
      return this._wrapped;
    }

  });

  // AMD registration happens at the end for compatibility with AMD loaders
  // that may not enforce next-turn semantics on modules. Even though general
  // practice for AMD registration is to be anonymous, underscore registers
  // as a named module because, like jQuery, it is a base library that is
  // popular enough to be bundled in a third party lib, but not be part of
  // an AMD load request. Those cases could generate an error when an
  // anonymous define() is called outside of a loader request.
  if (typeof define === 'function' && define.amd) {
    define('underscore', [], function() {
      return _;
    });
  }
}).call(this);

})()
},{}],65:[function(require,module,exports){
(function(definition){if(typeof exports==="object"){module.exports=definition();}else if(typeof define==="function"&&define.amd){define(definition);}else{mori=definition();}})(function(){return function(){
var g,aa=this;
function m(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}var ba="closure_uid_"+(1E9*Math.random()>>>0),ca=0;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function da(a,b){for(var c in a)b.call(void 0,a[c],c,a)};function ea(a,b){null!=a&&this.append.apply(this,arguments)}ea.prototype.Va="";ea.prototype.append=function(a,b,c){this.Va+=a;if(null!=b)for(var d=1;d<arguments.length;d++)this.Va+=arguments[d];return this};ea.prototype.toString=function(){return this.Va};function fa(a,b){a.sort(b||ga)}function ha(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||ga;fa(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value}function ga(a,b){return a>b?1:a<b?-1:0};var ia=null,ja=null;function ka(){return new la(null,5,[ma,!0,oa,!0,pa,!1,qa,!1,ra,ia],null)}function r(a){return null!=a&&!1!==a}function sa(a){return r(a)?!1:!0}function s(a,b){return a[m(null==b?null:b)]?!0:a._?!0:u?!1:null}function ta(a){return null==a?null:a.constructor}function x(a,b){var c=ta(b),c=r(r(c)?c.Db:c)?c.Bb:m(b);return Error(["No protocol method ",a," defined for type ",c,": ",b].join(""))}function ua(a){var b=a.Bb;return r(b)?b:""+A.b(a)}
function va(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function wa(a){return Array.prototype.slice.call(arguments)}
var xa=function(){function a(a,b){return C.c?C.c(function(a,b){a.push(b);return a},[],b):C.call(null,function(a,b){a.push(b);return a},[],b)}function b(a){return c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,0,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),ya={},za={};
function Aa(a){if(a?a.L:a)return a.L(a);var b;b=Aa[m(null==a?null:a)];if(!b&&(b=Aa._,!b))throw x("ICounted.-count",a);return b.call(null,a)}function Ba(a){if(a?a.I:a)return a.I(a);var b;b=Ba[m(null==a?null:a)];if(!b&&(b=Ba._,!b))throw x("IEmptyableCollection.-empty",a);return b.call(null,a)}var Ca={};function Da(a,b){if(a?a.G:a)return a.G(a,b);var c;c=Da[m(null==a?null:a)];if(!c&&(c=Da._,!c))throw x("ICollection.-conj",a);return c.call(null,a,b)}
var Ea={},D=function(){function a(a,b,c){if(a?a.aa:a)return a.aa(a,b,c);var h;h=D[m(null==a?null:a)];if(!h&&(h=D._,!h))throw x("IIndexed.-nth",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.J:a)return a.J(a,b);var c;c=D[m(null==a?null:a)];if(!c&&(c=D._,!c))throw x("IIndexed.-nth",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),
Fa={};function Ha(a){if(a?a.Q:a)return a.Q(a);var b;b=Ha[m(null==a?null:a)];if(!b&&(b=Ha._,!b))throw x("ISeq.-first",a);return b.call(null,a)}function Ia(a){if(a?a.S:a)return a.S(a);var b;b=Ia[m(null==a?null:a)];if(!b&&(b=Ia._,!b))throw x("ISeq.-rest",a);return b.call(null,a)}
var Ja={},Ka={},La=function(){function a(a,b,c){if(a?a.C:a)return a.C(a,b,c);var h;h=La[m(null==a?null:a)];if(!h&&(h=La._,!h))throw x("ILookup.-lookup",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.u:a)return a.u(a,b);var c;c=La[m(null==a?null:a)];if(!c&&(c=La._,!c))throw x("ILookup.-lookup",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=
a;return c}(),Ma={};function Na(a,b){if(a?a.kb:a)return a.kb(a,b);var c;c=Na[m(null==a?null:a)];if(!c&&(c=Na._,!c))throw x("IAssociative.-contains-key?",a);return c.call(null,a,b)}function Oa(a,b,c){if(a?a.ua:a)return a.ua(a,b,c);var d;d=Oa[m(null==a?null:a)];if(!d&&(d=Oa._,!d))throw x("IAssociative.-assoc",a);return d.call(null,a,b,c)}var Pa={};function Qa(a,b){if(a?a.nb:a)return a.nb(a,b);var c;c=Qa[m(null==a?null:a)];if(!c&&(c=Qa._,!c))throw x("IMap.-dissoc",a);return c.call(null,a,b)}var Sa={};
function Ta(a){if(a?a.$a:a)return a.$a(a);var b;b=Ta[m(null==a?null:a)];if(!b&&(b=Ta._,!b))throw x("IMapEntry.-key",a);return b.call(null,a)}function Ua(a){if(a?a.ab:a)return a.ab(a);var b;b=Ua[m(null==a?null:a)];if(!b&&(b=Ua._,!b))throw x("IMapEntry.-val",a);return b.call(null,a)}var Va={};function Wa(a,b){if(a?a.vb:a)return a.vb(a,b);var c;c=Wa[m(null==a?null:a)];if(!c&&(c=Wa._,!c))throw x("ISet.-disjoin",a);return c.call(null,a,b)}
function Xa(a){if(a?a.Ia:a)return a.Ia(a);var b;b=Xa[m(null==a?null:a)];if(!b&&(b=Xa._,!b))throw x("IStack.-peek",a);return b.call(null,a)}function Ya(a){if(a?a.Ja:a)return a.Ja(a);var b;b=Ya[m(null==a?null:a)];if(!b&&(b=Ya._,!b))throw x("IStack.-pop",a);return b.call(null,a)}var Za={};function $a(a,b,c){if(a?a.Pa:a)return a.Pa(a,b,c);var d;d=$a[m(null==a?null:a)];if(!d&&(d=$a._,!d))throw x("IVector.-assoc-n",a);return d.call(null,a,b,c)}
function ab(a){if(a?a.ub:a)return a.ub(a);var b;b=ab[m(null==a?null:a)];if(!b&&(b=ab._,!b))throw x("IDeref.-deref",a);return b.call(null,a)}var bb={};function cb(a){if(a?a.D:a)return a.D(a);var b;b=cb[m(null==a?null:a)];if(!b&&(b=cb._,!b))throw x("IMeta.-meta",a);return b.call(null,a)}var db={};function eb(a,b){if(a?a.F:a)return a.F(a,b);var c;c=eb[m(null==a?null:a)];if(!c&&(c=eb._,!c))throw x("IWithMeta.-with-meta",a);return c.call(null,a,b)}
var fb={},gb=function(){function a(a,b,c){if(a?a.M:a)return a.M(a,b,c);var h;h=gb[m(null==a?null:a)];if(!h&&(h=gb._,!h))throw x("IReduce.-reduce",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.N:a)return a.N(a,b);var c;c=gb[m(null==a?null:a)];if(!c&&(c=gb._,!c))throw x("IReduce.-reduce",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function hb(a,b,c){if(a?a.Za:a)return a.Za(a,b,c);var d;d=hb[m(null==a?null:a)];if(!d&&(d=hb._,!d))throw x("IKVReduce.-kv-reduce",a);return d.call(null,a,b,c)}function ib(a,b){if(a?a.v:a)return a.v(a,b);var c;c=ib[m(null==a?null:a)];if(!c&&(c=ib._,!c))throw x("IEquiv.-equiv",a);return c.call(null,a,b)}function jb(a){if(a?a.B:a)return a.B(a);var b;b=jb[m(null==a?null:a)];if(!b&&(b=jb._,!b))throw x("IHash.-hash",a);return b.call(null,a)}var kb={};
function lb(a){if(a?a.H:a)return a.H(a);var b;b=lb[m(null==a?null:a)];if(!b&&(b=lb._,!b))throw x("ISeqable.-seq",a);return b.call(null,a)}var mb={},nb={},ob={};function pb(a){if(a?a.Xa:a)return a.Xa(a);var b;b=pb[m(null==a?null:a)];if(!b&&(b=pb._,!b))throw x("IReversible.-rseq",a);return b.call(null,a)}function qb(a,b){if(a?a.yb:a)return a.yb(a,b);var c;c=qb[m(null==a?null:a)];if(!c&&(c=qb._,!c))throw x("ISorted.-sorted-seq",a);return c.call(null,a,b)}
function rb(a,b,c){if(a?a.zb:a)return a.zb(a,b,c);var d;d=rb[m(null==a?null:a)];if(!d&&(d=rb._,!d))throw x("ISorted.-sorted-seq-from",a);return d.call(null,a,b,c)}function sb(a,b){if(a?a.xb:a)return a.xb(a,b);var c;c=sb[m(null==a?null:a)];if(!c&&(c=sb._,!c))throw x("ISorted.-entry-key",a);return c.call(null,a,b)}function tb(a){if(a?a.wb:a)return a.wb(a);var b;b=tb[m(null==a?null:a)];if(!b&&(b=tb._,!b))throw x("ISorted.-comparator",a);return b.call(null,a)}
function ub(a,b){if(a?a.Sb:a)return a.Sb(0,b);var c;c=ub[m(null==a?null:a)];if(!c&&(c=ub._,!c))throw x("IWriter.-write",a);return c.call(null,a,b)}var vb={};function wb(a,b,c){if(a?a.w:a)return a.w(a,b,c);var d;d=wb[m(null==a?null:a)];if(!d&&(d=wb._,!d))throw x("IPrintWithWriter.-pr-writer",a);return d.call(null,a,b,c)}function xb(a,b,c){if(a?a.Rb:a)return a.Rb(0,b,c);var d;d=xb[m(null==a?null:a)];if(!d&&(d=xb._,!d))throw x("IWatchable.-notify-watches",a);return d.call(null,a,b,c)}
function yb(a){if(a?a.Wa:a)return a.Wa(a);var b;b=yb[m(null==a?null:a)];if(!b&&(b=yb._,!b))throw x("IEditableCollection.-as-transient",a);return b.call(null,a)}function zb(a,b){if(a?a.Ka:a)return a.Ka(a,b);var c;c=zb[m(null==a?null:a)];if(!c&&(c=zb._,!c))throw x("ITransientCollection.-conj!",a);return c.call(null,a,b)}function Ab(a){if(a?a.Oa:a)return a.Oa(a);var b;b=Ab[m(null==a?null:a)];if(!b&&(b=Ab._,!b))throw x("ITransientCollection.-persistent!",a);return b.call(null,a)}
function Bb(a,b,c){if(a?a.cb:a)return a.cb(a,b,c);var d;d=Bb[m(null==a?null:a)];if(!d&&(d=Bb._,!d))throw x("ITransientAssociative.-assoc!",a);return d.call(null,a,b,c)}function Cb(a,b){if(a?a.Ab:a)return a.Ab(a,b);var c;c=Cb[m(null==a?null:a)];if(!c&&(c=Cb._,!c))throw x("ITransientMap.-dissoc!",a);return c.call(null,a,b)}function Db(a,b,c){if(a?a.Pb:a)return a.Pb(0,b,c);var d;d=Db[m(null==a?null:a)];if(!d&&(d=Db._,!d))throw x("ITransientVector.-assoc-n!",a);return d.call(null,a,b,c)}
function Eb(a){if(a?a.Qb:a)return a.Qb();var b;b=Eb[m(null==a?null:a)];if(!b&&(b=Eb._,!b))throw x("ITransientVector.-pop!",a);return b.call(null,a)}function Fb(a,b){if(a?a.Ob:a)return a.Ob(0,b);var c;c=Fb[m(null==a?null:a)];if(!c&&(c=Fb._,!c))throw x("ITransientSet.-disjoin!",a);return c.call(null,a,b)}function Gb(a){if(a?a.Kb:a)return a.Kb();var b;b=Gb[m(null==a?null:a)];if(!b&&(b=Gb._,!b))throw x("IChunk.-drop-first",a);return b.call(null,a)}
function Hb(a){if(a?a.sb:a)return a.sb(a);var b;b=Hb[m(null==a?null:a)];if(!b&&(b=Hb._,!b))throw x("IChunkedSeq.-chunked-first",a);return b.call(null,a)}function Ib(a){if(a?a.tb:a)return a.tb(a);var b;b=Ib[m(null==a?null:a)];if(!b&&(b=Ib._,!b))throw x("IChunkedSeq.-chunked-rest",a);return b.call(null,a)}function Jb(a){if(a?a.rb:a)return a.rb(a);var b;b=Jb[m(null==a?null:a)];if(!b&&(b=Jb._,!b))throw x("IChunkedNext.-chunked-next",a);return b.call(null,a)}
function Kb(a){this.vc=a;this.q=0;this.i=1073741824}Kb.prototype.Sb=function(a,b){return this.vc.append(b)};function Lb(a){var b=new ea;a.w(null,new Kb(b),ka());return""+A.b(b)}var Mb="undefined"!==typeof Math.imul&&0!==(Math.imul.a?Math.imul.a(4294967295,5):Math.imul.call(null,4294967295,5))?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function Nb(a){a=Mb(a,3432918353);return Mb(a<<15|a>>>-15,461845907)}
function Ob(a,b){var c=a^b;return Mb(c<<13|c>>>-13,5)+3864292196}function Pb(a,b){var c=a^b,c=Mb(c^c>>>16,2246822507),c=Mb(c^c>>>13,3266489909);return c^c>>>16}var Qb={},Rb=0;function Sb(a){255<Rb&&(Qb={},Rb=0);var b=Qb[a];if("number"!==typeof b){a:if(null!=a)if(b=a.length,0<b){for(var c=0,d=0;;)if(c<b)var e=c+1,d=Mb(31,d)+a.charCodeAt(c),c=e;else{b=d;break a}b=void 0}else b=0;else b=0;Qb[a]=b;Rb+=1}return a=b}
function Tb(a){a&&(a.i&4194304||a.Dc)?a=a.B(null):"number"===typeof a?a=Math.floor(a)%2147483647:!0===a?a=1:!1===a?a=0:"string"===typeof a?(a=Sb(a),0!==a&&(a=Nb(a),a=Ob(0,a),a=Pb(a,4))):a=null==a?0:u?jb(a):null;return a}
function Ub(a){var b;b=a.name;var c;a:{c=1;for(var d=0;;)if(c<b.length){var e=c+2,d=Ob(d,Nb(b.charCodeAt(c-1)|b.charCodeAt(c)<<16));c=e}else{c=d;break a}c=void 0}c=1===(b.length&1)?c^Nb(b.charCodeAt(b.length-1)):c;b=Pb(c,Mb(2,b.length));a=Sb(a.fa);return b^a+2654435769+(b<<6)+(b>>2)}
function Vb(a,b){if(r(Wb.a?Wb.a(a,b):Wb.call(null,a,b)))return 0;var c=sa(a.fa);if(r(c?b.fa:c))return-1;if(r(a.fa)){if(sa(b.fa))return 1;c=Xb.a?Xb.a(a.fa,b.fa):Xb.call(null,a.fa,b.fa);return 0===c?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):c}return Yb?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):null}function Zb(a,b,c,d,e){this.fa=a;this.name=b;this.Na=c;this.Ua=d;this.W=e;this.i=2154168321;this.q=4096}g=Zb.prototype;g.w=function(a,b){return ub(b,this.Na)};
g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)};g.F=function(a,b){return new Zb(this.fa,this.name,this.Na,this.Ua,b)};g.D=function(){return this.W};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(c,this,null);case 3:return La.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(a,this,null)};
g.a=function(a,b){return La.c(a,this,b)};g.v=function(a,b){return b instanceof Zb?this.Na===b.Na:!1};g.toString=function(){return this.Na};var $b=function(){function a(a,b){var c=null!=a?""+A.b(a)+"/"+A.b(b):b;return new Zb(a,b,c,null,null)}function b(a){return a instanceof Zb?a:c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();
function E(a){if(null==a)return null;if(a&&(a.i&8388608||a.hc))return a.H(null);if(a instanceof Array||"string"===typeof a)return 0===a.length?null:new ac(a,0);if(s(kb,a))return lb(a);if(u)throw Error(""+A.b(a)+" is not ISeqable");return null}function F(a){if(null==a)return null;if(a&&(a.i&64||a.bb))return a.Q(null);a=E(a);return null==a?null:Ha(a)}function G(a){return null!=a?a&&(a.i&64||a.bb)?a.S(null):(a=E(a))?Ia(a):H:H}function I(a){return null==a?null:a&&(a.i&128||a.ob)?a.U(null):E(G(a))}
var Wb=function(){function a(a,b){return null==a?null==b:a===b||ib(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(b.a(a,d))if(I(e))a=d,d=F(e),e=I(e);else return b.a(d,F(e));else return!1}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!0;case 2:return a.call(this,b,
e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!0};b.a=a;b.d=c.d;return b}();function bc(a,b){var c=Nb(a),c=Ob(0,c);return Pb(c,b)}function cc(a){var b=0,c=1;for(a=E(a);;)if(null!=a)b+=1,c=Mb(31,c)+Tb(F(a))|0,a=I(a);else return bc(c,b)}function dc(a){var b=0,c=0;for(a=E(a);;)if(null!=a)b+=1,c=c+Tb(F(a))|0,a=I(a);else return bc(c,b)}za["null"]=!0;Aa["null"]=function(){return 0};
Date.prototype.v=function(a,b){return b instanceof Date&&this.toString()===b.toString()};ib.number=function(a,b){return a===b};bb["function"]=!0;cb["function"]=function(){return null};ya["function"]=!0;jb._=function(a){return a[ba]||(a[ba]=++ca)};function ec(a){this.l=a;this.q=0;this.i=32768}ec.prototype.ub=function(){return this.l};function fc(a){return a instanceof ec}
var gc=function(){function a(a,b,c,d){for(var l=Aa(a);;)if(d<l){c=b.a?b.a(c,D.a(a,d)):b.call(null,c,D.a(a,d));if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=Aa(a),l=0;;)if(l<d){c=b.a?b.a(c,D.a(a,l)):b.call(null,c,D.a(a,l));if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=Aa(a);if(0===c)return b.o?b.o():b.call(null);for(var d=D.a(a,0),l=1;;)if(l<c){d=b.a?b.a(d,D.a(a,l)):b.call(null,d,D.a(a,l));if(fc(d))return K.b?K.b(d):K.call(null,
d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),hc=function(){function a(a,b,c,d){for(var l=a.length;;)if(d<l){c=b.a?b.a(c,a[d]):b.call(null,c,a[d]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=a.length,l=0;;)if(l<d){c=b.a?b.a(c,a[l]):b.call(null,c,
a[l]);if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=a.length;if(0===a.length)return b.o?b.o():b.call(null);for(var d=a[0],l=1;;)if(l<c){d=b.a?b.a(d,a[l]):b.call(null,d,a[l]);if(fc(d))return K.b?K.b(d):K.call(null,d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}();
function ic(a){return a?a.i&2||a.Yb?!0:a.i?!1:s(za,a):s(za,a)}function jc(a){return a?a.i&16||a.Lb?!0:a.i?!1:s(Ea,a):s(Ea,a)}function ac(a,b){this.e=a;this.p=b;this.i=166199550;this.q=8192}g=ac.prototype;g.toString=function(){return Lb(this)};g.J=function(a,b){var c=b+this.p;return c<this.e.length?this.e[c]:null};g.aa=function(a,b,c){a=b+this.p;return a<this.e.length?this.e[a]:c};g.U=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):null};g.L=function(){return this.e.length-this.p};
g.Xa=function(){var a=Aa(this);return 0<a?new kc(this,a-1,null):null};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return H};g.N=function(a,b){return hc.n(this.e,b,this.e[this.p],this.p+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.p)};g.Q=function(){return this.e[this.p]};g.S=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):H};g.H=function(){return this};
g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};
var mc=function(){function a(a,b){return b<a.length?new ac(a,b):null}function b(a){return c.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),J=function(){function a(a,b){return mc.a(a,b)}function b(a){return mc.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+
arguments.length);};c.b=b;c.a=a;return c}();function kc(a,b,c){this.jb=a;this.p=b;this.j=c;this.i=32374990;this.q=8192}g=kc.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 0<this.p?new kc(this.jb,this.p-1,null):null};g.L=function(){return this.p+1};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return N.a?N.a(H,this.j):N.call(null,H,this.j)};
g.N=function(a,b){return nc.a?nc.a(b,this):nc.call(null,b,this)};g.M=function(a,b,c){return nc.c?nc.c(b,c,this):nc.call(null,b,c,this)};g.Q=function(){return D.a(this.jb,this.p)};g.S=function(){return 0<this.p?new kc(this.jb,this.p-1,null):H};g.H=function(){return this};g.F=function(a,b){return new kc(this.jb,this.p,b)};g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};function oc(a){for(;;){var b=I(a);if(null!=b)a=b;else return F(a)}}ib._=function(a,b){return a===b};
var pc=function(){function a(a,b){return null!=a?Da(a,b):Da(H,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(r(e))a=b.a(a,d),d=F(e),e=I(e);else return b.a(a,d)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+
arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function qc(a){return null==a?null:Ba(a)}function O(a){if(null!=a)if(a&&(a.i&2||a.Yb))a=a.L(null);else if(a instanceof Array)a=a.length;else if("string"===typeof a)a=a.length;else if(s(za,a))a=Aa(a);else if(u)a:{a=E(a);for(var b=0;;){if(ic(a)){a=b+Aa(a);break a}a=I(a);b+=1}a=void 0}else a=null;else a=0;return a}
var rc=function(){function a(a,b,c){for(;;){if(null==a)return c;if(0===b)return E(a)?F(a):c;if(jc(a))return D.c(a,b,c);if(E(a))a=I(a),b-=1;else return u?c:null}}function b(a,b){for(;;){if(null==a)throw Error("Index out of bounds");if(0===b){if(E(a))return F(a);throw Error("Index out of bounds");}if(jc(a))return D.a(a,b);if(E(a)){var c=I(a),h=b-1;a=c;b=h}else{if(u)throw Error("Index out of bounds");return null}}}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),P=function(){function a(a,b,c){if("number"!==typeof b)throw Error("index argument to nth must be a number.");if(null==a)return c;if(a&&(a.i&16||a.Lb))return a.aa(null,b,c);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:c;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.c(a,b,c);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}function b(a,
b){if("number"!==typeof b)throw Error("index argument to nth must be a number");if(null==a)return a;if(a&&(a.i&16||a.Lb))return a.J(null,b);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:null;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.a(a,b);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.a=b;c.c=a;return c}(),Q=function(){function a(a,b,c){return null!=a?a&&(a.i&256||a.Mb)?a.C(null,b,c):a instanceof Array?b<a.length?a[b]:c:"string"===typeof a?b<a.length?a[b]:c:s(Ka,a)?La.c(a,b,c):u?c:null:c}function b(a,b){return null==a?null:a&&(a.i&256||a.Mb)?a.u(null,b):a instanceof Array?b<a.length?a[b]:null:"string"===typeof a?b<a.length?a[b]:null:s(Ka,a)?La.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),R=function(){function a(a,b,c){return null!=a?Oa(a,b,c):sc.a?sc.a([b],[c]):sc.call(null,[b],[c])}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){for(;;)if(a=b.c(a,d,e),r(l))d=F(l),e=F(I(l)),l=I(I(l));else return a}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,
d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.c=a;b.d=c.d;return b}(),tc=function(){function a(a,b){return null==a?null:Qa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);
if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function uc(a){var b="function"==m(a);return b?b:a?r(r(null)?null:a.Xb)?!0:a.Cb?!1:s(ya,a):s(ya,a)}
function vc(a,b){this.h=a;this.j=b;this.q=0;this.i=393217}g=vc.prototype;
g.call=function(){var a=null;return a=function(a,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc){switch(arguments.length){case 1:var z=a,z=this;return z.h.o?z.h.o():z.h.call(null);case 2:return z=a,z=this,z.h.b?z.h.b(c):z.h.call(null,c);case 3:return z=a,z=this,z.h.a?z.h.a(c,d):z.h.call(null,c,d);case 4:return z=a,z=this,z.h.c?z.h.c(c,d,e):z.h.call(null,c,d,e);case 5:return z=a,z=this,z.h.n?z.h.n(c,d,e,f):z.h.call(null,c,d,e,f);case 6:return z=a,z=this,z.h.s?z.h.s(c,d,e,f,h):z.h.call(null,c,d,e,f,
h);case 7:return z=a,z=this,z.h.X?z.h.X(c,d,e,f,h,k):z.h.call(null,c,d,e,f,h,k);case 8:return z=a,z=this,z.h.ga?z.h.ga(c,d,e,f,h,k,l):z.h.call(null,c,d,e,f,h,k,l);case 9:return z=a,z=this,z.h.Ga?z.h.Ga(c,d,e,f,h,k,l,n):z.h.call(null,c,d,e,f,h,k,l,n);case 10:return z=a,z=this,z.h.Ha?z.h.Ha(c,d,e,f,h,k,l,n,q):z.h.call(null,c,d,e,f,h,k,l,n,q);case 11:return z=a,z=this,z.h.va?z.h.va(c,d,e,f,h,k,l,n,q,t):z.h.call(null,c,d,e,f,h,k,l,n,q,t);case 12:return z=a,z=this,z.h.wa?z.h.wa(c,d,e,f,h,k,l,n,q,t,v):
z.h.call(null,c,d,e,f,h,k,l,n,q,t,v);case 13:return z=a,z=this,z.h.xa?z.h.xa(c,d,e,f,h,k,l,n,q,t,v,w):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w);case 14:return z=a,z=this,z.h.ya?z.h.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y);case 15:return z=a,z=this,z.h.za?z.h.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);case 16:return z=a,z=this,z.h.Aa?z.h.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);case 17:return z=a,z=this,
z.h.Ba?z.h.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);case 18:return z=a,z=this,z.h.Ca?z.h.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);case 19:return z=a,z=this,z.h.Da?z.h.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);case 20:return z=a,z=this,z.h.Ea?z.h.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);case 21:return z=
a,z=this,z.h.Fa?z.h.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra);case 22:return z=a,z=this,S.bc?S.bc(z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc):S.call(null,z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.o=function(){return this.h.o?this.h.o():this.h.call(null)};
g.b=function(a){return this.h.b?this.h.b(a):this.h.call(null,a)};g.a=function(a,b){return this.h.a?this.h.a(a,b):this.h.call(null,a,b)};g.c=function(a,b,c){return this.h.c?this.h.c(a,b,c):this.h.call(null,a,b,c)};g.n=function(a,b,c,d){return this.h.n?this.h.n(a,b,c,d):this.h.call(null,a,b,c,d)};g.s=function(a,b,c,d,e){return this.h.s?this.h.s(a,b,c,d,e):this.h.call(null,a,b,c,d,e)};g.X=function(a,b,c,d,e,f){return this.h.X?this.h.X(a,b,c,d,e,f):this.h.call(null,a,b,c,d,e,f)};
g.ga=function(a,b,c,d,e,f,h){return this.h.ga?this.h.ga(a,b,c,d,e,f,h):this.h.call(null,a,b,c,d,e,f,h)};g.Ga=function(a,b,c,d,e,f,h,k){return this.h.Ga?this.h.Ga(a,b,c,d,e,f,h,k):this.h.call(null,a,b,c,d,e,f,h,k)};g.Ha=function(a,b,c,d,e,f,h,k,l){return this.h.Ha?this.h.Ha(a,b,c,d,e,f,h,k,l):this.h.call(null,a,b,c,d,e,f,h,k,l)};g.va=function(a,b,c,d,e,f,h,k,l,n){return this.h.va?this.h.va(a,b,c,d,e,f,h,k,l,n):this.h.call(null,a,b,c,d,e,f,h,k,l,n)};
g.wa=function(a,b,c,d,e,f,h,k,l,n,q){return this.h.wa?this.h.wa(a,b,c,d,e,f,h,k,l,n,q):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q)};g.xa=function(a,b,c,d,e,f,h,k,l,n,q,t){return this.h.xa?this.h.xa(a,b,c,d,e,f,h,k,l,n,q,t):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t)};g.ya=function(a,b,c,d,e,f,h,k,l,n,q,t,v){return this.h.ya?this.h.ya(a,b,c,d,e,f,h,k,l,n,q,t,v):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v)};
g.za=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w){return this.h.za?this.h.za(a,b,c,d,e,f,h,k,l,n,q,t,v,w):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w)};g.Aa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y){return this.h.Aa?this.h.Aa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y)};g.Ba=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B){return this.h.Ba?this.h.Ba(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B)};
g.Ca=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L){return this.h.Ca?this.h.Ca(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L)};g.Da=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U){return this.h.Da?this.h.Da(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U)};
g.Ea=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z){return this.h.Ea?this.h.Ea(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z)};g.Fa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na){return this.h.Fa?this.h.Fa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na)};g.Xb=!0;g.F=function(a,b){return new vc(this.h,b)};g.D=function(){return this.j};
function N(a,b){return uc(a)&&!(a?a.i&262144||a.oc||(a.i?0:s(db,a)):s(db,a))?new vc(a,b):null==a?null:eb(a,b)}function xc(a){var b=null!=a;return(b?a?a.i&131072||a.ec||(a.i?0:s(bb,a)):s(bb,a):b)?cb(a):null}function yc(a){return null==a?null:Xa(a)}function zc(a){return null==a?null:Ya(a)}
var Ac=function(){function a(a,b){return null==a?null:Wa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Bc(a){return null==a||sa(E(a))}function Cc(a){return null==a?!1:a?a.i&8||a.Ac?!0:a.i?!1:s(Ca,a):s(Ca,a)}function Dc(a){return null==a?!1:a?a.i&4096||a.jc?!0:a.i?!1:s(Va,a):s(Va,a)}function Ec(a){return a?a.i&512||a.yc?!0:a.i?!1:s(Ma,a):s(Ma,a)}function Fc(a){return a?a.i&16777216||a.ic?!0:a.i?!1:s(mb,a):s(mb,a)}
function Gc(a){return null==a?!1:a?a.i&1024||a.cc?!0:a.i?!1:s(Pa,a):s(Pa,a)}function Hc(a){return a?a.i&16384||a.Gc?!0:a.i?!1:s(Za,a):s(Za,a)}function Ic(a){return a?a.q&512||a.zc?!0:!1:!1}function Jc(a){var b=[];da(a,function(a){return function(b,e){return a.push(e)}}(b));return b}function Kc(a,b,c,d,e){for(;0!==e;)c[d]=a[b],d+=1,e-=1,b+=1}var Lc={};function Mc(a){return null==a?!1:a?a.i&64||a.bb?!0:a.i?!1:s(Fa,a):s(Fa,a)}function Nc(a){return r(a)?!0:!1}
function Oc(a,b){return Q.c(a,b,Lc)===Lc?!1:!0}function Xb(a,b){if(a===b)return 0;if(null==a)return-1;if(null==b)return 1;if(ta(a)===ta(b))return a&&(a.q&2048||a.lb)?a.mb(null,b):ga(a,b);if(u)throw Error("compare on non-nil objects of different types");return null}
var Pc=function(){function a(a,b,c,h){for(;;){var k=Xb(P.a(a,h),P.a(b,h));if(0===k&&h+1<c)h+=1;else return k}}function b(a,b){var f=O(a),h=O(b);return f<h?-1:f>h?1:u?c.n(a,b,f,0):null}var c=null,c=function(c,e,f,h){switch(arguments.length){case 2:return b.call(this,c,e);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.n=a;return c}();
function Qc(a){return Wb.a(a,Xb)?Xb:function(b,c){var d=a.a?a.a(b,c):a.call(null,b,c);return"number"===typeof d?d:r(d)?-1:r(a.a?a.a(c,b):a.call(null,c,b))?1:0}}
var Sc=function(){function a(a,b){if(E(b)){var c=Rc.b?Rc.b(b):Rc.call(null,b);ha(c,Qc(a));return E(c)}return H}function b(a){return c.a(Xb,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Tc=function(){function a(a,b,c){return Sc.a(function(c,f){return Qc(b).call(null,a.b?a.b(c):a.call(null,c),a.b?a.b(f):a.call(null,f))},c)}function b(a,b){return c.c(a,Xb,b)}
var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),nc=function(){function a(a,b,c){for(c=E(c);;)if(c){b=a.a?a.a(b,F(c)):a.call(null,b,F(c));if(fc(b))return K.b?K.b(b):K.call(null,b);c=I(c)}else return b}function b(a,b){var c=E(b);return c?C.c?C.c(a,F(c),I(c)):C.call(null,a,F(c),I(c)):a.o?a.o():a.call(null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),C=function(){function a(a,b,c){return c&&(c.i&524288||c.Nb)?c.M(null,a,b):c instanceof Array?hc.c(c,a,b):"string"===typeof c?hc.c(c,a,b):s(fb,c)?gb.c(c,a,b):u?nc.c(a,b,c):null}function b(a,b){return b&&(b.i&524288||b.Nb)?b.N(null,a):b instanceof Array?hc.a(b,a):"string"===typeof b?hc.a(b,a):s(fb,b)?gb.a(b,a):u?nc.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),Uc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>c)if(I(d))a=c,c=F(d),d=I(d);else return c>F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;
case 2:return a>d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>b};a.d=b.d;return a}(),Vc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>=c)if(I(d))a=c,c=F(d),d=I(d);else return c>=F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);
a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;case 2:return a>=d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>=b};a.d=b.d;return a}();function Wc(a){return a-1}
var Xc=function(){function a(a,b){return a>b?a:b}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a>d?a:d,e)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);
};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Yc(a){a=(a-a%2)/2;return 0<=a?Math.floor.b?Math.floor.b(a):Math.floor.call(null,a):Math.ceil.b?Math.ceil.b(a):Math.ceil.call(null,a)}function Zc(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}function $c(a){var b=1;for(a=E(a);;)if(a&&0<b)b-=1,a=I(a);else return a}
var A=function(){function a(a){return null==a?"":a.toString()}var b=null,c=function(){function a(b,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return c.call(this,b,k)}function c(a,d){for(var e=new ea(b.b(a)),l=d;;)if(r(l))e=e.append(b.b(F(l))),l=I(l);else return e.toString()}a.k=1;a.f=function(a){var b=F(a);a=G(a);return c(b,a)};a.d=c;return a}(),b=function(b,e){switch(arguments.length){case 0:return"";case 1:return a.call(this,b);default:return c.d(b,J(arguments,
1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.o=function(){return""};b.b=a;b.d=c.d;return b}(),ad=function(){var a=null,a=function(a,c,d){switch(arguments.length){case 2:return a.substring(c);case 3:return a.substring(c,d)}throw Error("Invalid arity: "+arguments.length);};a.a=function(a,c){return a.substring(c)};a.c=function(a,c,d){return a.substring(c,d)};return a}();
function lc(a,b){return Nc(Fc(b)?function(){for(var c=E(a),d=E(b);;){if(null==c)return null==d;if(null==d)return!1;if(Wb.a(F(c),F(d)))c=I(c),d=I(d);else return u?!1:null}}():null)}function bd(a,b,c,d,e){this.j=a;this.first=b;this.ta=c;this.count=d;this.m=e;this.i=65937646;this.q=8192}g=bd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 1===this.count?null:this.ta};g.L=function(){return this.count};g.Ia=function(){return this.first};g.Ja=function(){return Ia(this)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return H};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return 1===this.count?H:this.ta};g.H=function(){return this};g.F=function(a,b){return new bd(b,this.first,this.ta,this.count,this.m)};g.G=function(a,b){return new bd(this.j,b,this,this.count+1,null)};
function cd(a){this.j=a;this.i=65937614;this.q=8192}g=cd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null};g.L=function(){return 0};g.Ia=function(){return null};g.Ja=function(){throw Error("Can't pop empty list");};g.B=function(){return 0};g.v=function(a,b){return lc(this,b)};g.I=function(){return this};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null};g.S=function(){return H};
g.H=function(){return null};g.F=function(a,b){return new cd(b)};g.G=function(a,b){return new bd(this.j,b,null,1,null)};var H=new cd(null);function dd(a){return a?a.i&134217728||a.Fc?!0:a.i?!1:s(ob,a):s(ob,a)}function ed(a){return dd(a)?pb(a):C.c(pc,H,a)}
var fd=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b;if(a instanceof ac&&0===a.p)b=a.e;else a:{for(b=[];;)if(null!=a)b.push(a.Q(null)),a=a.U(null);else break a;b=void 0}a=b.length;for(var e=H;;)if(0<a){var f=a-1,e=e.G(null,b[a-1]);a=f}else return e}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function gd(a,b,c,d){this.j=a;this.first=b;this.ta=c;this.m=d;this.i=65929452;this.q=8192}
g=gd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null==this.ta?null:E(this.ta)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return null==this.ta?H:this.ta};g.H=function(){return this};
g.F=function(a,b){return new gd(b,this.first,this.ta,this.m)};g.G=function(a,b){return new gd(null,b,this,this.m)};function M(a,b){var c=null==b;return(c?c:b&&(b.i&64||b.bb))?new gd(null,a,b,null):new gd(null,a,E(b),null)}function T(a,b,c,d){this.fa=a;this.name=b;this.sa=c;this.Ua=d;this.i=2153775105;this.q=4096}g=T.prototype;g.w=function(a,b){return ub(b,":"+A.b(this.sa))};g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)+2654435769};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return Q.a(c,this);case 3:return Q.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return Q.a(a,this)};g.a=function(a,b){return Q.c(a,this,b)};g.v=function(a,b){return b instanceof T?this.sa===b.sa:!1};g.toString=function(){return":"+A.b(this.sa)};
function hd(a,b){return a===b?!0:a instanceof T&&b instanceof T?a.sa===b.sa:!1}
var jd=function(){function a(a,b){return new T(a,b,""+A.b(r(a)?""+A.b(a)+"/":null)+A.b(b),null)}function b(a){if(a instanceof T)return a;if(a instanceof Zb){var b;if(a&&(a.q&4096||a.fc))b=a.fa;else throw Error("Doesn't support namespace: "+A.b(a));return new T(b,id.b?id.b(a):id.call(null,a),a.Na,null)}return"string"===typeof a?(b=a.split("/"),2===b.length?new T(b[0],b[1],a,null):new T(null,b[0],a,null)):null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,
c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();function V(a,b,c,d){this.j=a;this.Ya=b;this.r=c;this.m=d;this.q=0;this.i=32374988}g=V.prototype;g.toString=function(){return Lb(this)};function kd(a){null!=a.Ya&&(a.r=a.Ya.o?a.Ya.o():a.Ya.call(null),a.Ya=null);return a.r}g.D=function(){return this.j};g.U=function(){lb(this);return null==this.r?null:I(this.r)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};
g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){lb(this);return null==this.r?null:F(this.r)};g.S=function(){lb(this);return null!=this.r?G(this.r):H};g.H=function(){kd(this);if(null==this.r)return null;for(var a=this.r;;)if(a instanceof V)a=kd(a);else return this.r=a,E(this.r)};g.F=function(a,b){return new V(b,this.Ya,this.r,this.m)};g.G=function(a,b){return M(b,this)};
function ld(a,b){this.qb=a;this.end=b;this.q=0;this.i=2}ld.prototype.L=function(){return this.end};ld.prototype.add=function(a){this.qb[this.end]=a;return this.end+=1};ld.prototype.da=function(){var a=new md(this.qb,0,this.end);this.qb=null;return a};function md(a,b,c){this.e=a;this.O=b;this.end=c;this.q=0;this.i=524306}g=md.prototype;g.N=function(a,b){return hc.n(this.e,b,this.e[this.O],this.O+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.O)};
g.Kb=function(){if(this.O===this.end)throw Error("-drop-first of empty chunk");return new md(this.e,this.O+1,this.end)};g.J=function(a,b){return this.e[this.O+b]};g.aa=function(a,b,c){return 0<=b&&b<this.end-this.O?this.e[this.O+b]:c};g.L=function(){return this.end-this.O};
var nd=function(){function a(a,b,c){return new md(a,b,c)}function b(a,b){return new md(a,b,a.length)}function c(a){return new md(a,0,a.length)}var d=null,d=function(d,f,h){switch(arguments.length){case 1:return c.call(this,d);case 2:return b.call(this,d,f);case 3:return a.call(this,d,f,h)}throw Error("Invalid arity: "+arguments.length);};d.b=c;d.a=b;d.c=a;return d}();function od(a,b,c,d){this.da=a;this.oa=b;this.j=c;this.m=d;this.i=31850732;this.q=1536}g=od.prototype;g.toString=function(){return Lb(this)};
g.D=function(){return this.j};g.U=function(){if(1<Aa(this.da))return new od(Gb(this.da),this.oa,this.j,null);var a=lb(this.oa);return null==a?null:a};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return D.a(this.da,0)};g.S=function(){return 1<Aa(this.da)?new od(Gb(this.da),this.oa,this.j,null):null==this.oa?H:this.oa};g.H=function(){return this};g.sb=function(){return this.da};
g.tb=function(){return null==this.oa?H:this.oa};g.F=function(a,b){return new od(this.da,this.oa,b,this.m)};g.G=function(a,b){return M(b,this)};g.rb=function(){return null==this.oa?null:this.oa};function pd(a,b){return 0===Aa(a)?b:new od(a,b,null,null)}function Rc(a){for(var b=[];;)if(E(a))b.push(F(a)),a=I(a);else return b}function qd(a,b){if(ic(a))return O(a);for(var c=a,d=b,e=0;;)if(0<d&&E(c))c=I(c),d-=1,e+=1;else return e}
var sd=function rd(b){return null==b?null:null==I(b)?E(F(b)):u?M(F(b),rd(I(b))):null},td=function(){function a(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),d.a(Ib(c),b)):M(F(c),d.a(G(c),b)):b},null,null)}function b(a){return new V(null,function(){return a},null,null)}function c(){return new V(null,function(){return null},null,null)}var d=null,e=function(){function a(c,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,
d,f)}function b(a,c,e){return function t(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),t(Ib(c),b)):M(F(c),t(G(c),b)):r(b)?t(F(b),I(b)):null},null,null)}(d.a(a,c),e)}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),d=function(d,h,k){switch(arguments.length){case 0:return c.call(this);case 1:return b.call(this,d);case 2:return a.call(this,d,h);default:return e.d(d,h,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};d.k=
2;d.f=e.f;d.o=c;d.b=b;d.a=a;d.d=e.d;return d}(),ud=function(){function a(a,b,c,d){return M(a,M(b,M(c,d)))}function b(a,b,c){return M(a,M(b,c))}var c=null,d=function(){function a(c,d,e,n,q){var t=null;4<arguments.length&&(t=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,n,t)}function b(a,c,d,e,f){return M(a,M(c,M(d,M(e,sd(f)))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var q=F(a);a=G(a);return b(c,d,e,q,a)};a.d=b;return a}(),c=function(c,f,
h,k,l){switch(arguments.length){case 1:return E(c);case 2:return M(c,f);case 3:return b.call(this,c,f,h);case 4:return a.call(this,c,f,h,k);default:return d.d(c,f,h,k,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};c.k=4;c.f=d.f;c.b=function(a){return E(a)};c.a=function(a,b){return M(a,b)};c.c=b;c.n=a;c.d=d.d;return c}();function vd(a){return Ab(a)}
var wd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=zb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return zb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=
function(a,b){return zb(a,b)};a.d=b.d;return a}(),xd=function(){var a=null,b=function(){function a(c,f,h,k){var l=null;3<arguments.length&&(l=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,f,h,l)}function b(a,c,d,k){for(;;)if(a=Bb(a,c,d),r(k))c=F(k),d=F(I(k)),k=I(I(k));else return a}a.k=3;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=I(a);var k=F(a);a=G(a);return b(c,h,k,a)};a.d=b;return a}(),a=function(a,d,e,f){switch(arguments.length){case 3:return Bb(a,d,e);default:return b.d(a,
d,e,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};a.k=3;a.f=b.f;a.c=function(a,b,e){return Bb(a,b,e)};a.d=b.d;return a}(),yd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Cb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return Cb(a,
d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Cb(a,b)};a.d=b.d;return a}(),zd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Fb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,
e){switch(arguments.length){case 2:return Fb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Fb(a,b)};a.d=b.d;return a}();
function Ad(a,b,c){var d=E(c);if(0===b)return a.o?a.o():a.call(null);c=Ha(d);var e=Ia(d);if(1===b)return a.b?a.b(c):a.b?a.b(c):a.call(null,c);var d=Ha(e),f=Ia(e);if(2===b)return a.a?a.a(c,d):a.a?a.a(c,d):a.call(null,c,d);var e=Ha(f),h=Ia(f);if(3===b)return a.c?a.c(c,d,e):a.c?a.c(c,d,e):a.call(null,c,d,e);var f=Ha(h),k=Ia(h);if(4===b)return a.n?a.n(c,d,e,f):a.n?a.n(c,d,e,f):a.call(null,c,d,e,f);var h=Ha(k),l=Ia(k);if(5===b)return a.s?a.s(c,d,e,f,h):a.s?a.s(c,d,e,f,h):a.call(null,c,d,e,f,h);var k=Ha(l),
n=Ia(l);if(6===b)return a.X?a.X(c,d,e,f,h,k):a.X?a.X(c,d,e,f,h,k):a.call(null,c,d,e,f,h,k);var l=Ha(n),q=Ia(n);if(7===b)return a.ga?a.ga(c,d,e,f,h,k,l):a.ga?a.ga(c,d,e,f,h,k,l):a.call(null,c,d,e,f,h,k,l);var n=Ha(q),t=Ia(q);if(8===b)return a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.call(null,c,d,e,f,h,k,l,n);var q=Ha(t),v=Ia(t);if(9===b)return a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.call(null,c,d,e,f,h,k,l,n,q);var t=Ha(v),w=Ia(v);if(10===b)return a.va?a.va(c,d,e,
f,h,k,l,n,q,t):a.va?a.va(c,d,e,f,h,k,l,n,q,t):a.call(null,c,d,e,f,h,k,l,n,q,t);var v=Ha(w),y=Ia(w);if(11===b)return a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.call(null,c,d,e,f,h,k,l,n,q,t,v);var w=Ha(y),B=Ia(y);if(12===b)return a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w);var y=Ha(B),L=Ia(B);if(13===b)return a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.call(null,c,d,e,f,h,k,l,n,q,
t,v,w,y);var B=Ha(L),U=Ia(L);if(14===b)return a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);var L=Ha(U),Z=Ia(U);if(15===b)return a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);var U=Ha(Z),na=Ia(Z);if(16===b)return a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);var Z=
Ha(na),Ga=Ia(na);if(17===b)return a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);var na=Ha(Ga),Ra=Ia(Ga);if(18===b)return a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);Ga=Ha(Ra);Ra=Ia(Ra);if(19===b)return a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.call(null,
c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);var wc=Ha(Ra);Ia(Ra);if(20===b)return a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc);throw Error("Only up to 20 arguments supported on functions");}
var S=function(){function a(a,b,c,d,e){b=ud.n(b,c,d,e);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function b(a,b,c,d){b=ud.c(b,c,d);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function c(a,b,c){b=ud.a(b,c);c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}function d(a,b){var c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}var e=null,f=function(){function a(c,d,e,f,h,w){var y=null;
5<arguments.length&&(y=J(Array.prototype.slice.call(arguments,5),0));return b.call(this,c,d,e,f,h,y)}function b(a,c,d,e,f,h){c=M(c,M(d,M(e,M(f,sd(h)))));d=a.k;return a.f?(e=qd(c,d+1),e<=d?Ad(a,e,c):a.f(c)):a.apply(a,Rc(c))}a.k=5;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=G(a);return b(c,d,e,f,h,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t){switch(arguments.length){case 2:return d.call(this,e,k);case 3:return c.call(this,e,k,l);case 4:return b.call(this,
e,k,l,n);case 5:return a.call(this,e,k,l,n,q);default:return f.d(e,k,l,n,q,J(arguments,5))}throw Error("Invalid arity: "+arguments.length);};e.k=5;e.f=f.f;e.a=d;e.c=c;e.n=b;e.s=a;e.d=f.d;return e}(),Bd=function(){function a(a,b){return!Wb.a(a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return sa(S.n(Wb,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,
d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!1;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!1};b.a=a;b.d=c.d;return b}();function Cd(a){return E(a)?a:null}function Dd(a,b){for(;;){if(null==E(b))return!0;if(r(a.b?a.b(F(b)):a.call(null,F(b)))){var c=a,d=I(b);a=c;b=d}else return u?!1:null}}
function Ed(a,b){for(;;)if(E(b)){var c=a.b?a.b(F(b)):a.call(null,F(b));if(r(c))return c;var c=a,d=I(b);a=c;b=d}else return null}function Fd(a){return a}
function Gd(a){return function(){var b=null,c=function(){function b(a,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,a,d,l)}function c(b,d,e){return sa(S.n(a,b,d,e))}b.k=2;b.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};b.d=c;return b}(),b=function(b,e,f){switch(arguments.length){case 0:return sa(a.o?a.o():a.call(null));case 1:var h=b;return sa(a.b?a.b(h):a.call(null,h));case 2:var h=b,k=e;return sa(a.a?a.a(h,k):a.call(null,
h,k));default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;return b}()}
var Hd=function(){function a(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return a.b?a.b(b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q))):a.call(null,b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q)))}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 0:return a.b?
a.b(b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null))):a.call(null,b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null)));case 1:var w=d;return a.b?a.b(b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w))):a.call(null,b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w)));case 2:var w=d,y=k;return a.b?a.b(b.b?b.b(c.a?c.a(w,y):c.call(null,w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y))):a.call(null,b.b?b.b(c.a?c.a(w,y):c.call(null,
w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y)));case 3:var w=d,y=k,B=t;return a.b?a.b(b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B))):a.call(null,b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B)));default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function b(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&
(h=J(Array.prototype.slice.call(arguments,3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return a.b?a.b(S.s(b,c,h,k,l)):a.call(null,S.s(b,c,h,k,l))}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 0:return a.b?a.b(b.o?b.o():b.call(null)):a.call(null,b.o?b.o():b.call(null));case 1:var v=c;return a.b?a.b(b.b?b.b(v):b.call(null,v)):a.call(null,b.b?b.b(v):b.call(null,v));case 2:var v=
c,w=h;return a.b?a.b(b.a?b.a(v,w):b.call(null,v,w)):a.call(null,b.a?b.a(v,w):b.call(null,v,w));case 3:var v=c,w=h,y=q;return a.b?a.b(b.c?b.c(v,w,y):b.call(null,v,w,y)):a.call(null,b.c?b.c(v,w,y):b.call(null,v,w,y));default:return d.d(c,h,q,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var c=null,d=function(){function a(c,d,e,n){var q=null;3<arguments.length&&(q=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,d,e,q)}function b(a,c,d,
e){return function(a){return function(){function b(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return c.call(this,d)}function c(b){b=S.a(F(a),b);for(var d=I(a);;)if(d)b=F(d).call(null,b),d=I(d);else return b}b.k=0;b.f=function(a){a=E(a);return c(a)};b.d=c;return b}()}(ed(ud.n(a,c,d,e)))}a.k=3;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=G(a);return b(c,d,e,a)};a.d=b;return a}(),c=function(c,f,h,k){switch(arguments.length){case 0:return Fd;
case 1:return c;case 2:return b.call(this,c,f);case 3:return a.call(this,c,f,h);default:return d.d(c,f,h,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;c.o=function(){return Fd};c.b=function(a){return a};c.a=b;c.c=a;c.d=d.d;return c}(),Id=function(){function a(a,b,c,d){return function(){function e(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return q.call(this,b)}function q(e){return S.s(a,b,c,d,e)}e.k=0;e.f=function(a){a=E(a);
return q(a)};e.d=q;return e}()}function b(a,b,c){return function(){function d(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,b)}function e(d){return S.n(a,b,c,d)}d.k=0;d.f=function(a){a=E(a);return e(a)};d.d=e;return d}()}function c(a,b){return function(){function c(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return d.call(this,b)}function d(c){return S.c(a,b,c)}c.k=0;c.f=function(a){a=E(a);return d(a)};
c.d=d;return c}()}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return h.call(this,c)}function h(b){return S.s(a,c,d,e,td.a(f,b))}b.k=0;b.f=function(a){a=E(a);return h(a)};b.d=h;return b}()}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);
a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 1:return d;case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.b=function(a){return a};d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Jd=function(){function a(a,b,c,d){return function(){var l=null,n=function(){function l(a,b,c,d){var e=null;
3<arguments.length&&(e=J(Array.prototype.slice.call(arguments,3),0));return n.call(this,a,b,c,e)}function n(l,q,t,B){return S.s(a,null==l?b:l,null==q?c:q,null==t?d:t,B)}l.k=3;l.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return n(b,c,d,a)};l.d=n;return l}(),l=function(l,t,v,w){switch(arguments.length){case 2:var y=l,B=t;return a.a?a.a(null==y?b:y,null==B?c:B):a.call(null,null==y?b:y,null==B?c:B);case 3:var y=l,B=t,L=v;return a.c?a.c(null==y?b:y,null==B?c:B,null==L?d:L):a.call(null,
null==y?b:y,null==B?c:B,null==L?d:L);default:return n.d(l,t,v,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};l.k=3;l.f=n.f;return l}()}function b(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return S.s(a,null==d?b:d,null==l?c:l,n,q)}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=
k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 2:var w=d,y=k;return a.a?a.a(null==w?b:w,null==y?c:y):a.call(null,null==w?b:w,null==y?c:y);case 3:var w=d,y=k,B=t;return a.c?a.c(null==w?b:w,null==y?c:y,B):a.call(null,null==w?b:w,null==y?c:y,B);default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function c(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&(h=J(Array.prototype.slice.call(arguments,
3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return S.s(a,null==c?b:c,h,k,l)}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 1:var v=c;return a.b?a.b(null==v?b:v):a.call(null,null==v?b:v);case 2:var v=c,w=h;return a.a?a.a(null==v?b:v,w):a.call(null,null==v?b:v,w);case 3:var v=c,w=h,y=q;return a.c?a.c(null==v?b:v,w,y):a.call(null,null==v?b:v,w,y);default:return d.d(c,h,q,J(arguments,
3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),Kd=function(){function a(a,b,c,e){return new V(null,function(){var n=E(b),q=E(c),t=E(e);return n&&q&&t?M(a.c?a.c(F(n),F(q),F(t)):a.call(null,F(n),F(q),F(t)),d.n(a,G(n),G(q),G(t))):null},
null,null)}function b(a,b,c){return new V(null,function(){var e=E(b),n=E(c);return e&&n?M(a.a?a.a(F(e),F(n)):a.call(null,F(e),F(n)),d.c(a,G(e),G(n))):null},null,null)}function c(a,b){return new V(null,function(){var c=E(b);if(c){if(Ic(c)){for(var e=Hb(c),n=O(e),q=new ld(Array(n),0),t=0;;)if(t<n){var v=a.b?a.b(D.a(e,t)):a.call(null,D.a(e,t));q.add(v);t+=1}else break;return pd(q.da(),d.a(a,Ib(c)))}return M(a.b?a.b(F(c)):a.call(null,F(c)),d.a(a,G(c)))}return null},null,null)}var d=null,e=function(){function a(c,
d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,e,f,h){var v=function y(a){return new V(null,function(){var b=d.a(E,a);return Dd(Fd,b)?M(d.a(F,b),y(d.a(G,b))):null},null,null)};return d.a(function(){return function(b){return S.a(a,b)}}(v),v(pc.d(h,f,J([e,c],0))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,
n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Md=function Ld(b,c){return new V(null,function(){if(0<b){var d=E(c);return d?M(F(d),Ld(b-1,G(d))):null}return null},null,null)};
function Nd(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b);if(0<a&&e){var f=a-1,e=G(e);a=f;b=e}else return e}}),null,null)}
var Od=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a,c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Pd=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a.o?a.o():a.call(null),c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Qd=function(){function a(a,c){return new V(null,function(){var f=E(a),h=E(c);return f&&h?M(F(f),M(F(h),b.a(G(f),G(h)))):null},null,null)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return new V(null,function(){var c=Kd.a(E,pc.d(e,d,J([a],0)));return Dd(Fd,c)?td.a(Kd.a(F,
c),S.a(b,Kd.a(G,c))):null},null,null)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function Rd(a){return function c(a,e){return new V(null,function(){var f=E(a);return f?M(F(f),c(G(f),e)):E(e)?c(F(e),G(e)):null},null,null)}(null,a)}
var Sd=function(){function a(a,b){return Rd(Kd.a(a,b))}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return Rd(S.n(Kd,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};
b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}(),Ud=function Td(b,c){return new V(null,function(){var d=E(c);if(d){if(Ic(d)){for(var e=Hb(d),f=O(e),h=new ld(Array(f),0),k=0;;)if(k<f){if(r(b.b?b.b(D.a(e,k)):b.call(null,D.a(e,k)))){var l=D.a(e,k);h.add(l)}k+=1}else break;return pd(h.da(),Td(b,Ib(d)))}e=F(d);d=G(d);return r(b.b?b.b(e):b.call(null,e))?M(e,Td(b,d)):Td(b,d)}return null},null,null)};function Vd(a,b){return Ud(Gd(a),b)}
function Wd(a){var b=Xd;return function d(a){return new V(null,function(){return M(a,r(b.b?b.b(a):b.call(null,a))?Sd.a(d,E.b?E.b(a):E.call(null,a)):null)},null,null)}(a)}function Yd(a,b){return null!=a?a&&(a.q&4||a.Bc)?vd(C.c(zb,yb(a),b)):C.c(Da,a,b):C.c(pc,H,b)}
var Zd=function(){function a(a,b,c,k){return new V(null,function(){var l=E(k);if(l){var n=Md(a,l);return a===O(n)?M(n,d.n(a,b,c,Nd(b,l))):Da(H,Md(a,td.a(n,c)))}return null},null,null)}function b(a,b,c){return new V(null,function(){var k=E(c);if(k){var l=Md(a,k);return a===O(l)?M(l,d.c(a,b,Nd(b,k))):null}return null},null,null)}function c(a,b){return d.c(a,a,b)}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,
d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),$d=function(){function a(a,b,c){var h=Lc;for(b=E(b);;)if(b){var k=a;if(k?k.i&256||k.Mb||(k.i?0:s(Ka,k)):s(Ka,k)){a=Q.c(a,F(b),h);if(h===a)return c;b=I(b)}else return c}else return a}function b(a,b){return c.c(a,b,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),ae=
function(){function a(a,b,c,d,f,t){var v=P.c(b,0,null);return(b=$c(b))?R.c(a,v,e.X(Q.a(a,v),b,c,d,f,t)):R.c(a,v,c.n?c.n(Q.a(a,v),d,f,t):c.call(null,Q.a(a,v),d,f,t))}function b(a,b,c,d,f){var t=P.c(b,0,null);return(b=$c(b))?R.c(a,t,e.s(Q.a(a,t),b,c,d,f)):R.c(a,t,c.c?c.c(Q.a(a,t),d,f):c.call(null,Q.a(a,t),d,f))}function c(a,b,c,d){var f=P.c(b,0,null);return(b=$c(b))?R.c(a,f,e.n(Q.a(a,f),b,c,d)):R.c(a,f,c.a?c.a(Q.a(a,f),d):c.call(null,Q.a(a,f),d))}function d(a,b,c){var d=P.c(b,0,null);return(b=$c(b))?
R.c(a,d,e.c(Q.a(a,d),b,c)):R.c(a,d,c.b?c.b(Q.a(a,d)):c.call(null,Q.a(a,d)))}var e=null,f=function(){function a(c,d,e,f,h,w,y){var B=null;6<arguments.length&&(B=J(Array.prototype.slice.call(arguments,6),0));return b.call(this,c,d,e,f,h,w,B)}function b(a,c,d,f,h,k,y){var B=P.c(c,0,null);return(c=$c(c))?R.c(a,B,S.d(e,Q.a(a,B),c,d,f,J([h,k,y],0))):R.c(a,B,S.d(d,Q.a(a,B),f,h,k,J([y],0)))}a.k=6;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=I(a);var y=
F(a);a=G(a);return b(c,d,e,f,h,y,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t,v){switch(arguments.length){case 3:return d.call(this,e,k,l);case 4:return c.call(this,e,k,l,n);case 5:return b.call(this,e,k,l,n,q);case 6:return a.call(this,e,k,l,n,q,t);default:return f.d(e,k,l,n,q,t,J(arguments,6))}throw Error("Invalid arity: "+arguments.length);};e.k=6;e.f=f.f;e.c=d;e.n=c;e.s=b;e.X=a;e.d=f.d;return e}();function be(a,b){this.t=a;this.e=b}
function ce(a){return new be(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}function de(a){return new be(a.t,va(a.e))}function ee(a){a=a.g;return 32>a?0:a-1>>>5<<5}function fe(a,b,c){for(;;){if(0===b)return c;var d=ce(a);d.e[0]=c;c=d;b-=5}}var he=function ge(b,c,d,e){var f=de(d),h=b.g-1>>>c&31;5===c?f.e[h]=e:(d=d.e[h],b=null!=d?ge(b,c-5,d,e):fe(null,c-5,e),f.e[h]=b);return f};
function ie(a,b){throw Error("No item "+A.b(a)+" in vector of length "+A.b(b));}function je(a){var b=a.root;for(a=a.shift;;)if(0<a)a-=5,b=b.e[0];else return b.e}function ke(a,b){if(b>=ee(a))return a.R;for(var c=a.root,d=a.shift;;)if(0<d)var e=d-5,c=c.e[b>>>d&31],d=e;else return c.e}function le(a,b){return 0<=b&&b<a.g?ke(a,b):ie(b,a.g)}
var ne=function me(b,c,d,e,f){var h=de(d);if(0===c)h.e[e&31]=f;else{var k=e>>>c&31;b=me(b,c-5,d.e[k],e,f);h.e[k]=b}return h},pe=function oe(b,c,d){var e=b.g-2>>>c&31;if(5<c){b=oe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d=de(d);d.e[e]=b;return d}return 0===e?null:u?(d=de(d),d.e[e]=null,d):null};function W(a,b,c,d,e,f){this.j=a;this.g=b;this.shift=c;this.root=d;this.R=e;this.m=f;this.i=167668511;this.q=8196}g=W.prototype;g.toString=function(){return Lb(this)};
g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.Za=function(a,b,c){a=[0,c];for(c=0;;)if(c<this.g){var d=ke(this,c),e=d.length;a:{for(var f=0,h=a[1];;)if(f<e){h=b.c?b.c(h,f+c,d[f]):b.call(null,h,f+c,d[f]);if(fc(h)){d=h;break a}f+=1}else{a[0]=e;d=a[1]=h;break a}d=void 0}if(fc(d))return K.b?K.b(d):K.call(null,d);c+=a[0]}else return a[1]};g.J=function(a,b){return le(this,b)[b&31]};
g.aa=function(a,b,c){return 0<=b&&b<this.g?ke(this,b)[b&31]:c};g.Pa=function(a,b,c){if(0<=b&&b<this.g)return ee(this)<=b?(a=va(this.R),a[b&31]=c,new W(this.j,this.g,this.shift,this.root,a,null)):new W(this.j,this.g,this.shift,ne(this,this.shift,this.root,b,c),this.R,null);if(b===this.g)return Da(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds  [0,"+A.b(this.g)+"]");return null};g.D=function(){return this.j};g.L=function(){return this.g};g.$a=function(){return D.a(this,0)};
g.ab=function(){return D.a(this,1)};g.Ia=function(){return 0<this.g?D.a(this,this.g-1):null};g.Ja=function(){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return eb(qe,this.j);if(1<this.g-ee(this))return new W(this.j,this.g-1,this.shift,this.root,this.R.slice(0,-1),null);if(u){var a=ke(this,this.g-2),b=pe(this,this.shift,this.root),b=null==b?X:b,c=this.g-1;return 5<this.shift&&null==b.e[1]?new W(this.j,c,this.shift-5,b.e[0],a,null):new W(this.j,c,this.shift,b,a,null)}return null};
g.Xa=function(){return 0<this.g?new kc(this,this.g-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.Wa=function(){return new re(this.g,this.shift,se.b?se.b(this.root):se.call(null,this.root),te.b?te.b(this.R):te.call(null,this.R))};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Vector's key for assoc must be a number.");};g.H=function(){return 0===this.g?null:32>=this.g?new ac(this.R,0):u?ue.n?ue.n(this,je(this),0,0):ue.call(null,this,je(this),0,0):null};g.F=function(a,b){return new W(b,this.g,this.shift,this.root,this.R,this.m)};
g.G=function(a,b){if(32>this.g-ee(this)){for(var c=this.R.length,d=Array(c+1),e=0;;)if(e<c)d[e]=this.R[e],e+=1;else break;d[c]=b;return new W(this.j,this.g+1,this.shift,this.root,d,null)}c=(d=this.g>>>5>1<<this.shift)?this.shift+5:this.shift;d?(d=ce(null),d.e[0]=this.root,e=fe(null,this.shift,new be(null,this.R)),d.e[1]=e):d=he(this,this.shift,this.root,new be(null,this.R));return new W(this.j,this.g+1,c,d,[b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};g.a=function(a,b){return this.aa(null,a,b)};
var X=new be(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),qe=new W(null,0,5,X,[],0);function ve(a,b){var c=a.length,d=b?a:va(a);if(32>c)return new W(null,c,5,X,d,null);for(var e=32,f=(new W(null,32,5,X,d.slice(0,32),null)).Wa(null);;)if(e<c)var h=e+1,f=wd.a(f,d[e]),e=h;else return Ab(f)}function we(a){return Ab(C.c(zb,yb(qe),a))}
var xe=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return a instanceof ac&&0===a.p?ve.a?ve.a(a.e,!0):ve.call(null,a.e,!0):we(a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function ye(a,b,c,d,e,f){this.P=a;this.ea=b;this.p=c;this.O=d;this.j=e;this.m=f;this.i=32243948;this.q=1536}g=ye.prototype;g.toString=function(){return Lb(this)};
g.U=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?null:a}return Jb(this)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b)};
g.M=function(a,b,c){return gc.c(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b,c)};g.Q=function(){return this.ea[this.O]};g.S=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?H:a}return Ib(this)};g.H=function(){return this};g.sb=function(){return nd.a(this.ea,this.O)};
g.tb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):H};g.F=function(a,b){return ue.s?ue.s(this.P,this.ea,this.p,this.O,b):ue.call(null,this.P,this.ea,this.p,this.O,b)};g.G=function(a,b){return M(b,this)};g.rb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):null};
var ue=function(){function a(a,b,c,d,l){return new ye(a,b,c,d,l,null)}function b(a,b,c,d){return new ye(a,b,c,d,null,null)}function c(a,b,c){return new ye(a,le(a,b),b,c,null,null)}var d=null,d=function(d,f,h,k,l){switch(arguments.length){case 3:return c.call(this,d,f,h);case 4:return b.call(this,d,f,h,k);case 5:return a.call(this,d,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};d.c=c;d.n=b;d.s=a;return d}();
function Ae(a,b,c,d,e){this.j=a;this.ca=b;this.start=c;this.end=d;this.m=e;this.i=166617887;this.q=8192}g=Ae.prototype;g.toString=function(){return Lb(this)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.J=function(a,b){return 0>b||this.end<=this.start+b?ie(b,this.end-this.start):D.a(this.ca,this.start+b)};g.aa=function(a,b,c){return 0>b||this.end<=this.start+b?c:D.c(this.ca,this.start+b,c)};
g.Pa=function(a,b,c){var d=this,e=d.start+b;return Be.s?Be.s(d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null):Be.call(null,d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null)};g.D=function(){return this.j};g.L=function(){return this.end-this.start};g.Ia=function(){return D.a(this.ca,this.end-1)};
g.Ja=function(){if(this.start===this.end)throw Error("Can't pop empty vector");return Be.s?Be.s(this.j,this.ca,this.start,this.end-1,null):Be.call(null,this.j,this.ca,this.start,this.end-1,null)};g.Xa=function(){return this.start!==this.end?new kc(this,this.end-this.start-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Subvec's key for assoc must be a number.");};g.H=function(){var a=this;return function(b){return function d(e){return e===a.end?null:M(D.a(a.ca,e),new V(null,function(){return function(){return d(e+1)}}(b),null,null))}}(this)(a.start)};g.F=function(a,b){return Be.s?Be.s(b,this.ca,this.start,this.end,this.m):Be.call(null,b,this.ca,this.start,this.end,this.m)};
g.G=function(a,b){return Be.s?Be.s(this.j,$a(this.ca,this.end,b),this.start,this.end+1,null):Be.call(null,this.j,$a(this.ca,this.end,b),this.start,this.end+1,null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};
g.a=function(a,b){return this.aa(null,a,b)};function Be(a,b,c,d,e){for(;;)if(b instanceof Ae)c=b.start+c,d=b.start+d,b=b.ca;else{var f=O(b);if(0>c||0>d||c>f||d>f)throw Error("Index out of bounds");return new Ae(a,b,c,d,e)}}
var ze=function(){function a(a,b,c){return Be(null,a,b,c,null)}function b(a,b){return c.c(a,b,O(a))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();function Ce(a,b){return a===b.t?b:new be(a,va(b.e))}function se(a){return new be({},va(a.e))}
function te(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];Kc(a,0,b,0,a.length);return b}
var Ee=function De(b,c,d,e){d=Ce(b.root.t,d);var f=b.g-1>>>c&31;if(5===c)b=e;else{var h=d.e[f];b=null!=h?De(b,c-5,h,e):fe(b.root.t,c-5,e)}d.e[f]=b;return d},Ge=function Fe(b,c,d){d=Ce(b.root.t,d);var e=b.g-2>>>c&31;if(5<c){b=Fe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d.e[e]=b;return d}return 0===e?null:u?(d.e[e]=null,d):null};function re(a,b,c,d){this.g=a;this.shift=b;this.root=c;this.R=d;this.i=275;this.q=88}g=re.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};
g.J=function(a,b){if(this.root.t)return le(this,b)[b&31];throw Error("nth after persistent!");};g.aa=function(a,b,c){return 0<=b&&b<this.g?D.a(this,b):c};g.L=function(){if(this.root.t)return this.g;throw Error("count after persistent!");};
g.Pb=function(a,b,c){var d=this;if(d.root.t){if(0<=b&&b<d.g)return ee(this)<=b?d.R[b&31]=c:(a=function(){return function f(a,k){var l=Ce(d.root.t,k);if(0===a)l.e[b&31]=c;else{var n=b>>>a&31,q=f(a-5,l.e[n]);l.e[n]=q}return l}}(this).call(null,d.shift,d.root),d.root=a),this;if(b===d.g)return zb(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds for TransientVector of length"+A.b(d.g));return null}throw Error("assoc! after persistent!");};
g.Qb=function(){if(this.root.t){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return this.g=0,this;if(0<(this.g-1&31))return this.g-=1,this;if(u){var a;a:if(a=this.g-2,a>=ee(this))a=this.R;else{for(var b=this.root,c=b,d=this.shift;;)if(0<d)c=Ce(b.t,c.e[a>>>d&31]),d-=5;else{a=c.e;break a}a=void 0}b=Ge(this,this.shift,this.root);b=null!=b?b:new be(this.root.t,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,null]);5<this.shift&&null==b.e[1]?(this.root=Ce(this.root.t,b.e[0]),this.shift-=5):this.root=b;this.g-=1;this.R=a;return this}return null}throw Error("pop! after persistent!");};g.cb=function(a,b,c){if("number"===typeof b)return Db(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
g.Ka=function(a,b){if(this.root.t){if(32>this.g-ee(this))this.R[this.g&31]=b;else{var c=new be(this.root.t,this.R),d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];d[0]=b;this.R=d;if(this.g>>>5>1<<this.shift){var d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],e=this.shift+
5;d[0]=this.root;d[1]=fe(this.root.t,this.shift,c);this.root=new be(this.root.t,d);this.shift=e}else this.root=Ee(this,this.shift,this.root,c)}this.g+=1;return this}throw Error("conj! after persistent!");};g.Oa=function(){if(this.root.t){this.root.t=null;var a=this.g-ee(this),b=Array(a);Kc(this.R,0,b,0,a);return new W(null,this.g,this.shift,this.root,b,null)}throw Error("persistent! called twice");};function He(a,b,c,d){this.j=a;this.ba=b;this.pa=c;this.m=d;this.q=0;this.i=31850572}g=He.prototype;
g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return F(this.ba)};g.S=function(){var a=I(this.ba);return a?new He(this.j,a,this.pa,null):null==this.pa?Ba(this):new He(this.j,this.pa,null,null)};g.H=function(){return this};g.F=function(a,b){return new He(b,this.ba,this.pa,this.m)};g.G=function(a,b){return M(b,this)};
function Ie(a,b,c,d,e){this.j=a;this.count=b;this.ba=c;this.pa=d;this.m=e;this.i=31858766;this.q=8192}g=Ie.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.L=function(){return this.count};g.Ia=function(){return F(this.ba)};g.Ja=function(){if(r(this.ba)){var a=I(this.ba);return a?new Ie(this.j,this.count-1,a,this.pa,null):new Ie(this.j,this.count-1,E(this.pa),qe,null)}return this};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return Je};g.Q=function(){return F(this.ba)};g.S=function(){return G(E(this))};g.H=function(){var a=E(this.pa),b=this.ba;return r(r(b)?b:a)?new He(null,this.ba,E(a),null):null};g.F=function(a,b){return new Ie(b,this.count,this.ba,this.pa,this.m)};g.G=function(a,b){var c;r(this.ba)?(c=this.pa,c=new Ie(this.j,this.count+1,this.ba,pc.a(r(c)?c:qe,b),null)):c=new Ie(this.j,this.count+1,pc.a(this.ba,b),qe,null);return c};var Je=new Ie(null,0,null,qe,0);
function Ke(){this.q=0;this.i=2097152}Ke.prototype.v=function(){return!1};var Le=new Ke;function Me(a,b){return Nc(Gc(b)?O(a)===O(b)?Dd(Fd,Kd.a(function(a){return Wb.a(Q.c(b,F(a),Le),F(I(a)))},a)):null:null)}function Ne(a){this.r=a}Ne.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:a}}return{done:!0,value:null}};function Oe(a){return new Ne(E(a))}function Pe(a){this.r=a}
Pe.prototype.next=function(){if(null!=this.r){var a=F(this.r),b=P.c(a,0,null),a=P.c(a,1,null);this.r=I(this.r);return{done:!1,value:[b,a]}}return{done:!0,value:null}};function Qe(a){return new Pe(E(a))}function Re(a){this.r=a}Re.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:[a,a]}}return{done:!0,value:null}};function Se(a){return new Re(E(a))}
function Te(a,b){var c=a.e;if(b instanceof T)a:{for(var d=c.length,e=b.sa,f=0;;){if(d<=f){c=-1;break a}var h=c[f];if(h instanceof T&&e===h.sa){c=f;break a}if(u)f+=2;else{c=null;break a}}c=void 0}else if("string"==typeof b||"number"===typeof b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(b===c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(b instanceof Zb)a:{d=c.length;e=b.Na;for(f=0;;){if(d<=f){c=-1;break a}h=c[f];if(h instanceof Zb&&e===h.Na){c=f;break a}if(u)f+=2;else{c=null;
break a}}c=void 0}else if(null==b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(null==c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(u)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(Wb.a(b,c[e])){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else c=null;return c}function Ue(a,b,c){this.e=a;this.p=b;this.W=c;this.q=0;this.i=32374990}g=Ue.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};
g.U=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):null};g.L=function(){return(this.e.length-this.p)/2};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return new W(null,2,5,X,[this.e[this.p],this.e[this.p+1]],null)};g.S=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):H};g.H=function(){return this};
g.F=function(a,b){return new Ue(this.e,this.p,b)};g.G=function(a,b){return M(b,this)};function la(a,b,c,d){this.j=a;this.g=b;this.e=c;this.m=d;this.i=16647951;this.q=8196}g=la.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Te(this,b);return-1===a?c:this.e[a+1]};
g.Za=function(a,b,c){a=this.e.length;for(var d=0;;)if(d<a){c=b.c?b.c(c,this.e[d],this.e[d+1]):b.call(null,c,this.e[d],this.e[d+1]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=2}else return c};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new Xe({},this.e.length,va(this.e))};g.I=function(){return eb(Ye,this.j)};g.N=function(a,b){return nc.a(b,this)};
g.M=function(a,b,c){return nc.c(b,c,this)};g.nb=function(a,b){if(0<=Te(this,b)){var c=this.e.length,d=c-2;if(0===d)return Ba(this);for(var d=Array(d),e=0,f=0;;){if(e>=c)return new la(this.j,this.g-1,d,null);if(Wb.a(b,this.e[e]))e+=2;else if(u)d[f]=this.e[e],d[f+1]=this.e[e+1],f+=2,e+=2;else return null}}else return this};
g.ua=function(a,b,c){a=Te(this,b);if(-1===a){if(this.g<Ze){a=this.e;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new la(this.j,this.g+1,e,null)}return eb(Oa(Yd($e,this),b,c),this.j)}return c===this.e[a+1]?this:u?(b=va(this.e),b[a+1]=c,new la(this.j,this.g,b,null)):null};g.kb=function(a,b){return-1!==Te(this,b)};g.H=function(){var a=this.e;return 0<=a.length-2?new Ue(a,0,null):null};g.F=function(a,b){return new la(b,this.g,this.e,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var Ye=new la(null,0,[],null),Ze=8;function af(a){for(var b=a.length,c=0,d=yb(Ye);;)if(c<b)var e=c+2,d=Bb(d,a[c],a[c+1]),c=e;else return Ab(d)}function Xe(a,b,c){this.Ra=a;this.ja=b;this.e=c;this.q=56;this.i=258}g=Xe.prototype;
g.Ab=function(a,b){if(r(this.Ra)){var c=Te(this,b);0<=c&&(this.e[c]=this.e[this.ja-2],this.e[c+1]=this.e[this.ja-1],c=this.e,c.pop(),c.pop(),this.ja-=2);return this}throw Error("dissoc! after persistent!");};g.cb=function(a,b,c){if(r(this.Ra)){a=Te(this,b);if(-1===a)return this.ja+2<=2*Ze?(this.ja+=2,this.e.push(b),this.e.push(c),this):xd.c(bf.a?bf.a(this.ja,this.e):bf.call(null,this.ja,this.e),b,c);c!==this.e[a+1]&&(this.e[a+1]=c);return this}throw Error("assoc! after persistent!");};
g.Ka=function(a,b){if(r(this.Ra)){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b))return Bb(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));for(var c=E(b),d=this;;){var e=F(c);if(r(e))c=I(c),d=Bb(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else return d}}else throw Error("conj! after persistent!");};g.Oa=function(){if(r(this.Ra))return this.Ra=!1,new la(null,Yc(this.ja),this.e,null);throw Error("persistent! called twice");};g.u=function(a,b){return La.c(this,b,null)};
g.C=function(a,b,c){if(r(this.Ra))return a=Te(this,b),-1===a?c:this.e[a+1];throw Error("lookup after persistent!");};g.L=function(){if(r(this.Ra))return Yc(this.ja);throw Error("count after persistent!");};function bf(a,b){for(var c=yb($e),d=0;;)if(d<a)c=xd.c(c,b[d],b[d+1]),d+=2;else return c}function ef(){this.l=!1}function ff(a,b){return a===b?!0:hd(a,b)?!0:u?Wb.a(a,b):null}
var gf=function(){function a(a,b,c,h,k){a=va(a);a[b]=c;a[h]=k;return a}function b(a,b,c){a=va(a);a[b]=c;return a}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function hf(a,b){var c=Array(a.length-2);Kc(a,0,c,0,2*b);Kc(a,2*(b+1),c,2*b,c.length-2*b);return c}
var jf=function(){function a(a,b,c,h,k,l){a=a.La(b);a.e[c]=h;a.e[k]=l;return a}function b(a,b,c,h){a=a.La(b);a.e[c]=h;return a}var c=null,c=function(c,e,f,h,k,l){switch(arguments.length){case 4:return b.call(this,c,e,f,h);case 6:return a.call(this,c,e,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};c.n=b;c.X=a;return c}();
function kf(a,b,c){for(var d=a.length,e=0;;)if(e<d){var f=a[e];null!=f?c=b.c?b.c(c,f,a[e+1]):b.call(null,c,f,a[e+1]):(f=a[e+1],c=null!=f?f.Ta(b,c):c);if(fc(c))return K.b?K.b(c):K.call(null,c);e+=2}else return c}function lf(a,b,c){this.t=a;this.A=b;this.e=c}g=lf.prototype;g.La=function(a){if(a===this.t)return this;var b=Zc(this.A),c=Array(0>b?4:2*(b+1));Kc(this.e,0,c,0,2*b);return new lf(a,this.A,c)};
g.gb=function(a,b,c,d,e){var f=1<<(c>>>b&31);if(0===(this.A&f))return this;var h=Zc(this.A&f-1),k=this.e[2*h],l=this.e[2*h+1];return null==k?(b=l.gb(a,b+5,c,d,e),b===l?this:null!=b?jf.n(this,a,2*h+1,b):this.A===f?null:u?mf(this,a,f,h):null):ff(d,k)?(e[0]=!0,mf(this,a,f,h)):u?this:null};function mf(a,b,c,d){if(a.A===c)return null;a=a.La(b);b=a.e;var e=b.length;a.A^=c;Kc(b,2*(d+1),b,2*d,e-2*(d+1));b[e-2]=null;b[e-1]=null;return a}g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};
g.Ta=function(a,b){return kf(this.e,a,b)};g.Ma=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.A&e))return d;var f=Zc(this.A&e-1),e=this.e[2*f],f=this.e[2*f+1];return null==e?f.Ma(a+5,b,c,d):ff(c,e)?f:u?d:null};
g.ia=function(a,b,c,d,e,f){var h=1<<(c>>>b&31),k=Zc(this.A&h-1);if(0===(this.A&h)){var l=Zc(this.A);if(2*l<this.e.length){a=this.La(a);b=a.e;f.l=!0;a:for(c=2*(l-k),f=2*k+(c-1),l=2*(k+1)+(c-1);;){if(0===c)break a;b[l]=b[f];l-=1;c-=1;f-=1}b[2*k]=d;b[2*k+1]=e;a.A|=h;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=of.ia(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0!==
(this.A>>>d&1)&&(k[d]=null!=this.e[e]?of.ia(a,b+5,Tb(this.e[e]),this.e[e],this.e[e+1],f):this.e[e+1],e+=2),d+=1;else break;return new pf(a,l+1,k)}return u?(b=Array(2*(l+4)),Kc(this.e,0,b,0,2*k),b[2*k]=d,b[2*k+1]=e,Kc(this.e,2*k,b,2*(k+1),2*(l-k)),f.l=!0,a=this.La(a),a.e=b,a.A|=h,a):null}l=this.e[2*k];h=this.e[2*k+1];return null==l?(l=h.ia(a,b+5,c,d,e,f),l===h?this:jf.n(this,a,2*k+1,l)):ff(d,l)?e===h?this:jf.n(this,a,2*k+1,e):u?(f.l=!0,jf.X(this,a,2*k,null,2*k+1,qf.ga?qf.ga(a,b+5,l,h,c,d,e):qf.call(null,
a,b+5,l,h,c,d,e))):null};
g.ha=function(a,b,c,d,e){var f=1<<(b>>>a&31),h=Zc(this.A&f-1);if(0===(this.A&f)){var k=Zc(this.A);if(16<=k){h=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[b>>>a&31]=of.ha(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0!==(this.A>>>c&1)&&(h[c]=null!=this.e[d]?of.ha(a+5,Tb(this.e[d]),this.e[d],this.e[d+1],e):this.e[d+1],d+=2),c+=1;else break;return new pf(null,k+1,h)}a=Array(2*(k+1));Kc(this.e,
0,a,0,2*h);a[2*h]=c;a[2*h+1]=d;Kc(this.e,2*h,a,2*(h+1),2*(k-h));e.l=!0;return new lf(null,this.A|f,a)}k=this.e[2*h];f=this.e[2*h+1];return null==k?(k=f.ha(a+5,b,c,d,e),k===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,k))):ff(c,k)?d===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,d)):u?(e.l=!0,new lf(null,this.A,gf.s(this.e,2*h,null,2*h+1,qf.X?qf.X(a+5,k,f,b,c,d):qf.call(null,a+5,k,f,b,c,d)))):null};
g.fb=function(a,b,c){var d=1<<(b>>>a&31);if(0===(this.A&d))return this;var e=Zc(this.A&d-1),f=this.e[2*e],h=this.e[2*e+1];return null==f?(a=h.fb(a+5,b,c),a===h?this:null!=a?new lf(null,this.A,gf.c(this.e,2*e+1,a)):this.A===d?null:u?new lf(null,this.A^d,hf(this.e,e)):null):ff(c,f)?new lf(null,this.A^d,hf(this.e,e)):u?this:null};var of=new lf(null,0,[]);
function rf(a,b,c){var d=a.e;a=2*(a.g-1);for(var e=Array(a),f=0,h=1,k=0;;)if(f<a)f!==c&&null!=d[f]&&(e[h]=d[f],h+=2,k|=1<<f),f+=1;else return new lf(b,k,e)}function pf(a,b,c){this.t=a;this.g=b;this.e=c}g=pf.prototype;g.La=function(a){return a===this.t?this:new pf(a,this.g,va(this.e))};
g.gb=function(a,b,c,d,e){var f=c>>>b&31,h=this.e[f];if(null==h)return this;b=h.gb(a,b+5,c,d,e);if(b===h)return this;if(null==b){if(8>=this.g)return rf(this,a,f);a=jf.n(this,a,f,b);a.g-=1;return a}return u?jf.n(this,a,f,b):null};g.eb=function(){return sf.b?sf.b(this.e):sf.call(null,this.e)};g.Ta=function(a,b){for(var c=this.e.length,d=0,e=b;;)if(d<c){var f=this.e[d];if(null!=f&&(e=f.Ta(a,e),fc(e)))return K.b?K.b(e):K.call(null,e);d+=1}else return e};
g.Ma=function(a,b,c,d){var e=this.e[b>>>a&31];return null!=e?e.Ma(a+5,b,c,d):d};g.ia=function(a,b,c,d,e,f){var h=c>>>b&31,k=this.e[h];if(null==k)return a=jf.n(this,a,h,of.ia(a,b+5,c,d,e,f)),a.g+=1,a;b=k.ia(a,b+5,c,d,e,f);return b===k?this:jf.n(this,a,h,b)};g.ha=function(a,b,c,d,e){var f=b>>>a&31,h=this.e[f];if(null==h)return new pf(null,this.g+1,gf.c(this.e,f,of.ha(a+5,b,c,d,e)));a=h.ha(a+5,b,c,d,e);return a===h?this:new pf(null,this.g,gf.c(this.e,f,a))};
g.fb=function(a,b,c){var d=b>>>a&31,e=this.e[d];return null!=e?(a=e.fb(a+5,b,c),a===e?this:null==a?8>=this.g?rf(this,null,d):new pf(null,this.g-1,gf.c(this.e,d,a)):u?new pf(null,this.g,gf.c(this.e,d,a)):null):this};function tf(a,b,c){b*=2;for(var d=0;;)if(d<b){if(ff(c,a[d]))return d;d+=2}else return-1}function uf(a,b,c,d){this.t=a;this.ra=b;this.g=c;this.e=d}g=uf.prototype;
g.La=function(a){if(a===this.t)return this;var b=Array(2*(this.g+1));Kc(this.e,0,b,0,2*this.g);return new uf(a,this.ra,this.g,b)};g.gb=function(a,b,c,d,e){b=tf(this.e,this.g,d);if(-1===b)return this;e[0]=!0;if(1===this.g)return null;a=this.La(a);e=a.e;e[b]=e[2*this.g-2];e[b+1]=e[2*this.g-1];e[2*this.g-1]=null;e[2*this.g-2]=null;a.g-=1;return a};g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};g.Ta=function(a,b){return kf(this.e,a,b)};
g.Ma=function(a,b,c,d){a=tf(this.e,this.g,c);return 0>a?d:ff(c,this.e[a])?this.e[a+1]:u?d:null};
g.ia=function(a,b,c,d,e,f){if(c===this.ra){b=tf(this.e,this.g,d);if(-1===b){if(this.e.length>2*this.g)return a=jf.X(this,a,2*this.g,d,2*this.g+1,e),f.l=!0,a.g+=1,a;c=this.e.length;b=Array(c+2);Kc(this.e,0,b,0,c);b[c]=d;b[c+1]=e;f.l=!0;f=this.g+1;a===this.t?(this.e=b,this.g=f,a=this):a=new uf(this.t,this.ra,f,b);return a}return this.e[b+1]===e?this:jf.n(this,a,b+1,e)}return(new lf(a,1<<(this.ra>>>b&31),[null,this,null,null])).ia(a,b,c,d,e,f)};
g.ha=function(a,b,c,d,e){return b===this.ra?(a=tf(this.e,this.g,c),-1===a?(a=2*this.g,b=Array(a+2),Kc(this.e,0,b,0,a),b[a]=c,b[a+1]=d,e.l=!0,new uf(null,this.ra,this.g+1,b)):Wb.a(this.e[a],d)?this:new uf(null,this.ra,this.g,gf.c(this.e,a+1,d))):(new lf(null,1<<(this.ra>>>a&31),[null,this])).ha(a,b,c,d,e)};g.fb=function(a,b,c){a=tf(this.e,this.g,c);return-1===a?this:1===this.g?null:u?new uf(null,this.ra,this.g-1,hf(this.e,Yc(a))):null};
var qf=function(){function a(a,b,c,h,k,l,n){var q=Tb(c);if(q===k)return new uf(null,q,2,[c,h,l,n]);var t=new ef;return of.ia(a,b,q,c,h,t).ia(a,b,k,l,n,t)}function b(a,b,c,h,k,l){var n=Tb(b);if(n===h)return new uf(null,n,2,[b,c,k,l]);var q=new ef;return of.ha(a,n,b,c,q).ha(a,h,k,l,q)}var c=null,c=function(c,e,f,h,k,l,n){switch(arguments.length){case 6:return b.call(this,c,e,f,h,k,l);case 7:return a.call(this,c,e,f,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};c.X=b;c.ga=a;return c}();
function vf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=vf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null==this.r?new W(null,2,5,X,[this.ka[this.p],this.ka[this.p+1]],null):F(this.r)};
g.S=function(){return null==this.r?nf.c?nf.c(this.ka,this.p+2,null):nf.call(null,this.ka,this.p+2,null):nf.c?nf.c(this.ka,this.p,I(this.r)):nf.call(null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new vf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var nf=function(){function a(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new vf(null,a,b,null,null);var h=a[b+1];if(r(h)&&(h=h.eb(),r(h)))return new vf(null,a,b+2,h,null);b+=2}else return null;else return new vf(null,a,b,c,null)}function b(a){return c.c(a,0,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 1:return b.call(this,c);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.c=a;return c}();
function wf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=wf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return F(this.r)};
g.S=function(){return sf.n?sf.n(null,this.ka,this.p,I(this.r)):sf.call(null,null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new wf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var sf=function(){function a(a,b,c,h){if(null==h)for(h=b.length;;)if(c<h){var k=b[c];if(r(k)&&(k=k.eb(),r(k)))return new wf(a,b,c+1,k,null);c+=1}else return null;else return new wf(a,b,c,h,null)}function b(a){return c.n(null,a,0,null)}var c=null,c=function(c,e,f,h){switch(arguments.length){case 1:return b.call(this,c);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.n=a;return c}();
function xf(a,b,c,d,e,f){this.j=a;this.g=b;this.root=c;this.T=d;this.Y=e;this.m=f;this.i=16123663;this.q=8196}g=xf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:u?this.root.Ma(0,Tb(b),b,c):null};
g.Za=function(a,b,c){a=this.T?b.c?b.c(c,null,this.Y):b.call(null,c,null,this.Y):c;return fc(a)?K.b?K.b(a):K.call(null,a):null!=this.root?this.root.Ta(b,a):u?a:null};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new yf({},this.root,this.g,this.T,this.Y)};g.I=function(){return eb($e,this.j)};
g.nb=function(a,b){if(null==b)return this.T?new xf(this.j,this.g-1,this.root,!1,null,null):this;if(null==this.root)return this;if(u){var c=this.root.fb(0,Tb(b),b);return c===this.root?this:new xf(this.j,this.g-1,c,this.T,this.Y,null)}return null};
g.ua=function(a,b,c){if(null==b)return this.T&&c===this.Y?this:new xf(this.j,this.T?this.g:this.g+1,this.root,!0,c,null);a=new ef;b=(null==this.root?of:this.root).ha(0,Tb(b),b,c,a);return b===this.root?this:new xf(this.j,a.l?this.g+1:this.g,b,this.T,this.Y,null)};g.kb=function(a,b){return null==b?this.T:null==this.root?!1:u?this.root.Ma(0,Tb(b),b,Lc)!==Lc:null};g.H=function(){if(0<this.g){var a=null!=this.root?this.root.eb():null;return this.T?M(new W(null,2,5,X,[null,this.Y],null),a):a}return null};
g.F=function(a,b){return new xf(b,this.g,this.root,this.T,this.Y,this.m)};g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var $e=new xf(null,0,null,!1,null,0);function sc(a,b){for(var c=a.length,d=0,e=yb($e);;)if(d<c)var f=d+1,e=e.cb(null,a[d],b[d]),d=f;else return Ab(e)}
function yf(a,b,c,d,e){this.t=a;this.root=b;this.count=c;this.T=d;this.Y=e;this.q=56;this.i=258}g=yf.prototype;g.Ab=function(a,b){if(this.t)if(null==b)this.T&&(this.T=!1,this.Y=null,this.count-=1);else{if(null!=this.root){var c=new ef,d=this.root.gb(this.t,0,Tb(b),b,c);d!==this.root&&(this.root=d);r(c[0])&&(this.count-=1)}}else throw Error("dissoc! after persistent!");return this};g.cb=function(a,b,c){return zf(this,b,c)};
g.Ka=function(a,b){var c;a:{if(this.t){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b)){c=zf(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));break a}c=E(b);for(var d=this;;){var e=F(c);if(r(e))c=I(c),d=zf(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else{c=d;break a}}}else throw Error("conj! after persistent");c=void 0}return c};
g.Oa=function(){var a;if(this.t)this.t=null,a=new xf(null,this.count,this.root,this.T,this.Y,null);else throw Error("persistent! called twice");return a};g.u=function(a,b){return null==b?this.T?this.Y:null:null==this.root?null:this.root.Ma(0,Tb(b),b)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:this.root.Ma(0,Tb(b),b,c)};g.L=function(){if(this.t)return this.count;throw Error("count after persistent!");};
function zf(a,b,c){if(a.t){if(null==b)a.Y!==c&&(a.Y=c),a.T||(a.count+=1,a.T=!0);else{var d=new ef;b=(null==a.root?of:a.root).ia(a.t,0,Tb(b),b,c,d);b!==a.root&&(a.root=b);d.l&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}function Af(a,b,c){for(var d=b;;)if(null!=a)b=c?a.left:a.right,d=pc.a(d,a),a=b;else return d}function Bf(a,b,c,d,e){this.j=a;this.stack=b;this.ib=c;this.g=d;this.m=e;this.q=0;this.i=32374862}g=Bf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};
g.L=function(){return 0>this.g?O(I(this))+1:this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return yc(this.stack)};g.S=function(){var a=F(this.stack),a=Af(this.ib?a.right:a.left,I(this.stack),this.ib);return null!=a?new Bf(null,a,this.ib,this.g-1,null):H};g.H=function(){return this};
g.F=function(a,b){return new Bf(b,this.stack,this.ib,this.g,this.m)};g.G=function(a,b){return M(b,this)};function Cf(a,b,c){return new Bf(null,Af(a,null,b),b,c,null)}function Df(a,b,c,d){return c instanceof Y?c.left instanceof Y?new Y(c.key,c.l,c.left.qa(),new $(a,b,c.right,d,null),null):c.right instanceof Y?new Y(c.right.key,c.right.l,new $(c.key,c.l,c.left,c.right.left,null),new $(a,b,c.right.right,d,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ef(a,b,c,d){return d instanceof Y?d.right instanceof Y?new Y(d.key,d.l,new $(a,b,c,d.left,null),d.right.qa(),null):d.left instanceof Y?new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),new $(d.key,d.l,d.left.right,d.right,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ff(a,b,c,d){if(c instanceof Y)return new Y(a,b,c.qa(),d,null);if(d instanceof $)return Ef(a,b,c,d.hb());if(d instanceof Y&&d.left instanceof $)return new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),Ef(d.key,d.l,d.left.right,d.right.hb()),null);if(u)throw Error("red-black tree invariant violation");return null}
var Hf=function Gf(b,c,d){d=null!=b.left?Gf(b.left,c,d):d;if(fc(d))return K.b?K.b(d):K.call(null,d);d=c.c?c.c(d,b.key,b.l):c.call(null,d,b.key,b.l);if(fc(d))return K.b?K.b(d):K.call(null,d);b=null!=b.right?Gf(b.right,c,d):d;return fc(b)?K.b?K.b(b):K.call(null,b):b};function $(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=$.prototype;g.Hb=function(a){return a.Jb(this)};g.hb=function(){return new Y(this.key,this.l,this.left,this.right,null)};g.qa=function(){return this};
g.Gb=function(a){return a.Ib(this)};g.replace=function(a,b,c,d){return new $(a,b,c,d,null)};g.Ib=function(a){return new $(a.key,a.l,this,a.right,null)};g.Jb=function(a){return new $(a.key,a.l,a.left,this,null)};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};
g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();
g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};function Y(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=Y.prototype;g.Hb=function(a){return new Y(this.key,this.l,this.left,a,null)};g.hb=function(){throw Error("red-black tree invariant violation");};g.qa=function(){return new $(this.key,this.l,this.left,this.right,null)};
g.Gb=function(a){return new Y(this.key,this.l,a,this.right,null)};g.replace=function(a,b,c,d){return new Y(a,b,c,d,null)};g.Ib=function(a){return this.left instanceof Y?new Y(this.key,this.l,this.left.qa(),new $(a.key,a.l,this.right,a.right,null),null):this.right instanceof Y?new Y(this.right.key,this.right.l,new $(this.key,this.l,this.left,this.right.left,null),new $(a.key,a.l,this.right.right,a.right,null),null):u?new $(a.key,a.l,this,a.right,null):null};
g.Jb=function(a){return this.right instanceof Y?new Y(this.key,this.l,new $(a.key,a.l,a.left,this.left,null),this.right.qa(),null):this.left instanceof Y?new Y(this.left.key,this.left.l,new $(a.key,a.l,a.left,this.left.left,null),new $(this.key,this.l,this.left.right,this.right,null),null):u?new $(a.key,a.l,a.left,this,null):null};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};
g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};
var Jf=function If(b,c,d,e,f){if(null==c)return new Y(d,e,null,null,null);var h=b.a?b.a(d,c.key):b.call(null,d,c.key);return 0===h?(f[0]=c,null):0>h?(b=If(b,c.left,d,e,f),null!=b?c.Gb(b):null):u?(b=If(b,c.right,d,e,f),null!=b?c.Hb(b):null):null},Lf=function Kf(b,c){if(null==b)return c;if(null==c)return b;if(b instanceof Y){if(c instanceof Y){var d=Kf(b.right,c.left);return d instanceof Y?new Y(d.key,d.l,new Y(b.key,b.l,b.left,d.left,null),new Y(c.key,c.l,d.right,c.right,null),null):new Y(b.key,b.l,
b.left,new Y(c.key,c.l,d,c.right,null),null)}return new Y(b.key,b.l,b.left,Kf(b.right,c),null)}return c instanceof Y?new Y(c.key,c.l,Kf(b,c.left),c.right,null):u?(d=Kf(b.right,c.left),d instanceof Y?new Y(d.key,d.l,new $(b.key,b.l,b.left,d.left,null),new $(c.key,c.l,d.right,c.right,null),null):Ff(b.key,b.l,b.left,new $(c.key,c.l,d,c.right,null))):null},Nf=function Mf(b,c,d,e){if(null!=c){var f=b.a?b.a(d,c.key):b.call(null,d,c.key);if(0===f)return e[0]=c,Lf(c.left,c.right);if(0>f)return b=Mf(b,c.left,
d,e),null!=b||null!=e[0]?c.left instanceof $?Ff(c.key,c.l,b,c.right):new Y(c.key,c.l,b,c.right,null):null;if(u){b=Mf(b,c.right,d,e);if(null!=b||null!=e[0])if(c.right instanceof $)if(e=c.key,d=c.l,c=c.left,b instanceof Y)c=new Y(e,d,c,b.qa(),null);else if(c instanceof $)c=Df(e,d,c.hb(),b);else if(c instanceof Y&&c.right instanceof $)c=new Y(c.right.key,c.right.l,Df(c.key,c.l,c.left.hb(),c.right.left),new $(e,d,c.right.right,b,null),null);else{if(u)throw Error("red-black tree invariant violation");
c=null}else c=new Y(c.key,c.l,c.left,b,null);else c=null;return c}}return null},Pf=function Of(b,c,d,e){var f=c.key,h=b.a?b.a(d,f):b.call(null,d,f);return 0===h?c.replace(f,e,c.left,c.right):0>h?c.replace(f,c.l,Of(b,c.left,d,e),c.right):u?c.replace(f,c.l,c.left,Of(b,c.right,d,e)):null};function Qf(a,b,c,d,e){this.Z=a;this.ma=b;this.g=c;this.j=d;this.m=e;this.i=418776847;this.q=8192}g=Qf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};
g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};
function Rf(a,b){for(var c=a.ma;;)if(null!=c){var d=a.Z.a?a.Z.a(b,c.key):a.Z.call(null,b,c.key);if(0===d)return c;if(0>d)c=c.left;else if(u)c=c.right;else return null}else return null}g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this,b);return null!=a?a.l:c};g.Za=function(a,b,c){return null!=this.ma?Hf(this.ma,b,c):c};g.D=function(){return this.j};g.L=function(){return this.g};g.Xa=function(){return 0<this.g?Cf(this.ma,!1,this.g):null};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.I=function(){return N(Sf,this.j)};g.nb=function(a,b){var c=[null],d=Nf(this.Z,this.ma,b,c);return null==d?null==P.a(c,0)?this:new Qf(this.Z,null,0,this.j,null):new Qf(this.Z,d.qa(),this.g-1,this.j,null)};
g.ua=function(a,b,c){a=[null];var d=Jf(this.Z,this.ma,b,c,a);return null==d?(a=P.a(a,0),Wb.a(c,a.l)?this:new Qf(this.Z,Pf(this.Z,this.ma,b,c),this.g,this.j,null)):new Qf(this.Z,d.qa(),this.g+1,this.j,null)};g.kb=function(a,b){return null!=Rf(this,b)};g.H=function(){return 0<this.g?Cf(this.ma,!0,this.g):null};g.F=function(a,b){return new Qf(this.Z,this.ma,this.g,b,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return 0<this.g?Cf(this.ma,b,this.g):null};g.zb=function(a,b,c){if(0<this.g){a=null;for(var d=this.ma;;)if(null!=d){var e=this.Z.a?this.Z.a(b,d.key):this.Z.call(null,b,d.key);if(0===e)return new Bf(null,pc.a(a,d),c,-1,null);if(r(c))0>e?(a=pc.a(a,d),d=d.left):d=d.right;else if(u)0<e?(a=pc.a(a,d),d=d.right):d=d.left;else return null}else return null==a?null:new Bf(null,a,c,-1,null)}else return null};
g.xb=function(a,b){return cf.b?cf.b(b):cf.call(null,b)};g.wb=function(){return this.Z};
var Sf=new Qf(Xb,null,0,null,0),Tf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=yb($e);;)if(a){var e=I(I(a)),b=xd.c(b,F(a),F(I(a)));a=e}else return Ab(b)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Uf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return new la(null,Yc(O(a)),S.a(wa,
a),null)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Vf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=Sf;;)if(a){var e=I(I(a)),b=R.c(b,F(a),F(I(a)));a=e}else return b}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Wf=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,
b){for(var e=E(b),f=new Qf(Qc(a),null,0,null,0);;)if(e)var h=I(I(e)),f=R.c(f,F(e),F(I(e))),e=h;else return f}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();function Xf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Xf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Xf(a,this.W)};g.B=function(){return cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).$a(null)};g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Xf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Xf(this.V,b)};g.G=function(a,b){return M(b,this)};function Ve(a){return(a=E(a))?new Xf(a,null):null}
function cf(a){return Ta(a)}function Yf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Yf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Yf(a,this.W)};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).ab(null)};
g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Yf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Yf(this.V,b)};g.G=function(a,b){return M(b,this)};function We(a){return(a=E(a))?new Yf(a,null):null}function df(a){return Ua(a)}
var Zf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return r(Ed(Fd,a))?C.a(function(a,b){return pc.a(r(a)?a:Ye,b)},a):null}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function $f(a,b,c){this.j=a;this.Sa=b;this.m=c;this.i=15077647;this.q=8196}g=$f.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};
g.has=function(a){return Oc(this,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return Na(this.Sa,b)?b:c};g.D=function(){return this.j};g.L=function(){return Aa(this.Sa)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.Wa=function(){return new ag(yb(this.Sa))};g.I=function(){return N(bg,this.j)};g.vb=function(a,b){return new $f(this.j,Qa(this.Sa,b),null)};g.H=function(){return Ve(this.Sa)};g.F=function(a,b){return new $f(b,this.Sa,this.m)};g.G=function(a,b){return new $f(this.j,R.c(this.Sa,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var bg=new $f(null,Ye,0);function ag(a){this.la=a;this.i=259;this.q=136}g=ag.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(this.la,c,Lc)===Lc?null:c;case 3:return La.c(this.la,c,Lc)===Lc?d:c}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(this.la,a,Lc)===Lc?null:a};g.a=function(a,b){return La.c(this.la,a,Lc)===Lc?b:a};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return La.c(this.la,b,Lc)===Lc?c:b};
g.L=function(){return O(this.la)};g.Ob=function(a,b){this.la=yd.a(this.la,b);return this};g.Ka=function(a,b){this.la=xd.c(this.la,b,null);return this};g.Oa=function(){return new $f(null,Ab(this.la),null)};function cg(a,b,c){this.j=a;this.na=b;this.m=c;this.i=417730831;this.q=8192}g=cg.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};g.has=function(a){return Oc(this,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this.na,b);return null!=a?a.key:c};g.D=function(){return this.j};g.L=function(){return O(this.na)};
g.Xa=function(){return 0<O(this.na)?Kd.a(cf,pb(this.na)):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.I=function(){return N(dg,this.j)};g.vb=function(a,b){return new cg(this.j,tc.a(this.na,b),null)};g.H=function(){return Ve(this.na)};g.F=function(a,b){return new cg(b,this.na,this.m)};g.G=function(a,b){return new cg(this.j,R.c(this.na,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return Kd.a(cf,qb(this.na,b))};g.zb=function(a,b,c){return Kd.a(cf,rb(this.na,b,c))};g.xb=function(a,b){return b};g.wb=function(){return tb(this.na)};
var dg=new cg(null,Sf,0);function eg(a){a=E(a);if(null==a)return bg;if(a instanceof ac&&0===a.p){a=a.e;a:{for(var b=0,c=yb(bg);;)if(b<a.length)var d=b+1,c=c.Ka(null,a[b]),b=d;else{a=c;break a}a=void 0}return a.Oa(null)}if(u)for(d=yb(bg);;)if(null!=a)b=a.U(null),d=d.Ka(null,a.Q(null)),a=b;else return d.Oa(null);else return null}
var fg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.c(Da,dg,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),gg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return C.c(Da,new cg(null,Wf(a),0),b)}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();
function hg(a){for(var b=qe;;)if(I(a))b=pc.a(b,F(a)),a=I(a);else return E(b)}function id(a){if(a&&(a.q&4096||a.fc))return a.name;if("string"===typeof a)return a;throw Error("Doesn't support name: "+A.b(a));}
var ig=function(){function a(a,b,c){return(a.b?a.b(b):a.call(null,b))>(a.b?a.b(c):a.call(null,c))?b:c}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){return C.c(function(c,d){return b.c(a,c,d)},b.c(a,d,e),l)}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 2:return e;
case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.a=function(a,b){return b};b.c=a;b.d=c.d;return b}(),jg=function(){function a(a,b,f){return new V(null,function(){var h=E(f);return h?M(Md(a,h),c.c(a,b,Nd(b,h))):null},null,null)}function b(a,b){return c.c(a,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);
};c.a=b;c.c=a;return c}(),lg=function kg(b,c){return new V(null,function(){var d=E(c);return d?r(b.b?b.b(F(d)):b.call(null,F(d)))?M(F(d),kg(b,G(d))):null:null},null,null)};function mg(a,b,c){return function(d){var e=tb(a);return b.a?b.a(e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0):b.call(null,e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0)}}
var ng=function(){function a(a,b,c,h,k){var l=rb(a,c,!0);if(r(l)){var n=P.c(l,0,null);return lg(mg(a,h,k),r(mg(a,b,c).call(null,n))?l:I(l))}return null}function b(a,b,c){var h=mg(a,b,c),k;a:{k=[Uc,Vc];var l=k.length;if(l<=Ze)for(var n=0,q=yb(Ye);;)if(n<l)var t=n+1,q=Bb(q,k[n],null),n=t;else{k=new $f(null,Ab(q),null);break a}else for(n=0,q=yb(bg);;)if(n<l)t=n+1,q=zb(q,k[n]),n=t;else{k=Ab(q);break a}k=void 0}return r(k.call(null,b))?(a=rb(a,c,!0),r(a)?(b=P.c(a,0,null),r(h.b?h.b(b):h.call(null,b))?a:
I(a)):null):lg(h,qb(a,!0))}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function og(a,b,c,d,e){this.j=a;this.start=b;this.end=c;this.step=d;this.m=e;this.i=32375006;this.q=8192}g=og.prototype;g.toString=function(){return Lb(this)};
g.J=function(a,b){if(b<Aa(this))return this.start+b*this.step;if(this.start>this.end&&0===this.step)return this.start;throw Error("Index out of bounds");};g.aa=function(a,b,c){return b<Aa(this)?this.start+b*this.step:this.start>this.end&&0===this.step?this.start:c};g.D=function(){return this.j};
g.U=function(){return 0<this.step?this.start+this.step<this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null:this.start+this.step>this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null};g.L=function(){return sa(lb(this))?0:Math.ceil((this.end-this.start)/this.step)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.Q=function(){return null==lb(this)?null:this.start};g.S=function(){return null!=lb(this)?new og(this.j,this.start+this.step,this.end,this.step,null):H};g.H=function(){return 0<this.step?this.start<this.end?this:null:this.start>this.end?this:null};g.F=function(a,b){return new og(b,this.start,this.end,this.step,this.m)};g.G=function(a,b){return M(b,this)};
var pg=function(){function a(a,b,c){return new og(null,a,b,c,null)}function b(a,b){return e.c(a,b,1)}function c(a){return e.c(0,a,1)}function d(){return e.c(0,Number.MAX_VALUE,1)}var e=null,e=function(e,h,k){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,e);case 2:return b.call(this,e,h);case 3:return a.call(this,e,h,k)}throw Error("Invalid arity: "+arguments.length);};e.o=d;e.b=c;e.a=b;e.c=a;return e}(),qg=function(){function a(a,b){for(;;)if(E(b)&&0<a){var c=a-1,h=
I(b);a=c;b=h}else return null}function b(a){for(;;)if(E(a))a=I(a);else return null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),rg=function(){function a(a,b){qg.a(a,b);return b}function b(a){qg.b(a);return a}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}();function sg(a,b){if("string"===typeof b){var c=a.exec(b);return Wb.a(F(c),b)?1===O(c)?F(c):we(c):null}throw new TypeError("re-matches must match against a string.");}function tg(a){var b;b=/^(?:\(\?([idmsux]*)\))?(.*)/;if("string"===typeof a)a=b.exec(a),b=null==a?null:1===O(a)?F(a):we(a);else throw new TypeError("re-find must match against a string.");P.c(b,0,null);a=P.c(b,1,null);b=P.c(b,2,null);return new RegExp(b,a)}
function ug(a,b,c,d,e,f,h){var k=ja;try{ja=null==ja?null:ja-1;if(null!=ja&&0>ja)return ub(a,"#");ub(a,c);E(h)&&(b.c?b.c(F(h),a,f):b.call(null,F(h),a,f));for(var l=I(h),n=ra.b(f)-1;;)if(!l||null!=n&&0===n){E(l)&&0===n&&(ub(a,d),ub(a,"..."));break}else{ub(a,d);b.c?b.c(F(l),a,f):b.call(null,F(l),a,f);var q=I(l);c=n-1;l=q;n=c}return ub(a,e)}finally{ja=k}}
var vg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){for(var e=E(b),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(a,l);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(a,l),e=I(f),f=null,h=0),k=0;else return null}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}(),wg={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};
function xg(a){return'"'+A.b(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(a){return wg[a]}))+'"'}
var Ag=function yg(b,c,d){if(null==b)return ub(c,"nil");if(void 0===b)return ub(c,"#\x3cundefined\x3e");if(u){r(function(){var c=Q.a(d,pa);return r(c)?(c=b?b.i&131072||b.ec?!0:b.i?!1:s(bb,b):s(bb,b))?xc(b):c:c}())&&(ub(c,"^"),yg(xc(b),c,d),ub(c," "));if(null==b)return ub(c,"nil");if(b.Db)return b.Tb(b,c,d);if(b&&(b.i&2147483648||b.K))return b.w(null,c,d);if(ta(b)===Boolean||"number"===typeof b)return ub(c,""+A.b(b));if(null!=b&&b.constructor===Object)return ub(c,"#js "),zg.n?zg.n(Kd.a(function(c){return new W(null,
2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d):zg.call(null,Kd.a(function(c){return new W(null,2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d);if(b instanceof Array)return ug(c,yg,"#js ["," ","]",d,b);if("string"==typeof b)return r(oa.b(d))?ub(c,xg(b)):ub(c,b);if(uc(b))return vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0));if(b instanceof Date){var e=function(b,c){for(var d=""+A.b(b);;)if(O(d)<c)d="0"+A.b(d);else return d};return vg.d(c,J(['#inst "',""+A.b(b.getUTCFullYear()),"-",e(b.getUTCMonth()+1,2),"-",e(b.getUTCDate(),
2),"T",e(b.getUTCHours(),2),":",e(b.getUTCMinutes(),2),":",e(b.getUTCSeconds(),2),".",e(b.getUTCMilliseconds(),3),"-",'00:00"'],0))}return b instanceof RegExp?vg.d(c,J(['#"',b.source,'"'],0)):(b?b.i&2147483648||b.K||(b.i?0:s(vb,b)):s(vb,b))?wb(b,c,d):u?vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0)):null}return null};
function Bg(a,b){var c=new ea;a:{var d=new Kb(c);Ag(F(a),d,b);for(var e=E(I(a)),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(d," ");Ag(l,d,b);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(d," "),Ag(l,d,b),e=I(f),f=null,h=0),k=0;else break a}return c}
var Cg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b=ka();return Bc(a)?"":""+A.b(Bg(a,b))}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function zg(a,b,c,d){return ug(c,function(a,c,d){b.c?b.c(Ta(a),c,d):b.call(null,Ta(a),c,d);ub(c," ");return b.c?b.c(Ua(a),c,d):b.call(null,Ua(a),c,d)},"{",", ","}",d,E(a))}ac.prototype.K=!0;
ac.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};V.prototype.K=!0;V.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Bf.prototype.K=!0;Bf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};vf.prototype.K=!0;vf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};$.prototype.K=!0;$.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Ue.prototype.K=!0;Ue.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
cg.prototype.K=!0;cg.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};ye.prototype.K=!0;ye.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};gd.prototype.K=!0;gd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};kc.prototype.K=!0;kc.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};xf.prototype.K=!0;xf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};wf.prototype.K=!0;wf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Ae.prototype.K=!0;Ae.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Qf.prototype.K=!0;Qf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};$f.prototype.K=!0;$f.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};od.prototype.K=!0;od.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Yf.prototype.K=!0;Yf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Y.prototype.K=!0;Y.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};
W.prototype.K=!0;W.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};He.prototype.K=!0;He.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};cd.prototype.K=!0;cd.prototype.w=function(a,b){return ub(b,"()")};Ie.prototype.K=!0;Ie.prototype.w=function(a,b,c){return ug(b,Ag,"#queue ["," ","]",c,E(this))};la.prototype.K=!0;la.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};og.prototype.K=!0;og.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Xf.prototype.K=!0;Xf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};bd.prototype.K=!0;bd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};W.prototype.lb=!0;W.prototype.mb=function(a,b){return Pc.a(this,b)};Ae.prototype.lb=!0;Ae.prototype.mb=function(a,b){return Pc.a(this,b)};T.prototype.lb=!0;T.prototype.mb=function(a,b){return Vb(this,b)};Zb.prototype.lb=!0;Zb.prototype.mb=function(a,b){return Vb(this,b)};
function Dg(a,b){if(a?a.gc:a)return a.gc(a,b);var c;c=Dg[m(null==a?null:a)];if(!c&&(c=Dg._,!c))throw x("IReset.-reset!",a);return c.call(null,a,b)}
var Eg=function(){function a(a,b,c,d,e){if(a?a.nc:a)return a.nc(a,b,c,d,e);var q;q=Eg[m(null==a?null:a)];if(!q&&(q=Eg._,!q))throw x("ISwap.-swap!",a);return q.call(null,a,b,c,d,e)}function b(a,b,c,d){if(a?a.mc:a)return a.mc(a,b,c,d);var e;e=Eg[m(null==a?null:a)];if(!e&&(e=Eg._,!e))throw x("ISwap.-swap!",a);return e.call(null,a,b,c,d)}function c(a,b,c){if(a?a.lc:a)return a.lc(a,b,c);var d;d=Eg[m(null==a?null:a)];if(!d&&(d=Eg._,!d))throw x("ISwap.-swap!",a);return d.call(null,a,b,c)}function d(a,b){if(a?
a.kc:a)return a.kc(a,b);var c;c=Eg[m(null==a?null:a)];if(!c&&(c=Eg._,!c))throw x("ISwap.-swap!",a);return c.call(null,a,b)}var e=null,e=function(e,h,k,l,n){switch(arguments.length){case 2:return d.call(this,e,h);case 3:return c.call(this,e,h,k);case 4:return b.call(this,e,h,k,l);case 5:return a.call(this,e,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};e.a=d;e.c=c;e.n=b;e.s=a;return e}();function Fg(a,b,c,d){this.state=a;this.j=b;this.wc=c;this.Wb=d;this.i=2153938944;this.q=16386}g=Fg.prototype;
g.B=function(){return this[ba]||(this[ba]=++ca)};g.Rb=function(a,b,c){a=E(this.Wb);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);h.n?h.n(k,this,b,c):h.call(null,k,this,b,c);f+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),k=d,e=O(d),d=k):(d=F(a),k=P.c(d,0,null),h=P.c(d,1,null),h.n?h.n(k,this,b,c):h.call(null,k,this,b,c),a=I(a),d=null,e=0),f=0;else return null};g.w=function(a,b,c){ub(b,"#\x3cAtom: ");Ag(this.state,b,c);return ub(b,"\x3e")};g.D=function(){return this.j};
g.ub=function(){return this.state};g.v=function(a,b){return this===b};
var Hg=function(){function a(a){return new Fg(a,null,null,null)}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Gg),d=Q.a(d,pa);return new Fg(a,d,e,null)}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+
arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Ig(a,b){if(a instanceof Fg){var c=a.wc;if(null!=c&&!r(c.b?c.b(b):c.call(null,b)))throw Error("Assert failed: Validator rejected reference state\n"+A.b(Cg.d(J([fd(new Zb(null,"validate","validate",1439230700,null),new Zb(null,"new-value","new-value",-1567397401,null))],0))));c=a.state;a.state=b;null!=a.Wb&&xb(a,c,b);return b}return Dg(a,b)}function K(a){return ab(a)}
var Jg=function(){function a(a,b,c,d){return a instanceof Fg?Ig(a,b.c?b.c(a.state,c,d):b.call(null,a.state,c,d)):Eg.n(a,b,c,d)}function b(a,b,c){return a instanceof Fg?Ig(a,b.a?b.a(a.state,c):b.call(null,a.state,c)):Eg.c(a,b,c)}function c(a,b){return a instanceof Fg?Ig(a,b.b?b.b(a.state):b.call(null,a.state)):Eg.a(a,b)}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return a instanceof
Fg?Ig(a,S.s(c,a.state,d,e,f)):Eg.s(a,c,d,e,f)}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Kg={};
function Lg(a){if(a?a.ac:a)return a.ac(a);var b;b=Lg[m(null==a?null:a)];if(!b&&(b=Lg._,!b))throw x("IEncodeJS.-clj-\x3ejs",a);return b.call(null,a)}function Mg(a){return(a?r(r(null)?null:a.$b)||(a.Cb?0:s(Kg,a)):s(Kg,a))?Lg(a):"string"===typeof a||"number"===typeof a||a instanceof T||a instanceof Zb?Ng.b?Ng.b(a):Ng.call(null,a):Cg.d(J([a],0))}
var Ng=function Og(b){if(null==b)return null;if(b?r(r(null)?null:b.$b)||(b.Cb?0:s(Kg,b)):s(Kg,b))return Lg(b);if(b instanceof T)return id(b);if(b instanceof Zb)return""+A.b(b);if(Gc(b)){var c={};b=E(b);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);c[Mg(k)]=Og(h);f+=1}else if(b=E(b))Ic(b)?(e=Hb(b),b=Ib(b),d=e,e=O(e)):(e=F(b),d=P.c(e,0,null),e=P.c(e,1,null),c[Mg(d)]=Og(e),b=I(b),d=null,e=0),f=0;else break;return c}if(Cc(b)){c=[];b=E(Kd.a(Og,b));d=null;for(f=e=0;;)if(f<
e)k=d.J(null,f),c.push(k),f+=1;else if(b=E(b))d=b,Ic(d)?(b=Hb(d),f=Ib(d),d=b,e=O(b),b=f):(b=F(d),c.push(b),b=I(d),d=null,e=0),f=0;else break;return c}return u?b:null},Pg={};function Qg(a,b){if(a?a.Zb:a)return a.Zb(a,b);var c;c=Qg[m(null==a?null:a)];if(!c&&(c=Qg._,!c))throw x("IEncodeClojure.-js-\x3eclj",a);return c.call(null,a,b)}
var Sg=function(){function a(a){return b.d(a,J([new la(null,1,[Rg,!1],null)],0))}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){if(a?r(r(null)?null:a.Cc)||(a.Cb?0:s(Pg,a)):s(Pg,a))return Qg(a,S.a(Uf,c));if(E(c)){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Rg);return function(a,b,c,d){return function y(e){return Mc(e)?rg.b(Kd.a(y,e)):Cc(e)?Yd(qc(e),Kd.a(y,e)):e instanceof Array?we(Kd.a(y,e)):ta(e)===
Object?Yd(Ye,function(){return function(a,b,c,d){return function Ra(f){return new V(null,function(a,b,c,d){return function(){for(;;){var a=E(f);if(a){if(Ic(a)){var b=Hb(a),c=O(b),h=new ld(Array(c),0);a:{for(var k=0;;)if(k<c){var l=D.a(b,k),l=new W(null,2,5,X,[d.b?d.b(l):d.call(null,l),y(e[l])],null);h.add(l);k+=1}else{b=!0;break a}b=void 0}return b?pd(h.da(),Ra(Ib(a))):pd(h.da(),null)}h=F(a);return M(new W(null,2,5,X,[d.b?d.b(h):d.call(null,h),y(e[h])],null),Ra(G(a)))}return null}}}(a,b,c,d),null,
null)}}(a,b,c,d)(Jc(e))}()):u?e:null}}(c,d,e,r(e)?jd:A)(a)}return null}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Tg(a){this.pb=a;this.q=0;this.i=2153775104}
Tg.prototype.B=function(){for(var a=Cg.d(J([this],0)),b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=4294967296;return b};Tg.prototype.w=function(a,b){return ub(b,'#uuid "'+A.b(this.pb)+'"')};Tg.prototype.v=function(a,b){return b instanceof Tg&&this.pb===b.pb};Tg.prototype.toString=function(){return this.pb};var Ug=new T(null,"ppath","ppath"),Vg=new T("zip","branch?","zip/branch?"),Wg=new T(null,"r","r"),Xg=new T("zip","children","zip/children"),pa=new T(null,"meta","meta"),qa=new T(null,"dup","dup"),u=new T(null,"else","else"),Gg=new T(null,"validator","validator"),Yb=new T(null,"default","default"),Yg=new T(null,"sequential","sequential"),ma=new T(null,"flush-on-newline","flush-on-newline"),Zg=new T(null,"l","l"),$g=new T("zip","make-node","zip/make-node"),oa=new T(null,"readably","readably"),ra=new T(null,
"print-length","print-length"),ah=new T(null,"pnodes","pnodes"),bh=new T(null,"changed?","changed?"),ch=new T(null,"tag","tag"),dh=new T(null,"set","set"),eh=new T(null,"end","end"),fh=new T(null,"atom","atom"),Rg=new T(null,"keywordize-keys","keywordize-keys"),gh=new T(null,"map","map"),hh=new T("mori","not-found","mori/not-found"),ih=new T("cljs.core","not-found","cljs.core/not-found");var jh,kh;function lh(a){return a.o?a.o():a.call(null)}function mh(a){return a.o?a.o():a.call(null)}var nh=function(){function a(a,b,c){return Gc(c)?hb(c,a,b):null==c?b:c instanceof Array?hc.c(c,a,b):u?gb.c(c,a,b):null}function b(a,b){return c.c(a,a.o?a.o():a.call(null),b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function oh(a,b,c,d){if(a?a.Eb:a)return a.Eb(a,b,c,d);var e;e=oh[m(null==a?null:a)];if(!e&&(e=oh._,!e))throw x("CollFold.coll-fold",a);return e.call(null,a,b,c,d)}
var qh=function ph(b,c){"undefined"===typeof jh&&(jh=function(b,c,f,h){this.$=b;this.Qa=c;this.uc=f;this.sc=h;this.q=0;this.i=917504},jh.Db=!0,jh.Bb="clojure.core.reducers/t6322",jh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6322")},jh.prototype.N=function(b,c){return gb.c(this,c,c.o?c.o():c.call(null))},jh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},jh.prototype.D=function(){return this.sc},jh.prototype.F=function(b,c){return new jh(this.$,
this.Qa,this.uc,c)});return new jh(c,b,ph,null)},sh=function rh(b,c){"undefined"===typeof kh&&(kh=function(b,c,f,h){this.$=b;this.Qa=c;this.rc=f;this.tc=h;this.q=0;this.i=917504},kh.Db=!0,kh.Bb="clojure.core.reducers/t6328",kh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6328")},kh.prototype.Eb=function(b,c,f,h){return oh(this.Qa,c,f,this.$.b?this.$.b(h):this.$.call(null,h))},kh.prototype.N=function(b,c){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),c.o?c.o():c.call(null))},
kh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},kh.prototype.D=function(){return this.tc},kh.prototype.F=function(b,c){return new kh(this.$,this.Qa,this.rc,c)});return new kh(c,b,rh,null)},th=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return b.a?b.a(c,a.b?a.b(e):a.call(null,e)):b.call(null,c,a.b?a.b(e):a.call(null,e));case 3:return b.a?
b.a(c,a.a?a.a(e,h):a.call(null,e,h)):b.call(null,c,a.a?a.a(e,h):a.call(null,e,h))}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),uh=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?
b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):c;case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):c}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),vh=function(){function a(a){return sh(a,
function(a){return function(){var b=null;return b=function(b,d){switch(arguments.length){case 0:return a.o?a.o():a.call(null);case 2:return Fc(d)?c.b(d).M(null,a,b):a.a?a.a(b,d):a.call(null,b,d)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(){return function(a){return c.b(a)}}var c=null,c=function(c){switch(arguments.length){case 0:return b.call(this);case 1:return a.call(this,c)}throw Error("Invalid arity: "+arguments.length);};c.o=b;c.b=a;return c}(),wh=function(){function a(a,
b){return uh.a(Gd(a),b)}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),xh=function(){function a(a,b){return qh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):
new ec(c);case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):new ec(c)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),yh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=
function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.a?b.a(c,d):b.call(null,c,d);case 3:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.c?b.c(c,d,e):b.call(null,c,d,e)}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}(),zh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?b.a?b.a(c,d):b.call(null,c,d):c;case 3:return Jg.a(a,Wc),0>ab(a)?b.c?b.c(c,d,e):b.call(null,c,d,e):c}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Bh=function Ah(b,c,d,e){if(Bc(b))return d.o?d.o():d.call(null);if(O(b)<=c)return nh.c(e,d.o?d.o():d.call(null),b);if(u){var f=Yc(O(b)),h=ze.c(b,0,f);b=ze.c(b,f,O(b));return lh(function(b,c,e,f){return function(){var b=f(c),h;h=f(e);return d.a?d.a(b.o?b.o():b.call(null),mh(h)):d.call(null,b.o?b.o():b.call(null),mh(h))}}(f,h,b,function(b,f,h){return function(q){return function(){return function(){return Ah(q,
c,d,e)}}(b,f,h)}}(f,h,b)))}return null};W.prototype.Eb=function(a,b,c,d){return Bh(this,b,c,d)};oh.object=function(a,b,c,d){return nh.c(d,c.o?c.o():c.call(null),a)};oh["null"]=function(a,b,c){return c.o?c.o():c.call(null)};function Ch(a,b){var c=S.c(ig,a,b);return M(c,Vd(function(a){return function(b){return a===b}}(c),b))}
var Dh=function(){function a(a,b){return O(a)<O(b)?C.c(pc,b,a):C.c(pc,a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){a=Ch(O,pc.d(d,c,J([a],0)));return C.c(Yd,F(a),G(a))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 0:return bg;case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.o=function(){return bg};b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Eh=function(){function a(a,b){for(;;)if(O(b)<O(a)){var c=a;a=b;b=c}else return C.c(function(a,b){return function(a,c){return Oc(b,c)?a:Ac.a(a,c)}}(a,b),a,a)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){a=Ch(function(a){return-O(a)},
pc.d(e,d,J([a],0)));return C.c(b,F(a),G(a))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Fh=function(){function a(a,b){return O(a)<O(b)?C.c(function(a,c){return Oc(b,c)?Ac.a(a,c):a},a,a):C.c(Ac,a,b)}var b=null,
c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a,pc.a(e,d))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=
c.d;return b}();function Gh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):new W(null,3,5,X,[a,b,null],null)}function Hh(a){return E(a)?C.c(function(a,c){var d=P.c(c,0,null),e=P.c(c,1,null);return R.c(a,d,e)},we(Od.a(S.a(Xc,Ve(a)),null)),a):null}
function Ih(a,b,c){var d=Q.a(a,c),e=Q.a(b,c),f=Jh.a?Jh.a(d,e):Jh.call(null,d,e),h=P.c(f,0,null),k=P.c(f,1,null),f=P.c(f,2,null);a=Oc(a,c);b=Oc(b,c);d=a&&b&&(null!=f||null==d&&null==e);return new W(null,3,5,X,[!a||null==h&&d?null:new af([c,h]),!b||null==k&&d?null:new af([c,k]),d?new af([c,f]):null],null)}
var Kh=function(){function a(a,b,c){return C.c(function(a,b){return rg.b(Kd.c(Zf,a,b))},new W(null,3,5,X,[null,null,null],null),Kd.a(Id.c(Ih,a,b),c))}function b(a,b){return c.c(a,b,Dh.a(Ve(a),Ve(b)))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function Lh(a,b){return we(Kd.a(Hh,Kh.c(Hc(a)?a:we(a),Hc(b)?b:we(b),pg.b(function(){var c=O(a),d=O(b);return c>d?c:d}()))))}function Mh(a,b){return new W(null,3,5,X,[Cd(Fh.a(a,b)),Cd(Fh.a(b,a)),Cd(Eh.a(a,b))],null)}function Nh(a){if(a?a.qc:a)return a.qc(a);var b;b=Nh[m(null==a?null:a)];if(!b&&(b=Nh._,!b))throw x("EqualityPartition.equality-partition",a);return b.call(null,a)}
function Oh(a,b){if(a?a.pc:a)return a.pc(a,b);var c;c=Oh[m(null==a?null:a)];if(!c&&(c=Oh._,!c))throw x("Diff.diff-similar",a);return c.call(null,a,b)}Nh._=function(a){return(a?a.i&1024||a.cc||(a.i?0:s(Pa,a)):s(Pa,a))?gh:(a?a.i&4096||a.jc||(a.i?0:s(Va,a)):s(Va,a))?dh:(a?a.i&16777216||a.ic||(a.i?0:s(mb,a)):s(mb,a))?Yg:Yb?fh:null};Nh["boolean"]=function(){return fh};Nh["function"]=function(){return fh};Nh.array=function(){return Yg};Nh.number=function(){return fh};Nh.string=function(){return fh};
Nh["null"]=function(){return fh};Oh._=function(a,b){return function(){switch(Nh(a)instanceof T?Nh(a).sa:null){case "map":return Kh;case "sequential":return Lh;case "set":return Mh;case "atom":return Gh;default:throw Error("No matching clause: "+A.b(Nh(a)));}}().call(null,a,b)};Oh["boolean"]=function(a,b){return Gh(a,b)};Oh["function"]=function(a,b){return Gh(a,b)};Oh.array=function(a,b){return Lh(a,b)};Oh.number=function(a,b){return Gh(a,b)};Oh.string=function(a,b){return Gh(a,b)};
Oh["null"]=function(a,b){return Gh(a,b)};function Jh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):Wb.a(Nh(a),Nh(b))?Oh(a,b):Gh(a,b)};function Ph(a){if(a?a.Ub:a)return a.Ub();var b;b=Ph[m(null==a?null:a)];if(!b&&(b=Ph._,!b))throw x("PushbackReader.read-char",a);return b.call(null,a)}function Qh(a,b){if(a?a.Vb:a)return a.Vb(0,b);var c;c=Qh[m(null==a?null:a)];if(!c&&(c=Qh._,!c))throw x("PushbackReader.unread",a);return c.call(null,a,b)}function Rh(a,b,c){this.r=a;this.buffer=b;this.Fb=c}Rh.prototype.Ub=function(){return 0===this.buffer.length?(this.Fb+=1,this.r[this.Fb]):this.buffer.pop()};Rh.prototype.Vb=function(a,b){return this.buffer.push(b)};
function Sh(a){var b=!/[^\t\n\r ]/.test(a);return r(b)?b:","===a}var Th=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,0,e)}function b(a,b){throw Error(S.a(A,b));}a.k=1;a.f=function(a){F(a);a=G(a);return b(0,a)};a.d=b;return a}();
function Uh(a,b){for(var c=new ea(b),d=Ph(a);;){var e;if(!(e=null==d||Sh(d))){e=d;var f="#"!==e;e=f?(f="'"!==e)?(f=":"!==e)?Vh.b?Vh.b(e):Vh.call(null,e):f:f:f}if(e)return Qh(a,d),c.toString();c.append(d);d=Ph(a)}}function Wh(a){for(;;){var b=Ph(a);if("\n"===b||"\r"===b||null==b)return a}}var Xh=tg("^([-+]?)(?:(0)|([1-9][0-9]*)|0[xX]([0-9A-Fa-f]+)|0([0-7]+)|([1-9][0-9]?)[rR]([0-9A-Za-z]+))(N)?$"),Yh=tg("^([-+]?[0-9]+)/([0-9]+)$"),Zh=tg("^([-+]?[0-9]+(\\.[0-9]*)?([eE][-+]?[0-9]+)?)(M)?$"),$h=tg("^[:]?([^0-9/].*/)?([^0-9/][^/]*)$");
function ai(a,b){var c=a.exec(b);return null!=c&&c[0]===b?1===c.length?c[0]:c:null}var bi=tg("^[0-9A-Fa-f]{2}$"),ci=tg("^[0-9A-Fa-f]{4}$");function di(a,b,c,d){return r(sg(a,d))?d:Th.d(b,J(["Unexpected unicode escape \\",c,d],0))}function ei(a){return String.fromCharCode(parseInt(a,16))}
function fi(a){var b=Ph(a),c="t"===b?"\t":"r"===b?"\r":"n"===b?"\n":"\\"===b?"\\":'"'===b?'"':"b"===b?"\b":"f"===b?"\f":null;r(c)?a=c:"x"===b?(c=(new ea(Ph(a),Ph(a))).toString(),a=ei(di(bi,a,b,c))):"u"===b?(c=(new ea(Ph(a),Ph(a),Ph(a),Ph(a))).toString(),a=ei(di(ci,a,b,c))):a=/[^0-9]/.test(b)?u?Th.d(a,J(["Unexpected unicode escape \\",b],0)):null:String.fromCharCode(b);return a}
function gi(a,b){for(var c=yb(qe);;){var d;a:{d=Sh;for(var e=b,f=Ph(e);;)if(r(d.b?d.b(f):d.call(null,f)))f=Ph(e);else{d=f;break a}d=void 0}r(d)||Th.d(b,J(["EOF while reading"],0));if(a===d)return Ab(c);e=Vh.b?Vh.b(d):Vh.call(null,d);r(e)?d=e.a?e.a(b,d):e.call(null,b,d):(Qh(b,d),d=hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null));c=d===b?c:wd.a(c,d)}}function ii(a,b){return Th.d(a,J(["Reader for ",b," not implemented yet"],0))}
function ji(a,b){var c=Ph(a),d=ki.b?ki.b(c):ki.call(null,c);if(r(d))return d.a?d.a(a,b):d.call(null,a,b);d=li.a?li.a(a,c):li.call(null,a,c);return r(d)?d:Th.d(a,J(["No dispatch macro for ",c],0))}function mi(a,b){return Th.d(a,J(["Unmached delimiter ",b],0))}function ni(a){return S.a(fd,gi(")",a))}function oi(a){return gi("]",a)}
function pi(a){var b=gi("}",a),c=O(b);if("number"!==typeof c||isNaN(c)||Infinity===c||parseFloat(c)!==parseInt(c,10))throw Error("Argument must be an integer: "+A.b(c));0!==(c&1)&&Th.d(a,J(["Map literal must contain an even number of forms"],0));return S.a(Tf,b)}function qi(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c)b.append(fi(a)),c=Ph(a);else{if('"'===c)return b.toString();if(Yb)b.append(c),c=Ph(a);else return null}}}
function ri(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c){b.append(c);var d=Ph(a);if(null==d)return Th.d(a,J(["EOF while reading"],0));var e=function(){var a=b;a.append(d);return a}(),f=Ph(a),b=e,c=f}else{if('"'===c)return b.toString();if(u)e=function(){var a=b;a.append(c);return a}(),f=Ph(a),b=e,c=f;else return null}}}
function si(a,b){var c=Uh(a,b);if(r(-1!=c.indexOf("/")))c=$b.a(ad.c(c,0,c.indexOf("/")),ad.c(c,c.indexOf("/")+1,c.length));else var d=$b.b(c),c="nil"===c?null:"true"===c?!0:"false"===c?!1:u?d:null;return c}function ti(a){var b=Uh(a,Ph(a)),c=ai($h,b),b=c[0],d=c[1],c=c[2];return void 0!==d&&":/"===d.substring(d.length-2,d.length)||":"===c[c.length-1]||-1!==b.indexOf("::",1)?Th.d(a,J(["Invalid token: ",b],0)):null!=d&&0<d.length?jd.a(d.substring(0,d.indexOf("/")),c):jd.b(b)}
function ui(a){return function(b){return Da(Da(H,hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null)),a)}}function vi(){return function(a){return Th.d(a,J(["Unreadable form"],0))}}
function wi(a){var b;b=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);b=b instanceof Zb?new la(null,1,[ch,b],null):"string"===typeof b?new la(null,1,[ch,b],null):b instanceof T?new af([b,!0]):u?b:null;Gc(b)||Th.d(a,J(["Metadata must be Symbol,Keyword,String or Map"],0));var c=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return(c?c.i&262144||c.oc||(c.i?0:s(db,c)):s(db,c))?N(c,Zf.d(J([xc(c),b],0))):Th.d(a,J(["Metadata can only be applied to IWithMetas"],0))}function xi(a){return eg(gi("}",a))}
function yi(a){return tg(ri(a))}function zi(a){hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return a}function Vh(a){return'"'===a?qi:":"===a?ti:";"===a?Wh:"'"===a?ui(new Zb(null,"quote","quote",1377916282,null)):"@"===a?ui(new Zb(null,"deref","deref",1494944732,null)):"^"===a?wi:"`"===a?ii:"~"===a?ii:"("===a?ni:")"===a?mi:"["===a?oi:"]"===a?mi:"{"===a?pi:"}"===a?mi:"\\"===a?Ph:"#"===a?ji:null}function ki(a){return"{"===a?xi:"\x3c"===a?vi():'"'===a?yi:"!"===a?Wh:"_"===a?zi:null}
function hi(a,b,c){for(;;){var d=Ph(a);if(null==d)return r(b)?Th.d(a,J(["EOF while reading"],0)):c;if(!Sh(d))if(";"===d)a=Wh.a?Wh.a(a,d):Wh.call(null,a);else if(u){var e=Vh(d);if(r(e))e=e.a?e.a(a,d):e.call(null,a,d);else{var e=a,f=void 0;!(f=!/[^0-9]/.test(d))&&(f=void 0,f="+"===d||"-"===d)&&(f=Ph(e),Qh(e,f),f=!/[^0-9]/.test(f));if(f)a:{e=a;d=new ea(d);for(f=Ph(e);;){var h;h=null==f;h||(h=(h=Sh(f))?h:Vh.b?Vh.b(f):Vh.call(null,f));if(r(h)){Qh(e,f);f=d=d.toString();h=void 0;if(r(ai(Xh,f)))if(f=ai(Xh,
f),null!=f[2])h=0;else{h=r(f[3])?[f[3],10]:r(f[4])?[f[4],16]:r(f[5])?[f[5],8]:r(f[6])?[f[7],parseInt(f[6],10)]:u?[null,null]:null;var k=h[0];null==k?h=null:(h=parseInt(k,h[1]),h="-"===f[1]?-h:h)}else h=void 0,r(ai(Yh,f))?(f=ai(Yh,f),h=parseInt(f[1],10)/parseInt(f[2],10)):h=r(ai(Zh,f))?parseFloat(f):null;f=h;e=r(f)?f:Th.d(e,J(["Invalid number format [",d,"]"],0));break a}d.append(f);f=Ph(e)}e=void 0}else e=u?si(a,d):null}if(e!==a)return e}else return null}}
function Ai(a){if(Wb.a(3,O(a)))return a;if(3<O(a))return ad.c(a,0,3);if(u)for(a=new ea(a);;)if(3>a.Va.length)a=a.append("0");else return a.toString();else return null}var Bi=function(a,b){return function(c,d){return Q.a(r(d)?b:a,c)}}(new W(null,13,5,X,[null,31,28,31,30,31,30,31,31,30,31,30,31],null),new W(null,13,5,X,[null,31,29,31,30,31,30,31,31,30,31,30,31],null)),Ci=/(\d\d\d\d)(?:-(\d\d)(?:-(\d\d)(?:[T](\d\d)(?::(\d\d)(?::(\d\d)(?:[.](\d+))?)?)?)?)?)?(?:[Z]|([-+])(\d\d):(\d\d))?/;
function Di(a){a=parseInt(a,10);return sa(isNaN(a))?a:null}function Ei(a,b,c,d){a<=b&&b<=c||Th.d(null,J([""+A.b(d)+" Failed:  "+A.b(a)+"\x3c\x3d"+A.b(b)+"\x3c\x3d"+A.b(c)],0));return b}
function Fi(a){var b=sg(Ci,a);P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null),l=P.c(b,7,null),n=P.c(b,8,null),q=P.c(b,9,null),t=P.c(b,10,null);if(sa(b))return Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));a=Di(c);var b=function(){var a=Di(d);return r(a)?a:1}(),c=function(){var a=Di(e);return r(a)?a:1}(),v=function(){var a=Di(f);return r(a)?a:0}(),w=function(){var a=Di(h);return r(a)?a:0}(),y=function(){var a=Di(k);return r(a)?
a:0}(),B=function(){var a=Di(Ai(l));return r(a)?a:0}(),n=(Wb.a(n,"-")?-1:1)*(60*function(){var a=Di(q);return r(a)?a:0}()+function(){var a=Di(t);return r(a)?a:0}());return new W(null,8,5,X,[a,Ei(1,b,12,"timestamp month field must be in range 1..12"),Ei(1,c,Bi.a?Bi.a(b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)):Bi.call(null,b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)),"timestamp day field must be in range 1..last day in month"),Ei(0,v,23,"timestamp hour field must be in range 0..23"),
Ei(0,w,59,"timestamp minute field must be in range 0..59"),Ei(0,y,Wb.a(w,59)?60:59,"timestamp second field must be in range 0..60"),Ei(0,B,999,"timestamp millisecond field must be in range 0..999"),n],null)}
var Gi=Hg.b(new la(null,4,["inst",function(a){var b;if("string"===typeof a)if(b=Fi(a),r(b)){a=P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null);b=P.c(b,7,null);b=new Date(Date.UTC(a,c-1,d,e,f,h,k)-6E4*b)}else b=Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));else b=Th.d(null,J(["Instance literal expects a string for its timestamp."],0));return b},"uuid",function(a){return"string"===typeof a?new Tg(a):Th.d(null,J(["UUID literal expects a string as its representation."],
0))},"queue",function(a){return Hc(a)?Yd(Je,a):Th.d(null,J(["Queue literal expects a vector for its elements."],0))},"js",function(a){if(Hc(a)){var b=[];a=E(a);for(var c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e);b.push(f);e+=1}else if(a=E(a))c=a,Ic(c)?(a=Hb(c),e=Ib(c),c=a,d=O(a),a=e):(a=F(c),b.push(a),a=I(c),c=null,d=0),e=0;else break;return b}if(Gc(a)){b={};a=E(a);c=null;for(e=d=0;;)if(e<d){var h=c.J(null,e),f=P.c(h,0,null),h=P.c(h,1,null);b[id(f)]=h;e+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),c=d,
d=O(d)):(d=F(a),c=P.c(d,0,null),d=P.c(d,1,null),b[id(c)]=d,a=I(a),c=null,d=0),e=0;else break;return b}return u?Th.d(null,J(["JS literal expects a vector or map containing only string or unqualified keyword keys"],0)):null}],null)),Hi=Hg.b(null);
function li(a,b){var c=si(a,b),d=Q.a(ab(Gi),""+A.b(c)),e=ab(Hi);return r(d)?d.b?d.b(hi(a,!0,null)):d.call(null,hi(a,!0,null)):r(e)?e.a?e.a(c,hi(a,!0,null)):e.call(null,c,hi(a,!0,null)):u?Th.d(a,J(["Could not find tag parser for ",""+A.b(c)," in ",Cg.d(J([Ve(ab(Gi))],0))],0)):null};p("mori.apply",S);p("mori.count",O);p("mori.distinct",function(a){return function c(a,e){return new V(null,function(){return function(a,d){for(;;){var e=a,l=P.c(e,0,null);if(e=E(e))if(Oc(d,l))l=G(e),e=d,a=l,d=e;else return M(l,c(G(e),pc.a(d,l)));else return null}}.call(null,a,e)},null,null)}(a,bg)});p("mori.empty",qc);p("mori.first",F);p("mori.rest",G);p("mori.seq",E);p("mori.conj",pc);p("mori.cons",M);
p("mori.find",function(a,b){return null!=a&&Ec(a)&&Oc(a,b)?new W(null,2,5,X,[b,Q.a(a,b)],null):null});p("mori.nth",P);p("mori.last",oc);p("mori.assoc",R);p("mori.dissoc",tc);p("mori.get_in",$d);p("mori.update_in",ae);p("mori.assoc_in",function Ii(b,c,d){var e=P.c(c,0,null);return(c=$c(c))?R.c(b,e,Ii(Q.a(b,e),c,d)):R.c(b,e,d)});p("mori.fnil",Jd);p("mori.disj",Ac);p("mori.pop",zc);p("mori.peek",yc);p("mori.hash",Tb);p("mori.get",Q);p("mori.has_key",Oc);p("mori.is_empty",Bc);p("mori.reverse",ed);
p("mori.take",Md);p("mori.drop",Nd);p("mori.take_nth",function Ji(b,c){return new V(null,function(){var d=E(c);return d?M(F(d),Ji(b,Nd(b,d))):null},null,null)});p("mori.partition",Zd);p("mori.partition_all",jg);p("mori.partition_by",function Ki(b,c){return new V(null,function(){var d=E(c);if(d){var e=F(d),f=b.b?b.b(e):b.call(null,e),e=M(e,lg(function(c,d){return function(c){return Wb.a(d,b.b?b.b(c):b.call(null,c))}}(e,f,d,d),I(d)));return M(e,Ki(b,E(Nd(O(e),d))))}return null},null,null)});
p("mori.iterate",function Li(b,c){return M(c,new V(null,function(){return Li(b,b.b?b.b(c):b.call(null,c))},null,null))});p("mori.into",Yd);p("mori.merge",Zf);p("mori.subvec",ze);p("mori.take_while",lg);p("mori.drop_while",function(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b),f;f=(f=e)?a.b?a.b(F(e)):a.call(null,F(e)):f;if(r(f))f=a,e=G(e),a=f,b=e;else return e}}),null,null)});
p("mori.group_by",function(a,b){return C.c(function(b,d){var e=a.b?a.b(d):a.call(null,d);return R.c(b,e,pc.a(Q.c(b,e,qe),d))},Ye,b)});p("mori.interpose",function(a,b){return Nd(1,Qd.a(Od.b(a),b))});p("mori.interleave",Qd);p("mori.concat",td);p("mori.conj1",function(a,b){return a.G(null,b)});function Xd(a){return a instanceof Array||Fc(a)}p("mori.flatten",function(a){return Ud(function(a){return!Xd(a)},G(Wd(a)))});p("mori.lazy_seq",function(a){return new V(null,a,null,null)});p("mori.keys",Ve);
p("mori.select_keys",function(a,b){for(var c=Ye,d=E(b);;)if(d)var e=F(d),f=Q.c(a,e,ih),c=Bd.a(f,ih)?R.c(c,e,f):c,d=I(d);else return c});p("mori.vals",We);p("mori.prim_seq",mc);p("mori.map",Kd);p("mori.mapcat",Sd);p("mori.reduce",C);p("mori.reduce_kv",function(a,b,c){return null!=c?hb(c,a,b):b});p("mori.filter",Ud);p("mori.remove",Vd);p("mori.some",Ed);p("mori.every",Dd);p("mori.equals",Wb);p("mori.range",pg);p("mori.repeat",Od);p("mori.repeatedly",Pd);p("mori.sort",Sc);p("mori.sort_by",Tc);
p("mori.into_array",xa);p("mori.subseq",ng);p("mori.rmap",th);p("mori.rfilter",uh);p("mori.rremove",wh);p("mori.rtake",yh);p("mori.rtake_while",xh);p("mori.rdrop",zh);p("mori.rflatten",vh);p("mori.list",fd);p("mori.vector",xe);p("mori.array_map",Uf);p("mori.hash_map",Tf);p("mori.set",eg);p("mori.sorted_set",fg);p("mori.sorted_set_by",gg);p("mori.sorted_map",Vf);p("mori.sorted_map_by",Wf);
p("mori.queue",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return Yd.a?Yd.a(Je,a):Yd.call(null,Je,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());p("mori.keyword",jd);p("mori.symbol",$b);p("mori.zipmap",function(a,b){for(var c=yb(Ye),d=E(a),e=E(b);;)if(d&&e)c=xd.c(c,F(d),F(e)),d=I(d),e=I(e);else return Ab(c)});
p("mori.is_list",function(a){return a?a.i&33554432||a.Ec?!0:a.i?!1:s(nb,a):s(nb,a)});p("mori.is_seq",Mc);p("mori.is_vector",Hc);p("mori.is_map",Gc);p("mori.is_set",Dc);p("mori.is_keyword",function(a){return a instanceof T});p("mori.is_symbol",function(a){return a instanceof Zb});p("mori.is_collection",Cc);p("mori.is_sequential",Fc);p("mori.is_associative",Ec);p("mori.is_counted",ic);p("mori.is_indexed",jc);p("mori.is_reduceable",function(a){return a?a.i&524288||a.Nb?!0:a.i?!1:s(fb,a):s(fb,a)});
p("mori.is_seqable",function(a){return a?a.i&8388608||a.hc?!0:a.i?!1:s(kb,a):s(kb,a)});p("mori.is_reversible",dd);p("mori.union",Dh);p("mori.intersection",Eh);p("mori.difference",Fh);p("mori.is_subset",function(a,b){return O(a)<=O(b)&&Dd(function(a){return Oc(b,a)},a)});p("mori.is_superset",function(a,b){return O(a)>=O(b)&&Dd(function(b){return Oc(a,b)},b)});p("mori.partial",Id);p("mori.comp",Hd);
p("mori.pipeline",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.a?C.a(function(a,b){return b.b?b.b(a):b.call(null,a)},a):C.call(null,function(a,b){return b.b?b.b(a):b.call(null,a)},a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.curry",function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return function(e){return S.a(a,M.a?M.a(e,b):M.call(null,e,b))}}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}());
p("mori.juxt",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,c)}function e(b){return xa.b?xa.b(Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,b)},a)):xa.call(null,Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,
b)},a))}b.k=0;b.f=function(a){a=E(a);return e(a)};b.d=e;return b}()}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.knit",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(b){return xa.b?xa.b(Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b)):xa.call(null,Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b))}}a.k=0;a.f=function(a){a=E(a);return b(a)};
a.d=b;return a}());p("mori.diff",Jh);p("mori.sum",function(a,b){return a+b});p("mori.inc",function(a){return a+1});p("mori.dec",function(a){return a-1});p("mori.is_even",function(a){return 0===(a%2+2)%2});p("mori.is_odd",function(a){return 1===(a%2+2)%2});p("mori.each",function(a,b){for(var c=E(a),d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f);b.b?b.b(h):b.call(null,h);f+=1}else if(c=E(c))d=c,Ic(d)?(c=Hb(d),e=Ib(d),d=c,h=O(c),c=e,e=h):(h=F(d),b.b?b.b(h):b.call(null,h),c=I(d),d=null,e=0),f=0;else return null});
p("mori.identity",Fd);p("mori.constantly",function(a){return function(){function b(b){0<arguments.length&&J(Array.prototype.slice.call(arguments,0),0);return a}b.k=0;b.f=function(b){E(b);return a};b.d=function(){return a};return b}()});p("mori.clj_to_js",Ng);
p("mori.js_to_clj",function(){function a(a,b){return Sg.d(a,J([Rg,b],0))}function b(a){return Sg.b(a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}());p("mori.parse",function(a){return hi(new Rh(a,[],-1),!1,null)});
p("mori.configure",function(a,b){switch(a){case "print-length":return ia=b;case "print-level":return ja=b;default:throw Error("No matching clause: "+A.b(a));}});
p("mori.proxy",function(a){if("undefined"!==typeof Proxy)return Proxy.create(function(){return{has:function(b){return Oc(a,b)},hasOwn:function(b){return Oc(a,b)},get:function(b,c){var d=Q.c?Q.c(a,c,hh):Q.call(null,a,c,hh);return hd(d,hh)?ic(a)&&"length"===c?O.b?O.b(a):O.call(null,a):null:u?d:null},set:function(){return null},enumerate:function(){return xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a))},keys:function(){return Gc(a)?xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,
a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a)):Hc(a)?xa.b?xa.b(pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):xa.call(null,pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):null}}}());throw Error("ES6 Proxy not supported!");});V.prototype.inspect=function(){return this.toString()};ac.prototype.inspect=function(){return this.toString()};kc.prototype.inspect=function(){return this.toString()};Bf.prototype.inspect=function(){return this.toString()};
vf.prototype.inspect=function(){return this.toString()};wf.prototype.inspect=function(){return this.toString()};bd.prototype.inspect=function(){return this.toString()};gd.prototype.inspect=function(){return this.toString()};cd.prototype.inspect=function(){return this.toString()};W.prototype.inspect=function(){return this.toString()};od.prototype.inspect=function(){return this.toString()};ye.prototype.inspect=function(){return this.toString()};Ae.prototype.inspect=function(){return this.toString()};
$.prototype.inspect=function(){return this.toString()};Y.prototype.inspect=function(){return this.toString()};la.prototype.inspect=function(){return this.toString()};xf.prototype.inspect=function(){return this.toString()};Qf.prototype.inspect=function(){return this.toString()};$f.prototype.inspect=function(){return this.toString()};cg.prototype.inspect=function(){return this.toString()};og.prototype.inspect=function(){return this.toString()};T.prototype.inspect=function(){return this.toString()};
Zb.prototype.inspect=function(){return this.toString()};Ie.prototype.inspect=function(){return this.toString()};He.prototype.inspect=function(){return this.toString()};p("mori._equiv",function(a,b){return a.Hc(b)});p("mori._keys",function(a){return a.keys()});p("mori._values",function(a){return a.values()});p("mori._entries",function(a){return a.entries()});p("mori._has",function(a){return a.has()});p("mori._get",function(a){return a.get()});p("mori._forEach",function(a){return a.forEach()});
p("mori._next",function(a){return a.next()});p("mori.mutable.thaw",function(a){return yb(a)});p("mori.mutable.freeze",vd);p("mori.mutable.conj1",function(a,b){return a.Ka(null,b)});p("mori.mutable.conj",wd);p("mori.mutable.assoc",xd);p("mori.mutable.dissoc",yd);p("mori.mutable.pop",function(a){return Eb(a)});p("mori.mutable.disj",zd);function Mi(a,b,c,d){return N(new W(null,2,5,X,[d,null],null),new la(null,3,[$g,c,Xg,b,Vg,a],null))}function Ni(a){return a.b?a.b(0):a.call(null,0)}function Oi(a){return Vg.b(xc(a)).call(null,Ni(a))}function Pi(a){if(r(Oi(a)))return Xg.b(xc(a)).call(null,Ni(a));throw"called children on a leaf node";}function Qi(a,b,c){return $g.b(xc(a)).call(null,b,c)}
function Ri(a){if(r(Oi(a))){var b=P.c(a,0,null),c=P.c(a,1,null),d=Pi(a),e=P.c(d,0,null),f=$c(d);return r(d)?N(new W(null,2,5,X,[e,new la(null,4,[Zg,qe,ah,r(c)?pc.a(ah.b(c),b):new W(null,1,5,X,[b],null),Ug,c,Wg,f],null)],null),xc(a)):null}return null}
function Si(a){var b=P.c(a,0,null),c=P.c(a,1,null),d=Mc(c)?S.a(Tf,c):c,c=Q.a(d,Zg),e=Q.a(d,Ug),f=Q.a(d,ah),h=Q.a(d,Wg),d=Q.a(d,bh);return r(f)?(f=yc(f),N(r(d)?new W(null,2,5,X,[Qi(a,f,td.a(c,M(b,h))),r(e)?R.c(e,bh,!0):e],null):new W(null,2,5,X,[f,e],null),xc(a))):null}function Ti(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg),f=P.c(e,0,null),h=$c(e);return r(r(c)?e:c)?N(new W(null,2,5,X,[f,R.d(c,Zg,pc.a(d,b),J([Wg,h],0))],null),xc(a)):null}
function Ui(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?e:c)?N(new W(null,2,5,X,[oc(e),R.d(c,Zg,S.n(pc,d,b,hg(e)),J([Wg,null],0))],null),xc(a)):a}function Vi(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[yc(d),R.d(c,Zg,zc(d),J([Wg,M(b,e)],0))],null),xc(a)):null}
function Wi(a,b){P.c(a,0,null);var c=P.c(a,1,null);return N(new W(null,2,5,X,[b,R.c(c,bh,!0)],null),xc(a))}var Xi=function(){function a(a,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,a,d,f)}function b(a,b,e){return Wi(a,S.c(b,Ni(a),e))}a.k=2;a.f=function(a){var d=F(a);a=I(a);var e=F(a);a=G(a);return b(d,e,a)};a.d=b;return a}();p("mori.zip.zipper",Mi);p("mori.zip.seq_zip",function(a){return Mi(Mc,Fd,function(a,c){return N(c,xc(a))},a)});p("mori.zip.vector_zip",function(a){return Mi(Hc,E,function(a,c){return N(we(c),xc(a))},a)});p("mori.zip.node",Ni);p("mori.zip.is_branch",{}.xc);p("mori.zip.children",Pi);p("mori.zip.make_node",Qi);p("mori.zip.path",function(a){return ah.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.lefts",function(a){return E(Zg.b(a.b?a.b(1):a.call(null,1)))});
p("mori.zip.rights",function(a){return Wg.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.down",Ri);p("mori.zip.up",Si);p("mori.zip.root",function(a){for(;;){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return Ni(a);var b=Si(a);if(r(b))a=b;else return Ni(a)}});p("mori.zip.right",Ti);p("mori.zip.rightmost",Ui);p("mori.zip.left",Vi);
p("mori.zip.leftmost",function(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[F(d),R.d(c,Zg,qe,J([Wg,td.d(G(d),new W(null,1,5,X,[b],null),J([e],0))],0))],null),xc(a)):a});p("mori.zip.insert_left",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Zg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Zg,pc.a(e,b),J([bh,!0],0))],null),xc(a))});
p("mori.zip.insert_right",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Wg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Wg,M(b,e),J([bh,!0],0))],null),xc(a))});p("mori.zip.replace",Wi);p("mori.zip.edit",Xi);p("mori.zip.insert_child",function(a,b){return Wi(a,Qi(a,Ni(a),M(b,Pi(a))))});p("mori.zip.append_child",function(a,b){return Wi(a,Qi(a,Ni(a),td.a(Pi(a),new W(null,1,5,X,[b],null))))});
p("mori.zip.next",function(a){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return a;var b;b=Oi(a);b=r(b)?Ri(a):b;if(r(b))return b;b=Ti(a);if(r(b))return b;for(;;)if(r(Si(a))){b=Ti(Si(a));if(r(b))return b;a=Si(a)}else return new W(null,2,5,X,[Ni(a),eh],null)});p("mori.zip.prev",function(a){var b=Vi(a);if(r(b))for(a=b;;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return Si(a)});p("mori.zip.is_end",function(a){return Wb.a(eh,a.b?a.b(1):a.call(null,1))});
p("mori.zip.remove",function(a){P.c(a,0,null);var b=P.c(a,1,null),b=Mc(b)?S.a(Tf,b):b,c=Q.a(b,Zg),d=Q.a(b,Ug),e=Q.a(b,ah),f=Q.a(b,Wg);if(null==b)throw"Remove at top";if(0<O(c))for(a=N(new W(null,2,5,X,[yc(c),R.d(b,Zg,zc(c),J([bh,!0],0))],null),xc(a));;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return N(new W(null,2,5,X,[Qi(a,yc(e),f),r(d)?R.c(d,bh,!0):d],null),xc(a))});;return this.mori;}.call({});});

},{}],12:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * A `Sequencer` advances its underlying sequence on `advance()`, and provides that value on `value()`. The only
   * guarantee a sequencer provides is that `value()` is always non-decreasing over time (i.e., after multiple calls
   * to `advance()`, a sequencer will never be smaller than the previous call - but it may also not be bigger).
   *
   */
  var UnitSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UnitSequencer.prototype, {
    initialize: function(opts) {
      opts           = Options.fromObject(opts);
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances its sequence by `by`, or by `1` if `by` is not provided.
     *
     * @param by {number} the amount to advance by. Defaults to `1`.
     * @async
     * @returns {Promise<undefined>}
     */
    advance: Promise.method(function(by) {
      // Wahh wahh - don't use `by || 1`, or you can't advance by 0, which is silly
      // but potentially necessary.
      by             = _.isUndefined(by) ? 1 : by;

      if (by < 0) {
        throw new Error("UnitSequencer#advance() requires positive `by` offset");
      }

      this._sequence = this._sequence + by;
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return UnitSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":7,"underscore":63,"bluebird":64}],13:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * See `UnitSequencer` for a high-level explanation of Sequencer semantics.
   *
   * A Sequencer which advances by reading from a Clock.
   * Note that this ClockSequencer relies on the Clock protocol, which
   * only provides `Clock#getTime()`. It does not modify the clock itself.
   * This means if you're using a LogicalClock, it's still up to the clock's
   * owner to advance the clock for the sequencer to advance.
   */
  var ClockSequencer = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ClockSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._clock    = opts.getOrError("clock");
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances by setting its sequence to the backing clock's time.
     * Note that if this method is called twice within the same time unit,
     * the sequence will not actually advance, since unique time is not
     * guaranteed by our clocks.
     *
     * @async
     * @returns {Promise<>}
     */
    advance: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._clock.getTime();
        })
        .then(function(t) {
          this._sequence = t;
        });
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return ClockSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":7,"underscore":63,"bluebird":64}],14:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * See `UnitSequencer` for a high-level explanation of Sequencer semantics.
   *
   * A UnitSequencer which reports its sequence summed with the sequences
   * of its internal collection of sequencers.
   *
   * This device is useful for tracking the state of data comprised from multiple
   * sources. For instance, you might have CachingDataStore(A) storing data
   * from Source(A), tracked by Sequencer(A), and CachingDataStore(B) storing
   * data from Source(B), tracked by Sequencer(B). Meanwhile, you may have
   * CachingDataStore(C), storing data from Source(A + B), and tracked by
   * Sequencer(C) = Sequencer(A + B) - a DelegatingCompositeSequencer.
   *
   * Thus, if Sequencer(A) is advanced, it may invalidate CachingDataStore(A) or
   * CachingDataStore(C) or both.
   *
   * Note this particular usage is generally only useful for Unit sequencers.
   *
   * If you'd like the above functionality, but with Sequencer(A) and
   * Sequencer(B) as ClockSequencers, and Sequencer(C) merely tracking
   * modification, you'd need to use a DelegatingForwardingSequencer for A and B,
   * forwarding them to UnitSequencer(C).
   *
   * DelegatingCompositeSequencer and DelegatingForwardingSequencer are effectivly
   * opposites of each other. DelegatingCompositeSequencer composes the `value`
   * of multiple underlying sequencers (pull), and DelegatingForwardingSequencer
   * forwards the `advance` call to multiple targets (push).
   */
  var DelegatingCompositeSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingCompositeSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._sequencers = _.clone(opts.getOrElse("sequencers", []));
    },
    addSequencer: function(seq) {
      this._sequencers.push(seq);
    },
    advance: function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments);
    },
    value: function() {
      return _
        .chain(this._sequencers)
        .invoke("value")
        .reduce(function(sum, n) {
          return sum + n;
        }, 0)
        .value() + this._delegateSequencer.value();
    }
  });

  return DelegatingCompositeSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":7,"underscore":63,"bluebird":64}],15:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * See `UnitSequencer` for a high-level explanation of Sequencer semantics.
   *
   * A Sequencer which delegates to another sequencer for both `advance` and `value`, and also forwards `advance` to
   * other `target` sequencers. It is the logical complement of a `DelegatingCompositeSequencer`, which derives its `value` from
   * its underlying `sequencers`.
   *
   *
   */
  var DelegatingForwardingSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingForwardingSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._forwardTargets = _.clone(opts.getOrElse("targets", []));
    },
    addTarget: function(seq) {
      this._forwardTargets.push(seq);
    },
    advance: Promise.method(function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments)
      .bind(this)
      .then(function(val) {
        return Promise
          .all(_.invoke(this._forwardTargets, "advance"))
          .then(function() {
            // Return the value returned by the delegate sequencer's
            // advance call (if any). The advancement of the forward
            // targets should be transparent.
            return val;
          });
      });
    }),
    value: function() {
      var s = this._delegateSequencer;
      return s.value.apply(s, arguments);
    }
  });

  return DelegatingForwardingSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":7,"underscore":63,"bluebird":64}],25:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {
  /**
   * A Clock which allows manually manipulating the underlying time value,
   * irrespective of real time. Useful for testing.
   */
  var LogicalClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LogicalClock.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._currentTime = opts.getOrElse("initialTime", 0);
    },

    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return this._currentTime;
    }),

    /**
     * Advances internal time, either `opts.by` a certain offset, or
     * `opts.to` a particular absolute time. If successful, returns the result
     * of calling `LogicalClock#getTime()` as a convenience.
     *
     * @param opts.to {number} absolute time to set clock to. Must be larger
     *                         than the current time
     * @param opts.by {number} offset to add to current time. Must be positive.
     *                         Defaults to `1` if neither `opts.to` or `opts.by`
     *                         are specified.
     * @async
     * @returns {Promise<number>} result of `LogicalClock#getTime()`
     */
    advanceTime: Promise.method(function(opts){
      opts = Options.fromObject(opts);
      var by = opts.getOrElse("by", 1),
          to = opts.getOrElse("to", undefined);
      if (!_.isUndefined(to)) {
        if (to < this._currentTime) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time")
        }
        this._currentTime = to;
      } else {
        if (by < 0) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time");
        }
        this._currentTime = this._currentTime + by;
      }
      return this.getTime();
    })
  });

  return LogicalClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../../core/options")
);

})()
},{"../../core/options":7,"underscore":63,"bluebird":64}],26:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A Clock which delegates to the system clock.
   */
  var SystemClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(SystemClock.prototype, {
    initialize: function() {},
    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return Date.now();
    })
  });

  return SystemClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"underscore":63,"bluebird":64}],28:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfiguration
) {

  /**
   * A device for resolving a set of raw configurations given a set of
   * scopes.
   *
   * This is useful for having things like region- or stage-specific (and/or both)
   * configurations.
   *
   * Given sets of raw configurations of the form:
   *
   *   {
   *     "scope-1" : {
   *       "key1" : "val1"
   *     },
   *     "scope-1+env1": {
   *       "key2" : "val-env-1"
   *     },
   *     "scope-1+env2": {
   *       "key2" : "val-env-2"
   *     }
   *   }
   *
   * `resolve(["scope-1"])` will return:
   *
   *   {
   *     "key1" : "val2"
   *   }
   *
   * `resolve(["scope-1", "env-1"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-1"
   *   }
   *
   * `resolve(["scope-1", "env-2"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-2"
   *   }
   *
   * Scopes unions are resolved in the following manner:
   *   1. a given scope union's parts are sorted
   *   2. scope unions as a whole are applied in sorted order
   *   3. repeat the process for a given configuration
   *
   * So, given three configs:
   *
   *  {
   *    "aaa": ... // 1
   *    "ccc": ... // 2
   *  }
   *
   *  {
   *    "aaa+ccc": ... // 3
   *    "ccc"    : ... // 4
   *  }
   *
   *  {
   *    "aaa+bbb": ... // 5
   *    "bbb"    : ... // 6
   *  }
   *
   * The resulting order will be:
   *   1, 2, 4, 3, 6, 5
   *
   * Notice 3 comes before 5 even though it's logically "after" in sorted order,
   * because configuration order overrides scope order. That is, scope unions
   * are ordered within a config, and then in config order.
   *
   */
  var ScopedConfigurationResolver = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfigurationResolver.prototype, {
    initialize: function() {
      this._configs = [];
    },

    /**
     * A rawConfig is a set of configuration scopes and their configuration
     * values, e.g.:
     *
     *   {
     *     "scope-1" : {
     *       "key1" : "val1"
     *     },
     *     "scope-1+env1": {
     *       "key2" : "val-env-1"
     *     },
     *     "scope-1+env2": {
     *       "key2" : "val-env-2"
     *     }
     *   }
     *
     * Note that the plus (+) sign is reserved for specifying scope unions.
     *
     * @param rawConfig {object} (required)
     *
     * @returns this
     */
    add: function(rawConfig) {
      this._configs.push(new ScopedConfiguration(rawConfig));
      return this;
    },

    /**
     * Resolves a computed final configuration given a set of scopes to apply,
     * and a set of configs loaded via `ScopedConfigurationResolver#add()`.
     *
     * @param scopes {Array<string>}
     *
     * @returns {object} the computed configuration
     */
    resolve: function(scopes) {
      scopes = powerset(_.clone(scopes).sort());
      scopes.shift(); // Get rid of the empty set.

      scopes = _.collect(scopes, function(s) {
        return s.join("+");
      });

      var relevantConfigs = _
        .chain(this._configs)
        .collect(function(c) {
          return _.collect(scopes, function(scope) {
            return c.blobForScope(scope);
          })
        }).flatten().value();

      relevantConfigs.unshift({});
      return _.extend.apply(_, relevantConfigs);
    }
  });

  var powerset = function (ary) {
      var ps = [[]];
      for (var i=0; i < ary.length; i++) {
          for (var j = 0, len = ps.length; j < len; j++) {
              ps.push(ps[j].concat(ary[i]));
          }
      }
      return ps;
  }

  return ScopedConfigurationResolver;
};

module.exports = mod(
  require("underscore"),
  require("./scoped-configuration")
);

})()
},{"./scoped-configuration":29,"underscore":63}],29:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * Given a raw config, ensures blobs can be fetched regardless of
   * scope union scope (i.e., does union canonicalization).
   *
   * For example, a config with scope union `"bbb+aaa"` can later be
   * fetched using either `"aaa+bbb"` or `"bbb+aaa"`. It does this
   * by uniformly ordering the union's composite scopes.
   *
   * This probably isn't a useful class on its own. Instead, defer to
   * `ScopedConfigurationResolver` or `ConfigurationMagic`.
   */
  var ScopedConfiguration = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfiguration.prototype, {
    initialize: function(rawConfig) {
      rawConfig = rawConfig || {};
      this._scopes = {};
      // Sort the scope strings
      _.each(rawConfig, function(config, scopeString) {
        var scope = scopeString.split("+").sort().join("+");
        this._scopes[scope] = config;
      }, this);
    },

    blobForScope: function(scope) {
      return _.clone(this._scopes[scope.split("+").sort().join("+")] || {});
    }
  });

  return ScopedConfiguration;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],31:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  Options
) {

  /**
   * A Logger.
   *
   * Any appender provided to `addAppender` should have a .log method (see `ConsoleLogAppender`).
   *
   */
  var Logger = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Logger.prototype, {

    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._name         = opts.getOrElse("name", "Default");
      this._logLevel     = opts.getOrElse("logLevel", LogUtil.Level.Info);
      this._parent       = opts.getOrElseFn("refParent", function() { return Ref(null) });
      this._muted        = {};
      this._appenders = [];
    },

    mute: function(name) {
      this._muted[name] = true;
    },

    unmute: function(name) {
      delete this._muted[name];
    },

    trace: function() {
      this._log(LogUtil.Level.Trace, _.toArray(arguments));
    },

    debug: function() {
      this._log(LogUtil.Level.Debug, _.toArray(arguments));
    },

    info: function() {
      this._log(LogUtil.Level.Info, _.toArray(arguments));
    },

    warn: function() {
      this._log(LogUtil.Level.Warn, _.toArray(arguments));
    },

    error: function() {
      this._log(LogUtil.Level.Error, _.toArray(arguments));
    },

    fatal: function() {
      this._log(LogUtil.Level.Fatal, _.toArray(arguments));
    },

    isTraceEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Trace);
    },

    isDebugEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Debug);
    },

    isInfoEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Info);
    },

    isWarnEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Warn);
    },

    isErrorEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Error);
    },

    isFatalEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Fatal);
    },

    isLogLevelEnabled: function(logLevel) {
      var coercedLogLevel = b(logLevel);
      return this._isCoercedLogLevelEnabled(coercedLogLevel);
    },

    _isCoercedLogLevelEnabled: function(coercedLogLevel) {
      return ((this._logLevel & coercedLogLevel) === coercedLogLevel) ||
        (this._parent.get() && this._parent.get()._isCoercedLogLevelEnabled(coercedLogLevel));
    },

    addAppender: function(appender) {
      this._appenders.push(appender);
    },

    setLogLevel: function(logLevel) {
      // Save a copy for the potential error message
      var originalLogLevel = logLevel;

      // If name is specified, e.g., "Info", convert to
      // int
      if (_.isString(logLevel)) {
        logLevel = LogUtil.Level[logLevel]
      }

      var exists = _.detect(LogUtil.Level, function(level, name) {
        return level === logLevel;
      });

      if (!exists) {
        throw new Error("Invalid logLevel: " + originalLogLevel);
      }

      this._logLevel = logLevel;
    },


    _log: function(logLevel, logArgs) {
      this._logWithMetadata([], logLevel, logArgs);
    },

    _isMuted: function(name) {
      return !!this._muted[name];
    },

    _logWithMetadata: function(descendants, logLevel, args) {
      var leaf = descendants[descendants.length - 1] || this._name;
      if (this.isLogLevelEnabled(logLevel) && !this._isMuted(leaf)) {
        _.each(this._appenders, function(appender) {
          appender.log(this._name, descendants, logLevel, LogUtil._Label[logLevel], args);
        }, this);
      }

      if (this._parent.get()) {
        this._parent.get()._logWithMetadata([this._name].concat(descendants), logLevel, args);
      }
    }
  });

  var LogUtil = function() {
    this.initialize.apply(this, arguments);
  };

  // Coerce (just use rightmost 8 bits)!; because JS is dumb, and everything is
  // actually a float with 53-bit precision
  var b = function(v) {
    return 0xFF & v;
  };

  _.extend(LogUtil, {
    Level: {
      Trace: b(parseInt("111111", 2)),
      Debug: b(parseInt("011111", 2)),
      Info:  b(parseInt("001111", 2)),
      Warn:  b(parseInt("000111", 2)),
      Error: b(parseInt("000011", 2)),
      Fatal: b(parseInt("000001", 2))
    }
  });

  _.extend(LogUtil.prototype, {
    Level: LogUtil.Level,
    initialize: function() {
      this._rootLogger = Ref(new Logger({
        name: "Root"
      }));
    },

    create: function(name, opts) {
      opts = _.clone(opts || {});

      var parent;
      if (opts.parent) {
        parent = Ref(opts.parent);
        delete(opts.parent);
      } else {
        parent = Ref.delegating(this._rootLogger);
      }

      opts.refParent = parent;

      opts.name = name;

      return new Logger(opts);
    },

    root: function() {
      return this._rootLogger.get();
    },

    resetRootLogger: function() {
      this._rootLogger.set(new Logger({
        name: "Root"
      }));
    }
  });


  LogUtil._Label = _.reduce(LogUtil.Level, function(memo, val, key) {
    memo[val] = key;
    return memo;
  }, {});

  return new LogUtil();
};

module.exports = mod(
  require("underscore"),
  require("../ref"),
  require("../options")
);

})()
},{"../options":7,"../ref":47,"underscore":63}],33:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  UUID,
  Options,
  StateGuard
) {

  /**
   * A channel is a path through which messages flow.
   *
   * Channels are meant to have a single publisher, multiple subscribers.
   *
   * This is "enforced" using a sentinel. The same sentinel provided during
   * instantiation must be used when calling `publish`, else an exception
   * is raised.
   *
   */
  var Channel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Channel.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._sentinel      = opts.getOrError("sentinel");
      this._stateGuard    = new StateGuard(["disposed"]);
      this._subscriptions = M.hash_map();
    },

    reset: function() {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });
      this._subscriptions = M.hash_map();
    },

    publish: function(sentinel, msg) {
      return this._publish.apply(this, arguments);
    },


    subscribe: function(handler) {
      return this._subscribe.apply(this, arguments);
    },


    dispose: function() {
      return this._dispose.apply(this, arguments);
    },


    isDisposed: function() {
      return this._stateGuard.applied("disposed");
    },


    _publish: function(sentinel, msg) {
      this._stateGuard.deny("disposed");

      if (this._sentinel !== sentinel) {
        throw new Error("Invalid sentinel provided; publisher must have same sentinel provided during instantiation.");
      }
      this._dispatch(msg);
      return true;
    },


    _subscribe: function(handler) {
      this._stateGuard.deny("disposed");

      var sub = new Subscription(this, handler),
          id  = sub.id();

      this._subscriptions = M.assoc(this._subscriptions, id, sub);

      return sub;
    },


    _dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      // Gnarly, as this hops back and forth between the channel and the sub, but
      // easier than splitting the dispose logic into two methods in the sub.
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._subscriptions = M.hash_map();

      this._stateGuard.apply("disposed");
    },


    _dispatch: function(msg) {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispatch(msg);
      });
    },


    _disposeHandle: function(id) {
      this._subscriptions = M.dissoc(this._subscriptions, id);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(channel, handler) {
      this._id         = UUID.v4();
      this._channel    = channel;
      this._handler    = handler;
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "dispose");
    },


    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._channel._disposeHandle(this._id);

      this._handler = null;
      this._channel = null;

      this._stateGuard.apply("disposed");
    },


    id: function() {
      return this._id;
    },


    dispatch: function(msg) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._handler(msg);
    }
  });

  return Channel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../uuid"),
  require("../options"),
  require("../state-guard")
);

})()
},{"../uuid":40,"../options":7,"../state-guard":10,"underscore":63,"mori":65}],34:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  // FIXME: Delete this in favor of CompositeChannel
  var ChainedChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ChainedChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      _.bindAll(this, "_forward");
      this._chainedSubs = M.vector();

      var initiallyChainedTo = opts.getOrElse("chainTo");
      if (initiallyChainedTo) {
        this.chainTo(initiallyChainedTo);
      }
    },

    chainTo: function(otherChannel) {
      this._chainedSubs = M.conj(this._chainedSubs, otherChannel.subscribe(this._forward));
    },

    dispose: function() {
      var subs = this._chainedSubs;

      this._chainedSubs = M.vector();

      M.each(subs, function(sub) {
        sub.dispose();
      });

      return this._dispose.apply(this, arguments);
    },

    _forward: function(msg) {
      this._publish(this._sentinel, msg);
    }
  });

  return ChainedChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"./channel":33,"../options":7,"underscore":63,"mori":65}],35:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  /**
   * A channel which listens to other channels, and forwards their messages as through published to this channel
   *
   */
  var CompositeChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CompositeChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      this._forwarding = M.hash_map();

      var listen = opts.getOrElse("listen", []);
      if (!_.isArray(listen)) {
        listen = [listen];
      }

      _.each(listen, _.bind(function(c) {
        this.listen(c);
      }, this));
    },


    dispose: function() {
      Channel.prototype.dispose.apply(this, arguments);
      var forwarding = this._forwarding;
      this._forwarding = M.hash_map();

      M.each(forwarding, _.bind(function(pair) {
        M.nth(pair, 1).dispose();
      }, this));
    },


    listen: function(channel) {
      var sub = channel.subscribe(_.bind(function(msg) {
        this._forward(msg)
      }, this));
      this._forwarding = M.assoc(this._forwarding, channel, sub);

      return {
        dispose: _.bind(function() {
          this._forwarding = M.dissoc(this._forwarding, channel);
          sub.dispose();
        }, this)
      };
    },


    _forward: function(msg) {
      this.publish(this._sentinel, msg);
    }
  });

  return CompositeChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":7,"./channel":33,"underscore":63,"mori":65}],38:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger
) {

  /**
   * A fiber dictates how an Exchange's messages are actually sent. When someone requests a mailbox from an Exchange,
   * that exchange registers itself as an entity with that address on the mailbox's behalf. When a message for that
   * address is received by the fiber, it routes it to the exchange, which forwards it to the mailbox, and onward.
   *
   * There's a picture in `Courier` that illustrates the component layout.
   *
   * An `InMemoryFiber` only has local entities, and only performs local dispatch. A `LinkableFiber` is an
   * `InMemoryFiber` which will forward messages to its linked fibers in the event a local entity hasn't been
   * registered with the address for which a message is bound.
   */
  var InMemoryFiber = (function() {
    var Klass = function() {
      this.initialize.apply(this, arguments);
    };

    var Log = Logger.create("InMemoryLogger");

    _.extend(Klass.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._entities = M.hash_map();
        this._identity = opts.getOrElse("identity", UUID.v4());

        this._stateGuard = new StateGuard(["disposed"]);

        _.bindAll(this, "_receive");
      },


      id: function() {
        return this._identity;
      },


      dispose: function() {
        if (this._stateGuard.applied("disposed")) {
          return;
        }
        this._dispose();
        this._stateGuard.apply("disposed");
      },

      _dispose: function() {

        var entities = this._entities;
        M.each(entities, function(pair) {
          M.nth(pair, 1).dispose();
        });

        this._entities = null;
      },

      registerEntity: function(opts) {
        opts = Options.fromObject(opts);

        var identity = opts.getOrError("identity"),
            entity   = new LocalEntity({
              identity: identity,
              delegate: opts.getOrError("delegate")
            });

        this._entities = M.assoc(this._entities, identity, entity);
        return true;
      },

      /**
       * Returns a promise which is fulfilled when the message is
       * sent, not received by the remote end. This to let the
       * caller know whether or not the message is stuck
       * in a buffer somewhere when calculating its timeouts.
       */
      send: Promise.method(function(opts) {
        this._stateGuard.deny("disposed");

        opts = Options.fromObject(opts);
        var from   = opts.getOrError("from"),
            to     = opts.getOrError("to"),
            body   = opts.getOrError("body"),
            msgId  = opts.getOrError("msgId"),

            mT     = opts.getOrElse("mT"),
            rMsgId = opts.getOrElse("rMsgId");


        //XXX: This is in-memory, so it's as simple
        // as invoking _receive in a future call stack
        return Promise
          .bind(this)
          .then(function() {
            _.defer(this._receive, {
              from:   from,
              to:     to,
              body:   body,
              msgId:  msgId,
              mT:     mT,
              rMsgId: rMsgId,
              oFib:   this._identity
            });
          })
          .then(function() {
            return msgId;
          });
      }),

      _receive: function(env) {
        if (this._stateGuard.applied("disposed")) {
          return;
        }

        env = Options.fromObject(env);
        var to, from, body, msgId, originFiber, mT, rMsgId;

        try {
          to          = env.getOrError("to");
          from        = env.getOrError("from");
          body        = env.getOrError("body");
          msgId       = env.getOrError("msgId");

          // Future-proofing for multi-fiber fabric.
          originFiber = env.getOrError("oFib");

          mT     = env.getOrElse("mT");
          rMsgId = env.getOrElse("rMsgId");
        } catch (e) {
          Log.error("Received malformed message", env);
        }

        var entity = M.get(this._entities, to);

        if (entity) {
          entity.dispatch({
            to:     to,
            from:   from,
            body:   body,
            msgId:  msgId,
            rMsgId: rMsgId,
            oFib:   originFiber,
            hFib:   this._identity,
            mT: mT
          });
        }
      }
    });

    return Klass;
  })();



  var LocalEntity = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LocalEntity.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrError("identity");
      this._delegate = opts.getOrError("delegate");
      this._stateGuard = new StateGuard(["disposed"]);
    },
    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },
    dispatch: function(env) {
      this._stateGuard.deny("disposed");

      this._delegate.receiveFiberMessage(env);
    }
  });

  return InMemoryFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/state-guard"),
  require("../../core/logging/logger")
);

})()
},{"../../core/options":7,"../../core/uuid":40,"../../core/state-guard":10,"../../core/logging/logger":31,"underscore":63,"bluebird":64,"mori":65}],39:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  InMemoryFiber,
  Channel,
  CompositeChannel
) {

  /**
   * LinkableFiber is a reference implementation for implementing a multi-fiber "fabric". Whereas an `InMemoryFiber`
   * only has local entities, and only performs local dispatch, a `LinkableFiber` is an `InMemoryFiber` which will
   * forward messages to its linked fibers in the event a local entity hasn't been registered with the address for
   * which a message is bound.
   *
   * For an example of how this might work in a multi-process or multi-machine environment, see the
   * `thicket-zmq-fiber` node module.
   */
  var LinkableFiber = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LinkableFiber.prototype, InMemoryFiber.prototype, {
    initialize: function(opts) {
      InMemoryFiber.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);


      this._localDispatch  = new Channel({ sentinel: this });
      this._ingressChannel = new CompositeChannel({
        sentinel: this,
        listen:   this._localDispatch
      });

      this._egressChannel  = new Channel({ sentinel: this });

      // _receive is defined and bound in InMemoryFiber ("protected" method)
      this._ingressChannel.subscribe(this._receive);
    },


    listen: function(channel) {
      this._ingressChannel.listen(channel);
    },


    egressChannel: function() {
      return this._egressChannel;
    },


    _dispose: function() {
      InMemoryFiber.prototype._dispose.apply(this, arguments);
    },

    send: Promise.method(function(opts) {
      this._stateGuard.deny("disposed");

      opts = Options.fromObject(opts);

      var from   = opts.getOrError("from"),
          to     = opts.getOrError("to"),
          body   = opts.getOrError("body"),
          msgId  = opts.getOrError("msgId"),
          mT     = opts.getOrElse("mT"),
          rMsgId = opts.getOrElse("rMsgId"),
          chan   = null;

      var msg = {
        from:   from,
        to:     to,
        body:   body,
        msgId:  msgId,
        mT:     mT,
        rMsgId: rMsgId,
        oFib:   this._identity
      };

      // Local dispatch, skip the round-trip
      if (M.get(this._entities, to)) {
        chan = this._localDispatch;
      } else {
        chan = this._egressChannel;
      }

      _.defer(_.bind(function() {
        chan.publish(this, msg);
      }, this));

      return msgId;
    })


  });

  return LinkableFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("./in-memory-fiber"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel")
);

})()
},{"../../core/options":7,"./in-memory-fiber":38,"../../core/channel/channel":33,"../../core/channel/composite-channel":35,"underscore":63,"bluebird":64,"mori":65}],41:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A 'serde' is a thing that can "ser"-ialize and "de"-erialize an object. This one just does JSON, and ignores
   * any additional options.
   *
   *
   */
  var JSONSerde = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(JSONSerde.prototype, {
    initialize: function() {},

    serialize: function(payload, opts) {
      return JSON.stringify(payload);
    },

    deserialize: function(payload, opts) {
      return JSON.parse(payload);
    }
  });

  return JSONSerde;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],42:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  BaseClient
) {

  var ClientBuilder = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ClientBuilder.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._spec = opts.getOrError("spec");
    },

    build: function(opts) {
      var c = new BaseClient(_.extend({}, this._spec.initOptions(), opts));
      _.each(this._spec.methods(), function(spec, name) {
        c.__registerMethod(name, spec);
      });
      return c;
    }
  });

  return ClientBuilder;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options"),
  require("./base-client")
);

})()
},{"../../core/options":7,"./base-client":58,"underscore":63}],43:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  MethodSpec
) {

  var ClientSpec = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ClientSpec.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._methodSpecs = _.reduce(opts.getOrElse("methods", {}), function(memo, spec, name) {
        memo[name] = new MethodSpec(spec);
        return memo;
      }, {});
      this._initOptions = opts.getOrElse("initOptions", {});
    },

    methods: function() {
      return this._methodSpecs;
    },

    initOptions: function() {
      return this._initOptions;
    }
  });

  return ClientSpec;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options"),
  require("./method-spec")
);

})()
},{"../../core/options":7,"./method-spec":59,"underscore":63}],47:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  DelegatingRef
) {

  var helper = function(val) {
    return new Ref(val);
  };

  helper.delegating = function(ref) {
    return new DelegatingRef(ref);
  };

  return helper;
};

module.exports = mod(
  require("underscore"),
  require("./ref"),
  require("./delegating-ref")
);

})()
},{"./ref":55,"./delegating-ref":54,"underscore":63}],64:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Promise = require("./promise.js")();
module.exports = Promise;
},{"./promise.js":66}],32:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * An appender which logs to the global `console`.
   *
   */
  var ConsoleLogAppender = function() {
    this.initialize.apply(this, arguments);
  };

  var p = function(num) {
    if (("" + num).length === 1) {
      return "0" + num;
    } else {
      return num;
    }
  };

  _.extend(ConsoleLogAppender.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._console = opts.getOrElse("console", console);
      this._timeDelegate = opts.getOrElse("timeDelegate", function(){
        var d = new Date();
        return [d.getUTCFullYear(), p(d.getUTCMonth()), p(d.getUTCDay())].join("/") +
          " " + [p(d.getUTCHours()), p(d.getUTCMinutes()), p(d.getUTCSeconds())].join(":") +
          "." + d.getUTCMilliseconds();
      });
    },

    log: function(loggerName, descendants, logLevel, logLevelName, args) {
      // Use the furthest ancestor as the logged name (since it originated there)
      var furthestAncestor = descendants[descendants.length - 1];
      if (furthestAncestor) {
        loggerName = furthestAncestor;
      }
      this._log(["["+logLevelName+"]["+this._getTime()+"]["+loggerName+"]"].concat(args));
    },

    _getTime: function() {
      return this._timeDelegate();
    },

    _log: function(logItems) {
      // Why does he do this? Is he insane? Well, yes.
      //
      // But mostly, I do this because console.log isn't, in all cases,
      // something you can call .apply on. Last I checked, in IE calling
      // console.log.apply(console, []) will throw an error. So that's why the
      // big ugly switch.
      //
      // If you need more than 7 items, well, I can't help you (but you can - add another
      // switch case).
      switch(logItems.length) {
        case 0:
          this._console.log();
          break;
        case 1:
          this._console.log(logItems[0]);
          break;
        case 2:
          this._console.log(logItems[0], logItems[1]);
          break;
        case 3:
          this._console.log(logItems[0], logItems[1], logItems[2]);
          break;
        case 4:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3]);
          break;
        case 5:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4]);
          break;
        case 6:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5]);
          break;
        case 7:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5], logItems[6]);
          break;
        default:
          var label = logItems.shift();
          this._console.log(label, logItems);
      }
    }
  });

  return ConsoleLogAppender;
};

module.exports = mod(
  require("underscore"),
  require("../../options")
);

})()
},{"../../options":7,"underscore":63}],49:[function(require,module,exports){
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger,
  ConfigurationMagic,
  AppContainer
) {
  var Log = Logger.create("Bootstrapper");

  var Bootstrapper = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Bootstrapper.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._configs = opts.getOrError("configurations");
      this._scopes = opts.getOrError("scopes");
      this._appKlass = opts.getOrError("applicationConstructor");
    },
    bootstrap: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          var config       = ConfigurationMagic.resolveConfig(this._scopes, this._configs),
              AppKlass     = this._appKlass;

          Log.info("Using resolved configuration: ", JSON.stringify(config));

          var app          = new AppKlass({configuration: config}),
              appContainer = new AppContainer({app: app});

          return appContainer;
        });
    })
  });

  return Bootstrapper;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger"),
  require("./configuration-magic"),
  require("./web-app-container")
);

},{"../core/options":7,"../core/logging/logger":31,"./configuration-magic":27,"./web-app-container":50,"underscore":63,"bluebird":64}],51:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var WebScheduler = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },

    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return WebScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":63}],50:[function(require,module,exports){
(function(){/*global require: false, module: false, process: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger
) {

  var Log = Logger.create("AppContainer");

  var WebAppContainer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebAppContainer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts)
      this._app = opts.getOrError("app");
    },

    start: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._app.start();
        });
    }),

    stop: Promise.method(function(reason) {
      return this._app.stop().then(function() {
        if (reason) {
          Log.error("Stopping due to reason:", reason);
        }
      });
    })
  });

  return WebAppContainer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger")
);

})()
},{"../core/options":7,"../core/logging/logger":31,"underscore":63,"bluebird":64}],53:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  Ref,
  SetTimeoutScheduler
) {

  var DefaultRuntime = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DefaultRuntime.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._schedulerRef = Ref(opts.getOrElseFn("scheduler", function() {
        return new SetTimeoutScheduler();
      }));
    },

    /**
     * @returns {Ref<Scheduler>}
     */
    scheduler: function() {
      return Ref.delegating(this._schedulerRef);
    },

    setScheduler: function(scheduler) {
      this._schedulerRef.set(scheduler);
    }
  });

  return DefaultRuntime;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("../core/ref"),
  require("../core/scheduler/set-timeout-scheduler")
);

})()
},{"../core/options":7,"../core/scheduler/set-timeout-scheduler":56,"../core/ref":47,"underscore":63}],57:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var StoreEntry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StoreEntry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Perfectly acceptable to pass in undefined...
      this._value = opts.getOrElse("value", undefined);
      this._lastSequence = opts.getOrError("initialSequence");

      this._ttl = opts.getOrElse("ttl");
    },

    isExpired: function(sequence, fallbackTtl) {
      var ttl = this._ttl || fallbackTtl;
      if (!ttl) {
        throw new Error("No TTL specified!");
      }
      // E.g., lastSequence = 4, ttl = 1, sequence = 5: expired
      //       lastSequence = 4, ttl = 1, sequence = 4: not expired
      //       lastSequence = 4, ttl = 2, sequence = 5: not expired
      return !(this._lastSequence + ttl > sequence);
    },

    touch: function(sequence) {
      this._lastSequence = sequence;
    },

    update: function(val, sequence, opts) {
      this._value        = val;
      this._lastSequence = sequence;

      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl");
    },

    dispose: function() {
      this._value        = null;
      this._lastSequence = null;
    },

    value: function() {
      return this._value;
    }
  });

  return StoreEntry;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options")
);

})()
},{"../../core/options":7,"underscore":63}],61:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Logger,
  Options
) {

  var TEN_MINUTES_IN_MILLISECONDS = 60 * 1000 * 10;

  var Log = Logger.create("ProcessKeepAlive");

  /**
   * Keeps a (node) process "alive" by keeping at least one bit of (noop) work scheduled for execution.
   *
   * @constructor
   */
  var ProcessKeepAlive = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ProcessKeepAlive.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler = opts.getOrError("scheduler");
      this._timeoutId = null;

      _.bindAll(this, "_cycle");
    },
    start: function() {
      Log.debug("Starting ProcessKeepAlive");
      this._cycle();
    },
    stop: function() {
      Log.debug("Stopping ProcessKeepAlive");
      if (this._timeoutId) {
        this._scheduler.get().unschedule(this._timeoutId);
        this._timeoutId = null;
      }
    },
    _cycle: function() {
      this._timeoutId = this._scheduler.get().schedule(
        this._cycle,
        TEN_MINUTES_IN_MILLISECONDS
      );
    }
  });

  return ProcessKeepAlive;
};

module.exports = mod(
  require("underscore"),
  require("../../core/logging/logger"),
  require("../../core/options")
);

})()
},{"../../core/logging/logger":31,"../../core/options":7,"underscore":63}],60:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  ChainedChannel,
  Channel,
  CompositeChannel,
  StateGuard
) {


  var Mailbox = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Mailbox.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._id                    = UUID.v4();
      this._ownerIdentity         = opts.getOrError("ownerIdentity");
      this._exchange              = opts.getOrError("exchange");
      this._oneShotChannel        = new Channel({ sentinel: this });
      this._requestReplyChannel   = new Channel({ sentinel: this });
      this._ingressChannel        = new CompositeChannel({
        sentinel: this,
        listen: [this._oneShotChannel, this._requestReplyChannel]
      });
      this._stateGuard            = new StateGuard(["disposed"]);

      this._outstandingRequestIds = M.set();
    },

    id: function() {
      return this._id;
    },

    ownerIdentity: function() {
      return this._ownerIdentity;
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")){
        return;
      }

      this._oneShotChannel.dispose();
      this._requestReplyChannel.dispose();
      this._ingressChannel.dispose();

      // Attempt to cancel all outstanding requests.
      // This is an async request, so we just have to fire and
      // forge them.
      //
      // If you're disposing of a mailbox before requests
      // complete, you might have a bad time. The good
      // news is because responses are ferried back from the fiber
      // to the mailbox caller via the Promise interface rather
      // than channels, they should still get CancellationErrors
      var reqs = this._outstandingRequestIds;
      this._outstandingRequestIds = M.set();

      M.each(reqs, _.bind(function(reqId) {
        this._exchange.cancelSendAndReceive(reqId);
      }, this));

      this._oneShotChannel      = null;
      this._requestReplyChannel = null;
      this._ingressChannel      = null;

      this._stateGuard.apply("disposed");
    },

    /**
     * Returns a new ChainedChannel chained to this Mailbox's
     * privately-owned inbound Channel.
     * @returns {ChainedChannel}
     */
    ingressChannel: function() {
      return this._ingressChannel;
    },

    oneShotChannel: function() {
      return this._oneShotChannel;
    },

    requestReplyChannel: function() {
      return this._requestReplyChannel;
    },

    send: Promise.method(function(env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });
      return this._exchange.send(env);
    }),

    reply: Promise.method(function(msgId, env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        rMsgId: msgId,
        from: this._ownerIdentity
      });

      return this._exchange.reply(env);
    }),

    sendAndReceive: Promise.method(function(env, opts) {
      this._stateGuard.deny("disposed");

      var reqId = (opts || {}).reqId || UUID.v4();

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });

      opts = _.extend({}, opts || {}, {
        reqId: reqId
      });

      this._outstandingRequestIds = M.conj(this._outstandingRequestIds, reqId);

      return this._exchange
        .sendAndReceive(env, opts)
        .bind(this)
        .then(function(resp) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          return resp;
        })
        .caught(Promise.CancellationError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        })
        .caught(Promise.TimeoutError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        });
    }),


    outstandingRequestCount: function() {
      return M.count(this._outstandingRequestIds);
    },


    cancelSendAndReceive: Promise.method(function(reqId) {
      return this._exchange
        .cancelSendAndReceive(reqId)
        .bind(this)
        .then(function() {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
        });
    }),

    _receiveOneShot: function(msg) {
      this._oneShotChannel.publish(this, msg);
    },

    _receiveRequestReply: function(msg) {
      this._requestReplyChannel.publish(this, msg);
    }
  });

  return Mailbox;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/channel/chained-channel"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel"),
  require("../../core/state-guard")
);

})()
},{"../../core/uuid":40,"../../core/options":7,"../../core/channel/chained-channel":34,"../../core/channel/channel":33,"../../core/channel/composite-channel":35,"../../core/state-guard":10,"underscore":63,"bluebird":64,"mori":65}],58:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Lang,
  UUID,
  Courier
) {

  var BaseClient = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(BaseClient.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._exchange = opts.getOrError("exchange");
      this._identity = opts.getOrElseFn("identity", function() {
        return UUID.v4();
      });
      this._serviceIdentity = opts.getOrError("serviceIdentity");
      this._mailbox         = this._exchange.mailbox(this._identity);
      this._courier         = new Courier({
        delegate: this,
        mailbox: this._mailbox
      });
    },

    __registerMethod: function(name, methodSpec) {
      var args          = methodSpec.args(),
          defaults      = methodSpec.defaults(),
          mType         = methodSpec.mType() || name,
          courierMethod = methodSpec.requestReply() ? "sendAndReceive" : "send";

      var getArgs = _.bind(function(defaults, methodArgs) {
        var finalArgs = {}, argName, argVal;
        for (var i = 0; i < args.length; i++) {
          argName = args[i];
          argVal = methodArgs[i];
          if (typeof argVal === "undefined") {
            if (defaults.hasOwnProperty(argName)) {
              finalArgs[argName] = defaults[argName];
            } else {
              throw new Error.ArgumentMissingError("argument missing: " + argName);
            }
          } else {
            finalArgs[argName] = argVal;
          }
        }
        return finalArgs;
      }, null, defaults);

      this[name] = Promise.method(_.bind(function() {
        var msg = _.extend({
          mT: mType
        }, getArgs(_.toArray(arguments)));
        return this._courier[courierMethod](this._serviceIdentity, msg);
      }, this));

    }
  });

  var Error = {
    ArgumentMissingError: Lang.makeErrorClass("ArgumentMissingError", "argument missing")
  };

  BaseClient.Error = Error;

  return BaseClient;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../../core/options"),
  require("../../core/lang"),
  require("../../core/uuid"),
  require("../../messaging/courier")
);

})()
},{"../../core/options":7,"../../core/lang":9,"../../core/uuid":40,"../../messaging/courier":37,"underscore":63,"bluebird":64}],67:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    if (canPost) {
        var queue = [];
        window.addEventListener('message', function (ev) {
            var source = ev.source;
            if ((source === window || source === null) && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

process.binding = function (name) {
    throw new Error('process.binding is not supported');
}

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],66:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var old;
if (typeof Promise !== "undefined") old = Promise;
function noConflict(bluebird) {
    try { if (Promise === bluebird) Promise = old; }
    catch (e) {}
    return bluebird;
}
module.exports = function() {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");

var INTERNAL = function(){};
var APPLY = {};
var NEXT_FILTER = {e: null};

var cast = require("./thenables.js")(Promise, INTERNAL);
var PromiseArray = require("./promise_array.js")(Promise, INTERNAL, cast);
var CapturedTrace = require("./captured_trace.js")();
var CatchFilter = require("./catch_filter.js")(NEXT_FILTER);
var PromiseResolver = require("./promise_resolver.js");

var isArray = util.isArray;

var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var tryCatch2 = util.tryCatch2;
var tryCatchApply = util.tryCatchApply;
var RangeError = errors.RangeError;
var TypeError = errors.TypeError;
var CancellationError = errors.CancellationError;
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var originatesFromRejection = errors.originatesFromRejection;
var markAsOriginatingFromRejection = errors.markAsOriginatingFromRejection;
var canAttach = errors.canAttach;
var thrower = util.thrower;
var apiRejection = require("./errors_api_rejection")(Promise);


var makeSelfResolutionError = function Promise$_makeSelfResolutionError() {
    return new TypeError("circular promise resolution chain");
};

function Promise(resolver) {
    if (typeof resolver !== "function") {
        throw new TypeError("the promise constructor requires a resolver function");
    }
    if (this.constructor !== Promise) {
        throw new TypeError("the promise constructor cannot be invoked directly");
    }
    this._bitField = 0;
    this._fulfillmentHandler0 = void 0;
    this._rejectionHandler0 = void 0;
    this._promise0 = void 0;
    this._receiver0 = void 0;
    this._settledValue = void 0;
    this._boundTo = void 0;
    if (resolver !== INTERNAL) this._resolveFromResolver(resolver);
}

Promise.prototype.bind = function Promise$bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._follow(this);
    ret._propagateFrom(this, 2 | 1);
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.prototype.toString = function Promise$toString() {
    return "[object Promise]";
};

Promise.prototype.caught = Promise.prototype["catch"] =
function Promise$catch(fn) {
    var len = arguments.length;
    if (len > 1) {
        var catchInstances = new Array(len - 1),
            j = 0, i;
        for (i = 0; i < len - 1; ++i) {
            var item = arguments[i];
            if (typeof item === "function") {
                catchInstances[j++] = item;
            } else {
                var catchFilterTypeError =
                    new TypeError(
                        "A catch filter must be an error constructor "
                        + "or a filter function");

                this._attachExtraTrace(catchFilterTypeError);
                async.invoke(this._reject, this, catchFilterTypeError);
                return;
            }
        }
        catchInstances.length = j;
        fn = arguments[i];

        this._resetTrace();
        var catchFilter = new CatchFilter(catchInstances, fn, this);
        return this._then(void 0, catchFilter.doFilter, void 0,
            catchFilter, void 0);
    }
    return this._then(void 0, fn, void 0, void 0, void 0);
};

Promise.prototype.then =
function Promise$then(didFulfill, didReject, didProgress) {
    return this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
};


Promise.prototype.done =
function Promise$done(didFulfill, didReject, didProgress) {
    var promise = this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
    promise._setIsFinal();
};

Promise.prototype.spread = function Promise$spread(didFulfill, didReject) {
    return this._then(didFulfill, didReject, void 0,
        APPLY, void 0);
};

Promise.prototype.isCancellable = function Promise$isCancellable() {
    return !this.isResolved() &&
        this._cancellable();
};

Promise.prototype.toJSON = function Promise$toJSON() {
    var ret = {
        isFulfilled: false,
        isRejected: false,
        fulfillmentValue: void 0,
        rejectionReason: void 0
    };
    if (this.isFulfilled()) {
        ret.fulfillmentValue = this._settledValue;
        ret.isFulfilled = true;
    } else if (this.isRejected()) {
        ret.rejectionReason = this._settledValue;
        ret.isRejected = true;
    }
    return ret;
};

Promise.prototype.all = function Promise$all() {
    return new PromiseArray(this).promise();
};


Promise.is = function Promise$Is(val) {
    return val instanceof Promise;
};

Promise.all = function Promise$All(promises) {
    return new PromiseArray(promises).promise();
};

Promise.prototype.error = function Promise$_error(fn) {
    return this.caught(originatesFromRejection, fn);
};

Promise.prototype._resolveFromSyncValue =
function Promise$_resolveFromSyncValue(value) {
    if (value === errorObj) {
        this._cleanValues();
        this._setRejected();
        this._settledValue = value.e;
        this._ensurePossibleRejectionHandled();
    } else {
        var maybePromise = cast(value, void 0);
        if (maybePromise instanceof Promise) {
            this._follow(maybePromise);
        } else {
            this._cleanValues();
            this._setFulfilled();
            this._settledValue = value;
        }
    }
};

Promise.method = function Promise$_Method(fn) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    return function Promise$_method() {
        var value;
        switch(arguments.length) {
        case 0: value = tryCatch1(fn, this, void 0); break;
        case 1: value = tryCatch1(fn, this, arguments[0]); break;
        case 2: value = tryCatch2(fn, this, arguments[0], arguments[1]); break;
        default:
            var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
            value = tryCatchApply(fn, args, this); break;
        }
        var ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._resolveFromSyncValue(value);
        return ret;
    };
};

Promise.attempt = Promise["try"] = function Promise$_Try(fn, args, ctx) {
    if (typeof fn !== "function") {
        return apiRejection("fn must be a function");
    }
    var value = isArray(args)
        ? tryCatchApply(fn, args, ctx)
        : tryCatch1(fn, ctx, args);

    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._resolveFromSyncValue(value);
    return ret;
};

Promise.defer = Promise.pending = function Promise$Defer() {
    var promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    return new PromiseResolver(promise);
};

Promise.bind = function Promise$Bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._setFulfilled();
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.cast = function Promise$_Cast(obj) {
    var ret = cast(obj, void 0);
    if (!(ret instanceof Promise)) {
        var val = ret;
        ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._setFulfilled();
        ret._cleanValues();
        ret._settledValue = val;
    }
    return ret;
};

Promise.resolve = Promise.fulfilled = Promise.cast;

Promise.reject = Promise.rejected = function Promise$Reject(reason) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    markAsOriginatingFromRejection(reason);
    ret._cleanValues();
    ret._setRejected();
    ret._settledValue = reason;
    if (!canAttach(reason)) {
        var trace = new Error(reason + "");
        ret._setCarriedStackTrace(trace);
    }
    ret._ensurePossibleRejectionHandled();
    return ret;
};

Promise.onPossiblyUnhandledRejection =
function Promise$OnPossiblyUnhandledRejection(fn) {
        CapturedTrace.possiblyUnhandledRejection = typeof fn === "function"
                                                    ? fn : void 0;
};

var unhandledRejectionHandled;
Promise.onUnhandledRejectionHandled =
function Promise$onUnhandledRejectionHandled(fn) {
    unhandledRejectionHandled = typeof fn === "function" ? fn : void 0;
};

var debugging = false || !!(
    typeof process !== "undefined" &&
    typeof process.execPath === "string" &&
    typeof process.env === "object" &&
    (process.env["BLUEBIRD_DEBUG"] ||
        process.env["NODE_ENV"] === "development")
);


Promise.longStackTraces = function Promise$LongStackTraces() {
    if (async.haveItemsQueued() &&
        debugging === false
   ) {
        throw new Error("cannot enable long stack traces after promises have been created");
    }
    debugging = CapturedTrace.isSupported();
};

Promise.hasLongStackTraces = function Promise$HasLongStackTraces() {
    return debugging && CapturedTrace.isSupported();
};

Promise.prototype._then =
function Promise$_then(
    didFulfill,
    didReject,
    didProgress,
    receiver,
    internalData
) {
    var haveInternalData = internalData !== void 0;
    var ret = haveInternalData ? internalData : new Promise(INTERNAL);

    if (!haveInternalData) {
        if (debugging) {
            var haveSameContext = this._peekContext() === this._traceParent;
            ret._traceParent = haveSameContext ? this._traceParent : this;
        }
        ret._propagateFrom(this, 7);
    }

    var callbackIndex =
        this._addCallbacks(didFulfill, didReject, didProgress, ret, receiver);

    if (this.isResolved()) {
        async.invoke(this._queueSettleAt, this, callbackIndex);
    }

    return ret;
};

Promise.prototype._length = function Promise$_length() {
    return this._bitField & 262143;
};

Promise.prototype._isFollowingOrFulfilledOrRejected =
function Promise$_isFollowingOrFulfilledOrRejected() {
    return (this._bitField & 939524096) > 0;
};

Promise.prototype._isFollowing = function Promise$_isFollowing() {
    return (this._bitField & 536870912) === 536870912;
};

Promise.prototype._setLength = function Promise$_setLength(len) {
    this._bitField = (this._bitField & -262144) |
        (len & 262143);
};

Promise.prototype._setFulfilled = function Promise$_setFulfilled() {
    this._bitField = this._bitField | 268435456;
};

Promise.prototype._setRejected = function Promise$_setRejected() {
    this._bitField = this._bitField | 134217728;
};

Promise.prototype._setFollowing = function Promise$_setFollowing() {
    this._bitField = this._bitField | 536870912;
};

Promise.prototype._setIsFinal = function Promise$_setIsFinal() {
    this._bitField = this._bitField | 33554432;
};

Promise.prototype._isFinal = function Promise$_isFinal() {
    return (this._bitField & 33554432) > 0;
};

Promise.prototype._cancellable = function Promise$_cancellable() {
    return (this._bitField & 67108864) > 0;
};

Promise.prototype._setCancellable = function Promise$_setCancellable() {
    this._bitField = this._bitField | 67108864;
};

Promise.prototype._unsetCancellable = function Promise$_unsetCancellable() {
    this._bitField = this._bitField & (~67108864);
};

Promise.prototype._setRejectionIsUnhandled =
function Promise$_setRejectionIsUnhandled() {
    this._bitField = this._bitField | 2097152;
};

Promise.prototype._unsetRejectionIsUnhandled =
function Promise$_unsetRejectionIsUnhandled() {
    this._bitField = this._bitField & (~2097152);
    if (this._isUnhandledRejectionNotified()) {
        this._unsetUnhandledRejectionIsNotified();
        this._notifyUnhandledRejectionIsHandled();
    }
};

Promise.prototype._isRejectionUnhandled =
function Promise$_isRejectionUnhandled() {
    return (this._bitField & 2097152) > 0;
};

Promise.prototype._setUnhandledRejectionIsNotified =
function Promise$_setUnhandledRejectionIsNotified() {
    this._bitField = this._bitField | 524288;
};

Promise.prototype._unsetUnhandledRejectionIsNotified =
function Promise$_unsetUnhandledRejectionIsNotified() {
    this._bitField = this._bitField & (~524288);
};

Promise.prototype._isUnhandledRejectionNotified =
function Promise$_isUnhandledRejectionNotified() {
    return (this._bitField & 524288) > 0;
};

Promise.prototype._setCarriedStackTrace =
function Promise$_setCarriedStackTrace(capturedTrace) {
    this._bitField = this._bitField | 1048576;
    this._fulfillmentHandler0 = capturedTrace;
};

Promise.prototype._unsetCarriedStackTrace =
function Promise$_unsetCarriedStackTrace() {
    this._bitField = this._bitField & (~1048576);
    this._fulfillmentHandler0 = void 0;
};

Promise.prototype._isCarryingStackTrace =
function Promise$_isCarryingStackTrace() {
    return (this._bitField & 1048576) > 0;
};

Promise.prototype._getCarriedStackTrace =
function Promise$_getCarriedStackTrace() {
    return this._isCarryingStackTrace()
        ? this._fulfillmentHandler0
        : void 0;
};

Promise.prototype._receiverAt = function Promise$_receiverAt(index) {
    var ret = index === 0
        ? this._receiver0
        : this[(index << 2) + index - 5 + 4];
    if (this._isBound() && ret === void 0) {
        return this._boundTo;
    }
    return ret;
};

Promise.prototype._promiseAt = function Promise$_promiseAt(index) {
    return index === 0
        ? this._promise0
        : this[(index << 2) + index - 5 + 3];
};

Promise.prototype._fulfillmentHandlerAt =
function Promise$_fulfillmentHandlerAt(index) {
    return index === 0
        ? this._fulfillmentHandler0
        : this[(index << 2) + index - 5 + 0];
};

Promise.prototype._rejectionHandlerAt =
function Promise$_rejectionHandlerAt(index) {
    return index === 0
        ? this._rejectionHandler0
        : this[(index << 2) + index - 5 + 1];
};

Promise.prototype._addCallbacks = function Promise$_addCallbacks(
    fulfill,
    reject,
    progress,
    promise,
    receiver
) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }

    if (index === 0) {
        this._promise0 = promise;
        if (receiver !== void 0) this._receiver0 = receiver;
        if (typeof fulfill === "function" && !this._isCarryingStackTrace())
            this._fulfillmentHandler0 = fulfill;
        if (typeof reject === "function") this._rejectionHandler0 = reject;
        if (typeof progress === "function") this._progressHandler0 = progress;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promise;
        this[base + 4] = receiver;
        this[base + 0] = typeof fulfill === "function"
                                            ? fulfill : void 0;
        this[base + 1] = typeof reject === "function"
                                            ? reject : void 0;
        this[base + 2] = typeof progress === "function"
                                            ? progress : void 0;
    }
    this._setLength(index + 1);
    return index;
};

Promise.prototype._setProxyHandlers =
function Promise$_setProxyHandlers(receiver, promiseSlotValue) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }
    if (index === 0) {
        this._promise0 = promiseSlotValue;
        this._receiver0 = receiver;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promiseSlotValue;
        this[base + 4] = receiver;
        this[base + 0] =
        this[base + 1] =
        this[base + 2] = void 0;
    }
    this._setLength(index + 1);
};

Promise.prototype._proxyPromiseArray =
function Promise$_proxyPromiseArray(promiseArray, index) {
    this._setProxyHandlers(promiseArray, index);
};

Promise.prototype._proxyPromise = function Promise$_proxyPromise(promise) {
    promise._setProxied();
    this._setProxyHandlers(promise, -1);
};

Promise.prototype._setBoundTo = function Promise$_setBoundTo(obj) {
    if (obj !== void 0) {
        this._bitField = this._bitField | 8388608;
        this._boundTo = obj;
    } else {
        this._bitField = this._bitField & (~8388608);
    }
};

Promise.prototype._isBound = function Promise$_isBound() {
    return (this._bitField & 8388608) === 8388608;
};

Promise.prototype._resolveFromResolver =
function Promise$_resolveFromResolver(resolver) {
    var promise = this;
    this._setTrace(void 0);
    this._pushContext();

    function Promise$_resolver(val) {
        if (promise._tryFollow(val)) {
            return;
        }
        promise._fulfill(val);
    }
    function Promise$_rejecter(val) {
        var trace = canAttach(val) ? val : new Error(val + "");
        promise._attachExtraTrace(trace);
        markAsOriginatingFromRejection(val);
        promise._reject(val, trace === val ? void 0 : trace);
    }
    var r = tryCatch2(resolver, void 0, Promise$_resolver, Promise$_rejecter);
    this._popContext();

    if (r !== void 0 && r === errorObj) {
        var e = r.e;
        var trace = canAttach(e) ? e : new Error(e + "");
        promise._reject(e, trace);
    }
};

Promise.prototype._spreadSlowCase =
function Promise$_spreadSlowCase(targetFn, promise, values, boundTo) {
    var promiseForAll = new PromiseArray(values).promise();
    var promise2 = promiseForAll._then(function() {
        return targetFn.apply(boundTo, arguments);
    }, void 0, void 0, APPLY, void 0);
    promise._follow(promise2);
};

Promise.prototype._callSpread =
function Promise$_callSpread(handler, promise, value) {
    var boundTo = this._boundTo;
    if (isArray(value)) {
        for (var i = 0, len = value.length; i < len; ++i) {
            if (cast(value[i], void 0) instanceof Promise) {
                this._spreadSlowCase(handler, promise, value, boundTo);
                return;
            }
        }
    }
    promise._pushContext();
    return tryCatchApply(handler, value, boundTo);
};

Promise.prototype._callHandler =
function Promise$_callHandler(
    handler, receiver, promise, value) {
    var x;
    if (receiver === APPLY && !this.isRejected()) {
        x = this._callSpread(handler, promise, value);
    } else {
        promise._pushContext();
        x = tryCatch1(handler, receiver, value);
    }
    promise._popContext();
    return x;
};

Promise.prototype._settlePromiseFromHandler =
function Promise$_settlePromiseFromHandler(
    handler, receiver, value, promise
) {
    if (!(promise instanceof Promise)) {
        handler.call(receiver, value, promise);
        return;
    }
    var x = this._callHandler(handler, receiver, promise, value);
    if (promise._isFollowing()) return;

    if (x === errorObj || x === promise || x === NEXT_FILTER) {
        var err = x === promise
                    ? makeSelfResolutionError()
                    : x.e;
        var trace = canAttach(err) ? err : new Error(err + "");
        if (x !== NEXT_FILTER) promise._attachExtraTrace(trace);
        promise._rejectUnchecked(err, trace);
    } else {
        var castValue = cast(x, promise);
        if (castValue instanceof Promise) {
            if (castValue.isRejected() &&
                !castValue._isCarryingStackTrace() &&
                !canAttach(castValue._settledValue)) {
                var trace = new Error(castValue._settledValue + "");
                promise._attachExtraTrace(trace);
                castValue._setCarriedStackTrace(trace);
            }
            promise._follow(castValue);
            promise._propagateFrom(castValue, 1);
        } else {
            promise._fulfillUnchecked(x);
        }
    }
};

Promise.prototype._follow =
function Promise$_follow(promise) {
    this._setFollowing();

    if (promise.isPending()) {
        this._propagateFrom(promise, 1);
        promise._proxyPromise(this);
    } else if (promise.isFulfilled()) {
        this._fulfillUnchecked(promise._settledValue);
    } else {
        this._rejectUnchecked(promise._settledValue,
            promise._getCarriedStackTrace());
    }

    if (promise._isRejectionUnhandled()) promise._unsetRejectionIsUnhandled();

    if (debugging &&
        promise._traceParent == null) {
        promise._traceParent = this;
    }
};

Promise.prototype._tryFollow =
function Promise$_tryFollow(value) {
    if (this._isFollowingOrFulfilledOrRejected() ||
        value === this) {
        return false;
    }
    var maybePromise = cast(value, void 0);
    if (!(maybePromise instanceof Promise)) {
        return false;
    }
    this._follow(maybePromise);
    return true;
};

Promise.prototype._resetTrace = function Promise$_resetTrace() {
    if (debugging) {
        this._trace = new CapturedTrace(this._peekContext() === void 0);
    }
};

Promise.prototype._setTrace = function Promise$_setTrace(parent) {
    if (debugging) {
        var context = this._peekContext();
        this._traceParent = context;
        var isTopLevel = context === void 0;
        if (parent !== void 0 &&
            parent._traceParent === context) {
            this._trace = parent._trace;
        } else {
            this._trace = new CapturedTrace(isTopLevel);
        }
    }
    return this;
};

Promise.prototype._attachExtraTrace =
function Promise$_attachExtraTrace(error) {
    if (debugging) {
        var promise = this;
        var stack = error.stack;
        stack = typeof stack === "string" ? stack.split("\n") : [];
        CapturedTrace.protectErrorMessageNewlines(stack);
        var headerLineCount = 1;
        var combinedTraces = 1;
        while(promise != null &&
            promise._trace != null) {
            stack = CapturedTrace.combine(
                stack,
                promise._trace.stack.split("\n")
            );
            promise = promise._traceParent;
            combinedTraces++;
        }

        var stackTraceLimit = Error.stackTraceLimit || 10;
        var max = (stackTraceLimit + headerLineCount) * combinedTraces;
        var len = stack.length;
        if (len > max) {
            stack.length = max;
        }

        if (len > 0)
            stack[0] = stack[0].split("\u0002\u0000\u0001").join("\n");

        if (stack.length <= headerLineCount) {
            error.stack = "(No stack trace)";
        } else {
            error.stack = stack.join("\n");
        }
    }
};

Promise.prototype._cleanValues = function Promise$_cleanValues() {
    if (this._cancellable()) {
        this._cancellationParent = void 0;
    }
};

Promise.prototype._propagateFrom =
function Promise$_propagateFrom(parent, flags) {
    if ((flags & 1) > 0 && parent._cancellable()) {
        this._setCancellable();
        this._cancellationParent = parent;
    }
    if ((flags & 4) > 0) {
        this._setBoundTo(parent._boundTo);
    }
    if ((flags & 2) > 0) {
        this._setTrace(parent);
    }
};

Promise.prototype._fulfill = function Promise$_fulfill(value) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._fulfillUnchecked(value);
};

Promise.prototype._reject =
function Promise$_reject(reason, carriedStackTrace) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._rejectUnchecked(reason, carriedStackTrace);
};

Promise.prototype._settlePromiseAt = function Promise$_settlePromiseAt(index) {
    var handler = this.isFulfilled()
        ? this._fulfillmentHandlerAt(index)
        : this._rejectionHandlerAt(index);

    var value = this._settledValue;
    var receiver = this._receiverAt(index);
    var promise = this._promiseAt(index);

    if (typeof handler === "function") {
        this._settlePromiseFromHandler(handler, receiver, value, promise);
    } else {
        var done = false;
        var isFulfilled = this.isFulfilled();
        if (receiver !== void 0) {
            if (receiver instanceof Promise &&
                receiver._isProxied()) {
                receiver._unsetProxied();

                if (isFulfilled) receiver._fulfillUnchecked(value);
                else receiver._rejectUnchecked(value,
                    this._getCarriedStackTrace());
                done = true;
            } else if (receiver instanceof PromiseArray) {
                if (isFulfilled) receiver._promiseFulfilled(value, promise);
                else receiver._promiseRejected(value, promise);
                done = true;
            }
        }

        if (!done) {
            if (isFulfilled) promise._fulfill(value);
            else promise._reject(value, this._getCarriedStackTrace());
        }
    }

    if (index >= 256) {
        this._queueGC();
    }
};

Promise.prototype._isProxied = function Promise$_isProxied() {
    return (this._bitField & 4194304) === 4194304;
};

Promise.prototype._setProxied = function Promise$_setProxied() {
    this._bitField = this._bitField | 4194304;
};

Promise.prototype._unsetProxied = function Promise$_unsetProxied() {
    this._bitField = this._bitField & (~4194304);
};

Promise.prototype._isGcQueued = function Promise$_isGcQueued() {
    return (this._bitField & -1073741824) === -1073741824;
};

Promise.prototype._setGcQueued = function Promise$_setGcQueued() {
    this._bitField = this._bitField | -1073741824;
};

Promise.prototype._unsetGcQueued = function Promise$_unsetGcQueued() {
    this._bitField = this._bitField & (~-1073741824);
};

Promise.prototype._queueGC = function Promise$_queueGC() {
    if (this._isGcQueued()) return;
    this._setGcQueued();
    async.invokeLater(this._gc, this, void 0);
};

Promise.prototype._gc = function Promise$gc() {
    var len = this._length() * 5;
    for (var i = 0; i < len; i++) {
        delete this[i];
    }
    this._setLength(0);
    this._unsetGcQueued();
};

Promise.prototype._queueSettleAt = function Promise$_queueSettleAt(index) {
    if (this._isRejectionUnhandled()) this._unsetRejectionIsUnhandled();
    async.invoke(this._settlePromiseAt, this, index);
};

Promise.prototype._fulfillUnchecked =
function Promise$_fulfillUnchecked(value) {
    if (!this.isPending()) return;
    if (value === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err, void 0);
    }
    this._cleanValues();
    this._setFulfilled();
    this._settledValue = value;
    var len = this._length();

    if (len > 0) {
        async.invoke(this._settlePromises, this, len);
    }
};

Promise.prototype._rejectUncheckedCheckError =
function Promise$_rejectUncheckedCheckError(reason) {
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._rejectUnchecked(reason, trace === reason ? void 0 : trace);
};

Promise.prototype._rejectUnchecked =
function Promise$_rejectUnchecked(reason, trace) {
    if (!this.isPending()) return;
    if (reason === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err);
    }
    this._cleanValues();
    this._setRejected();
    this._settledValue = reason;

    if (this._isFinal()) {
        async.invokeLater(thrower, void 0, trace === void 0 ? reason : trace);
        return;
    }
    var len = this._length();

    if (trace !== void 0) this._setCarriedStackTrace(trace);

    if (len > 0) {
        async.invoke(this._rejectPromises, this, null);
    } else {
        this._ensurePossibleRejectionHandled();
    }
};

Promise.prototype._rejectPromises = function Promise$_rejectPromises() {
    this._settlePromises();
    this._unsetCarriedStackTrace();
};

Promise.prototype._settlePromises = function Promise$_settlePromises() {
    var len = this._length();
    for (var i = 0; i < len; i++) {
        this._settlePromiseAt(i);
    }
};

Promise.prototype._ensurePossibleRejectionHandled =
function Promise$_ensurePossibleRejectionHandled() {
    this._setRejectionIsUnhandled();
    if (CapturedTrace.possiblyUnhandledRejection !== void 0) {
        async.invokeLater(this._notifyUnhandledRejection, this, void 0);
    }
};

Promise.prototype._notifyUnhandledRejectionIsHandled =
function Promise$_notifyUnhandledRejectionIsHandled() {
    if (typeof unhandledRejectionHandled === "function") {
        async.invokeLater(unhandledRejectionHandled, void 0, this);
    }
};

Promise.prototype._notifyUnhandledRejection =
function Promise$_notifyUnhandledRejection() {
    if (this._isRejectionUnhandled()) {
        var reason = this._settledValue;
        var trace = this._getCarriedStackTrace();

        this._setUnhandledRejectionIsNotified();

        if (trace !== void 0) {
            this._unsetCarriedStackTrace();
            reason = trace;
        }
        if (typeof CapturedTrace.possiblyUnhandledRejection === "function") {
            CapturedTrace.possiblyUnhandledRejection(reason, this);
        }
    }
};

var contextStack = [];
Promise.prototype._peekContext = function Promise$_peekContext() {
    var lastIndex = contextStack.length - 1;
    if (lastIndex >= 0) {
        return contextStack[lastIndex];
    }
    return void 0;

};

Promise.prototype._pushContext = function Promise$_pushContext() {
    if (!debugging) return;
    contextStack.push(this);
};

Promise.prototype._popContext = function Promise$_popContext() {
    if (!debugging) return;
    contextStack.pop();
};

Promise.noConflict = function Promise$NoConflict() {
    return noConflict(Promise);
};

Promise.setScheduler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    async._schedule = fn;
};

if (!CapturedTrace.isSupported()) {
    Promise.longStackTraces = function(){};
    debugging = false;
}

Promise._makeSelfResolutionError = makeSelfResolutionError;
require("./finally.js")(Promise, NEXT_FILTER, cast);
require("./direct_resolve.js")(Promise);
require("./synchronous_inspection.js")(Promise);
require("./join.js")(Promise, PromiseArray, cast, INTERNAL);
Promise.RangeError = RangeError;
Promise.CancellationError = CancellationError;
Promise.TimeoutError = TimeoutError;
Promise.TypeError = TypeError;
Promise.OperationalError = OperationalError;
Promise.RejectionError = OperationalError;
Promise.AggregateError = errors.AggregateError;

util.toFastProperties(Promise);
util.toFastProperties(Promise.prototype);
Promise.Promise = Promise;
require('./timers.js')(Promise,INTERNAL,cast);
require('./race.js')(Promise,INTERNAL,cast);
require('./call_get.js')(Promise);
require('./generators.js')(Promise,apiRejection,INTERNAL,cast);
require('./map.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./nodeify.js')(Promise);
require('./promisify.js')(Promise,INTERNAL);
require('./props.js')(Promise,PromiseArray,cast);
require('./reduce.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./settle.js')(Promise,PromiseArray);
require('./some.js')(Promise,PromiseArray,apiRejection);
require('./progress.js')(Promise,PromiseArray);
require('./cancel.js')(Promise,INTERNAL);
require('./filter.js')(Promise,INTERNAL);
require('./any.js')(Promise,PromiseArray);
require('./each.js')(Promise,INTERNAL);
require('./using.js')(Promise,apiRejection,cast);

Promise.prototype = Promise.prototype;
return Promise;

};

})(require("__browserify_process"))
},{"./util.js":68,"./async.js":69,"./errors.js":70,"./thenables.js":71,"./promise_array.js":72,"./captured_trace.js":73,"./catch_filter.js":74,"./promise_resolver.js":75,"./finally.js":76,"./direct_resolve.js":77,"./synchronous_inspection.js":78,"./join.js":79,"./timers.js":80,"./race.js":81,"./call_get.js":82,"./generators.js":83,"./map.js":84,"./nodeify.js":85,"./props.js":86,"./reduce.js":87,"./settle.js":88,"./promisify.js":89,"./some.js":90,"./progress.js":91,"./cancel.js":92,"./filter.js":93,"./any.js":94,"./each.js":95,"./using.js":96,"./errors_api_rejection":97,"__browserify_process":67}],55:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A basic Ref serves as a means of indirection between references and their
   * values, allowing an outside agent to modify the underlying value.
   */
  var Ref = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Ref.prototype, {
    initialize: function(val) {
      this._val = val;
    },

    /**
     * Return the value boxed by this Ref
     *
     * @returns {dynamic}
     */
    get: function() {
      return this._val;
    },

    /**
     * Set a new boxed value. Note this method is specific to this Ref
     * implementation, and not the Ref protocol, which only defines
     * `Ref#get()`.
     *
     * @param newVal {dynamic} the value to box
     */
    set: function(newVal) {
      if (newVal instanceof Ref) {
        this._val = newVal.get();
      } else {
        this._val = newVal;
      }
    }
  });

  return Ref;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],54:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A ref whose boxed value is another ref
   */
  var DelegatingRef = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingRef.prototype, {
    initialize: function(ref) {
      this._delegateRef = ref;
    },
    get: function() {
      return this._delegateRef.get();
    }
  });

  return DelegatingRef;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":63}],78:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
function PromiseInspection(promise) {
    if (promise !== void 0) {
        this._bitField = promise._bitField;
        this._settledValue = promise.isResolved()
            ? promise._settledValue
            : void 0;
    }
    else {
        this._bitField = 0;
        this._settledValue = void 0;
    }
}

PromiseInspection.prototype.isFulfilled =
Promise.prototype.isFulfilled = function Promise$isFulfilled() {
    return (this._bitField & 268435456) > 0;
};

PromiseInspection.prototype.isRejected =
Promise.prototype.isRejected = function Promise$isRejected() {
    return (this._bitField & 134217728) > 0;
};

PromiseInspection.prototype.isPending =
Promise.prototype.isPending = function Promise$isPending() {
    return (this._bitField & 402653184) === 0;
};

PromiseInspection.prototype.value =
Promise.prototype.value = function Promise$value() {
    if (!this.isFulfilled()) {
        throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.error =
PromiseInspection.prototype.reason =
Promise.prototype.reason = function Promise$reason() {
    if (!this.isRejected()) {
        throw new TypeError("cannot get rejection reason of a non-rejected promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.isResolved =
Promise.prototype.isResolved = function Promise$isResolved() {
    return (this._bitField & 402653184) > 0;
};

Promise.PromiseInspection = PromiseInspection;
};

},{}],93:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseMap = Promise.map;

Promise.prototype.filter = function Promise$filter(fn, options) {
    return PromiseMap(this, fn, options, INTERNAL);
};

Promise.filter = function Promise$Filter(promises, fn, options) {
    return PromiseMap(promises, fn, options, INTERNAL);
};
};

},{}],94:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var SomePromiseArray = Promise._SomePromiseArray;
function Promise$_Any(promises) {
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(1);
    ret.setUnwrap();
    ret.init();
    return promise;
}

Promise.any = function Promise$Any(promises) {
    return Promise$_Any(promises);
};

Promise.prototype.any = function Promise$any() {
    return Promise$_Any(this);
};

};

},{}],95:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseReduce = Promise.reduce;

Promise.prototype.each = function Promise$each(fn) {
    return PromiseReduce(this, fn, null, INTERNAL);
};

Promise.each = function Promise$Each(promises, fn) {
    return PromiseReduce(promises, fn, null, INTERNAL);
};
};

},{}],56:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var SetTimeoutScheduler = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(SetTimeoutScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },

    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return SetTimeoutScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":63}],68:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var es5 = require("./es5.js");
var haveGetters = (function(){
    try {
        var o = {};
        es5.defineProperty(o, "f", {
            get: function () {
                return 3;
            }
        });
        return o.f === 3;
    }
    catch (e) {
        return false;
    }

})();
var canEvaluate = typeof navigator == "undefined";
var errorObj = {e: {}};
function tryCatch1(fn, receiver, arg) {
    try { return fn.call(receiver, arg); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch2(fn, receiver, arg, arg2) {
    try { return fn.call(receiver, arg, arg2); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch3(fn, receiver, arg, arg2, arg3) {
    try { return fn.call(receiver, arg, arg2, arg3); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch4(fn, receiver, arg, arg2, arg3, arg4) {
    try { return fn.call(receiver, arg, arg2, arg3, arg4); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatchApply(fn, args, receiver) {
    try { return fn.apply(receiver, args); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

var inherits = function(Child, Parent) {
    var hasProp = {}.hasOwnProperty;

    function T() {
        this.constructor = Child;
        this.constructor$ = Parent;
        for (var propertyName in Parent.prototype) {
            if (hasProp.call(Parent.prototype, propertyName) &&
                propertyName.charAt(propertyName.length-1) !== "$"
           ) {
                this[propertyName + "$"] = Parent.prototype[propertyName];
            }
        }
    }
    T.prototype = Parent.prototype;
    Child.prototype = new T();
    return Child.prototype;
};

function asString(val) {
    return typeof val === "string" ? val : ("" + val);
}

function isPrimitive(val) {
    return val == null || val === true || val === false ||
        typeof val === "string" || typeof val === "number";

}

function isObject(value) {
    return !isPrimitive(value);
}

function maybeWrapAsError(maybeError) {
    if (!isPrimitive(maybeError)) return maybeError;

    return new Error(asString(maybeError));
}

function withAppended(target, appendee) {
    var len = target.length;
    var ret = new Array(len + 1);
    var i;
    for (i = 0; i < len; ++i) {
        ret[i] = target[i];
    }
    ret[i] = appendee;
    return ret;
}

function getDataPropertyOrDefault(obj, key, defaultValue) {
    if (es5.isES5) {
        var desc = Object.getOwnPropertyDescriptor(obj, key);
        if (desc != null) {
            return desc.get == null && desc.set == null
                    ? desc.value
                    : defaultValue;
        }
    } else {
        return {}.hasOwnProperty.call(obj, key) ? obj[key] : void 0;
    }
}

function notEnumerableProp(obj, name, value) {
    if (isPrimitive(obj)) return obj;
    var descriptor = {
        value: value,
        configurable: true,
        enumerable: false,
        writable: true
    };
    es5.defineProperty(obj, name, descriptor);
    return obj;
}


var wrapsPrimitiveReceiver = (function() {
    return this !== "string";
}).call("string");

function thrower(r) {
    throw r;
}

var inheritedDataKeys = (function() {
    if (es5.isES5) {
        return function(obj, opts) {
            var ret = [];
            var visitedKeys = Object.create(null);
            var getKeys = Object(opts).includeHidden
                ? Object.getOwnPropertyNames
                : Object.keys;
            while (obj != null) {
                var keys;
                try {
                    keys = getKeys(obj);
                } catch (e) {
                    return ret;
                }
                for (var i = 0; i < keys.length; ++i) {
                    var key = keys[i];
                    if (visitedKeys[key]) continue;
                    visitedKeys[key] = true;
                    var desc = Object.getOwnPropertyDescriptor(obj, key);
                    if (desc != null && desc.get == null && desc.set == null) {
                        ret.push(key);
                    }
                }
                obj = es5.getPrototypeOf(obj);
            }
            return ret;
        };
    } else {
        return function(obj) {
            var ret = [];
            /*jshint forin:false */
            for (var key in obj) {
                ret.push(key);
            }
            return ret;
        };
    }

})();

function isClass(fn) {
    try {
        if (typeof fn === "function") {
            var keys = es5.keys(fn.prototype);
            return keys.length > 0 &&
                   !(keys.length === 1 && keys[0] === "constructor");
        }
        return false;
    } catch (e) {
        return false;
    }
}

function toFastProperties(obj) {
    /*jshint -W027*/
    function f() {}
    f.prototype = obj;
    return f;
    eval(obj);
}

var rident = /^[a-z$_][a-z$_0-9]*$/i;
function isIdentifier(str) {
    return rident.test(str);
}

function filledRange(count, prefix, suffix) {
    var ret = new Array(count);
    for(var i = 0; i < count; ++i) {
        ret[i] = prefix + i + suffix;
    }
    return ret;
}

var ret = {
    isClass: isClass,
    isIdentifier: isIdentifier,
    inheritedDataKeys: inheritedDataKeys,
    getDataPropertyOrDefault: getDataPropertyOrDefault,
    thrower: thrower,
    isArray: es5.isArray,
    haveGetters: haveGetters,
    notEnumerableProp: notEnumerableProp,
    isPrimitive: isPrimitive,
    isObject: isObject,
    canEvaluate: canEvaluate,
    errorObj: errorObj,
    tryCatch1: tryCatch1,
    tryCatch2: tryCatch2,
    tryCatch3: tryCatch3,
    tryCatch4: tryCatch4,
    tryCatchApply: tryCatchApply,
    inherits: inherits,
    withAppended: withAppended,
    asString: asString,
    maybeWrapAsError: maybeWrapAsError,
    wrapsPrimitiveReceiver: wrapsPrimitiveReceiver,
    toFastProperties: toFastProperties,
    filledRange: filledRange
};

module.exports = ret;

},{"./es5.js":98}],69:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule = require("./schedule.js");
var Queue = require("./queue.js");
var errorObj = require("./util.js").errorObj;
var tryCatch1 = require("./util.js").tryCatch1;
var _process = typeof process !== "undefined" ? process : void 0;

function Async() {
    this._isTickUsed = false;
    this._schedule = schedule;
    this._length = 0;
    this._lateBuffer = new Queue(16);
    this._functionBuffer = new Queue(65536);
    var self = this;
    this.consumeFunctionBuffer = function Async$consumeFunctionBuffer() {
        self._consumeFunctionBuffer();
    };
}

Async.prototype.haveItemsQueued = function Async$haveItemsQueued() {
    return this._length > 0;
};

Async.prototype.invokeLater = function Async$invokeLater(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    this._lateBuffer.push(fn, receiver, arg);
    this._queueTick();
};

Async.prototype.invoke = function Async$invoke(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    var functionBuffer = this._functionBuffer;
    functionBuffer.push(fn, receiver, arg);
    this._length = functionBuffer.length();
    this._queueTick();
};

Async.prototype._consumeFunctionBuffer =
function Async$_consumeFunctionBuffer() {
    var functionBuffer = this._functionBuffer;
    while (functionBuffer.length() > 0) {
        var fn = functionBuffer.shift();
        var receiver = functionBuffer.shift();
        var arg = functionBuffer.shift();
        fn.call(receiver, arg);
    }
    this._reset();
    this._consumeLateBuffer();
};

Async.prototype._consumeLateBuffer = function Async$_consumeLateBuffer() {
    var buffer = this._lateBuffer;
    while(buffer.length() > 0) {
        var fn = buffer.shift();
        var receiver = buffer.shift();
        var arg = buffer.shift();
        var res = tryCatch1(fn, receiver, arg);
        if (res === errorObj) {
            this._queueTick();
            if (fn.domain != null) {
                fn.domain.emit("error", res.e);
            } else {
                throw res.e;
            }
        }
    }
};

Async.prototype._queueTick = function Async$_queue() {
    if (!this._isTickUsed) {
        this._schedule(this.consumeFunctionBuffer);
        this._isTickUsed = true;
    }
};

Async.prototype._reset = function Async$_reset() {
    this._isTickUsed = false;
    this._length = 0;
};

module.exports = new Async();

})(require("__browserify_process"))
},{"./schedule.js":99,"./queue.js":100,"./util.js":68,"__browserify_process":67}],70:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Objectfreeze = require("./es5.js").freeze;
var util = require("./util.js");
var inherits = util.inherits;
var notEnumerableProp = util.notEnumerableProp;

function markAsOriginatingFromRejection(e) {
    try {
        notEnumerableProp(e, "isOperational", true);
    }
    catch(ignore) {}
}

function originatesFromRejection(e) {
    if (e == null) return false;
    return ((e instanceof OperationalError) ||
        e["isOperational"] === true);
}

function isError(obj) {
    return obj instanceof Error;
}

function canAttach(obj) {
    return isError(obj);
}

function subError(nameProperty, defaultMessage) {
    function SubError(message) {
        if (!(this instanceof SubError)) return new SubError(message);
        this.message = typeof message === "string" ? message : defaultMessage;
        this.name = nameProperty;
        if (Error.captureStackTrace) {
            Error.captureStackTrace(this, this.constructor);
        }
    }
    inherits(SubError, Error);
    return SubError;
}

var _TypeError, _RangeError;
var CancellationError = subError("CancellationError", "cancellation error");
var TimeoutError = subError("TimeoutError", "timeout error");
var AggregateError = subError("AggregateError", "aggregate error");
try {
    _TypeError = TypeError;
    _RangeError = RangeError;
} catch(e) {
    _TypeError = subError("TypeError", "type error");
    _RangeError = subError("RangeError", "range error");
}

var methods = ("join pop push shift unshift slice filter forEach some " +
    "every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");

for (var i = 0; i < methods.length; ++i) {
    if (typeof Array.prototype[methods[i]] === "function") {
        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];
    }
}

AggregateError.prototype.length = 0;
AggregateError.prototype["isOperational"] = true;
var level = 0;
AggregateError.prototype.toString = function() {
    var indent = Array(level * 4 + 1).join(" ");
    var ret = "\n" + indent + "AggregateError of:" + "\n";
    level++;
    indent = Array(level * 4 + 1).join(" ");
    for (var i = 0; i < this.length; ++i) {
        var str = this[i] === this ? "[Circular AggregateError]" : this[i] + "";
        var lines = str.split("\n");
        for (var j = 0; j < lines.length; ++j) {
            lines[j] = indent + lines[j];
        }
        str = lines.join("\n");
        ret += str + "\n";
    }
    level--;
    return ret;
};

function OperationalError(message) {
    this.name = "OperationalError";
    this.message = message;
    this.cause = message;
    this["isOperational"] = true;

    if (message instanceof Error) {
        this.message = message.message;
        this.stack = message.stack;
    } else if (Error.captureStackTrace) {
        Error.captureStackTrace(this, this.constructor);
    }

}
inherits(OperationalError, Error);

var key = "__BluebirdErrorTypes__";
var errorTypes = Error[key];
if (!errorTypes) {
    errorTypes = Objectfreeze({
        CancellationError: CancellationError,
        TimeoutError: TimeoutError,
        OperationalError: OperationalError,
        RejectionError: OperationalError,
        AggregateError: AggregateError
    });
    notEnumerableProp(Error, key, errorTypes);
}

module.exports = {
    Error: Error,
    TypeError: _TypeError,
    RangeError: _RangeError,
    CancellationError: errorTypes.CancellationError,
    OperationalError: errorTypes.OperationalError,
    TimeoutError: errorTypes.TimeoutError,
    AggregateError: errorTypes.AggregateError,
    originatesFromRejection: originatesFromRejection,
    markAsOriginatingFromRejection: markAsOriginatingFromRejection,
    canAttach: canAttach
};

},{"./es5.js":98,"./util.js":68}],71:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var util = require("./util.js");
var canAttach = require("./errors.js").canAttach;
var errorObj = util.errorObj;
var isObject = util.isObject;

function getThen(obj) {
    try {
        return obj.then;
    }
    catch(e) {
        errorObj.e = e;
        return errorObj;
    }
}

function Promise$_Cast(obj, originalPromise) {
    if (isObject(obj)) {
        if (obj instanceof Promise) {
            return obj;
        }
        else if (isAnyBluebirdPromise(obj)) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            obj._then(
                ret._fulfillUnchecked,
                ret._rejectUncheckedCheckError,
                ret._progressUnchecked,
                ret,
                null
            );
            ret._setFollowing();
            return ret;
        }
        var then = getThen(obj);
        if (then === errorObj) {
            if (originalPromise !== void 0 && canAttach(then.e)) {
                originalPromise._attachExtraTrace(then.e);
            }
            return Promise.reject(then.e);
        } else if (typeof then === "function") {
            return Promise$_doThenable(obj, then, originalPromise);
        }
    }
    return obj;
}

var hasProp = {}.hasOwnProperty;
function isAnyBluebirdPromise(obj) {
    return hasProp.call(obj, "_promise0");
}

function Promise$_doThenable(x, then, originalPromise) {
    var resolver = Promise.defer();
    var called = false;
    try {
        then.call(
            x,
            Promise$_resolveFromThenable,
            Promise$_rejectFromThenable,
            Promise$_progressFromThenable
        );
    } catch(e) {
        if (!called) {
            called = true;
            var trace = canAttach(e) ? e : new Error(e + "");
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(trace);
            }
            resolver.promise._reject(e, trace);
        }
    }
    return resolver.promise;

    function Promise$_resolveFromThenable(y) {
        if (called) return;
        called = true;

        if (x === y) {
            var e = Promise._makeSelfResolutionError();
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(e);
            }
            resolver.promise._reject(e, void 0);
            return;
        }
        resolver.resolve(y);
    }

    function Promise$_rejectFromThenable(r) {
        if (called) return;
        called = true;
        var trace = canAttach(r) ? r : new Error(r + "");
        if (originalPromise !== void 0) {
            originalPromise._attachExtraTrace(trace);
        }
        resolver.promise._reject(r, trace);
    }

    function Promise$_progressFromThenable(v) {
        if (called) return;
        var promise = resolver.promise;
        if (typeof promise._progress === "function") {
            promise._progress(v);
        }
    }
}

return Promise$_Cast;
};

},{"./util.js":68,"./errors.js":70}],72:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var canAttach = require("./errors.js").canAttach;
var util = require("./util.js");
var isArray = util.isArray;

function toResolutionValue(val) {
    switch(val) {
    case -1: return void 0;
    case -2: return [];
    case -3: return {};
    }
}

function PromiseArray(values) {
    var promise = this._promise = new Promise(INTERNAL);
    var parent = void 0;
    if (values instanceof Promise) {
        parent = values;
        promise._propagateFrom(parent, 1 | 4);
    }
    promise._setTrace(parent);
    this._values = values;
    this._length = 0;
    this._totalResolved = 0;
    this._init(void 0, -2);
}
PromiseArray.prototype.length = function PromiseArray$length() {
    return this._length;
};

PromiseArray.prototype.promise = function PromiseArray$promise() {
    return this._promise;
};

PromiseArray.prototype._init =
function PromiseArray$_init(_, resolveValueIfEmpty) {
    var values = cast(this._values, void 0);
    if (values instanceof Promise) {
        this._values = values;
        values._setBoundTo(this._promise._boundTo);
        if (values.isFulfilled()) {
            values = values._settledValue;
            if (!isArray(values)) {
                var err = new Promise.TypeError("expecting an array, a promise or a thenable");
                this.__hardReject__(err);
                return;
            }
        } else if (values.isPending()) {
            values._then(
                PromiseArray$_init,
                this._reject,
                void 0,
                this,
                resolveValueIfEmpty
           );
            return;
        } else {
            values._unsetRejectionIsUnhandled();
            this._reject(values._settledValue);
            return;
        }
    } else if (!isArray(values)) {
        var err = new Promise.TypeError("expecting an array, a promise or a thenable");
        this.__hardReject__(err);
        return;
    }

    if (values.length === 0) {
        if (resolveValueIfEmpty === -5) {
            this._resolveEmptyArray();
        }
        else {
            this._resolve(toResolutionValue(resolveValueIfEmpty));
        }
        return;
    }
    var len = this.getActualLength(values.length);
    var newLen = len;
    var newValues = this.shouldCopyValues() ? new Array(len) : this._values;
    var isDirectScanNeeded = false;
    for (var i = 0; i < len; ++i) {
        var maybePromise = cast(values[i], void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                maybePromise._proxyPromiseArray(this, i);
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                isDirectScanNeeded = true;
            }
        } else {
            isDirectScanNeeded = true;
        }
        newValues[i] = maybePromise;
    }
    this._values = newValues;
    this._length = newLen;
    if (isDirectScanNeeded) {
        this._scanDirectValues(len);
    }
};

PromiseArray.prototype._settlePromiseAt =
function PromiseArray$_settlePromiseAt(index) {
    var value = this._values[index];
    if (!(value instanceof Promise)) {
        this._promiseFulfilled(value, index);
    } else if (value.isFulfilled()) {
        this._promiseFulfilled(value._settledValue, index);
    } else if (value.isRejected()) {
        this._promiseRejected(value._settledValue, index);
    }
};

PromiseArray.prototype._scanDirectValues =
function PromiseArray$_scanDirectValues(len) {
    for (var i = 0; i < len; ++i) {
        if (this._isResolved()) {
            break;
        }
        this._settlePromiseAt(i);
    }
};

PromiseArray.prototype._isResolved = function PromiseArray$_isResolved() {
    return this._values === null;
};

PromiseArray.prototype._resolve = function PromiseArray$_resolve(value) {
    this._values = null;
    this._promise._fulfill(value);
};

PromiseArray.prototype.__hardReject__ =
PromiseArray.prototype._reject = function PromiseArray$_reject(reason) {
    this._values = null;
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._promise._attachExtraTrace(trace);
    this._promise._reject(reason, trace);
};

PromiseArray.prototype._promiseProgressed =
function PromiseArray$_promiseProgressed(progressValue, index) {
    if (this._isResolved()) return;
    this._promise._progress({
        index: index,
        value: progressValue
    });
};


PromiseArray.prototype._promiseFulfilled =
function PromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

PromiseArray.prototype._promiseRejected =
function PromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    this._totalResolved++;
    this._reject(reason);
};

PromiseArray.prototype.shouldCopyValues =
function PromiseArray$_shouldCopyValues() {
    return true;
};

PromiseArray.prototype.getActualLength =
function PromiseArray$getActualLength(len) {
    return len;
};

return PromiseArray;
};

},{"./errors.js":70,"./util.js":68}],73:[function(require,module,exports){
(function(){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function() {
var inherits = require("./util.js").inherits;
var defineProperty = require("./es5.js").defineProperty;

var rignore = new RegExp(
    "\\b(?:[a-zA-Z0-9.]+\\$_\\w+|" +
    "tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|" +
    "\\w*PromiseArray\\.\\w*PromiseArray|" +
    "setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|" +
    "process._tickCallback|nextTick|Async\\$\\w+)\\b"
);

var rtraceline = null;
var formatStack = null;

function formatNonError(obj) {
    var str;
    if (typeof obj === "function") {
        str = "[function " +
            (obj.name || "anonymous") +
            "]";
    } else {
        str = obj.toString();
        var ruselessToString = /\[object [a-zA-Z0-9$_]+\]/;
        if (ruselessToString.test(str)) {
            try {
                var newStr = JSON.stringify(obj);
                str = newStr;
            }
            catch(e) {

            }
        }
        if (str.length === 0) {
            str = "(empty array)";
        }
    }
    return ("(<" + snip(str) + ">, no stack trace)");
}

function snip(str) {
    var maxChars = 41;
    if (str.length < maxChars) {
        return str;
    }
    return str.substr(0, maxChars - 3) + "...";
}

function CapturedTrace(ignoreUntil, isTopLevel) {
    this.captureStackTrace(CapturedTrace, isTopLevel);

}
inherits(CapturedTrace, Error);

CapturedTrace.prototype.captureStackTrace =
function CapturedTrace$captureStackTrace(ignoreUntil, isTopLevel) {
    captureStackTrace(this, ignoreUntil, isTopLevel);
};

CapturedTrace.possiblyUnhandledRejection =
function CapturedTrace$PossiblyUnhandledRejection(reason) {
    if (typeof console === "object") {
        var message;
        if (typeof reason === "object" || typeof reason === "function") {
            var stack = reason.stack;
            message = "Possibly unhandled " + formatStack(stack, reason);
        } else {
            message = "Possibly unhandled " + String(reason);
        }
        if (typeof console.error === "function" ||
            typeof console.error === "object") {
            console.error(message);
        } else if (typeof console.log === "function" ||
            typeof console.log === "object") {
            console.log(message);
        }
    }
};

CapturedTrace.combine = function CapturedTrace$Combine(current, prev) {
    var curLast = current.length - 1;
    for (var i = prev.length - 1; i >= 0; --i) {
        var line = prev[i];
        if (current[curLast] === line) {
            current.pop();
            curLast--;
        } else {
            break;
        }
    }

    current.push("From previous event:");
    var lines = current.concat(prev);

    var ret = [];

    for (var i = 0, len = lines.length; i < len; ++i) {

        if ((rignore.test(lines[i]) ||
            (i > 0 && !rtraceline.test(lines[i])) &&
            lines[i] !== "From previous event:")
       ) {
            continue;
        }
        ret.push(lines[i]);
    }
    return ret;
};

CapturedTrace.protectErrorMessageNewlines = function(stack) {
    for (var i = 0; i < stack.length; ++i) {
        if (rtraceline.test(stack[i])) {
            break;
        }
    }

    if (i <= 1) return;

    var errorMessageLines = [];
    for (var j = 0; j < i; ++j) {
        errorMessageLines.push(stack.shift());
    }
    stack.unshift(errorMessageLines.join("\u0002\u0000\u0001"));
};

CapturedTrace.isSupported = function CapturedTrace$IsSupported() {
    return typeof captureStackTrace === "function";
};

var captureStackTrace = (function stackDetection() {
    if (typeof Error.stackTraceLimit === "number" &&
        typeof Error.captureStackTrace === "function") {
        rtraceline = /^\s*at\s*/;
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);


        };
        var captureStackTrace = Error.captureStackTrace;
        return function CapturedTrace$_captureStackTrace(
            receiver, ignoreUntil) {
            captureStackTrace(receiver, ignoreUntil);
        };
    }
    var err = new Error();

    if (typeof err.stack === "string" &&
        typeof "".startsWith === "function" &&
        (err.stack.startsWith("stackDetection@")) &&
        stackDetection.name === "stackDetection") {

        defineProperty(Error, "stackTraceLimit", {
            writable: true,
            enumerable: false,
            configurable: false,
            value: 25
        });
        rtraceline = /@/;
        var rline = /[@\n]/;

        formatStack = function(stack, error) {
            if (typeof stack === "string") {
                return (error.name + ". " + error.message + "\n" + stack);
            }

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return function captureStackTrace(o) {
            var stack = new Error().stack;
            var split = stack.split(rline);
            var len = split.length;
            var ret = "";
            for (var i = 0; i < len; i += 2) {
                ret += split[i];
                ret += "@";
                ret += split[i + 1];
                ret += "\n";
            }
            o.stack = ret;
        };
    } else {
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if ((typeof error === "object" ||
                typeof error === "function") &&
                error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return null;
    }
})();

return CapturedTrace;
};

})()
},{"./util.js":68,"./es5.js":98}],74:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(NEXT_FILTER) {
var util = require("./util.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;
var keys = require("./es5.js").keys;
var TypeError = errors.TypeError;

function CatchFilter(instances, callback, promise) {
    this._instances = instances;
    this._callback = callback;
    this._promise = promise;
}

function CatchFilter$_safePredicate(predicate, e) {
    var safeObject = {};
    var retfilter = tryCatch1(predicate, safeObject, e);

    if (retfilter === errorObj) return retfilter;

    var safeKeys = keys(safeObject);
    if (safeKeys.length) {
        errorObj.e = new TypeError(
            "Catch filter must inherit from Error "
          + "or be a simple predicate function");
        return errorObj;
    }
    return retfilter;
}

CatchFilter.prototype.doFilter = function CatchFilter$_doFilter(e) {
    var cb = this._callback;
    var promise = this._promise;
    var boundTo = promise._boundTo;
    for (var i = 0, len = this._instances.length; i < len; ++i) {
        var item = this._instances[i];
        var itemIsErrorType = item === Error ||
            (item != null && item.prototype instanceof Error);

        if (itemIsErrorType && e instanceof item) {
            var ret = tryCatch1(cb, boundTo, e);
            if (ret === errorObj) {
                NEXT_FILTER.e = ret.e;
                return NEXT_FILTER;
            }
            return ret;
        } else if (typeof item === "function" && !itemIsErrorType) {
            var shouldHandle = CatchFilter$_safePredicate(item, e);
            if (shouldHandle === errorObj) {
                var trace = errors.canAttach(errorObj.e)
                    ? errorObj.e
                    : new Error(errorObj.e + "");
                this._promise._attachExtraTrace(trace);
                e = errorObj.e;
                break;
            } else if (shouldHandle) {
                var ret = tryCatch1(cb, boundTo, e);
                if (ret === errorObj) {
                    NEXT_FILTER.e = ret.e;
                    return NEXT_FILTER;
                }
                return ret;
            }
        }
    }
    NEXT_FILTER.e = e;
    return NEXT_FILTER;
};

return CatchFilter;
};

},{"./util.js":68,"./errors.js":70,"./es5.js":98}],75:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var maybeWrapAsError = util.maybeWrapAsError;
var errors = require("./errors.js");
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var async = require("./async.js");
var haveGetters = util.haveGetters;
var es5 = require("./es5.js");

function isUntypedError(obj) {
    return obj instanceof Error &&
        es5.getPrototypeOf(obj) === Error.prototype;
}

function wrapAsOperationalError(obj) {
    var ret;
    if (isUntypedError(obj)) {
        ret = new OperationalError(obj);
    } else {
        ret = obj;
    }
    errors.markAsOriginatingFromRejection(ret);
    return ret;
}

function nodebackForPromise(promise) {
    function PromiseResolver$_callback(err, value) {
        if (promise === null) return;

        if (err) {
            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        } else if (arguments.length > 2) {
            var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
            promise._fulfill(args);
        } else {
            promise._fulfill(value);
        }

        promise = null;
    }
    return PromiseResolver$_callback;
}


var PromiseResolver;
if (!haveGetters) {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
        this.asCallback = nodebackForPromise(promise);
        this.callback = this.asCallback;
    };
}
else {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
    };
}
if (haveGetters) {
    var prop = {
        get: function() {
            return nodebackForPromise(this.promise);
        }
    };
    es5.defineProperty(PromiseResolver.prototype, "asCallback", prop);
    es5.defineProperty(PromiseResolver.prototype, "callback", prop);
}

PromiseResolver._nodebackForPromise = nodebackForPromise;

PromiseResolver.prototype.toString = function PromiseResolver$toString() {
    return "[object PromiseResolver]";
};

PromiseResolver.prototype.resolve =
PromiseResolver.prototype.fulfill = function PromiseResolver$resolve(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    if (promise._tryFollow(value)) {
        return;
    }
    async.invoke(promise._fulfill, promise, value);
};

PromiseResolver.prototype.reject = function PromiseResolver$reject(reason) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    errors.markAsOriginatingFromRejection(reason);
    var trace = errors.canAttach(reason) ? reason : new Error(reason + "");
    promise._attachExtraTrace(trace);
    async.invoke(promise._reject, promise, reason);
    if (trace !== reason) {
        async.invoke(this._setCarriedStackTrace, this, trace);
    }
};

PromiseResolver.prototype.progress =
function PromiseResolver$progress(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }
    async.invoke(this.promise._progress, this.promise, value);
};

PromiseResolver.prototype.cancel = function PromiseResolver$cancel() {
    async.invoke(this.promise.cancel, this.promise, void 0);
};

PromiseResolver.prototype.timeout = function PromiseResolver$timeout() {
    this.reject(new TimeoutError("timeout"));
};

PromiseResolver.prototype.isResolved = function PromiseResolver$isResolved() {
    return this.promise.isResolved();
};

PromiseResolver.prototype.toJSON = function PromiseResolver$toJSON() {
    return this.promise.toJSON();
};

PromiseResolver.prototype._setCarriedStackTrace =
function PromiseResolver$_setCarriedStackTrace(trace) {
    if (this.promise.isRejected()) {
        this.promise._setCarriedStackTrace(trace);
    }
};

module.exports = PromiseResolver;

},{"./util.js":68,"./errors.js":70,"./async.js":69,"./es5.js":98}],76:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, NEXT_FILTER, cast) {
var util = require("./util.js");
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;
var isPrimitive = util.isPrimitive;
var thrower = util.thrower;

function returnThis() {
    return this;
}
function throwThis() {
    throw this;
}
function return$(r) {
    return function Promise$_returner() {
        return r;
    };
}
function throw$(r) {
    return function Promise$_thrower() {
        throw r;
    };
}
function promisedFinally(ret, reasonOrValue, isFulfilled) {
    var then;
    if (wrapsPrimitiveReceiver && isPrimitive(reasonOrValue)) {
        then = isFulfilled ? return$(reasonOrValue) : throw$(reasonOrValue);
    } else {
        then = isFulfilled ? returnThis : throwThis;
    }
    return ret._then(then, thrower, void 0, reasonOrValue, void 0);
}

function finallyHandler(reasonOrValue) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo)
                    : handler();

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, reasonOrValue,
                                    promise.isFulfilled());
        }
    }

    if (promise.isRejected()) {
        NEXT_FILTER.e = reasonOrValue;
        return NEXT_FILTER;
    } else {
        return reasonOrValue;
    }
}

function tapHandler(value) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo, value)
                    : handler(value);

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, value, true);
        }
    }
    return value;
}

Promise.prototype._passThroughHandler =
function Promise$_passThroughHandler(handler, isFinally) {
    if (typeof handler !== "function") return this.then();

    var promiseAndHandler = {
        promise: this,
        handler: handler
    };

    return this._then(
            isFinally ? finallyHandler : tapHandler,
            isFinally ? finallyHandler : void 0, void 0,
            promiseAndHandler, void 0);
};

Promise.prototype.lastly =
Promise.prototype["finally"] = function Promise$finally(handler) {
    return this._passThroughHandler(handler, true);
};

Promise.prototype.tap = function Promise$tap(handler) {
    return this._passThroughHandler(handler, false);
};
};

},{"./util.js":68}],77:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var isPrimitive = util.isPrimitive;
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;

module.exports = function(Promise) {
var returner = function Promise$_returner() {
    return this;
};
var thrower = function Promise$_thrower() {
    throw this;
};

var wrapper = function Promise$_wrapper(value, action) {
    if (action === 1) {
        return function Promise$_thrower() {
            throw value;
        };
    } else if (action === 2) {
        return function Promise$_returner() {
            return value;
        };
    }
};


Promise.prototype["return"] =
Promise.prototype.thenReturn =
function Promise$thenReturn(value) {
    if (wrapsPrimitiveReceiver && isPrimitive(value)) {
        return this._then(
            wrapper(value, 2),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(returner, void 0, void 0, value, void 0);
};

Promise.prototype["throw"] =
Promise.prototype.thenThrow =
function Promise$thenThrow(reason) {
    if (wrapsPrimitiveReceiver && isPrimitive(reason)) {
        return this._then(
            wrapper(reason, 1),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(thrower, void 0, void 0, reason, void 0);
};
};

},{"./util.js":68}],79:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, cast, INTERNAL) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;


if (canEvaluate) {
    var thenCallback = function(i) {
        return new Function("value", "holder", "                             \n\
            'use strict';                                                    \n\
            holder.pIndex = value;                                           \n\
            holder.checkFulfillment(this);                                   \n\
            ".replace(/Index/g, i));
    };

    var caller = function(count) {
        var values = [];
        for (var i = 1; i <= count; ++i) values.push("holder.p" + i);
        return new Function("holder", "                                      \n\
            'use strict';                                                    \n\
            var callback = holder.fn;                                        \n\
            return callback(values);                                         \n\
            ".replace(/values/g, values.join(", ")));
    };
    var thenCallbacks = [];
    var callers = [void 0];
    for (var i = 1; i <= 5; ++i) {
        thenCallbacks.push(thenCallback(i));
        callers.push(caller(i));
    }

    var Holder = function(total, fn) {
        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;
        this.fn = fn;
        this.total = total;
        this.now = 0;
    };

    Holder.prototype.callers = callers;
    Holder.prototype.checkFulfillment = function(promise) {
        var now = this.now;
        now++;
        var total = this.total;
        if (now >= total) {
            var handler = this.callers[total];
            var ret = tryCatch1(handler, void 0, this);
            if (ret === errorObj) {
                promise._rejectUnchecked(ret.e);
            } else if (!promise._tryFollow(ret)) {
                promise._fulfillUnchecked(ret);
            }
        } else {
            this.now = now;
        }
    };
}




Promise.join = function Promise$Join() {
    var last = arguments.length - 1;
    var fn;
    if (last > 0 && typeof arguments[last] === "function") {
        fn = arguments[last];
        if (last < 6 && canEvaluate) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            var holder = new Holder(last, fn);
            var reject = ret._reject;
            var callbacks = thenCallbacks;
            for (var i = 0; i < last; ++i) {
                var maybePromise = cast(arguments[i], void 0);
                if (maybePromise instanceof Promise) {
                    if (maybePromise.isPending()) {
                        maybePromise._then(callbacks[i], reject,
                                           void 0, ret, holder);
                    } else if (maybePromise.isFulfilled()) {
                        callbacks[i].call(ret,
                                          maybePromise._settledValue, holder);
                    } else {
                        ret._reject(maybePromise._settledValue);
                        maybePromise._unsetRejectionIsUnhandled();
                    }
                } else {
                    callbacks[i].call(ret, maybePromise, holder);
                }
            }
            return ret;
        }
    }
    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
    var ret = new PromiseArray(args).promise();
    return fn !== void 0 ? ret.spread(fn) : ret;
};

};

},{"./util.js":68}],81:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var apiRejection = require("./errors_api_rejection.js")(Promise);
var isArray = require("./util.js").isArray;

var raceLater = function Promise$_raceLater(promise) {
    return promise.then(function(array) {
        return Promise$_Race(array, promise);
    });
};

var hasOwn = {}.hasOwnProperty;
function Promise$_Race(promises, parent) {
    var maybePromise = cast(promises, void 0);

    if (maybePromise instanceof Promise) {
        return raceLater(maybePromise);
    } else if (!isArray(promises)) {
        return apiRejection("expecting an array, a promise or a thenable");
    }

    var ret = new Promise(INTERNAL);
    if (parent !== void 0) {
        ret._propagateFrom(parent, 7);
    } else {
        ret._setTrace(void 0);
    }
    var fulfill = ret._fulfill;
    var reject = ret._reject;
    for (var i = 0, len = promises.length; i < len; ++i) {
        var val = promises[i];

        if (val === void 0 && !(hasOwn.call(promises, i))) {
            continue;
        }

        Promise.cast(val)._then(fulfill, reject, void 0, ret, null);
    }
    return ret;
}

Promise.race = function Promise$Race(promises) {
    return Promise$_Race(promises, void 0);
};

Promise.prototype.race = function Promise$race() {
    return Promise$_Race(this, void 0);
};

};

},{"./errors_api_rejection.js":97,"./util.js":68}],82:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var cr = Object.create;
if (cr) {
    var callerCache = cr(null);
    var getterCache = cr(null);
    callerCache[" size"] = getterCache[" size"] = 0;
}

module.exports = function(Promise) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var isIdentifier = util.isIdentifier;

function makeMethodCaller (methodName) {
    return new Function("obj", "                                             \n\
        'use strict'                                                         \n\
        var len = this.length;                                               \n\
        switch(len) {                                                        \n\
            case 1: return obj.methodName(this[0]);                          \n\
            case 2: return obj.methodName(this[0], this[1]);                 \n\
            case 3: return obj.methodName(this[0], this[1], this[2]);        \n\
            case 0: return obj.methodName();                                 \n\
            default: return obj.methodName.apply(obj, this);                 \n\
        }                                                                    \n\
        ".replace(/methodName/g, methodName));
}

function makeGetter (propertyName) {
    return new Function("obj", "                                             \n\
        'use strict';                                                        \n\
        return obj.propertyName;                                             \n\
        ".replace("propertyName", propertyName));
}

function getCompiled(name, compiler, cache) {
    var ret = cache[name];
    if (typeof ret !== "function") {
        if (!isIdentifier(name)) {
            return null;
        }
        ret = compiler(name);
        cache[name] = ret;
        cache[" size"]++;
        if (cache[" size"] > 512) {
            var keys = Object.keys(cache);
            for (var i = 0; i < 256; ++i) delete cache[keys[i]];
            cache[" size"] = keys.length - 256;
        }
    }
    return ret;
}

function getMethodCaller(name) {
    return getCompiled(name, makeMethodCaller, callerCache);
}

function getGetter(name) {
    return getCompiled(name, makeGetter, getterCache);
}

function caller(obj) {
    return obj[this.pop()].apply(obj, this);
}
Promise.prototype.call = function Promise$call(methodName) {
    var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
    if (canEvaluate) {
        var maybeCaller = getMethodCaller(methodName);
        if (maybeCaller !== null) {
            return this._then(maybeCaller, void 0, void 0, args, void 0);
        }
    }
    args.push(methodName);
    return this._then(caller, void 0, void 0, args, void 0);
};

function namedGetter(obj) {
    return obj[this];
}
function indexedGetter(obj) {
    return obj[this];
}
Promise.prototype.get = function Promise$get(propertyName) {
    var isIndex = (typeof propertyName === "number");
    var getter;
    if (!isIndex) {
        if (canEvaluate) {
            var maybeGetter = getGetter(propertyName);
            getter = maybeGetter !== null ? maybeGetter : namedGetter;
        } else {
            getter = namedGetter;
        }
    } else {
        getter = indexedGetter;
    }
    return this._then(getter, void 0, void 0, propertyName, void 0);
};
};

},{"./util.js":68}],83:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, apiRejection, INTERNAL, cast) {
var errors = require("./errors.js");
var TypeError = errors.TypeError;
var deprecated = require("./util.js").deprecated;
var util = require("./util.js");
var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var yieldHandlers = [];

function promiseFromYieldHandler(value, yieldHandlers) {
    var _errorObj = errorObj;
    var _Promise = Promise;
    var len = yieldHandlers.length;
    for (var i = 0; i < len; ++i) {
        var result = tryCatch1(yieldHandlers[i], void 0, value);
        if (result === _errorObj) {
            return _Promise.reject(_errorObj.e);
        }
        var maybePromise = cast(result, promiseFromYieldHandler);
        if (maybePromise instanceof _Promise) return maybePromise;
    }
    return null;
}

function PromiseSpawn(generatorFunction, receiver, yieldHandler) {
    var promise = this._promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    this._generatorFunction = generatorFunction;
    this._receiver = receiver;
    this._generator = void 0;
    this._yieldHandlers = typeof yieldHandler === "function"
        ? [yieldHandler].concat(yieldHandlers)
        : yieldHandlers;
}

PromiseSpawn.prototype.promise = function PromiseSpawn$promise() {
    return this._promise;
};

PromiseSpawn.prototype._run = function PromiseSpawn$_run() {
    this._generator = this._generatorFunction.call(this._receiver);
    this._receiver =
        this._generatorFunction = void 0;
    this._next(void 0);
};

PromiseSpawn.prototype._continue = function PromiseSpawn$_continue(result) {
    if (result === errorObj) {
        this._generator = void 0;
        var trace = errors.canAttach(result.e)
            ? result.e : new Error(result.e + "");
        this._promise._attachExtraTrace(trace);
        this._promise._reject(result.e, trace);
        return;
    }

    var value = result.value;
    if (result.done === true) {
        this._generator = void 0;
        if (!this._promise._tryFollow(value)) {
            this._promise._fulfill(value);
        }
    } else {
        var maybePromise = cast(value, void 0);
        if (!(maybePromise instanceof Promise)) {
            maybePromise =
                promiseFromYieldHandler(maybePromise, this._yieldHandlers);
            if (maybePromise === null) {
                this._throw(new TypeError("A value was yielded that could not be treated as a promise"));
                return;
            }
        }
        maybePromise._then(
            this._next,
            this._throw,
            void 0,
            this,
            null
       );
    }
};

PromiseSpawn.prototype._throw = function PromiseSpawn$_throw(reason) {
    if (errors.canAttach(reason))
        this._promise._attachExtraTrace(reason);
    this._continue(
        tryCatch1(this._generator["throw"], this._generator, reason)
   );
};

PromiseSpawn.prototype._next = function PromiseSpawn$_next(value) {
    this._continue(
        tryCatch1(this._generator.next, this._generator, value)
   );
};

Promise.coroutine =
function Promise$Coroutine(generatorFunction, options) {
    if (typeof generatorFunction !== "function") {
        throw new TypeError("generatorFunction must be a function");
    }
    var yieldHandler = Object(options).yieldHandler;
    var PromiseSpawn$ = PromiseSpawn;
    return function () {
        var generator = generatorFunction.apply(this, arguments);
        var spawn = new PromiseSpawn$(void 0, void 0, yieldHandler);
        spawn._generator = generator;
        spawn._next(void 0);
        return spawn.promise();
    };
};

Promise.coroutine.addYieldHandler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    yieldHandlers.push(fn);
};

Promise.spawn = function Promise$Spawn(generatorFunction) {
    deprecated("Promise.spawn is deprecated. Use Promise.coroutine instead.");
    if (typeof generatorFunction !== "function") {
        return apiRejection("generatorFunction must be a function");
    }
    var spawn = new PromiseSpawn(generatorFunction, this);
    var ret = spawn.promise();
    spawn._run(Promise.spawn);
    return ret;
};
};

},{"./errors.js":70,"./util.js":68}],84:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
var PENDING = {};
var EMPTY_ARRAY = [];

function MappingPromiseArray(promises, fn, limit, _filter) {
    this.constructor$(promises);
    this._callback = fn;
    this._preservedValues = _filter === INTERNAL
        ? new Array(this.length())
        : null;
    this._limit = limit;
    this._inFlight = 0;
    this._queue = limit >= 1 ? [] : EMPTY_ARRAY;
    this._init$(void 0, -2);
}
util.inherits(MappingPromiseArray, PromiseArray);

MappingPromiseArray.prototype._init = function MappingPromiseArray$_init() {};

MappingPromiseArray.prototype._promiseFulfilled =
function MappingPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;

    var length = this.length();
    var preservedValues = this._preservedValues;
    var limit = this._limit;
    if (values[index] === PENDING) {
        values[index] = value;
        if (limit >= 1) {
            this._inFlight--;
            this._drainQueue();
            if (this._isResolved()) return;
        }
    } else {
        if (limit >= 1 && this._inFlight >= limit) {
            values[index] = value;
            this._queue.push(index);
            return;
        }
        if (preservedValues !== null) preservedValues[index] = value;

        var callback = this._callback;
        var receiver = this._promise._boundTo;
        var ret = tryCatch3(callback, receiver, value, index, length);
        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                if (limit >= 1) this._inFlight++;
                values[index] = PENDING;
                return maybePromise._proxyPromiseArray(this, index);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }
        values[index] = ret;
    }
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= length) {
        if (preservedValues !== null) {
            this._filter(values, preservedValues);
        } else {
            this._resolve(values);
        }

    }
};

MappingPromiseArray.prototype._drainQueue =
function MappingPromiseArray$_drainQueue() {
    var queue = this._queue;
    var limit = this._limit;
    var values = this._values;
    while (queue.length > 0 && this._inFlight < limit) {
        var index = queue.pop();
        this._promiseFulfilled(values[index], index);
    }
};

MappingPromiseArray.prototype._filter =
function MappingPromiseArray$_filter(booleans, values) {
    var len = values.length;
    var ret = new Array(len);
    var j = 0;
    for (var i = 0; i < len; ++i) {
        if (booleans[i]) ret[j++] = values[i];
    }
    ret.length = j;
    this._resolve(ret);
};

MappingPromiseArray.prototype.preservedValues =
function MappingPromiseArray$preserveValues() {
    return this._preservedValues;
};

function map(promises, fn, options, _filter) {
    var limit = typeof options === "object" && options !== null
        ? options.concurrency
        : 0;
    limit = typeof limit === "number" &&
        isFinite(limit) && limit >= 1 ? limit : 0;
    return new MappingPromiseArray(promises, fn, limit, _filter);
}

Promise.prototype.map = function Promise$map(fn, options) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");

    return map(this, fn, options, null).promise();
};

Promise.map = function Promise$Map(promises, fn, options, _filter) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    return map(promises, fn, options, _filter).promise();
};


};

},{"./util.js":68}],85:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var util = require("./util.js");
var async = require("./async.js");
var tryCatch2 = util.tryCatch2;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

function thrower(r) {
    throw r;
}

function Promise$_spreadAdapter(val, receiver) {
    if (!util.isArray(val)) return Promise$_successAdapter(val, receiver);
    var ret = util.tryCatchApply(this, [null].concat(val), receiver);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

function Promise$_successAdapter(val, receiver) {
    var nodeback = this;
    var ret = val === void 0
        ? tryCatch1(nodeback, receiver, null)
        : tryCatch2(nodeback, receiver, null, val);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}
function Promise$_errorAdapter(reason, receiver) {
    var nodeback = this;
    var ret = tryCatch1(nodeback, receiver, reason);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

Promise.prototype.nodeify = function Promise$nodeify(nodeback, options) {
    if (typeof nodeback == "function") {
        var adapter = Promise$_successAdapter;
        if (options !== void 0 && Object(options).spread) {
            adapter = Promise$_spreadAdapter;
        }
        this._then(
            adapter,
            Promise$_errorAdapter,
            void 0,
            nodeback,
            this._boundTo
        );
    }
    return this;
};
};

},{"./util.js":68,"./async.js":69}],87:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch4 = util.tryCatch4;
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
function ReductionPromiseArray(promises, fn, accum, _each) {
    this.constructor$(promises);
    this._preservedValues = _each === INTERNAL ? [] : null;
    this._zerothIsAccum = (accum === void 0);
    this._gotAccum = false;
    this._reducingIndex = (this._zerothIsAccum ? 1 : 0);
    this._valuesPhase = undefined;

    var maybePromise = cast(accum, void 0);
    var rejected = false;
    var isPromise = maybePromise instanceof Promise;
    if (isPromise) {
        if (maybePromise.isPending()) {
            maybePromise._proxyPromiseArray(this, -1);
        } else if (maybePromise.isFulfilled()) {
            accum = maybePromise.value();
            this._gotAccum = true;
        } else {
            maybePromise._unsetRejectionIsUnhandled();
            this._reject(maybePromise.reason());
            rejected = true;
        }
    }
    if (!(isPromise || this._zerothIsAccum)) this._gotAccum = true;
    this._callback = fn;
    this._accum = accum;
    if (!rejected) this._init$(void 0, -5);
}
util.inherits(ReductionPromiseArray, PromiseArray);

ReductionPromiseArray.prototype._init =
function ReductionPromiseArray$_init() {};

ReductionPromiseArray.prototype._resolveEmptyArray =
function ReductionPromiseArray$_resolveEmptyArray() {
    if (this._gotAccum || this._zerothIsAccum) {
        this._resolve(this._preservedValues !== null
                        ? [] : this._accum);
    }
};

ReductionPromiseArray.prototype._promiseFulfilled =
function ReductionPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;
    var length = this.length();
    var preservedValues = this._preservedValues;
    var isEach = preservedValues !== null;
    var gotAccum = this._gotAccum;
    var valuesPhase = this._valuesPhase;
    var valuesPhaseIndex;
    if (!valuesPhase) {
        valuesPhase = this._valuesPhase = Array(length);
        for (valuesPhaseIndex=0; valuesPhaseIndex<length; ++valuesPhaseIndex) {
            valuesPhase[valuesPhaseIndex] = 0;
        }
    }
    valuesPhaseIndex = valuesPhase[index];

    if (index === 0 && this._zerothIsAccum) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
        valuesPhase[index] = ((valuesPhaseIndex === 0)
            ? 1 : 2);
    } else if (index === -1) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
    } else {
        if (valuesPhaseIndex === 0) {
            valuesPhase[index] = 1;
        }
        else {
            valuesPhase[index] = 2;
            if (gotAccum) {
                this._accum = value;
            }
        }
    }
    if (!gotAccum) return;

    var callback = this._callback;
    var receiver = this._promise._boundTo;
    var ret;

    for (var i = this._reducingIndex; i < length; ++i) {
        valuesPhaseIndex = valuesPhase[i];
        if (valuesPhaseIndex === 2) {
            this._reducingIndex = i + 1;
            continue;
        }
        if (valuesPhaseIndex !== 1) return;

        value = values[i];
        if (value instanceof Promise) {
            if (value.isFulfilled()) {
                value = value._settledValue;
            } else if (value.isPending()) {
                return;
            } else {
                value._unsetRejectionIsUnhandled();
                return this._reject(value.reason());
            }
        }

        if (isEach) {
            preservedValues.push(value);
            ret = tryCatch3(callback, receiver, value, i, length);
        }
        else {
            ret = tryCatch4(callback, receiver, this._accum, value, i, length);
        }

        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                valuesPhase[i] = 4;
                return maybePromise._proxyPromiseArray(this, i);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }

        this._reducingIndex = i + 1;
        this._accum = ret;
    }

    if (this._reducingIndex < length) return;
    this._resolve(isEach ? preservedValues : this._accum);
};

function reduce(promises, fn, initialValue, _each) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);
    return array.promise();
}

Promise.prototype.reduce = function Promise$reduce(fn, initialValue) {
    return reduce(this, fn, initialValue, null);
};

Promise.reduce = function Promise$Reduce(promises, fn, initialValue, _each) {
    return reduce(promises, fn, initialValue, _each);
};
};

},{"./util.js":68}],88:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
    function(Promise, PromiseArray) {
var PromiseInspection = Promise.PromiseInspection;
var util = require("./util.js");

function SettledPromiseArray(values) {
    this.constructor$(values);
}
util.inherits(SettledPromiseArray, PromiseArray);

SettledPromiseArray.prototype._promiseResolved =
function SettledPromiseArray$_promiseResolved(index, inspection) {
    this._values[index] = inspection;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

SettledPromiseArray.prototype._promiseFulfilled =
function SettledPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 268435456;
    ret._settledValue = value;
    this._promiseResolved(index, ret);
};
SettledPromiseArray.prototype._promiseRejected =
function SettledPromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 134217728;
    ret._settledValue = reason;
    this._promiseResolved(index, ret);
};

Promise.settle = function Promise$Settle(promises) {
    return new SettledPromiseArray(promises).promise();
};

Promise.prototype.settle = function Promise$settle() {
    return new SettledPromiseArray(this).promise();
};
};

},{"./util.js":68}],90:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, apiRejection) {
var util = require("./util.js");
var RangeError = require("./errors.js").RangeError;
var AggregateError = require("./errors.js").AggregateError;
var isArray = util.isArray;


function SomePromiseArray(values) {
    this.constructor$(values);
    this._howMany = 0;
    this._unwrap = false;
    this._initialized = false;
}
util.inherits(SomePromiseArray, PromiseArray);

SomePromiseArray.prototype._init = function SomePromiseArray$_init() {
    if (!this._initialized) {
        return;
    }
    if (this._howMany === 0) {
        this._resolve([]);
        return;
    }
    this._init$(void 0, -5);
    var isArrayResolved = isArray(this._values);
    if (!this._isResolved() &&
        isArrayResolved &&
        this._howMany > this._canPossiblyFulfill()) {
        this._reject(this._getRangeError(this.length()));
    }
};

SomePromiseArray.prototype.init = function SomePromiseArray$init() {
    this._initialized = true;
    this._init();
};

SomePromiseArray.prototype.setUnwrap = function SomePromiseArray$setUnwrap() {
    this._unwrap = true;
};

SomePromiseArray.prototype.howMany = function SomePromiseArray$howMany() {
    return this._howMany;
};

SomePromiseArray.prototype.setHowMany =
function SomePromiseArray$setHowMany(count) {
    if (this._isResolved()) return;
    this._howMany = count;
};

SomePromiseArray.prototype._promiseFulfilled =
function SomePromiseArray$_promiseFulfilled(value) {
    if (this._isResolved()) return;
    this._addFulfilled(value);
    if (this._fulfilled() === this.howMany()) {
        this._values.length = this.howMany();
        if (this.howMany() === 1 && this._unwrap) {
            this._resolve(this._values[0]);
        } else {
            this._resolve(this._values);
        }
    }

};
SomePromiseArray.prototype._promiseRejected =
function SomePromiseArray$_promiseRejected(reason) {
    if (this._isResolved()) return;
    this._addRejected(reason);
    if (this.howMany() > this._canPossiblyFulfill()) {
        var e = new AggregateError();
        for (var i = this.length(); i < this._values.length; ++i) {
            e.push(this._values[i]);
        }
        this._reject(e);
    }
};

SomePromiseArray.prototype._fulfilled = function SomePromiseArray$_fulfilled() {
    return this._totalResolved;
};

SomePromiseArray.prototype._rejected = function SomePromiseArray$_rejected() {
    return this._values.length - this.length();
};

SomePromiseArray.prototype._addRejected =
function SomePromiseArray$_addRejected(reason) {
    this._values.push(reason);
};

SomePromiseArray.prototype._addFulfilled =
function SomePromiseArray$_addFulfilled(value) {
    this._values[this._totalResolved++] = value;
};

SomePromiseArray.prototype._canPossiblyFulfill =
function SomePromiseArray$_canPossiblyFulfill() {
    return this.length() - this._rejected();
};

SomePromiseArray.prototype._getRangeError =
function SomePromiseArray$_getRangeError(count) {
    var message = "Input array must contain at least " +
            this._howMany + " items but contains only " + count + " items";
    return new RangeError(message);
};

SomePromiseArray.prototype._resolveEmptyArray =
function SomePromiseArray$_resolveEmptyArray() {
    this._reject(this._getRangeError(0));
};

function Promise$_Some(promises, howMany) {
    if ((howMany | 0) !== howMany || howMany < 0) {
        return apiRejection("expecting a positive integer");
    }
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(howMany);
    ret.init();
    return promise;
}

Promise.some = function Promise$Some(promises, howMany) {
    return Promise$_Some(promises, howMany);
};

Promise.prototype.some = function Promise$some(howMany) {
    return Promise$_Some(this, howMany);
};

Promise._SomePromiseArray = SomePromiseArray;
};

},{"./util.js":68,"./errors.js":70}],91:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray) {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

Promise.prototype.progressed = function Promise$progressed(handler) {
    return this._then(void 0, void 0, handler, void 0, void 0);
};

Promise.prototype._progress = function Promise$_progress(progressValue) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._progressUnchecked(progressValue);

};

Promise.prototype._progressHandlerAt =
function Promise$_progressHandlerAt(index) {
    return index === 0
        ? this._progressHandler0
        : this[(index << 2) + index - 5 + 2];
};

Promise.prototype._doProgressWith =
function Promise$_doProgressWith(progression) {
    var progressValue = progression.value;
    var handler = progression.handler;
    var promise = progression.promise;
    var receiver = progression.receiver;

    var ret = tryCatch1(handler, receiver, progressValue);
    if (ret === errorObj) {
        if (ret.e != null &&
            ret.e.name !== "StopProgressPropagation") {
            var trace = errors.canAttach(ret.e)
                ? ret.e : new Error(ret.e + "");
            promise._attachExtraTrace(trace);
            promise._progress(ret.e);
        }
    } else if (ret instanceof Promise) {
        ret._then(promise._progress, null, null, promise, void 0);
    } else {
        promise._progress(ret);
    }
};


Promise.prototype._progressUnchecked =
function Promise$_progressUnchecked(progressValue) {
    if (!this.isPending()) return;
    var len = this._length();
    var progress = this._progress;
    for (var i = 0; i < len; i++) {
        var handler = this._progressHandlerAt(i);
        var promise = this._promiseAt(i);
        if (!(promise instanceof Promise)) {
            var receiver = this._receiverAt(i);
            if (typeof handler === "function") {
                handler.call(receiver, progressValue, promise);
            } else if (receiver instanceof Promise && receiver._isProxied()) {
                receiver._progressUnchecked(progressValue);
            } else if (receiver instanceof PromiseArray) {
                receiver._promiseProgressed(progressValue, promise);
            }
            continue;
        }

        if (typeof handler === "function") {
            async.invoke(this._doProgressWith, this, {
                handler: handler,
                promise: promise,
                receiver: this._receiverAt(i),
                value: progressValue
            });
        } else {
            async.invoke(progress, promise, progressValue);
        }
    }
};
};

},{"./util.js":68,"./async.js":69,"./errors.js":70}],92:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var errors = require("./errors.js");
var canAttach = errors.canAttach;
var async = require("./async.js");
var CancellationError = errors.CancellationError;

Promise.prototype._cancel = function Promise$_cancel(reason) {
    if (!this.isCancellable()) return this;
    var parent;
    var promiseToReject = this;
    while ((parent = promiseToReject._cancellationParent) !== void 0 &&
        parent.isCancellable()) {
        promiseToReject = parent;
    }
    promiseToReject._attachExtraTrace(reason);
    promiseToReject._rejectUnchecked(reason);
};

Promise.prototype.cancel = function Promise$cancel(reason) {
    if (!this.isCancellable()) return this;
    reason = reason !== void 0
        ? (canAttach(reason) ? reason : new Error(reason + ""))
        : new CancellationError();
    async.invokeLater(this._cancel, this, reason);
    return this;
};

Promise.prototype.cancellable = function Promise$cancellable() {
    if (this._cancellable()) return this;
    this._setCancellable();
    this._cancellationParent = void 0;
    return this;
};

Promise.prototype.uncancellable = function Promise$uncancellable() {
    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 2 | 4);
    ret._follow(this);
    ret._unsetCancellable();
    return ret;
};

Promise.prototype.fork =
function Promise$fork(didFulfill, didReject, didProgress) {
    var ret = this._then(didFulfill, didReject, didProgress,
                         void 0, void 0);

    ret._setCancellable();
    ret._cancellationParent = void 0;
    return ret;
};
};

},{"./errors.js":70,"./async.js":69}],96:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function (Promise, apiRejection, cast) {
    var TypeError = require("./errors.js").TypeError;
    var inherits = require("./util.js").inherits;
    var PromiseInspection = Promise.PromiseInspection;

    function inspectionMapper(inspections) {
        var len = inspections.length;
        for (var i = 0; i < len; ++i) {
            var inspection = inspections[i];
            if (inspection.isRejected()) {
                return Promise.reject(inspection.error());
            }
            inspections[i] = inspection.value();
        }
        return inspections;
    }

    function thrower(e) {
        setTimeout(function(){throw e;}, 0);
    }

    function dispose(resources, inspection) {
        var i = 0;
        var len = resources.length;
        var ret = Promise.defer();
        function iterator() {
            if (i >= len) return ret.resolve();
            var maybePromise = cast(resources[i++], void 0);
            if (maybePromise instanceof Promise &&
                maybePromise._isDisposable()) {
                try {
                    maybePromise = cast(maybePromise._getDisposer()
                                        .tryDispose(inspection), void 0);
                } catch (e) {
                    return thrower(e);
                }
                if (maybePromise instanceof Promise) {
                    return maybePromise._then(iterator, thrower,
                                              null, null, null);
                }
            }
            iterator();
        }
        iterator();
        return ret.promise;
    }

    function disposerSuccess(value) {
        var inspection = new PromiseInspection();
        inspection._settledValue = value;
        inspection._bitField = 268435456;
        return dispose(this, inspection).thenReturn(value);
    }

    function disposerFail(reason) {
        var inspection = new PromiseInspection();
        inspection._settledValue = reason;
        inspection._bitField = 134217728;
        return dispose(this, inspection).thenThrow(reason);
    }

    function Disposer(data, promise) {
        this._data = data;
        this._promise = promise;
    }

    Disposer.prototype.data = function Disposer$data() {
        return this._data;
    };

    Disposer.prototype.promise = function Disposer$promise() {
        return this._promise;
    };

    Disposer.prototype.resource = function Disposer$resource() {
        if (this.promise().isFulfilled()) {
            return this.promise().value();
        }
        return null;
    };

    Disposer.prototype.tryDispose = function(inspection) {
        var resource = this.resource();
        var ret = resource !== null
            ? this.doDispose(resource, inspection) : null;
        this._promise._unsetDisposable();
        this._data = this._promise = null;
        return ret;
    };

    function FunctionDisposer(fn, promise) {
        this.constructor$(fn, promise);
    }
    inherits(FunctionDisposer, Disposer);

    FunctionDisposer.prototype.doDispose = function (resource, inspection) {
        var fn = this.data();
        return fn.call(resource, resource, inspection);
    };

    Promise.using = function Promise$using() {
        var len = arguments.length;
        if (len < 2) return apiRejection(
                        "you must pass at least 2 arguments to Promise.using");
        var fn = arguments[len - 1];
        if (typeof fn !== "function") return apiRejection("fn must be a function");
        len--;
        var resources = new Array(len);
        for (var i = 0; i < len; ++i) {
            var resource = arguments[i];
            if (resource instanceof Disposer) {
                var disposer = resource;
                resource = resource.promise();
                resource._setDisposable(disposer);
            }
            resources[i] = resource;
        }

        return Promise.settle(resources)
            .then(inspectionMapper)
            .spread(fn)
            ._then(disposerSuccess, disposerFail, void 0, resources, void 0);
    };

    Promise.prototype._setDisposable =
    function Promise$_setDisposable(disposer) {
        this._bitField = this._bitField | 262144;
        this._disposer = disposer;
    };

    Promise.prototype._isDisposable = function Promise$_isDisposable() {
        return (this._bitField & 262144) > 0;
    };

    Promise.prototype._getDisposer = function Promise$_getDisposer() {
        return this._disposer;
    };

    Promise.prototype._unsetDisposable = function Promise$_unsetDisposable() {
        this._bitField = this._bitField & (~262144);
        this._disposer = void 0;
    };

    Promise.prototype.disposer = function Promise$disposer(fn) {
        if (typeof fn === "function") {
            return new FunctionDisposer(fn, this);
        }
        throw new TypeError();
    };

};

},{"./errors.js":70,"./util.js":68}],97:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var TypeError = require('./errors.js').TypeError;

function apiRejection(msg) {
    var error = new TypeError(msg);
    var ret = Promise.rejected(error);
    var parent = ret._peekContext();
    if (parent != null) {
        parent._attachExtraTrace(error);
    }
    return ret;
}

return apiRejection;
};

},{"./errors.js":70}],80:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var _setTimeout = function(fn, ms) {
    var len = arguments.length;
    var arg0 = arguments[2];
    var arg1 = arguments[3];
    var arg2 = len >= 5 ? arguments[4] : void 0;
    setTimeout(function() {
        fn(arg0, arg1, arg2);
    }, ms);
};

module.exports = function(Promise, INTERNAL, cast) {
var util = require("./util.js");
var errors = require("./errors.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var TimeoutError = Promise.TimeoutError;

var afterTimeout = function Promise$_afterTimeout(promise, message, ms) {
    if (!promise.isPending()) return;
    if (typeof message !== "string") {
        message = "operation timed out after" + " " + ms + " ms"
    }
    var err = new TimeoutError(message);
    errors.markAsOriginatingFromRejection(err);
    promise._attachExtraTrace(err);
    promise._cancel(err);
};

var afterDelay = function Promise$_afterDelay(value, promise) {
    promise._fulfill(value);
};

var delay = Promise.delay = function Promise$Delay(value, ms) {
    if (ms === void 0) {
        ms = value;
        value = void 0;
    }
    ms = +ms;
    var maybePromise = cast(value, void 0);
    var promise = new Promise(INTERNAL);

    if (maybePromise instanceof Promise) {
        promise._propagateFrom(maybePromise, 7);
        promise._follow(maybePromise);
        return promise.then(function(value) {
            return Promise.delay(value, ms);
        });
    } else {
        promise._setTrace(void 0);
        _setTimeout(afterDelay, ms, value, promise);
    }
    return promise;
};

Promise.prototype.delay = function Promise$delay(ms) {
    return delay(this, ms);
};

Promise.prototype.timeout = function Promise$timeout(ms, message) {
    ms = +ms;

    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 7);
    ret._follow(this);
    _setTimeout(afterTimeout, ms, ret, message, ms);
    return ret.cancellable();
};

};

},{"./util.js":68,"./errors.js":70,"./errors_api_rejection":97}],86:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, cast) {
var util = require("./util.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var isObject = util.isObject;
var es5 = require("./es5.js");

function PropertiesPromiseArray(obj) {
    var keys = es5.keys(obj);
    var len = keys.length;
    var values = new Array(len * 2);
    for (var i = 0; i < len; ++i) {
        var key = keys[i];
        values[i] = obj[key];
        values[i + len] = key;
    }
    this.constructor$(values);
}
util.inherits(PropertiesPromiseArray, PromiseArray);

PropertiesPromiseArray.prototype._init =
function PropertiesPromiseArray$_init() {
    this._init$(void 0, -3) ;
};

PropertiesPromiseArray.prototype._promiseFulfilled =
function PropertiesPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        var val = {};
        var keyOffset = this.length();
        for (var i = 0, len = this.length(); i < len; ++i) {
            val[this._values[i + keyOffset]] = this._values[i];
        }
        this._resolve(val);
    }
};

PropertiesPromiseArray.prototype._promiseProgressed =
function PropertiesPromiseArray$_promiseProgressed(value, index) {
    if (this._isResolved()) return;

    this._promise._progress({
        key: this._values[index + this.length()],
        value: value
    });
};

PropertiesPromiseArray.prototype.shouldCopyValues =
function PropertiesPromiseArray$_shouldCopyValues() {
    return false;
};

PropertiesPromiseArray.prototype.getActualLength =
function PropertiesPromiseArray$getActualLength(len) {
    return len >> 1;
};

function Promise$_Props(promises) {
    var ret;
    var castValue = cast(promises, void 0);

    if (!isObject(castValue)) {
        return apiRejection("cannot await properties of a non-object");
    } else if (castValue instanceof Promise) {
        ret = castValue._then(Promise.props, void 0, void 0, void 0, void 0);
    } else {
        ret = new PropertiesPromiseArray(castValue).promise();
    }

    if (castValue instanceof Promise) {
        ret._propagateFrom(castValue, 4);
    }
    return ret;
}

Promise.prototype.props = function Promise$props() {
    return Promise$_Props(this);
};

Promise.props = function Promise$Props(promises) {
    return Promise$_Props(promises);
};
};

},{"./util.js":68,"./es5.js":98,"./errors_api_rejection":97}],89:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var THIS = {};
var util = require("./util.js");
var nodebackForPromise = require("./promise_resolver.js")
    ._nodebackForPromise;
var withAppended = util.withAppended;
var maybeWrapAsError = util.maybeWrapAsError;
var canEvaluate = util.canEvaluate;
var TypeError = require("./errors").TypeError;
var defaultSuffix = "Async";
var defaultFilter = function(name, func) {
    return util.isIdentifier(name) &&
        name.charAt(0) !== "_" &&
        !util.isClass(func);
};
var defaultPromisified = {__isPromisified__: true};


function escapeIdentRegex(str) {
    return str.replace(/([$])/, "\\$");
}

function isPromisified(fn) {
    try {
        return fn.__isPromisified__ === true;
    }
    catch (e) {
        return false;
    }
}

function hasPromisified(obj, key, suffix) {
    var val = util.getDataPropertyOrDefault(obj, key + suffix,
                                            defaultPromisified);
    return val ? isPromisified(val) : false;
}
function checkValid(ret, suffix, suffixRegexp) {
    for (var i = 0; i < ret.length; i += 2) {
        var key = ret[i];
        if (suffixRegexp.test(key)) {
            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, "");
            for (var j = 0; j < ret.length; j += 2) {
                if (ret[j] === keyWithoutAsyncSuffix) {
                    throw new TypeError("Cannot promisify an API " +
                        "that has normal methods with '"+suffix+"'-suffix");
                }
            }
        }
    }
}

function promisifiableMethods(obj, suffix, suffixRegexp, filter) {
    var keys = util.inheritedDataKeys(obj);
    var ret = [];
    for (var i = 0; i < keys.length; ++i) {
        var key = keys[i];
        var value = obj[key];
        if (typeof value === "function" &&
            !isPromisified(value) &&
            !hasPromisified(obj, key, suffix) &&
            filter(key, value, obj)) {
            ret.push(key, value);
        }
    }
    checkValid(ret, suffix, suffixRegexp);
    return ret;
}

function switchCaseArgumentOrder(likelyArgumentCount) {
    var ret = [likelyArgumentCount];
    var min = Math.max(0, likelyArgumentCount - 1 - 5);
    for(var i = likelyArgumentCount - 1; i >= min; --i) {
        if (i === likelyArgumentCount) continue;
        ret.push(i);
    }
    for(var i = likelyArgumentCount + 1; i <= 5; ++i) {
        ret.push(i);
    }
    return ret;
}

function argumentSequence(argumentCount) {
    return util.filledRange(argumentCount, "arguments[", "]");
}

function parameterDeclaration(parameterCount) {
    return util.filledRange(parameterCount, "_arg", "");
}

function parameterCount(fn) {
    if (typeof fn.length === "number") {
        return Math.max(Math.min(fn.length, 1023 + 1), 0);
    }
    return 0;
}

function generatePropertyAccess(key) {
    if (util.isIdentifier(key)) {
        return "." + key;
    }
    else return "['" + key.replace(/(['\\])/g, "\\$1") + "']";
}

function makeNodePromisifiedEval(callback, receiver, originalName, fn, suffix) {
    var newParameterCount = Math.max(0, parameterCount(fn) - 1);
    var argumentOrder = switchCaseArgumentOrder(newParameterCount);
    var callbackName =
        (typeof originalName === "string" && util.isIdentifier(originalName)
            ? originalName + suffix
            : "promisified");

    function generateCallForArgumentCount(count) {
        var args = argumentSequence(count).join(", ");
        var comma = count > 0 ? ", " : "";
        var ret;
        if (typeof callback === "string") {
            ret = "                                                          \n\
                this.method(args, fn);                                       \n\
                break;                                                       \n\
            ".replace(".method", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            ret =  "                                                         \n\
                callback.call(this, args, fn);                               \n\
                break;                                                       \n\
            ";
        } else if (receiver !== void 0) {
            ret =  "                                                         \n\
                callback.call(receiver, args, fn);                           \n\
                break;                                                       \n\
            ";
        } else {
            ret =  "                                                         \n\
                callback(args, fn);                                          \n\
                break;                                                       \n\
            ";
        }
        return ret.replace("args", args).replace(", ", comma);
    }

    function generateArgumentSwitchCase() {
        var ret = "";
        for(var i = 0; i < argumentOrder.length; ++i) {
            ret += "case " + argumentOrder[i] +":" +
                generateCallForArgumentCount(argumentOrder[i]);
        }
        var codeForCall;
        if (typeof callback === "string") {
            codeForCall = "                                                  \n\
                this.property.apply(this, args);                             \n\
            "
                .replace(".property", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            codeForCall = "                                                  \n\
                callback.apply(this, args);                                  \n\
            ";
        } else {
            codeForCall = "                                                  \n\
                callback.apply(receiver, args);                              \n\
            ";
        }

        ret += "                                                             \n\
        default:                                                             \n\
            var args = new Array(len + 1);                                   \n\
            var i = 0;                                                       \n\
            for (var i = 0; i < len; ++i) {                                  \n\
               args[i] = arguments[i];                                       \n\
            }                                                                \n\
            args[i] = fn;                                                    \n\
            [CodeForCall]                                                    \n\
            break;                                                           \n\
        ".replace("[CodeForCall]", codeForCall);
        return ret;
    }

    return new Function("Promise",
                        "callback",
                        "receiver",
                        "withAppended",
                        "maybeWrapAsError",
                        "nodebackForPromise",
                        "INTERNAL","                                         \n\
        var ret = function FunctionName(Parameters) {                        \n\
            'use strict';                                                    \n\
            var len = arguments.length;                                      \n\
            var promise = new Promise(INTERNAL);                             \n\
            promise._setTrace(void 0);                                       \n\
            var fn = nodebackForPromise(promise);                            \n\
            try {                                                            \n\
                switch(len) {                                                \n\
                    [CodeForSwitchCase]                                      \n\
                }                                                            \n\
            } catch (e) {                                                    \n\
                var wrapped = maybeWrapAsError(e);                           \n\
                promise._attachExtraTrace(wrapped);                          \n\
                promise._reject(wrapped);                                    \n\
            }                                                                \n\
            return promise;                                                  \n\
        };                                                                   \n\
        ret.__isPromisified__ = true;                                        \n\
        return ret;                                                          \n\
        "
        .replace("FunctionName", callbackName)
        .replace("Parameters", parameterDeclaration(newParameterCount))
        .replace("[CodeForSwitchCase]", generateArgumentSwitchCase()))(
            Promise,
            callback,
            receiver,
            withAppended,
            maybeWrapAsError,
            nodebackForPromise,
            INTERNAL
        );
}

function makeNodePromisifiedClosure(callback, receiver) {
    function promisified() {
        var _receiver = receiver;
        if (receiver === THIS) _receiver = this;
        if (typeof callback === "string") {
            callback = _receiver[callback];
        }
        var promise = new Promise(INTERNAL);
        promise._setTrace(void 0);
        var fn = nodebackForPromise(promise);
        try {
            callback.apply(_receiver, withAppended(arguments, fn));
        } catch(e) {
            var wrapped = maybeWrapAsError(e);
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        }
        return promise;
    }
    promisified.__isPromisified__ = true;
    return promisified;
}

var makeNodePromisified = canEvaluate
    ? makeNodePromisifiedEval
    : makeNodePromisifiedClosure;

function promisifyAll(obj, suffix, filter, promisifier) {
    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + "$");
    var methods =
        promisifiableMethods(obj, suffix, suffixRegexp, filter);

    for (var i = 0, len = methods.length; i < len; i+= 2) {
        var key = methods[i];
        var fn = methods[i+1];
        var promisifiedKey = key + suffix;
        obj[promisifiedKey] = promisifier === makeNodePromisified
                ? makeNodePromisified(key, THIS, key, fn, suffix)
                : promisifier(fn);
    }
    util.toFastProperties(obj);
    return obj;
}

function promisify(callback, receiver) {
    return makeNodePromisified(callback, receiver, void 0, callback);
}

Promise.promisify = function Promise$Promisify(fn, receiver) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    if (isPromisified(fn)) {
        return fn;
    }
    return promisify(fn, arguments.length < 2 ? THIS : receiver);
};

Promise.promisifyAll = function Promise$PromisifyAll(target, options) {
    if (typeof target !== "function" && typeof target !== "object") {
        throw new TypeError("the target of promisifyAll must be an object or a function");
    }
    options = Object(options);
    var suffix = options.suffix;
    if (typeof suffix !== "string") suffix = defaultSuffix;
    var filter = options.filter;
    if (typeof filter !== "function") filter = defaultFilter;
    var promisifier = options.promisifier;
    if (typeof promisifier !== "function") promisifier = makeNodePromisified;

    if (!util.isIdentifier(suffix)) {
        throw new RangeError("suffix must be a valid identifier");
    }

    var keys = util.inheritedDataKeys(target, {includeHidden: true});
    for (var i = 0; i < keys.length; ++i) {
        var value = target[keys[i]];
        if (keys[i] !== "constructor" &&
            util.isClass(value)) {
            promisifyAll(value.prototype, suffix, filter, promisifier);
            promisifyAll(value, suffix, filter, promisifier);
        }
    }

    return promisifyAll(target, suffix, filter, promisifier);
};
};


},{"./util.js":68,"./promise_resolver.js":75,"./errors":70}],98:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
var isES5 = (function(){
    "use strict";
    return this === void 0;
})();

if (isES5) {
    module.exports = {
        freeze: Object.freeze,
        defineProperty: Object.defineProperty,
        keys: Object.keys,
        getPrototypeOf: Object.getPrototypeOf,
        isArray: Array.isArray,
        isES5: isES5
    };
} else {
    var has = {}.hasOwnProperty;
    var str = {}.toString;
    var proto = {}.constructor.prototype;

    var ObjectKeys = function ObjectKeys(o) {
        var ret = [];
        for (var key in o) {
            if (has.call(o, key)) {
                ret.push(key);
            }
        }
        return ret;
    }

    var ObjectDefineProperty = function ObjectDefineProperty(o, key, desc) {
        o[key] = desc.value;
        return o;
    }

    var ObjectFreeze = function ObjectFreeze(obj) {
        return obj;
    }

    var ObjectGetPrototypeOf = function ObjectGetPrototypeOf(obj) {
        try {
            return Object(obj).constructor.prototype;
        }
        catch (e) {
            return proto;
        }
    }

    var ArrayIsArray = function ArrayIsArray(obj) {
        try {
            return str.call(obj) === "[object Array]";
        }
        catch(e) {
            return false;
        }
    }

    module.exports = {
        isArray: ArrayIsArray,
        keys: ObjectKeys,
        defineProperty: ObjectDefineProperty,
        freeze: ObjectFreeze,
        getPrototypeOf: ObjectGetPrototypeOf,
        isES5: isES5
    };
}

},{}],99:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule;
var _MutationObserver;
if (typeof process === "object" && typeof process.version === "string") {
    schedule = function Promise$_Scheduler(fn) {
        process.nextTick(fn);
    };
}
else if ((typeof MutationObserver !== "undefined" &&
         (_MutationObserver = MutationObserver)) ||
         (typeof WebKitMutationObserver !== "undefined" &&
         (_MutationObserver = WebKitMutationObserver))) {
    schedule = (function() {
        var div = document.createElement("div");
        var queuedFn = void 0;
        var observer = new _MutationObserver(
            function Promise$_Scheduler() {
                var fn = queuedFn;
                queuedFn = void 0;
                fn();
            }
       );
        observer.observe(div, {
            attributes: true
        });
        return function Promise$_Scheduler(fn) {
            queuedFn = fn;
            div.setAttribute("class", "foo");
        };

    })();
}
else if (typeof setTimeout !== "undefined") {
    schedule = function Promise$_Scheduler(fn) {
        setTimeout(fn, 0);
    };
}
else throw new Error("no async scheduler available");
module.exports = schedule;

})(require("__browserify_process"))
},{"__browserify_process":67}],100:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
function arrayCopy(src, srcIndex, dst, dstIndex, len) {
    for (var j = 0; j < len; ++j) {
        dst[j + dstIndex] = src[j + srcIndex];
    }
}

function Queue(capacity) {
    this._capacity = capacity;
    this._length = 0;
    this._front = 0;
    this._makeCapacity();
}

Queue.prototype._willBeOverCapacity =
function Queue$_willBeOverCapacity(size) {
    return this._capacity < size;
};

Queue.prototype._pushOne = function Queue$_pushOne(arg) {
    var length = this.length();
    this._checkCapacity(length + 1);
    var i = (this._front + length) & (this._capacity - 1);
    this[i] = arg;
    this._length = length + 1;
};

Queue.prototype.push = function Queue$push(fn, receiver, arg) {
    var length = this.length() + 3;
    if (this._willBeOverCapacity(length)) {
        this._pushOne(fn);
        this._pushOne(receiver);
        this._pushOne(arg);
        return;
    }
    var j = this._front + length - 3;
    this._checkCapacity(length);
    var wrapMask = this._capacity - 1;
    this[(j + 0) & wrapMask] = fn;
    this[(j + 1) & wrapMask] = receiver;
    this[(j + 2) & wrapMask] = arg;
    this._length = length;
};

Queue.prototype.shift = function Queue$shift() {
    var front = this._front,
        ret = this[front];

    this[front] = void 0;
    this._front = (front + 1) & (this._capacity - 1);
    this._length--;
    return ret;
};

Queue.prototype.length = function Queue$length() {
    return this._length;
};

Queue.prototype._makeCapacity = function Queue$_makeCapacity() {
    var len = this._capacity;
    for (var i = 0; i < len; ++i) {
        this[i] = void 0;
    }
};

Queue.prototype._checkCapacity = function Queue$_checkCapacity(size) {
    if (this._capacity < size) {
        this._resizeTo(this._capacity << 3);
    }
};

Queue.prototype._resizeTo = function Queue$_resizeTo(capacity) {
    var oldFront = this._front;
    var oldCapacity = this._capacity;
    var oldQueue = new Array(oldCapacity);
    var length = this.length();

    arrayCopy(this, 0, oldQueue, 0, oldCapacity);
    this._capacity = capacity;
    this._makeCapacity();
    this._front = 0;
    if (oldFront + length <= oldCapacity) {
        arrayCopy(oldQueue, oldFront, this, 0, length);
    } else {        var lengthBeforeWrapping =
            length - ((oldFront + length) & (oldCapacity - 1));

        arrayCopy(oldQueue, oldFront, this, 0, lengthBeforeWrapping);
        arrayCopy(oldQueue, 0, this, lengthBeforeWrapping,
                    length - lengthBeforeWrapping);
    }
};

module.exports = Queue;

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9pbmRleC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ub2RlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3dlYi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ydW50aW1lL2luZGV4LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2Jyb3dzZXJpZnkyLWxpc3QuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvbWV0aG9kLXNwZWMuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdXRpbC9jb21wb25lbnQtbG9hZGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvcGVyaW9kaWMuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdXRpbC90aW1lci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC91dGlsL3JldHJ5YWJsZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2Rpc3BhdGNoZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9vcHRpb25zLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvY291bnRkb3duLWxhdGNoLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvbGFuZy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3N0YXRlLWd1YXJkLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcHViLXN1Yi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb2xsZWN0aW9uL2RvdWJseS1saW5rZWQtbGlzdC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb2xsZWN0aW9uL29iamVjdC1oYXNoLW1hcC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb2xsZWN0aW9uL2RlZmF1bHRpbmctaGFzaC1tYXAuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29sbGVjdGlvbi9tdWx0aS1tYXAuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29sbGVjdGlvbi9scnUtaGFzaC1tYXAuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc3RvcmFnZS9jYWNoaW5nLWRhdGEtc3RvcmUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc3RvcmFnZS9pbi1tZW1vcnktZGF0YS1zdG9yZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2xydS1kYXRhLXN0b3JlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3N0b3JhZ2Uvc2lnbmFsaW5nLWRhdGEtc3RvcmUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWMuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2FwcC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZXhjaGFuZ2UuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvbWVzc2FnaW5nL2NvdXJpZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS91dWlkLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvY29tcG9uZW50LXJlZ2lzdHJ5LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3NjaGVkdWxlci9pbmRleC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy91bmRlcnNjb3JlL3VuZGVyc2NvcmUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvbW9yaS9tb3JpLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWNvbXBvc2l0ZS1zZXF1ZW5jZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC90aW1lL2Nsb2NrL2xvZ2ljYWwtY2xvY2suanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdGltZS9jbG9jay9zeXN0ZW0tY2xvY2suanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2NvbmZpZy9zY29wZWQtY29uZmlndXJhdGlvbi1yZXNvbHZlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvbG9nZ2luZy9sb2dnZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9jaGFubmVsL2NoYW5uZWwuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2NoYW5uZWwvY29tcG9zaXRlLWNoYW5uZWwuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvbWVzc2FnaW5nL2ZpYmVyL2luLW1lbW9yeS1maWJlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZmliZXIvbGlua2FibGUtZmliZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXJkZS9qc29uLXNlcmRlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3BsYXRmb3JtL2NsaWVudC1idWlsZGVyL2NsaWVudC1idWlsZGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3BsYXRmb3JtL2NsaWVudC1idWlsZGVyL2NsaWVudC1zcGVjLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcmVmL2luZGV4LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vYmx1ZWJpcmQuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvYm9vdHN0cmFwcGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3NjaGVkdWxlci93ZWItc2NoZWR1bGVyLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2FwcGtpdC93ZWItYXBwLWNvbnRhaW5lci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9ydW50aW1lL2RlZmF1bHQtcnVudGltZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2ludGVybmFscy9leHBpcmluZy1lbnRyeS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvaW50ZXJuYWwvcHJvY2Vzcy1rZWVwLWFsaXZlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L21lc3NhZ2luZy9pbnRlcm5hbHMvbWFpbGJveC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlci9iYXNlLWNsaWVudC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5Mi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNlLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvcmVmL3JlZi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3JlZi9kZWxlZ2F0aW5nLXJlZi5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3N5bmNocm9ub3VzX2luc3BlY3Rpb24uanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9maWx0ZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9hbnkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9lYWNoLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2NoZWR1bGVyL3NldC10aW1lb3V0LXNjaGVkdWxlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3V0aWwuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9hc3luYy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2Vycm9ycy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3RoZW5hYmxlcy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3Byb21pc2VfYXJyYXkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9jYXB0dXJlZF90cmFjZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhdGNoX2ZpbHRlci5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3Byb21pc2VfcmVzb2x2ZXIuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9maW5hbGx5LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZGlyZWN0X3Jlc29sdmUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9qb2luLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcmFjZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhbGxfZ2V0LmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZ2VuZXJhdG9ycy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL21hcC5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL25vZGVpZnkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9yZWR1Y2UuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9zZXR0bGUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9zb21lLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvZ3Jlc3MuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9jYW5jZWwuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi91c2luZy5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2Vycm9yc19hcGlfcmVqZWN0aW9uLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vdGltZXJzLmpzIiwiL2hvbWUvdWJ1bnR1L3NyYy9saWJzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvcHMuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNpZnkuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9lczUuanMiLCIvaG9tZS91YnVudHUvc3JjL2xpYnMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9zY2hlZHVsZS5qcyIsIi9ob21lL3VidW50dS9zcmMvbGlicy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3F1ZXVlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1UEE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2UUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDclRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2haQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdFQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoMENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaktBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBDb21wb25lbnRSZWdpc3RyeSxcbiAgd2ViQWxpYXNlcyxcbiAgbm9kZUFsaWFzZXNcbikge1xuICB2YXIgYyA9IG5ldyBDb21wb25lbnRSZWdpc3RyeSgpO1xuXG5cbiAgYy5yZWdpc3Rlck1hbnkoW1xuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vdXRpbC9jb21wb25lbnQtbG9hZGVyXCIpLFxuICAgICAgYXM6IFwiY29tcG9uZW50LWxvYWRlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vdXRpbC9wZXJpb2RpY1wiKSxcbiAgICAgIGFzOiBcInBlcmlvZGljXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi91dGlsL3JldHJ5YWJsZVwiKSxcbiAgICAgIGFzOiBcInJldHJ5YWJsZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vdXRpbC90aW1lclwiKSxcbiAgICAgIGFzOiBcInRpbWVyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL2Rpc3BhdGNoZXJcIiksXG4gICAgICBhczogXCJkaXNwYXRjaGVyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL2NvdW50ZG93bi1sYXRjaFwiKSxcbiAgICAgIGFzOiBcImNvdW50ZG93bi1sYXRjaFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9vcHRpb25zXCIpLFxuICAgICAgYXM6IFwib3B0aW9uc1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sYW5nXCIpLFxuICAgICAgYXM6IFwibGFuZ1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9yZWZcIiksXG4gICAgICBhczogXCJyZWZcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gICAgICBhczogXCJzdGF0ZS1ndWFyZFwiXG4gICAgfSxcblxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3B1Yi1zdWJcIiksXG4gICAgICBhczogXCJwdWItc3ViXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlclwiKSxcbiAgICAgIGFzOiBbXCJ1bml0LXNlcXVlbmNlclwiLCBcInNlcXVlbmNlclwiXVxuICAgIH0sXG5cblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvY2xvY2stc2VxdWVuY2VyXCIpLFxuICAgICAgYXM6IFwiY2xvY2stc2VxdWVuY2VyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWNvbXBvc2l0ZS1zZXF1ZW5jZXJcIiksXG4gICAgICBhczogXCJkZWxlZ2F0aW5nLWNvbXBvc2l0ZS1zZXF1ZW5jZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctZm9yd2FyZGluZy1zZXF1ZW5jZXJcIiksXG4gICAgICBhczogXCJkZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb2xsZWN0aW9uL2RvdWJseS1saW5rZWQtbGlzdFwiKSxcbiAgICAgIGFzOiBcImRvdWJseS1saW5rZWQtbGlzdFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29sbGVjdGlvbi9vYmplY3QtaGFzaC1tYXBcIiksXG4gICAgICBhczogW1wiaGFzaC1tYXBcIiwgXCJvYmplY3QtaGFzaC1tYXBcIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb2xsZWN0aW9uL2RlZmF1bHRpbmctaGFzaC1tYXBcIiksXG4gICAgICBhczogXCJkZWZhdWx0aW5nLWhhc2gtbWFwXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb2xsZWN0aW9uL211bHRpLW1hcFwiKSxcbiAgICAgIGFzOiBcIm11bHRpLW1hcFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29sbGVjdGlvbi9scnUtaGFzaC1tYXBcIiksXG4gICAgICBhczogXCJscnUtaGFzaC1tYXBcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2UvY2FjaGluZy1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwiY2FjaGluZy1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9zdG9yYWdlL2luLW1lbW9yeS1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwiaW4tbWVtb3J5LWRhdGEtc3RvcmVcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2UvbHJ1LWRhdGEtc3RvcmVcIiksXG4gICAgICBhczogXCJscnUtZGF0YS1zdG9yZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZVwiKSxcbiAgICAgIGFzOiBcInNpZ25hbGluZy1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi90aW1lL2Nsb2NrL2xvZ2ljYWwtY2xvY2tcIiksXG4gICAgICBhczogXCJsb2dpY2FsLWNsb2NrXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi90aW1lL2Nsb2NrL3N5c3RlbS1jbG9ja1wiKSxcbiAgICAgIGFzOiBcInN5c3RlbS1jbG9ja1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWNcIiksXG4gICAgICBhczogXCJjb25maWd1cmF0aW9uLW1hZ2ljXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyXCIpLFxuICAgICAgYXM6IFwic2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb25cIiksXG4gICAgICBhczogW1wic2NvcGVkLWNvbmZpZ3VyYXRpb25cIiwgXCJjb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb25cIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvYXBwXCIpLFxuICAgICAgYXM6IFwiYXBwXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9ydW50aW1lXCIpLFxuICAgICAgYXM6IFwicnVudGltZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgICAgIGFzOiBcImxvZ2dlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlclwiKSxcbiAgICAgIGFzOiBbXCJhcHBlbmRlcnMvY29uc29sZS1sb2dcIiwgXCJjb25zb2xlLWxvZy1hcHBlbmRlclwiXVxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICAgICAgYXM6IFwiY2hhbm5lbFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgICAgIGFzOiBcImNoYWluZWQtY2hhbm5lbFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsXCIpLFxuICAgICAgYXM6IFwiY29tcG9zaXRlLWNoYW5uZWxcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL21lc3NhZ2luZy9leGNoYW5nZVwiKSxcbiAgICAgIGFzOiBcIm1lc3NhZ2luZy9leGNoYW5nZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2NvdXJpZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvY291cmllclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2ZpYmVyL2luLW1lbW9yeS1maWJlclwiKSxcbiAgICAgIGFzOiBcIm1lc3NhZ2luZy9maWJlcnMvaW4tbWVtb3J5XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9tZXNzYWdpbmcvZmliZXIvbGlua2FibGUtZmliZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvZmliZXJzL2xpbmthYmxlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3V1aWRcIiksXG4gICAgICBhczogXCJ1dWlkXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcmRlL2pzb24tc2VyZGVcIiksXG4gICAgICBhczogW1wic2VyZGUvanNvblwiLCBcImpzb24tc2VyZGVcIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlci9jbGllbnQtYnVpbGRlclwiKSxcbiAgICAgIGFzOiBcImV4cGVyaW1lbnRhbC9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvY2xpZW50LXNwZWNcIiksXG4gICAgICBhczogXCJleHBlcmltZW50YWwvcGxhdGZvcm0vY2xpZW50LXNwZWNcIlxuICAgIH1cbiAgXSk7XG5cbiAgYy5zZWxmUmVnaXN0ZXIoe1xuICAgIGFzOiBcImNvbXBvbmVudC1yZWdpc3RyeVwiXG4gIH0pO1xuXG4gIHdlYkFsaWFzZXMoYyk7XG4gIG5vZGVBbGlhc2VzKGMpO1xuXG4gIHJldHVybiBjO1xufTtcblxudmFyIGcgPSAodHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IHt9IDogd2luZG93KTtcbmcudGhpY2tldCA9IG1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1yZWdpc3RyeVwiKSxcbiAgcmVxdWlyZShcIi4vd2ViXCIpLFxuICByZXF1aXJlKFwiLi9ub2RlXCIpXG4pO1xuXG59KSgpIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjKSB7fTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYykge1xuICBjLnJlZ2lzdGVyTWFueShbXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvYm9vdHN0cmFwcGVyXCIpLFxuICAgICAgYXM6IFwiYm9vdHN0cmFwcGVyXCJcbiAgICB9LFxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L3dlYi1hcHAtY29udGFpbmVyXCIpLFxuICAgICAgYXM6IFwiYXBwLWNvbnRhaW5lclwiXG4gICAgfSxcbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3NjaGVkdWxlci93ZWItc2NoZWR1bGVyXCIpLFxuICAgICAgYXM6IFwic2NoZWR1bGVyXCJcbiAgICB9XG4gIF0pO1xuXG4gIHJlcXVpcmUoXCIuL2Jyb3dzZXJpZnkyLWxpc3RcIik7XG59O1xuIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuL2RlZmF1bHQtcnVudGltZVwiKTtcblxufSkoKSIsIihmdW5jdGlvbigpe3JlcXVpcmUoXCIuL3J1bnRpbWUvZGVmYXVsdC1ydW50aW1lLmpzXCIpO1xucmVxdWlyZShcIi4vcnVudGltZS9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL25vZGUuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NlcmRlL2pzb24tc2VyZGUuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3V1aWQuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvb3B0aW9ucy5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvcHViLXN1Yi5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvZGlzcGF0Y2hlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvcmVmL2RlbGVnYXRpbmctcmVmLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9yZWYvcmVmLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9yZWYvaW5kZXguanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvY2xvY2stc2VxdWVuY2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWNvbXBvc2l0ZS1zZXF1ZW5jZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3N0YXRlLWd1YXJkLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9zY2hlZHVsZXIvc2V0LXRpbWVvdXQtc2NoZWR1bGVyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9jb3VudGRvd24tbGF0Y2guanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2xhbmcuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY2hhaW5lZC1jaGFubmVsLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NoYW5uZWwuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY29tcG9zaXRlLWNoYW5uZWwuanNcIik7XG5yZXF1aXJlKFwiLi93ZWIuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL3NpZ25hbGluZy1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9scnUtZGF0YS1zdG9yZS5qc1wiKTtcbnJlcXVpcmUoXCIuL3N0b3JhZ2UvaW4tbWVtb3J5LWRhdGEtc3RvcmUuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL2ludGVybmFscy9leHBpcmluZy1lbnRyeS5qc1wiKTtcbnJlcXVpcmUoXCIuL3N0b3JhZ2UvY2FjaGluZy1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvYmFzZS1jbGllbnQuanNcIik7XG5yZXF1aXJlKFwiLi9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlci9jbGllbnQtYnVpbGRlci5qc1wiKTtcbnJlcXVpcmUoXCIuL3BsYXRmb3JtL2NsaWVudC1idWlsZGVyL2NsaWVudC1zcGVjLmpzXCIpO1xucmVxdWlyZShcIi4vcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvbWV0aG9kLXNwZWMuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1sb2FkZXIuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1yZWdpc3RyeS5qc1wiKTtcbnJlcXVpcmUoXCIuL3V0aWwvdGltZXIuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL3JldHJ5YWJsZS5qc1wiKTtcbnJlcXVpcmUoXCIuL3V0aWwvcGVyaW9kaWMuanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvaW50ZXJuYWxzL21haWxib3guanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvY291cmllci5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9maWJlci9saW5rYWJsZS1maWJlci5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9maWJlci9pbi1tZW1vcnktZmliZXIuanNcIik7XG5yZXF1aXJlKFwiLi9tZXNzYWdpbmcvZXhjaGFuZ2UuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvYXBwLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2ludGVybmFsL3Byb2Nlc3Mta2VlcC1hbGl2ZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXIuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L3dlYi1hcHAtY29udGFpbmVyLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWMuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvYm9vdHN0cmFwcGVyLmpzXCIpO1xucmVxdWlyZShcIi4vc2NoZWR1bGVyL3dlYi1zY2hlZHVsZXIuanNcIik7XG5yZXF1aXJlKFwiLi9zY2hlZHVsZXIvaW5kZXguanNcIik7XG5yZXF1aXJlKFwiLi9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svbG9naWNhbC1jbG9jay5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svc3lzdGVtLWNsb2NrLmpzXCIpO1xucmVxdWlyZShcIi4vY29sbGVjdGlvbi9scnUtaGFzaC1tYXAuanNcIik7XG5yZXF1aXJlKFwiLi9jb2xsZWN0aW9uL2RlZmF1bHRpbmctaGFzaC1tYXAuanNcIik7XG5yZXF1aXJlKFwiLi9jb2xsZWN0aW9uL29iamVjdC1oYXNoLW1hcC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vbXVsdGktbWFwLmpzXCIpO1xucmVxdWlyZShcIi4vY29sbGVjdGlvbi9kb3VibHktbGlua2VkLWxpc3QuanNcIik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgTGFuZ1xuKSB7XG5cbiAgdmFyIE1ldGhvZFNwZWMgPSBMYW5nLnBvam9DbGFzcyhbXCJhcmdzXCIsIFwiZGVmYXVsdHNcIiwgXCJtVHlwZVwiLCBcInJlcXVlc3RSZXBseVwiXSwge1xuICAgIGRlZmF1bHRzOiB7XG4gICAgICBhcmdzOiAgICAgICAgIFtdLFxuICAgICAgZGVmYXVsdHM6ICAgICB7fSxcbiAgICAgIHJlcXVlc3RSZXBseTogdHJ1ZVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIE1ldGhvZFNwZWM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvbGFuZ1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGZhY3RvcnkgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIExpa2UgYSBgQ29tcG9uZW50UmVnaXN0cnlgLCBidXQgbW9kdWxlcyBhcmUgbG9hZGVkIG9uLWRlbWFuZCByYXRoZXIgdGhhbiBlYWdlcmx5IHJlcXVpcmVkIGFuZCBhbGlhc2VkLiBUaGlzIGlzXG4gICAqIGRvbmUgYnkgcHJvdmlkaW5nIHRoZSB0b3AtbGV2ZWwgYHJlcXVpcmVgIG1ldGhvZCBhcyBhbiBpbml0aWFsaXphdGlvbiBwYXJhbWV0ZXIsIHdoaWNoIG1haW50YWlucyB0aGUgYXBwcm9wcmlhdGVcbiAgICogcGF0aCBjb250ZXh0IGZvciByZXNvbHZpbmcgcmVsYXRpdmUgaW1wb3J0cyBsYXRlci5cbiAgICpcbiAgICogTm90ZSB0aGlzIG9ubHkgd29ya3MgaW4gTm9kZSwgbm90IGVudmlyb25tZW50cyBsaWtlIEJyb3dzZXJpZnksIHdoaWNoIG5lZWQgdG8gZWFnZXJseSByZXNvbHZlIGFsbCByZXF1aXJlZFxuICAgKiBtb2R1bGVzIHZpYSBzdGF0aWMgYW5hbHlzaXMuIEZvciB0aGF0LCB1c2UgdGhlIGBDb21wb25lbnRSZWdpc3RyeWAuXG4gICAqL1xuICB2YXIgQ29tcG9uZW50TG9hZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29tcG9uZW50TG9hZGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHJlcXVpcmVGdW4pIHtcbiAgICAgIHRoaXMuX3JlcXVpcmVGdW4gPSByZXF1aXJlRnVuO1xuICAgICAgdGhpcy5fYWxpYXNlcyA9IHt9O1xuICAgICAgdGhpcy5fcGF0aFRyYW5zZm9ybSA9IGZ1bmN0aW9uKGlkKSB7IHJldHVybiBpZDt9O1xuICAgIH0sXG5cbiAgICBzZXRQYXRoVHJhbnNmb3JtOiBmdW5jdGlvbihwYXRoVHJhbnNmb3JtKSB7XG4gICAgICB0aGlzLl9wYXRoVHJhbnNmb3JtID0gcGF0aFRyYW5zZm9ybTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBhbGlhczogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHZhciBhbGlhc05hbWUgID0gb3B0cy5nZXRPckVycm9yKFwiYXNcIik7XG4gICAgICB0aGlzLl9hbGlhc2VzW2FsaWFzTmFtZV0gPSBvcHRzLmdldE9yRXJyb3IoXCJtb2R1bGVcIik7XG4gICAgfSxcblxuICAgIGJ1bGtBbGlhczogZnVuY3Rpb24oYWxpYXNlcykge1xuICAgICAgXy5lYWNoKGFsaWFzZXMsIGZ1bmN0aW9uKGFsaWFzTmFtZXMsIG1vZHVsZU5hbWUpIHtcbiAgICAgICAgaWYgKCFfLmlzQXJyYXkoYWxpYXNOYW1lcykpIHtcbiAgICAgICAgICBhbGlhc05hbWVzID0gW2FsaWFzTmFtZXNdXG4gICAgICAgIH1cbiAgICAgICAgXy5lYWNoKGFsaWFzTmFtZXMsIGZ1bmN0aW9uKGFsaWFzTmFtZSkge1xuICAgICAgICAgIHRoaXMuYWxpYXMoe21vZHVsZTogbW9kdWxlTmFtZSwgYXM6IGFsaWFzTmFtZX0pO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBjb21wb25lbnQ6IGZ1bmN0aW9uKGFsaWFzKSB7XG4gICAgICB2YXIgbW9kID0gdGhpcy5fYWxpYXNlc1thbGlhc107XG4gICAgICBpZiAoIW1vZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGFsaWFzIHByb3ZpZGVkIChubyBzdWNoIG1vZHVsZSk6IGBcIithbGlhcytcIidcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fcmVxdWlyZUZ1bih0aGlzLl9wYXRoVHJhbnNmb3JtKG1vZCkpO1xuICAgIH0sXG5cbiAgICBjOiBmdW5jdGlvbihhbGlhcykge1xuICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29tcG9uZW50TG9hZGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBTdGF0ZUd1YXJkLFxuICBDaGFubmVsLFxuICBDaGFpbmVkQ2hhbm5lbCxcbiAgTG9nZ2VyXG4pIHtcblxuICAvKipcbiAgICogVXBvbiBgc3RhcnQoKWAsIHJ1bnMgdGhlIHByb3ZpZGVkIFByb21pc2lmaWVkIGB0YXNrYCBldmVyeSBgaW50ZXJ2YWxgIG1pbGxpc2Vjb25kcyB1bnRpbCBgc3RvcCgpYCBpcyBjYWxsZWQuIFRoZSByZXN1bHRzXG4gICAqIG9mIGVhY2ggYHRhc2tgIGFyZSBzZW50IGFsb25nIHRoZSBgZWdyZXNzQ2hhbm5lbCgpYCwgYXMgYG1zZy5yZXN1bHRgIG9yIGBtc2cuZXJyYC5cbiAgICpcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgUGVyaW9kaWMgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIlBlcmlvZGljXCIpO1xuXG4gIF8uZXh0ZW5kKFBlcmlvZGljLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9zY2hlZHVsZXJSZWYgPSBvcHRzLmdldE9yRXJyb3IoXCJzY2hlZHVsZXJcIik7XG4gICAgICB0aGlzLl90YXNrICAgICAgICAgPSBvcHRzLmdldE9yRWxzZShcInRhc2tcIik7XG4gICAgICB0aGlzLl9pbnRlcnZhbCAgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJpbnRlcnZhbFwiKTtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZCAgID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIiwgXCJzdGFydGVkXCJdKTtcbiAgICAgIHRoaXMuX2NoYW5uZWwgICAgICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG4gICAgICB0aGlzLl90YXNrSWQgICAgICAgPSBudWxsO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfcnVuVGFza1wiKTtcbiAgICB9LFxuXG5cbiAgICBzdGFydDogZnVuY3Rpb24oKXtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmRcbiAgICAgICAgLmRlbnkoXCJkaXNwb3NlZFwiLCBcInN0YXJ0ZWRcIilcbiAgICAgICAgLmFwcGx5KFwic3RhcnRlZFwiKTtcblxuICAgICAgdGhpcy5fc2NoZWR1bGVOZXh0KHRydWUpO1xuICAgIH0sXG5cblxuICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fY2FuY2VsUGVuZGluZygpO1xuICAgICAgdGhpcy5fY2FuY2VsT3V0c3RhbmRpbmcoKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQudW5hcHBseShcInN0YXJ0ZWRcIik7XG4gICAgfSxcblxuICAgIGVncmVzc0NoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBDaGFpbmVkQ2hhbm5lbCh7XG4gICAgICAgIHNlbnRpbmVsOiB0aGlzLFxuICAgICAgICBjaGFpblRvOiB0aGlzLl9jaGFubmVsXG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3J1blRhc2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlc3VsdHMgPSB7XG4gICAgICAgIG1UOiBcInJlc3VsdHNcIixcbiAgICAgICAgcmVzdWx0OiBudWxsLFxuICAgICAgICBlcnI6IG51bGxcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX3Rhc2tJZCA9IG51bGw7XG4gICAgICB0aGlzLl9jdXJyZW50UnVuID0gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAuY2FuY2VsbGFibGUoKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGFzaygpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICByZXN1bHRzLnJlc3VsdCA9IHJlc3VsdDtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChQcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAvLyBMZXQgaXQgYmUuIERvbid0IHdhbnQgaXQgdG8gdHJpY2tsZSBpbnRvIHRoZSByZXN1bHRzLlxuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIHJlc3VsdHMuZXJyID0gZXJyO1xuICAgICAgICB9KVxuICAgICAgICAubGFzdGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2N1cnJlbnRSdW4gPSBudWxsO1xuICAgICAgICAgIHRoaXMuX25vdGlmeVJlc3VsdHMocmVzdWx0cyk7XG4gICAgICAgICAgdGhpcy5fc2NoZWR1bGVOZXh0KCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIF9ub3RpZnlSZXN1bHRzOiBmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICB0aGlzLl9zY2hlZHVsZXJSZWYuZ2V0KCkucnVuU29vbihfLmJpbmQoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpIHx8ICF0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJzdGFydGVkXCIpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKExvZy5pc1RyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgTG9nLnRyYWNlKFwiTm90aWZ5aW5nIHJlc3VsdHNcIiwgcmVzdWx0cyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9jaGFubmVsLnB1Ymxpc2godGhpcywgcmVzdWx0cyk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfSxcblxuXG4gICAgX3NjaGVkdWxlTmV4dDogZnVuY3Rpb24obm93KSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikgfHwgIXRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcInN0YXJ0ZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fdGFza0lkID0gdGhpcy5fc2NoZWR1bGVyUmVmLmdldCgpLnNjaGVkdWxlKHRoaXMuX3J1blRhc2ssIG5vdyA/IDAgOiB0aGlzLl9pbnRlcnZhbCk7XG4gICAgICBMb2cudHJhY2UoXCJTY2hlZHVsZWQgdGFza1wiLCB0aGlzLl90YXNrSWQpO1xuICAgIH0sXG5cblxuICAgIF9jYW5jZWxQZW5kaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgIExvZy50cmFjZShcImNhbmNlbFBlbmRpbmcgcmVxdWVzdGVkLCBsb29raW5nIGZvciBwZW5kaW5nIHRhc2suXCIpO1xuICAgICAgaWYgKHRoaXMuX3Rhc2tJZCkge1xuICAgICAgICBMb2cudHJhY2UoXCJGb3VuZCBwZW5kaW5nIHRhc2s7IGNhbmNlbGxpbmdcIiwgdGhpcy5fdGFza0lkKTtcbiAgICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmLmdldCgpLnVuc2NoZWR1bGUodGhpcy5fdGFza0lkKTtcbiAgICAgICAgdGhpcy5fdGFza0lkID0gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgX2NhbmNlbE91dHN0YW5kaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgIExvZy50cmFjZShcImNhbmNlbE91dHN0YW5kaW5nIHJlcXVlc3RlZCwgbG9va2luZyBmb3Igb3V0c3RhbmRpbmcgd29yay5cIik7XG4gICAgICBpZiAodGhpcy5fY3VycmVudFJ1bikge1xuICAgICAgICBMb2cudHJhY2UoXCJPdXRzdGFuZGluZyB3b3JrIGZvdW5kOyBjYW5jZWxsaW5nXCIpO1xuICAgICAgICB0aGlzLl9jdXJyZW50UnVuLmNhbmNlbCgpO1xuICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKXtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2NhbmNlbFBlbmRpbmcoKTtcbiAgICAgIHRoaXMuX2NhbmNlbE91dHN0YW5kaW5nKCk7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBQZXJpb2RpYztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgc2ltcGxlIHRpbWVyLlxuICAgKlxuICAgKiBTdGFydCBpdCwgc3RvcCBpdCwgZ2V0IHRoZSBkZWx0YS5cbiAgICpcbiAgICogT3IsIHN0YXJ0IGl0LCBhbmQgcmVwZWF0ZWRseSBjYWxsIGBsYXBgIGZvciB0aGUgdGltZSBiZXR3ZWVuIHRoZSBsYXN0IGBsYXBgIGNhbGwgYW5kIG5vdy5cbiAgICpcbiAgICovXG4gIHZhciBUaW1lciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFRpbWVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc3RhcnRUaW1lID0gbnVsbDtcbiAgICAgIHRoaXMuX2VuZFRpbWUgPSBudWxsO1xuICAgICAgdGhpcy5fbGFzdExhcCA9IG51bGw7XG4gICAgfSxcblxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc3RhcnRUaW1lID0gdGhpcy5fbGFzdExhcCA9ICtuZXcgRGF0ZSgpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9lbmRUaW1lID0gK25ldyBEYXRlKCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgbGFwOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdGhpcy5fbGFzdExhcCkgcmV0dXJuIDA7XG5cbiAgICAgIHZhciBvbGRMYXN0TGFwID0gdGhpcy5fbGFzdExhcDtcbiAgICAgIHRoaXMuX2xhc3RMYXAgPSArbmV3IERhdGUoKTtcbiAgICAgIHJldHVybiAodGhpcy5fbGFzdExhcCAtIG9sZExhc3RMYXApO1xuICAgIH0sXG5cblxuICAgIGRlbHRhOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAodGhpcy5fZW5kVGltZSAtIHRoaXMuX3N0YXJ0VGltZSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gVGltZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgTGFuZyxcbiAgU3RhdGVHdWFyZCxcbiAgTG9nZ2VyXG4pIHtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIlJldHJ5YWJsZVwiKTtcblxuICB2YXIgREVGQVVMVF9CQUNLT0ZGX0NFSUxJTkcgPSA2MCAqIDEwMDAgKiAxMDsgLy8gMTAgbWludXRlc1xuXG5cbiAgLyoqXG4gICAqIEEgZGV2aWNlIHdoaWNoIHJldHJpZXMgdGhlIHByb3ZpZGVkIFByb21pc2lmaWVkIGB0YXNrYCB1bnRpbCBpdCBjb21wbGV0ZXMgd2l0aG91dCBlcnJvciwgb3IgYHJldHJpZXNgIHRpbWVzXG4gICAqIChkZWZhdWx0IGlzIGZvcmV2ZXIpLiBUaGUgcmVzdWx0cyBvZiB0aGUgYHRhc2tgIGFyZSBhY2Nlc3NpYmxlIHZpYSB0aGUgYHJlc3VsdCgpYCBwcm9taXNlLCB3aGljaCB3aWxsIGJlIGZ1bGZpbGxlZFxuICAgKiBvciByZWplY3RlZCBvbiBzdWNjZXNzIG9yIGVycm9yIChzdWNoIGFzIFJldHJ5YWJsZS5FcnJvci5NYXhSZXRyaWVzRXJyb3Igb3IgUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvcikuXG4gICAqXG4gICAqIElmIGFuIGVycm9yIG9jY3VycywgdGhlIGB0YXNrYCBpcyByZXRyaWVkIGFmdGVyIHNvbWUgdGltZSwgYXMgZGV0ZXJtaW5lZCBieSB0aGUgYGJhY2tvZmZgIGBzdHJhdGVneWAsIG9mIHdoaWNoIHR3b1xuICAgKiBhcmUgc3VwcG9ydGVkOiBgUmV0cnlhYmxlLkJhY2tvZmYuTGluZWFyYCBhbmQgYFJldHJ5YWJsZS5CYWNrb2ZmLkV4cG9uZW50aWFsYC4gVGhlIGRlZmF1bHQgc3RyYXRlZ3kgaXNcbiAgICogYFJldHJ5YWJsZS5CYWNrb2ZmLkxpbmVhcmAsIHdpdGggdGhlIHBlcmlvZCBkZXRlcm1pbmVkIGJ5OlxuICAgKlxuICAgKiBgY29lZmZpY2llbnQgKiBhdHRlbXB0TnVtICogZmFjdG9yYFxuICAgKlxuICAgKiBEZWZhdWx0IG9wdGlvbnMgZm9yIExpbmVhciBiYWNrb2ZmIGFyZTogYGZhY3RvcmAgPSAxLCBgY29lZmZpY2llbnRgID0gMjUwLlxuICAgKlxuICAgKiBGb3IgYFJldHJ5YWJsZS5CYWNrb2ZmLkV4cG9uZW50aWFsLCB0aGUgcGVyaW9kIGlzIGRldGVybWluZWQgYnk6XG4gICAqXG4gICAqIGBjb2VmZmljaWVudCAqIE1hdGgucG93KGJhc2UsIGF0dGVtcHROdW0pYFxuICAgKlxuICAgKiBEZWZhdWx0IG9wdGlvbnMgZm9yIEV4cG9uZW50aWFsIGJhY2tvZmYgYXJlOiBgY29lZmZpY2llbnQgPSAyNTBgLCBgYmFzZSA9IDJgLlxuICAgKlxuICAgKiBSZWdhcmRsZXNzIG9mIGJhY2tvZmYgc3RyYXRlZ3ksIGEgYGJhY2tvZmZDZWlsaW5nYCBjYW4gYmUgcHJvdmlkZWQuIElmIHByb3ZpZGVkLCB0aGlzIGlzIHRoZSB1cHBlciBib3VuZCBvZlxuICAgKiB0aGUgcGVyaW9kIGJldHdlZW4gdW5zdWNjZXNzZnVsIHRhc2sgcnVucy4gVGhpcyBhbGxvd3MsIGZvciBleGFtcGxlLCBhbiBleHBvbmVudGlhbCBiYWNrb2ZmIHVwIHRvIGEgY2VpbGluZyAoZS5nLixcbiAgICogZml2ZSBtaW51dGVzKSwgYWZ0ZXIgd2hpY2ggcG9pbnQgdGhlIHBlcmlvZCB3aWxsIHNpbXBseSBiZSB0aGUgY2VpbGluZyAoZS5nLiwgZml2ZSBtaW51dGVzKS5cbiAgICpcbiAgICovXG4gIHZhciBSZXRyeWFibGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChSZXRyeWFibGUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciAgPSBvcHRzLmdldE9yRXJyb3IoXCJzY2hlZHVsZXJcIik7XG4gICAgICB0aGlzLl90YXNrICAgICAgID0gb3B0cy5nZXRPckVycm9yKFwidGFza1wiKTtcbiAgICAgIC8vIElmIG5vdCBwcm92aWRlZCwgZ28gb24gZm9yZXZlci5cbiAgICAgIHRoaXMuX3JldHJpZXMgICAgPSBvcHRzLmdldE9yRWxzZShcInJldHJpZXNcIik7XG4gICAgICB0aGlzLl9jdXJyZW50VHJ5ID0gMDtcbiAgICAgIHRoaXMuX2RlZmVycmVkICAgPSBMYW5nLmRlZmVycmVkKCk7XG5cbiAgICAgIHZhciBiYWNrb2ZmID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNrb2ZmXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN0cmF0ZWd5OiBSZXRyeWFibGUuQmFja29mZi5MaW5lYXIsXG4gICAgICAgICAgZmFjdG9yOiAxLFxuICAgICAgICAgIGNvZWZmaWNpZW50OiAyNTBcbiAgICAgICAgfTtcbiAgICAgIH0pKTtcblxuICAgICAgdmFyIFN0cmF0ZWd5Q2xhc3MgPSBCYWNrb2ZmU3RyYXRlZ3lbYmFja29mZi5nZXRPckVycm9yKFwic3RyYXRlZ3lcIildO1xuXG4gICAgICB0aGlzLl9iYWNrb2ZmU3RyYXRlZ3kgPSBuZXcgU3RyYXRlZ3lDbGFzcyhiYWNrb2ZmLnRvT2JqZWN0KCkpO1xuICAgICAgdGhpcy5fYmFja29mZkNlaWxpbmcgID0gb3B0cy5nZXRPckVsc2UoXCJiYWNrb2ZmQ2VpbGluZ1wiLCBERUZBVUxUX0JBQ0tPRkZfQ0VJTElORyk7XG4gICAgICB0aGlzLl9kaXNwb3NlZEd1YXJkICAgPSBTdGF0ZUd1YXJkLnNjb3BlZChcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfYXR0ZW1wdFwiKTtcbiAgICAgIHRoaXMuX2N1cnJlbnRSdW4gPSBudWxsO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyLmdldCgpLnJ1blNvb24odGhpcy5fYXR0ZW1wdCk7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkR3VhcmQuYXBwbGllZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSdW4pIHtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1bi5jYW5jZWwobmV3IFJldHJ5YWJsZS5FcnJvci5EaXNwb3NlZEVycm9yKCkpO1xuICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fdGFzayA9IG51bGw7XG5cbiAgICAgIHRoaXMuX2Rpc3Bvc2VkR3VhcmQuYXBwbHkoKTtcbiAgICB9LFxuXG4gICAgcmVzdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9kZWZlcnJlZC5wcm9taXNlO1xuICAgIH0sXG5cbiAgICBfYXR0ZW1wdDogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fZGlzcG9zZWRHdWFyZC5hcHBsaWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jdXJyZW50UnVuID0gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAuY2FuY2VsbGFibGUoKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGFzaygpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICBpZiAodGhpcy5fZGVmZXJyZWQucHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgdGhpcy5fZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChSZXRyeWFibGUuRXJyb3IuRGlzcG9zZWRFcnJvciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fZGVmZXJyZWQucHJvbWlzZS5jYW5jZWwobmV3IFByb21pc2UuQ2FuY2VsbGF0aW9uRXJyb3IoKSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkR3VhcmQuYXBwbGllZCgpKSB7XG4gICAgICAgICAgICBMb2cud2FybihcIkNhdWdodCByZXRyeWFibGUgcnVuIGVycm9yLCBidXQgcmV0cnlhYmxlIGlzIGFscmVhZHkgZGlzcG9zZWRcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgTG9nLmRlYnVnKFwiUmVjZWl2ZWQgZXJyb3IgaW4gYXR0ZW1wdFwiLCB0aGlzLl9jdXJyZW50VHJ5KTtcbiAgICAgICAgICB2YXIgbmV4dFRyeSA9IHRoaXMuX2N1cnJlbnRUcnkgKyAxO1xuXG4gICAgICAgICAgaWYgKHRoaXMuX3JldHJpZXMgPj0gMCAmJiBuZXh0VHJ5ID4gdGhpcy5fcmV0cmllcykge1xuICAgICAgICAgICAgTG9nLmRlYnVnKFwiSGl0IG1heCBudW1iZXIgb2YgcmV0cmllczpcIiwgdGhpcy5fcmV0cmllcyk7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBSZXRyeWFibGUuRXJyb3IuTWF4UmV0cmllc0Vycm9yKCk7XG4gICAgICAgICAgICBlLmNhdXNlID0gZXJyO1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBTY2hlZHVsZSB1cyB1cCB0byB0cnkgYWdhaW47XG4gICAgICAgICAgdGhpcy5fY3VycmVudFJ1biA9IG51bGw7XG4gICAgICAgICAgdGhpcy5fY3VycmVudFRyeSA9IG5leHRUcnk7XG5cbiAgICAgICAgICB2YXIgdGltZSA9IHRoaXMuX2JhY2tvZmZTdHJhdGVneS50aW1lKHRoaXMuX2N1cnJlbnRUcnkpO1xuICAgICAgICAgIHRoaXMuX3NjaGVkdWxlci5nZXQoKS5zY2hlZHVsZSh0aGlzLl9hdHRlbXB0LCBNYXRoLm1pbih0aW1lLCB0aGlzLl9iYWNrb2ZmQ2VpbGluZykpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KFJldHJ5YWJsZS5FcnJvci5NYXhSZXRyaWVzRXJyb3IsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGlmICh0aGlzLl9kZWZlcnJlZC5wcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWZlcnJlZC5yZWplY3QoZXJyLmNhdXNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgXy5leHRlbmQoUmV0cnlhYmxlLCB7XG4gICAgQmFja29mZjoge1xuICAgICAgTGluZWFyOiAgICAgIFwibGluZWFyXCIsXG4gICAgICBFeHBvbmVudGlhbDogXCJleHBvbmVudGlhbFwiXG4gICAgfSxcbiAgICBFcnJvcjoge1xuICAgICAgRGlzcG9zZWRFcnJvcjogTGFuZy5tYWtlRXJyb3JDbGFzcyhcIkRpc3Bvc2VkRXJyb3JcIiwgXCJSZXRyeWFibGUgd2FzIGRpc3Bvc2VkXCIpLFxuICAgICAgTWF4UmV0cmllc0Vycm9yOiBMYW5nLm1ha2VFcnJvckNsYXNzKFwiTWF4UmV0cmllc0Vycm9yXCIsIFwiUmV0cnlhYmxlIHdhcyByZXRyaWVkIHRvbyBtYW55IHRpbWVzXCIpXG4gICAgfVxuICB9KVxuXG4gIHZhciBCYWNrb2ZmU3RyYXRlZ3kgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIExpbmVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIF8uZXh0ZW5kKExpbmVhci5wcm90b3R5cGUsIHtcbiAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgICAgdGhpcy5fZmFjdG9yICAgICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwiZmFjdG9yXCIsIDEpO1xuICAgICAgICB0aGlzLl9jb2VmZmljaWVudCAgID0gb3B0cy5nZXRPckVsc2UoXCJjb2VmZmljaWVudFwiLCAyNTApO1xuICAgICAgfSxcblxuICAgICAgdGltZTogZnVuY3Rpb24oaXRlcmF0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mYWN0b3IgKiB0aGlzLl9jb2VmZmljaWVudCAqIGl0ZXJhdGlvbjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBFeHBvbmVudGlhbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIF8uZXh0ZW5kKEV4cG9uZW50aWFsLnByb3RvdHlwZSwge1xuICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHRoaXMuX2Jhc2UgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJiYXNlXCIsIDIpO1xuICAgICAgICB0aGlzLl9jb2VmZmljaWVudCA9IG9wdHMuZ2V0T3JFbHNlKFwiY29lZmZpY2llbnRcIiwgMjUwKTtcbiAgICAgIH0sXG5cbiAgICAgIHRpbWU6IGZ1bmN0aW9uKGl0ZXJhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29lZmZpY2llbnQgKiAoTWF0aC5wb3codGhpcy5fYmFzZSwgaXRlcmF0aW9uKSk7XG4gICAgICB9XG4gICAgfSlcblxuXG4gICAgdmFyIGJhY2tvZmZzID0ge307XG5cbiAgICBiYWNrb2Zmc1tSZXRyeWFibGUuQmFja29mZi5MaW5lYXJdICAgICAgPSBMaW5lYXI7XG4gICAgYmFja29mZnNbUmV0cnlhYmxlLkJhY2tvZmYuRXhwb25lbnRpYWxdID0gRXhwb25lbnRpYWw7XG5cbiAgICByZXR1cm4gYmFja29mZnM7XG4gIH0oKSk7XG5cbiAgcmV0dXJuIFJldHJ5YWJsZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sYW5nXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZFxuKSB7XG5cbiAgLyoqXG4gICAqIEF0dGVtcHRzIHRvIGludGVsbGlnZW50bHkgZGlzcGF0Y2ggYW4gb2JqZWN0IHdpdGggYW4gbVQgYXR0cmlidXRlLCB1c2luZ1xuICAgKiB0aGUgcnVsZXMgcHJvdmlkZWQgYXQgaW5zdGFudGlhdGlvbi5cbiAgICpcbiAgICogRm9yIGEgZ2l2ZW4gbVR5cGVkIG9iamVjdCwgc2VhcmNoZXMgdGhlIHByb3ZpZGVkIGBkZWxlZ2F0ZWAgZm9yIGEgbWV0aG9kXG4gICAqIG5hbWVkIFtwcmVmaXhdW2NhbWVsLWNhc2VkIG1UXSwgYW5kIGlmIHByZXNlbnQsIGNhbGxzIGl0LiBJZiBub3QgZm91bmQsXG4gICAqIGxvb2tzIGZvciBbcHJlZml4XUVsc2UuIElmIHRoZSBtVCBhdHRyaWJ1dGUgaXNuJ3QgZm91bmQsIGRpc3BhdGNoZXMgdG9cbiAgICogW3ByZWZpeF1NYWxmb3JtZWQuXG4gICAqL1xuICB2YXIgRGlzcGF0Y2hlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBERUZBVUxUX0NPTlRFWFRfREVMRUdBVEUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge307XG4gIH07XG5cbiAgXy5leHRlbmQoRGlzcGF0Y2hlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fZGVsZWdhdGUgICAgICAgID0gb3B0cy5nZXRPckVycm9yKFwiZGVsZWdhdGVcIiksXG4gICAgICB0aGlzLl9wcmVmaXggICAgICAgICAgPSBvcHRzLmdldE9yRWxzZShcInByZWZpeFwiLCBcIm9uTXNnXCIpO1xuICAgICAgdGhpcy5fZWxzZVN1ZmZpeCAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJlbHNlU3VmZml4XCIsIFwiZWxzZVwiKTtcbiAgICAgIHRoaXMuX21hbGZvcm1lZFN1ZmZpeCA9IG9wdHMuZ2V0T3JFbHNlKFwibWFsZm9ybWVkU3VmZml4XCIsIFwibWFsZm9ybWVkXCIpO1xuICAgICAgdGhpcy5fY29udGV4dERlbGVnYXRlID0gb3B0cy5nZXRPckVsc2UoXCJjb250ZXh0RGVsZWdhdGVcIiwgREVGQVVMVF9DT05URVhUX0RFTEVHQVRFKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICAgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcbiAgICAgIHRoaXMuX3N1YnMgICAgICAgICAgICA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgdmFyIGNoYW5uZWxzID0gb3B0cy5nZXRPckVsc2UoXCJsaXN0ZW5cIiwgW10pO1xuXG4gICAgICBpZiAoIV8uaXNBcnJheShjaGFubmVscykpIHtcbiAgICAgICAgY2hhbm5lbHMgPSBbY2hhbm5lbHNdO1xuICAgICAgfVxuXG4gICAgICBfLmVhY2goY2hhbm5lbHMsIF8uYmluZChmdW5jdGlvbihjKSB7XG4gICAgICAgIHRoaXMubGlzdGVuKGMpXG4gICAgICB9LCB0aGlzKSk7XG4gICAgfSxcblxuICAgIGxpc3RlbjogZnVuY3Rpb24oY2hhbm5lbCkge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIHZhciBzdWIgPSBjaGFubmVsLnN1YnNjcmliZShfLmJpbmQoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2gobXNnKTtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgdGhpcy5fc3VicyA9IE0uYXNzb2ModGhpcy5fc3Vicywgc3ViLmlkKCksIHN1Yik7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRpc3Bvc2U6IF8uYmluZChmdW5jdGlvbigpe1xuICAgICAgICAgIHZhciBuU3ViID0gTS5nZXQodGhpcy5fc3Vicywgc3ViLmlkKCkpO1xuICAgICAgICAgIGlmIChuU3ViKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJzID0gTS5kaXNzb2ModGhpcy5fc3Vicywgc3ViLmlkKCkpO1xuICAgICAgICAgICAgblN1Yi5kaXNwb3NlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBkaXNwYXRjaDogZnVuY3Rpb24obVR5cGVkLCBjdHgpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fZ2V0VmV0dGVkSGFuZGxlck5hbWUobVR5cGVkKTtcblxuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fZGVsZWdhdGVbaGFuZGxlcl0obVR5cGVkLCB0aGlzLl9jb250ZXh0RGVsZWdhdGUobVR5cGVkLCBjdHgpKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogTGlrZSBgZGlzcGF0Y2hgLCBidXQgZXhwZWN0cyBkZWxlZ2F0ZSB0byByZXR1cm4gYSBQcm9taXNlPG9iamVjdD5cbiAgICAgKi9cbiAgICBkaXNwYXRjaEFzeW5jOiBmdW5jdGlvbihtVHlwZWQsIGN0eCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLl9nZXRWZXR0ZWRIYW5kbGVyTmFtZShtVHlwZWQpO1xuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlbGVnYXRlW2hhbmRsZXJdKG1UeXBlZCwgdGhpcy5fY29udGV4dERlbGVnYXRlKG1UeXBlZCwgY3R4KSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIHN1YnMgPSB0aGlzLl9zdWJzO1xuICAgICAgdGhpcy5fc3VicyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgTS5lYWNoKHN1YnMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG5cbiAgICBfZ2V0SGFuZGxlck5hbWU6IGZ1bmN0aW9uKHByZWZpeCwgc3VmZml4KSB7XG4gICAgICByZXR1cm4gcHJlZml4ICsgc3VmZml4LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3VmZml4LnN1YnN0cigxKTtcbiAgICB9LFxuXG4gICAgLy8gRklYTUU6IENoZWNrIGZvciBcInJlc2VydmVkXCIgbVR5cGVzIChfZWxzZVN1ZmZpeCwgX21hbGZvcm1lZFN1ZmZpeCwgZXRjKSwgbG9nIHdhcm5pbmdcbiAgICBfZ2V0VmV0dGVkSGFuZGxlck5hbWU6IGZ1bmN0aW9uKG1UeXBlZCkge1xuICAgICAgdmFyIG1UID0gbVR5cGVkLm1ULFxuICAgICAgICAgIHByZWZpeCA9IHRoaXMuX3ByZWZpeCxcbiAgICAgICAgICBwb3RlbnRpYWxIYW5kbGVyTmFtZSxcbiAgICAgICAgICBmaW5hbEhhbmRsZXJOYW1lO1xuXG4gICAgICBpZiAoIW1UKSB7XG4gICAgICAgIGZpbmFsSGFuZGxlck5hbWUgPSB0aGlzLl9nZXRIYW5kbGVyTmFtZShwcmVmaXgsIHRoaXMuX21hbGZvcm1lZFN1ZmZpeCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwb3RlbnRpYWxIYW5kbGVyTmFtZSA9IHRoaXMuX2dldEhhbmRsZXJOYW1lKHByZWZpeCwgbVQpO1xuICAgICAgICBpZiAoXy5pc0Z1bmN0aW9uKHRoaXMuX2RlbGVnYXRlW3BvdGVudGlhbEhhbmRsZXJOYW1lXSkpIHtcbiAgICAgICAgICBmaW5hbEhhbmRsZXJOYW1lID0gcG90ZW50aWFsSGFuZGxlck5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZmluYWxIYW5kbGVyTmFtZSA9IHRoaXMuX2dldEhhbmRsZXJOYW1lKHByZWZpeCwgdGhpcy5fZWxzZVN1ZmZpeCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKF8uaXNGdW5jdGlvbih0aGlzLl9kZWxlZ2F0ZVtmaW5hbEhhbmRsZXJOYW1lXSkpIHtcbiAgICAgICAgcmV0dXJuIGZpbmFsSGFuZGxlck5hbWU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRGlzcGF0Y2hlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL3N0YXRlLWd1YXJkXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZmFjdG9yeSA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICpcbiAgICogSGVscGVyIGZvciBkZWFsaW5nIHdpdGggaGFzaC1zdHlsZSBmdW5jdGlvbiBhcmd1bWVudHMsIHdoaWNoIGNhbiBiZSB1c2VmdWxcbiAgICogaW4gbWV0aG9kcyB3aXRoIG9wdGlvbmFsL2RlZmF1bHQgdmFsdWVzLlxuICAgKlxuICAgKiBVc2FnZTpcbiAgICpcbiAgICogICB2YXIgZm9vID0gZnVuY3Rpb24ob3B0cykge1xuICAgKiAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgKlxuICAgKiAgICAgICB2YXIgb25lID0gb3B0cy5nZXRPckVycm9yKFwib25lXCIpLFxuICAgKiAgICAgICAgICAgdHdvID0gb3B0cy5nZXRPckVsc2UoXCJ0d29cIiwgMiksXG4gICAqICAgICAgICAgICB0aHJlZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJ0aHJlZVwiLCBmdW5jdGlvbigpIHtcbiAgICogICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAqICAgICAgICAgICB9KTtcbiAgICpcbiAgICogICAgIGNvbnNvbGUubG9nKG9uZSwgdHdvLCB0aHJlZSk7XG4gICAqICAgfTtcbiAgICpcbiAgICogICBmb28oeyBvbmU6IDEgfSk7IC8vIGxvZ3MgXCIxLCAyLCAzXCJcbiAgICogICBmb28oKTsgLy8gdGhyb3dzIEVycm9yXG4gICAqICAgZm9vKHtvbmU6IDEsIHR3bzogZmFsc2UsIHRocmVlOiA0fSk7IC8vIGxvZ3MgXCIxLCBmYWxzZSwgNFwiXG4gICAqXG4gICAqL1xuICB2YXIgT3B0aW9ucyA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKE9wdGlvbnMucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgdGhpcy5fcHJvdmlkZWRPcHRzID0gb3B0cyB8fCB7fTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQXR0ZW1wdHMgdG8gcmV0dXJuIHRoZSB2YWx1ZSBmb3IgdGhlIHJlcXVlc3RlZCBga2V5YC4gSWYgdGhlIHZhbHVlXG4gICAgICogaXMgdW5kZWZpbmVkIG9yIG51bGwsIGluc3RlYWQgcmV0dXJucyB0aGUgcHJvdmlkZWQgYGZhbGxiYWNrVmFsdWVgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSAocmVxdWlyZWQpIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGZhbGxiYWNrVmFsdWUgIHJldHVybmVkIGlmIGBrZXlgIGF0dHJpYnV0ZSBpcyBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAqXG4gICAgICogQHJldHVybnMgcmVxdWVzdGVkIHZhbHVlIGZvciBga2V5YCwgb3IgZmFsbGJhY2tWYWx1ZWBcbiAgICAgKi9cbiAgICBnZXRPckVsc2U6IGZ1bmN0aW9uKGtleSwgZGVmYXVsdFZhbHVlKSB7XG4gICAgICBpZiAodGhpcy5faXNVbmRlZk9yTnVsbChrZXkpKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZWRPcHRzW2tleV07XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIHJldHVybiB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQgYGtleWAuIElmIHRoZSB2YWx1ZVxuICAgICAqIGlzIHVuZGVmaW5lZCBvciBudWxsLCB0aHJvd3MgYW4gZXJyb3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IChyZXF1aXJlZCkgYXR0cmlidXRlIHRvIGJlIHJlYWRcbiAgICAgKiBAcGFyYW0gZXJyICAgICAgICAgICAgbWVzc2FnZSBwcm92aWRlZCB0byBFcnJvciBjb25zdHJ1Y3RvciBpZiBga2V5YFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICBpcyBudWxsIG9yIG5vdCBkZWZpbmVkXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQga2V5XG4gICAgICovXG4gICAgZ2V0T3JFcnJvcjogZnVuY3Rpb24oa2V5LCBlcnJvck1zZykge1xuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICBlcnJvck1zZyA9IGVycm9yTXNnIHx8IFwiT3B0aW9uIHJlcXVlc3RlZCBidXQgbm90IGZvdW5kOiBgXCIra2V5K1wiYFwiO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNc2cpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZWRPcHRzW2tleV07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIHJldHVybiB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQgYGtleWAuIElmIHRoZSB2YWx1ZVxuICAgICAqIGlzIHVuZGVmaW5lZCBvciBudWxsLCBpbnN0ZWFkIGV2YWx1YXRlcyBgZmFsbGJhY2tWYWx1ZUZuYCBhbmQgcmV0dXJuc1xuICAgICAqIGl0cyB2YWx1ZS5cbiAgICAgKlxuICAgICAqIFRoaXMgaXMgdXNlZnVsIGZvciBzaW11bGF0aW5nIG5vbi1zdHJpY3QgZXZhbHVhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgKHJlcXVpcmVkKSAgYXR0cmlidXRlIHRvIGJlIHJlYWRcbiAgICAgKiBAcGFyYW0gZmFsbGJhY2tWYWx1ZUZuIGV2YWx1YXRlZCBhbmQgcmV0dXJuIHZhbHVlIHJldHVybmVkIGlmIGBrZXlgXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGUgaXMgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHJlcXVlc3RlZCB2YWx1ZSBmb3IgYGtleWAgb3IgdGhlIHJldHVybiB2YWx1ZSBvZiBldmFsdWF0ZWRcbiAgICAgKiAgICAgICAgICBgZmFsbGJhY2tWYWx1ZUZuYFxuICAgICAqL1xuICAgIGdldE9yRWxzZUZuOiBmdW5jdGlvbihrZXksIGRlZmF1bHRWYWx1ZUZuKSB7XG4gICAgICBpZiAodHlwZW9mIGRlZmF1bHRWYWx1ZUZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT3B0aW9ucyNnZXRPckVsc2VGbiByZXF1aXJlcyBhIGRlZmF1bHRWYWx1ZUZuXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5faXNVbmRlZk9yTnVsbChrZXkpKSB7XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWVGbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgICAgfVxuICAgIH0sXG5cblxuICAgIHRvT2JqZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfLmNsb25lKHRoaXMuX3Byb3ZpZGVkT3B0cyk7XG4gICAgfSxcblxuICAgIHNjb3BlOiBmdW5jdGlvbihwcmVmaXgpIHtcbiAgICAgIHJldHVybiBPcHRpb25zLmZyb21PYmplY3RXaXRoUHJlZml4KHRoaXMudG9PYmplY3QoKSwgcHJlZml4KTtcbiAgICB9LFxuXG4gICAgX2lzVW5kZWZPck51bGw6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzLl9wcm92aWRlZE9wdHNba2V5XSA9PT0gXCJ1bmRlZmluZWRcIiB8fCB0aGlzLl9wcm92aWRlZE9wdHNba2V5XSA9PT0gbnVsbDtcbiAgICB9XG4gIH0pO1xuXG4gIF8uZXh0ZW5kKE9wdGlvbnMsIHtcbiAgICBmcm9tT2JqZWN0OiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICByZXR1cm4gbmV3IE9wdGlvbnMob3B0cyk7XG4gICAgfSxcblxuXG4gICAgZnJvbU9iamVjdFdpdGhQcmVmaXg6IGZ1bmN0aW9uKG9wdHMsIHByZWZpeCkge1xuICAgICAgb3B0cyA9IF8ucmVkdWNlKG9wdHMsIGZ1bmN0aW9uKG1lbW8sIHZhbCwga2V5KSB7XG4gICAgICAgIHZhciByZXN0LCBuZXdLZXk7XG4gICAgICAgIGlmIChrZXkuaW5kZXhPZihwcmVmaXgpID09PSAwKSB7XG4gICAgICAgICAgcmVzdCA9IGtleS5zdWJzdHIocHJlZml4Lmxlbmd0aCk7XG4gICAgICAgICAgaWYgKHJlc3QubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgbmV3S2V5ID0gcmVzdC5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIHJlc3Quc3Vic3RyKDEpO1xuICAgICAgICAgICAgbWVtb1tuZXdLZXldID0gdmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgcmV0dXJuIG5ldyBPcHRpb25zKG9wdHMpO1xuICAgIH1cbiAgfSlcblxuICByZXR1cm4gT3B0aW9ucztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXG52YXIgbW9kID0gZnVuY3Rpb24gKFxuICBfXG4gICkge1xuXG4gIC8qKlxuICAgKiBBIGRldmljZSB3aGljaCBjYWxscyB0aGUgcHJvdmlkZWQgY29tcGxldGlvbkNhbGxiYWNrIGFmdGVyIGBzdGVwc2AgY2FsbHMgdG8gYENvdW50ZG93bkxhdGNoI3N0ZXAoKWAuXG4gICAqXG4gICAqL1xuXG4gIHZhciBDb3VudGRvd25MYXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9LFxuICAgICAgbm9vcCA9IGZ1bmN0aW9uKCkge307XG5cbiAgXy5leHRlbmQoQ291bnRkb3duTGF0Y2gucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gKHN0ZXBzLCBjb21wbGV0aW9uQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX3N0ZXBzID0gc3RlcHMgfHwgMDtcbiAgICAgIHRoaXMuX2NvbXBsZXRpb25DYWxsYmFjayA9IGNvbXBsZXRpb25DYWxsYmFjayB8fCBub29wO1xuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2NvbXBsZXRpb25DYWxsYmFja1wiLCBcIl90cmlnZ2VyQ29tcGxldGlvblwiKTtcbiAgICAgIGlmKGlzTmFOKHRoaXMuX3N0ZXBzKSB8fCB0aGlzLl9zdGVwcyA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bnRkb3duTGF0Y2g6IE51bWJlciBvZiBzdGVwcyBhcmUgaW52YWxpZC5cIik7XG4gICAgICB9XG4gICAgICB0aGlzLl9jdXJyZW50ID0gMDtcbiAgICAgIHRoaXMuX2NvbXBsZXRlID0gZmFsc2U7XG4gICAgICB0aGlzLl9lcnJvciA9IG51bGw7XG4gICAgICBpZih0aGlzLl9zdGVwcyA9PT0gMCkge1xuICAgICAgICBfLmRlZmVyKHRoaXMuX3RyaWdnZXJDb21wbGV0aW9uKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0sXG4gICAgc3RlcDogZnVuY3Rpb24gKHN0ZXBzKSB7XG4gICAgICBpZiAodGhpcy5fY29tcGxldGUgfHwgdGhpcy5fc3RlcHMgPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fY3VycmVudCArPSBzdGVwcyB8fCAxO1xuICAgICAgaWYgKHRoaXMuX2N1cnJlbnQgPj0gdGhpcy5fc3RlcHMpIHtcbiAgICAgICAgdGhpcy5fdHJpZ2dlckNvbXBsZXRpb24oKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBpZiAodGhpcy5fY29tcGxldGUgfHwgdGhpcy5fc3RlcHMgPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fZXJyb3IgPSBlcnI7XG4gICAgICB0aGlzLl90cmlnZ2VyQ29tcGxldGlvbigpO1xuICAgIH0sXG4gICAgX3RyaWdnZXJDb21wbGV0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5fY29tcGxldGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5fY29tcGxldGUgPSB0cnVlO1xuICAgICAgaWYgKHRoaXMuX2Vycm9yKSB7XG4gICAgICAgIF8uZGVmZXIoXy5iaW5kKHRoaXMuX2NvbXBsZXRpb25DYWxsYmFjaywgbnVsbCwgdGhpcy5fZXJyb3IpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF8uZGVmZXIodGhpcy5fY29tcGxldGlvbkNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDb3VudGRvd25MYXRjaDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGZhY3RvcnkgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgdXRpbGl0eSBzaW5nbGV0b24gZm9yIFwibGFuZ3VhZ2UgZXh0ZW5zaW9uc1wiLlxuICAgKi9cbiAgdmFyIExhbmcgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMYW5nLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCl7fVxuICB9KTtcblxuICBfLmV4dGVuZChMYW5nLCB7XG4gICAgbm9vcDogZnVuY3Rpb24oKSB7fSxcblxuICAgIHBhcnRpYWxseUFwcGx5OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gXy50b0FycmF5KGFyZ3VtZW50cyksXG4gICAgICAgICAgZnVuICA9IGFyZ3Muc2hpZnQoKTtcblxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZnVuLmFwcGx5KG51bGwsIGFyZ3MuY29uY2F0KGFyZ3VtZW50cykpO1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgbWFrZUVycm9yQ2xhc3M6IGZ1bmN0aW9uKG5hbWUsIGRlZmF1bHRNZXNzYWdlKSB7XG4gICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWFrZUVycm9yQ2xhc3MgcmVxdWlyZXMgYG5hbWVgXCIpO1xuICAgICAgfVxuXG4gICAgICB2YXIga2xhc3MgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMubmFtZSAgICA9IG5hbWU7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IHRoaXMubmFtZSArIFwiOiBcIiArIChtZXNzYWdlIHx8IGRlZmF1bHRNZXNzYWdlIHx8IFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiKTtcblxuICAgICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBrbGFzcyk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGtsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgICAgIGtsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGtsYXNzO1xuICAgICAgcmV0dXJuIGtsYXNzO1xuICAgIH0sXG5cbiAgICBwb2pvQ2xhc3M6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHtcbiAgICAgIGlmICghXy5pc0FycmF5KGF0dHJpYnV0ZXMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxhbmcjcG9qb0NsYXNzIHJlcXVpcmVzIGF0dHJpYnV0ZXMgYXJyYXlcIik7XG4gICAgICB9XG5cbiAgICAgIHZhciBvcHRpb25zID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdGlvbnMpLFxuICAgICAgICAgIC8vIG9wdGlvbmFsIHNwZWNpZmllcyBrZXlzIHRoYXQgYXJlIG9wdGlvbmFsLCB3aXRoIHZhbHVlcyB0aGF0IGFyZSBkZWZhdWx0IGlmIG5vdCBwcm92aWRlZFxuICAgICAgICAgIGRlZmF1bHRzID0gb3B0aW9ucy5nZXRPckVsc2UoXCJkZWZhdWx0c1wiLCB7fSksXG4gICAgICAgICAgb3B0aW9uYWxBdHRyaWJ1dGVzID0gXy5rZXlzKGRlZmF1bHRzKTtcblxuICAgICAgdmFyIHRvQXR0cmlidXRlTmFtZSA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIHJldHVybiBcIl9cIiArIGF0dHI7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0b0dldHRlciA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdG9TZXR0ZXIgPSBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzZXRcIiArIGF0dHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBhdHRyLnN1YnN0cigxKTtcbiAgICAgICAgICB9O1xuXG4gICAgICB2YXIga2xhc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuXG4gICAgICBfLmV4dGVuZChrbGFzcy5wcm90b3R5cGUsIHtcbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICAgICAgXy5lYWNoKGF0dHJpYnV0ZXMsIGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAgICAgIGlmIChfLmNvbnRhaW5zKG9wdGlvbmFsQXR0cmlidXRlcywgYXR0cikpIHtcbiAgICAgICAgICAgICAgdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildID0gb3B0cy5nZXRPckVsc2UoYXR0ciwgZGVmYXVsdHNbYXR0cl0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildID0gb3B0cy5nZXRPckVycm9yKGF0dHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgXy5lYWNoKGF0dHJpYnV0ZXMsIGZ1bmN0aW9uKGF0dHIpIHtcbiAgICAgICAga2xhc3MucHJvdG90eXBlW3RvR2V0dGVyKGF0dHIpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzW3RvQXR0cmlidXRlTmFtZShhdHRyKV07XG4gICAgICAgIH07XG4gICAgICAgIGtsYXNzLnByb3RvdHlwZVt0b1NldHRlcihhdHRyKV0gPSBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildID0gdjtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ga2xhc3M7XG4gICAgfSxcblxuICAgIGRlZmVycmVkOiBmdW5jdGlvbihwcm9taXNlQ2xhc3MpIHtcbiAgICAgIHByb21pc2VDbGFzcyA9IHByb21pc2VDbGFzcyB8fCBQcm9taXNlO1xuICAgICAgdmFyIHJlcyA9IG51bGwsIHJlaiA9IG51bGw7XG4gICAgICB2YXIgcCA9IG5ldyBwcm9taXNlQ2xhc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlcyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgcmVqID0gYXJndW1lbnRzWzFdO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHByb21pc2U6IHAsXG4gICAgICAgIHJlc29sdmU6IHJlcyxcbiAgICAgICAgcmVqZWN0OiAgcmVqXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIExhbmc7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZVxuKSB7XG5cbiAgLyoqXG4gICAqIEEgU3RhdGVHdWFyZCBkb2VzIHdoYXQgaXRzIG5hbWUgaW1wbGllcy4gVmFsaWQgc3RhdGVzIGFyZSBwcm92aWRlZCBkdXJpbmcgaW5zdGFudGlhdGlvbiwgYW5kIGFyZSBhcHBsaWVkLCBlbnN1cmVkLFxuICAgKiBkZW5pZWQsIGV0YywgdGhyb3VnaCB0aGUgY291cnNlIG9mIHRoZSBvd25lcidzIGxpZmV0aW1lLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgaWYgeW91J2QgbGlrZSB0byBlbnN1cmUgdGhhdCBGb28jYmFyIHJhaXNlcyBhbiBlcnJvciBhZnRlciBGb28jZGlzcG9zZSBpcyBjYWxsZWQsIHlvdSBtaWdodCBkbyB0aGVcbiAgICogZm9sbG93aW5nOlxuICAgKlxuICAgKiAgIHZhciBGb28gPSBmdW5jdGlvbigpIHtcbiAgICogICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgXy5leHRlbmQoRm9vLnByb3RvdHlwZSwge1xuICAgKiAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbmV3IEV4cGVuc2l2ZVJlc291cmNlKCk7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAqICAgICB9LFxuICAgKiAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIC8vICNkaXNwb3NlIHNob3VsZCBiZSBpZGVtcG90ZW50LCBzbyBoZXJlIHdlIGp1c3QgY2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIGFscmVhZHkgZGlzcG9zZWQsIGFuZCByZXR1cm4uXG4gICAqICAgICAgIC8vIE5vdGUgdGhhdCBpZiBkaXNwb3NlIHdlcmUgYXN5bmMsIHdlJ2QgbmVlZCB0byBhZGQgYSBcImRpc3Bvc2luZ1wiIHN0YXRlLlxuICAgKiAgICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICogICAgICAgICByZXR1cm47XG4gICAqICAgICAgIH1cbiAgICpcbiAgICogICAgICAgaWYgKHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlKSB7XG4gICAqICAgICAgICAgdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2UuZGlzcG9zZSgpO1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbnVsbDtcbiAgICogICAgICAgfVxuICAgKiAgICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAqICAgICB9LFxuICAgKiAgICAgYmFyOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7IC8vIFRocm93cyBleGNlcHRpb24gaWYgI2Rpc3Bvc2Ugd2FzIGNhbGxlZFxuICAgKlxuICAgKiAgICAgICByZXR1cm4gdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2Uuc29tZU1ldGhvZCgpO1xuICAgKiAgICAgfVxuICAgKiAgIH0pO1xuICAgKlxuICAgKiBJbiB0aGlzIGNhc2UsIHdoZXJlIHdlIGhhdmUgb25seSBvbmUgc3RhdGUsIGl0J3MgdXNlZnVsIHRvIHNpbXBseSBjcmVhdGUgYSBzY29wZWQgU3RhdGVHdWFyZCwgd2hpY2ggYmVoYXZlc1xuICAgKiBpZGVudGljYWxseSB0byBhIHJlZ3VsYXIgb25lLCBleGNlcHQgZXZlcnkgZW5mb3JjZW1lbnQvcXVlcnkgbWV0aG9kIGhhcyB0aGUgc2NvcGUgcHJvdmlkZWQgZHVyaW5nIGluc3RhbnRpYXRpb25cbiAgICogYXMgYSBmaXJzdCwgaW1wbGljaXQgYXJndW1lbnQ6XG4gICAqXG4gICAqICAgLy8gSWRlbnRpY2FsIHRvIHByZXZpb3VzIHZlcnNpb24uXG4gICAqXG4gICAqICAgdmFyIEZvbyA9IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAqICAgfTtcbiAgICpcbiAgICogICBfLmV4dGVuZChGb28ucHJvdG90eXBlLCB7XG4gICAqICAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2UgPSBuZXcgRXhwZW5zaXZlUmVzb3VyY2UoKTtcbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZCA9IFN0YXRlR3VhcmQuc2NvcGVkKFwiZGlzcG9zZWRcIik7XG4gICAqICAgICB9LFxuICAgKiAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIC8vICNkaXNwb3NlIHNob3VsZCBiZSBpZGVtcG90ZW50LCBzbyBoZXJlIHdlIGp1c3QgY2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIGFscmVhZHkgZGlzcG9zZWQsIGFuZCByZXR1cm4uXG4gICAqICAgICAgIC8vIE5vdGUgdGhhdCBpZiBkaXNwb3NlIHdlcmUgYXN5bmMsIHdlJ2QgbmVlZCB0byBhZGQgYSBcImRpc3Bvc2luZ1wiIHN0YXRlLlxuICAgKiAgICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKCkpIHtcbiAgICogICAgICAgICByZXR1cm47XG4gICAqICAgICAgIH1cbiAgICpcbiAgICogICAgICAgaWYgKHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlKSB7XG4gICAqICAgICAgICAgdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2UuZGlzcG9zZSgpO1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbnVsbDtcbiAgICogICAgICAgfVxuICAgKiAgICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KCk7XG4gICAqICAgICB9LFxuICAgKiAgICAgYmFyOiBmdW5jdGlvbigpIHtcbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KCk7IC8vIFRocm93cyBleGNlcHRpb24gaWYgI2Rpc3Bvc2Ugd2FzIGNhbGxlZFxuICAgKlxuICAgKiAgICAgICByZXR1cm4gdGhpcy5fZXhwZW5zaXZlUmVzb3VyY2Uuc29tZU1ldGhvZCgpO1xuICAgKiAgICAgfVxuICAgKiAgIH0pO1xuICAgKlxuICAgKi9cbiAgdmFyIFN0YXRlR3VhcmQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdGF0ZUd1YXJkLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHN0YXRlcykge1xuICAgICAgdGhpcy5fdmFsaWRTdGF0ZXMgPSBfLnJlZHVjZShzdGF0ZXMsIGZ1bmN0aW9uKG1lbW8sIHN0YXRlKSB7XG4gICAgICAgIG1lbW9bc3RhdGVdID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIHRoaXMuX2FwcGxpZWRTdGF0ZXMgPSB7fTtcbiAgICB9LFxuXG4gICAgc2NvcGU6IGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICB2YXIgc2tpcCA9IFtcInNjb3BlXCIsIFwiaW5pdGlhbGl6ZVwiXSxcbiAgICAgICAgICBzZWxmID0gdGhpcyxcbiAgICAgICAgICBzY29wZWQgPSB7fTtcblxuICAgICAgXy5lYWNoKFN0YXRlR3VhcmQucHJvdG90eXBlLCBmdW5jdGlvbihmdW4sIG1ldGhvZE5hbWUpIHtcbiAgICAgICAgaWYgKF8uY29udGFpbnMoc2tpcCwgbWV0aG9kTmFtZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBzY29wZWRbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgYXJncyA9IF8udG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgICAgIGFyZ3MudW5zaGlmdChzdGF0ZSk7XG4gICAgICAgICAgcmV0dXJuIGZ1bi5hcHBseShzZWxmLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gc2NvcGVkO1xuICAgIH0sXG5cbiAgICBhcHBseTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuXG4gICAgICBfLmVhY2goc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICB0aGlzLl9hcHBsaWVkU3RhdGVzW3N0YXRlXSA9IHRydWU7XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGFwcGx5QXN5bmM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuYXBwbHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIGFwcGx5QXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5QXN5bmMuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgdW5hcHBseTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuXG4gICAgICBfLmVhY2goc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV0pIHtcbiAgICAgICAgICBkZWxldGUgdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV07XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgdW5hcHBseUFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnVuYXBwbHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIHVuYXBwbHlBc3luY0ZuOiBmdW5jdGlvbihzdGF0ZXMpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIF8uYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudW5hcHBseUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgZGVueTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuXG4gICAgICB2YXIgYXBwbGllZCA9IF8uZmlsdGVyKHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdO1xuICAgICAgfSwgdGhpcyk7XG5cbiAgICAgIGlmIChhcHBsaWVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3RhdGUgZGVuaWFsIHJlcXVlc3RlZCwgYnV0IGFwcGxpZWQ6IFwiICsgcHJldHR5KGFwcGxpZWQpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGRlbnlBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5kZW55LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICBkZW55QXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbnlBc3luYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGVuc3VyZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3RhdGVzID0gYXJ5T3JWYXJpYWRpY1RvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93KHRoaXMuX3ZhbGlkU3RhdGVzLCBzdGF0ZXMpO1xuICAgICAgdmFyIG1pc3NpbmcgPSBfLnJlamVjdChzdGF0ZXMsIGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHBsaWVkU3RhdGVzW3N0YXRlXTtcbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0YXRlIGVuc3VyYW5jZSByZXF1ZXN0ZWQsIGJ1dCBub3QgYXBwbGllZDogXCIgKyBwcmV0dHkobWlzc2luZykpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGVuc3VyZUFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmVuc3VyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0pLFxuXG4gICAgZW5zdXJlQXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuc3VyZUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGFwcGxpZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgcmV0dXJuIF8uZXZlcnkoc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV07XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgYXBwbGllZEFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcGxpZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIGFwcGxpZWRBc3luY0ZuOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIF8uYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbGllZEFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgICB9LCB0aGlzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBhcnlPclZhcmlhZGljVG9BcnJheSA9IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICByZXR1cm4gXy5jaGFpbihhcmdzKS50b0FycmF5KCkuZmxhdHRlbigpLnZhbHVlKCk7XG4gIH07XG5cbiAgdmFyIGNoZWNrVmFsaWRTdGF0ZXNPclRocm93ID0gZnVuY3Rpb24odmFsaWRTdGF0ZXNNYXAsIHN0YXRlcykge1xuICAgIHZhciBpbnZhbGlkU3RhdGVzID0gXy5yZWplY3Qoc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgcmV0dXJuICEhdmFsaWRTdGF0ZXNNYXBbc3RhdGVdO1xuICAgIH0pO1xuXG4gICAgaWYgKGludmFsaWRTdGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzdGF0ZXMgcHJvdmlkZWQ6IFwiICsgcHJldHR5KGludmFsaWRTdGF0ZXMpKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHByZXR0eSA9IGZ1bmN0aW9uKHN0YXRlcykge1xuICAgIHJldHVybiBcIltcIitzdGF0ZXMuam9pbihcIixcIikrXCJdXCI7XG4gIH07XG5cbiAgXy5leHRlbmQoU3RhdGVHdWFyZCwge1xuICAgIHNjb3BlZDogZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgIHJldHVybiAobmV3IFN0YXRlR3VhcmQoW3Njb3BlXSkpLnNjb3BlKHNjb3BlKTtcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIFN0YXRlR3VhcmQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICogQSBtaXhpbiBlbmFibGluZyBwdWJzdWIgb24gYW4gb2JqZWN0LiBUbyB1c2UsIGNvcHkgdGhlIHNpbmdsZXRvbiBtZXRob2RzIGludG8gdGhlIG9iamVjdCBvciBvYmplY3QgcHJvdG90eXBlOlxuICAgKlxuICAgKiAgICAgdmFyIG15T2JqID0gXy5leHRlbmQoe30sIFB1YlN1Yik7XG4gICAqICAgICBteU9iai5vbignZm9vJywgZnVuY3Rpb24oZXZ0KSB7IGNvbnNvbGUubG9nKGV2dCkgfSk7IC8vIGxvZ3MgYHsgJ3NvbWUnOiAnZGF0YScgfWBcbiAgICogICAgIG15T2JqLm5vdGlmeSgnZm9vJywgeyBzb21lOiAnZGF0YScgfSk7XG4gICAqXG4gICAqL1xuICB2YXIgUHViU3ViID0ge1xuICAgIG9uOiBmdW5jdGlvbihldmVudE5hbWUsIGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIHZhciBidWNrZXQgPSB0aGlzLl9fcHViU3ViQnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICBidWNrZXQuc3Vic2NyaWJlKGhhbmRsZXIsIGNvbnRleHQpO1xuICAgIH0sXG4gICAgb2ZmOiBmdW5jdGlvbihldmVudE5hbWUsIGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIHZhciBidWNrZXQgPSB0aGlzLl9fcHViU3ViQnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICBidWNrZXQudW5zdWJzY3JpYmUoaGFuZGxlciwgY29udGV4dCk7XG4gICAgfSxcbiAgICBub3RpZnk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgICAgICA9IF8udG9BcnJheShhcmd1bWVudHMpLFxuICAgICAgICAgIGV2ZW50TmFtZSA9IGFyZ3Muc2hpZnQoKTtcblxuICAgICAgdmFyIGJ1Y2tldCA9IHRoaXMuX19wdWJTdWJCdWNrZXQoZXZlbnROYW1lKTtcbiAgICAgIGJ1Y2tldC5ub3RpZnkoYXJncyk7XG4gICAgfSxcbiAgICBfX3B1YlN1YkJ1Y2tldDogZnVuY3Rpb24oZXZlbnROYW1lKSB7XG4gICAgICB0aGlzLl9fcHViU3ViRXZlbnRzID0gdGhpcy5fX3B1YlN1YkV2ZW50cyB8fCB7fTtcbiAgICAgIHRoaXMuX19wdWJTdWJFdmVudHNbZXZlbnROYW1lXSA9IHRoaXMuX19wdWJTdWJFdmVudHNbZXZlbnROYW1lXSB8fCBuZXcgRXZlbnRCdWNrZXQoZXZlbnROYW1lKTtcbiAgICAgIHJldHVybiB0aGlzLl9fcHViU3ViRXZlbnRzW2V2ZW50TmFtZV07XG4gICAgfVxuICB9O1xuXG4gIHZhciBFdmVudEJ1Y2tldCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEV2ZW50QnVja2V0LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xuICAgICAgdGhpcy5fZXZlbnROYW1lID0gZXZlbnROYW1lO1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IFtdO1xuICAgIH0sXG4gICAgc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICBpZiAoaGFuZGxlcikge1xuICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25zLnB1c2gobmV3IFN1YnNjcmlwdGlvbihoYW5kbGVyLCBjb250ZXh0KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdWJzY3JpcHRpb24gcmVxdWlyZXMgaGFuZGxlcjogXCIgKyB0aGlzLl9ldmVudE5hbWUpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uKGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIHZhciBzdWJzO1xuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgc3VicyA9IF8uZmlsdGVyKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHN1Yikge1xuICAgICAgICAgIHJldHVybiBzdWIubWF0Y2hlcyhoYW5kbGVyLCBjb250ZXh0KTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdWJzID0gdGhpcy5fc3Vic2NyaXB0aW9ucztcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKHN1YnMsIGZ1bmN0aW9uKHN1Yikge1xuICAgICAgICBzdWIuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBfLmRpZmZlcmVuY2UodGhpcy5fc3Vic2NyaXB0aW9ucywgc3Vicyk7XG4gICAgfSxcbiAgICBub3RpZnk6IGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIF8uaW52b2tlKHRoaXMuX3N1YnNjcmlwdGlvbnMsIFwibm90aWZ5XCIsIGFyZ3MpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN1YnNjcmlwdGlvbi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gaGFuZGxlcjtcbiAgICAgIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICAgIH0sXG4gICAgbWF0Y2hlczogZnVuY3Rpb24oaGFuZGxlciwgY29udGV4dCkge1xuICAgICAgaWYgKHRoaXMuX2NvbnRleHQpIHtcbiAgICAgICAgLy8gQ29tcGFyZSBjb250ZXh0IHJlZnMgYXMgcmVmcyBpZmYgd2UgaGF2ZSBhIGNvbnRleHQgb2JqZWN0XG4gICAgICAgIHJldHVybiAoaGFuZGxlciA9PT0gdGhpcy5faGFuZGxlciAmJiBjb250ZXh0ID09PSB0aGlzLl9jb250ZXh0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE90aGVyd2lzZSwganVzdCBtYWtlIHN1cmUgd2UgZG9uJ3QgaGF2ZSBhIGNvbnRleHQgKG51bGwgb3IgdW5kZWZpbmVkIGFyZSBmaW5lKVxuICAgICAgICByZXR1cm4gKGhhbmRsZXIgPT09IHRoaXMuX2hhbmRsZXIgJiYgIWNvbnRleHQpO1xuICAgICAgfVxuICAgIH0sXG4gICAgbm90aWZ5OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICAvLyBXZSBzaG91bGRuJ3QgYmUgY2FsbGVkIGFmdGVyIGRpc3Bvc2UsIGJ1dFxuICAgICAgLy8ganVzdCBpbiBjYXNlLi4uXG4gICAgICBpZiAodGhpcy5faGFuZGxlcikge1xuICAgICAgICB0aGlzLl9oYW5kbGVyLmFwcGx5KHRoaXMuX2NvbnRleHQsIGFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU29tZXRoaW5nIHdlbnQgd3JvbmcgaGVyZS4uLlxuICAgICAgfVxuICAgIH0sXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gbnVsbDtcbiAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xuICAgIH1cbiAgfSlcblxuICByZXR1cm4gUHViU3ViO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIGRvdWJseS1saW5rZWQgbGlzdCBpbXBsZW1lbnRhdGlvbi5cbiAgICpcbiAgICovXG4gIHZhciBEb3VibHlMaW5rZWRMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRG91Ymx5TGlua2VkTGlzdC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2Zyb250ID0gbnVsbDtcbiAgICAgIHRoaXMuX2JhY2sgPSBudWxsO1xuICAgICAgdGhpcy5fc2l6ZSA9IDA7XG4gICAgfSxcblxuICAgIGdldDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICB0aGlzLl9jaGVja0VsZW1lbnRJZHhPclRocm93KGlkeCk7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb0lkeChpZHgpO1xuICAgICAgcmV0dXJuIG5vZGUudmFsdWUoKTtcbiAgICB9LFxuXG4gICAgZXhpc3RzOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9WYWx1ZSh2YWx1ZSk7XG4gICAgICByZXR1cm4gISFub2RlO1xuICAgIH0sXG5cbiAgICBzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaXplO1xuICAgIH0sXG5cbiAgICBhZGQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGRCYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIGFkZEZyb250OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy5fbGlua0Zyb250KHZhbHVlKTtcbiAgICB9LFxuXG4gICAgYWRkQmFjazogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHRoaXMuX2xpbmtCYWNrKHZhbHVlKTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9WYWx1ZSh2YWx1ZSk7XG4gICAgICByZXR1cm4gdGhpcy5fdW5saW5rKG5vZGUpO1xuICAgIH0sXG5cbiAgICByZW1vdmVGcm9udDogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fZnJvbnQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gc3VjaCBlbGVtZW50XCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3VubGlua0Zyb250KHRoaXMuX2Zyb250KTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlQmFjazogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fYmFjayA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzdWNoIGVsZW1lbnRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fdW5saW5rQmFjayh0aGlzLl9iYWNrKTtcbiAgICB9LFxuXG4gICAgaW5zZXJ0QXRJbmRleDogZnVuY3Rpb24oaWR4LCB2YWx1ZSkge1xuICAgICAgdGhpcy5fY2hlY2tJc0VsZW1lbnRQb3NpdGlvbk9yVGhyb3coaWR4KTtcblxuICAgICAgaWYgKGlkeCA9PT0gdGhpcy5fc2l6ZSkge1xuICAgICAgICB0aGlzLmFkZEJhY2sodmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9JZHgoaWR4KTtcbiAgICAgICAgdGhpcy5fbGlua0JlZm9yZSh2YWx1ZSwgbm9kZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZUF0SW5kZXg6IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgdGhpcy5fY2hlY2tFbGVtZW50SWR4T3JUaHJvdyhpZHgpO1xuICAgICAgaWYgKGlkeCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdW5saW5rRnJvbnQodGhpcy5fZnJvbnQpO1xuICAgICAgfSBlbHNlIGlmICggaWR4ID09PSAodGhpcy5fc2l6ZSAtIDEpICkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdW5saW5rQmFjayh0aGlzLl9iYWNrKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBub2RlID0gdGhpcy5fd2Fsa1RvSWR4KGlkeCk7XG4gICAgICAgIHJldHVybiB0aGlzLl91bmxpbmsobm9kZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBub2RlID0gdGhpcy5fZnJvbnQsXG4gICAgICAgICAgbmV4dDtcblxuICAgICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgICAgbmV4dCA9IG5vZGUubmV4dCgpO1xuICAgICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgICAgbm9kZSA9IG5leHQ7XG4gICAgICB9XG4gICAgICB0aGlzLl9mcm9udCA9IG51bGw7XG4gICAgICB0aGlzLl9iYWNrICA9IG51bGw7XG4gICAgICB0aGlzLl9zaXplID0gMDtcbiAgICB9LFxuXG4gICAgX2xpbmtGcm9udDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBvbGRGcm9udCA9IHRoaXMuX2Zyb250LFxuICAgICAgICAgIG5ld05vZGUgPSBuZXcgTm9kZSh7dmFsdWU6IHZhbHVlfSk7XG4gICAgICB0aGlzLl9mcm9udCA9IG5ld05vZGU7XG5cbiAgICAgIGlmIChvbGRGcm9udCA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9iYWNrID0gbmV3Tm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9sZEZyb250LnNldFByZXYobmV3Tm9kZSk7XG4gICAgICAgIG5ld05vZGUuc2V0TmV4dChvbGRGcm9udCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3NpemUrKztcbiAgICAgIHJldHVybiBuZXdOb2RlO1xuICAgIH0sXG5cbiAgICBfbGlua0JhY2s6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgb2xkQmFjayA9IHRoaXMuX2JhY2ssXG4gICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlKHt2YWx1ZTogdmFsdWV9KTtcblxuICAgICAgdGhpcy5fYmFjayA9IG5ld05vZGU7XG4gICAgICBpZiAob2xkQmFjayA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG5ld05vZGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbGRCYWNrLnNldE5leHQobmV3Tm9kZSk7XG4gICAgICAgIG5ld05vZGUuc2V0UHJldihvbGRCYWNrKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc2l6ZSsrO1xuICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgfSxcblxuICAgIF9saW5rQmVmb3JlOiBmdW5jdGlvbih2YWx1ZSwgbm9kZSkge1xuICAgICAgdmFyIHByZWQgICAgPSBub2RlLnByZXYoKSxcbiAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUoe3ZhbHVlOiB2YWx1ZSwgcHJldjogcHJlZCwgbmV4dDogbm9kZX0pO1xuXG4gICAgICBub2RlLnNldFByZXYobmV3Tm9kZSk7XG4gICAgICBpZiAocHJlZCA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG5ld05vZGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmVkLnNldE5leHQobmV3Tm9kZSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zaXplKys7XG4gICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICB9LFxuXG4gICAgX3VubGlua0Zyb250OiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB2YXIgdmFsdWUgICAgPSBub2RlLnZhbHVlKCksXG4gICAgICAgICAgbmV3RnJvbnQgPSBub2RlLm5leHQoKTtcblxuICAgICAgbm9kZS5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9mcm9udCA9IG5ld0Zyb250O1xuICAgICAgaWYgKG5ld0Zyb250ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2JhY2sgPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3RnJvbnQuc2V0UHJldihudWxsKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NpemUtLTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgX3VubGlua0JhY2s6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciB2YWx1ZSAgID0gbm9kZS52YWx1ZSgpLFxuICAgICAgICAgIG5ld0JhY2sgPSBub2RlLnByZXYoKTtcblxuICAgICAgbm9kZS5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9iYWNrID0gbmV3QmFjaztcbiAgICAgIGlmIChuZXdCYWNrID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fZnJvbnQgPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3QmFjay5zZXROZXh0KG51bGwpO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2l6ZS0tO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBfdW5saW5rOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB2YXIgcHJldiAgPSBub2RlLnByZXYoKSxcbiAgICAgICAgICBuZXh0ICA9IG5vZGUubmV4dCgpLFxuICAgICAgICAgIHZhbHVlID0gbm9kZS52YWx1ZSgpO1xuXG4gICAgICBpZiAocHJldiA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG5leHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcmV2LnNldE5leHQobmV4dCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChuZXh0ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2JhY2sgPSBwcmV2O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dC5zZXRQcmV2KHByZXYpO1xuICAgICAgfVxuXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX3NpemUtLTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgX3dhbGtUb0lkeDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICB2YXIgbm9kZSwgY3VycmVudDtcbiAgICAgIGlmIChpZHggPCB0aGlzLl9zaXplIC8gMikge1xuICAgICAgICBub2RlID0gdGhpcy5fZnJvbnQ7XG4gICAgICAgIGN1cnJlbnQgPSAwO1xuICAgICAgICB3aGlsZShjdXJyZW50ICE9PSBpZHgpIHtcbiAgICAgICAgICBub2RlID0gbm9kZS5uZXh0KCk7XG4gICAgICAgICAgY3VycmVudCsrO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlID0gdGhpcy5fYmFjaztcbiAgICAgICAgY3VycmVudCA9IHRoaXMuX3NpemUgLSAxO1xuXG4gICAgICAgIHdoaWxlKGN1cnJlbnQgIT09IGlkeCkge1xuICAgICAgICAgIG5vZGUgPSBub2RlLnByZXYoKTtcbiAgICAgICAgICBjdXJyZW50LS07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBub2RlO1xuICAgIH0sXG5cbiAgICBfd2Fsa1RvVmFsdWU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbiA9IHRoaXMuX2Zyb250O1xuICAgICAgd2hpbGUgKG4gIT09bnVsbCApIHtcbiAgICAgICAgaWYgKG4ubWF0Y2godmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH1cbiAgICAgICAgbiA9IG4ubmV4dCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9pc0VsZW1lbnRJZHg6IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgcmV0dXJuIChpZHggPj0gMCAmJiBpZHggPCB0aGlzLl9zaXplKTtcbiAgICB9LFxuXG4gICAgX2lzRWxlbWVudFBvc2l0aW9uOiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIHJldHVybiAoaWR4ID49IDAgJiYgaWR4IDw9IHRoaXMuX3NpemUpO1xuICAgIH0sXG5cbiAgICBfY2hlY2tFbGVtZW50SWR4T3JUaHJvdzogZnVuY3Rpb24oaWR4KSB7XG4gICAgICBpZiAoIXRoaXMuX2lzRWxlbWVudElkeChpZHgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHM7IHNpemU6IFwiICsgdGhpcy5fc2l6ZSArIFwiOyBpZHg6IFwiICsgaWR4KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgX2NoZWNrSXNFbGVtZW50UG9zaXRpb25PclRocm93OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIGlmICghdGhpcy5faXNFbGVtZW50UG9zaXRpb24oaWR4KSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzOyBzaXplOiBcIiArIHRoaXMuX3NpemUgKyBcIjsgaWR4OiBcIiArIGlkeCk7XG4gICAgICB9XG4gICAgfVxuXG4gIH0pO1xuXG4gIHZhciBOb2RlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTm9kZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzICAgICAgICA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX25leHQgID0gb3B0cy5nZXRPckVsc2UoXCJuZXh0XCIsIG51bGwpO1xuICAgICAgdGhpcy5fcHJldiAgPSBvcHRzLmdldE9yRWxzZShcInByZXZcIiwgbnVsbCk7XG4gICAgICB0aGlzLl92YWx1ZSA9IG9wdHMuZ2V0T3JFbHNlKFwidmFsdWVcIiwgbnVsbCk7XG4gICAgfSxcblxuICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX25leHQ7XG4gICAgfSxcblxuICAgIHByZXY6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ByZXY7XG4gICAgfSxcblxuICAgIHNldE5leHQ6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHRoaXMuX25leHQgPSBub2RlO1xuICAgIH0sXG5cbiAgICBzZXRQcmV2OiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB0aGlzLl9wcmV2ID0gbm9kZTtcbiAgICB9LFxuXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX25leHQgID0gbnVsbDtcbiAgICAgIHRoaXMuX3ByZXYgID0gbnVsbDtcbiAgICAgIHRoaXMuX3ZhbHVlID0gbnVsbDtcbiAgICB9LFxuXG4gICAgbWF0Y2g6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWUgPT09IHZhbHVlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIERvdWJseUxpbmtlZExpc3Q7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIERlbGVnYXRlcyBzdG9yYWdlIHRvIGEgSlMgb2JqZWN0LlxuICAgKi9cbiAgdmFyIE9iamVjdEhhc2hNYXAgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuXG4gIF8uZXh0ZW5kKE9iamVjdEhhc2hNYXAucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3N0b3JlID0ge307XG4gICAgICB0aGlzLl9rZXlQcmVmaXggPSBvcHRzLmdldE9yRWxzZShcImtleVByZWZpeFwiLCBcIm9obS1cIik7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uKGtleSl7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmVbdGhpcy5fbWFrZUtleShrZXkpXTtcbiAgICB9LFxuICAgIHB1dDogZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHRoaXMuX3N0b3JlW3RoaXMuX21ha2VLZXkoa2V5KV0gPSB2YWw7XG4gICAgfSxcbiAgICByZW1vdmU6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIHZhbDtcbiAgICAgIGtleSA9IHRoaXMuX21ha2VLZXkoa2V5KTtcbiAgICAgIGlmIChfLmhhcyh0aGlzLl9zdG9yZSwga2V5KSkge1xuICAgICAgICB2YWwgPSB0aGlzLl9zdG9yZVtrZXldO1xuICAgICAgICBkZWxldGUgdGhpcy5fc3RvcmVba2V5XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWw7XG4gICAgfSxcbiAgICBleGlzdHM6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIF8uaGFzKHRoaXMuX3N0b3JlLCB0aGlzLl9tYWtlS2V5KGtleSkpO1xuICAgIH0sXG4gICAgc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy5zaXplKHRoaXMuX3N0b3JlKTtcbiAgICB9LFxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3N0b3JlID0ge307XG4gICAgfSxcbiAgICBrZXlzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfXG4gICAgICAgIC5jaGFpbih0aGlzLl9zdG9yZSlcbiAgICAgICAgLmtleXMoKVxuICAgICAgICAubWFwKF8uYmluZChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdW5tYWtlS2V5KGtleSk7XG4gICAgICAgIH0sIHRoaXMpKVxuICAgICAgICAudmFsdWUoKTtcbiAgICB9LFxuICAgIHZhbHVlczogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy52YWx1ZXModGhpcy5fc3RvcmUpO1xuICAgIH0sXG4gICAgX21ha2VLZXk6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2tleVByZWZpeCArIGtleTtcbiAgICB9LFxuICAgIF91bm1ha2VLZXk6IGZ1bmN0aW9uKG1hZGVLZXkpIHtcbiAgICAgIHJldHVybiBtYWRlS2V5LnN1YnN0cih0aGlzLl9rZXlQcmVmaXgubGVuZ3RoKTtcbiAgICB9XG4gIH0pO1xuXG5cbiAgcmV0dXJuIE9iamVjdEhhc2hNYXA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9ucyxcbiAgT2JqZWN0SGFzaE1hcFxuKSB7XG5cbiAgdmFyIERFRkFVTFRfREVGQVVMVF9GTiA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIHZhciBEZWZhdWx0aW5nSGFzaG1hcCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKERlZmF1bHRpbmdIYXNobWFwLnByb3RvdHlwZSwgT2JqZWN0SGFzaE1hcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBPYmplY3RIYXNoTWFwLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fZGVmYXVsdEZuID0gb3B0cy5nZXRPckVsc2UoXCJkZWZhdWx0Rm5cIiwgREVGQVVMVF9ERUZBVUxUX0ZOKTtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24oa2V5KSB7XG4gICAgICB2YXIgcmVhbEtleSA9IHRoaXMuX21ha2VLZXkoa2V5KTtcbiAgICAgIHZhciB2ID0gdGhpcy5fc3RvcmVbcmVhbEtleV07XG4gICAgICBpZiAodHlwZW9mIHYgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgdiA9IHRoaXMuX3N0b3JlW3JlYWxLZXldID0gdGhpcy5fZGVmYXVsdEZuKGtleSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdjtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWZhdWx0aW5nSGFzaG1hcDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vb2JqZWN0LWhhc2gtbWFwXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIERlZmF1bHRpbmdIYXNoTWFwXG4pIHtcblxuICB2YXIgTXVsdGlNYXAgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChNdWx0aU1hcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3N0b3JlID0gbmV3IERlZmF1bHRpbmdIYXNoTWFwKHtcbiAgICAgICAgZGVmYXVsdEZuOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZS5nZXQoa2V5KTtcbiAgICB9LFxuICAgIHB1dDogZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHZhciB2ID0gdGhpcy5fc3RvcmUuZ2V0KGtleSk7XG4gICAgICB2LnB1c2godmFsKTtcbiAgICB9LFxuICAgIHJlbW92ZTogZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHZhciB2ID0gdGhpcy5fc3RvcmUuZ2V0KGtleSk7XG4gICAgICB2YXIgaWR4ID0gdi5pbmRleE9mKHZhbCk7XG4gICAgICBpZiAoaWR4ICE9PSAtMSkge1xuICAgICAgICB2LnNwbGljZShpZHgsIDEpO1xuICAgICAgICByZXR1cm4gdjtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfSxcbiAgICByZW1vdmVBbGw6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIHYgPSB0aGlzLl9zdG9yZS5nZXQoa2V5KTtcbiAgICAgIHRoaXMuX3N0b3JlLnJlbW92ZShrZXkpO1xuICAgICAgcmV0dXJuIHY7XG4gICAgfSxcbiAgICBleGlzdHM6IGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmUuZXhpc3RzKGtleSkgJiYgXy5jb250YWlucyh0aGlzLl9zdG9yZS5nZXQoa2V5KSwgdmFsKVxuICAgIH0sXG4gICAga2V5czogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmUua2V5cygpO1xuICAgIH0sXG4gICAgdmFsdWVzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfXG4gICAgICAgIC5jaGFpbih0aGlzLl9zdG9yZS5rZXlzKCkpXG4gICAgICAgIC5tYXAoXy5iaW5kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9zdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSwgdGhpcykpXG4gICAgICAgIC5mbGF0dGVuKClcbiAgICAgICAgLnZhbHVlKCk7XG4gICAgfSxcbiAgICBzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBfLnNpemUodGhpcy52YWx1ZXMoKSk7XG4gICAgfSxcbiAgICBjbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zdG9yZS5jbGVhcigpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIE11bHRpTWFwO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi9kZWZhdWx0aW5nLWhhc2gtbWFwXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIE9iamVjdEhhc2hNYXAsXG4gIERvdWJseUxpbmtlZExpc3Rcbikge1xuXG4gIC8qKlxuICAgKiBBbiBpbi1tZW1vcnkgaGFzaCBtYXAgd2l0aCBhbiBMUlUgZXZpY3Rpb24gcG9saWN5LlxuICAgKlxuICAgKi9cbiAgdmFyIExSVUhhc2hNYXAgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMUlVIYXNoTWFwLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jYXBhY2l0eSA9IG9wdHMuZ2V0T3JFcnJvcihcImNhcGFjaXR5XCIpO1xuICAgICAgdGhpcy5fa2V5QWNjZXNzTGlzdCA9IG5ldyBEb3VibHlMaW5rZWRMaXN0KCk7XG4gICAgICAvLyBUT0RPOiBSZWFsbHkgbmVlZCBhIHByb3BlciBIYXNoTWFwIGF0IHNvbWUgcG9pbnQuLi5cbiAgICAgIHRoaXMuX3N0b3JlID0gbmV3IE9iamVjdEhhc2hNYXAoKTtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24oa2V5KSB7XG4gICAgICB2YXIgZW50cnkgPSB0aGlzLl9zdG9yZS5nZXQoa2V5KTtcbiAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBBcyBhIHBlcmYgb3B0aW1pemF0aW9uLCB3ZSBrZWVwIGEgcmVmXG4gICAgICAvLyB0byB0aGUgbm9kZSBpbiB0aGUgZW50cnkuXG4gICAgICB2YXIgbm9kZSA9IGVudHJ5Lm5vZGUoKTtcbiAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QuX3VubGluayhub2RlKTtcblxuICAgICAgLy8gR2V0IHRoZSBuZXcgbm9kZVxuICAgICAgbm9kZSA9IHRoaXMuX2tleUFjY2Vzc0xpc3QuX2xpbmtGcm9udChlbnRyeS5rZXkoKSk7XG5cbiAgICAgIC8vIFNhdmUgaXRcbiAgICAgIGVudHJ5LnNldE5vZGUobm9kZSk7XG4gICAgICAvLyBSZXR1cm4gdGhlIHZhbHVlXG4gICAgICByZXR1cm4gZW50cnkudmFsdWUoKTtcbiAgICB9LFxuXG4gICAgcHV0OiBmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fc3RvcmUuZ2V0KGtleSksXG4gICAgICAgICAgbm9kZTtcbiAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgLy8gSWYgbm8gZW50cnksIG1ha2UgYSBuZXcgZW50cnlcbiAgICAgICAgaWYgKHRoaXMuX2tleUFjY2Vzc0xpc3Quc2l6ZSgpID49IHRoaXMuX2NhcGFjaXR5KSB7XG4gICAgICAgICAgLy8gSGF2ZSB0byBtYWtlIHJvb20gZm9yIGl0XG4gICAgICAgICAgdmFyIGV2aWN0ZWRLZXkgPSB0aGlzLl9rZXlBY2Nlc3NMaXN0LnJlbW92ZUJhY2soKSxcbiAgICAgICAgICAgICAgZXZpY3RlZEVudHJ5ID0gdGhpcy5fc3RvcmUuZ2V0KGV2aWN0ZWRLZXkpO1xuXG4gICAgICAgICAgZXZpY3RlZEVudHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgICB0aGlzLl9zdG9yZS5yZW1vdmUoZXZpY3RlZEtleSk7XG4gICAgICAgIH1cblxuICAgICAgICBub2RlID0gdGhpcy5fa2V5QWNjZXNzTGlzdC5fbGlua0Zyb250KGtleSk7XG4gICAgICAgIGVudHJ5ID0gbmV3IEVudHJ5KHtcbiAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICB2YWx1ZTogdmFsLFxuICAgICAgICAgIG5vZGU6IG5vZGVcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3N0b3JlLnB1dChrZXksIGVudHJ5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFwiVG91Y2hcIiB0aGUgZW50cnksIHNldCBuZXcgdmFsdWVcbiAgICAgICAgbm9kZSA9IGVudHJ5Lm5vZGUoKTtcbiAgICAgICAgdGhpcy5fa2V5QWNjZXNzTGlzdC5fdW5saW5rKG5vZGUpO1xuICAgICAgICBub2RlID0gdGhpcy5fa2V5QWNjZXNzTGlzdC5fbGlua0Zyb250KGVudHJ5LmtleSgpKTtcbiAgICAgICAgLy8gVXBkYXRlIHdpdGggdGhlIG5ldyBub2RlIGFuZCB2YWx1ZVxuICAgICAgICBlbnRyeS5zZXROb2RlKG5vZGUpO1xuICAgICAgICBlbnRyeS5zZXRWYWx1ZSh2YWwpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICByZW1vdmU6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fc3RvcmUuZ2V0KGtleSksXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgbm9kZTtcbiAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICB2YWx1ZSA9IGVudHJ5LnZhbHVlKCk7XG4gICAgICAgIG5vZGUgPSBlbnRyeS5ub2RlKCk7XG4gICAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QuX3VubGluayhub2RlKTtcbiAgICAgICAgZW50cnkuZGlzcG9zZSgpO1xuICAgICAgICB0aGlzLl9zdG9yZS5yZW1vdmUoa2V5KTtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBleGlzdHM6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0b3JlLmV4aXN0cyhrZXkpO1xuICAgIH0sXG5cbiAgICBzaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZS5zaXplKCk7XG4gICAgfSxcblxuICAgIGNsZWFyOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3N0b3JlLmNsZWFyKCk7XG4gICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0LmNsZWFyKCk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgRW50cnkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChFbnRyeS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgLy8gVGhvdWdoIHRoZSBOb2RlIHNob3VsZCBoYXZlIHRoZSBrZXksIGlmIHRoZSBub2RlXG4gICAgICAvLyBpcyB1bmxpbmtlZCBmcm9tIHRoZSBsaXN0LCBpdHMgYm94ZWQgdmFsdWUgd2lsbCBkaXNhcHBlYXJcbiAgICAgIHRoaXMuX2tleSAgID0gb3B0cy5nZXRPckVycm9yKFwia2V5XCIpO1xuICAgICAgdGhpcy5fdmFsdWUgPSBvcHRzLmdldE9yRXJyb3IoXCJ2YWx1ZVwiKTtcbiAgICAgIHRoaXMuX25vZGUgID0gb3B0cy5nZXRPckVycm9yKFwibm9kZVwiKTtcbiAgICB9LFxuICAgIG5vZGU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX25vZGU7XG4gICAgfSxcbiAgICBzZXROb2RlOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICB0aGlzLl9ub2RlID0gbm9kZTtcbiAgICB9LFxuICAgIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9LFxuICAgIHNldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGtleTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fa2V5O1xuICAgIH0sXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9rZXkgPSBudWxsO1xuICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xuICAgICAgdGhpcy5fbm9kZSA9IG51bGw7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gTFJVSGFzaE1hcDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vb2JqZWN0LWhhc2gtbWFwXCIpLFxuICByZXF1aXJlKFwiLi9kb3VibHktbGlua2VkLWxpc3RcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgSW5NZW1vcnlEYXRhU3RvcmUsXG4gIFVuaXRTZXF1ZW5jZXIsXG4gIEVudHJ5XG4pIHtcblxuICAvLyBBcHByb3ByaWF0ZSBmb3IgdGhlIGRlZmF1bHQgc2VxdWVuY2VyIChub24tdGVtcG9yYWwpXG4gIHZhciBERUZBVUxUX1RUTCA9IDE7XG5cblxuICAvKipcbiAgICogQSBsb29rLWFzaWRlIGNhY2hpbmcgZGF0YSBzdG9yZS4gTm90ZTogaXQncyBnZW5lcmFsbHkgbm90IHVzZWZ1bCB0byBhbGxvd1xuICAgKiBudWxsL3VuZGVmaW5lZCBzdG9yZWQgdmFsdWVzLiBXaGVuIGFuIGl0ZW0gaXMgZXZpY3RlZCBmcm9tIHRoZSBjYWNoZSwgYVxuICAgKiBzdWJzZXF1ZW50IGBnZXRgIGNhbGwgd2lsbCByZXR1cm4gYHVuZGVmaW5lZGAsIHNvIGl0IGNhbiBiZSBkaWZmaWN1bHQgdG9cbiAgICogZGV0ZXJtaW5lIGlmIHRoZXJlIHdhcyBhIGNhY2hlIG1pc3MgaWYgdGhlIHZhbHVlIHlvdSdyZSBzdG9yaW5nIGlzLCBpbiBmYWN0LFxuICAgKiBgdW5kZWZpbmVkYCwgdW5sZXNzIHlvdSBwcmVmaXggZXZlcnkgY2hlY2sgd2l0aCBgZXhpc3RzYCwgd2hpY2ggYWxzbyBkb2VzXG4gICAqIGNhY2hlIGV2aWN0aW9uIG9uIGNoZWNrLlxuICAgKi9cbiAgdmFyIENhY2hpbmdEYXRhU3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDYWNoaW5nRGF0YVN0b3JlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl90dGwgPSBvcHRzLmdldE9yRWxzZShcInR0bFwiLCBERUZBVUxUX1RUTCk7XG5cbiAgICAgIC8vIERlZmF1bHQgc2VxdWVuY2VyIGlzIGEgbGluZWFyL3VuaXQgc2VxdWVuY2VyLiBUaGUgZGVmYXVsdCBUVEwgaXNcbiAgICAgIC8vIDEuIFRoZXJlZm9yZSwgYWxsIHZhbHVlcyB3aWxsIGV4cGlyZSB3aXRoIHNpbmdsZSBhZHZhbmNlIG9mIHRoZVxuICAgICAgLy8gc2VxdWVuY2VyLiBOb3RlIHRoYXQgdGhlIGRhdGEgc3RvcmUgZG9lc24ndCBhZHZhbmNlIHRoZVxuICAgICAgLy8gc2VxdWVuY2VyIGl0c2VsZi4gVGhlIHN0b3JlIG93bmVyIGlzIHJlc3BvbnNpYmxlIGZvciBkb2luZ1xuICAgICAgLy8gdGhpcy5cbiAgICAgIC8vXG4gICAgICAvLyBUaGlzIGlzIGVzcGVjaWFsbHkgaW1wb3J0YW50IHRvIG5vdGUgZm9yIHRpbWUtYmFzZWQgc2VxdWVuY2Vycy5cbiAgICAgIC8vIFRpbWUgd2lsbCBub3QgYWR2YW5jZSBhdXRvbWF0aWNhbGx5LiBUaGUgc3RvcmUgb3duZXIgaXMgcmVzcG9uc2libGVcbiAgICAgIC8vIGZvciBzY2hlZHVsaW5nIHRoZSBzZXF1ZW5jZXIgdG8gYWR2YW5jZSB3aXRoIHRpbWUuIFRoaXMga2VlcHMgdGhlXG4gICAgICAvLyBDYWNoaW5nRGF0YVN0b3JlJ3MgbGlmZWN5Y2xlIHNpbXBsZSB3aXRoIHJlc3BlY3QgdG8gdGltZS5cbiAgICAgIHRoaXMuX3NlcXVlbmNlciA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJzZXF1ZW5jZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgVW5pdFNlcXVlbmNlcigpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEJ5IGRlZmF1bHQsIHdlIGRlbGVnYXRlIHRvIGFuIGluLW1lbW9yeSBzdG9yZS4gRmluZSBmb3Igc2ltcGxlXG4gICAgICAvLyBjYXNlcywgYnV0IG5vdCBvcHRpbWFsLlxuICAgICAgdGhpcy5fYmFja2luZ1N0b3JlID0gb3B0cy5nZXRPckVsc2VGbihcImJhY2tpbmdTdG9yZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbk1lbW9yeURhdGFTdG9yZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZXMgdGhlIGxhc3RVcGRhdGVkIHRpbWUgdG8gXCJub3dcIiBvbiByZWFkIC0ga2VlcHMgZW50cmllc1xuICAgICAgLy8gZnJvbSBleHBpcmluZyB3aGVuIHRoZXkncmUgYmVpbmcgYWNjZXNzZWQsIGJ1dCBjYW4gY2F1c2VcbiAgICAgIC8vIHN0YWxlbmVzcyBpc3N1ZXMuXG4gICAgICB0aGlzLl9zaG91bGRUb3VjaE9uUmVhZCA9IG9wdHMuZ2V0T3JFbHNlKFwidG91Y2hPblJlYWRcIiwgZmFsc2UpO1xuICAgIH0sXG5cbiAgICBzZXF1ZW5jZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlcjtcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGtleS4gSWYgdGhlIG9iamVjdCBoYXNcbiAgICAgKiBleHBpcmVkLCBpdCB3aWxsIGJlIGV2aWN0ZWQgZnJvbSB0aGUgY2FjaGUsIGFuZCBgdW5kZWZpbmVkYCB3aWxsXG4gICAgICogYmUgcmV0dXJuZWQgaW5zdGVhZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkge3N0cmluZ30gKHJlcXVpcmVkKVxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IHJlcXVlc3RlZCB2YWx1ZVxuICAgICAqL1xuICAgIGdldDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSl7XG4gICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghZW50cnkuaXNFeHBpcmVkKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLCB0aGlzLl90dGwpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc2hvdWxkVG91Y2hPblJlYWQpIHtcbiAgICAgICAgICAgICAgZW50cnkudG91Y2godGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5wdXQoa2V5LCBlbnRyeSk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5yZXR1cm4oZW50cnkudmFsdWUoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW92ZShrZXkpXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIC50aGVuUmV0dXJuIGlzIGEgbGllLlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIFN0b3JlcyB0aGUgcHJvdmlkZWQgYHZhbGAsIGlkZW50aWZpZWQgYnkgYGtleWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBga2V5YCB7c3RyaW5nfSAgKHJlcXVpcmVkKSBpZGVudGlmaWVyIGZvciB2YWx1ZSB0byBiZSBzdG9yZWRcbiAgICAgKiBAcGFyYW0gYHZhbGAge2R5bmFtaWN9IChyZXF1aXJlZCkgdmFsdWUgdG8gYmUgc3RvcmVkXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8Pn1cbiAgICAgKi9cbiAgICBwdXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIC8vIElmIHdlIGhhdmUgYW4gZW50cnksIHdlIHNob3VsZCBqdXN0IHVwZGF0ZVxuICAgICAgICAgIC8vIEVsc2UsIHdlIG1ha2UgbmV3IG9uZS5cbiAgICAgICAgICAvLyBQZXNpc3QsIHRoZW4gcmV0dXJuIG5vdGhpbmcuXG4gICAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICBlbnRyeS51cGRhdGUodmFsLCB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVudHJ5ID0gbmV3IEVudHJ5KHtcbiAgICAgICAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgICAgICAgaW5pdGlhbFNlcXVlbmNlOiB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5wdXQoa2V5LCBlbnRyeSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBga2V5YFxuICAgICAqXG4gICAgICogQHBhcmFtIGBrZXlgIHtzdHJpbmd9IChyZXF1aXJlZCkgaWRlbnRpZmllciBmb3IgdmFsdWUgdG8gYmUgcmVtb3ZlZFxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGR5bmFtaWM+fSBSZW1vdmVkIHZhbHVlLCBpZiBwcmVzZW50IGluIHN0b3JlLlxuICAgICAqL1xuICAgIHJlbW92ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KSB7XG4gICAgICB2YXIgdmFsO1xuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZVxuICAgICAgICAucmVtb3ZlKGtleSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgIHZhbCA9IGVudHJ5LnZhbHVlKCk7XG4gICAgICAgICAgICBlbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICBleGlzdHM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICAvLyBJdCdzIG5vdCBzdWZmaWNpZW50IHRvIGRlbGVnYXRlIHRoaXMgY2FsbCB0byB0aGUgdW5kZXJseWluZ1xuICAgICAgLy8gYmFja2luZyBzdG9yZS4gV2UgbmVlZCB0byBwZXJmb3JtIGV2aWN0aW9uLCBhcyBhIHN1YnNlcXVlbnQgY2FsbFxuICAgICAgLy8gdG8gZ2V0IHdvdWxkIGRvIHRoZSBzYW1lLiBJZiB0aGUgYGV4aXN0c2AgY2hlY2sgc2F5cyBpdCBleGlzdHMsXG4gICAgICAvLyBiZXQgaXQgZG9lc24ndCB3aGVuIHdlIGBnZXRgLCB0aGVuIGBleGlzdHNgIGlzIGEgd29ydGhsZXNzIG9wZXJhdGlvbi5cbiAgICAgIC8vXG4gICAgICAvLyBOb3RlIHRoYXQgaWYgeW91J3JlIHVzaW5nIGEgQ2FjaGluZ0RhdGFTdG9yZSBiYWNrZWQgYnkgYW4gSW5NZW1vcnlEYXRhU3RvcmVcbiAgICAgIC8vIGJhY2tlZCBieSBhbiBMUlVIYXNoTWFwLCB0aGlzIHdpbGwgY2F1c2UgdGhlIGVudHJ5IHRvIGJlIFwidG91Y2hlZFwiLCB3aGVyZWFzXG4gICAgICAvLyBhIG5vcm1hbCBcImV4aXN0c1wiIGNoZWNrIHdvdWxkIG5vdC5cbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmICghZW50cnkuaXNFeHBpcmVkKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLCB0aGlzLl90dGwpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5yZW1vdmUoa2V5KVxuICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAudGhlblJldHVybihmYWxzZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICBjbGVhcjogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmNsZWFyKCk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIENhY2hpbmdEYXRhU3RvcmU7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9pbi1tZW1vcnktZGF0YS1zdG9yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi9pbnRlcm5hbHMvZXhwaXJpbmctZW50cnlcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgT2JqZWN0SGFzaE1hcFxuKSB7XG5cbiAgLyoqXG4gICAqIEluTWVtb3J5RGF0YVN0b3JlIGRlbGVnYXRlcyB0byBhIGJhY2tpbmcgSGFzaE1hcC4gQnkgZGVmYXVsdCwgdGhpc1xuICAgKiB3aWxsIGJlIGEgXCJwb29yIG1hbidzIEhhc2hNYXBcIiwgYS5rLmEuLCB0aGUgT2JqZWN0SGFzaE1hcC5cbiAgICovXG4gIHZhciBJbk1lbW9yeURhdGFTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEluTWVtb3J5RGF0YVN0b3JlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9tYXAgPSBvcHRzLmdldE9yRWxzZUZuKFwiYmFja2luZ0hhc2hNYXBcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JqZWN0SGFzaE1hcCgpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGdldDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLmdldChrZXkpO1xuICAgIH0pLFxuXG4gICAgcHV0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5wdXQoa2V5LCB2YWwpO1xuICAgIH0pLFxuXG4gICAgcmVtb3ZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXAucmVtb3ZlKGtleSk7XG4gICAgfSksXG5cbiAgICBleGlzdHM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLmV4aXN0cyhrZXkpO1xuICAgIH0pLFxuXG4gICAgY2xlYXI6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5jbGVhcigpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBJbk1lbW9yeURhdGFTdG9yZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29sbGVjdGlvbi9vYmplY3QtaGFzaC1tYXBcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9ucyxcbiAgSW5NZW1vcnlEYXRhU3RvcmUsXG4gIExSVUhhc2hNYXBcbikge1xuXG4gIC8qKlxuICAgKiBBIERhdGEgU3RvcmUgd2l0aCBhbiBMUlUgZXZpY3Rpb24gcG9saWN5LlxuICAgKlxuICAgKi9cbiAgdmFyIExSVURhdGFTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExSVURhdGFTdG9yZS5wcm90b3R5cGUsIEluTWVtb3J5RGF0YVN0b3JlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgbWFwID0gbmV3IExSVUhhc2hNYXAoe1xuICAgICAgICBjYXBhY2l0eTogb3B0cy5nZXRPckVycm9yKFwiY2FwYWNpdHlcIilcbiAgICAgIH0pO1xuICAgICAgSW5NZW1vcnlEYXRhU3RvcmUucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCB7XG4gICAgICAgIGJhY2tpbmdIYXNoTWFwOiBtYXBcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIExSVURhdGFTdG9yZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWRhdGEtc3RvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb2xsZWN0aW9uL2xydS1oYXNoLW1hcFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBDaGFubmVsLFxuICBDaGFpbmVkQ2hhbm5lbCxcbiAgVW5pdFNlcXVlbmNlcixcbiAgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIsXG4gIEluTWVtb3J5RGF0YVN0b3JlLFxuICBFbnRyeVxuKSB7XG5cbiAgLyoqXG4gICAqIFNlbWFudGljYWxseSBzaW1pbGFyIHRvIGEgQ2FjaGluZ0RhdGFTdG9yZSwgZXhjZXB0OlxuICAgKiAgIDEpIEV4cGlyeSBpcyBjaGVjayBib3RoIG9uIGFjY2VzcywgYW5kIHdoZW5ldmVyIGBhZHZhbmNlYCBpc1xuICAgKiAgICAgIGNhbGxlZCBvbiB0aGUgYHNlbnRyeVNlcXVlbmNlcmAuXG4gICAqICAgMikgUmVjb3JkcyBhcmUgbm90IGF1dG9tYXRpY2FsbHkgcmVtb3ZlZDsgaW5zdGVhZCwgYSBzaWduYWwgaXMgc2VudFxuICAgKiAgICAgIGFsb25nIHRoZSBgc2lnbmFsQ2hhbm5lbGAuIFRoZSBzaWduYWwgZGlzcGF0Y2ggaXMgZGVmZXJyZWQsIHNvXG4gICAqICAgICAgYW4gYWNjZXNzLXRyaWdnZXJlZCBldm9jYXRpb24gc2lnbmFsIHdvbid0IGJlIHJlY2VpdmVkIHVudGlsIGFcbiAgICogICAgICBzdWJzZXF1ZW50IHRpY2suIFNpbmNlIHByb21pc2VzIGFyZSBhc3luY2hyb25vdXMsIHRoaXMgbWVhbnNcbiAgICogICAgICB0aGUgY2FsbGVyIG1heSByZWNlaXZlIGEgdmFsdWUgZnJvbSB0aGUgc3RvcmUsIGFuZCBtYXkgYWxzb1xuICAgKiAgICAgIHJlY2VpdmUgYW4gZXZlbnQgZnJvbSB0aGUgU3RvcmUgaW5kaWNhdGluZyBleHBpcnkgLSBpbiBub24tZGV0ZXJtaW5pc3RpY1xuICAgKiAgICAgIG9yZGVyLiBJdCdzIHVwIHRvIHRoZSBjYWxsZXIgdG8gY2hvb3NlIGEgcmVzb2x1dGlvbi5cbiAgICogICAgICBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIG5vIGd1YXJhbnRlZSB0aGF0IGEgc2luZ2xlIGV4cGlyeSBldmVudFxuICAgKiAgICAgIHdpbGwgYmUgc2VudCBmb3IgYSBnaXZlbiBrZXk7IGluc3RlYWQsIHRoZSBldmVudCB3aWxsIGNvbnRpbnVlXG4gICAqICAgICAgdG8gYmUgZGlzcGF0Y2hlZCBmb3IgYXMgbG9uZyBhcyB0aGUga2V5IHJlbWFpbnMgaW4gdGhlIHN0b3JlLlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBTaWduYWxpbmdEYXRhU3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgREVGQVVMVF9UVEwgPSAxO1xuXG4gIF8uZXh0ZW5kKFNpZ25hbGluZ0RhdGFTdG9yZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIiwgREVGQVVMVF9UVEwpO1xuXG4gICAgICB0aGlzLl9zZXF1ZW5jZXIgPSBvcHRzLmdldE9yRWxzZUZuKFwic2VxdWVuY2VyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFVuaXRTZXF1ZW5jZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfZG9DaGVja1wiKTtcblxuICAgICAgdGhpcy5fc2VudHJ5U2VxdWVuY2VyID0gbmV3IERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyKHtcbiAgICAgICAgZGVsZWdhdGU6IG5ldyBVbml0U2VxdWVuY2VyKCksXG4gICAgICAgIHRhcmdldHM6IFt7XG4gICAgICAgICAgYWR2YW5jZTogdGhpcy5fZG9DaGVja1xuICAgICAgICB9XVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2JhY2tpbmdTdG9yZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNraW5nU3RvcmVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5NZW1vcnlEYXRhU3RvcmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zaG91bGRUb3VjaE9uUmVhZCA9IG9wdHMuZ2V0T3JFbHNlKFwidG91Y2hPblJlYWRcIiwgZmFsc2UpO1xuXG4gICAgICB0aGlzLl9zaWduYWxDaGFubmVsID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcblxuICAgICAgdGhpcy5fa2V5cyA9IE0uc2V0KCk7XG4gICAgfSxcblxuICAgIHNlcXVlbmNlcjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2VxdWVuY2VyO1xuICAgIH0sXG5cbiAgICBzZW50cnlTZXF1ZW5jZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlbnRyeVNlcXVlbmNlcjtcbiAgICB9LFxuXG4gICAgc2lnbmFsQ2hhbm5lbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IENoYWluZWRDaGFubmVsKHtcbiAgICAgICAgc2VudGluZWw6IHRoaXMsXG4gICAgICAgIGNoYWluVG86IHRoaXMuX3NpZ25hbENoYW5uZWxcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfZG9DaGVjazogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgd29yayA9IE0ubWFwKF8uYmluZChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgICBpZiAoZW50cnkgJiYgZW50cnkuaXNFeHBpcmVkKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLCB0aGlzLl90dGwpKSB7XG4gICAgICAgICAgICAgIHRoaXMuX3NpZ25hbEV4cGlyeVNvb24oa2V5LCB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sIHRoaXMpLCB0aGlzLl9rZXlzKTtcblxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKE0uaW50b19hcnJheSh3b3JrKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgYGtleWAuIElmIHRoZSBvYmplY3RcbiAgICAgKiBoYXMgZXhwaXJlZCwgaXQgd2lsbCBzdGlsbCBiZSByZXR1cm5lZCBmcm9tIHRoZSBTdG9yZSwgYnV0IGFuIG1UOmV4cGlyZWRcbiAgICAgKiBtZXNzYWdlIHdpbGwgYmUgc2VudCBhbG9uZyB0aGUgYHNpZ25hbENoYW5uZWxgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSB7c3RyaW5nfVxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG9iamVjdD59IHJlcXVlc3RlZCB2YWx1ZVxuICAgICAqL1xuICAgIGdldDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBpc0V4cGlyZWQgPSBlbnRyeS5pc0V4cGlyZWQodGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHRoaXMuX3R0bCk7XG5cbiAgICAgICAgICBpZiAoaXNFeHBpcmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaWduYWxFeHBpcnlTb29uKGtleSwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghaXNFeHBpcmVkICYmIHRoaXMuX3Nob3VsZFRvdWNoT25SZWFkKSB7XG4gICAgICAgICAgICBlbnRyeS50b3VjaCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnB1dChrZXksIGVudHJ5KTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnRoZW5SZXR1cm4oZW50cnkudmFsdWUoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeS52YWx1ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgdGhlIHByb3ZpZGVkIGB2YWxgLCBpZGVudGlmaWVkIGJ5IGBrZXlgLCB3aXRoIGEgVFRMIG9wdGlvbmFsbHlcbiAgICAgKiBzdXBwbGllZCBieSBgb3B0cy50dGxgIChvdmVycmlkZXMgcHJlLWNvbmZpZ3VyZWQgU3RvcmUgVFRMLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSB7U3RyaW5nfVxuICAgICAqIEBwYXJhbSB2YWwge29iamVjdH0gdmFsdWUgdG8gYmUgc3RvcmVkXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8Pn1cbiAgICAgKi9cbiAgICBwdXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSwgdmFsLCBvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgZW50cnkudXBkYXRlKHZhbCwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksIHtcbiAgICAgICAgICAgICAgdHRsOiBvcHRzLmdldE9yRWxzZShcInR0bFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVudHJ5ID0gbmV3IEVudHJ5KHtcbiAgICAgICAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgICAgICAgaW5pdGlhbFNlcXVlbmNlOiB0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSxcbiAgICAgICAgICAgICAgdHRsOiBvcHRzLmdldE9yRWxzZShcInR0bFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLnB1dChrZXksIGVudHJ5KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IE0uY29uaih0aGlzLl9rZXlzLCBrZXkpO1xuICAgICAgICAgICAgICByZXR1cm47IC8vIEJlY2F1c2UgdGhlblJldHVybiBkb2Vzbid0IHdvcmsgd2l0aCBhbiBlbXB0eSB2YWx1ZS5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBga2V5YFxuICAgICAqL1xuICAgIHJlbW92ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KXtcbiAgICAgIHZhciB2YWw7XG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlXG4gICAgICAgIC5yZW1vdmUoa2V5KVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgdGhpcy5fa2V5cyA9IE0uZGlzaih0aGlzLl9rZXlzLCBrZXkpO1xuXG4gICAgICAgICAgICB2YWwgPSBlbnRyeS52YWx1ZSgpO1xuICAgICAgICAgICAgZW50cnkuZGlzcG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG5cbiAgICBleGlzdHM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICAvLyBVbmxpa2UgaW4gdGhlIENhY2hpbmdEYXRhU3RvcmUsIHdoZXJlIHdlIGhhdmUgdG8gcGVyZm9ybSBldmljdGlvbiBydWxlcyBiZWZvcmVcbiAgICAgIC8vIHJldHVybmluZyB0aGUgYW5zd2VyLCBoZXJlIHdlIGNhbiBqdXN0IGRlbGVnYXRlIHN0cmFpZ2h0IHRvIHRoZSBiYWNraW5nIHN0b3JlLlxuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5leGlzdHMoa2V5KTtcbiAgICB9KSxcblxuXG4gICAgY2xlYXI6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmNsZWFyKCk7XG4gICAgfSksXG5cblxuICAgIF9zaWduYWxFeHBpcnlTb29uOiBmdW5jdGlvbihrZXksIHNlcXVlbmNlKSB7XG4gICAgICBfLmRlZmVyKF8uYmluZChmdW5jdGlvbigpe1xuICAgICAgICB0aGlzLl9zaWduYWxDaGFubmVsLnB1Ymxpc2godGhpcywge1xuICAgICAgICAgIG1UOiBcImV4cGlyZWRcIixcbiAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICBzZXF1ZW5jZTogc2VxdWVuY2VcbiAgICAgICAgfSk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gU2lnbmFsaW5nRGF0YVN0b3JlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9jaGFubmVsL2NoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2NoYW5uZWwvY2hhaW5lZC1jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi9pbi1tZW1vcnktZGF0YS1zdG9yZVwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlclxuKSB7XG5cbiAgLyoqXG4gICAqIEEgdXRpbGl0eSBcImNsYXNzXCIgZm9yIGNvbmZpZ3VyYXRpb24tcmVsYXRlZCBmdW5jdGlvbmFsaXR5LlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBDb25maWd1cmF0aW9uTWFnaWMgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDb25maWd1cmF0aW9uTWFnaWMucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fVxuICB9KTtcblxuICBfLmV4dGVuZChDb25maWd1cmF0aW9uTWFnaWMsIHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVzb2x2ZWQgY29uZmlndXJhdGlvbiwgZ2l2ZW4gbXVsdGlwbGUgY29uZmlndXJhdGlvbiBkb2N1bWVudHMgYW5kIGEgc2V0IG9mIHNjb3Blcy4gU2VlXG4gICAgICogYFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlcmAuXG4gICAgICovXG4gICAgcmVzb2x2ZUNvbmZpZzogZnVuY3Rpb24oc2NvcGVzLCBjb25maWdPYmplY3RzKSB7XG4gICAgICB2YXIgciA9IG5ldyBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXIoKTtcbiAgICAgIF8uZWFjaChjb25maWdPYmplY3RzLCBmdW5jdGlvbihjKSB7XG4gICAgICAgIHIuYWRkKGMpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gci5yZXNvbHZlKHNjb3Blcyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29uZmlndXJhdGlvbk1hZ2ljO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTG9nZ2VyLFxuICBPcHRpb25zLFxuICBTdGF0ZUd1YXJkLFxuICBSdW50aW1lLFxuICBQcm9jZXNzS2VlcEFsaXZlXG4pIHtcbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJBcHBcIik7XG5cbiAgdmFyIEFwcCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEFwcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fZ3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJzdGFydGluZ1wiLCBcInN0YXJ0ZWRcIiwgXCJzdG9wcGluZ1wiLCBcInN0b3BwZWRcIl0pO1xuICAgICAgdGhpcy5fcmF3Q29uZmlnID0gb3B0cy5nZXRPckVycm9yKFwiY29uZmlndXJhdGlvblwiKTtcbiAgICAgIHRoaXMuX2NvbmZpZyA9IE9wdGlvbnMuZnJvbU9iamVjdCh0aGlzLl9yYXdDb25maWcpO1xuXG4gICAgICAvLyBUaGUgZGVmYXVsdCBSdW50aW1lIGhhcyBzZW5zaWJsZSBkZWZhdWx0cy5cbiAgICAgIHRoaXMuX3J1bnRpbWUgPSBvcHRzLmdldE9yRWxzZUZuKFwicnVudGltZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSdW50aW1lKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fa2VlcEFsaXZlID0gbmV3IFByb2Nlc3NLZWVwQWxpdmUoe1xuICAgICAgICBzY2hlZHVsZXI6IHRoaXMuX3J1bnRpbWUuc2NoZWR1bGVyKClcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgdXAgICA9IG9wdHMuZ2V0T3JFbHNlKFwidXBcIiksXG4gICAgICAgICAgZG93biA9IG9wdHMuZ2V0T3JFbHNlKFwiZG93blwiKTtcblxuICAgICAgaWYgKHVwKSB7XG4gICAgICAgIHRoaXMudXAgPSBQcm9taXNlLm1ldGhvZChfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHVwLmNhbGwodGhpcywgdGhpcy5fY29uZmlnKTtcbiAgICAgICAgfSwgdGhpcykpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZG93bikge1xuICAgICAgICB0aGlzLmRvd24gPSBQcm9taXNlLm1ldGhvZChfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGRvd24uY2FsbCh0aGlzLCB0aGlzLl9jb25maWcpO1xuICAgICAgICB9LCB0aGlzKSk7XG4gICAgICB9XG5cbiAgICB9LFxuXG4gICAgc3RhcnQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgTG9nLmRlYnVnKFwiU3RhcnRpbmcgQXBwXCIpO1xuICAgICAgdGhpcy5fZ3VhcmRcbiAgICAgICAgLmRlbnkoXCJzdGFydGluZ1wiKVxuICAgICAgICAuYXBwbHkoXCJzdGFydGluZ1wiKTtcblxuICAgICAgdGhpcy5fa2VlcEFsaXZlLnN0YXJ0KCk7XG4gICAgICBMb2cuZGVidWcoXCJDYWxsaW5nIEFwcCN1cCgpXCIpO1xuXG4gICAgICByZXR1cm4gdGhpcy51cCgpXG4gICAgICAgIC50aGVuKHRoaXMuX2d1YXJkLmFwcGx5QXN5bmNGbihcInN0YXJ0ZWRcIikpO1xuICAgIH0pLFxuXG4gICAgc3RvcDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICBMb2cuZGVidWcoXCJTdG9wcGluZyBBcHBcIik7XG4gICAgICB0aGlzLl9ndWFyZFxuICAgICAgICAuZGVueShcInN0b3BwaW5nXCIpXG4gICAgICAgIC5hcHBseShcInN0b3BwaW5nXCIpO1xuXG4gICAgICB0aGlzLl9rZWVwQWxpdmUuc3RvcCgpO1xuICAgICAgTG9nLmRlYnVnKFwiQ2FsbGluZyBBcHAjZG93bigpXCIpO1xuXG4gICAgICByZXR1cm4gdGhpcy5kb3duKClcbiAgICAgICAgLnRoZW4odGhpcy5fZ3VhcmQuYXBwbHlBc3luY0ZuKFwic3RvcHBlZFwiKSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXF1ZXN0ZWQgY29uZmlndXJhdGlvbiB2YWx1ZSwgb3IgdGhyb3dzIGFuIGVycm9yLlxuICAgICAqIEBwYXJhbSBrZXkgdGhlIGNvbmZpZ3VyYXRpb24ga2V5IHJlcXVlc3QgZnJvbSB0aGUgQ29uZmlndXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqL1xuICAgIGNvbmZpZzogZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fY29uZmlnLmdldE9yRXJyb3Ioa2V5KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVE9ETzogRG9jLiBTdWJjbGFzcyBzaG91bGQgb3ZlcnJpZGUuXG4gICAgICovXG4gICAgdXA6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge30pLFxuXG4gICAgLyoqXG4gICAgICogVE9ETzogRG9jLiBTdWJjbGFzcyBzaG91bGQgb3ZlcnJpZGUuXG4gICAgICovXG4gICAgZG93bjogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7fSlcbiAgfSk7XG5cbiAgcmV0dXJuIEFwcDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9ydW50aW1lXCIpLFxuICByZXF1aXJlKFwiLi9pbnRlcm5hbC9wcm9jZXNzLWtlZXAtYWxpdmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgTG9nZ2VyLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcixcbiAgVW5pdFNlcXVlbmNlcixcbiAgSW5NZW1vcnlGaWJlcixcbiAgTWFpbGJveCxcbiAgRGlzcGF0Y2hlcixcbiAgU2lnbmFsaW5nRGF0YVN0b3JlLFxuICBQZXJpb2RpYyxcbiAgQ2xvY2tTZXF1ZW5jZXIsXG4gIFN5c3RlbUNsb2NrLFxuICBSdW50aW1lXG4gICkge1xuXG4gIC8qKlxuICAgKiBBbiBgRXhjaGFuZ2VgIHZlbmRzIG1haWxib3hlcy4gTWVzc2FnZXMgc2VudCBmcm9tIGEgbWFpbGJveCBhcmUgbWFuYWdlZCBieSB0aGUgRXhjaGFuZ2Ugd2hpY2ggdmVuZGVkIHRoZSBtYWlsYm94LlxuICAgKiBUaGUgRXhjaGFuZ2UgaGFuZGxlcyB0aGUgd29yayBvZjpcbiAgICpcbiAgICogICAxLiBXcmFwcGluZyB0aGUgbWVzc2FnZSBpbiB0aGUgYXBwcm9wcmlhdGUgbWVzc2FnZSBlbnZlbG9wZSBmb3IgdGhlIHZlcmIgdXNlZCAoYHNlbmRgLCBgc2VuZEFuZFJlY2VpdmVgLFxuICAgKiAgICAgIGByZXBseWApXG4gICAqICAgMi4gUGFpcmluZyBhIGdpdmVuIGByZXBseWAgd2l0aCB0aGUgb3JpZ2luYXRpbmcgYHNlbmRBbmRSZWNlaXZlYCBjYWxsLCBhbmQgZnVsZmlsbGluZyB0aGUgYXNzb2NpYXRlZCByZXN1bHRcbiAgICogICAgICBwcm9taXNlLlxuICAgKiAgIDMuIEhhbmRsaW5nIG1lc3NhZ2UgdGltZW91dHMgZm9yIGBzZW5kQW5kUmVjZWl2ZWAgY2FsbHMuIFdoZW4gYSBtZXNzYWdlIHRpbWVzIG91dCwgdGhlIHByb21pc2UgYXNzb2NpYXRlZCB3aXRoXG4gICAqICAgICAgdGhlIHJlc3VsdCBpcyBjYW5jZWxlZC5cbiAgICpcbiAgICogVGhlIGFjdHVhbCB3b3JrIG9mIHNlbmRpbmcgbWVzc2FnZXMgaXMgaGFuZGxlZCBieSBhbiBFeGNoYW5nZSdzIHVuZGVybHlpbmcgYEZpYmVyYC4gVGhlIGRlZmF1bHQgZmliZXIgaXNcbiAgICogYW4gYEluTWVtb3J5RmliZXJgLCB3aGljaCBwZXJmb3JtcyBvbmx5IGxvY2FsIGRpc3BhdGNoLlxuICAgKlxuICAgKiBHZW5lcmFsbHkgc3BlYWtpbmcsIG1haWxib3hlcyBzaGFyaW5nIGFuIHVuZGVybHlpbmcgZmliZXIgKGVpdGhlciBieSBib3RoIGJlaW5nIHNwYXduZWQgZnJvbSB0aGUgc2FtZSBtYWlsYm94LFxuICAgKiBvciBiZWluZyBzcGF3bmVkIGJ5IGV4Y2hhbmdlcyBzaGFyaW5nIHRoZSBzYW1lIGZpYmVyKSBjYW4gc2VuZCBtZXNzYWdlcyB0byBlYWNoIG90aGVyLCBwcm92aWRlZCB0aGV5IGtub3dcbiAgICogZWFjaCBvdGhlcidzIGFkZHJlc3Nlcy5cbiAgICpcbiAgICovXG4gIHZhciBFeGNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBNU0dfU0VORCAgICAgICAgICAgICA9IEV4Y2hhbmdlLk1TR19TRU5EICAgICAgICAgICAgID0gXCJzZW5kXCIsXG4gICAgICBNU0dfU0VORF9BTkRfUkVDRUlWRSA9IEV4Y2hhbmdlLk1TR19TRU5EX0FORF9SRUNFSVZFID0gXCJzZW5kQW5kUmVjZWl2ZVwiLFxuICAgICAgTVNHX1JFUExZICAgICAgICAgICAgPSBFeGNoYW5nZS5NU0dfUkVQTFkgICAgICAgICAgICA9IFwicmVwbHlcIjtcblxuICAvLyA3LjUgc2Vjb25kcyBpcyByZWFzb25hYmxlLCB5ZXM/XG4gIHZhciBERUZBVUxUX1JFUExZX1RJTUVPVVQgPSA3NTAwO1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiRXhjaGFuZ2VcIik7XG5cblxuICBfLmV4dGVuZChFeGNoYW5nZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFbHNlKFwiaWRlbnRpdHlcIiwgVVVJRC52NCgpKTtcblxuICAgICAgdGhpcy5fcnVudGltZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJydW50aW1lXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFJ1bnRpbWUoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9tYWlsYm94RmliZXJEZWxlZ2F0ZSA9IHtcbiAgICAgICAgcmVjZWl2ZUZpYmVyTWVzc2FnZTogdGhpcy5fcmVjZWl2ZU1haWxib3hGaWJlck1lc3NhZ2UuYmluZCh0aGlzKVxuICAgICAgfTtcblxuICAgICAgdGhpcy5fbWFpbGJveGVzID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICB0aGlzLl9maWJlciAgICAgPSBvcHRzLmdldE9yRWxzZUZuKFwiZmliZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5NZW1vcnlGaWJlcigpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2ZpYmVyLnJlZ2lzdGVyRW50aXR5KHtcbiAgICAgICAgaWRlbnRpdHk6IHRoaXMuX2lkZW50aXR5LFxuICAgICAgICBkZWxlZ2F0ZTogdGhpc1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX21haWxib3hEaXNwYXRjaGVyID0gbmV3IERpc3BhdGNoZXIoe1xuICAgICAgICBkZWxlZ2F0ZTogdGhpcyxcbiAgICAgICAgcHJlZml4OiBcIl9vbk1ieFwiXG4gICAgICB9KTtcblxuICAgICAgdmFyIHVzZWREZWZhdWx0Q2xvY2sgPSBmYWxzZTtcblxuICAgICAgLy8gRm9yIHJlcXVlc3Rlci1wcm92aWRlZCByZXF1ZXN0SWQgdG8gbWVzc2FnZUlkIG1hcHBpbmcuXG4gICAgICAvLyBVc2VkIGZvciBjYW5jZWxsaW5nIG91dHN0YW5kaW5nIHNlbmRBbmRSZWNlaXZlIHJlcXVlc3RzLlxuICAgICAgdGhpcy5fcmVxVG9Nc2cgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIC8vIERhdGEgc3RvcmUgZm9yIHBlbmRpbmcgcmVxdWVzdHNcbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMgPSBuZXcgU2lnbmFsaW5nRGF0YVN0b3JlKHtcbiAgICAgICAgdHRsOiBvcHRzLmdldE9yRWxzZShcInJlcGx5VGltZW91dFwiLCBERUZBVUxUX1JFUExZX1RJTUVPVVQpLFxuICAgICAgICBzZXF1ZW5jZXI6IG5ldyBDbG9ja1NlcXVlbmNlcih7XG4gICAgICAgICAgY2xvY2s6IG9wdHMuZ2V0T3JFbHNlRm4oXCJjbG9ja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVzZWREZWZhdWx0Q2xvY2sgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTeXN0ZW1DbG9jaygpO1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIC8vIEhheCAtIFNpbmNlIHdlIHdhbnQgdGltZSB0byBiZSBhc3luYywgYnV0IHByb3ZpZGUgYSBkZWZhdWx0IHN5c3RlbSBjbG9ja1xuICAgICAgICAgIC8vIHdlIG5lZWQgdG8gZ2V0IHRoZSBpbml0aWFsIGNsb2NrIHNlcXVlbmNlIHN5bmMsIGJ5IGJ5cGFzc2luZyB0aGUgY2xvY2sgY2FsbC5cbiAgICAgICAgICAvLyBJZiB5b3UgcHJvdmlkZSBhbiBhc3luYyBjbG9jaywgeW91IHNob3VsZCBlaXRoZXIgcHJvdmlkZSBhbiBpbml0aWFsIHRpbWUsIG9yXG4gICAgICAgICAgLy8gZW5zdXJlIHRoYXQgdGhlIGZpcnN0IGdldFRpbWUgaGFzIHJlc29sdmVkIGJlZm9yZSBpbnN0YW50aWF0aW5nIHRoZSBleGNoYW5nZS5cbiAgICAgICAgICAvLyBPUiwgaW4gdGhlIGZ1dHVyZSwgd2UgaGF2ZSB0byBhZGQgYSBzdGFydCgpL3N0b3AoKSB0byBFeGNoYW5nZS5cbiAgICAgICAgICBpbml0aWFsU2VxdWVuY2U6IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFNlcXVlbmNlXCIsICh1c2VkRGVmYXVsdENsb2NrID8gK25ldyBEYXRlKCkgOiB1bmRlZmluZWQpKVxuICAgICAgICB9KVxuICAgICAgfSk7XG5cbiAgICAgIC8vIERpc3BhdGNoZXMgc3RvcmUgc2lnbmFscyAoZS5nLiwgZXhwaXJ5KVxuICAgICAgdGhpcy5fZXhwaXJ5RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMsXG4gICAgICAgIHByZWZpeDogXCJfb25TdG9yZVNpZ25hbFwiLFxuICAgICAgICBsaXN0ZW46IHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMuc2lnbmFsQ2hhbm5lbCgpXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fY29tcG9zaXRlU2VxID0gbmV3IERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyKHtcbiAgICAgICAgZGVsZWdhdGU6IG5ldyBVbml0U2VxdWVuY2VyKCksXG4gICAgICAgIHRhcmdldHM6IFt0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnNlcXVlbmNlcigpLCB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnNlbnRyeVNlcXVlbmNlcigpXVxuICAgICAgfSlcblxuICAgICAgLy8gVGhpcyBndXkgdHJpZ2dlcnMgcGVyaW9kaWMgZXhwaXJ5IGNoZWNrcyBpbiB0aGUgc3RvcmVcbiAgICAgIHRoaXMuX2NoZWNrRXhwaXJ5ID0gbmV3IFBlcmlvZGljKHtcbiAgICAgICAgc2NoZWR1bGVyOiB0aGlzLl9ydW50aW1lLnNjaGVkdWxlcigpLFxuICAgICAgICB0YXNrOiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbXBvc2l0ZVNlcS5hZHZhbmNlKCk7XG4gICAgICAgIH0sIHRoaXMpLFxuICAgICAgICBpbnRlcnZhbDogb3B0cy5nZXRPckVsc2UoXCJleHBpcnlJbnRlcnZhbFwiLCAxMDAwKVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2NoZWNrRXhwaXJ5LnN0YXJ0KCk7XG4gICAgfSxcblxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAvLyBUT0RPOiBDYW5jZWwgb3V0c3RhbmRpbmcgcmVxdWVzdHNcblxuICAgICAgdGhpcy5fZXhwaXJ5RGlzcGF0Y2hlci5kaXNwb3NlKCk7XG5cbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMuY2xlYXIoKTtcblxuICAgICAgLy8gVE9ETzogRGlzcG9zZSBhbGwgdGhlIHRoaW5nc1xuICAgICAgdGhpcy5fY2hlY2tFeHBpcnkuZGlzcG9zZSgpO1xuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkcyBhIE1haWxib3ggZm9yIHRoZSBwcm92aWRlZCBgcmVxdWVzdGVySWRlbnRpdHlgLiBUaGVcbiAgICAgKiBgUmVxdWVzdGVySWRlbnRpdHlgIG11c3QgbmV2ZXIgaGF2ZSBiZWVuIHVzZWQgZm9yIHJlcXVlc3RpbmdcbiAgICAgKiBhIG1haWxib3ggcHJldmlvdXNseS5cbiAgICAgKlxuICAgICAqIFdlIGF0dGVtcHQgdG8gdmFsaWRhdGUgdW5pcXVlIG1haWxib3ggbmFtZXMsIGJ1dCBiZWNhdXNlIG1haWxib3ggbmFtZXNcbiAgICAgKiBhcmUgZ2xvYmFsIGFuZCB0aGVyZSBpcyBubyBjaGVja2luZyBiZXR3ZWVuIGZpYmVycywgaXQncyBvbmx5IGEgYmVzdC1lZmZvcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVxdWVzdGVySWRlbnRpdHlcbiAgICAgKiBAcmV0dXJucyB7TWFpbGJveH1cbiAgICAgKi9cbiAgICBtYWlsYm94OiBmdW5jdGlvbihyZXF1ZXN0ZXJJZGVudGl0eSkge1xuICAgICAgdGhpcy5fYXNzZXJ0VW5pcXVlT3duZXIocmVxdWVzdGVySWRlbnRpdHkpO1xuXG4gICAgICB2YXIgbWFpbGJveCA9IG5ldyBNYWlsYm94KHtcbiAgICAgICAgZXhjaGFuZ2U6ICAgICAgdGhpcyxcbiAgICAgICAgb3duZXJJZGVudGl0eTogcmVxdWVzdGVySWRlbnRpdHlcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9tYWlsYm94ZXMgPSBNLmFzc29jKHRoaXMuX21haWxib3hlcywgcmVxdWVzdGVySWRlbnRpdHksIG1haWxib3gpO1xuXG4gICAgICB0aGlzLl9maWJlci5yZWdpc3RlckVudGl0eSh7XG4gICAgICAgIGlkZW50aXR5OiByZXF1ZXN0ZXJJZGVudGl0eSxcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMuX21haWxib3hGaWJlckRlbGVnYXRlXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIG1haWxib3g7XG4gICAgfSxcblxuXG4gICAgc2VuZDogZnVuY3Rpb24oZW52KSB7XG4gICAgICBlbnYgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2ZpYmVyLnNlbmQoe1xuICAgICAgICBmcm9tOiAgZW52LmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICB0bzogICAgZW52LmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgYm9keTogIGVudi5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgbVQ6ICAgIE1TR19TRU5ELFxuICAgICAgICBtc2dJZDogVVVJRC52NCgpXG4gICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICByZXBseTogZnVuY3Rpb24oZW52KSB7XG4gICAgICBlbnYgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KTtcbiAgICAgIHJldHVybiB0aGlzLl9maWJlci5zZW5kKHtcbiAgICAgICAgZnJvbTogICBlbnYuZ2V0T3JFcnJvcihcImZyb21cIiksXG4gICAgICAgIHRvOiAgICAgZW52LmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgYm9keTogICBlbnYuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgIG1UOiAgICAgTVNHX1JFUExZLFxuICAgICAgICBtc2dJZDogIFVVSUQudjQoKSxcbiAgICAgICAgck1zZ0lkOiBlbnYuZ2V0T3JFcnJvcihcInJNc2dJZFwiKVxuICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgc2VuZEFuZFJlY2VpdmU6IGZ1bmN0aW9uKGVudiwgb3B0cykge1xuICAgICAgZW52ICA9IE9wdGlvbnMuZnJvbU9iamVjdChlbnYpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdmFyIG1zZ0lkID0gVVVJRC52NCgpLFxuICAgICAgICAgIHJlcUlkICAgID0gb3B0cy5nZXRPckVycm9yKFwicmVxSWRcIiksXG4gICAgICAgICAgZGVmZXJyZWQgPSBkZWZlcigpLFxuICAgICAgICAgIGZpYkVudiAgID0ge1xuICAgICAgICAgICAgZnJvbTogIGVudi5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgICAgIHRvOiAgICBlbnYuZ2V0T3JFcnJvcihcInRvXCIpLFxuICAgICAgICAgICAgYm9keTogIGVudi5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgICAgIG1UOiAgICBNU0dfU0VORF9BTkRfUkVDRUlWRSxcbiAgICAgICAgICAgIG1zZ0lkOiBtc2dJZFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVxICAgICAgPSB7XG4gICAgICAgICAgICByZXFJZDogICAgcmVxSWQsXG4gICAgICAgICAgICBkZWZlcnJlZDogZGVmZXJyZWQsXG4gICAgICAgICAgICBmaWJFbnY6ICAgZmliRW52XG4gICAgICAgICAgfTtcblxuICAgICAgdGhpcy5fcmVxVG9Nc2cgPSBNLmFzc29jKHRoaXMuX3JlcVRvTXNnLCByZXFJZCwgbXNnSWQpO1xuXG4gICAgICByZXR1cm4gdGhpc1xuICAgICAgICAuX291dHN0YW5kaW5nUmVxdWVzdHNcbiAgICAgICAgLnB1dChtc2dJZCwgcmVxLCB7dHRsOiBvcHRzLmdldE9yRWxzZShcInJlcGx5VGltZW91dFwiKX0pXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9maWJlci5zZW5kKGZpYkVudik7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiByZXEuZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNhbmNlbFNlbmRBbmRSZWNlaXZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihyZXFJZCkge1xuICAgICAgdmFyIG1zZ0lkID0gTS5nZXQodGhpcy5fcmVxVG9Nc2csIHJlcUlkKTtcblxuICAgICAgaWYgKG1zZ0lkKSB7XG4gICAgICAgIExvZy5kZWJ1ZyhcIkNhbmNlbGluZyByZXF1ZXN0XCIsIHJlcUlkLCBcIndpdGggbXNnSWRcIiwgbXNnSWQpO1xuICAgICAgICB0aGlzLl9yZXFUb01zZyA9IE0uZGlzc29jKHRoaXMuX3JlcVRvTXNnLCByZXFJZCk7XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMucmVtb3ZlKG1zZ0lkKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcSkge1xuICAgICAgICAgICAgaWYgKHJlcSkge1xuICAgICAgICAgICAgICByZXEuZGVmZXJyZWQucmVqZWN0KG5ldyBQcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBMb2cud2FybihcIlRyaWVkIHRvIGNhbmNlbCByZXF1ZXN0LCBidXQgbm8gb3VzdGFuZGluZyByZXF1ZXN0IHdpdGggdGhhdCBJRCBmb3VuZDtcIiwgcmVxSWQpO1xuICAgICAgfVxuICAgIH0pLFxuXG5cbiAgICBfYXNzZXJ0VW5pcXVlT3duZXI6IGZ1bmN0aW9uKGlkZW50aXR5KSB7XG4gICAgICBpZiAoTS5nZXQodGhpcy5fbWFpbGJveGVzLCBpZGVudGl0eSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWFpbGJveCByZWdpc3RyYXRpb24gcmVxdWlyZXMgYSB1bmlxdWUgaWRlbnRpdHlcIik7XG4gICAgICB9XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogRmliZXIgZGVsZWdhdGUgcHJvdG9jb2wgbWV0aG9kIGZvciBhIG1lc3NhZ2UgYm91bmQgZm9yIGEgTWFpbGJveCBvd25lZCBieVxuICAgICAqIHRoaXMgZXhjaGFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW52XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcmVjZWl2ZU1haWxib3hGaWJlck1lc3NhZ2U6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdGhpcy5fbWFpbGJveERpc3BhdGNoZXIuZGlzcGF0Y2goZW52KTtcbiAgICB9LFxuXG5cbiAgICBfb25NYnhTZW5kOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHZhciBvRW52ICAgICA9IE9wdGlvbnMuZnJvbU9iamVjdChlbnYpLFxuICAgICAgICAgIGlkZW50aXR5ID0gb0Vudi5nZXRPckVsc2UoXCJ0b1wiKSxcbiAgICAgICAgICBib2R5ICAgICA9IG9FbnYuZ2V0T3JFbHNlKFwiYm9keVwiKTtcblxuICAgICAgaWYgKCEoaWRlbnRpdHkgfHwgYm9keSkpIHtcbiAgICAgICAgTG9nLmluZm8oXCJFeGNoYW5nZSByZWNlaXZlZCBhIG1lc3NhZ2Ugd2l0aCBtaXNzaW5nIGVudmVsb3BlIGluZm9ybWF0aW9uXCIsIGVudik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIG1ib3ggPSBNLmdldCh0aGlzLl9tYWlsYm94ZXMsIGlkZW50aXR5KTtcbiAgICAgIGlmIChtYm94KSB7XG4gICAgICAgIG1ib3guX3JlY2VpdmVPbmVTaG90KGVudik7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFRPRE86IFNob3VsZCB0aGlzIGdvIGFsb25nIHRoZSBtYWlsYm94IGluZ3Jlc3MgY2hhbm5lbD9cbiAgICAvLyBPciBzaG91bGQgaXQgYmUgY2ItYmFzZWQ/XG4gICAgX29uTWJ4U2VuZEFuZFJlY2VpdmU6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdmFyIG9FbnYgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KSxcbiAgICAgICAgICBpZGVudGl0eSA9IG9FbnYuZ2V0T3JFbHNlKFwidG9cIiksXG4gICAgICAgICAgYm9keSA9IG9FbnYuZ2V0T3JFbHNlKFwiYm9keVwiKTtcblxuICAgICAgaWYgKCEoaWRlbnRpdHkgfHwgYm9keSkpIHtcbiAgICAgICAgTG9nLmluZm8oXCJFeGNoYW5nZSByZWNlaXZlZCBhIG1lc3NhZ2Ugd2l0aCBtaXNzaW5nIGVudmVsb3BlIGluZm9ybWF0aW9uXCIsIGVudik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIG1ib3ggPSBNLmdldCh0aGlzLl9tYWlsYm94ZXMsIGlkZW50aXR5KTtcbiAgICAgIGlmIChtYm94KSB7XG4gICAgICAgIG1ib3guX3JlY2VpdmVSZXF1ZXN0UmVwbHkoZW52KTtcbiAgICAgIH1cbiAgICB9LFxuXG5cbiAgICBfb25NYnhSZXBseTogZnVuY3Rpb24oZW52KSB7XG4gICAgICB2YXIgb0VudiAgICAgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KSxcbiAgICAgICAgICByTXNnSWQgICA9IG9FbnYuZ2V0T3JFbHNlKFwick1zZ0lkXCIpO1xuXG5cblxuICAgICAgLy8gRG9uJ3QgZGlzcGF0Y2ggdmV0dGVkIHJlcGxpZXMuIEp1c3QgZnVsZmlsbCB0aGUgcHJvbWlzZVxuICAgICAgUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpe1xuICAgICAgICAgIHJldHVybiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnJlbW92ZShyTXNnSWQpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5kaXNzb2ModGhpcy5fcmVxVG9Nc2csIHJlcXVlc3QucmVxSWQpO1xuICAgICAgICAgICAgcmVxdWVzdC5kZWZlcnJlZC5yZXNvbHZlKGVudik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiBGaXJlZCB3aGVuIGEgcmVxdWVzdCBpbiB0aGUgb3V0c3RhbmRpbmcgcmVxdWVzdHMgc3RvcmUgaXMgcGFzdCBkdWUuXG4gICAgICovXG4gICAgX29uU3RvcmVTaWduYWxFeHBpcmVkOiBmdW5jdGlvbihzaWcpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIkV4cGlyZWQgZW50cnkgaW4gc3RvcmVcIiwgc2lnKTtcbiAgICAgIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdHMucmVtb3ZlKHNpZy5rZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXF1ZXN0KSB7XG4gICAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5kaXNzb2ModGhpcy5fcmVxVG9Nc2csIHJlcXVlc3QucmVxSWQpO1xuICAgICAgICAgICAgcmVxdWVzdC5kZWZlcnJlZC5yZWplY3QobmV3IFByb21pc2UuVGltZW91dEVycm9yKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogRmliZXIgZGVsZWdhdGUgcHJvdG9jb2wgbWV0aG9kIGZvciBhIG1lc3NhZ2UgYm91bmQgZm9yIHRoaXMgRXhjaGFuZ2UgZGlyZWN0bHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW52XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICByZWNlaXZlRmliZXJNZXNzYWdlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKTtcbiAgICB9XG4gIH0pO1xuXG5cbiAgdmFyIGRlZmVyID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVzLCByZWo7XG4gICAgdmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbigpIHtcbiAgICAgIHJlcyA9IGFyZ3VtZW50c1swXTtcbiAgICAgIHJlaiA9IGFyZ3VtZW50c1sxXTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBwcm9taXNlOiBwLFxuICAgICAgcmVzb2x2ZTogcmVzLFxuICAgICAgcmVqZWN0OiByZWpcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiBFeGNoYW5nZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3V1aWRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuL2ZpYmVyL2luLW1lbW9yeS1maWJlclwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWxzL21haWxib3hcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2Rpc3BhdGNoZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9zdG9yYWdlL3NpZ25hbGluZy1kYXRhLXN0b3JlXCIpLFxuICByZXF1aXJlKFwiLi4vdXRpbC9wZXJpb2RpY1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4uL3RpbWUvY2xvY2svc3lzdGVtLWNsb2NrXCIpLFxuICByZXF1aXJlKFwiLi4vcnVudGltZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBTdGF0ZUd1YXJkLFxuICBMb2dnZXIsXG4gIERpc3BhdGNoZXJcbikge1xuXG4gIC8qKlxuICAgKiBBIENvdXJpZXIgbWFrZXMgaXQgZWFzeSBmb3IgYSBtYWlib3ggb3duZXIgdG8gZGVhbCB3aXRoIHNlbmRpbmcgYW5kIHJlY2VpdmluZyBtZXNzYWdlcy4gSXQgaGFzIGEgc2xpZ2h0bHkgbW9yZVxuICAgKiBuYXR1cmFsIGludGVyZmFjZSBmb3Igc2VuZGluZyBtZXNzYWdlcyAoYHNlbmQodG8sIG1zZylgLCBgc2VuZEFuZFJlY2VpdmUodG8sIG1zZywgb3B0cylgKSwgYW5kIGF1dG9tYXRpY2FsbHlcbiAgICogZGlzcGF0Y2hlcyBpbmNvbWluZyBtZXNzYWdlcyB0byBkZWxlZ2F0ZSBtZXRob2RzLlxuICAgKlxuICAgKiBDb21tb24gdXNhZ2UgaXMgZm9yIGEgbWFpbGJveCBvd25lciAobGV0J3MgY2FsbCBpdCBcIm93bmVyIEFcIikgdG8gY3JlYXRlIGEgbmV3IENvdXJpZXIgKFwiY291cmllciBBXCIpLCBzZXR0aW5nIHRoZVxuICAgKiBgZGVsZWdhdGVgIHRvIGl0c2VsZiwgYW5kIHRoZSBgbWFpbGJveGAgdG8gdGhlIG1haWxib3ggKFwibWFpbGJveCBBXCIpIGl0IG93bnMuIFdoZW4gYSByZW1vdGUgbWFpbGJveCdzXG4gICAqIChcIm1haWxib3ggQlwiKSBjb3VyaWVyIChcImNvdXJpZXIgQlwiKSBwZXJmb3JtcyBhIGBjb3VyaWVyLnNlbmQoXCJBXCIsIHsgbVQ6IFwiZm9vXCIgfSlgLCBpdCB3aWxsIGJlIGF1dG9tYXRpY2FsbHlcbiAgICogZGlzcGF0Y2hlZCB0byBcIm93bmVyIEFcIidzIGBvbk1zZ0Zvb2AgbWV0aG9kLCBpZiBwcmVzZW50LlxuICAgKlxuICAgKiBJZiBcImNvdXJpZXIgQlwiIHBlcmZvcm1zIGEgYGNvdXJpZXIuc2VuZEFuZFJlY2VpdmUoXCJBXCIsIHsgbVQ6IFwiYmFyXCIgfSlgLCBpdCB3aWxsIGdldCBzZXQgdG8gXCJvd25lciBBXCInc1xuICAgKiBgb25SZXFCYXJgIG1ldGhvZCwgYW5kIHRoZSByZXN1bHRpbmcgcHJvbWlzZSdzIGZ1bGZpbGxlZCB2YWx1ZSB3aWxsIGJlIGRpc3BhdGNoZWQgYmFjayB0byBcImNvdXJpZXIgQlwiIGFzIHRoZVxuICAgKiBmdWxmaWxsZWQgcmVzdWx0IG9mIHRoZSBvcmlnaW5hdGluZyBgc2VuZEFuZFJlY2VpdmVgLlxuICAgKlxuICAgKiBBIGBzZW5kYCBvciBgc2VuZEFuZFJlY2VpdmVgIGNhbGwgaW5pdGlhdGVkIG9uIENvdXJpZXJCIHdpbGwgcmVzdWx0IGluIGEgbWV0aG9kIGNhbGwgb24gRGVsZWdhdGVBLCBhbmQgdmljZSB2ZXJzYS5cbiAgICpcbiAgICogIERlbGVnYXRlQSA8LT4gQ291cmllckEgPC0+IE1haWxib3hBIDwtPiBFeGNoYW5nZUFcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF5cbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXFxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2XG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZpYmVyXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFeGNoYW5nZUIgPC0+IE1haWxib3hCIDwtPiBDb3VyaWVyQiA8LT4gRGVsZWdhdGVCXG4gICAqXG4gICAqXG4gICAqXG4gICAqL1xuICB2YXIgQ291cmllciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBNU0dfUkVQTFkgPSBDb3VyaWVyLk1TR19SRVBMWSA9IFwiY1JlcGx5XCI7XG5cbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJDb3VyaWVyXCIpO1xuXG4gIF8uZXh0ZW5kKENvdXJpZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5faWQgICAgICAgICA9IFVVSUQudjQoKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlICAgPSBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKTtcbiAgICAgIHRoaXMuX21haWxib3ggICAgPSBvcHRzLmdldE9yRXJyb3IoXCJtYWlsYm94XCIpO1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZCA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX29uT25lU2hvdE1lc3NhZ2VcIiwgXCJfb25SZXF1ZXN0UmVwbHlNZXNzYWdlXCIsIFwiX2RlZmF1bHRDb250ZXh0RGVsZWdhdGVcIik7XG5cbiAgICAgIHRoaXMuX2NvbnRleHREZWxlZ2F0ZSA9IG9wdHMuZ2V0T3JFbHNlKFwiY29udGV4dERlbGVnYXRlXCIsIHRoaXMuX2RlZmF1bHRDb250ZXh0RGVsZWdhdGUpO1xuXG4gICAgICB0aGlzLl9vbmVTaG90RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMuX2RlbGVnYXRlLFxuICAgICAgICBwcmVmaXg6IG9wdHMuZ2V0T3JFbHNlKFwib25lU2hvdFByZWZpeFwiLCBcIm9uTXNnXCIpLFxuICAgICAgICBjb250ZXh0RGVsZWdhdGU6IHRoaXMuX2NvbnRleHREZWxlZ2F0ZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseURpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih7XG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLl9kZWxlZ2F0ZSxcbiAgICAgICAgcHJlZml4OiBvcHRzLmdldE9yRWxzZShcInJlcXVlc3RSZXBseVByZWZpeFwiLCBcIm9uUmVxXCIpLFxuICAgICAgICBjb250ZXh0RGVsZWdhdGU6IHRoaXMuX2NvbnRleHREZWxlZ2F0ZVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnMgPSBNLnZlY3RvcihcbiAgICAgICAgdGhpcy5fbWFpbGJveC5vbmVTaG90Q2hhbm5lbCgpLnN1YnNjcmliZSh0aGlzLl9vbk9uZVNob3RNZXNzYWdlKSxcbiAgICAgICAgdGhpcy5fbWFpbGJveC5yZXF1ZXN0UmVwbHlDaGFubmVsKCkuc3Vic2NyaWJlKHRoaXMuX29uUmVxdWVzdFJlcGx5TWVzc2FnZSlcbiAgICAgICk7XG4gICAgfSxcblxuXG4gICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH0sXG5cbiAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbih0bywgbXNnKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX21haWxib3guc2VuZCh7XG4gICAgICAgIHRvOiB0byxcbiAgICAgICAgYm9keTogbXNnXG4gICAgICB9KTtcbiAgICB9KSxcblxuICAgIHNlbmRBbmRSZWNlaXZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbih0bywgbXNnLCBvcHRzKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX21haWxib3hcbiAgICAgICAgLnNlbmRBbmRSZWNlaXZlKHtcbiAgICAgICAgICB0bzogdG8sXG4gICAgICAgICAgYm9keTogbXNnXG4gICAgICAgIH0sIG9wdHMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuXG4gICAgICAgICAgaWYgKHJlcy5ib2R5ICYmIHJlcy5ib2R5Lm1UID09PSBNU0dfUkVQTFkgJiYgcmVzLmJvZHkuYm9keSkge1xuICAgICAgICAgICAgLy8gVW53cmFwIHRoZSByZW1vdGUgbWVzc2FnZVxuICAgICAgICAgICAgaWYgKHJlcy5ib2R5LmJvZHkuZXJyKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXMuYm9keS5ib2R5LmVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzLmJvZHkuYm9keS5yZXM7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNvbWVvbmUgaXMgbWlzYmVoYXZpbmdcbiAgICAgICAgICAgIExvZy53YXJuKFwiUmVjZWl2ZWQgc2VuZEFuZFJlY2VpdmUgcmVwbHksIGJ1dCBpdCBpc24ndCBDb3VyaWVyLWNvbXBhdGlibGVcIiwgdGhpcy5fbWFpbGJveC5vd25lcklkZW50aXR5KCksIHJlcyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuXG4gICAgICBNLmVhY2godGhpcy5fc3VicywgZnVuY3Rpb24oc3ViKSB7XG4gICAgICAgIHN1Yi5kaXNwb3NlKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fc3VicyAgICAgPSBudWxsO1xuICAgICAgdGhpcy5fbWFpbGJveCAgPSBudWxsO1xuICAgICAgdGhpcy5fZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuICAgIF9kZWZhdWx0Q29udGV4dERlbGVnYXRlOiBmdW5jdGlvbihtVHlwZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1haWxib3g6IHRoaXMuX21haWxib3hcbiAgICAgIH07XG4gICAgfSxcblxuICAgIF9vbk9uZVNob3RNZXNzYWdlOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMuX29uZVNob3REaXNwYXRjaGVyLmRpc3BhdGNoKG1zZy5ib2R5LCBtc2cpO1xuICAgIH0sXG5cblxuICAgIF9vblJlcXVlc3RSZXBseU1lc3NhZ2U6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5RGlzcGF0Y2hlclxuICAgICAgICAuZGlzcGF0Y2hBc3luYyhtc2cuYm9keSwgbXNnKVxuICAgICAgICAuYmluZCh7XG4gICAgICAgICAgbWJveDogdGhpcy5fbWFpbGJveCxcbiAgICAgICAgICBlcnI6IG51bGwsXG4gICAgICAgICAgcmVzdWx0OiBudWxsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgdGhpcy5lcnIgPSBlcnIubWVzc2FnZTtcbiAgICAgICAgfSlcbiAgICAgICAgLmxhc3RseShmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLm1ib3gucmVwbHkobXNnLm1zZ0lkLCB7XG4gICAgICAgICAgICB0bzogbXNnLmZyb20sXG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgIG1UOiBNU0dfUkVQTFksXG4gICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBlcnI6IHRoaXMuZXJyLFxuICAgICAgICAgICAgICAgIHJlczogdGhpcy5yZXN1bHRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBDb3VyaWVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2Rpc3BhdGNoZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogVXRpbGl0eSBmb3IgZ2VuZXJhdGluZyBWNCBVVUlEcy4gRXhwb3J0cyBhIHNpbmdsZXRvbi5cbiAqL1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIHZhciBVVUlEID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoVVVJRC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuICAgIC8vIFNlZTogaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Vbml2ZXJzYWxseV91bmlxdWVfaWRlbnRpZmllciNWZXJzaW9uXzRfLjI4cmFuZG9tLjI5XG4gICAgdjQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24oYykge1xuICAgICAgICB2YXIgciA9IE1hdGgucmFuZG9tKCkgKiAxNiB8IDA7XG4gICAgICAgIC8vIDB4MyAgICAgICA9IDBiMDAwMTFcbiAgICAgICAgLy8gMHg4ICAgICAgID0gMGIwMTAwMFxuICAgICAgICAvLyAweDMgfCAweDggPSAwYjAxMDExXG4gICAgICAgIC8vIHIgJiAweDMgICA9ICgwYjAwMDAwIHwgMGIwMDAwMSB8IDBiMDAwMTAgfCAwYjAwMDExKVxuICAgICAgICB2YXIgdiA9IChjID09ICd4JyA/IHIgOiAociAmIDB4MyB8IDB4OCkpO1xuICAgICAgICByZXR1cm4gdi50b1N0cmluZygxNik7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBuZXcgVVVJRCgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIHJlZ2lzdHJ5IGZvciBtb2R1bGVzLiBBbGxvd3MgYW4gTlBNIHBhY2thZ2UgdG8gZXhwb3NlIGludGVybmFsIG1vZHVsZXMgd2l0aG91dCBuZWVkaW5nIHRvIGtub3cgdGhlIGV4cGxpY2l0XG4gICAqIGZpbGUgcGF0aCwgd2hpY2ggbWF5IGNoYW5nZSBmcm9tIHJlbGVhc2UgdG8gcmVsZWFzZS4gRWFjaCBtb2R1bGUgbWF5IGhhdmUgb25lIG9yIG1vcmUgYWxpYXNlcyB3aGljaCBjYW4gYmVcbiAgICogdXNlZCB0byByZXF1ZXN0IGl0IGxhdGVyLlxuICAgKlxuICAgKi9cbiAgdmFyIENvbXBvbmVudFJlZ2lzdHJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29tcG9uZW50UmVnaXN0cnkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9tb2R1bGVzID0ge307XG4gICAgfSxcblxuXG4gICAgcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgYWxpYXNlcyAgID0gb3B0cy5nZXRPckVycm9yKFwiYXNcIiksXG4gICAgICAgICAgbW9kT2JqZWN0ID0gb3B0cy5nZXRPckVycm9yKFwibW9kdWxlXCIpO1xuXG4gICAgICBpZiAoIV8uaXNBcnJheShhbGlhc2VzKSkge1xuICAgICAgICBhbGlhc2VzID0gWyBhbGlhc2VzIF07XG4gICAgICB9XG5cbiAgICAgIF8uZWFjaChhbGlhc2VzLCBfLmJpbmQoZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgICAgdGhpcy5fbW9kdWxlc1thbGlhc10gPSBtb2RPYmplY3Q7XG4gICAgICB9LCB0aGlzKSk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBzZWxmUmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyKHtcbiAgICAgICAgYXM6IG9wdHMuZ2V0T3JFcnJvcihcImFzXCIpLFxuICAgICAgICBtb2R1bGU6IENvbXBvbmVudFJlZ2lzdHJ5XG4gICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICByZWdpc3Rlck1hbnk6IGZ1bmN0aW9uKGFsaWFzZXNBcnkpIHtcbiAgICAgIF8uZWFjaChhbGlhc2VzQXJ5LCBfLmJpbmQoZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlcihhbGlhcyk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgY29tcG9uZW50OiBmdW5jdGlvbihhbGlhcykge1xuICAgICAgdmFyIG0gPSB0aGlzLl9tb2R1bGVzW2FsaWFzXTtcbiAgICAgIGlmICghbSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGFsaWFzIHByb3ZpZGVkIChubyBzdWNoIG1vZHVsZSk6IGBcIithbGlhcytcIidcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gbTtcbiAgICB9XG5cbiAgfSk7XG5cbiAgQ29tcG9uZW50UmVnaXN0cnkucHJvdG90eXBlLmMgPSBDb21wb25lbnRSZWdpc3RyeS5wcm90b3R5cGUuY29tcG9uZW50O1xuXG4gIHJldHVybiBDb21wb25lbnRSZWdpc3RyeTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuL3dlYi1zY2hlZHVsZXJcIik7XG4iLCIoZnVuY3Rpb24oKXsvLyAgICAgVW5kZXJzY29yZS5qcyAxLjYuMFxuLy8gICAgIGh0dHA6Ly91bmRlcnNjb3JlanMub3JnXG4vLyAgICAgKGMpIDIwMDktMjAxNCBKZXJlbXkgQXNoa2VuYXMsIERvY3VtZW50Q2xvdWQgYW5kIEludmVzdGlnYXRpdmUgUmVwb3J0ZXJzICYgRWRpdG9yc1xuLy8gICAgIFVuZGVyc2NvcmUgbWF5IGJlIGZyZWVseSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbihmdW5jdGlvbigpIHtcblxuICAvLyBCYXNlbGluZSBzZXR1cFxuICAvLyAtLS0tLS0tLS0tLS0tLVxuXG4gIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZXhwb3J0c2Agb24gdGhlIHNlcnZlci5cbiAgdmFyIHJvb3QgPSB0aGlzO1xuXG4gIC8vIFNhdmUgdGhlIHByZXZpb3VzIHZhbHVlIG9mIHRoZSBgX2AgdmFyaWFibGUuXG4gIHZhciBwcmV2aW91c1VuZGVyc2NvcmUgPSByb290Ll87XG5cbiAgLy8gRXN0YWJsaXNoIHRoZSBvYmplY3QgdGhhdCBnZXRzIHJldHVybmVkIHRvIGJyZWFrIG91dCBvZiBhIGxvb3AgaXRlcmF0aW9uLlxuICB2YXIgYnJlYWtlciA9IHt9O1xuXG4gIC8vIFNhdmUgYnl0ZXMgaW4gdGhlIG1pbmlmaWVkIChidXQgbm90IGd6aXBwZWQpIHZlcnNpb246XG4gIHZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlLCBPYmpQcm90byA9IE9iamVjdC5wcm90b3R5cGUsIEZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcblxuICAvLyBDcmVhdGUgcXVpY2sgcmVmZXJlbmNlIHZhcmlhYmxlcyBmb3Igc3BlZWQgYWNjZXNzIHRvIGNvcmUgcHJvdG90eXBlcy5cbiAgdmFyXG4gICAgcHVzaCAgICAgICAgICAgICA9IEFycmF5UHJvdG8ucHVzaCxcbiAgICBzbGljZSAgICAgICAgICAgID0gQXJyYXlQcm90by5zbGljZSxcbiAgICBjb25jYXQgICAgICAgICAgID0gQXJyYXlQcm90by5jb25jYXQsXG4gICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLFxuICAgIGhhc093blByb3BlcnR5ICAgPSBPYmpQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuICAvLyBBbGwgKipFQ01BU2NyaXB0IDUqKiBuYXRpdmUgZnVuY3Rpb24gaW1wbGVtZW50YXRpb25zIHRoYXQgd2UgaG9wZSB0byB1c2VcbiAgLy8gYXJlIGRlY2xhcmVkIGhlcmUuXG4gIHZhclxuICAgIG5hdGl2ZUZvckVhY2ggICAgICA9IEFycmF5UHJvdG8uZm9yRWFjaCxcbiAgICBuYXRpdmVNYXAgICAgICAgICAgPSBBcnJheVByb3RvLm1hcCxcbiAgICBuYXRpdmVSZWR1Y2UgICAgICAgPSBBcnJheVByb3RvLnJlZHVjZSxcbiAgICBuYXRpdmVSZWR1Y2VSaWdodCAgPSBBcnJheVByb3RvLnJlZHVjZVJpZ2h0LFxuICAgIG5hdGl2ZUZpbHRlciAgICAgICA9IEFycmF5UHJvdG8uZmlsdGVyLFxuICAgIG5hdGl2ZUV2ZXJ5ICAgICAgICA9IEFycmF5UHJvdG8uZXZlcnksXG4gICAgbmF0aXZlU29tZSAgICAgICAgID0gQXJyYXlQcm90by5zb21lLFxuICAgIG5hdGl2ZUluZGV4T2YgICAgICA9IEFycmF5UHJvdG8uaW5kZXhPZixcbiAgICBuYXRpdmVMYXN0SW5kZXhPZiAgPSBBcnJheVByb3RvLmxhc3RJbmRleE9mLFxuICAgIG5hdGl2ZUlzQXJyYXkgICAgICA9IEFycmF5LmlzQXJyYXksXG4gICAgbmF0aXZlS2V5cyAgICAgICAgID0gT2JqZWN0LmtleXMsXG4gICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQ7XG5cbiAgLy8gQ3JlYXRlIGEgc2FmZSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciB1c2UgYmVsb3cuXG4gIHZhciBfID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIF8pIHJldHVybiBvYmo7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIF8pKSByZXR1cm4gbmV3IF8ob2JqKTtcbiAgICB0aGlzLl93cmFwcGVkID0gb2JqO1xuICB9O1xuXG4gIC8vIEV4cG9ydCB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yICoqTm9kZS5qcyoqLCB3aXRoXG4gIC8vIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvciB0aGUgb2xkIGByZXF1aXJlKClgIEFQSS4gSWYgd2UncmUgaW5cbiAgLy8gdGhlIGJyb3dzZXIsIGFkZCBgX2AgYXMgYSBnbG9iYWwgb2JqZWN0IHZpYSBhIHN0cmluZyBpZGVudGlmaWVyLFxuICAvLyBmb3IgQ2xvc3VyZSBDb21waWxlciBcImFkdmFuY2VkXCIgbW9kZS5cbiAgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgICAgZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gXztcbiAgICB9XG4gICAgZXhwb3J0cy5fID0gXztcbiAgfSBlbHNlIHtcbiAgICByb290Ll8gPSBfO1xuICB9XG5cbiAgLy8gQ3VycmVudCB2ZXJzaW9uLlxuICBfLlZFUlNJT04gPSAnMS42LjAnO1xuXG4gIC8vIENvbGxlY3Rpb24gRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gVGhlIGNvcm5lcnN0b25lLCBhbiBgZWFjaGAgaW1wbGVtZW50YXRpb24sIGFrYSBgZm9yRWFjaGAuXG4gIC8vIEhhbmRsZXMgb2JqZWN0cyB3aXRoIHRoZSBidWlsdC1pbiBgZm9yRWFjaGAsIGFycmF5cywgYW5kIHJhdyBvYmplY3RzLlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZm9yRWFjaGAgaWYgYXZhaWxhYmxlLlxuICB2YXIgZWFjaCA9IF8uZWFjaCA9IF8uZm9yRWFjaCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiBvYmo7XG4gICAgaWYgKG5hdGl2ZUZvckVhY2ggJiYgb2JqLmZvckVhY2ggPT09IG5hdGl2ZUZvckVhY2gpIHtcbiAgICAgIG9iai5mb3JFYWNoKGl0ZXJhdG9yLCBjb250ZXh0KTtcbiAgICB9IGVsc2UgaWYgKG9iai5sZW5ndGggPT09ICtvYmoubGVuZ3RoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtpXSwgaSwgb2JqKSA9PT0gYnJlYWtlcikgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2tleXNbaV1dLCBrZXlzW2ldLCBvYmopID09PSBicmVha2VyKSByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRvciB0byBlYWNoIGVsZW1lbnQuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBtYXBgIGlmIGF2YWlsYWJsZS5cbiAgXy5tYXAgPSBfLmNvbGxlY3QgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHRzO1xuICAgIGlmIChuYXRpdmVNYXAgJiYgb2JqLm1hcCA9PT0gbmF0aXZlTWFwKSByZXR1cm4gb2JqLm1hcChpdGVyYXRvciwgY29udGV4dCk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgcmVzdWx0cy5wdXNoKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgdmFyIHJlZHVjZUVycm9yID0gJ1JlZHVjZSBvZiBlbXB0eSBhcnJheSB3aXRoIG5vIGluaXRpYWwgdmFsdWUnO1xuXG4gIC8vICoqUmVkdWNlKiogYnVpbGRzIHVwIGEgc2luZ2xlIHJlc3VsdCBmcm9tIGEgbGlzdCBvZiB2YWx1ZXMsIGFrYSBgaW5qZWN0YCxcbiAgLy8gb3IgYGZvbGRsYC4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHJlZHVjZWAgaWYgYXZhaWxhYmxlLlxuICBfLnJlZHVjZSA9IF8uZm9sZGwgPSBfLmluamVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIG1lbW8sIGNvbnRleHQpIHtcbiAgICB2YXIgaW5pdGlhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyO1xuICAgIGlmIChvYmogPT0gbnVsbCkgb2JqID0gW107XG4gICAgaWYgKG5hdGl2ZVJlZHVjZSAmJiBvYmoucmVkdWNlID09PSBuYXRpdmVSZWR1Y2UpIHtcbiAgICAgIGlmIChjb250ZXh0KSBpdGVyYXRvciA9IF8uYmluZChpdGVyYXRvciwgY29udGV4dCk7XG4gICAgICByZXR1cm4gaW5pdGlhbCA/IG9iai5yZWR1Y2UoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZShpdGVyYXRvcik7XG4gICAgfVxuICAgIGVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHtcbiAgICAgIGlmICghaW5pdGlhbCkge1xuICAgICAgICBtZW1vID0gdmFsdWU7XG4gICAgICAgIGluaXRpYWwgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWVtbyA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgbWVtbywgdmFsdWUsIGluZGV4LCBsaXN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBlRXJyb3IocmVkdWNlRXJyb3IpO1xuICAgIHJldHVybiBtZW1vO1xuICB9O1xuXG4gIC8vIFRoZSByaWdodC1hc3NvY2lhdGl2ZSB2ZXJzaW9uIG9mIHJlZHVjZSwgYWxzbyBrbm93biBhcyBgZm9sZHJgLlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgcmVkdWNlUmlnaHRgIGlmIGF2YWlsYWJsZS5cbiAgXy5yZWR1Y2VSaWdodCA9IF8uZm9sZHIgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBtZW1vLCBjb250ZXh0KSB7XG4gICAgdmFyIGluaXRpYWwgPSBhcmd1bWVudHMubGVuZ3RoID4gMjtcbiAgICBpZiAob2JqID09IG51bGwpIG9iaiA9IFtdO1xuICAgIGlmIChuYXRpdmVSZWR1Y2VSaWdodCAmJiBvYmoucmVkdWNlUmlnaHQgPT09IG5hdGl2ZVJlZHVjZVJpZ2h0KSB7XG4gICAgICBpZiAoY29udGV4dCkgaXRlcmF0b3IgPSBfLmJpbmQoaXRlcmF0b3IsIGNvbnRleHQpO1xuICAgICAgcmV0dXJuIGluaXRpYWwgPyBvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZVJpZ2h0KGl0ZXJhdG9yKTtcbiAgICB9XG4gICAgdmFyIGxlbmd0aCA9IG9iai5sZW5ndGg7XG4gICAgaWYgKGxlbmd0aCAhPT0gK2xlbmd0aCkge1xuICAgICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTtcbiAgICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIH1cbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpbmRleCA9IGtleXMgPyBrZXlzWy0tbGVuZ3RoXSA6IC0tbGVuZ3RoO1xuICAgICAgaWYgKCFpbml0aWFsKSB7XG4gICAgICAgIG1lbW8gPSBvYmpbaW5kZXhdO1xuICAgICAgICBpbml0aWFsID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lbW8gPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG1lbW8sIG9ialtpbmRleF0sIGluZGV4LCBsaXN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBlRXJyb3IocmVkdWNlRXJyb3IpO1xuICAgIHJldHVybiBtZW1vO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC5cbiAgXy5maW5kID0gXy5kZXRlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciByZXN1bHQ7XG4gICAgYW55KG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkge1xuICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyB0aGF0IHBhc3MgYSB0cnV0aCB0ZXN0LlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZmlsdGVyYCBpZiBhdmFpbGFibGUuXG4gIC8vIEFsaWFzZWQgYXMgYHNlbGVjdGAuXG4gIF8uZmlsdGVyID0gXy5zZWxlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0cztcbiAgICBpZiAobmF0aXZlRmlsdGVyICYmIG9iai5maWx0ZXIgPT09IG5hdGl2ZUZpbHRlcikgcmV0dXJuIG9iai5maWx0ZXIocHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkgcmVzdWx0cy5wdXNoKHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0aCB0ZXN0IGZhaWxzLlxuICBfLnJlamVjdCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICByZXR1cm4gIXByZWRpY2F0ZS5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCk7XG4gICAgfSwgY29udGV4dCk7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgYWxsIG9mIHRoZSBlbGVtZW50cyBtYXRjaCBhIHRydXRoIHRlc3QuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBldmVyeWAgaWYgYXZhaWxhYmxlLlxuICAvLyBBbGlhc2VkIGFzIGBhbGxgLlxuICBfLmV2ZXJ5ID0gXy5hbGwgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHByZWRpY2F0ZSB8fCAocHJlZGljYXRlID0gXy5pZGVudGl0eSk7XG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0O1xuICAgIGlmIChuYXRpdmVFdmVyeSAmJiBvYmouZXZlcnkgPT09IG5hdGl2ZUV2ZXJ5KSByZXR1cm4gb2JqLmV2ZXJ5KHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgaWYgKCEocmVzdWx0ID0gcmVzdWx0ICYmIHByZWRpY2F0ZS5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkpKSByZXR1cm4gYnJlYWtlcjtcbiAgICB9KTtcbiAgICByZXR1cm4gISFyZXN1bHQ7XG4gIH07XG5cbiAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBzb21lYCBpZiBhdmFpbGFibGUuXG4gIC8vIEFsaWFzZWQgYXMgYGFueWAuXG4gIHZhciBhbnkgPSBfLnNvbWUgPSBfLmFueSA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7XG4gICAgcHJlZGljYXRlIHx8IChwcmVkaWNhdGUgPSBfLmlkZW50aXR5KTtcbiAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0O1xuICAgIGlmIChuYXRpdmVTb21lICYmIG9iai5zb21lID09PSBuYXRpdmVTb21lKSByZXR1cm4gb2JqLnNvbWUocHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocmVzdWx0IHx8IChyZXN1bHQgPSBwcmVkaWNhdGUuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSkgcmV0dXJuIGJyZWFrZXI7XG4gICAgfSk7XG4gICAgcmV0dXJuICEhcmVzdWx0O1xuICB9O1xuXG4gIC8vIERldGVybWluZSBpZiB0aGUgYXJyYXkgb3Igb2JqZWN0IGNvbnRhaW5zIGEgZ2l2ZW4gdmFsdWUgKHVzaW5nIGA9PT1gKS5cbiAgLy8gQWxpYXNlZCBhcyBgaW5jbHVkZWAuXG4gIF8uY29udGFpbnMgPSBfLmluY2x1ZGUgPSBmdW5jdGlvbihvYmosIHRhcmdldCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChuYXRpdmVJbmRleE9mICYmIG9iai5pbmRleE9mID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gb2JqLmluZGV4T2YodGFyZ2V0KSAhPSAtMTtcbiAgICByZXR1cm4gYW55KG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gdGFyZ2V0O1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIEludm9rZSBhIG1ldGhvZCAod2l0aCBhcmd1bWVudHMpIG9uIGV2ZXJ5IGl0ZW0gaW4gYSBjb2xsZWN0aW9uLlxuICBfLmludm9rZSA9IGZ1bmN0aW9uKG9iaiwgbWV0aG9kKSB7XG4gICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG4gICAgdmFyIGlzRnVuYyA9IF8uaXNGdW5jdGlvbihtZXRob2QpO1xuICAgIHJldHVybiBfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gKGlzRnVuYyA/IG1ldGhvZCA6IHZhbHVlW21ldGhvZF0pLmFwcGx5KHZhbHVlLCBhcmdzKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBtYXBgOiBmZXRjaGluZyBhIHByb3BlcnR5LlxuICBfLnBsdWNrID0gZnVuY3Rpb24ob2JqLCBrZXkpIHtcbiAgICByZXR1cm4gXy5tYXAob2JqLCBfLnByb3BlcnR5KGtleSkpO1xuICB9O1xuXG4gIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYGZpbHRlcmA6IHNlbGVjdGluZyBvbmx5IG9iamVjdHNcbiAgLy8gY29udGFpbmluZyBzcGVjaWZpYyBga2V5OnZhbHVlYCBwYWlycy5cbiAgXy53aGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHtcbiAgICByZXR1cm4gXy5maWx0ZXIob2JqLCBfLm1hdGNoZXMoYXR0cnMpKTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBmaW5kYDogZ2V0dGluZyB0aGUgZmlyc3Qgb2JqZWN0XG4gIC8vIGNvbnRhaW5pbmcgc3BlY2lmaWMgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8uZmluZFdoZXJlID0gZnVuY3Rpb24ob2JqLCBhdHRycykge1xuICAgIHJldHVybiBfLmZpbmQob2JqLCBfLm1hdGNoZXMoYXR0cnMpKTtcbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIG1heGltdW0gZWxlbWVudCBvciAoZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuXG4gIC8vIENhbid0IG9wdGltaXplIGFycmF5cyBvZiBpbnRlZ2VycyBsb25nZXIgdGhhbiA2NSw1MzUgZWxlbWVudHMuXG4gIC8vIFNlZSBbV2ViS2l0IEJ1ZyA4MDc5N10oaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTgwNzk3KVxuICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpZiAoIWl0ZXJhdG9yICYmIF8uaXNBcnJheShvYmopICYmIG9ialswXSA9PT0gK29ialswXSAmJiBvYmoubGVuZ3RoIDwgNjU1MzUpIHtcbiAgICAgIHJldHVybiBNYXRoLm1heC5hcHBseShNYXRoLCBvYmopO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgdmFyIGNvbXB1dGVkID0gaXRlcmF0b3IgPyBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkgOiB2YWx1ZTtcbiAgICAgIGlmIChjb21wdXRlZCA+IGxhc3RDb21wdXRlZCkge1xuICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIG1pbmltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuXG4gIF8ubWluID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIGlmICghaXRlcmF0b3IgJiYgXy5pc0FycmF5KG9iaikgJiYgb2JqWzBdID09PSArb2JqWzBdICYmIG9iai5sZW5ndGggPCA2NTUzNSkge1xuICAgICAgcmV0dXJuIE1hdGgubWluLmFwcGx5KE1hdGgsIG9iaik7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBJbmZpbml0eSwgbGFzdENvbXB1dGVkID0gSW5maW5pdHk7XG4gICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgdmFyIGNvbXB1dGVkID0gaXRlcmF0b3IgPyBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkgOiB2YWx1ZTtcbiAgICAgIGlmIChjb21wdXRlZCA8IGxhc3RDb21wdXRlZCkge1xuICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBTaHVmZmxlIGFuIGFycmF5LCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlXG4gIC8vIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXLigJNZYXRlc19zaHVmZmxlKS5cbiAgXy5zaHVmZmxlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHJhbmQ7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgc2h1ZmZsZWQgPSBbXTtcbiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJhbmQgPSBfLnJhbmRvbShpbmRleCsrKTtcbiAgICAgIHNodWZmbGVkW2luZGV4IC0gMV0gPSBzaHVmZmxlZFtyYW5kXTtcbiAgICAgIHNodWZmbGVkW3JhbmRdID0gdmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHNodWZmbGVkO1xuICB9O1xuXG4gIC8vIFNhbXBsZSAqKm4qKiByYW5kb20gdmFsdWVzIGZyb20gYSBjb2xsZWN0aW9uLlxuICAvLyBJZiAqKm4qKiBpcyBub3Qgc3BlY2lmaWVkLCByZXR1cm5zIGEgc2luZ2xlIHJhbmRvbSBlbGVtZW50LlxuICAvLyBUaGUgaW50ZXJuYWwgYGd1YXJkYCBhcmd1bWVudCBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBtYXBgLlxuICBfLnNhbXBsZSA9IGZ1bmN0aW9uKG9iaiwgbiwgZ3VhcmQpIHtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSB7XG4gICAgICBpZiAob2JqLmxlbmd0aCAhPT0gK29iai5sZW5ndGgpIG9iaiA9IF8udmFsdWVzKG9iaik7XG4gICAgICByZXR1cm4gb2JqW18ucmFuZG9tKG9iai5sZW5ndGggLSAxKV07XG4gICAgfVxuICAgIHJldHVybiBfLnNodWZmbGUob2JqKS5zbGljZSgwLCBNYXRoLm1heCgwLCBuKSk7XG4gIH07XG5cbiAgLy8gQW4gaW50ZXJuYWwgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgbG9va3VwIGl0ZXJhdG9ycy5cbiAgdmFyIGxvb2t1cEl0ZXJhdG9yID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIF8uaWRlbnRpdHk7XG4gICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHJldHVybiB2YWx1ZTtcbiAgICByZXR1cm4gXy5wcm9wZXJ0eSh2YWx1ZSk7XG4gIH07XG5cbiAgLy8gU29ydCB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uIHByb2R1Y2VkIGJ5IGFuIGl0ZXJhdG9yLlxuICBfLnNvcnRCeSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRvciA9IGxvb2t1cEl0ZXJhdG9yKGl0ZXJhdG9yKTtcbiAgICByZXR1cm4gXy5wbHVjayhfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgIGNyaXRlcmlhOiBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdClcbiAgICAgIH07XG4gICAgfSkuc29ydChmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICAgICAgdmFyIGEgPSBsZWZ0LmNyaXRlcmlhO1xuICAgICAgdmFyIGIgPSByaWdodC5jcml0ZXJpYTtcbiAgICAgIGlmIChhICE9PSBiKSB7XG4gICAgICAgIGlmIChhID4gYiB8fCBhID09PSB2b2lkIDApIHJldHVybiAxO1xuICAgICAgICBpZiAoYSA8IGIgfHwgYiA9PT0gdm9pZCAwKSByZXR1cm4gLTE7XG4gICAgICB9XG4gICAgICByZXR1cm4gbGVmdC5pbmRleCAtIHJpZ2h0LmluZGV4O1xuICAgIH0pLCAndmFsdWUnKTtcbiAgfTtcblxuICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiB1c2VkIGZvciBhZ2dyZWdhdGUgXCJncm91cCBieVwiIG9wZXJhdGlvbnMuXG4gIHZhciBncm91cCA9IGZ1bmN0aW9uKGJlaGF2aW9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgIGl0ZXJhdG9yID0gbG9va3VwSXRlcmF0b3IoaXRlcmF0b3IpO1xuICAgICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuICAgICAgICB2YXIga2V5ID0gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIG9iaik7XG4gICAgICAgIGJlaGF2aW9yKHJlc3VsdCwga2V5LCB2YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBHcm91cHMgdGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbi4gUGFzcyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlXG4gIC8vIHRvIGdyb3VwIGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgY3JpdGVyaW9uLlxuICBfLmdyb3VwQnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIGtleSwgdmFsdWUpIHtcbiAgICBfLmhhcyhyZXN1bHQsIGtleSkgPyByZXN1bHRba2V5XS5wdXNoKHZhbHVlKSA6IHJlc3VsdFtrZXldID0gW3ZhbHVlXTtcbiAgfSk7XG5cbiAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvclxuICAvLyB3aGVuIHlvdSBrbm93IHRoYXQgeW91ciBpbmRleCB2YWx1ZXMgd2lsbCBiZSB1bmlxdWUuXG4gIF8uaW5kZXhCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwga2V5LCB2YWx1ZSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIC8vIENvdW50cyBpbnN0YW5jZXMgb2YgYW4gb2JqZWN0IHRoYXQgZ3JvdXAgYnkgYSBjZXJ0YWluIGNyaXRlcmlvbi4gUGFzc1xuICAvLyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlIHRvIGNvdW50IGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGVcbiAgLy8gY3JpdGVyaW9uLlxuICBfLmNvdW50QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIGtleSkge1xuICAgIF8uaGFzKHJlc3VsdCwga2V5KSA/IHJlc3VsdFtrZXldKysgOiByZXN1bHRba2V5XSA9IDE7XG4gIH0pO1xuXG4gIC8vIFVzZSBhIGNvbXBhcmF0b3IgZnVuY3Rpb24gdG8gZmlndXJlIG91dCB0aGUgc21hbGxlc3QgaW5kZXggYXQgd2hpY2hcbiAgLy8gYW4gb2JqZWN0IHNob3VsZCBiZSBpbnNlcnRlZCBzbyBhcyB0byBtYWludGFpbiBvcmRlci4gVXNlcyBiaW5hcnkgc2VhcmNoLlxuICBfLnNvcnRlZEluZGV4ID0gZnVuY3Rpb24oYXJyYXksIG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRvciA9IGxvb2t1cEl0ZXJhdG9yKGl0ZXJhdG9yKTtcbiAgICB2YXIgdmFsdWUgPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9iaik7XG4gICAgdmFyIGxvdyA9IDAsIGhpZ2ggPSBhcnJheS5sZW5ndGg7XG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgIHZhciBtaWQgPSAobG93ICsgaGlnaCkgPj4+IDE7XG4gICAgICBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGFycmF5W21pZF0pIDwgdmFsdWUgPyBsb3cgPSBtaWQgKyAxIDogaGlnaCA9IG1pZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbiAgfTtcblxuICAvLyBTYWZlbHkgY3JlYXRlIGEgcmVhbCwgbGl2ZSBhcnJheSBmcm9tIGFueXRoaW5nIGl0ZXJhYmxlLlxuICBfLnRvQXJyYXkgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIW9iaikgcmV0dXJuIFtdO1xuICAgIGlmIChfLmlzQXJyYXkob2JqKSkgcmV0dXJuIHNsaWNlLmNhbGwob2JqKTtcbiAgICBpZiAob2JqLmxlbmd0aCA9PT0gK29iai5sZW5ndGgpIHJldHVybiBfLm1hcChvYmosIF8uaWRlbnRpdHkpO1xuICAgIHJldHVybiBfLnZhbHVlcyhvYmopO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC5cbiAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gMDtcbiAgICByZXR1cm4gKG9iai5sZW5ndGggPT09ICtvYmoubGVuZ3RoKSA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7XG4gIH07XG5cbiAgLy8gQXJyYXkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIEdldCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheS4gUGFzc2luZyAqKm4qKiB3aWxsIHJldHVybiB0aGUgZmlyc3QgTlxuICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LiBBbGlhc2VkIGFzIGBoZWFkYCBhbmQgYHRha2VgLiBUaGUgKipndWFyZCoqIGNoZWNrXG4gIC8vIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC5cbiAgXy5maXJzdCA9IF8uaGVhZCA9IF8udGFrZSA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIGlmICgobiA9PSBudWxsKSB8fCBndWFyZCkgcmV0dXJuIGFycmF5WzBdO1xuICAgIGlmIChuIDwgMCkgcmV0dXJuIFtdO1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBuKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBsYXN0IGVudHJ5IG9mIHRoZSBhcnJheS4gRXNwZWNpYWxseSB1c2VmdWwgb25cbiAgLy8gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gYWxsIHRoZSB2YWx1ZXMgaW5cbiAgLy8gdGhlIGFycmF5LCBleGNsdWRpbmcgdGhlIGxhc3QgTi4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoXG4gIC8vIGBfLm1hcGAuXG4gIF8uaW5pdGlhbCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBhcnJheS5sZW5ndGggLSAoKG4gPT0gbnVsbCkgfHwgZ3VhcmQgPyAxIDogbikpO1xuICB9O1xuXG4gIC8vIEdldCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBsYXN0IE5cbiAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuXG4gIF8ubGFzdCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIGlmICgobiA9PSBudWxsKSB8fCBndWFyZCkgcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdO1xuICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCBNYXRoLm1heChhcnJheS5sZW5ndGggLSBuLCAwKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBldmVyeXRoaW5nIGJ1dCB0aGUgZmlyc3QgZW50cnkgb2YgdGhlIGFycmF5LiBBbGlhc2VkIGFzIGB0YWlsYCBhbmQgYGRyb3BgLlxuICAvLyBFc3BlY2lhbGx5IHVzZWZ1bCBvbiB0aGUgYXJndW1lbnRzIG9iamVjdC4gUGFzc2luZyBhbiAqKm4qKiB3aWxsIHJldHVyblxuICAvLyB0aGUgcmVzdCBOIHZhbHVlcyBpbiB0aGUgYXJyYXkuIFRoZSAqKmd1YXJkKipcbiAgLy8gY2hlY2sgYWxsb3dzIGl0IHRvIHdvcmsgd2l0aCBgXy5tYXBgLlxuICBfLnJlc3QgPSBfLnRhaWwgPSBfLmRyb3AgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgKG4gPT0gbnVsbCkgfHwgZ3VhcmQgPyAxIDogbik7XG4gIH07XG5cbiAgLy8gVHJpbSBvdXQgYWxsIGZhbHN5IHZhbHVlcyBmcm9tIGFuIGFycmF5LlxuICBfLmNvbXBhY3QgPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgXy5pZGVudGl0eSk7XG4gIH07XG5cbiAgLy8gSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gb2YgYSByZWN1cnNpdmUgYGZsYXR0ZW5gIGZ1bmN0aW9uLlxuICB2YXIgZmxhdHRlbiA9IGZ1bmN0aW9uKGlucHV0LCBzaGFsbG93LCBvdXRwdXQpIHtcbiAgICBpZiAoc2hhbGxvdyAmJiBfLmV2ZXJ5KGlucHV0LCBfLmlzQXJyYXkpKSB7XG4gICAgICByZXR1cm4gY29uY2F0LmFwcGx5KG91dHB1dCwgaW5wdXQpO1xuICAgIH1cbiAgICBlYWNoKGlucHV0LCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKF8uaXNBcnJheSh2YWx1ZSkgfHwgXy5pc0FyZ3VtZW50cyh2YWx1ZSkpIHtcbiAgICAgICAgc2hhbGxvdyA/IHB1c2guYXBwbHkob3V0cHV0LCB2YWx1ZSkgOiBmbGF0dGVuKHZhbHVlLCBzaGFsbG93LCBvdXRwdXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3V0cHV0LnB1c2godmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG5cbiAgLy8gRmxhdHRlbiBvdXQgYW4gYXJyYXksIGVpdGhlciByZWN1cnNpdmVseSAoYnkgZGVmYXVsdCksIG9yIGp1c3Qgb25lIGxldmVsLlxuICBfLmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSwgc2hhbGxvdykge1xuICAgIHJldHVybiBmbGF0dGVuKGFycmF5LCBzaGFsbG93LCBbXSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgdmVyc2lvbiBvZiB0aGUgYXJyYXkgdGhhdCBkb2VzIG5vdCBjb250YWluIHRoZSBzcGVjaWZpZWQgdmFsdWUocykuXG4gIF8ud2l0aG91dCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8uZGlmZmVyZW5jZShhcnJheSwgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgfTtcblxuICAvLyBTcGxpdCBhbiBhcnJheSBpbnRvIHR3byBhcnJheXM6IG9uZSB3aG9zZSBlbGVtZW50cyBhbGwgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgLy8gcHJlZGljYXRlLCBhbmQgb25lIHdob3NlIGVsZW1lbnRzIGFsbCBkbyBub3Qgc2F0aXNmeSB0aGUgcHJlZGljYXRlLlxuICBfLnBhcnRpdGlvbiA9IGZ1bmN0aW9uKGFycmF5LCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgcGFzcyA9IFtdLCBmYWlsID0gW107XG4gICAgZWFjaChhcnJheSwgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgKHByZWRpY2F0ZShlbGVtKSA/IHBhc3MgOiBmYWlsKS5wdXNoKGVsZW0pO1xuICAgIH0pO1xuICAgIHJldHVybiBbcGFzcywgZmFpbF07XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhIGR1cGxpY2F0ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGFycmF5LiBJZiB0aGUgYXJyYXkgaGFzIGFscmVhZHlcbiAgLy8gYmVlbiBzb3J0ZWQsIHlvdSBoYXZlIHRoZSBvcHRpb24gb2YgdXNpbmcgYSBmYXN0ZXIgYWxnb3JpdGhtLlxuICAvLyBBbGlhc2VkIGFzIGB1bmlxdWVgLlxuICBfLnVuaXEgPSBfLnVuaXF1ZSA9IGZ1bmN0aW9uKGFycmF5LCBpc1NvcnRlZCwgaXRlcmF0b3IsIGNvbnRleHQpIHtcbiAgICBpZiAoXy5pc0Z1bmN0aW9uKGlzU29ydGVkKSkge1xuICAgICAgY29udGV4dCA9IGl0ZXJhdG9yO1xuICAgICAgaXRlcmF0b3IgPSBpc1NvcnRlZDtcbiAgICAgIGlzU29ydGVkID0gZmFsc2U7XG4gICAgfVxuICAgIHZhciBpbml0aWFsID0gaXRlcmF0b3IgPyBfLm1hcChhcnJheSwgaXRlcmF0b3IsIGNvbnRleHQpIDogYXJyYXk7XG4gICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICB2YXIgc2VlbiA9IFtdO1xuICAgIGVhY2goaW5pdGlhbCwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgICBpZiAoaXNTb3J0ZWQgPyAoIWluZGV4IHx8IHNlZW5bc2Vlbi5sZW5ndGggLSAxXSAhPT0gdmFsdWUpIDogIV8uY29udGFpbnMoc2VlbiwgdmFsdWUpKSB7XG4gICAgICAgIHNlZW4ucHVzaCh2YWx1ZSk7XG4gICAgICAgIHJlc3VsdHMucHVzaChhcnJheVtpbmRleF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8vIFByb2R1Y2UgYW4gYXJyYXkgdGhhdCBjb250YWlucyB0aGUgdW5pb246IGVhY2ggZGlzdGluY3QgZWxlbWVudCBmcm9tIGFsbCBvZlxuICAvLyB0aGUgcGFzc2VkLWluIGFycmF5cy5cbiAgXy51bmlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfLnVuaXEoXy5mbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSkpO1xuICB9O1xuXG4gIC8vIFByb2R1Y2UgYW4gYXJyYXkgdGhhdCBjb250YWlucyBldmVyeSBpdGVtIHNoYXJlZCBiZXR3ZWVuIGFsbCB0aGVcbiAgLy8gcGFzc2VkLWluIGFycmF5cy5cbiAgXy5pbnRlcnNlY3Rpb24gPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHZhciByZXN0ID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIHJldHVybiBfLmZpbHRlcihfLnVuaXEoYXJyYXkpLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICByZXR1cm4gXy5ldmVyeShyZXN0LCBmdW5jdGlvbihvdGhlcikge1xuICAgICAgICByZXR1cm4gXy5jb250YWlucyhvdGhlciwgaXRlbSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBUYWtlIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gb25lIGFycmF5IGFuZCBhIG51bWJlciBvZiBvdGhlciBhcnJheXMuXG4gIC8vIE9ubHkgdGhlIGVsZW1lbnRzIHByZXNlbnQgaW4ganVzdCB0aGUgZmlyc3QgYXJyYXkgd2lsbCByZW1haW4uXG4gIF8uZGlmZmVyZW5jZSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgdmFyIHJlc3QgPSBjb25jYXQuYXBwbHkoQXJyYXlQcm90bywgc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcbiAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKXsgcmV0dXJuICFfLmNvbnRhaW5zKHJlc3QsIHZhbHVlKTsgfSk7XG4gIH07XG5cbiAgLy8gWmlwIHRvZ2V0aGVyIG11bHRpcGxlIGxpc3RzIGludG8gYSBzaW5nbGUgYXJyYXkgLS0gZWxlbWVudHMgdGhhdCBzaGFyZVxuICAvLyBhbiBpbmRleCBnbyB0b2dldGhlci5cbiAgXy56aXAgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgbGVuZ3RoID0gXy5tYXgoXy5wbHVjayhhcmd1bWVudHMsICdsZW5ndGgnKS5jb25jYXQoMCkpO1xuICAgIHZhciByZXN1bHRzID0gbmV3IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0c1tpXSA9IF8ucGx1Y2soYXJndW1lbnRzLCAnJyArIGkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvLyBDb252ZXJ0cyBsaXN0cyBpbnRvIG9iamVjdHMuIFBhc3MgZWl0aGVyIGEgc2luZ2xlIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gXG4gIC8vIHBhaXJzLCBvciB0d28gcGFyYWxsZWwgYXJyYXlzIG9mIHRoZSBzYW1lIGxlbmd0aCAtLSBvbmUgb2Yga2V5cywgYW5kIG9uZSBvZlxuICAvLyB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZXMuXG4gIF8ub2JqZWN0ID0gZnVuY3Rpb24obGlzdCwgdmFsdWVzKSB7XG4gICAgaWYgKGxpc3QgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gbGlzdC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHZhbHVlcykge1xuICAgICAgICByZXN1bHRbbGlzdFtpXV0gPSB2YWx1ZXNbaV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRbbGlzdFtpXVswXV0gPSBsaXN0W2ldWzFdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIElmIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcGx5IHVzIHdpdGggaW5kZXhPZiAoSSdtIGxvb2tpbmcgYXQgeW91LCAqKk1TSUUqKiksXG4gIC8vIHdlIG5lZWQgdGhpcyBmdW5jdGlvbi4gUmV0dXJuIHRoZSBwb3NpdGlvbiBvZiB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhblxuICAvLyBpdGVtIGluIGFuIGFycmF5LCBvciAtMSBpZiB0aGUgaXRlbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGFycmF5LlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgaW5kZXhPZmAgaWYgYXZhaWxhYmxlLlxuICAvLyBJZiB0aGUgYXJyYXkgaXMgbGFyZ2UgYW5kIGFscmVhZHkgaW4gc29ydCBvcmRlciwgcGFzcyBgdHJ1ZWBcbiAgLy8gZm9yICoqaXNTb3J0ZWQqKiB0byB1c2UgYmluYXJ5IHNlYXJjaC5cbiAgXy5pbmRleE9mID0gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGlzU29ydGVkKSB7XG4gICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiAtMTtcbiAgICB2YXIgaSA9IDAsIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgICBpZiAoaXNTb3J0ZWQpIHtcbiAgICAgIGlmICh0eXBlb2YgaXNTb3J0ZWQgPT0gJ251bWJlcicpIHtcbiAgICAgICAgaSA9IChpc1NvcnRlZCA8IDAgPyBNYXRoLm1heCgwLCBsZW5ndGggKyBpc1NvcnRlZCkgOiBpc1NvcnRlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpID0gXy5zb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7XG4gICAgICAgIHJldHVybiBhcnJheVtpXSA9PT0gaXRlbSA/IGkgOiAtMTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG5hdGl2ZUluZGV4T2YgJiYgYXJyYXkuaW5kZXhPZiA9PT0gbmF0aXZlSW5kZXhPZikgcmV0dXJuIGFycmF5LmluZGV4T2YoaXRlbSwgaXNTb3J0ZWQpO1xuICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIGlmIChhcnJheVtpXSA9PT0gaXRlbSkgcmV0dXJuIGk7XG4gICAgcmV0dXJuIC0xO1xuICB9O1xuXG4gIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBsYXN0SW5kZXhPZmAgaWYgYXZhaWxhYmxlLlxuICBfLmxhc3RJbmRleE9mID0gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGZyb20pIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xO1xuICAgIHZhciBoYXNJbmRleCA9IGZyb20gIT0gbnVsbDtcbiAgICBpZiAobmF0aXZlTGFzdEluZGV4T2YgJiYgYXJyYXkubGFzdEluZGV4T2YgPT09IG5hdGl2ZUxhc3RJbmRleE9mKSB7XG4gICAgICByZXR1cm4gaGFzSW5kZXggPyBhcnJheS5sYXN0SW5kZXhPZihpdGVtLCBmcm9tKSA6IGFycmF5Lmxhc3RJbmRleE9mKGl0ZW0pO1xuICAgIH1cbiAgICB2YXIgaSA9IChoYXNJbmRleCA/IGZyb20gOiBhcnJheS5sZW5ndGgpO1xuICAgIHdoaWxlIChpLS0pIGlmIChhcnJheVtpXSA9PT0gaXRlbSkgcmV0dXJuIGk7XG4gICAgcmV0dXJuIC0xO1xuICB9O1xuXG4gIC8vIEdlbmVyYXRlIGFuIGludGVnZXIgQXJyYXkgY29udGFpbmluZyBhbiBhcml0aG1ldGljIHByb2dyZXNzaW9uLiBBIHBvcnQgb2ZcbiAgLy8gdGhlIG5hdGl2ZSBQeXRob24gYHJhbmdlKClgIGZ1bmN0aW9uLiBTZWVcbiAgLy8gW3RoZSBQeXRob24gZG9jdW1lbnRhdGlvbl0oaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI3JhbmdlKS5cbiAgXy5yYW5nZSA9IGZ1bmN0aW9uKHN0YXJ0LCBzdG9wLCBzdGVwKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPD0gMSkge1xuICAgICAgc3RvcCA9IHN0YXJ0IHx8IDA7XG4gICAgICBzdGFydCA9IDA7XG4gICAgfVxuICAgIHN0ZXAgPSBhcmd1bWVudHNbMl0gfHwgMTtcblxuICAgIHZhciBsZW5ndGggPSBNYXRoLm1heChNYXRoLmNlaWwoKHN0b3AgLSBzdGFydCkgLyBzdGVwKSwgMCk7XG4gICAgdmFyIGlkeCA9IDA7XG4gICAgdmFyIHJhbmdlID0gbmV3IEFycmF5KGxlbmd0aCk7XG5cbiAgICB3aGlsZShpZHggPCBsZW5ndGgpIHtcbiAgICAgIHJhbmdlW2lkeCsrXSA9IHN0YXJ0O1xuICAgICAgc3RhcnQgKz0gc3RlcDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmFuZ2U7XG4gIH07XG5cbiAgLy8gRnVuY3Rpb24gKGFoZW0pIEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBSZXVzYWJsZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiBmb3IgcHJvdG90eXBlIHNldHRpbmcuXG4gIHZhciBjdG9yID0gZnVuY3Rpb24oKXt9O1xuXG4gIC8vIENyZWF0ZSBhIGZ1bmN0aW9uIGJvdW5kIHRvIGEgZ2l2ZW4gb2JqZWN0IChhc3NpZ25pbmcgYHRoaXNgLCBhbmQgYXJndW1lbnRzLFxuICAvLyBvcHRpb25hbGx5KS4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYEZ1bmN0aW9uLmJpbmRgIGlmXG4gIC8vIGF2YWlsYWJsZS5cbiAgXy5iaW5kID0gZnVuY3Rpb24oZnVuYywgY29udGV4dCkge1xuICAgIHZhciBhcmdzLCBib3VuZDtcbiAgICBpZiAobmF0aXZlQmluZCAmJiBmdW5jLmJpbmQgPT09IG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgaWYgKCFfLmlzRnVuY3Rpb24oZnVuYykpIHRocm93IG5ldyBUeXBlRXJyb3I7XG4gICAgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcbiAgICByZXR1cm4gYm91bmQgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBib3VuZCkpIHJldHVybiBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MuY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xuICAgICAgY3Rvci5wcm90b3R5cGUgPSBmdW5jLnByb3RvdHlwZTtcbiAgICAgIHZhciBzZWxmID0gbmV3IGN0b3I7XG4gICAgICBjdG9yLnByb3RvdHlwZSA9IG51bGw7XG4gICAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseShzZWxmLCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTtcbiAgICAgIGlmIChPYmplY3QocmVzdWx0KSA9PT0gcmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfTtcbiAgfTtcblxuICAvLyBQYXJ0aWFsbHkgYXBwbHkgYSBmdW5jdGlvbiBieSBjcmVhdGluZyBhIHZlcnNpb24gdGhhdCBoYXMgaGFkIHNvbWUgb2YgaXRzXG4gIC8vIGFyZ3VtZW50cyBwcmUtZmlsbGVkLCB3aXRob3V0IGNoYW5naW5nIGl0cyBkeW5hbWljIGB0aGlzYCBjb250ZXh0LiBfIGFjdHNcbiAgLy8gYXMgYSBwbGFjZWhvbGRlciwgYWxsb3dpbmcgYW55IGNvbWJpbmF0aW9uIG9mIGFyZ3VtZW50cyB0byBiZSBwcmUtZmlsbGVkLlxuICBfLnBhcnRpYWwgPSBmdW5jdGlvbihmdW5jKSB7XG4gICAgdmFyIGJvdW5kQXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcG9zaXRpb24gPSAwO1xuICAgICAgdmFyIGFyZ3MgPSBib3VuZEFyZ3Muc2xpY2UoKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBhcmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhcmdzW2ldID09PSBfKSBhcmdzW2ldID0gYXJndW1lbnRzW3Bvc2l0aW9uKytdO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgYXJndW1lbnRzLmxlbmd0aCkgYXJncy5wdXNoKGFyZ3VtZW50c1twb3NpdGlvbisrXSk7XG4gICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEJpbmQgYSBudW1iZXIgb2YgYW4gb2JqZWN0J3MgbWV0aG9kcyB0byB0aGF0IG9iamVjdC4gUmVtYWluaW5nIGFyZ3VtZW50c1xuICAvLyBhcmUgdGhlIG1ldGhvZCBuYW1lcyB0byBiZSBib3VuZC4gVXNlZnVsIGZvciBlbnN1cmluZyB0aGF0IGFsbCBjYWxsYmFja3NcbiAgLy8gZGVmaW5lZCBvbiBhbiBvYmplY3QgYmVsb25nIHRvIGl0LlxuICBfLmJpbmRBbGwgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgZnVuY3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgaWYgKGZ1bmNzLmxlbmd0aCA9PT0gMCkgdGhyb3cgbmV3IEVycm9yKCdiaW5kQWxsIG11c3QgYmUgcGFzc2VkIGZ1bmN0aW9uIG5hbWVzJyk7XG4gICAgZWFjaChmdW5jcywgZnVuY3Rpb24oZikgeyBvYmpbZl0gPSBfLmJpbmQob2JqW2ZdLCBvYmopOyB9KTtcbiAgICByZXR1cm4gb2JqO1xuICB9O1xuXG4gIC8vIE1lbW9pemUgYW4gZXhwZW5zaXZlIGZ1bmN0aW9uIGJ5IHN0b3JpbmcgaXRzIHJlc3VsdHMuXG4gIF8ubWVtb2l6ZSA9IGZ1bmN0aW9uKGZ1bmMsIGhhc2hlcikge1xuICAgIHZhciBtZW1vID0ge307XG4gICAgaGFzaGVyIHx8IChoYXNoZXIgPSBfLmlkZW50aXR5KTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIga2V5ID0gaGFzaGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICByZXR1cm4gXy5oYXMobWVtbywga2V5KSA/IG1lbW9ba2V5XSA6IChtZW1vW2tleV0gPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgIH07XG4gIH07XG5cbiAgLy8gRGVsYXlzIGEgZnVuY3Rpb24gZm9yIHRoZSBnaXZlbiBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLCBhbmQgdGhlbiBjYWxsc1xuICAvLyBpdCB3aXRoIHRoZSBhcmd1bWVudHMgc3VwcGxpZWQuXG4gIF8uZGVsYXkgPSBmdW5jdGlvbihmdW5jLCB3YWl0KSB7XG4gICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgcmV0dXJuIGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7IH0sIHdhaXQpO1xuICB9O1xuXG4gIC8vIERlZmVycyBhIGZ1bmN0aW9uLCBzY2hlZHVsaW5nIGl0IHRvIHJ1biBhZnRlciB0aGUgY3VycmVudCBjYWxsIHN0YWNrIGhhc1xuICAvLyBjbGVhcmVkLlxuICBfLmRlZmVyID0gZnVuY3Rpb24oZnVuYykge1xuICAgIHJldHVybiBfLmRlbGF5LmFwcGx5KF8sIFtmdW5jLCAxXS5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCB3aGVuIGludm9rZWQsIHdpbGwgb25seSBiZSB0cmlnZ2VyZWQgYXQgbW9zdCBvbmNlXG4gIC8vIGR1cmluZyBhIGdpdmVuIHdpbmRvdyBvZiB0aW1lLiBOb3JtYWxseSwgdGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIHJ1blxuICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247XG4gIC8vIGJ1dCBpZiB5b3UnZCBsaWtlIHRvIGRpc2FibGUgdGhlIGV4ZWN1dGlvbiBvbiB0aGUgbGVhZGluZyBlZGdlLCBwYXNzXG4gIC8vIGB7bGVhZGluZzogZmFsc2V9YC4gVG8gZGlzYWJsZSBleGVjdXRpb24gb24gdGhlIHRyYWlsaW5nIGVkZ2UsIGRpdHRvLlxuICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgb3B0aW9ucykge1xuICAgIHZhciBjb250ZXh0LCBhcmdzLCByZXN1bHQ7XG4gICAgdmFyIHRpbWVvdXQgPSBudWxsO1xuICAgIHZhciBwcmV2aW91cyA9IDA7XG4gICAgb3B0aW9ucyB8fCAob3B0aW9ucyA9IHt9KTtcbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIHByZXZpb3VzID0gb3B0aW9ucy5sZWFkaW5nID09PSBmYWxzZSA/IDAgOiBfLm5vdygpO1xuICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vdyA9IF8ubm93KCk7XG4gICAgICBpZiAoIXByZXZpb3VzICYmIG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UpIHByZXZpb3VzID0gbm93O1xuICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpO1xuICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgaWYgKHJlbWFpbmluZyA8PSAwKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIHByZXZpb3VzID0gbm93O1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XG4gICAgICB9IGVsc2UgaWYgKCF0aW1lb3V0ICYmIG9wdGlvbnMudHJhaWxpbmcgIT09IGZhbHNlKSB7XG4gICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCByZW1haW5pbmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3RcbiAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvclxuICAvLyBOIG1pbGxpc2Vjb25kcy4gSWYgYGltbWVkaWF0ZWAgaXMgcGFzc2VkLCB0cmlnZ2VyIHRoZSBmdW5jdGlvbiBvbiB0aGVcbiAgLy8gbGVhZGluZyBlZGdlLCBpbnN0ZWFkIG9mIHRoZSB0cmFpbGluZy5cbiAgXy5kZWJvdW5jZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuICAgIHZhciB0aW1lb3V0LCBhcmdzLCBjb250ZXh0LCB0aW1lc3RhbXAsIHJlc3VsdDtcblxuICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGxhc3QgPSBfLm5vdygpIC0gdGltZXN0YW1wO1xuICAgICAgaWYgKGxhc3QgPCB3YWl0KSB7XG4gICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0IC0gbGFzdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgICAgaWYgKCFpbW1lZGlhdGUpIHtcbiAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICB0aW1lc3RhbXAgPSBfLm5vdygpO1xuICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICBpZiAoIXRpbWVvdXQpIHtcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuICAgICAgfVxuICAgICAgaWYgKGNhbGxOb3cpIHtcbiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBhdCBtb3N0IG9uZSB0aW1lLCBubyBtYXR0ZXIgaG93XG4gIC8vIG9mdGVuIHlvdSBjYWxsIGl0LiBVc2VmdWwgZm9yIGxhenkgaW5pdGlhbGl6YXRpb24uXG4gIF8ub25jZSA9IGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICB2YXIgcmFuID0gZmFsc2UsIG1lbW87XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHJhbikgcmV0dXJuIG1lbW87XG4gICAgICByYW4gPSB0cnVlO1xuICAgICAgbWVtbyA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIGZ1bmMgPSBudWxsO1xuICAgICAgcmV0dXJuIG1lbW87XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBmdW5jdGlvbiBwYXNzZWQgYXMgYW4gYXJndW1lbnQgdG8gdGhlIHNlY29uZCxcbiAgLy8gYWxsb3dpbmcgeW91IHRvIGFkanVzdCBhcmd1bWVudHMsIHJ1biBjb2RlIGJlZm9yZSBhbmQgYWZ0ZXIsIGFuZFxuICAvLyBjb25kaXRpb25hbGx5IGV4ZWN1dGUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uLlxuICBfLndyYXAgPSBmdW5jdGlvbihmdW5jLCB3cmFwcGVyKSB7XG4gICAgcmV0dXJuIF8ucGFydGlhbCh3cmFwcGVyLCBmdW5jKTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBpcyB0aGUgY29tcG9zaXRpb24gb2YgYSBsaXN0IG9mIGZ1bmN0aW9ucywgZWFjaFxuICAvLyBjb25zdW1pbmcgdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgZnVuY3Rpb24gdGhhdCBmb2xsb3dzLlxuICBfLmNvbXBvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZnVuY3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICBmb3IgKHZhciBpID0gZnVuY3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgYXJncyA9IFtmdW5jc1tpXS5hcHBseSh0aGlzLCBhcmdzKV07XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJnc1swXTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgb25seSBiZSBleGVjdXRlZCBhZnRlciBiZWluZyBjYWxsZWQgTiB0aW1lcy5cbiAgXy5hZnRlciA9IGZ1bmN0aW9uKHRpbWVzLCBmdW5jKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKC0tdGltZXMgPCAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBPYmplY3QgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS1cblxuICAvLyBSZXRyaWV2ZSB0aGUgbmFtZXMgb2YgYW4gb2JqZWN0J3MgcHJvcGVydGllcy5cbiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYE9iamVjdC5rZXlzYFxuICBfLmtleXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdO1xuICAgIGlmIChuYXRpdmVLZXlzKSByZXR1cm4gbmF0aXZlS2V5cyhvYmopO1xuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKF8uaGFzKG9iaiwga2V5KSkga2V5cy5wdXNoKGtleSk7XG4gICAgcmV0dXJuIGtleXM7XG4gIH07XG5cbiAgLy8gUmV0cmlldmUgdGhlIHZhbHVlcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7XG4gICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWx1ZXMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZXNbaV0gPSBvYmpba2V5c1tpXV07XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZXM7XG4gIH07XG5cbiAgLy8gQ29udmVydCBhbiBvYmplY3QgaW50byBhIGxpc3Qgb2YgYFtrZXksIHZhbHVlXWAgcGFpcnMuXG4gIF8ucGFpcnMgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgcGFpcnMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBwYWlyc1tpXSA9IFtrZXlzW2ldLCBvYmpba2V5c1tpXV1dO1xuICAgIH1cbiAgICByZXR1cm4gcGFpcnM7XG4gIH07XG5cbiAgLy8gSW52ZXJ0IHRoZSBrZXlzIGFuZCB2YWx1ZXMgb2YgYW4gb2JqZWN0LiBUaGUgdmFsdWVzIG11c3QgYmUgc2VyaWFsaXphYmxlLlxuICBfLmludmVydCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbb2JqW2tleXNbaV1dXSA9IGtleXNbaV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgc29ydGVkIGxpc3Qgb2YgdGhlIGZ1bmN0aW9uIG5hbWVzIGF2YWlsYWJsZSBvbiB0aGUgb2JqZWN0LlxuICAvLyBBbGlhc2VkIGFzIGBtZXRob2RzYFxuICBfLmZ1bmN0aW9ucyA9IF8ubWV0aG9kcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBuYW1lcyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChfLmlzRnVuY3Rpb24ob2JqW2tleV0pKSBuYW1lcy5wdXNoKGtleSk7XG4gICAgfVxuICAgIHJldHVybiBuYW1lcy5zb3J0KCk7XG4gIH07XG5cbiAgLy8gRXh0ZW5kIGEgZ2l2ZW4gb2JqZWN0IHdpdGggYWxsIHRoZSBwcm9wZXJ0aWVzIGluIHBhc3NlZC1pbiBvYmplY3QocykuXG4gIF8uZXh0ZW5kID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgZWFjaChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICAgIG9ialtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IG9ubHkgY29udGFpbmluZyB0aGUgd2hpdGVsaXN0ZWQgcHJvcGVydGllcy5cbiAgXy5waWNrID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGNvcHkgPSB7fTtcbiAgICB2YXIga2V5cyA9IGNvbmNhdC5hcHBseShBcnJheVByb3RvLCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIGVhY2goa2V5cywgZnVuY3Rpb24oa2V5KSB7XG4gICAgICBpZiAoa2V5IGluIG9iaikgY29weVtrZXldID0gb2JqW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG5cbiAgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCB3aXRob3V0IHRoZSBibGFja2xpc3RlZCBwcm9wZXJ0aWVzLlxuICBfLm9taXQgPSBmdW5jdGlvbihvYmopIHtcbiAgICB2YXIgY29weSA9IHt9O1xuICAgIHZhciBrZXlzID0gY29uY2F0LmFwcGx5KEFycmF5UHJvdG8sIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKCFfLmNvbnRhaW5zKGtleXMsIGtleSkpIGNvcHlba2V5XSA9IG9ialtrZXldO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbiAgfTtcblxuICAvLyBGaWxsIGluIGEgZ2l2ZW4gb2JqZWN0IHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzLlxuICBfLmRlZmF1bHRzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgZWFjaChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICAgIGlmIChvYmpbcHJvcF0gPT09IHZvaWQgMCkgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcblxuICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuXG4gIF8uY2xvbmUgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIG9iajtcbiAgICByZXR1cm4gXy5pc0FycmF5KG9iaikgPyBvYmouc2xpY2UoKSA6IF8uZXh0ZW5kKHt9LCBvYmopO1xuICB9O1xuXG4gIC8vIEludm9rZXMgaW50ZXJjZXB0b3Igd2l0aCB0aGUgb2JqLCBhbmQgdGhlbiByZXR1cm5zIG9iai5cbiAgLy8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byBcInRhcCBpbnRvXCIgYSBtZXRob2QgY2hhaW4sIGluXG4gIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLlxuICBfLnRhcCA9IGZ1bmN0aW9uKG9iaiwgaW50ZXJjZXB0b3IpIHtcbiAgICBpbnRlcmNlcHRvcihvYmopO1xuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gSW50ZXJuYWwgcmVjdXJzaXZlIGNvbXBhcmlzb24gZnVuY3Rpb24gZm9yIGBpc0VxdWFsYC5cbiAgdmFyIGVxID0gZnVuY3Rpb24oYSwgYiwgYVN0YWNrLCBiU3RhY2spIHtcbiAgICAvLyBJZGVudGljYWwgb2JqZWN0cyBhcmUgZXF1YWwuIGAwID09PSAtMGAsIGJ1dCB0aGV5IGFyZW4ndCBpZGVudGljYWwuXG4gICAgLy8gU2VlIHRoZSBbSGFybW9ueSBgZWdhbGAgcHJvcG9zYWxdKGh0dHA6Ly93aWtpLmVjbWFzY3JpcHQub3JnL2Rva3UucGhwP2lkPWhhcm1vbnk6ZWdhbCkuXG4gICAgaWYgKGEgPT09IGIpIHJldHVybiBhICE9PSAwIHx8IDEgLyBhID09IDEgLyBiO1xuICAgIC8vIEEgc3RyaWN0IGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5IGJlY2F1c2UgYG51bGwgPT0gdW5kZWZpbmVkYC5cbiAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7XG4gICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuXG4gICAgaWYgKGEgaW5zdGFuY2VvZiBfKSBhID0gYS5fd3JhcHBlZDtcbiAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkO1xuICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgaWYgKGNsYXNzTmFtZSAhPSB0b1N0cmluZy5jYWxsKGIpKSByZXR1cm4gZmFsc2U7XG4gICAgc3dpdGNoIChjbGFzc05hbWUpIHtcbiAgICAgIC8vIFN0cmluZ3MsIG51bWJlcnMsIGRhdGVzLCBhbmQgYm9vbGVhbnMgYXJlIGNvbXBhcmVkIGJ5IHZhbHVlLlxuICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGBcIjVcImAgaXNcbiAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZyhcIjVcIilgLlxuICAgICAgICByZXR1cm4gYSA9PSBTdHJpbmcoYik7XG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgICAvLyBgTmFOYHMgYXJlIGVxdWl2YWxlbnQsIGJ1dCBub24tcmVmbGV4aXZlLiBBbiBgZWdhbGAgY29tcGFyaXNvbiBpcyBwZXJmb3JtZWQgZm9yXG4gICAgICAgIC8vIG90aGVyIG51bWVyaWMgdmFsdWVzLlxuICAgICAgICByZXR1cm4gYSAhPSArYSA/IGIgIT0gK2IgOiAoYSA9PSAwID8gMSAvIGEgPT0gMSAvIGIgOiBhID09ICtiKTtcbiAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOlxuICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6XG4gICAgICAgIC8vIENvZXJjZSBkYXRlcyBhbmQgYm9vbGVhbnMgdG8gbnVtZXJpYyBwcmltaXRpdmUgdmFsdWVzLiBEYXRlcyBhcmUgY29tcGFyZWQgYnkgdGhlaXJcbiAgICAgICAgLy8gbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zLiBOb3RlIHRoYXQgaW52YWxpZCBkYXRlcyB3aXRoIG1pbGxpc2Vjb25kIHJlcHJlc2VudGF0aW9uc1xuICAgICAgICAvLyBvZiBgTmFOYCBhcmUgbm90IGVxdWl2YWxlbnQuXG4gICAgICAgIHJldHVybiArYSA9PSArYjtcbiAgICAgIC8vIFJlZ0V4cHMgYXJlIGNvbXBhcmVkIGJ5IHRoZWlyIHNvdXJjZSBwYXR0ZXJucyBhbmQgZmxhZ3MuXG4gICAgICBjYXNlICdbb2JqZWN0IFJlZ0V4cF0nOlxuICAgICAgICByZXR1cm4gYS5zb3VyY2UgPT0gYi5zb3VyY2UgJiZcbiAgICAgICAgICAgICAgIGEuZ2xvYmFsID09IGIuZ2xvYmFsICYmXG4gICAgICAgICAgICAgICBhLm11bHRpbGluZSA9PSBiLm11bHRpbGluZSAmJlxuICAgICAgICAgICAgICAgYS5pZ25vcmVDYXNlID09IGIuaWdub3JlQ2FzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhICE9ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gQXNzdW1lIGVxdWFsaXR5IGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpY1xuICAgIC8vIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMSBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gLlxuICAgIHZhciBsZW5ndGggPSBhU3RhY2subGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgLy8gTGluZWFyIHNlYXJjaC4gUGVyZm9ybWFuY2UgaXMgaW52ZXJzZWx5IHByb3BvcnRpb25hbCB0byB0aGUgbnVtYmVyIG9mXG4gICAgICAvLyB1bmlxdWUgbmVzdGVkIHN0cnVjdHVyZXMuXG4gICAgICBpZiAoYVN0YWNrW2xlbmd0aF0gPT0gYSkgcmV0dXJuIGJTdGFja1tsZW5ndGhdID09IGI7XG4gICAgfVxuICAgIC8vIE9iamVjdHMgd2l0aCBkaWZmZXJlbnQgY29uc3RydWN0b3JzIGFyZSBub3QgZXF1aXZhbGVudCwgYnV0IGBPYmplY3Rgc1xuICAgIC8vIGZyb20gZGlmZmVyZW50IGZyYW1lcyBhcmUuXG4gICAgdmFyIGFDdG9yID0gYS5jb25zdHJ1Y3RvciwgYkN0b3IgPSBiLmNvbnN0cnVjdG9yO1xuICAgIGlmIChhQ3RvciAhPT0gYkN0b3IgJiYgIShfLmlzRnVuY3Rpb24oYUN0b3IpICYmIChhQ3RvciBpbnN0YW5jZW9mIGFDdG9yKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmlzRnVuY3Rpb24oYkN0b3IpICYmIChiQ3RvciBpbnN0YW5jZW9mIGJDdG9yKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICYmICgnY29uc3RydWN0b3InIGluIGEgJiYgJ2NvbnN0cnVjdG9yJyBpbiBiKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnB1c2goYSk7XG4gICAgYlN0YWNrLnB1c2goYik7XG4gICAgdmFyIHNpemUgPSAwLCByZXN1bHQgPSB0cnVlO1xuICAgIC8vIFJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzLlxuICAgIGlmIChjbGFzc05hbWUgPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgLy8gQ29tcGFyZSBhcnJheSBsZW5ndGhzIHRvIGRldGVybWluZSBpZiBhIGRlZXAgY29tcGFyaXNvbiBpcyBuZWNlc3NhcnkuXG4gICAgICBzaXplID0gYS5sZW5ndGg7XG4gICAgICByZXN1bHQgPSBzaXplID09IGIubGVuZ3RoO1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBEZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzLlxuICAgICAgICB3aGlsZSAoc2l6ZS0tKSB7XG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gZXEoYVtzaXplXSwgYltzaXplXSwgYVN0YWNrLCBiU3RhY2spKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVlcCBjb21wYXJlIG9iamVjdHMuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gYSkge1xuICAgICAgICBpZiAoXy5oYXMoYSwga2V5KSkge1xuICAgICAgICAgIC8vIENvdW50IHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgICAgICBzaXplKys7XG4gICAgICAgICAgLy8gRGVlcCBjb21wYXJlIGVhY2ggbWVtYmVyLlxuICAgICAgICAgIGlmICghKHJlc3VsdCA9IF8uaGFzKGIsIGtleSkgJiYgZXEoYVtrZXldLCBiW2tleV0sIGFTdGFjaywgYlN0YWNrKSkpIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBFbnN1cmUgdGhhdCBib3RoIG9iamVjdHMgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgZm9yIChrZXkgaW4gYikge1xuICAgICAgICAgIGlmIChfLmhhcyhiLCBrZXkpICYmICEoc2l6ZS0tKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gIXNpemU7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIFJlbW92ZSB0aGUgZmlyc3Qgb2JqZWN0IGZyb20gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzLlxuICAgIGFTdGFjay5wb3AoKTtcbiAgICBiU3RhY2sucG9wKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBQZXJmb3JtIGEgZGVlcCBjb21wYXJpc29uIHRvIGNoZWNrIGlmIHR3byBvYmplY3RzIGFyZSBlcXVhbC5cbiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBlcShhLCBiLCBbXSwgW10pO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gYXJyYXksIHN0cmluZywgb3Igb2JqZWN0IGVtcHR5P1xuICAvLyBBbiBcImVtcHR5XCIgb2JqZWN0IGhhcyBubyBlbnVtZXJhYmxlIG93bi1wcm9wZXJ0aWVzLlxuICBfLmlzRW1wdHkgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiB0cnVlO1xuICAgIGlmIChfLmlzQXJyYXkob2JqKSB8fCBfLmlzU3RyaW5nKG9iaikpIHJldHVybiBvYmoubGVuZ3RoID09PSAwO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChfLmhhcyhvYmosIGtleSkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgRE9NIGVsZW1lbnQ/XG4gIF8uaXNFbGVtZW50ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuICEhKG9iaiAmJiBvYmoubm9kZVR5cGUgPT09IDEpO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYW4gYXJyYXk/XG4gIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5XG4gIF8uaXNBcnJheSA9IG5hdGl2ZUlzQXJyYXkgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgYW4gb2JqZWN0P1xuICBfLmlzT2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gT2JqZWN0KG9iaik7XG4gIH07XG5cbiAgLy8gQWRkIHNvbWUgaXNUeXBlIG1ldGhvZHM6IGlzQXJndW1lbnRzLCBpc0Z1bmN0aW9uLCBpc1N0cmluZywgaXNOdW1iZXIsIGlzRGF0ZSwgaXNSZWdFeHAuXG4gIGVhY2goWydBcmd1bWVudHMnLCAnRnVuY3Rpb24nLCAnU3RyaW5nJywgJ051bWJlcicsICdEYXRlJywgJ1JlZ0V4cCddLCBmdW5jdGlvbihuYW1lKSB7XG4gICAgX1snaXMnICsgbmFtZV0gPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT0gJ1tvYmplY3QgJyArIG5hbWUgKyAnXSc7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gRGVmaW5lIGEgZmFsbGJhY2sgdmVyc2lvbiBvZiB0aGUgbWV0aG9kIGluIGJyb3dzZXJzIChhaGVtLCBJRSksIHdoZXJlXG4gIC8vIHRoZXJlIGlzbid0IGFueSBpbnNwZWN0YWJsZSBcIkFyZ3VtZW50c1wiIHR5cGUuXG4gIGlmICghXy5pc0FyZ3VtZW50cyhhcmd1bWVudHMpKSB7XG4gICAgXy5pc0FyZ3VtZW50cyA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuICEhKG9iaiAmJiBfLmhhcyhvYmosICdjYWxsZWUnKSk7XG4gICAgfTtcbiAgfVxuXG4gIC8vIE9wdGltaXplIGBpc0Z1bmN0aW9uYCBpZiBhcHByb3ByaWF0ZS5cbiAgaWYgKHR5cGVvZiAoLy4vKSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbic7XG4gICAgfTtcbiAgfVxuXG4gIC8vIElzIGEgZ2l2ZW4gb2JqZWN0IGEgZmluaXRlIG51bWJlcj9cbiAgXy5pc0Zpbml0ZSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBpc0Zpbml0ZShvYmopICYmICFpc05hTihwYXJzZUZsb2F0KG9iaikpO1xuICB9O1xuXG4gIC8vIElzIHRoZSBnaXZlbiB2YWx1ZSBgTmFOYD8gKE5hTiBpcyB0aGUgb25seSBudW1iZXIgd2hpY2ggZG9lcyBub3QgZXF1YWwgaXRzZWxmKS5cbiAgXy5pc05hTiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBfLmlzTnVtYmVyKG9iaikgJiYgb2JqICE9ICtvYmo7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/XG4gIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZSB8fCBvYmogPT09IGZhbHNlIHx8IHRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBCb29sZWFuXSc7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBlcXVhbCB0byBudWxsP1xuICBfLmlzTnVsbCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBvYmogPT09IG51bGw7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSB1bmRlZmluZWQ/XG4gIF8uaXNVbmRlZmluZWQgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSB2b2lkIDA7XG4gIH07XG5cbiAgLy8gU2hvcnRjdXQgZnVuY3Rpb24gZm9yIGNoZWNraW5nIGlmIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBwcm9wZXJ0eSBkaXJlY3RseVxuICAvLyBvbiBpdHNlbGYgKGluIG90aGVyIHdvcmRzLCBub3Qgb24gYSBwcm90b3R5cGUpLlxuICBfLmhhcyA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XG4gICAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xuICB9O1xuXG4gIC8vIFV0aWxpdHkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gUnVuIFVuZGVyc2NvcmUuanMgaW4gKm5vQ29uZmxpY3QqIG1vZGUsIHJldHVybmluZyB0aGUgYF9gIHZhcmlhYmxlIHRvIGl0c1xuICAvLyBwcmV2aW91cyBvd25lci4gUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8ubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJvb3QuXyA9IHByZXZpb3VzVW5kZXJzY29yZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvLyBLZWVwIHRoZSBpZGVudGl0eSBmdW5jdGlvbiBhcm91bmQgZm9yIGRlZmF1bHQgaXRlcmF0b3JzLlxuICBfLmlkZW50aXR5ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgXy5jb25zdGFudCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9O1xuICB9O1xuXG4gIF8ucHJvcGVydHkgPSBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gb2JqW2tleV07XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgcHJlZGljYXRlIGZvciBjaGVja2luZyB3aGV0aGVyIGFuIG9iamVjdCBoYXMgYSBnaXZlbiBzZXQgb2YgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8ubWF0Y2hlcyA9IGZ1bmN0aW9uKGF0dHJzKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgaWYgKG9iaiA9PT0gYXR0cnMpIHJldHVybiB0cnVlOyAvL2F2b2lkIGNvbXBhcmluZyBhbiBvYmplY3QgdG8gaXRzZWxmLlxuICAgICAgZm9yICh2YXIga2V5IGluIGF0dHJzKSB7XG4gICAgICAgIGlmIChhdHRyc1trZXldICE9PSBvYmpba2V5XSlcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgLy8gUnVuIGEgZnVuY3Rpb24gKipuKiogdGltZXMuXG4gIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRvciwgY29udGV4dCkge1xuICAgIHZhciBhY2N1bSA9IEFycmF5KE1hdGgubWF4KDAsIG4pKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykgYWNjdW1baV0gPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGkpO1xuICAgIHJldHVybiBhY2N1bTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiBhbmQgbWF4IChpbmNsdXNpdmUpLlxuICBfLnJhbmRvbSA9IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gICAgaWYgKG1heCA9PSBudWxsKSB7XG4gICAgICBtYXggPSBtaW47XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICByZXR1cm4gbWluICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKTtcbiAgfTtcblxuICAvLyBBIChwb3NzaWJseSBmYXN0ZXIpIHdheSB0byBnZXQgdGhlIGN1cnJlbnQgdGltZXN0YW1wIGFzIGFuIGludGVnZXIuXG4gIF8ubm93ID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24oKSB7IHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfTtcblxuICAvLyBMaXN0IG9mIEhUTUwgZW50aXRpZXMgZm9yIGVzY2FwaW5nLlxuICB2YXIgZW50aXR5TWFwID0ge1xuICAgIGVzY2FwZToge1xuICAgICAgJyYnOiAnJmFtcDsnLFxuICAgICAgJzwnOiAnJmx0OycsXG4gICAgICAnPic6ICcmZ3Q7JyxcbiAgICAgICdcIic6ICcmcXVvdDsnLFxuICAgICAgXCInXCI6ICcmI3gyNzsnXG4gICAgfVxuICB9O1xuICBlbnRpdHlNYXAudW5lc2NhcGUgPSBfLmludmVydChlbnRpdHlNYXAuZXNjYXBlKTtcblxuICAvLyBSZWdleGVzIGNvbnRhaW5pbmcgdGhlIGtleXMgYW5kIHZhbHVlcyBsaXN0ZWQgaW1tZWRpYXRlbHkgYWJvdmUuXG4gIHZhciBlbnRpdHlSZWdleGVzID0ge1xuICAgIGVzY2FwZTogICBuZXcgUmVnRXhwKCdbJyArIF8ua2V5cyhlbnRpdHlNYXAuZXNjYXBlKS5qb2luKCcnKSArICddJywgJ2cnKSxcbiAgICB1bmVzY2FwZTogbmV3IFJlZ0V4cCgnKCcgKyBfLmtleXMoZW50aXR5TWFwLnVuZXNjYXBlKS5qb2luKCd8JykgKyAnKScsICdnJylcbiAgfTtcblxuICAvLyBGdW5jdGlvbnMgZm9yIGVzY2FwaW5nIGFuZCB1bmVzY2FwaW5nIHN0cmluZ3MgdG8vZnJvbSBIVE1MIGludGVycG9sYXRpb24uXG4gIF8uZWFjaChbJ2VzY2FwZScsICd1bmVzY2FwZSddLCBmdW5jdGlvbihtZXRob2QpIHtcbiAgICBfW21ldGhvZF0gPSBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICAgIGlmIChzdHJpbmcgPT0gbnVsbCkgcmV0dXJuICcnO1xuICAgICAgcmV0dXJuICgnJyArIHN0cmluZykucmVwbGFjZShlbnRpdHlSZWdleGVzW21ldGhvZF0sIGZ1bmN0aW9uKG1hdGNoKSB7XG4gICAgICAgIHJldHVybiBlbnRpdHlNYXBbbWV0aG9kXVttYXRjaF07XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBJZiB0aGUgdmFsdWUgb2YgdGhlIG5hbWVkIGBwcm9wZXJ0eWAgaXMgYSBmdW5jdGlvbiB0aGVuIGludm9rZSBpdCB3aXRoIHRoZVxuICAvLyBgb2JqZWN0YCBhcyBjb250ZXh0OyBvdGhlcndpc2UsIHJldHVybiBpdC5cbiAgXy5yZXN1bHQgPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgaWYgKG9iamVjdCA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIHZhciB2YWx1ZSA9IG9iamVjdFtwcm9wZXJ0eV07XG4gICAgcmV0dXJuIF8uaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKG9iamVjdCkgOiB2YWx1ZTtcbiAgfTtcblxuICAvLyBBZGQgeW91ciBvd24gY3VzdG9tIGZ1bmN0aW9ucyB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8ubWl4aW4gPSBmdW5jdGlvbihvYmopIHtcbiAgICBlYWNoKF8uZnVuY3Rpb25zKG9iaiksIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gX1tuYW1lXSA9IG9ialtuYW1lXTtcbiAgICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gW3RoaXMuX3dyYXBwZWRdO1xuICAgICAgICBwdXNoLmFwcGx5KGFyZ3MsIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiByZXN1bHQuY2FsbCh0aGlzLCBmdW5jLmFwcGx5KF8sIGFyZ3MpKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gR2VuZXJhdGUgYSB1bmlxdWUgaW50ZWdlciBpZCAodW5pcXVlIHdpdGhpbiB0aGUgZW50aXJlIGNsaWVudCBzZXNzaW9uKS5cbiAgLy8gVXNlZnVsIGZvciB0ZW1wb3JhcnkgRE9NIGlkcy5cbiAgdmFyIGlkQ291bnRlciA9IDA7XG4gIF8udW5pcXVlSWQgPSBmdW5jdGlvbihwcmVmaXgpIHtcbiAgICB2YXIgaWQgPSArK2lkQ291bnRlciArICcnO1xuICAgIHJldHVybiBwcmVmaXggPyBwcmVmaXggKyBpZCA6IGlkO1xuICB9O1xuXG4gIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUgdXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZVxuICAvLyBmb2xsb3dpbmcgdGVtcGxhdGUgc2V0dGluZ3MgdG8gdXNlIGFsdGVybmF0aXZlIGRlbGltaXRlcnMuXG4gIF8udGVtcGxhdGVTZXR0aW5ncyA9IHtcbiAgICBldmFsdWF0ZSAgICA6IC88JShbXFxzXFxTXSs/KSU+L2csXG4gICAgaW50ZXJwb2xhdGUgOiAvPCU9KFtcXHNcXFNdKz8pJT4vZyxcbiAgICBlc2NhcGUgICAgICA6IC88JS0oW1xcc1xcU10rPyklPi9nXG4gIH07XG5cbiAgLy8gV2hlbiBjdXN0b21pemluZyBgdGVtcGxhdGVTZXR0aW5nc2AsIGlmIHlvdSBkb24ndCB3YW50IHRvIGRlZmluZSBhblxuICAvLyBpbnRlcnBvbGF0aW9uLCBldmFsdWF0aW9uIG9yIGVzY2FwaW5nIHJlZ2V4LCB3ZSBuZWVkIG9uZSB0aGF0IGlzXG4gIC8vIGd1YXJhbnRlZWQgbm90IHRvIG1hdGNoLlxuICB2YXIgbm9NYXRjaCA9IC8oLileLztcblxuICAvLyBDZXJ0YWluIGNoYXJhY3RlcnMgbmVlZCB0byBiZSBlc2NhcGVkIHNvIHRoYXQgdGhleSBjYW4gYmUgcHV0IGludG8gYVxuICAvLyBzdHJpbmcgbGl0ZXJhbC5cbiAgdmFyIGVzY2FwZXMgPSB7XG4gICAgXCInXCI6ICAgICAgXCInXCIsXG4gICAgJ1xcXFwnOiAgICAgJ1xcXFwnLFxuICAgICdcXHInOiAgICAgJ3InLFxuICAgICdcXG4nOiAgICAgJ24nLFxuICAgICdcXHQnOiAgICAgJ3QnLFxuICAgICdcXHUyMDI4JzogJ3UyMDI4JyxcbiAgICAnXFx1MjAyOSc6ICd1MjAyOSdcbiAgfTtcblxuICB2YXIgZXNjYXBlciA9IC9cXFxcfCd8XFxyfFxcbnxcXHR8XFx1MjAyOHxcXHUyMDI5L2c7XG5cbiAgLy8gSmF2YVNjcmlwdCBtaWNyby10ZW1wbGF0aW5nLCBzaW1pbGFyIHRvIEpvaG4gUmVzaWcncyBpbXBsZW1lbnRhdGlvbi5cbiAgLy8gVW5kZXJzY29yZSB0ZW1wbGF0aW5nIGhhbmRsZXMgYXJiaXRyYXJ5IGRlbGltaXRlcnMsIHByZXNlcnZlcyB3aGl0ZXNwYWNlLFxuICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS5cbiAgXy50ZW1wbGF0ZSA9IGZ1bmN0aW9uKHRleHQsIGRhdGEsIHNldHRpbmdzKSB7XG4gICAgdmFyIHJlbmRlcjtcbiAgICBzZXR0aW5ncyA9IF8uZGVmYXVsdHMoe30sIHNldHRpbmdzLCBfLnRlbXBsYXRlU2V0dGluZ3MpO1xuXG4gICAgLy8gQ29tYmluZSBkZWxpbWl0ZXJzIGludG8gb25lIHJlZ3VsYXIgZXhwcmVzc2lvbiB2aWEgYWx0ZXJuYXRpb24uXG4gICAgdmFyIG1hdGNoZXIgPSBuZXcgUmVnRXhwKFtcbiAgICAgIChzZXR0aW5ncy5lc2NhcGUgfHwgbm9NYXRjaCkuc291cmNlLFxuICAgICAgKHNldHRpbmdzLmludGVycG9sYXRlIHx8IG5vTWF0Y2gpLnNvdXJjZSxcbiAgICAgIChzZXR0aW5ncy5ldmFsdWF0ZSB8fCBub01hdGNoKS5zb3VyY2VcbiAgICBdLmpvaW4oJ3wnKSArICd8JCcsICdnJyk7XG5cbiAgICAvLyBDb21waWxlIHRoZSB0ZW1wbGF0ZSBzb3VyY2UsIGVzY2FwaW5nIHN0cmluZyBsaXRlcmFscyBhcHByb3ByaWF0ZWx5LlxuICAgIHZhciBpbmRleCA9IDA7XG4gICAgdmFyIHNvdXJjZSA9IFwiX19wKz0nXCI7XG4gICAgdGV4dC5yZXBsYWNlKG1hdGNoZXIsIGZ1bmN0aW9uKG1hdGNoLCBlc2NhcGUsIGludGVycG9sYXRlLCBldmFsdWF0ZSwgb2Zmc2V0KSB7XG4gICAgICBzb3VyY2UgKz0gdGV4dC5zbGljZShpbmRleCwgb2Zmc2V0KVxuICAgICAgICAucmVwbGFjZShlc2NhcGVyLCBmdW5jdGlvbihtYXRjaCkgeyByZXR1cm4gJ1xcXFwnICsgZXNjYXBlc1ttYXRjaF07IH0pO1xuXG4gICAgICBpZiAoZXNjYXBlKSB7XG4gICAgICAgIHNvdXJjZSArPSBcIicrXFxuKChfX3Q9KFwiICsgZXNjYXBlICsgXCIpKT09bnVsbD8nJzpfLmVzY2FwZShfX3QpKStcXG4nXCI7XG4gICAgICB9XG4gICAgICBpZiAoaW50ZXJwb2xhdGUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJytcXG4oKF9fdD0oXCIgKyBpbnRlcnBvbGF0ZSArIFwiKSk9PW51bGw/Jyc6X190KStcXG4nXCI7XG4gICAgICB9XG4gICAgICBpZiAoZXZhbHVhdGUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJztcXG5cIiArIGV2YWx1YXRlICsgXCJcXG5fX3ArPSdcIjtcbiAgICAgIH1cbiAgICAgIGluZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoO1xuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0pO1xuICAgIHNvdXJjZSArPSBcIic7XFxuXCI7XG5cbiAgICAvLyBJZiBhIHZhcmlhYmxlIGlzIG5vdCBzcGVjaWZpZWQsIHBsYWNlIGRhdGEgdmFsdWVzIGluIGxvY2FsIHNjb3BlLlxuICAgIGlmICghc2V0dGluZ3MudmFyaWFibGUpIHNvdXJjZSA9ICd3aXRoKG9ianx8e30pe1xcbicgKyBzb3VyY2UgKyAnfVxcbic7XG5cbiAgICBzb3VyY2UgPSBcInZhciBfX3QsX19wPScnLF9faj1BcnJheS5wcm90b3R5cGUuam9pbixcIiArXG4gICAgICBcInByaW50PWZ1bmN0aW9uKCl7X19wKz1fX2ouY2FsbChhcmd1bWVudHMsJycpO307XFxuXCIgK1xuICAgICAgc291cmNlICsgXCJyZXR1cm4gX19wO1xcblwiO1xuXG4gICAgdHJ5IHtcbiAgICAgIHJlbmRlciA9IG5ldyBGdW5jdGlvbihzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJywgJ18nLCBzb3VyY2UpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGUuc291cmNlID0gc291cmNlO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YSkgcmV0dXJuIHJlbmRlcihkYXRhLCBfKTtcbiAgICB2YXIgdGVtcGxhdGUgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICByZXR1cm4gcmVuZGVyLmNhbGwodGhpcywgZGF0YSwgXyk7XG4gICAgfTtcblxuICAgIC8vIFByb3ZpZGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uIHNvdXJjZSBhcyBhIGNvbnZlbmllbmNlIGZvciBwcmVjb21waWxhdGlvbi5cbiAgICB0ZW1wbGF0ZS5zb3VyY2UgPSAnZnVuY3Rpb24oJyArIChzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJykgKyAnKXtcXG4nICsgc291cmNlICsgJ30nO1xuXG4gICAgcmV0dXJuIHRlbXBsYXRlO1xuICB9O1xuXG4gIC8vIEFkZCBhIFwiY2hhaW5cIiBmdW5jdGlvbiwgd2hpY2ggd2lsbCBkZWxlZ2F0ZSB0byB0aGUgd3JhcHBlci5cbiAgXy5jaGFpbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHJldHVybiBfKG9iaikuY2hhaW4oKTtcbiAgfTtcblxuICAvLyBPT1BcbiAgLy8gLS0tLS0tLS0tLS0tLS0tXG4gIC8vIElmIFVuZGVyc2NvcmUgaXMgY2FsbGVkIGFzIGEgZnVuY3Rpb24sIGl0IHJldHVybnMgYSB3cmFwcGVkIG9iamVjdCB0aGF0XG4gIC8vIGNhbiBiZSB1c2VkIE9PLXN0eWxlLiBUaGlzIHdyYXBwZXIgaG9sZHMgYWx0ZXJlZCB2ZXJzaW9ucyBvZiBhbGwgdGhlXG4gIC8vIHVuZGVyc2NvcmUgZnVuY3Rpb25zLiBXcmFwcGVkIG9iamVjdHMgbWF5IGJlIGNoYWluZWQuXG5cbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnRpbnVlIGNoYWluaW5nIGludGVybWVkaWF0ZSByZXN1bHRzLlxuICB2YXIgcmVzdWx0ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NoYWluID8gXyhvYmopLmNoYWluKCkgOiBvYmo7XG4gIH07XG5cbiAgLy8gQWRkIGFsbCBvZiB0aGUgVW5kZXJzY29yZSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIgb2JqZWN0LlxuICBfLm1peGluKF8pO1xuXG4gIC8vIEFkZCBhbGwgbXV0YXRvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIGVhY2goWydwb3AnLCAncHVzaCcsICdyZXZlcnNlJywgJ3NoaWZ0JywgJ3NvcnQnLCAnc3BsaWNlJywgJ3Vuc2hpZnQnXSwgZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdO1xuICAgIF8ucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgb2JqID0gdGhpcy5fd3JhcHBlZDtcbiAgICAgIG1ldGhvZC5hcHBseShvYmosIGFyZ3VtZW50cyk7XG4gICAgICBpZiAoKG5hbWUgPT0gJ3NoaWZ0JyB8fCBuYW1lID09ICdzcGxpY2UnKSAmJiBvYmoubGVuZ3RoID09PSAwKSBkZWxldGUgb2JqWzBdO1xuICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIG9iaik7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIGVhY2goWydjb25jYXQnLCAnam9pbicsICdzbGljZSddLCBmdW5jdGlvbihuYW1lKSB7XG4gICAgdmFyIG1ldGhvZCA9IEFycmF5UHJvdG9bbmFtZV07XG4gICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZXN1bHQuY2FsbCh0aGlzLCBtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgXy5leHRlbmQoXy5wcm90b3R5cGUsIHtcblxuICAgIC8vIFN0YXJ0IGNoYWluaW5nIGEgd3JhcHBlZCBVbmRlcnNjb3JlIG9iamVjdC5cbiAgICBjaGFpbjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9jaGFpbiA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLy8gRXh0cmFjdHMgdGhlIHJlc3VsdCBmcm9tIGEgd3JhcHBlZCBhbmQgY2hhaW5lZCBvYmplY3QuXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7XG4gICAgfVxuXG4gIH0pO1xuXG4gIC8vIEFNRCByZWdpc3RyYXRpb24gaGFwcGVucyBhdCB0aGUgZW5kIGZvciBjb21wYXRpYmlsaXR5IHdpdGggQU1EIGxvYWRlcnNcbiAgLy8gdGhhdCBtYXkgbm90IGVuZm9yY2UgbmV4dC10dXJuIHNlbWFudGljcyBvbiBtb2R1bGVzLiBFdmVuIHRob3VnaCBnZW5lcmFsXG4gIC8vIHByYWN0aWNlIGZvciBBTUQgcmVnaXN0cmF0aW9uIGlzIHRvIGJlIGFub255bW91cywgdW5kZXJzY29yZSByZWdpc3RlcnNcbiAgLy8gYXMgYSBuYW1lZCBtb2R1bGUgYmVjYXVzZSwgbGlrZSBqUXVlcnksIGl0IGlzIGEgYmFzZSBsaWJyYXJ5IHRoYXQgaXNcbiAgLy8gcG9wdWxhciBlbm91Z2ggdG8gYmUgYnVuZGxlZCBpbiBhIHRoaXJkIHBhcnR5IGxpYiwgYnV0IG5vdCBiZSBwYXJ0IG9mXG4gIC8vIGFuIEFNRCBsb2FkIHJlcXVlc3QuIFRob3NlIGNhc2VzIGNvdWxkIGdlbmVyYXRlIGFuIGVycm9yIHdoZW4gYW5cbiAgLy8gYW5vbnltb3VzIGRlZmluZSgpIGlzIGNhbGxlZCBvdXRzaWRlIG9mIGEgbG9hZGVyIHJlcXVlc3QuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoJ3VuZGVyc2NvcmUnLCBbXSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXztcbiAgICB9KTtcbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufSkoKSIsIihmdW5jdGlvbihkZWZpbml0aW9uKXtpZih0eXBlb2YgZXhwb3J0cz09PVwib2JqZWN0XCIpe21vZHVsZS5leHBvcnRzPWRlZmluaXRpb24oKTt9ZWxzZSBpZih0eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kKXtkZWZpbmUoZGVmaW5pdGlvbik7fWVsc2V7bW9yaT1kZWZpbml0aW9uKCk7fX0pKGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7XG52YXIgZyxhYT10aGlzO1xuZnVuY3Rpb24gbShhKXt2YXIgYj10eXBlb2YgYTtpZihcIm9iamVjdFwiPT1iKWlmKGEpe2lmKGEgaW5zdGFuY2VvZiBBcnJheSlyZXR1cm5cImFycmF5XCI7aWYoYSBpbnN0YW5jZW9mIE9iamVjdClyZXR1cm4gYjt2YXIgYz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSk7aWYoXCJbb2JqZWN0IFdpbmRvd11cIj09YylyZXR1cm5cIm9iamVjdFwiO2lmKFwiW29iamVjdCBBcnJheV1cIj09Y3x8XCJudW1iZXJcIj09dHlwZW9mIGEubGVuZ3RoJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5zcGxpY2UmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnByb3BlcnR5SXNFbnVtZXJhYmxlJiYhYS5wcm9wZXJ0eUlzRW51bWVyYWJsZShcInNwbGljZVwiKSlyZXR1cm5cImFycmF5XCI7aWYoXCJbb2JqZWN0IEZ1bmN0aW9uXVwiPT1jfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5jYWxsJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5wcm9wZXJ0eUlzRW51bWVyYWJsZSYmIWEucHJvcGVydHlJc0VudW1lcmFibGUoXCJjYWxsXCIpKXJldHVyblwiZnVuY3Rpb25cIn1lbHNlIHJldHVyblwibnVsbFwiO2Vsc2UgaWYoXCJmdW5jdGlvblwiPT1cbmImJlwidW5kZWZpbmVkXCI9PXR5cGVvZiBhLmNhbGwpcmV0dXJuXCJvYmplY3RcIjtyZXR1cm4gYn12YXIgYmE9XCJjbG9zdXJlX3VpZF9cIisoMUU5Kk1hdGgucmFuZG9tKCk+Pj4wKSxjYT0wO2Z1bmN0aW9uIHAoYSxiKXt2YXIgYz1hLnNwbGl0KFwiLlwiKSxkPWFhO2NbMF1pbiBkfHwhZC5leGVjU2NyaXB0fHxkLmV4ZWNTY3JpcHQoXCJ2YXIgXCIrY1swXSk7Zm9yKHZhciBlO2MubGVuZ3RoJiYoZT1jLnNoaWZ0KCkpOyljLmxlbmd0aHx8dm9pZCAwPT09Yj9kPWRbZV0/ZFtlXTpkW2VdPXt9OmRbZV09Yn07ZnVuY3Rpb24gZGEoYSxiKXtmb3IodmFyIGMgaW4gYSliLmNhbGwodm9pZCAwLGFbY10sYyxhKX07ZnVuY3Rpb24gZWEoYSxiKXtudWxsIT1hJiZ0aGlzLmFwcGVuZC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZWEucHJvdG90eXBlLlZhPVwiXCI7ZWEucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbihhLGIsYyl7dGhpcy5WYSs9YTtpZihudWxsIT1iKWZvcih2YXIgZD0xO2Q8YXJndW1lbnRzLmxlbmd0aDtkKyspdGhpcy5WYSs9YXJndW1lbnRzW2RdO3JldHVybiB0aGlzfTtlYS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5WYX07ZnVuY3Rpb24gZmEoYSxiKXthLnNvcnQoYnx8Z2EpfWZ1bmN0aW9uIGhhKGEsYil7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspYVtjXT17aW5kZXg6Yyx2YWx1ZTphW2NdfTt2YXIgZD1ifHxnYTtmYShhLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGQoYS52YWx1ZSxiLnZhbHVlKXx8YS5pbmRleC1iLmluZGV4fSk7Zm9yKGM9MDtjPGEubGVuZ3RoO2MrKylhW2NdPWFbY10udmFsdWV9ZnVuY3Rpb24gZ2EoYSxiKXtyZXR1cm4gYT5iPzE6YTxiPy0xOjB9O3ZhciBpYT1udWxsLGphPW51bGw7ZnVuY3Rpb24ga2EoKXtyZXR1cm4gbmV3IGxhKG51bGwsNSxbbWEsITAsb2EsITAscGEsITEscWEsITEscmEsaWFdLG51bGwpfWZ1bmN0aW9uIHIoYSl7cmV0dXJuIG51bGwhPWEmJiExIT09YX1mdW5jdGlvbiBzYShhKXtyZXR1cm4gcihhKT8hMTohMH1mdW5jdGlvbiBzKGEsYil7cmV0dXJuIGFbbShudWxsPT1iP251bGw6YildPyEwOmEuXz8hMDp1PyExOm51bGx9ZnVuY3Rpb24gdGEoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDphLmNvbnN0cnVjdG9yfWZ1bmN0aW9uIHgoYSxiKXt2YXIgYz10YShiKSxjPXIocihjKT9jLkRiOmMpP2MuQmI6bShiKTtyZXR1cm4gRXJyb3IoW1wiTm8gcHJvdG9jb2wgbWV0aG9kIFwiLGEsXCIgZGVmaW5lZCBmb3IgdHlwZSBcIixjLFwiOiBcIixiXS5qb2luKFwiXCIpKX1mdW5jdGlvbiB1YShhKXt2YXIgYj1hLkJiO3JldHVybiByKGIpP2I6XCJcIitBLmIoYSl9XG5mdW5jdGlvbiB2YShhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz1BcnJheShiKSxkPTA7OylpZihkPGIpY1tkXT1hW2RdLGQrPTE7ZWxzZSBicmVhaztyZXR1cm4gY31mdW5jdGlvbiB3YShhKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKX1cbnZhciB4YT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gQy5jP0MuYyhmdW5jdGlvbihhLGIpe2EucHVzaChiKTtyZXR1cm4gYX0sW10sYik6Qy5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXthLnB1c2goYik7cmV0dXJuIGF9LFtdLGIpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMuYShudWxsLGEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsMCxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCkseWE9e30semE9e307XG5mdW5jdGlvbiBBYShhKXtpZihhP2EuTDphKXJldHVybiBhLkwoYSk7dmFyIGI7Yj1BYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUFhLl8sIWIpKXRocm93IHgoXCJJQ291bnRlZC4tY291bnRcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gQmEoYSl7aWYoYT9hLkk6YSlyZXR1cm4gYS5JKGEpO3ZhciBiO2I9QmFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1CYS5fLCFiKSl0aHJvdyB4KFwiSUVtcHR5YWJsZUNvbGxlY3Rpb24uLWVtcHR5XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBDYT17fTtmdW5jdGlvbiBEYShhLGIpe2lmKGE/YS5HOmEpcmV0dXJuIGEuRyhhLGIpO3ZhciBjO2M9RGFbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1EYS5fLCFjKSl0aHJvdyB4KFwiSUNvbGxlY3Rpb24uLWNvbmpcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbnZhciBFYT17fSxEPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYoYT9hLmFhOmEpcmV0dXJuIGEuYWEoYSxiLGMpO3ZhciBoO2g9RFttKG51bGw9PWE/bnVsbDphKV07aWYoIWgmJihoPUQuXywhaCkpdGhyb3cgeChcIklJbmRleGVkLi1udGhcIixhKTtyZXR1cm4gaC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIGIoYSxiKXtpZihhP2EuSjphKXJldHVybiBhLkooYSxiKTt2YXIgYztjPURbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1ELl8sIWMpKXRocm93IHgoXCJJSW5kZXhlZC4tbnRoXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxcbkZhPXt9O2Z1bmN0aW9uIEhhKGEpe2lmKGE/YS5ROmEpcmV0dXJuIGEuUShhKTt2YXIgYjtiPUhhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SGEuXywhYikpdGhyb3cgeChcIklTZXEuLWZpcnN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIElhKGEpe2lmKGE/YS5TOmEpcmV0dXJuIGEuUyhhKTt2YXIgYjtiPUlhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SWEuXywhYikpdGhyb3cgeChcIklTZXEuLXJlc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG52YXIgSmE9e30sS2E9e30sTGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtpZihhP2EuQzphKXJldHVybiBhLkMoYSxiLGMpO3ZhciBoO2g9TGFbbShudWxsPT1hP251bGw6YSldO2lmKCFoJiYoaD1MYS5fLCFoKSl0aHJvdyB4KFwiSUxvb2t1cC4tbG9va3VwXCIsYSk7cmV0dXJuIGguY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBiKGEsYil7aWYoYT9hLnU6YSlyZXR1cm4gYS51KGEsYik7dmFyIGM7Yz1MYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPUxhLl8sIWMpKXRocm93IHgoXCJJTG9va3VwLi1sb29rdXBcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1cbmE7cmV0dXJuIGN9KCksTWE9e307ZnVuY3Rpb24gTmEoYSxiKXtpZihhP2Eua2I6YSlyZXR1cm4gYS5rYihhLGIpO3ZhciBjO2M9TmFbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1OYS5fLCFjKSl0aHJvdyB4KFwiSUFzc29jaWF0aXZlLi1jb250YWlucy1rZXk/XCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gT2EoYSxiLGMpe2lmKGE/YS51YTphKXJldHVybiBhLnVhKGEsYixjKTt2YXIgZDtkPU9hW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9T2EuXywhZCkpdGhyb3cgeChcIklBc3NvY2lhdGl2ZS4tYXNzb2NcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfXZhciBQYT17fTtmdW5jdGlvbiBRYShhLGIpe2lmKGE/YS5uYjphKXJldHVybiBhLm5iKGEsYik7dmFyIGM7Yz1RYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPVFhLl8sIWMpKXRocm93IHgoXCJJTWFwLi1kaXNzb2NcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX12YXIgU2E9e307XG5mdW5jdGlvbiBUYShhKXtpZihhP2EuJGE6YSlyZXR1cm4gYS4kYShhKTt2YXIgYjtiPVRhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9VGEuXywhYikpdGhyb3cgeChcIklNYXBFbnRyeS4ta2V5XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFVhKGEpe2lmKGE/YS5hYjphKXJldHVybiBhLmFiKGEpO3ZhciBiO2I9VWFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1VYS5fLCFiKSl0aHJvdyB4KFwiSU1hcEVudHJ5Li12YWxcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIFZhPXt9O2Z1bmN0aW9uIFdhKGEsYil7aWYoYT9hLnZiOmEpcmV0dXJuIGEudmIoYSxiKTt2YXIgYztjPVdhW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9V2EuXywhYykpdGhyb3cgeChcIklTZXQuLWRpc2pvaW5cIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbmZ1bmN0aW9uIFhhKGEpe2lmKGE/YS5JYTphKXJldHVybiBhLklhKGEpO3ZhciBiO2I9WGFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1YYS5fLCFiKSl0aHJvdyB4KFwiSVN0YWNrLi1wZWVrXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFlhKGEpe2lmKGE/YS5KYTphKXJldHVybiBhLkphKGEpO3ZhciBiO2I9WWFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1ZYS5fLCFiKSl0aHJvdyB4KFwiSVN0YWNrLi1wb3BcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIFphPXt9O2Z1bmN0aW9uICRhKGEsYixjKXtpZihhP2EuUGE6YSlyZXR1cm4gYS5QYShhLGIsYyk7dmFyIGQ7ZD0kYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPSRhLl8sIWQpKXRocm93IHgoXCJJVmVjdG9yLi1hc3NvYy1uXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1cbmZ1bmN0aW9uIGFiKGEpe2lmKGE/YS51YjphKXJldHVybiBhLnViKGEpO3ZhciBiO2I9YWJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1hYi5fLCFiKSl0aHJvdyB4KFwiSURlcmVmLi1kZXJlZlwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgYmI9e307ZnVuY3Rpb24gY2IoYSl7aWYoYT9hLkQ6YSlyZXR1cm4gYS5EKGEpO3ZhciBiO2I9Y2JbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1jYi5fLCFiKSl0aHJvdyB4KFwiSU1ldGEuLW1ldGFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIGRiPXt9O2Z1bmN0aW9uIGViKGEsYil7aWYoYT9hLkY6YSlyZXR1cm4gYS5GKGEsYik7dmFyIGM7Yz1lYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPWViLl8sIWMpKXRocm93IHgoXCJJV2l0aE1ldGEuLXdpdGgtbWV0YVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxudmFyIGZiPXt9LGdiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYoYT9hLk06YSlyZXR1cm4gYS5NKGEsYixjKTt2YXIgaDtoPWdiW20obnVsbD09YT9udWxsOmEpXTtpZighaCYmKGg9Z2IuXywhaCkpdGhyb3cgeChcIklSZWR1Y2UuLXJlZHVjZVwiLGEpO3JldHVybiBoLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gYihhLGIpe2lmKGE/YS5OOmEpcmV0dXJuIGEuTihhLGIpO3ZhciBjO2M9Z2JbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1nYi5fLCFjKSl0aHJvdyB4KFwiSVJlZHVjZS4tcmVkdWNlXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIGhiKGEsYixjKXtpZihhP2EuWmE6YSlyZXR1cm4gYS5aYShhLGIsYyk7dmFyIGQ7ZD1oYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPWhiLl8sIWQpKXRocm93IHgoXCJJS1ZSZWR1Y2UuLWt2LXJlZHVjZVwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gaWIoYSxiKXtpZihhP2EudjphKXJldHVybiBhLnYoYSxiKTt2YXIgYztjPWliW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9aWIuXywhYykpdGhyb3cgeChcIklFcXVpdi4tZXF1aXZcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBqYihhKXtpZihhP2EuQjphKXJldHVybiBhLkIoYSk7dmFyIGI7Yj1qYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPWpiLl8sIWIpKXRocm93IHgoXCJJSGFzaC4taGFzaFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIga2I9e307XG5mdW5jdGlvbiBsYihhKXtpZihhP2EuSDphKXJldHVybiBhLkgoYSk7dmFyIGI7Yj1sYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPWxiLl8sIWIpKXRocm93IHgoXCJJU2VxYWJsZS4tc2VxXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBtYj17fSxuYj17fSxvYj17fTtmdW5jdGlvbiBwYihhKXtpZihhP2EuWGE6YSlyZXR1cm4gYS5YYShhKTt2YXIgYjtiPXBiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9cGIuXywhYikpdGhyb3cgeChcIklSZXZlcnNpYmxlLi1yc2VxXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIHFiKGEsYil7aWYoYT9hLnliOmEpcmV0dXJuIGEueWIoYSxiKTt2YXIgYztjPXFiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9cWIuXywhYykpdGhyb3cgeChcIklTb3J0ZWQuLXNvcnRlZC1zZXFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbmZ1bmN0aW9uIHJiKGEsYixjKXtpZihhP2EuemI6YSlyZXR1cm4gYS56YihhLGIsYyk7dmFyIGQ7ZD1yYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPXJiLl8sIWQpKXRocm93IHgoXCJJU29ydGVkLi1zb3J0ZWQtc2VxLWZyb21cIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIHNiKGEsYil7aWYoYT9hLnhiOmEpcmV0dXJuIGEueGIoYSxiKTt2YXIgYztjPXNiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9c2IuXywhYykpdGhyb3cgeChcIklTb3J0ZWQuLWVudHJ5LWtleVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIHRiKGEpe2lmKGE/YS53YjphKXJldHVybiBhLndiKGEpO3ZhciBiO2I9dGJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj10Yi5fLCFiKSl0aHJvdyB4KFwiSVNvcnRlZC4tY29tcGFyYXRvclwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIHViKGEsYil7aWYoYT9hLlNiOmEpcmV0dXJuIGEuU2IoMCxiKTt2YXIgYztjPXViW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9dWIuXywhYykpdGhyb3cgeChcIklXcml0ZXIuLXdyaXRlXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIHZiPXt9O2Z1bmN0aW9uIHdiKGEsYixjKXtpZihhP2EudzphKXJldHVybiBhLncoYSxiLGMpO3ZhciBkO2Q9d2JbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD13Yi5fLCFkKSl0aHJvdyB4KFwiSVByaW50V2l0aFdyaXRlci4tcHItd3JpdGVyXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiB4YihhLGIsYyl7aWYoYT9hLlJiOmEpcmV0dXJuIGEuUmIoMCxiLGMpO3ZhciBkO2Q9eGJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD14Yi5fLCFkKSl0aHJvdyB4KFwiSVdhdGNoYWJsZS4tbm90aWZ5LXdhdGNoZXNcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfVxuZnVuY3Rpb24geWIoYSl7aWYoYT9hLldhOmEpcmV0dXJuIGEuV2EoYSk7dmFyIGI7Yj15YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPXliLl8sIWIpKXRocm93IHgoXCJJRWRpdGFibGVDb2xsZWN0aW9uLi1hcy10cmFuc2llbnRcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gemIoYSxiKXtpZihhP2EuS2E6YSlyZXR1cm4gYS5LYShhLGIpO3ZhciBjO2M9emJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz16Yi5fLCFjKSl0aHJvdyB4KFwiSVRyYW5zaWVudENvbGxlY3Rpb24uLWNvbmohXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gQWIoYSl7aWYoYT9hLk9hOmEpcmV0dXJuIGEuT2EoYSk7dmFyIGI7Yj1BYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUFiLl8sIWIpKXRocm93IHgoXCJJVHJhbnNpZW50Q29sbGVjdGlvbi4tcGVyc2lzdGVudCFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG5mdW5jdGlvbiBCYihhLGIsYyl7aWYoYT9hLmNiOmEpcmV0dXJuIGEuY2IoYSxiLGMpO3ZhciBkO2Q9QmJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1CYi5fLCFkKSl0aHJvdyB4KFwiSVRyYW5zaWVudEFzc29jaWF0aXZlLi1hc3NvYyFcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIENiKGEsYil7aWYoYT9hLkFiOmEpcmV0dXJuIGEuQWIoYSxiKTt2YXIgYztjPUNiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9Q2IuXywhYykpdGhyb3cgeChcIklUcmFuc2llbnRNYXAuLWRpc3NvYyFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBEYihhLGIsYyl7aWYoYT9hLlBiOmEpcmV0dXJuIGEuUGIoMCxiLGMpO3ZhciBkO2Q9RGJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1EYi5fLCFkKSl0aHJvdyB4KFwiSVRyYW5zaWVudFZlY3Rvci4tYXNzb2MtbiFcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfVxuZnVuY3Rpb24gRWIoYSl7aWYoYT9hLlFiOmEpcmV0dXJuIGEuUWIoKTt2YXIgYjtiPUViW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9RWIuXywhYikpdGhyb3cgeChcIklUcmFuc2llbnRWZWN0b3IuLXBvcCFcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gRmIoYSxiKXtpZihhP2EuT2I6YSlyZXR1cm4gYS5PYigwLGIpO3ZhciBjO2M9RmJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1GYi5fLCFjKSl0aHJvdyB4KFwiSVRyYW5zaWVudFNldC4tZGlzam9pbiFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiBHYihhKXtpZihhP2EuS2I6YSlyZXR1cm4gYS5LYigpO3ZhciBiO2I9R2JbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1HYi5fLCFiKSl0aHJvdyB4KFwiSUNodW5rLi1kcm9wLWZpcnN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gSGIoYSl7aWYoYT9hLnNiOmEpcmV0dXJuIGEuc2IoYSk7dmFyIGI7Yj1IYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUhiLl8sIWIpKXRocm93IHgoXCJJQ2h1bmtlZFNlcS4tY2h1bmtlZC1maXJzdFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBJYihhKXtpZihhP2EudGI6YSlyZXR1cm4gYS50YihhKTt2YXIgYjtiPUliW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9SWIuXywhYikpdGhyb3cgeChcIklDaHVua2VkU2VxLi1jaHVua2VkLXJlc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gSmIoYSl7aWYoYT9hLnJiOmEpcmV0dXJuIGEucmIoYSk7dmFyIGI7Yj1KYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUpiLl8sIWIpKXRocm93IHgoXCJJQ2h1bmtlZE5leHQuLWNodW5rZWQtbmV4dFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIEtiKGEpe3RoaXMudmM9YTt0aGlzLnE9MDt0aGlzLmk9MTA3Mzc0MTgyNH1LYi5wcm90b3R5cGUuU2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy52Yy5hcHBlbmQoYil9O2Z1bmN0aW9uIExiKGEpe3ZhciBiPW5ldyBlYTthLncobnVsbCxuZXcgS2IoYiksa2EoKSk7cmV0dXJuXCJcIitBLmIoYil9dmFyIE1iPVwidW5kZWZpbmVkXCIhPT10eXBlb2YgTWF0aC5pbXVsJiYwIT09KE1hdGguaW11bC5hP01hdGguaW11bC5hKDQyOTQ5NjcyOTUsNSk6TWF0aC5pbXVsLmNhbGwobnVsbCw0Mjk0OTY3Mjk1LDUpKT9mdW5jdGlvbihhLGIpe3JldHVybiBNYXRoLmltdWwoYSxiKX06ZnVuY3Rpb24oYSxiKXt2YXIgYz1hJjY1NTM1LGQ9YiY2NTUzNTtyZXR1cm4gYypkKygoYT4+PjE2JjY1NTM1KSpkK2MqKGI+Pj4xNiY2NTUzNSk8PDE2Pj4+MCl8MH07ZnVuY3Rpb24gTmIoYSl7YT1NYihhLDM0MzI5MTgzNTMpO3JldHVybiBNYihhPDwxNXxhPj4+LTE1LDQ2MTg0NTkwNyl9XG5mdW5jdGlvbiBPYihhLGIpe3ZhciBjPWFeYjtyZXR1cm4gTWIoYzw8MTN8Yz4+Pi0xMyw1KSszODY0MjkyMTk2fWZ1bmN0aW9uIFBiKGEsYil7dmFyIGM9YV5iLGM9TWIoY15jPj4+MTYsMjI0NjgyMjUwNyksYz1NYihjXmM+Pj4xMywzMjY2NDg5OTA5KTtyZXR1cm4gY15jPj4+MTZ9dmFyIFFiPXt9LFJiPTA7ZnVuY3Rpb24gU2IoYSl7MjU1PFJiJiYoUWI9e30sUmI9MCk7dmFyIGI9UWJbYV07aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBiKXthOmlmKG51bGwhPWEpaWYoYj1hLmxlbmd0aCwwPGIpe2Zvcih2YXIgYz0wLGQ9MDs7KWlmKGM8Yil2YXIgZT1jKzEsZD1NYigzMSxkKSthLmNoYXJDb2RlQXQoYyksYz1lO2Vsc2V7Yj1kO2JyZWFrIGF9Yj12b2lkIDB9ZWxzZSBiPTA7ZWxzZSBiPTA7UWJbYV09YjtSYis9MX1yZXR1cm4gYT1ifVxuZnVuY3Rpb24gVGIoYSl7YSYmKGEuaSY0MTk0MzA0fHxhLkRjKT9hPWEuQihudWxsKTpcIm51bWJlclwiPT09dHlwZW9mIGE/YT1NYXRoLmZsb29yKGEpJTIxNDc0ODM2NDc6ITA9PT1hP2E9MTohMT09PWE/YT0wOlwic3RyaW5nXCI9PT10eXBlb2YgYT8oYT1TYihhKSwwIT09YSYmKGE9TmIoYSksYT1PYigwLGEpLGE9UGIoYSw0KSkpOmE9bnVsbD09YT8wOnU/amIoYSk6bnVsbDtyZXR1cm4gYX1cbmZ1bmN0aW9uIFViKGEpe3ZhciBiO2I9YS5uYW1lO3ZhciBjO2E6e2M9MTtmb3IodmFyIGQ9MDs7KWlmKGM8Yi5sZW5ndGgpe3ZhciBlPWMrMixkPU9iKGQsTmIoYi5jaGFyQ29kZUF0KGMtMSl8Yi5jaGFyQ29kZUF0KGMpPDwxNikpO2M9ZX1lbHNle2M9ZDticmVhayBhfWM9dm9pZCAwfWM9MT09PShiLmxlbmd0aCYxKT9jXk5iKGIuY2hhckNvZGVBdChiLmxlbmd0aC0xKSk6YztiPVBiKGMsTWIoMixiLmxlbmd0aCkpO2E9U2IoYS5mYSk7cmV0dXJuIGJeYSsyNjU0NDM1NzY5KyhiPDw2KSsoYj4+Mil9XG5mdW5jdGlvbiBWYihhLGIpe2lmKHIoV2IuYT9XYi5hKGEsYik6V2IuY2FsbChudWxsLGEsYikpKXJldHVybiAwO3ZhciBjPXNhKGEuZmEpO2lmKHIoYz9iLmZhOmMpKXJldHVybi0xO2lmKHIoYS5mYSkpe2lmKHNhKGIuZmEpKXJldHVybiAxO2M9WGIuYT9YYi5hKGEuZmEsYi5mYSk6WGIuY2FsbChudWxsLGEuZmEsYi5mYSk7cmV0dXJuIDA9PT1jP1hiLmE/WGIuYShhLm5hbWUsYi5uYW1lKTpYYi5jYWxsKG51bGwsYS5uYW1lLGIubmFtZSk6Y31yZXR1cm4gWWI/WGIuYT9YYi5hKGEubmFtZSxiLm5hbWUpOlhiLmNhbGwobnVsbCxhLm5hbWUsYi5uYW1lKTpudWxsfWZ1bmN0aW9uIFpiKGEsYixjLGQsZSl7dGhpcy5mYT1hO3RoaXMubmFtZT1iO3RoaXMuTmE9Yzt0aGlzLlVhPWQ7dGhpcy5XPWU7dGhpcy5pPTIxNTQxNjgzMjE7dGhpcy5xPTQwOTZ9Zz1aYi5wcm90b3R5cGU7Zy53PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHViKGIsdGhpcy5OYSl9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5VYTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMuVWE9YT1VYih0aGlzKX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBaYih0aGlzLmZhLHRoaXMubmFtZSx0aGlzLk5hLHRoaXMuVWEsYil9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLld9O2cuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIExhLmMoYyx0aGlzLG51bGwpO2Nhc2UgMzpyZXR1cm4gTGEuYyhjLHRoaXMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIExhLmMoYSx0aGlzLG51bGwpfTtcbmcuYT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKGEsdGhpcyxiKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBaYj90aGlzLk5hPT09Yi5OYTohMX07Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLk5hfTt2YXIgJGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7dmFyIGM9bnVsbCE9YT9cIlwiK0EuYihhKStcIi9cIitBLmIoYik6YjtyZXR1cm4gbmV3IFpiKGEsYixjLG51bGwsbnVsbCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIFpiP2E6Yy5hKG51bGwsYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIEUoYSl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDtpZihhJiYoYS5pJjgzODg2MDh8fGEuaGMpKXJldHVybiBhLkgobnVsbCk7aWYoYSBpbnN0YW5jZW9mIEFycmF5fHxcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIDA9PT1hLmxlbmd0aD9udWxsOm5ldyBhYyhhLDApO2lmKHMoa2IsYSkpcmV0dXJuIGxiKGEpO2lmKHUpdGhyb3cgRXJyb3IoXCJcIitBLmIoYSkrXCIgaXMgbm90IElTZXFhYmxlXCIpO3JldHVybiBudWxsfWZ1bmN0aW9uIEYoYSl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDtpZihhJiYoYS5pJjY0fHxhLmJiKSlyZXR1cm4gYS5RKG51bGwpO2E9RShhKTtyZXR1cm4gbnVsbD09YT9udWxsOkhhKGEpfWZ1bmN0aW9uIEcoYSl7cmV0dXJuIG51bGwhPWE/YSYmKGEuaSY2NHx8YS5iYik/YS5TKG51bGwpOihhPUUoYSkpP0lhKGEpOkg6SH1mdW5jdGlvbiBJKGEpe3JldHVybiBudWxsPT1hP251bGw6YSYmKGEuaSYxMjh8fGEub2IpP2EuVShudWxsKTpFKEcoYSkpfVxudmFyIFdiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBudWxsPT1hP251bGw9PWI6YT09PWJ8fGliKGEsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2Zvcig7OylpZihiLmEoYSxkKSlpZihJKGUpKWE9ZCxkPUYoZSksZT1JKGUpO2Vsc2UgcmV0dXJuIGIuYShkLEYoZSkpO2Vsc2UgcmV0dXJuITF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4hMDtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsXG5lKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMH07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBiYyhhLGIpe3ZhciBjPU5iKGEpLGM9T2IoMCxjKTtyZXR1cm4gUGIoYyxiKX1mdW5jdGlvbiBjYyhhKXt2YXIgYj0wLGM9MTtmb3IoYT1FKGEpOzspaWYobnVsbCE9YSliKz0xLGM9TWIoMzEsYykrVGIoRihhKSl8MCxhPUkoYSk7ZWxzZSByZXR1cm4gYmMoYyxiKX1mdW5jdGlvbiBkYyhhKXt2YXIgYj0wLGM9MDtmb3IoYT1FKGEpOzspaWYobnVsbCE9YSliKz0xLGM9YytUYihGKGEpKXwwLGE9SShhKTtlbHNlIHJldHVybiBiYyhjLGIpfXphW1wibnVsbFwiXT0hMDtBYVtcIm51bGxcIl09ZnVuY3Rpb24oKXtyZXR1cm4gMH07XG5EYXRlLnByb3RvdHlwZS52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBEYXRlJiZ0aGlzLnRvU3RyaW5nKCk9PT1iLnRvU3RyaW5nKCl9O2liLm51bWJlcj1mdW5jdGlvbihhLGIpe3JldHVybiBhPT09Yn07YmJbXCJmdW5jdGlvblwiXT0hMDtjYltcImZ1bmN0aW9uXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O3lhW1wiZnVuY3Rpb25cIl09ITA7amIuXz1mdW5jdGlvbihhKXtyZXR1cm4gYVtiYV18fChhW2JhXT0rK2NhKX07ZnVuY3Rpb24gZWMoYSl7dGhpcy5sPWE7dGhpcy5xPTA7dGhpcy5pPTMyNzY4fWVjLnByb3RvdHlwZS51Yj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2Z1bmN0aW9uIGZjKGEpe3JldHVybiBhIGluc3RhbmNlb2YgZWN9XG52YXIgZ2M9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe2Zvcih2YXIgbD1BYShhKTs7KWlmKGQ8bCl7Yz1iLmE/Yi5hKGMsRC5hKGEsZCkpOmIuY2FsbChudWxsLGMsRC5hKGEsZCkpO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2QrPTF9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBiKGEsYixjKXtmb3IodmFyIGQ9QWEoYSksbD0wOzspaWYobDxkKXtjPWIuYT9iLmEoYyxELmEoYSxsKSk6Yi5jYWxsKG51bGwsYyxELmEoYSxsKSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7bCs9MX1lbHNlIHJldHVybiBjfWZ1bmN0aW9uIGMoYSxiKXt2YXIgYz1BYShhKTtpZigwPT09YylyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtmb3IodmFyIGQ9RC5hKGEsMCksbD0xOzspaWYobDxjKXtkPWIuYT9iLmEoZCxELmEoYSxsKSk6Yi5jYWxsKG51bGwsZCxELmEoYSxsKSk7aWYoZmMoZCkpcmV0dXJuIEsuYj9LLmIoZCk6Sy5jYWxsKG51bGwsXG5kKTtsKz0xfWVsc2UgcmV0dXJuIGR9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCksaGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe2Zvcih2YXIgbD1hLmxlbmd0aDs7KWlmKGQ8bCl7Yz1iLmE/Yi5hKGMsYVtkXSk6Yi5jYWxsKG51bGwsYyxhW2RdKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtkKz0xfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gYihhLGIsYyl7Zm9yKHZhciBkPWEubGVuZ3RoLGw9MDs7KWlmKGw8ZCl7Yz1iLmE/Yi5hKGMsYVtsXSk6Yi5jYWxsKG51bGwsYyxcbmFbbF0pO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2wrPTF9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBjKGEsYil7dmFyIGM9YS5sZW5ndGg7aWYoMD09PWEubGVuZ3RoKXJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Zvcih2YXIgZD1hWzBdLGw9MTs7KWlmKGw8Yyl7ZD1iLmE/Yi5hKGQsYVtsXSk6Yi5jYWxsKG51bGwsZCxhW2xdKTtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtsKz0xfWVsc2UgcmV0dXJuIGR9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCk7XG5mdW5jdGlvbiBpYyhhKXtyZXR1cm4gYT9hLmkmMnx8YS5ZYj8hMDphLmk/ITE6cyh6YSxhKTpzKHphLGEpfWZ1bmN0aW9uIGpjKGEpe3JldHVybiBhP2EuaSYxNnx8YS5MYj8hMDphLmk/ITE6cyhFYSxhKTpzKEVhLGEpfWZ1bmN0aW9uIGFjKGEsYil7dGhpcy5lPWE7dGhpcy5wPWI7dGhpcy5pPTE2NjE5OTU1MDt0aGlzLnE9ODE5Mn1nPWFjLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLko9ZnVuY3Rpb24oYSxiKXt2YXIgYz1iK3RoaXMucDtyZXR1cm4gYzx0aGlzLmUubGVuZ3RoP3RoaXMuZVtjXTpudWxsfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXthPWIrdGhpcy5wO3JldHVybiBhPHRoaXMuZS5sZW5ndGg/dGhpcy5lW2FdOmN9O2cuVT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnArMTx0aGlzLmUubGVuZ3RoP25ldyBhYyh0aGlzLmUsdGhpcy5wKzEpOm51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmUubGVuZ3RoLXRoaXMucH07XG5nLlhhPWZ1bmN0aW9uKCl7dmFyIGE9QWEodGhpcyk7cmV0dXJuIDA8YT9uZXcga2ModGhpcyxhLTEsbnVsbCk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGMuYT9sYy5hKHRoaXMsYik6bGMuY2FsbChudWxsLHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBIfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gaGMubih0aGlzLmUsYix0aGlzLmVbdGhpcy5wXSx0aGlzLnArMSl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGhjLm4odGhpcy5lLGIsYyx0aGlzLnApfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lW3RoaXMucF19O2cuUz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnArMTx0aGlzLmUubGVuZ3RoP25ldyBhYyh0aGlzLmUsdGhpcy5wKzEpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNLmE/TS5hKGIsdGhpcyk6TS5jYWxsKG51bGwsYix0aGlzKX07XG52YXIgbWM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIGI8YS5sZW5ndGg/bmV3IGFjKGEsYik6bnVsbH1mdW5jdGlvbiBiKGEpe3JldHVybiBjLmEoYSwwKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLEo9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG1jLmEoYSxiKX1mdW5jdGlvbiBiKGEpe3JldHVybiBtYy5hKGEsMCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIGtjKGEsYixjKXt0aGlzLmpiPWE7dGhpcy5wPWI7dGhpcy5qPWM7dGhpcy5pPTMyMzc0OTkwO3RoaXMucT04MTkyfWc9a2MucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMucD9uZXcga2ModGhpcy5qYix0aGlzLnAtMSxudWxsKTpudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wKzF9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjLmE/bGMuYSh0aGlzLGIpOmxjLmNhbGwobnVsbCx0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTi5hP04uYShILHRoaXMuaik6Ti5jYWxsKG51bGwsSCx0aGlzLmopfTtcbmcuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hP25jLmEoYix0aGlzKTpuYy5jYWxsKG51bGwsYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYz9uYy5jKGIsYyx0aGlzKTpuYy5jYWxsKG51bGwsYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRC5hKHRoaXMuamIsdGhpcy5wKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5wP25ldyBrYyh0aGlzLmpiLHRoaXMucC0xLG51bGwpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGtjKHRoaXMuamIsdGhpcy5wLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTS5hP00uYShiLHRoaXMpOk0uY2FsbChudWxsLGIsdGhpcyl9O2Z1bmN0aW9uIG9jKGEpe2Zvcig7Oyl7dmFyIGI9SShhKTtpZihudWxsIT1iKWE9YjtlbHNlIHJldHVybiBGKGEpfX1pYi5fPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1ifTtcbnZhciBwYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbnVsbCE9YT9EYShhLGIpOkRhKEgsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2Zvcig7OylpZihyKGUpKWE9Yi5hKGEsZCksZD1GKGUpLGU9SShlKTtlbHNlIHJldHVybiBiLmEoYSxkKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBxYyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOkJhKGEpfWZ1bmN0aW9uIE8oYSl7aWYobnVsbCE9YSlpZihhJiYoYS5pJjJ8fGEuWWIpKWE9YS5MKG51bGwpO2Vsc2UgaWYoYSBpbnN0YW5jZW9mIEFycmF5KWE9YS5sZW5ndGg7ZWxzZSBpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpYT1hLmxlbmd0aDtlbHNlIGlmKHMoemEsYSkpYT1BYShhKTtlbHNlIGlmKHUpYTp7YT1FKGEpO2Zvcih2YXIgYj0wOzspe2lmKGljKGEpKXthPWIrQWEoYSk7YnJlYWsgYX1hPUkoYSk7Yis9MX1hPXZvaWQgMH1lbHNlIGE9bnVsbDtlbHNlIGE9MDtyZXR1cm4gYX1cbnZhciByYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2Zvcig7Oyl7aWYobnVsbD09YSlyZXR1cm4gYztpZigwPT09YilyZXR1cm4gRShhKT9GKGEpOmM7aWYoamMoYSkpcmV0dXJuIEQuYyhhLGIsYyk7aWYoRShhKSlhPUkoYSksYi09MTtlbHNlIHJldHVybiB1P2M6bnVsbH19ZnVuY3Rpb24gYihhLGIpe2Zvcig7Oyl7aWYobnVsbD09YSl0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7aWYoMD09PWIpe2lmKEUoYSkpcmV0dXJuIEYoYSk7dGhyb3cgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO31pZihqYyhhKSlyZXR1cm4gRC5hKGEsYik7aWYoRShhKSl7dmFyIGM9SShhKSxoPWItMTthPWM7Yj1ofWVsc2V7aWYodSl0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7cmV0dXJuIG51bGx9fX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxcbmMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksUD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKFwibnVtYmVyXCIhPT10eXBlb2YgYil0aHJvdyBFcnJvcihcImluZGV4IGFyZ3VtZW50IHRvIG50aCBtdXN0IGJlIGEgbnVtYmVyLlwiKTtpZihudWxsPT1hKXJldHVybiBjO2lmKGEmJihhLmkmMTZ8fGEuTGIpKXJldHVybiBhLmFhKG51bGwsYixjKTtpZihhIGluc3RhbmNlb2YgQXJyYXl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYjxhLmxlbmd0aD9hW2JdOmM7aWYocyhFYSxhKSlyZXR1cm4gRC5hKGEsYik7aWYoYT9hLmkmNjR8fGEuYmJ8fChhLmk/MDpzKEZhLGEpKTpzKEZhLGEpKXJldHVybiByYy5jKGEsYixjKTtpZih1KXRocm93IEVycm9yKFwibnRoIG5vdCBzdXBwb3J0ZWQgb24gdGhpcyB0eXBlIFwiK0EuYih1YSh0YShhKSkpKTtyZXR1cm4gbnVsbH1mdW5jdGlvbiBiKGEsXG5iKXtpZihcIm51bWJlclwiIT09dHlwZW9mIGIpdGhyb3cgRXJyb3IoXCJpbmRleCBhcmd1bWVudCB0byBudGggbXVzdCBiZSBhIG51bWJlclwiKTtpZihudWxsPT1hKXJldHVybiBhO2lmKGEmJihhLmkmMTZ8fGEuTGIpKXJldHVybiBhLkoobnVsbCxiKTtpZihhIGluc3RhbmNlb2YgQXJyYXl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYjxhLmxlbmd0aD9hW2JdOm51bGw7aWYocyhFYSxhKSlyZXR1cm4gRC5hKGEsYik7aWYoYT9hLmkmNjR8fGEuYmJ8fChhLmk/MDpzKEZhLGEpKTpzKEZhLGEpKXJldHVybiByYy5hKGEsYik7aWYodSl0aHJvdyBFcnJvcihcIm50aCBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgdHlwZSBcIitBLmIodWEodGEoYSkpKSk7cmV0dXJuIG51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gbnVsbCE9YT9hJiYoYS5pJjI1Nnx8YS5NYik/YS5DKG51bGwsYixjKTphIGluc3RhbmNlb2YgQXJyYXk/YjxhLmxlbmd0aD9hW2JdOmM6XCJzdHJpbmdcIj09PXR5cGVvZiBhP2I8YS5sZW5ndGg/YVtiXTpjOnMoS2EsYSk/TGEuYyhhLGIsYyk6dT9jOm51bGw6Y31mdW5jdGlvbiBiKGEsYil7cmV0dXJuIG51bGw9PWE/bnVsbDphJiYoYS5pJjI1Nnx8YS5NYik/YS51KG51bGwsYik6YSBpbnN0YW5jZW9mIEFycmF5P2I8YS5sZW5ndGg/YVtiXTpudWxsOlwic3RyaW5nXCI9PT10eXBlb2YgYT9iPGEubGVuZ3RoP2FbYl06bnVsbDpzKEthLGEpP0xhLmEoYSxiKTpudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLFxuYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxSPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIG51bGwhPWE/T2EoYSxiLGMpOnNjLmE/c2MuYShbYl0sW2NdKTpzYy5jYWxsKG51bGwsW2JdLFtjXSl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayxsKXt2YXIgbj1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKG49SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsayxuKX1mdW5jdGlvbiBjKGEsZCxlLGwpe2Zvcig7OylpZihhPWIuYyhhLGQsZSkscihsKSlkPUYobCksZT1GKEkobCkpLGw9SShJKGwpKTtlbHNlIHJldHVybiBhfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgbD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLFxuZCxsLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSxmKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLGYsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MztiLmY9Yy5mO2IuYz1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksdGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG51bGw9PWE/bnVsbDpRYShhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtmb3IoOzspe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7YT1iLmEoYSxkKTtcbmlmKHIoZSkpZD1GKGUpLGU9SShlKTtlbHNlIHJldHVybiBhfX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gdWMoYSl7dmFyIGI9XCJmdW5jdGlvblwiPT1tKGEpO3JldHVybiBiP2I6YT9yKHIobnVsbCk/bnVsbDphLlhiKT8hMDphLkNiPyExOnMoeWEsYSk6cyh5YSxhKX1cbmZ1bmN0aW9uIHZjKGEsYil7dGhpcy5oPWE7dGhpcy5qPWI7dGhpcy5xPTA7dGhpcy5pPTM5MzIxN31nPXZjLnByb3RvdHlwZTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEsd2Mpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6dmFyIHo9YSx6PXRoaXM7cmV0dXJuIHouaC5vP3ouaC5vKCk6ei5oLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiB6PWEsej10aGlzLHouaC5iP3ouaC5iKGMpOnouaC5jYWxsKG51bGwsYyk7Y2FzZSAzOnJldHVybiB6PWEsej10aGlzLHouaC5hP3ouaC5hKGMsZCk6ei5oLmNhbGwobnVsbCxjLGQpO2Nhc2UgNDpyZXR1cm4gej1hLHo9dGhpcyx6LmguYz96LmguYyhjLGQsZSk6ei5oLmNhbGwobnVsbCxjLGQsZSk7Y2FzZSA1OnJldHVybiB6PWEsej10aGlzLHouaC5uP3ouaC5uKGMsZCxlLGYpOnouaC5jYWxsKG51bGwsYyxkLGUsZik7Y2FzZSA2OnJldHVybiB6PWEsej10aGlzLHouaC5zP3ouaC5zKGMsZCxlLGYsaCk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLFxuaCk7Y2FzZSA3OnJldHVybiB6PWEsej10aGlzLHouaC5YP3ouaC5YKGMsZCxlLGYsaCxrKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrKTtjYXNlIDg6cmV0dXJuIHo9YSx6PXRoaXMsei5oLmdhP3ouaC5nYShjLGQsZSxmLGgsayxsKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwpO2Nhc2UgOTpyZXR1cm4gej1hLHo9dGhpcyx6LmguR2E/ei5oLkdhKGMsZCxlLGYsaCxrLGwsbik6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4pO2Nhc2UgMTA6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkhhP3ouaC5IYShjLGQsZSxmLGgsayxsLG4scSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSk7Y2FzZSAxMTpyZXR1cm4gej1hLHo9dGhpcyx6LmgudmE/ei5oLnZhKGMsZCxlLGYsaCxrLGwsbixxLHQpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCk7Y2FzZSAxMjpyZXR1cm4gej1hLHo9dGhpcyx6Lmgud2E/ei5oLndhKGMsZCxlLGYsaCxrLGwsbixxLHQsdik6XG56LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdik7Y2FzZSAxMzpyZXR1cm4gej1hLHo9dGhpcyx6LmgueGE/ei5oLnhhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTtjYXNlIDE0OnJldHVybiB6PWEsej10aGlzLHouaC55YT96LmgueWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTtjYXNlIDE1OnJldHVybiB6PWEsej10aGlzLHouaC56YT96LmguemEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik7Y2FzZSAxNjpyZXR1cm4gej1hLHo9dGhpcyx6LmguQWE/ei5oLkFhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTtjYXNlIDE3OnJldHVybiB6PWEsej10aGlzLFxuei5oLkJhP3ouaC5CYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpO2Nhc2UgMTg6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkNhP3ouaC5DYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTtjYXNlIDE5OnJldHVybiB6PWEsej10aGlzLHouaC5EYT96LmguRGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk7Y2FzZSAyMDpyZXR1cm4gej1hLHo9dGhpcyx6LmguRWE/ei5oLkVhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EpO2Nhc2UgMjE6cmV0dXJuIHo9XG5hLHo9dGhpcyx6LmguRmE/ei5oLkZhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSxSYSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEpO2Nhc2UgMjI6cmV0dXJuIHo9YSx6PXRoaXMsUy5iYz9TLmJjKHouaCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEsd2MpOlMuY2FsbChudWxsLHouaCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEsd2MpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5vPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaC5vP3RoaXMuaC5vKCk6dGhpcy5oLmNhbGwobnVsbCl9O1xuZy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmguYj90aGlzLmguYihhKTp0aGlzLmguY2FsbChudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5oLmE/dGhpcy5oLmEoYSxiKTp0aGlzLmguY2FsbChudWxsLGEsYil9O2cuYz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMuaC5jP3RoaXMuaC5jKGEsYixjKTp0aGlzLmguY2FsbChudWxsLGEsYixjKX07Zy5uPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmgubj90aGlzLmgubihhLGIsYyxkKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQpfTtnLnM9ZnVuY3Rpb24oYSxiLGMsZCxlKXtyZXR1cm4gdGhpcy5oLnM/dGhpcy5oLnMoYSxiLGMsZCxlKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSl9O2cuWD1mdW5jdGlvbihhLGIsYyxkLGUsZil7cmV0dXJuIHRoaXMuaC5YP3RoaXMuaC5YKGEsYixjLGQsZSxmKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmKX07XG5nLmdhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgpe3JldHVybiB0aGlzLmguZ2E/dGhpcy5oLmdhKGEsYixjLGQsZSxmLGgpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCl9O2cuR2E9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrKXtyZXR1cm4gdGhpcy5oLkdhP3RoaXMuaC5HYShhLGIsYyxkLGUsZixoLGspOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrKX07Zy5IYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCl7cmV0dXJuIHRoaXMuaC5IYT90aGlzLmguSGEoYSxiLGMsZCxlLGYsaCxrLGwpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwpfTtnLnZhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4pe3JldHVybiB0aGlzLmgudmE/dGhpcy5oLnZhKGEsYixjLGQsZSxmLGgsayxsLG4pOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbil9O1xuZy53YT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEpe3JldHVybiB0aGlzLmgud2E/dGhpcy5oLndhKGEsYixjLGQsZSxmLGgsayxsLG4scSk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEpfTtnLnhhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0KXtyZXR1cm4gdGhpcy5oLnhhP3RoaXMuaC54YShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCl9O2cueWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdil7cmV0dXJuIHRoaXMuaC55YT90aGlzLmgueWEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2KX07XG5nLnphPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyl7cmV0dXJuIHRoaXMuaC56YT90aGlzLmguemEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyl9O2cuQWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpe3JldHVybiB0aGlzLmguQWE/dGhpcy5oLkFhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KX07Zy5CYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKXtyZXR1cm4gdGhpcy5oLkJhP3RoaXMuaC5CYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpfTtcbmcuQ2E9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKXtyZXR1cm4gdGhpcy5oLkNhP3RoaXMuaC5DYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKX07Zy5EYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSl7cmV0dXJuIHRoaXMuaC5EYT90aGlzLmguRGEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpfTtcbmcuRWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWil7cmV0dXJuIHRoaXMuaC5FYT90aGlzLmguRWEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKX07Zy5GYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKXtyZXR1cm4gdGhpcy5oLkZhP3RoaXMuaC5GYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpfTtnLlhiPSEwO2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgdmModGhpcy5oLGIpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtcbmZ1bmN0aW9uIE4oYSxiKXtyZXR1cm4gdWMoYSkmJiEoYT9hLmkmMjYyMTQ0fHxhLm9jfHwoYS5pPzA6cyhkYixhKSk6cyhkYixhKSk/bmV3IHZjKGEsYik6bnVsbD09YT9udWxsOmViKGEsYil9ZnVuY3Rpb24geGMoYSl7dmFyIGI9bnVsbCE9YTtyZXR1cm4oYj9hP2EuaSYxMzEwNzJ8fGEuZWN8fChhLmk/MDpzKGJiLGEpKTpzKGJiLGEpOmIpP2NiKGEpOm51bGx9ZnVuY3Rpb24geWMoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDpYYShhKX1mdW5jdGlvbiB6YyhhKXtyZXR1cm4gbnVsbD09YT9udWxsOllhKGEpfVxudmFyIEFjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBudWxsPT1hP251bGw6V2EoYSxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7Zm9yKDs7KXtpZihudWxsPT1hKXJldHVybiBudWxsO2E9Yi5hKGEsZCk7aWYocihlKSlkPUYoZSksZT1JKGUpO2Vsc2UgcmV0dXJuIGF9fWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLFxuZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIEJjKGEpe3JldHVybiBudWxsPT1hfHxzYShFKGEpKX1mdW5jdGlvbiBDYyhhKXtyZXR1cm4gbnVsbD09YT8hMTphP2EuaSY4fHxhLkFjPyEwOmEuaT8hMTpzKENhLGEpOnMoQ2EsYSl9ZnVuY3Rpb24gRGMoYSl7cmV0dXJuIG51bGw9PWE/ITE6YT9hLmkmNDA5Nnx8YS5qYz8hMDphLmk/ITE6cyhWYSxhKTpzKFZhLGEpfWZ1bmN0aW9uIEVjKGEpe3JldHVybiBhP2EuaSY1MTJ8fGEueWM/ITA6YS5pPyExOnMoTWEsYSk6cyhNYSxhKX1mdW5jdGlvbiBGYyhhKXtyZXR1cm4gYT9hLmkmMTY3NzcyMTZ8fGEuaWM/ITA6YS5pPyExOnMobWIsYSk6cyhtYixhKX1cbmZ1bmN0aW9uIEdjKGEpe3JldHVybiBudWxsPT1hPyExOmE/YS5pJjEwMjR8fGEuY2M/ITA6YS5pPyExOnMoUGEsYSk6cyhQYSxhKX1mdW5jdGlvbiBIYyhhKXtyZXR1cm4gYT9hLmkmMTYzODR8fGEuR2M/ITA6YS5pPyExOnMoWmEsYSk6cyhaYSxhKX1mdW5jdGlvbiBJYyhhKXtyZXR1cm4gYT9hLnEmNTEyfHxhLnpjPyEwOiExOiExfWZ1bmN0aW9uIEpjKGEpe3ZhciBiPVtdO2RhKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIsZSl7cmV0dXJuIGEucHVzaChlKX19KGIpKTtyZXR1cm4gYn1mdW5jdGlvbiBLYyhhLGIsYyxkLGUpe2Zvcig7MCE9PWU7KWNbZF09YVtiXSxkKz0xLGUtPTEsYis9MX12YXIgTGM9e307ZnVuY3Rpb24gTWMoYSl7cmV0dXJuIG51bGw9PWE/ITE6YT9hLmkmNjR8fGEuYmI/ITA6YS5pPyExOnMoRmEsYSk6cyhGYSxhKX1mdW5jdGlvbiBOYyhhKXtyZXR1cm4gcihhKT8hMDohMX1cbmZ1bmN0aW9uIE9jKGEsYil7cmV0dXJuIFEuYyhhLGIsTGMpPT09TGM/ITE6ITB9ZnVuY3Rpb24gWGIoYSxiKXtpZihhPT09YilyZXR1cm4gMDtpZihudWxsPT1hKXJldHVybi0xO2lmKG51bGw9PWIpcmV0dXJuIDE7aWYodGEoYSk9PT10YShiKSlyZXR1cm4gYSYmKGEucSYyMDQ4fHxhLmxiKT9hLm1iKG51bGwsYik6Z2EoYSxiKTtpZih1KXRocm93IEVycm9yKFwiY29tcGFyZSBvbiBub24tbmlsIG9iamVjdHMgb2YgZGlmZmVyZW50IHR5cGVzXCIpO3JldHVybiBudWxsfVxudmFyIFBjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoKXtmb3IoOzspe3ZhciBrPVhiKFAuYShhLGgpLFAuYShiLGgpKTtpZigwPT09ayYmaCsxPGMpaCs9MTtlbHNlIHJldHVybiBrfX1mdW5jdGlvbiBiKGEsYil7dmFyIGY9TyhhKSxoPU8oYik7cmV0dXJuIGY8aD8tMTpmPmg/MTp1P2MubihhLGIsZiwwKTpudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2Mubj1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gUWMoYSl7cmV0dXJuIFdiLmEoYSxYYik/WGI6ZnVuY3Rpb24oYixjKXt2YXIgZD1hLmE/YS5hKGIsYyk6YS5jYWxsKG51bGwsYixjKTtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGQ/ZDpyKGQpPy0xOnIoYS5hP2EuYShjLGIpOmEuY2FsbChudWxsLGMsYikpPzE6MH19XG52YXIgU2M9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7aWYoRShiKSl7dmFyIGM9UmMuYj9SYy5iKGIpOlJjLmNhbGwobnVsbCxiKTtoYShjLFFjKGEpKTtyZXR1cm4gRShjKX1yZXR1cm4gSH1mdW5jdGlvbiBiKGEpe3JldHVybiBjLmEoWGIsYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxUYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBTYy5hKGZ1bmN0aW9uKGMsZil7cmV0dXJuIFFjKGIpLmNhbGwobnVsbCxhLmI/YS5iKGMpOmEuY2FsbChudWxsLGMpLGEuYj9hLmIoZik6YS5jYWxsKG51bGwsZikpfSxjKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLFhiLGIpfVxudmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxuYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2ZvcihjPUUoYyk7OylpZihjKXtiPWEuYT9hLmEoYixGKGMpKTphLmNhbGwobnVsbCxiLEYoYykpO2lmKGZjKGIpKXJldHVybiBLLmI/Sy5iKGIpOksuY2FsbChudWxsLGIpO2M9SShjKX1lbHNlIHJldHVybiBifWZ1bmN0aW9uIGIoYSxiKXt2YXIgYz1FKGIpO3JldHVybiBjP0MuYz9DLmMoYSxGKGMpLEkoYykpOkMuY2FsbChudWxsLGEsRihjKSxJKGMpKTphLm8/YS5vKCk6YS5jYWxsKG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxDPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIGMmJihjLmkmNTI0Mjg4fHxjLk5iKT9jLk0obnVsbCxhLGIpOmMgaW5zdGFuY2VvZiBBcnJheT9oYy5jKGMsYSxiKTpcInN0cmluZ1wiPT09dHlwZW9mIGM/aGMuYyhjLGEsYik6cyhmYixjKT9nYi5jKGMsYSxiKTp1P25jLmMoYSxiLGMpOm51bGx9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBiJiYoYi5pJjUyNDI4OHx8Yi5OYik/Yi5OKG51bGwsYSk6YiBpbnN0YW5jZW9mIEFycmF5P2hjLmEoYixhKTpcInN0cmluZ1wiPT09dHlwZW9mIGI/aGMuYShiLGEpOnMoZmIsYik/Z2IuYShiLGEpOnU/bmMuYShhLGIpOm51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxcbmMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFVjPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPmMpaWYoSShkKSlhPWMsYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBjPkYoZCk7ZWxzZSByZXR1cm4hMX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiEwO1xuY2FzZSAyOnJldHVybiBhPmQ7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsZCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0yO2EuZj1iLmY7YS5iPWZ1bmN0aW9uKCl7cmV0dXJuITB9O2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBhPmJ9O2EuZD1iLmQ7cmV0dXJuIGF9KCksVmM9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZixoKXt2YXIgaz1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsayl9ZnVuY3Rpb24gYihhLGMsZCl7Zm9yKDs7KWlmKGE+PWMpaWYoSShkKSlhPWMsYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBjPj1GKGQpO2Vsc2UgcmV0dXJuITF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7XG5hPUcoYSk7cmV0dXJuIGIoYyxoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiEwO2Nhc2UgMjpyZXR1cm4gYT49ZDtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMH07YS5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE+PWJ9O2EuZD1iLmQ7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gV2MoYSl7cmV0dXJuIGEtMX1cbnZhciBYYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gYT5iP2E6Yn12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7cmV0dXJuIEMuYyhiLGE+ZD9hOmQsZSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTtcbn07Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gWWMoYSl7YT0oYS1hJTIpLzI7cmV0dXJuIDA8PWE/TWF0aC5mbG9vci5iP01hdGguZmxvb3IuYihhKTpNYXRoLmZsb29yLmNhbGwobnVsbCxhKTpNYXRoLmNlaWwuYj9NYXRoLmNlaWwuYihhKTpNYXRoLmNlaWwuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFpjKGEpe2EtPWE+PjEmMTQzMTY1NTc2NTthPShhJjg1ODk5MzQ1OSkrKGE+PjImODU4OTkzNDU5KTtyZXR1cm4gMTY4NDMwMDkqKGErKGE+PjQpJjI1MjY0NTEzNSk+PjI0fWZ1bmN0aW9uICRjKGEpe3ZhciBiPTE7Zm9yKGE9RShhKTs7KWlmKGEmJjA8YiliLT0xLGE9SShhKTtlbHNlIHJldHVybiBhfVxudmFyIEE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBudWxsPT1hP1wiXCI6YS50b1N0cmluZygpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkKXt2YXIgaz1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGspfWZ1bmN0aW9uIGMoYSxkKXtmb3IodmFyIGU9bmV3IGVhKGIuYihhKSksbD1kOzspaWYocihsKSllPWUuYXBwZW5kKGIuYihGKGwpKSksbD1JKGwpO2Vsc2UgcmV0dXJuIGUudG9TdHJpbmcoKX1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUcoYSk7cmV0dXJuIGMoYixhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuXCJcIjtjYXNlIDE6cmV0dXJuIGEuY2FsbCh0aGlzLGIpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLEooYXJndW1lbnRzLFxuMSkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MTtiLmY9Yy5mO2Iubz1mdW5jdGlvbigpe3JldHVyblwiXCJ9O2IuYj1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksYWQ9ZnVuY3Rpb24oKXt2YXIgYT1udWxsLGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGEuc3Vic3RyaW5nKGMpO2Nhc2UgMzpyZXR1cm4gYS5zdWJzdHJpbmcoYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5hPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGEuc3Vic3RyaW5nKGMpfTthLmM9ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBhLnN1YnN0cmluZyhjLGQpfTtyZXR1cm4gYX0oKTtcbmZ1bmN0aW9uIGxjKGEsYil7cmV0dXJuIE5jKEZjKGIpP2Z1bmN0aW9uKCl7Zm9yKHZhciBjPUUoYSksZD1FKGIpOzspe2lmKG51bGw9PWMpcmV0dXJuIG51bGw9PWQ7aWYobnVsbD09ZClyZXR1cm4hMTtpZihXYi5hKEYoYyksRihkKSkpYz1JKGMpLGQ9SShkKTtlbHNlIHJldHVybiB1PyExOm51bGx9fSgpOm51bGwpfWZ1bmN0aW9uIGJkKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5maXJzdD1iO3RoaXMudGE9Yzt0aGlzLmNvdW50PWQ7dGhpcy5tPWU7dGhpcy5pPTY1OTM3NjQ2O3RoaXMucT04MTkyfWc9YmQucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiAxPT09dGhpcy5jb3VudD9udWxsOnRoaXMudGF9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvdW50fTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlyc3R9O2cuSmE9ZnVuY3Rpb24oKXtyZXR1cm4gSWEodGhpcyl9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gSH07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpcnN0fTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gMT09PXRoaXMuY291bnQ/SDp0aGlzLnRhfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBiZChiLHRoaXMuZmlyc3QsdGhpcy50YSx0aGlzLmNvdW50LHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgYmQodGhpcy5qLGIsdGhpcyx0aGlzLmNvdW50KzEsbnVsbCl9O1xuZnVuY3Rpb24gY2QoYSl7dGhpcy5qPWE7dGhpcy5pPTY1OTM3NjE0O3RoaXMucT04MTkyfWc9Y2QucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gMH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkphPWZ1bmN0aW9uKCl7dGhyb3cgRXJyb3IoXCJDYW4ndCBwb3AgZW1wdHkgbGlzdFwiKTt9O2cuQj1mdW5jdGlvbigpe3JldHVybiAwfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIEh9O1xuZy5IPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgY2QoYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgYmQodGhpcy5qLGIsbnVsbCwxLG51bGwpfTt2YXIgSD1uZXcgY2QobnVsbCk7ZnVuY3Rpb24gZGQoYSl7cmV0dXJuIGE/YS5pJjEzNDIxNzcyOHx8YS5GYz8hMDphLmk/ITE6cyhvYixhKTpzKG9iLGEpfWZ1bmN0aW9uIGVkKGEpe3JldHVybiBkZChhKT9wYihhKTpDLmMocGMsSCxhKX1cbnZhciBmZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXt2YXIgYjtpZihhIGluc3RhbmNlb2YgYWMmJjA9PT1hLnApYj1hLmU7ZWxzZSBhOntmb3IoYj1bXTs7KWlmKG51bGwhPWEpYi5wdXNoKGEuUShudWxsKSksYT1hLlUobnVsbCk7ZWxzZSBicmVhayBhO2I9dm9pZCAwfWE9Yi5sZW5ndGg7Zm9yKHZhciBlPUg7OylpZigwPGEpe3ZhciBmPWEtMSxlPWUuRyhudWxsLGJbYS0xXSk7YT1mfWVsc2UgcmV0dXJuIGV9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gZ2QoYSxiLGMsZCl7dGhpcy5qPWE7dGhpcy5maXJzdD1iO3RoaXMudGE9Yzt0aGlzLm09ZDt0aGlzLmk9NjU5Mjk0NTI7dGhpcy5xPTgxOTJ9XG5nPWdkLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy50YT9udWxsOkUodGhpcy50YSl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlyc3R9O2cuUz1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLnRhP0g6dGhpcy50YX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBnZChiLHRoaXMuZmlyc3QsdGhpcy50YSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGdkKG51bGwsYix0aGlzLHRoaXMubSl9O2Z1bmN0aW9uIE0oYSxiKXt2YXIgYz1udWxsPT1iO3JldHVybihjP2M6YiYmKGIuaSY2NHx8Yi5iYikpP25ldyBnZChudWxsLGEsYixudWxsKTpuZXcgZ2QobnVsbCxhLEUoYiksbnVsbCl9ZnVuY3Rpb24gVChhLGIsYyxkKXt0aGlzLmZhPWE7dGhpcy5uYW1lPWI7dGhpcy5zYT1jO3RoaXMuVWE9ZDt0aGlzLmk9MjE1Mzc3NTEwNTt0aGlzLnE9NDA5Nn1nPVQucHJvdG90eXBlO2cudz1mdW5jdGlvbihhLGIpe3JldHVybiB1YihiLFwiOlwiK0EuYih0aGlzLnNhKSl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVWE7cmV0dXJuIG51bGwhPWE/YTp0aGlzLlVhPWE9VWIodGhpcykrMjY1NDQzNTc2OX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBRLmEoYyx0aGlzKTtjYXNlIDM6cmV0dXJuIFEuYyhjLHRoaXMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIFEuYShhLHRoaXMpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUS5jKGEsdGhpcyxiKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBUP3RoaXMuc2E9PT1iLnNhOiExfTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCI6XCIrQS5iKHRoaXMuc2EpfTtcbmZ1bmN0aW9uIGhkKGEsYil7cmV0dXJuIGE9PT1iPyEwOmEgaW5zdGFuY2VvZiBUJiZiIGluc3RhbmNlb2YgVD9hLnNhPT09Yi5zYTohMX1cbnZhciBqZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbmV3IFQoYSxiLFwiXCIrQS5iKHIoYSk/XCJcIitBLmIoYSkrXCIvXCI6bnVsbCkrQS5iKGIpLG51bGwpfWZ1bmN0aW9uIGIoYSl7aWYoYSBpbnN0YW5jZW9mIFQpcmV0dXJuIGE7aWYoYSBpbnN0YW5jZW9mIFpiKXt2YXIgYjtpZihhJiYoYS5xJjQwOTZ8fGEuZmMpKWI9YS5mYTtlbHNlIHRocm93IEVycm9yKFwiRG9lc24ndCBzdXBwb3J0IG5hbWVzcGFjZTogXCIrQS5iKGEpKTtyZXR1cm4gbmV3IFQoYixpZC5iP2lkLmIoYSk6aWQuY2FsbChudWxsLGEpLGEuTmEsbnVsbCl9cmV0dXJuXCJzdHJpbmdcIj09PXR5cGVvZiBhPyhiPWEuc3BsaXQoXCIvXCIpLDI9PT1iLmxlbmd0aD9uZXcgVChiWzBdLGJbMV0sYSxudWxsKTpuZXcgVChudWxsLGJbMF0sYSxudWxsKSk6bnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLFxuYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gVihhLGIsYyxkKXt0aGlzLmo9YTt0aGlzLllhPWI7dGhpcy5yPWM7dGhpcy5tPWQ7dGhpcy5xPTA7dGhpcy5pPTMyMzc0OTg4fWc9Vi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07ZnVuY3Rpb24ga2QoYSl7bnVsbCE9YS5ZYSYmKGEucj1hLllhLm8/YS5ZYS5vKCk6YS5ZYS5jYWxsKG51bGwpLGEuWWE9bnVsbCk7cmV0dXJuIGEucn1nLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtsYih0aGlzKTtyZXR1cm4gbnVsbD09dGhpcy5yP251bGw6SSh0aGlzLnIpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O1xuZy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7bGIodGhpcyk7cmV0dXJuIG51bGw9PXRoaXMucj9udWxsOkYodGhpcy5yKX07Zy5TPWZ1bmN0aW9uKCl7bGIodGhpcyk7cmV0dXJuIG51bGwhPXRoaXMucj9HKHRoaXMucik6SH07Zy5IPWZ1bmN0aW9uKCl7a2QodGhpcyk7aWYobnVsbD09dGhpcy5yKXJldHVybiBudWxsO2Zvcih2YXIgYT10aGlzLnI7OylpZihhIGluc3RhbmNlb2YgVilhPWtkKGEpO2Vsc2UgcmV0dXJuIHRoaXMucj1hLEUodGhpcy5yKX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBWKGIsdGhpcy5ZYSx0aGlzLnIsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG5mdW5jdGlvbiBsZChhLGIpe3RoaXMucWI9YTt0aGlzLmVuZD1iO3RoaXMucT0wO3RoaXMuaT0yfWxkLnByb3RvdHlwZS5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kfTtsZC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEpe3RoaXMucWJbdGhpcy5lbmRdPWE7cmV0dXJuIHRoaXMuZW5kKz0xfTtsZC5wcm90b3R5cGUuZGE9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgbWQodGhpcy5xYiwwLHRoaXMuZW5kKTt0aGlzLnFiPW51bGw7cmV0dXJuIGF9O2Z1bmN0aW9uIG1kKGEsYixjKXt0aGlzLmU9YTt0aGlzLk89Yjt0aGlzLmVuZD1jO3RoaXMucT0wO3RoaXMuaT01MjQzMDZ9Zz1tZC5wcm90b3R5cGU7Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGhjLm4odGhpcy5lLGIsdGhpcy5lW3RoaXMuT10sdGhpcy5PKzEpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBoYy5uKHRoaXMuZSxiLGMsdGhpcy5PKX07XG5nLktiPWZ1bmN0aW9uKCl7aWYodGhpcy5PPT09dGhpcy5lbmQpdGhyb3cgRXJyb3IoXCItZHJvcC1maXJzdCBvZiBlbXB0eSBjaHVua1wiKTtyZXR1cm4gbmV3IG1kKHRoaXMuZSx0aGlzLk8rMSx0aGlzLmVuZCl9O2cuSj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVbdGhpcy5PK2JdfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMDw9YiYmYjx0aGlzLmVuZC10aGlzLk8/dGhpcy5lW3RoaXMuTytiXTpjfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQtdGhpcy5PfTtcbnZhciBuZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBuZXcgbWQoYSxiLGMpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gbmV3IG1kKGEsYixhLmxlbmd0aCl9ZnVuY3Rpb24gYyhhKXtyZXR1cm4gbmV3IG1kKGEsMCxhLmxlbmd0aCl9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBjLmNhbGwodGhpcyxkKTtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYj1jO2QuYT1iO2QuYz1hO3JldHVybiBkfSgpO2Z1bmN0aW9uIG9kKGEsYixjLGQpe3RoaXMuZGE9YTt0aGlzLm9hPWI7dGhpcy5qPWM7dGhpcy5tPWQ7dGhpcy5pPTMxODUwNzMyO3RoaXMucT0xNTM2fWc9b2QucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O1xuZy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7aWYoMTxBYSh0aGlzLmRhKSlyZXR1cm4gbmV3IG9kKEdiKHRoaXMuZGEpLHRoaXMub2EsdGhpcy5qLG51bGwpO3ZhciBhPWxiKHRoaXMub2EpO3JldHVybiBudWxsPT1hP251bGw6YX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuUT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcy5kYSwwKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIDE8QWEodGhpcy5kYSk/bmV3IG9kKEdiKHRoaXMuZGEpLHRoaXMub2EsdGhpcy5qLG51bGwpOm51bGw9PXRoaXMub2E/SDp0aGlzLm9hfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5zYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRhfTtcbmcudGI9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5vYT9IOnRoaXMub2F9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgb2QodGhpcy5kYSx0aGlzLm9hLGIsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07Zy5yYj1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLm9hP251bGw6dGhpcy5vYX07ZnVuY3Rpb24gcGQoYSxiKXtyZXR1cm4gMD09PUFhKGEpP2I6bmV3IG9kKGEsYixudWxsLG51bGwpfWZ1bmN0aW9uIFJjKGEpe2Zvcih2YXIgYj1bXTs7KWlmKEUoYSkpYi5wdXNoKEYoYSkpLGE9SShhKTtlbHNlIHJldHVybiBifWZ1bmN0aW9uIHFkKGEsYil7aWYoaWMoYSkpcmV0dXJuIE8oYSk7Zm9yKHZhciBjPWEsZD1iLGU9MDs7KWlmKDA8ZCYmRShjKSljPUkoYyksZC09MSxlKz0xO2Vsc2UgcmV0dXJuIGV9XG52YXIgc2Q9ZnVuY3Rpb24gcmQoYil7cmV0dXJuIG51bGw9PWI/bnVsbDpudWxsPT1JKGIpP0UoRihiKSk6dT9NKEYoYikscmQoSShiKSkpOm51bGx9LHRkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGM9RShhKTtyZXR1cm4gYz9JYyhjKT9wZChIYihjKSxkLmEoSWIoYyksYikpOk0oRihjKSxkLmEoRyhjKSxiKSk6Yn0sbnVsbCxudWxsKX1mdW5jdGlvbiBiKGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIGF9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYygpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9dmFyIGQ9bnVsbCxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSl7dmFyIGY9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxcbmQsZil9ZnVuY3Rpb24gYihhLGMsZSl7cmV0dXJuIGZ1bmN0aW9uIHQoYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBjPUUoYSk7cmV0dXJuIGM/SWMoYyk/cGQoSGIoYyksdChJYihjKSxiKSk6TShGKGMpLHQoRyhjKSxiKSk6cihiKT90KEYoYiksSShiKSk6bnVsbH0sbnVsbCxudWxsKX0oZC5hKGEsYyksZSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksZD1mdW5jdGlvbihkLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYy5jYWxsKHRoaXMpO2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsZCk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxkLGgpO2RlZmF1bHQ6cmV0dXJuIGUuZChkLGgsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9XG4yO2QuZj1lLmY7ZC5vPWM7ZC5iPWI7ZC5hPWE7ZC5kPWUuZDtyZXR1cm4gZH0oKSx1ZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIE0oYSxNKGIsTShjLGQpKSl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIE0oYSxNKGIsYykpfXZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsbixxKXt2YXIgdD1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxuLHQpfWZ1bmN0aW9uIGIoYSxjLGQsZSxmKXtyZXR1cm4gTShhLE0oYyxNKGQsTShlLHNkKGYpKSkpKX1hLms9NDthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIHE9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUscSxhKX07YS5kPWI7cmV0dXJuIGF9KCksYz1mdW5jdGlvbihjLGYsXG5oLGssbCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gRShjKTtjYXNlIDI6cmV0dXJuIE0oYyxmKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixoKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZixoLGspO2RlZmF1bHQ6cmV0dXJuIGQuZChjLGYsaCxrLEooYXJndW1lbnRzLDQpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5rPTQ7Yy5mPWQuZjtjLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIEUoYSl9O2MuYT1mdW5jdGlvbihhLGIpe3JldHVybiBNKGEsYil9O2MuYz1iO2Mubj1hO2MuZD1kLmQ7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gdmQoYSl7cmV0dXJuIEFiKGEpfVxudmFyIHdkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPXpiKGEsYykscihkKSljPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gemIoYSxkKTtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmE9XG5mdW5jdGlvbihhLGIpe3JldHVybiB6YihhLGIpfTthLmQ9Yi5kO3JldHVybiBhfSgpLHhkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCxrKXt2YXIgbD1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGYsaCxsKX1mdW5jdGlvbiBiKGEsYyxkLGspe2Zvcig7OylpZihhPUJiKGEsYyxkKSxyKGspKWM9RihrKSxkPUYoSShrKSksaz1JKEkoaykpO2Vsc2UgcmV0dXJuIGF9YS5rPTM7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1JKGEpO3ZhciBrPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxrLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxhPWZ1bmN0aW9uKGEsZCxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIEJiKGEsZCxlKTtkZWZhdWx0OnJldHVybiBiLmQoYSxcbmQsZSxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0zO2EuZj1iLmY7YS5jPWZ1bmN0aW9uKGEsYixlKXtyZXR1cm4gQmIoYSxiLGUpfTthLmQ9Yi5kO3JldHVybiBhfSgpLHlkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPUNiKGEsYykscihkKSljPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gQ2IoYSxcbmQpO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBDYihhLGIpfTthLmQ9Yi5kO3JldHVybiBhfSgpLHpkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPUZiKGEsYykscihkKSljPUYoZCksZD1JKGQpO2Vsc2UgcmV0dXJuIGF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsXG5lKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBGYihhLGQpO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBGYihhLGIpfTthLmQ9Yi5kO3JldHVybiBhfSgpO1xuZnVuY3Rpb24gQWQoYSxiLGMpe3ZhciBkPUUoYyk7aWYoMD09PWIpcmV0dXJuIGEubz9hLm8oKTphLmNhbGwobnVsbCk7Yz1IYShkKTt2YXIgZT1JYShkKTtpZigxPT09YilyZXR1cm4gYS5iP2EuYihjKTphLmI/YS5iKGMpOmEuY2FsbChudWxsLGMpO3ZhciBkPUhhKGUpLGY9SWEoZSk7aWYoMj09PWIpcmV0dXJuIGEuYT9hLmEoYyxkKTphLmE/YS5hKGMsZCk6YS5jYWxsKG51bGwsYyxkKTt2YXIgZT1IYShmKSxoPUlhKGYpO2lmKDM9PT1iKXJldHVybiBhLmM/YS5jKGMsZCxlKTphLmM/YS5jKGMsZCxlKTphLmNhbGwobnVsbCxjLGQsZSk7dmFyIGY9SGEoaCksaz1JYShoKTtpZig0PT09YilyZXR1cm4gYS5uP2EubihjLGQsZSxmKTphLm4/YS5uKGMsZCxlLGYpOmEuY2FsbChudWxsLGMsZCxlLGYpO3ZhciBoPUhhKGspLGw9SWEoayk7aWYoNT09PWIpcmV0dXJuIGEucz9hLnMoYyxkLGUsZixoKTphLnM/YS5zKGMsZCxlLGYsaCk6YS5jYWxsKG51bGwsYyxkLGUsZixoKTt2YXIgaz1IYShsKSxcbm49SWEobCk7aWYoNj09PWIpcmV0dXJuIGEuWD9hLlgoYyxkLGUsZixoLGspOmEuWD9hLlgoYyxkLGUsZixoLGspOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrKTt2YXIgbD1IYShuKSxxPUlhKG4pO2lmKDc9PT1iKXJldHVybiBhLmdhP2EuZ2EoYyxkLGUsZixoLGssbCk6YS5nYT9hLmdhKGMsZCxlLGYsaCxrLGwpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwpO3ZhciBuPUhhKHEpLHQ9SWEocSk7aWYoOD09PWIpcmV0dXJuIGEuR2E/YS5HYShjLGQsZSxmLGgsayxsLG4pOmEuR2E/YS5HYShjLGQsZSxmLGgsayxsLG4pOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbik7dmFyIHE9SGEodCksdj1JYSh0KTtpZig5PT09YilyZXR1cm4gYS5IYT9hLkhhKGMsZCxlLGYsaCxrLGwsbixxKTphLkhhP2EuSGEoYyxkLGUsZixoLGssbCxuLHEpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxKTt2YXIgdD1IYSh2KSx3PUlhKHYpO2lmKDEwPT09YilyZXR1cm4gYS52YT9hLnZhKGMsZCxlLFxuZixoLGssbCxuLHEsdCk6YS52YT9hLnZhKGMsZCxlLGYsaCxrLGwsbixxLHQpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQpO3ZhciB2PUhhKHcpLHk9SWEodyk7aWYoMTE9PT1iKXJldHVybiBhLndhP2Eud2EoYyxkLGUsZixoLGssbCxuLHEsdCx2KTphLndhP2Eud2EoYyxkLGUsZixoLGssbCxuLHEsdCx2KTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYpO3ZhciB3PUhhKHkpLEI9SWEoeSk7aWYoMTI9PT1iKXJldHVybiBhLnhhP2EueGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpOmEueGE/YS54YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpO3ZhciB5PUhhKEIpLEw9SWEoQik7aWYoMTM9PT1iKXJldHVybiBhLnlhP2EueWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk6YS55YT9hLnlhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLFxudCx2LHcseSk7dmFyIEI9SGEoTCksVT1JYShMKTtpZigxND09PWIpcmV0dXJuIGEuemE/YS56YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpOmEuemE/YS56YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik7dmFyIEw9SGEoVSksWj1JYShVKTtpZigxNT09PWIpcmV0dXJuIGEuQWE/YS5BYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk6YS5BYT9hLkFhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk7dmFyIFU9SGEoWiksbmE9SWEoWik7aWYoMTY9PT1iKXJldHVybiBhLkJhP2EuQmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk6YS5CYT9hLkJhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpO3ZhciBaPVxuSGEobmEpLEdhPUlhKG5hKTtpZigxNz09PWIpcmV0dXJuIGEuQ2E/YS5DYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOmEuQ2E/YS5DYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik7dmFyIG5hPUhhKEdhKSxSYT1JYShHYSk7aWYoMTg9PT1iKXJldHVybiBhLkRhP2EuRGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTphLkRhP2EuRGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpO0dhPUhhKFJhKTtSYT1JYShSYSk7aWYoMTk9PT1iKXJldHVybiBhLkVhP2EuRWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTphLkVhP2EuRWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTphLmNhbGwobnVsbCxcbmMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk7dmFyIHdjPUhhKFJhKTtJYShSYSk7aWYoMjA9PT1iKXJldHVybiBhLkZhP2EuRmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLHdjKTphLkZhP2EuRmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLHdjKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2Esd2MpO3Rocm93IEVycm9yKFwiT25seSB1cCB0byAyMCBhcmd1bWVudHMgc3VwcG9ydGVkIG9uIGZ1bmN0aW9uc1wiKTt9XG52YXIgUz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCxlKXtiPXVkLm4oYixjLGQsZSk7Yz1hLms7cmV0dXJuIGEuZj8oZD1xZChiLGMrMSksZDw9Yz9BZChhLGQsYik6YS5mKGIpKTphLmFwcGx5KGEsUmMoYikpfWZ1bmN0aW9uIGIoYSxiLGMsZCl7Yj11ZC5jKGIsYyxkKTtjPWEuaztyZXR1cm4gYS5mPyhkPXFkKGIsYysxKSxkPD1jP0FkKGEsZCxiKTphLmYoYikpOmEuYXBwbHkoYSxSYyhiKSl9ZnVuY3Rpb24gYyhhLGIsYyl7Yj11ZC5hKGIsYyk7Yz1hLms7aWYoYS5mKXt2YXIgZD1xZChiLGMrMSk7cmV0dXJuIGQ8PWM/QWQoYSxkLGIpOmEuZihiKX1yZXR1cm4gYS5hcHBseShhLFJjKGIpKX1mdW5jdGlvbiBkKGEsYil7dmFyIGM9YS5rO2lmKGEuZil7dmFyIGQ9cWQoYixjKzEpO3JldHVybiBkPD1jP0FkKGEsZCxiKTphLmYoYil9cmV0dXJuIGEuYXBwbHkoYSxSYyhiKSl9dmFyIGU9bnVsbCxmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmLGgsdyl7dmFyIHk9bnVsbDtcbjU8YXJndW1lbnRzLmxlbmd0aCYmKHk9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLGgseSl9ZnVuY3Rpb24gYihhLGMsZCxlLGYsaCl7Yz1NKGMsTShkLE0oZSxNKGYsc2QoaCkpKSkpO2Q9YS5rO3JldHVybiBhLmY/KGU9cWQoYyxkKzEpLGU8PWQ/QWQoYSxlLGMpOmEuZihjKSk6YS5hcHBseShhLFJjKGMpKX1hLms9NTthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIGY9RihhKTthPUkoYSk7dmFyIGg9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixoLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxlPWZ1bmN0aW9uKGUsayxsLG4scSx0KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBkLmNhbGwodGhpcyxlLGspO2Nhc2UgMzpyZXR1cm4gYy5jYWxsKHRoaXMsZSxrLGwpO2Nhc2UgNDpyZXR1cm4gYi5jYWxsKHRoaXMsXG5lLGssbCxuKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGUsayxsLG4scSk7ZGVmYXVsdDpyZXR1cm4gZi5kKGUsayxsLG4scSxKKGFyZ3VtZW50cyw1KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Uuaz01O2UuZj1mLmY7ZS5hPWQ7ZS5jPWM7ZS5uPWI7ZS5zPWE7ZS5kPWYuZDtyZXR1cm4gZX0oKSxCZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4hV2IuYShhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxsKX1mdW5jdGlvbiBiKGEsYyxkKXtyZXR1cm4gc2EoUy5uKFdiLGEsYyxkKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsXG5kLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiExO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oKXtyZXR1cm4hMX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBDZChhKXtyZXR1cm4gRShhKT9hOm51bGx9ZnVuY3Rpb24gRGQoYSxiKXtmb3IoOzspe2lmKG51bGw9PUUoYikpcmV0dXJuITA7aWYocihhLmI/YS5iKEYoYikpOmEuY2FsbChudWxsLEYoYikpKSl7dmFyIGM9YSxkPUkoYik7YT1jO2I9ZH1lbHNlIHJldHVybiB1PyExOm51bGx9fVxuZnVuY3Rpb24gRWQoYSxiKXtmb3IoOzspaWYoRShiKSl7dmFyIGM9YS5iP2EuYihGKGIpKTphLmNhbGwobnVsbCxGKGIpKTtpZihyKGMpKXJldHVybiBjO3ZhciBjPWEsZD1JKGIpO2E9YztiPWR9ZWxzZSByZXR1cm4gbnVsbH1mdW5jdGlvbiBGZChhKXtyZXR1cm4gYX1cbmZ1bmN0aW9uIEdkKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGEsZCxsKX1mdW5jdGlvbiBjKGIsZCxlKXtyZXR1cm4gc2EoUy5uKGEsYixkLGUpKX1iLms9MjtiLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTtiLmQ9YztyZXR1cm4gYn0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBzYShhLm8/YS5vKCk6YS5jYWxsKG51bGwpKTtjYXNlIDE6dmFyIGg9YjtyZXR1cm4gc2EoYS5iP2EuYihoKTphLmNhbGwobnVsbCxoKSk7Y2FzZSAyOnZhciBoPWIsaz1lO3JldHVybiBzYShhLmE/YS5hKGgsayk6YS5jYWxsKG51bGwsXG5oLGspKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtyZXR1cm4gYn0oKX1cbnZhciBIZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBmdW5jdGlvbigpe3ZhciBkPW51bGwsbD1mdW5jdGlvbigpe2Z1bmN0aW9uIGQoYSxiLGMsZSl7dmFyIGY9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gay5jYWxsKHRoaXMsYSxiLGMsZil9ZnVuY3Rpb24gayhkLGwsbixxKXtyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKFMucyhjLGQsbCxuLHEpKTpiLmNhbGwobnVsbCxTLnMoYyxkLGwsbixxKSkpOmEuY2FsbChudWxsLGIuYj9iLmIoUy5zKGMsZCxsLG4scSkpOmIuY2FsbChudWxsLFMucyhjLGQsbCxuLHEpKSl9ZC5rPTM7ZC5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBrKGIsYyxkLGEpfTtkLmQ9aztyZXR1cm4gZH0oKSxkPWZ1bmN0aW9uKGQsayx0LHYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGEuYj9cbmEuYihiLmI/Yi5iKGMubz9jLm8oKTpjLmNhbGwobnVsbCkpOmIuY2FsbChudWxsLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMubz9jLm8oKTpjLmNhbGwobnVsbCkpOmIuY2FsbChudWxsLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpKTtjYXNlIDE6dmFyIHc9ZDtyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpOmIuY2FsbChudWxsLGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpOmIuY2FsbChudWxsLGMuYj9jLmIodyk6Yy5jYWxsKG51bGwsdykpKTtjYXNlIDI6dmFyIHc9ZCx5PWs7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYihjLmE/Yy5hKHcseSk6Yy5jYWxsKG51bGwsdyx5KSk6Yi5jYWxsKG51bGwsYy5hP2MuYSh3LHkpOmMuY2FsbChudWxsLHcseSkpKTphLmNhbGwobnVsbCxiLmI/Yi5iKGMuYT9jLmEodyx5KTpjLmNhbGwobnVsbCxcbncseSkpOmIuY2FsbChudWxsLGMuYT9jLmEodyx5KTpjLmNhbGwobnVsbCx3LHkpKSk7Y2FzZSAzOnZhciB3PWQseT1rLEI9dDtyZXR1cm4gYS5iP2EuYihiLmI/Yi5iKGMuYz9jLmModyx5LEIpOmMuY2FsbChudWxsLHcseSxCKSk6Yi5jYWxsKG51bGwsYy5jP2MuYyh3LHksQik6Yy5jYWxsKG51bGwsdyx5LEIpKSk6YS5jYWxsKG51bGwsYi5iP2IuYihjLmM/Yy5jKHcseSxCKTpjLmNhbGwobnVsbCx3LHksQikpOmIuY2FsbChudWxsLGMuYz9jLmModyx5LEIpOmMuY2FsbChudWxsLHcseSxCKSkpO2RlZmF1bHQ6cmV0dXJuIGwuZChkLGssdCxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz0zO2QuZj1sLmY7cmV0dXJuIGR9KCl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGMoYSxiLGUsZil7dmFyIGg9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJlxuKGg9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBkLmNhbGwodGhpcyxhLGIsZSxoKX1mdW5jdGlvbiBkKGMsaCxrLGwpe3JldHVybiBhLmI/YS5iKFMucyhiLGMsaCxrLGwpKTphLmNhbGwobnVsbCxTLnMoYixjLGgsayxsKSl9Yy5rPTM7Yy5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1HKGEpO3JldHVybiBkKGIsYyxlLGEpfTtjLmQ9ZDtyZXR1cm4gY30oKSxjPWZ1bmN0aW9uKGMsaCxxLHQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGEuYj9hLmIoYi5vP2IubygpOmIuY2FsbChudWxsKSk6YS5jYWxsKG51bGwsYi5vP2IubygpOmIuY2FsbChudWxsKSk7Y2FzZSAxOnZhciB2PWM7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYih2KTpiLmNhbGwobnVsbCx2KSk6YS5jYWxsKG51bGwsYi5iP2IuYih2KTpiLmNhbGwobnVsbCx2KSk7Y2FzZSAyOnZhciB2PVxuYyx3PWg7cmV0dXJuIGEuYj9hLmIoYi5hP2IuYSh2LHcpOmIuY2FsbChudWxsLHYsdykpOmEuY2FsbChudWxsLGIuYT9iLmEodix3KTpiLmNhbGwobnVsbCx2LHcpKTtjYXNlIDM6dmFyIHY9Yyx3PWgseT1xO3JldHVybiBhLmI/YS5iKGIuYz9iLmModix3LHkpOmIuY2FsbChudWxsLHYsdyx5KSk6YS5jYWxsKG51bGwsYi5jP2IuYyh2LHcseSk6Yi5jYWxsKG51bGwsdix3LHkpKTtkZWZhdWx0OnJldHVybiBkLmQoYyxoLHEsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLms9MztjLmY9ZC5mO3JldHVybiBjfSgpfXZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsbil7dmFyIHE9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihxPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUscSl9ZnVuY3Rpb24gYihhLGMsZCxcbmUpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGMoYil7Yj1TLmEoRihhKSxiKTtmb3IodmFyIGQ9SShhKTs7KWlmKGQpYj1GKGQpLmNhbGwobnVsbCxiKSxkPUkoZCk7ZWxzZSByZXR1cm4gYn1iLms9MDtiLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBjKGEpfTtiLmQ9YztyZXR1cm4gYn0oKX0oZWQodWQubihhLGMsZCxlKSkpfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxhKX07YS5kPWI7cmV0dXJuIGF9KCksYz1mdW5jdGlvbihjLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBGZDtcbmNhc2UgMTpyZXR1cm4gYztjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZik7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGYsaCk7ZGVmYXVsdDpyZXR1cm4gZC5kKGMsZixoLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5rPTM7Yy5mPWQuZjtjLm89ZnVuY3Rpb24oKXtyZXR1cm4gRmR9O2MuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yy5hPWI7Yy5jPWE7Yy5kPWQuZDtyZXR1cm4gY30oKSxJZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShhKXt2YXIgYj1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGI9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBxLmNhbGwodGhpcyxiKX1mdW5jdGlvbiBxKGUpe3JldHVybiBTLnMoYSxiLGMsZCxlKX1lLms9MDtlLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO1xucmV0dXJuIHEoYSl9O2UuZD1xO3JldHVybiBlfSgpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGQoYSl7dmFyIGI9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihiPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gZS5jYWxsKHRoaXMsYil9ZnVuY3Rpb24gZShkKXtyZXR1cm4gUy5uKGEsYixjLGQpfWQuaz0wO2QuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGUoYSl9O2QuZD1lO3JldHVybiBkfSgpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBjKGEpe3ZhciBiPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGQuY2FsbCh0aGlzLGIpfWZ1bmN0aW9uIGQoYyl7cmV0dXJuIFMuYyhhLGIsYyl9Yy5rPTA7Yy5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gZChhKX07XG5jLmQ9ZDtyZXR1cm4gY30oKX12YXIgZD1udWxsLGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLGYsdCl7dmFyIHY9bnVsbDs0PGFyZ3VtZW50cy5sZW5ndGgmJih2PUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsZix2KX1mdW5jdGlvbiBiKGEsYyxkLGUsZil7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhKXt2YXIgYz1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGM9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBoLmNhbGwodGhpcyxjKX1mdW5jdGlvbiBoKGIpe3JldHVybiBTLnMoYSxjLGQsZSx0ZC5hKGYsYikpfWIuaz0wO2IuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGgoYSl9O2IuZD1oO3JldHVybiBifSgpfWEuaz00O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO1xuYT1JKGEpO3ZhciBmPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsYSl9O2EuZD1iO3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oZCxoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBkO2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxoKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsaCxrKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsaCxrLGwpO2RlZmF1bHQ6cmV0dXJuIGUuZChkLGgsayxsLEooYXJndW1lbnRzLDQpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPTQ7ZC5mPWUuZjtkLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2QuYT1jO2QuYz1iO2Qubj1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksSmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbigpe3ZhciBsPW51bGwsbj1mdW5jdGlvbigpe2Z1bmN0aW9uIGwoYSxiLGMsZCl7dmFyIGU9bnVsbDtcbjM8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBuLmNhbGwodGhpcyxhLGIsYyxlKX1mdW5jdGlvbiBuKGwscSx0LEIpe3JldHVybiBTLnMoYSxudWxsPT1sP2I6bCxudWxsPT1xP2M6cSxudWxsPT10P2Q6dCxCKX1sLms9MztsLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIG4oYixjLGQsYSl9O2wuZD1uO3JldHVybiBsfSgpLGw9ZnVuY3Rpb24obCx0LHYsdyl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjp2YXIgeT1sLEI9dDtyZXR1cm4gYS5hP2EuYShudWxsPT15P2I6eSxudWxsPT1CP2M6Qik6YS5jYWxsKG51bGwsbnVsbD09eT9iOnksbnVsbD09Qj9jOkIpO2Nhc2UgMzp2YXIgeT1sLEI9dCxMPXY7cmV0dXJuIGEuYz9hLmMobnVsbD09eT9iOnksbnVsbD09Qj9jOkIsbnVsbD09TD9kOkwpOmEuY2FsbChudWxsLFxubnVsbD09eT9iOnksbnVsbD09Qj9jOkIsbnVsbD09TD9kOkwpO2RlZmF1bHQ6cmV0dXJuIG4uZChsLHQsdixKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2wuaz0zO2wuZj1uLmY7cmV0dXJuIGx9KCl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGQ9bnVsbCxsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZChhLGIsYyxlKXt2YXIgZj1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKGY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBrLmNhbGwodGhpcyxhLGIsYyxmKX1mdW5jdGlvbiBrKGQsbCxuLHEpe3JldHVybiBTLnMoYSxudWxsPT1kP2I6ZCxudWxsPT1sP2M6bCxuLHEpfWQuaz0zO2QuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gayhiLGMsZCxhKX07ZC5kPVxuaztyZXR1cm4gZH0oKSxkPWZ1bmN0aW9uKGQsayx0LHYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6dmFyIHc9ZCx5PWs7cmV0dXJuIGEuYT9hLmEobnVsbD09dz9iOncsbnVsbD09eT9jOnkpOmEuY2FsbChudWxsLG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5KTtjYXNlIDM6dmFyIHc9ZCx5PWssQj10O3JldHVybiBhLmM/YS5jKG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5LEIpOmEuY2FsbChudWxsLG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5LEIpO2RlZmF1bHQ6cmV0dXJuIGwuZChkLGssdCxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz0zO2QuZj1sLmY7cmV0dXJuIGR9KCl9ZnVuY3Rpb24gYyhhLGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGwsZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGMoYSxiLGUsZil7dmFyIGg9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihoPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLFxuMyksMCkpO3JldHVybiBkLmNhbGwodGhpcyxhLGIsZSxoKX1mdW5jdGlvbiBkKGMsaCxrLGwpe3JldHVybiBTLnMoYSxudWxsPT1jP2I6YyxoLGssbCl9Yy5rPTM7Yy5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1HKGEpO3JldHVybiBkKGIsYyxlLGEpfTtjLmQ9ZDtyZXR1cm4gY30oKSxjPWZ1bmN0aW9uKGMsaCxxLHQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6dmFyIHY9YztyZXR1cm4gYS5iP2EuYihudWxsPT12P2I6dik6YS5jYWxsKG51bGwsbnVsbD09dj9iOnYpO2Nhc2UgMjp2YXIgdj1jLHc9aDtyZXR1cm4gYS5hP2EuYShudWxsPT12P2I6dix3KTphLmNhbGwobnVsbCxudWxsPT12P2I6dix3KTtjYXNlIDM6dmFyIHY9Yyx3PWgseT1xO3JldHVybiBhLmM/YS5jKG51bGw9PXY/Yjp2LHcseSk6YS5jYWxsKG51bGwsbnVsbD09dj9iOnYsdyx5KTtkZWZhdWx0OnJldHVybiBkLmQoYyxoLHEsSihhcmd1bWVudHMsXG4zKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Muaz0zO2MuZj1kLmY7cmV0dXJuIGN9KCl9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCksS2Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGUpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIG49RShiKSxxPUUoYyksdD1FKGUpO3JldHVybiBuJiZxJiZ0P00oYS5jP2EuYyhGKG4pLEYocSksRih0KSk6YS5jYWxsKG51bGwsRihuKSxGKHEpLEYodCkpLGQubihhLEcobiksRyhxKSxHKHQpKSk6bnVsbH0sXG5udWxsLG51bGwpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGU9RShiKSxuPUUoYyk7cmV0dXJuIGUmJm4/TShhLmE/YS5hKEYoZSksRihuKSk6YS5jYWxsKG51bGwsRihlKSxGKG4pKSxkLmMoYSxHKGUpLEcobikpKTpudWxsfSxudWxsLG51bGwpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBjPUUoYik7aWYoYyl7aWYoSWMoYykpe2Zvcih2YXIgZT1IYihjKSxuPU8oZSkscT1uZXcgbGQoQXJyYXkobiksMCksdD0wOzspaWYodDxuKXt2YXIgdj1hLmI/YS5iKEQuYShlLHQpKTphLmNhbGwobnVsbCxELmEoZSx0KSk7cS5hZGQodik7dCs9MX1lbHNlIGJyZWFrO3JldHVybiBwZChxLmRhKCksZC5hKGEsSWIoYykpKX1yZXR1cm4gTShhLmI/YS5iKEYoYykpOmEuY2FsbChudWxsLEYoYykpLGQuYShhLEcoYykpKX1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX12YXIgZD1udWxsLGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsXG5kLGUsZix0KXt2YXIgdj1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLHYpfWZ1bmN0aW9uIGIoYSxjLGUsZixoKXt2YXIgdj1mdW5jdGlvbiB5KGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGI9ZC5hKEUsYSk7cmV0dXJuIERkKEZkLGIpP00oZC5hKEYsYikseShkLmEoRyxiKSkpOm51bGx9LG51bGwsbnVsbCl9O3JldHVybiBkLmEoZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIFMuYShhLGIpfX0odiksdihwYy5kKGgsZixKKFtlLGNdLDApKSkpfWEuaz00O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9SShhKTt2YXIgZj1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxmLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxkPWZ1bmN0aW9uKGQsaCxrLGwsXG5uKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGgpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxoLGspO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxoLGssbCk7ZGVmYXVsdDpyZXR1cm4gZS5kKGQsaCxrLGwsSihhcmd1bWVudHMsNCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9NDtkLmY9ZS5mO2QuYT1jO2QuYz1iO2Qubj1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksTWQ9ZnVuY3Rpb24gTGQoYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe2lmKDA8Yil7dmFyIGQ9RShjKTtyZXR1cm4gZD9NKEYoZCksTGQoYi0xLEcoZCkpKTpudWxsfXJldHVybiBudWxsfSxudWxsLG51bGwpfTtcbmZ1bmN0aW9uIE5kKGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oYyl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGMoYSxiKX19KGZ1bmN0aW9uKGEsYil7Zm9yKDs7KXt2YXIgZT1FKGIpO2lmKDA8YSYmZSl7dmFyIGY9YS0xLGU9RyhlKTthPWY7Yj1lfWVsc2UgcmV0dXJuIGV9fSksbnVsbCxudWxsKX1cbnZhciBPZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTWQoYSxjLmIoYikpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gTShhLGMuYihhKSl9LG51bGwsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxQZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTWQoYSxjLmIoYikpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gTShhLm8/YS5vKCk6YS5jYWxsKG51bGwpLGMuYihhKSl9LG51bGwsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLFFkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGY9RShhKSxoPUUoYyk7cmV0dXJuIGYmJmg/TShGKGYpLE0oRihoKSxiLmEoRyhmKSxHKGgpKSkpOm51bGx9LG51bGwsbnVsbCl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGM9S2QuYShFLHBjLmQoZSxkLEooW2FdLDApKSk7cmV0dXJuIERkKEZkLGMpP3RkLmEoS2QuYShGLFxuYyksUy5hKGIsS2QuYShHLGMpKSk6bnVsbH0sbnVsbCxudWxsKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gUmQoYSl7cmV0dXJuIGZ1bmN0aW9uIGMoYSxlKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBmPUUoYSk7cmV0dXJuIGY/TShGKGYpLGMoRyhmKSxlKSk6RShlKT9jKEYoZSksRyhlKSk6bnVsbH0sbnVsbCxudWxsKX0obnVsbCxhKX1cbnZhciBTZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gUmQoS2QuYShhLGIpKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsbCl9ZnVuY3Rpb24gYihhLGMsZCl7cmV0dXJuIFJkKFMubihLZCxhLGMsZCkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O1xuYi5rPTI7Yi5mPWMuZjtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpLFVkPWZ1bmN0aW9uIFRkKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZD1FKGMpO2lmKGQpe2lmKEljKGQpKXtmb3IodmFyIGU9SGIoZCksZj1PKGUpLGg9bmV3IGxkKEFycmF5KGYpLDApLGs9MDs7KWlmKGs8Zil7aWYocihiLmI/Yi5iKEQuYShlLGspKTpiLmNhbGwobnVsbCxELmEoZSxrKSkpKXt2YXIgbD1ELmEoZSxrKTtoLmFkZChsKX1rKz0xfWVsc2UgYnJlYWs7cmV0dXJuIHBkKGguZGEoKSxUZChiLEliKGQpKSl9ZT1GKGQpO2Q9RyhkKTtyZXR1cm4gcihiLmI/Yi5iKGUpOmIuY2FsbChudWxsLGUpKT9NKGUsVGQoYixkKSk6VGQoYixkKX1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX07ZnVuY3Rpb24gVmQoYSxiKXtyZXR1cm4gVWQoR2QoYSksYil9XG5mdW5jdGlvbiBXZChhKXt2YXIgYj1YZDtyZXR1cm4gZnVuY3Rpb24gZChhKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBNKGEscihiLmI/Yi5iKGEpOmIuY2FsbChudWxsLGEpKT9TZC5hKGQsRS5iP0UuYihhKTpFLmNhbGwobnVsbCxhKSk6bnVsbCl9LG51bGwsbnVsbCl9KGEpfWZ1bmN0aW9uIFlkKGEsYil7cmV0dXJuIG51bGwhPWE/YSYmKGEucSY0fHxhLkJjKT92ZChDLmMoemIseWIoYSksYikpOkMuYyhEYSxhLGIpOkMuYyhwYyxILGIpfVxudmFyIFpkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxrKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBsPUUoayk7aWYobCl7dmFyIG49TWQoYSxsKTtyZXR1cm4gYT09PU8obik/TShuLGQubihhLGIsYyxOZChiLGwpKSk6RGEoSCxNZChhLHRkLmEobixjKSkpfXJldHVybiBudWxsfSxudWxsLG51bGwpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGs9RShjKTtpZihrKXt2YXIgbD1NZChhLGspO3JldHVybiBhPT09TyhsKT9NKGwsZC5jKGEsYixOZChiLGspKSk6bnVsbH1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX1mdW5jdGlvbiBjKGEsYil7cmV0dXJuIGQuYyhhLGEsYil9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxcbmQsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmE9YztkLmM9YjtkLm49YTtyZXR1cm4gZH0oKSwkZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3ZhciBoPUxjO2ZvcihiPUUoYik7OylpZihiKXt2YXIgaz1hO2lmKGs/ay5pJjI1Nnx8ay5NYnx8KGsuaT8wOnMoS2EsaykpOnMoS2Esaykpe2E9US5jKGEsRihiKSxoKTtpZihoPT09YSlyZXR1cm4gYztiPUkoYil9ZWxzZSByZXR1cm4gY31lbHNlIHJldHVybiBhfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYixudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLGFlPVxuZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsZix0KXt2YXIgdj1QLmMoYiwwLG51bGwpO3JldHVybihiPSRjKGIpKT9SLmMoYSx2LGUuWChRLmEoYSx2KSxiLGMsZCxmLHQpKTpSLmMoYSx2LGMubj9jLm4oUS5hKGEsdiksZCxmLHQpOmMuY2FsbChudWxsLFEuYShhLHYpLGQsZix0KSl9ZnVuY3Rpb24gYihhLGIsYyxkLGYpe3ZhciB0PVAuYyhiLDAsbnVsbCk7cmV0dXJuKGI9JGMoYikpP1IuYyhhLHQsZS5zKFEuYShhLHQpLGIsYyxkLGYpKTpSLmMoYSx0LGMuYz9jLmMoUS5hKGEsdCksZCxmKTpjLmNhbGwobnVsbCxRLmEoYSx0KSxkLGYpKX1mdW5jdGlvbiBjKGEsYixjLGQpe3ZhciBmPVAuYyhiLDAsbnVsbCk7cmV0dXJuKGI9JGMoYikpP1IuYyhhLGYsZS5uKFEuYShhLGYpLGIsYyxkKSk6Ui5jKGEsZixjLmE/Yy5hKFEuYShhLGYpLGQpOmMuY2FsbChudWxsLFEuYShhLGYpLGQpKX1mdW5jdGlvbiBkKGEsYixjKXt2YXIgZD1QLmMoYiwwLG51bGwpO3JldHVybihiPSRjKGIpKT9cblIuYyhhLGQsZS5jKFEuYShhLGQpLGIsYykpOlIuYyhhLGQsYy5iP2MuYihRLmEoYSxkKSk6Yy5jYWxsKG51bGwsUS5hKGEsZCkpKX12YXIgZT1udWxsLGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLGYsaCx3LHkpe3ZhciBCPW51bGw7Njxhcmd1bWVudHMubGVuZ3RoJiYoQj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw2KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLGYsaCx3LEIpfWZ1bmN0aW9uIGIoYSxjLGQsZixoLGsseSl7dmFyIEI9UC5jKGMsMCxudWxsKTtyZXR1cm4oYz0kYyhjKSk/Ui5jKGEsQixTLmQoZSxRLmEoYSxCKSxjLGQsZixKKFtoLGsseV0sMCkpKTpSLmMoYSxCLFMuZChkLFEuYShhLEIpLGYsaCxrLEooW3ldLDApKSl9YS5rPTY7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBmPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1JKGEpO3ZhciB5PVxuRihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixoLHksYSl9O2EuZD1iO3JldHVybiBhfSgpLGU9ZnVuY3Rpb24oZSxrLGwsbixxLHQsdil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gZC5jYWxsKHRoaXMsZSxrLGwpO2Nhc2UgNDpyZXR1cm4gYy5jYWxsKHRoaXMsZSxrLGwsbik7Y2FzZSA1OnJldHVybiBiLmNhbGwodGhpcyxlLGssbCxuLHEpO2Nhc2UgNjpyZXR1cm4gYS5jYWxsKHRoaXMsZSxrLGwsbixxLHQpO2RlZmF1bHQ6cmV0dXJuIGYuZChlLGssbCxuLHEsdCxKKGFyZ3VtZW50cyw2KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Uuaz02O2UuZj1mLmY7ZS5jPWQ7ZS5uPWM7ZS5zPWI7ZS5YPWE7ZS5kPWYuZDtyZXR1cm4gZX0oKTtmdW5jdGlvbiBiZShhLGIpe3RoaXMudD1hO3RoaXMuZT1ifVxuZnVuY3Rpb24gY2UoYSl7cmV0dXJuIG5ldyBiZShhLFtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdKX1mdW5jdGlvbiBkZShhKXtyZXR1cm4gbmV3IGJlKGEudCx2YShhLmUpKX1mdW5jdGlvbiBlZShhKXthPWEuZztyZXR1cm4gMzI+YT8wOmEtMT4+PjU8PDV9ZnVuY3Rpb24gZmUoYSxiLGMpe2Zvcig7Oyl7aWYoMD09PWIpcmV0dXJuIGM7dmFyIGQ9Y2UoYSk7ZC5lWzBdPWM7Yz1kO2ItPTV9fXZhciBoZT1mdW5jdGlvbiBnZShiLGMsZCxlKXt2YXIgZj1kZShkKSxoPWIuZy0xPj4+YyYzMTs1PT09Yz9mLmVbaF09ZTooZD1kLmVbaF0sYj1udWxsIT1kP2dlKGIsYy01LGQsZSk6ZmUobnVsbCxjLTUsZSksZi5lW2hdPWIpO3JldHVybiBmfTtcbmZ1bmN0aW9uIGllKGEsYil7dGhyb3cgRXJyb3IoXCJObyBpdGVtIFwiK0EuYihhKStcIiBpbiB2ZWN0b3Igb2YgbGVuZ3RoIFwiK0EuYihiKSk7fWZ1bmN0aW9uIGplKGEpe3ZhciBiPWEucm9vdDtmb3IoYT1hLnNoaWZ0OzspaWYoMDxhKWEtPTUsYj1iLmVbMF07ZWxzZSByZXR1cm4gYi5lfWZ1bmN0aW9uIGtlKGEsYil7aWYoYj49ZWUoYSkpcmV0dXJuIGEuUjtmb3IodmFyIGM9YS5yb290LGQ9YS5zaGlmdDs7KWlmKDA8ZCl2YXIgZT1kLTUsYz1jLmVbYj4+PmQmMzFdLGQ9ZTtlbHNlIHJldHVybiBjLmV9ZnVuY3Rpb24gbGUoYSxiKXtyZXR1cm4gMDw9YiYmYjxhLmc/a2UoYSxiKTppZShiLGEuZyl9XG52YXIgbmU9ZnVuY3Rpb24gbWUoYixjLGQsZSxmKXt2YXIgaD1kZShkKTtpZigwPT09YyloLmVbZSYzMV09ZjtlbHNle3ZhciBrPWU+Pj5jJjMxO2I9bWUoYixjLTUsZC5lW2tdLGUsZik7aC5lW2tdPWJ9cmV0dXJuIGh9LHBlPWZ1bmN0aW9uIG9lKGIsYyxkKXt2YXIgZT1iLmctMj4+PmMmMzE7aWYoNTxjKXtiPW9lKGIsYy01LGQuZVtlXSk7aWYobnVsbD09YiYmMD09PWUpcmV0dXJuIG51bGw7ZD1kZShkKTtkLmVbZV09YjtyZXR1cm4gZH1yZXR1cm4gMD09PWU/bnVsbDp1PyhkPWRlKGQpLGQuZVtlXT1udWxsLGQpOm51bGx9O2Z1bmN0aW9uIFcoYSxiLGMsZCxlLGYpe3RoaXMuaj1hO3RoaXMuZz1iO3RoaXMuc2hpZnQ9Yzt0aGlzLnJvb3Q9ZDt0aGlzLlI9ZTt0aGlzLm09Zjt0aGlzLmk9MTY3NjY4NTExO3RoaXMucT04MTk2fWc9Vy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07XG5nLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBiP0QuYyh0aGlzLGIsYyk6Y307Zy5aYT1mdW5jdGlvbihhLGIsYyl7YT1bMCxjXTtmb3IoYz0wOzspaWYoYzx0aGlzLmcpe3ZhciBkPWtlKHRoaXMsYyksZT1kLmxlbmd0aDthOntmb3IodmFyIGY9MCxoPWFbMV07OylpZihmPGUpe2g9Yi5jP2IuYyhoLGYrYyxkW2ZdKTpiLmNhbGwobnVsbCxoLGYrYyxkW2ZdKTtpZihmYyhoKSl7ZD1oO2JyZWFrIGF9Zis9MX1lbHNle2FbMF09ZTtkPWFbMV09aDticmVhayBhfWQ9dm9pZCAwfWlmKGZjKGQpKXJldHVybiBLLmI/Sy5iKGQpOksuY2FsbChudWxsLGQpO2MrPWFbMF19ZWxzZSByZXR1cm4gYVsxXX07Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxlKHRoaXMsYilbYiYzMV19O1xuZy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA8PWImJmI8dGhpcy5nP2tlKHRoaXMsYilbYiYzMV06Y307Zy5QYT1mdW5jdGlvbihhLGIsYyl7aWYoMDw9YiYmYjx0aGlzLmcpcmV0dXJuIGVlKHRoaXMpPD1iPyhhPXZhKHRoaXMuUiksYVtiJjMxXT1jLG5ldyBXKHRoaXMuaix0aGlzLmcsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYSxudWxsKSk6bmV3IFcodGhpcy5qLHRoaXMuZyx0aGlzLnNoaWZ0LG5lKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYixjKSx0aGlzLlIsbnVsbCk7aWYoYj09PXRoaXMuZylyZXR1cm4gRGEodGhpcyxjKTtpZih1KXRocm93IEVycm9yKFwiSW5kZXggXCIrQS5iKGIpK1wiIG91dCBvZiBib3VuZHMgIFswLFwiK0EuYih0aGlzLmcpK1wiXVwiKTtyZXR1cm4gbnVsbH07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307Zy4kYT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcywwKX07XG5nLmFiPWZ1bmN0aW9uKCl7cmV0dXJuIEQuYSh0aGlzLDEpfTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP0QuYSh0aGlzLHRoaXMuZy0xKTpudWxsfTtnLkphPWZ1bmN0aW9uKCl7aWYoMD09PXRoaXMuZyl0aHJvdyBFcnJvcihcIkNhbid0IHBvcCBlbXB0eSB2ZWN0b3JcIik7aWYoMT09PXRoaXMuZylyZXR1cm4gZWIocWUsdGhpcy5qKTtpZigxPHRoaXMuZy1lZSh0aGlzKSlyZXR1cm4gbmV3IFcodGhpcy5qLHRoaXMuZy0xLHRoaXMuc2hpZnQsdGhpcy5yb290LHRoaXMuUi5zbGljZSgwLC0xKSxudWxsKTtpZih1KXt2YXIgYT1rZSh0aGlzLHRoaXMuZy0yKSxiPXBlKHRoaXMsdGhpcy5zaGlmdCx0aGlzLnJvb3QpLGI9bnVsbD09Yj9YOmIsYz10aGlzLmctMTtyZXR1cm4gNTx0aGlzLnNoaWZ0JiZudWxsPT1iLmVbMV0/bmV3IFcodGhpcy5qLGMsdGhpcy5zaGlmdC01LGIuZVswXSxhLG51bGwpOm5ldyBXKHRoaXMuaixjLHRoaXMuc2hpZnQsYixhLG51bGwpfXJldHVybiBudWxsfTtcbmcuWGE9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLmc/bmV3IGtjKHRoaXMsdGhpcy5nLTEsbnVsbCk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyByZSh0aGlzLmcsdGhpcy5zaGlmdCxzZS5iP3NlLmIodGhpcy5yb290KTpzZS5jYWxsKG51bGwsdGhpcy5yb290KSx0ZS5iP3RlLmIodGhpcy5SKTp0ZS5jYWxsKG51bGwsdGhpcy5SKSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKHFlLHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe2lmKFwibnVtYmVyXCI9PT10eXBlb2YgYilyZXR1cm4gJGEodGhpcyxiLGMpO3Rocm93IEVycm9yKFwiVmVjdG9yJ3Mga2V5IGZvciBhc3NvYyBtdXN0IGJlIGEgbnVtYmVyLlwiKTt9O2cuSD1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5nP251bGw6MzI+PXRoaXMuZz9uZXcgYWModGhpcy5SLDApOnU/dWUubj91ZS5uKHRoaXMsamUodGhpcyksMCwwKTp1ZS5jYWxsKG51bGwsdGhpcyxqZSh0aGlzKSwwLDApOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVyhiLHRoaXMuZyx0aGlzLnNoaWZ0LHRoaXMucm9vdCx0aGlzLlIsdGhpcy5tKX07XG5nLkc9ZnVuY3Rpb24oYSxiKXtpZigzMj50aGlzLmctZWUodGhpcykpe2Zvcih2YXIgYz10aGlzLlIubGVuZ3RoLGQ9QXJyYXkoYysxKSxlPTA7OylpZihlPGMpZFtlXT10aGlzLlJbZV0sZSs9MTtlbHNlIGJyZWFrO2RbY109YjtyZXR1cm4gbmV3IFcodGhpcy5qLHRoaXMuZysxLHRoaXMuc2hpZnQsdGhpcy5yb290LGQsbnVsbCl9Yz0oZD10aGlzLmc+Pj41PjE8PHRoaXMuc2hpZnQpP3RoaXMuc2hpZnQrNTp0aGlzLnNoaWZ0O2Q/KGQ9Y2UobnVsbCksZC5lWzBdPXRoaXMucm9vdCxlPWZlKG51bGwsdGhpcy5zaGlmdCxuZXcgYmUobnVsbCx0aGlzLlIpKSxkLmVbMV09ZSk6ZD1oZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290LG5ldyBiZShudWxsLHRoaXMuUikpO3JldHVybiBuZXcgVyh0aGlzLmosdGhpcy5nKzEsYyxkLFtiXSxudWxsKX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLkoobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuYWEobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLkoobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYWEobnVsbCxhLGIpfTtcbnZhciBYPW5ldyBiZShudWxsLFtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdKSxxZT1uZXcgVyhudWxsLDAsNSxYLFtdLDApO2Z1bmN0aW9uIHZlKGEsYil7dmFyIGM9YS5sZW5ndGgsZD1iP2E6dmEoYSk7aWYoMzI+YylyZXR1cm4gbmV3IFcobnVsbCxjLDUsWCxkLG51bGwpO2Zvcih2YXIgZT0zMixmPShuZXcgVyhudWxsLDMyLDUsWCxkLnNsaWNlKDAsMzIpLG51bGwpKS5XYShudWxsKTs7KWlmKGU8Yyl2YXIgaD1lKzEsZj13ZC5hKGYsZFtlXSksZT1oO2Vsc2UgcmV0dXJuIEFiKGYpfWZ1bmN0aW9uIHdlKGEpe3JldHVybiBBYihDLmMoemIseWIocWUpLGEpKX1cbnZhciB4ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIGFjJiYwPT09YS5wP3ZlLmE/dmUuYShhLmUsITApOnZlLmNhbGwobnVsbCxhLmUsITApOndlKGEpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIHllKGEsYixjLGQsZSxmKXt0aGlzLlA9YTt0aGlzLmVhPWI7dGhpcy5wPWM7dGhpcy5PPWQ7dGhpcy5qPWU7dGhpcy5tPWY7dGhpcy5pPTMyMjQzOTQ4O3RoaXMucT0xNTM2fWc9eWUucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O1xuZy5VPWZ1bmN0aW9uKCl7aWYodGhpcy5PKzE8dGhpcy5lYS5sZW5ndGgpe3ZhciBhPXVlLm4/dWUubih0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PKzEpOnVlLmNhbGwobnVsbCx0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PKzEpO3JldHVybiBudWxsPT1hP251bGw6YX1yZXR1cm4gSmIodGhpcyl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4ocWUsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEoemUuYz96ZS5jKHRoaXMuUCx0aGlzLnArdGhpcy5PLE8odGhpcy5QKSk6emUuY2FsbChudWxsLHRoaXMuUCx0aGlzLnArdGhpcy5PLE8odGhpcy5QKSksYil9O1xuZy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZ2MuYyh6ZS5jP3plLmModGhpcy5QLHRoaXMucCt0aGlzLk8sTyh0aGlzLlApKTp6ZS5jYWxsKG51bGwsdGhpcy5QLHRoaXMucCt0aGlzLk8sTyh0aGlzLlApKSxiLGMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYVt0aGlzLk9dfTtnLlM9ZnVuY3Rpb24oKXtpZih0aGlzLk8rMTx0aGlzLmVhLmxlbmd0aCl7dmFyIGE9dWUubj91ZS5uKHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8rMSk6dWUuY2FsbChudWxsLHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8rMSk7cmV0dXJuIG51bGw9PWE/SDphfXJldHVybiBJYih0aGlzKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuc2I9ZnVuY3Rpb24oKXtyZXR1cm4gbmQuYSh0aGlzLmVhLHRoaXMuTyl9O1xuZy50Yj1mdW5jdGlvbigpe3ZhciBhPXRoaXMucCt0aGlzLmVhLmxlbmd0aDtyZXR1cm4gYTxBYSh0aGlzLlApP3VlLm4/dWUubih0aGlzLlAsa2UodGhpcy5QLGEpLGEsMCk6dWUuY2FsbChudWxsLHRoaXMuUCxrZSh0aGlzLlAsYSksYSwwKTpIfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdWUucz91ZS5zKHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8sYik6dWUuY2FsbChudWxsLHRoaXMuUCx0aGlzLmVhLHRoaXMucCx0aGlzLk8sYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2cucmI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnArdGhpcy5lYS5sZW5ndGg7cmV0dXJuIGE8QWEodGhpcy5QKT91ZS5uP3VlLm4odGhpcy5QLGtlKHRoaXMuUCxhKSxhLDApOnVlLmNhbGwobnVsbCx0aGlzLlAsa2UodGhpcy5QLGEpLGEsMCk6bnVsbH07XG52YXIgdWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsbCl7cmV0dXJuIG5ldyB5ZShhLGIsYyxkLGwsbnVsbCl9ZnVuY3Rpb24gYihhLGIsYyxkKXtyZXR1cm4gbmV3IHllKGEsYixjLGQsbnVsbCxudWxsKX1mdW5jdGlvbiBjKGEsYixjKXtyZXR1cm4gbmV3IHllKGEsbGUoYSxiKSxiLGMsbnVsbCxudWxsKX12YXIgZD1udWxsLGQ9ZnVuY3Rpb24oZCxmLGgsayxsKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBjLmNhbGwodGhpcyxkLGYsaCk7Y2FzZSA0OnJldHVybiBiLmNhbGwodGhpcyxkLGYsaCxrKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGQsZixoLGssbCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYz1jO2Qubj1iO2Qucz1hO3JldHVybiBkfSgpO1xuZnVuY3Rpb24gQWUoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmNhPWI7dGhpcy5zdGFydD1jO3RoaXMuZW5kPWQ7dGhpcy5tPWU7dGhpcy5pPTE2NjYxNzg4Nzt0aGlzLnE9ODE5Mn1nPUFlLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBiP0QuYyh0aGlzLGIsYyk6Y307Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA+Ynx8dGhpcy5lbmQ8PXRoaXMuc3RhcnQrYj9pZShiLHRoaXMuZW5kLXRoaXMuc3RhcnQpOkQuYSh0aGlzLmNhLHRoaXMuc3RhcnQrYil9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPmJ8fHRoaXMuZW5kPD10aGlzLnN0YXJ0K2I/YzpELmModGhpcy5jYSx0aGlzLnN0YXJ0K2IsYyl9O1xuZy5QYT1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcyxlPWQuc3RhcnQrYjtyZXR1cm4gQmUucz9CZS5zKGQuaixSLmMoZC5jYSxlLGMpLGQuc3RhcnQsZnVuY3Rpb24oKXt2YXIgYT1kLmVuZCxiPWUrMTtyZXR1cm4gYT5iP2E6Yn0oKSxudWxsKTpCZS5jYWxsKG51bGwsZC5qLFIuYyhkLmNhLGUsYyksZC5zdGFydCxmdW5jdGlvbigpe3ZhciBhPWQuZW5kLGI9ZSsxO3JldHVybiBhPmI/YTpifSgpLG51bGwpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQtdGhpcy5zdGFydH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcy5jYSx0aGlzLmVuZC0xKX07XG5nLkphPWZ1bmN0aW9uKCl7aWYodGhpcy5zdGFydD09PXRoaXMuZW5kKXRocm93IEVycm9yKFwiQ2FuJ3QgcG9wIGVtcHR5IHZlY3RvclwiKTtyZXR1cm4gQmUucz9CZS5zKHRoaXMuaix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQtMSxudWxsKTpCZS5jYWxsKG51bGwsdGhpcy5qLHRoaXMuY2EsdGhpcy5zdGFydCx0aGlzLmVuZC0xLG51bGwpfTtnLlhhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhcnQhPT10aGlzLmVuZD9uZXcga2ModGhpcyx0aGlzLmVuZC10aGlzLnN0YXJ0LTEsbnVsbCk6bnVsbH07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihxZSx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtnLnVhPWZ1bmN0aW9uKGEsYixjKXtpZihcIm51bWJlclwiPT09dHlwZW9mIGIpcmV0dXJuICRhKHRoaXMsYixjKTt0aHJvdyBFcnJvcihcIlN1YnZlYydzIGtleSBmb3IgYXNzb2MgbXVzdCBiZSBhIG51bWJlci5cIik7fTtnLkg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24gZChlKXtyZXR1cm4gZT09PWEuZW5kP251bGw6TShELmEoYS5jYSxlKSxuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGQoZSsxKX19KGIpLG51bGwsbnVsbCkpfX0odGhpcykoYS5zdGFydCl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBCZS5zP0JlLnMoYix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQsdGhpcy5tKTpCZS5jYWxsKG51bGwsYix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQsdGhpcy5tKX07XG5nLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQmUucz9CZS5zKHRoaXMuaiwkYSh0aGlzLmNhLHRoaXMuZW5kLGIpLHRoaXMuc3RhcnQsdGhpcy5lbmQrMSxudWxsKTpCZS5jYWxsKG51bGwsdGhpcy5qLCRhKHRoaXMuY2EsdGhpcy5lbmQsYiksdGhpcy5zdGFydCx0aGlzLmVuZCsxLG51bGwpfTtnLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLkoobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuYWEobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLkoobnVsbCxhKX07XG5nLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5hYShudWxsLGEsYil9O2Z1bmN0aW9uIEJlKGEsYixjLGQsZSl7Zm9yKDs7KWlmKGIgaW5zdGFuY2VvZiBBZSljPWIuc3RhcnQrYyxkPWIuc3RhcnQrZCxiPWIuY2E7ZWxzZXt2YXIgZj1PKGIpO2lmKDA+Y3x8MD5kfHxjPmZ8fGQ+Zil0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7cmV0dXJuIG5ldyBBZShhLGIsYyxkLGUpfX1cbnZhciB6ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBCZShudWxsLGEsYixjLG51bGwpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYixPKGEpKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIENlKGEsYil7cmV0dXJuIGE9PT1iLnQ/YjpuZXcgYmUoYSx2YShiLmUpKX1mdW5jdGlvbiBzZShhKXtyZXR1cm4gbmV3IGJlKHt9LHZhKGEuZSkpfVxuZnVuY3Rpb24gdGUoYSl7dmFyIGI9W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF07S2MoYSwwLGIsMCxhLmxlbmd0aCk7cmV0dXJuIGJ9XG52YXIgRWU9ZnVuY3Rpb24gRGUoYixjLGQsZSl7ZD1DZShiLnJvb3QudCxkKTt2YXIgZj1iLmctMT4+PmMmMzE7aWYoNT09PWMpYj1lO2Vsc2V7dmFyIGg9ZC5lW2ZdO2I9bnVsbCE9aD9EZShiLGMtNSxoLGUpOmZlKGIucm9vdC50LGMtNSxlKX1kLmVbZl09YjtyZXR1cm4gZH0sR2U9ZnVuY3Rpb24gRmUoYixjLGQpe2Q9Q2UoYi5yb290LnQsZCk7dmFyIGU9Yi5nLTI+Pj5jJjMxO2lmKDU8Yyl7Yj1GZShiLGMtNSxkLmVbZV0pO2lmKG51bGw9PWImJjA9PT1lKXJldHVybiBudWxsO2QuZVtlXT1iO3JldHVybiBkfXJldHVybiAwPT09ZT9udWxsOnU/KGQuZVtlXT1udWxsLGQpOm51bGx9O2Z1bmN0aW9uIHJlKGEsYixjLGQpe3RoaXMuZz1hO3RoaXMuc2hpZnQ9Yjt0aGlzLnJvb3Q9Yzt0aGlzLlI9ZDt0aGlzLmk9Mjc1O3RoaXMucT04OH1nPXJlLnByb3RvdHlwZTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBiP0QuYyh0aGlzLGIsYyk6Y307XG5nLko9ZnVuY3Rpb24oYSxiKXtpZih0aGlzLnJvb3QudClyZXR1cm4gbGUodGhpcyxiKVtiJjMxXTt0aHJvdyBFcnJvcihcIm50aCBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPD1iJiZiPHRoaXMuZz9ELmEodGhpcyxiKTpjfTtnLkw9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QudClyZXR1cm4gdGhpcy5nO3Rocm93IEVycm9yKFwiY291bnQgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtcbmcuUGI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXM7aWYoZC5yb290LnQpe2lmKDA8PWImJmI8ZC5nKXJldHVybiBlZSh0aGlzKTw9Yj9kLlJbYiYzMV09YzooYT1mdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbiBmKGEsayl7dmFyIGw9Q2UoZC5yb290LnQsayk7aWYoMD09PWEpbC5lW2ImMzFdPWM7ZWxzZXt2YXIgbj1iPj4+YSYzMSxxPWYoYS01LGwuZVtuXSk7bC5lW25dPXF9cmV0dXJuIGx9fSh0aGlzKS5jYWxsKG51bGwsZC5zaGlmdCxkLnJvb3QpLGQucm9vdD1hKSx0aGlzO2lmKGI9PT1kLmcpcmV0dXJuIHpiKHRoaXMsYyk7aWYodSl0aHJvdyBFcnJvcihcIkluZGV4IFwiK0EuYihiKStcIiBvdXQgb2YgYm91bmRzIGZvciBUcmFuc2llbnRWZWN0b3Igb2YgbGVuZ3RoXCIrQS5iKGQuZykpO3JldHVybiBudWxsfXRocm93IEVycm9yKFwiYXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5nLlFiPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290LnQpe2lmKDA9PT10aGlzLmcpdGhyb3cgRXJyb3IoXCJDYW4ndCBwb3AgZW1wdHkgdmVjdG9yXCIpO2lmKDE9PT10aGlzLmcpcmV0dXJuIHRoaXMuZz0wLHRoaXM7aWYoMDwodGhpcy5nLTEmMzEpKXJldHVybiB0aGlzLmctPTEsdGhpcztpZih1KXt2YXIgYTthOmlmKGE9dGhpcy5nLTIsYT49ZWUodGhpcykpYT10aGlzLlI7ZWxzZXtmb3IodmFyIGI9dGhpcy5yb290LGM9YixkPXRoaXMuc2hpZnQ7OylpZigwPGQpYz1DZShiLnQsYy5lW2E+Pj5kJjMxXSksZC09NTtlbHNle2E9Yy5lO2JyZWFrIGF9YT12b2lkIDB9Yj1HZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290KTtiPW51bGwhPWI/YjpuZXcgYmUodGhpcy5yb290LnQsW251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLFxubnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXSk7NTx0aGlzLnNoaWZ0JiZudWxsPT1iLmVbMV0/KHRoaXMucm9vdD1DZSh0aGlzLnJvb3QudCxiLmVbMF0pLHRoaXMuc2hpZnQtPTUpOnRoaXMucm9vdD1iO3RoaXMuZy09MTt0aGlzLlI9YTtyZXR1cm4gdGhpc31yZXR1cm4gbnVsbH10aHJvdyBFcnJvcihcInBvcCEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLmNiPWZ1bmN0aW9uKGEsYixjKXtpZihcIm51bWJlclwiPT09dHlwZW9mIGIpcmV0dXJuIERiKHRoaXMsYixjKTt0aHJvdyBFcnJvcihcIlRyYW5zaWVudFZlY3RvcidzIGtleSBmb3IgYXNzb2MhIG11c3QgYmUgYSBudW1iZXIuXCIpO307XG5nLkthPWZ1bmN0aW9uKGEsYil7aWYodGhpcy5yb290LnQpe2lmKDMyPnRoaXMuZy1lZSh0aGlzKSl0aGlzLlJbdGhpcy5nJjMxXT1iO2Vsc2V7dmFyIGM9bmV3IGJlKHRoaXMucm9vdC50LHRoaXMuUiksZD1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXTtkWzBdPWI7dGhpcy5SPWQ7aWYodGhpcy5nPj4+NT4xPDx0aGlzLnNoaWZ0KXt2YXIgZD1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXSxlPXRoaXMuc2hpZnQrXG41O2RbMF09dGhpcy5yb290O2RbMV09ZmUodGhpcy5yb290LnQsdGhpcy5zaGlmdCxjKTt0aGlzLnJvb3Q9bmV3IGJlKHRoaXMucm9vdC50LGQpO3RoaXMuc2hpZnQ9ZX1lbHNlIHRoaXMucm9vdD1FZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290LGMpfXRoaXMuZys9MTtyZXR1cm4gdGhpc310aHJvdyBFcnJvcihcImNvbmohIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5PYT1mdW5jdGlvbigpe2lmKHRoaXMucm9vdC50KXt0aGlzLnJvb3QudD1udWxsO3ZhciBhPXRoaXMuZy1lZSh0aGlzKSxiPUFycmF5KGEpO0tjKHRoaXMuUiwwLGIsMCxhKTtyZXR1cm4gbmV3IFcobnVsbCx0aGlzLmcsdGhpcy5zaGlmdCx0aGlzLnJvb3QsYixudWxsKX10aHJvdyBFcnJvcihcInBlcnNpc3RlbnQhIGNhbGxlZCB0d2ljZVwiKTt9O2Z1bmN0aW9uIEhlKGEsYixjLGQpe3RoaXMuaj1hO3RoaXMuYmE9Yjt0aGlzLnBhPWM7dGhpcy5tPWQ7dGhpcy5xPTA7dGhpcy5pPTMxODUwNTcyfWc9SGUucHJvdG90eXBlO1xuZy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuUT1mdW5jdGlvbigpe3JldHVybiBGKHRoaXMuYmEpfTtnLlM9ZnVuY3Rpb24oKXt2YXIgYT1JKHRoaXMuYmEpO3JldHVybiBhP25ldyBIZSh0aGlzLmosYSx0aGlzLnBhLG51bGwpOm51bGw9PXRoaXMucGE/QmEodGhpcyk6bmV3IEhlKHRoaXMuaix0aGlzLnBhLG51bGwsbnVsbCl9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEhlKGIsdGhpcy5iYSx0aGlzLnBhLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xuZnVuY3Rpb24gSWUoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmNvdW50PWI7dGhpcy5iYT1jO3RoaXMucGE9ZDt0aGlzLm09ZTt0aGlzLmk9MzE4NTg3NjY7dGhpcy5xPTgxOTJ9Zz1JZS5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY291bnR9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gRih0aGlzLmJhKX07Zy5KYT1mdW5jdGlvbigpe2lmKHIodGhpcy5iYSkpe3ZhciBhPUkodGhpcy5iYSk7cmV0dXJuIGE/bmV3IEllKHRoaXMuaix0aGlzLmNvdW50LTEsYSx0aGlzLnBhLG51bGwpOm5ldyBJZSh0aGlzLmosdGhpcy5jb3VudC0xLEUodGhpcy5wYSkscWUsbnVsbCl9cmV0dXJuIHRoaXN9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtcbmcudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gSmV9O2cuUT1mdW5jdGlvbigpe3JldHVybiBGKHRoaXMuYmEpfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gRyhFKHRoaXMpKX07Zy5IPWZ1bmN0aW9uKCl7dmFyIGE9RSh0aGlzLnBhKSxiPXRoaXMuYmE7cmV0dXJuIHIocihiKT9iOmEpP25ldyBIZShudWxsLHRoaXMuYmEsRShhKSxudWxsKTpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEllKGIsdGhpcy5jb3VudCx0aGlzLmJhLHRoaXMucGEsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7dmFyIGM7cih0aGlzLmJhKT8oYz10aGlzLnBhLGM9bmV3IEllKHRoaXMuaix0aGlzLmNvdW50KzEsdGhpcy5iYSxwYy5hKHIoYyk/YzpxZSxiKSxudWxsKSk6Yz1uZXcgSWUodGhpcy5qLHRoaXMuY291bnQrMSxwYy5hKHRoaXMuYmEsYikscWUsbnVsbCk7cmV0dXJuIGN9O3ZhciBKZT1uZXcgSWUobnVsbCwwLG51bGwscWUsMCk7XG5mdW5jdGlvbiBLZSgpe3RoaXMucT0wO3RoaXMuaT0yMDk3MTUyfUtlLnByb3RvdHlwZS52PWZ1bmN0aW9uKCl7cmV0dXJuITF9O3ZhciBMZT1uZXcgS2U7ZnVuY3Rpb24gTWUoYSxiKXtyZXR1cm4gTmMoR2MoYik/TyhhKT09PU8oYik/RGQoRmQsS2QuYShmdW5jdGlvbihhKXtyZXR1cm4gV2IuYShRLmMoYixGKGEpLExlKSxGKEkoYSkpKX0sYSkpOm51bGw6bnVsbCl9ZnVuY3Rpb24gTmUoYSl7dGhpcy5yPWF9TmUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLnIpe3ZhciBhPUYodGhpcy5yKTt0aGlzLnI9SSh0aGlzLnIpO3JldHVybntkb25lOiExLHZhbHVlOmF9fXJldHVybntkb25lOiEwLHZhbHVlOm51bGx9fTtmdW5jdGlvbiBPZShhKXtyZXR1cm4gbmV3IE5lKEUoYSkpfWZ1bmN0aW9uIFBlKGEpe3RoaXMucj1hfVxuUGUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZihudWxsIT10aGlzLnIpe3ZhciBhPUYodGhpcy5yKSxiPVAuYyhhLDAsbnVsbCksYT1QLmMoYSwxLG51bGwpO3RoaXMucj1JKHRoaXMucik7cmV0dXJue2RvbmU6ITEsdmFsdWU6W2IsYV19fXJldHVybntkb25lOiEwLHZhbHVlOm51bGx9fTtmdW5jdGlvbiBRZShhKXtyZXR1cm4gbmV3IFBlKEUoYSkpfWZ1bmN0aW9uIFJlKGEpe3RoaXMucj1hfVJlLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5yKXt2YXIgYT1GKHRoaXMucik7dGhpcy5yPUkodGhpcy5yKTtyZXR1cm57ZG9uZTohMSx2YWx1ZTpbYSxhXX19cmV0dXJue2RvbmU6ITAsdmFsdWU6bnVsbH19O2Z1bmN0aW9uIFNlKGEpe3JldHVybiBuZXcgUmUoRShhKSl9XG5mdW5jdGlvbiBUZShhLGIpe3ZhciBjPWEuZTtpZihiIGluc3RhbmNlb2YgVClhOntmb3IodmFyIGQ9Yy5sZW5ndGgsZT1iLnNhLGY9MDs7KXtpZihkPD1mKXtjPS0xO2JyZWFrIGF9dmFyIGg9Y1tmXTtpZihoIGluc3RhbmNlb2YgVCYmZT09PWguc2Epe2M9ZjticmVhayBhfWlmKHUpZis9MjtlbHNle2M9bnVsbDticmVhayBhfX1jPXZvaWQgMH1lbHNlIGlmKFwic3RyaW5nXCI9PXR5cGVvZiBifHxcIm51bWJlclwiPT09dHlwZW9mIGIpYTp7ZD1jLmxlbmd0aDtmb3IoZT0wOzspe2lmKGQ8PWUpe2M9LTE7YnJlYWsgYX1pZihiPT09Y1tlXSl7Yz1lO2JyZWFrIGF9aWYodSllKz0yO2Vsc2V7Yz1udWxsO2JyZWFrIGF9fWM9dm9pZCAwfWVsc2UgaWYoYiBpbnN0YW5jZW9mIFpiKWE6e2Q9Yy5sZW5ndGg7ZT1iLk5hO2ZvcihmPTA7Oyl7aWYoZDw9Zil7Yz0tMTticmVhayBhfWg9Y1tmXTtpZihoIGluc3RhbmNlb2YgWmImJmU9PT1oLk5hKXtjPWY7YnJlYWsgYX1pZih1KWYrPTI7ZWxzZXtjPW51bGw7XG5icmVhayBhfX1jPXZvaWQgMH1lbHNlIGlmKG51bGw9PWIpYTp7ZD1jLmxlbmd0aDtmb3IoZT0wOzspe2lmKGQ8PWUpe2M9LTE7YnJlYWsgYX1pZihudWxsPT1jW2VdKXtjPWU7YnJlYWsgYX1pZih1KWUrPTI7ZWxzZXtjPW51bGw7YnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBpZih1KWE6e2Q9Yy5sZW5ndGg7Zm9yKGU9MDs7KXtpZihkPD1lKXtjPS0xO2JyZWFrIGF9aWYoV2IuYShiLGNbZV0pKXtjPWU7YnJlYWsgYX1pZih1KWUrPTI7ZWxzZXtjPW51bGw7YnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBjPW51bGw7cmV0dXJuIGN9ZnVuY3Rpb24gVWUoYSxiLGMpe3RoaXMuZT1hO3RoaXMucD1iO3RoaXMuVz1jO3RoaXMucT0wO3RoaXMuaT0zMjM3NDk5MH1nPVVlLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfTtcbmcuVT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnA8dGhpcy5lLmxlbmd0aC0yP25ldyBVZSh0aGlzLmUsdGhpcy5wKzIsdGhpcy5XKTpudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5lLmxlbmd0aC10aGlzLnApLzJ9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5XKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmVbdGhpcy5wXSx0aGlzLmVbdGhpcy5wKzFdXSxudWxsKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucDx0aGlzLmUubGVuZ3RoLTI/bmV3IFVlKHRoaXMuZSx0aGlzLnArMix0aGlzLlcpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVWUodGhpcy5lLHRoaXMucCxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07ZnVuY3Rpb24gbGEoYSxiLGMsZCl7dGhpcy5qPWE7dGhpcy5nPWI7dGhpcy5lPWM7dGhpcy5tPWQ7dGhpcy5pPTE2NjQ3OTUxO3RoaXMucT04MTk2fWc9bGEucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cua2V5cz1mdW5jdGlvbigpe3JldHVybiBPZShWZS5iP1ZlLmIodGhpcyk6VmUuY2FsbChudWxsLHRoaXMpKX07Zy5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIFFlKEUodGhpcykpfTtnLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiBPZShXZS5iP1dlLmIodGhpcyk6V2UuY2FsbChudWxsLHRoaXMpKX07Zy5oYXM9ZnVuY3Rpb24oYSl7cmV0dXJuIE9jKHRoaXMsYSl9O2cuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07XG5nLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7YT1UZSh0aGlzLGIpO3JldHVybi0xPT09YT9jOnRoaXMuZVthKzFdfTtcbmcuWmE9ZnVuY3Rpb24oYSxiLGMpe2E9dGhpcy5lLmxlbmd0aDtmb3IodmFyIGQ9MDs7KWlmKGQ8YSl7Yz1iLmM/Yi5jKGMsdGhpcy5lW2RdLHRoaXMuZVtkKzFdKTpiLmNhbGwobnVsbCxjLHRoaXMuZVtkXSx0aGlzLmVbZCsxXSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7ZCs9Mn1lbHNlIHJldHVybiBjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1kYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIE1lKHRoaXMsYil9O2cuV2E9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhlKHt9LHRoaXMuZS5sZW5ndGgsdmEodGhpcy5lKSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBlYihZZSx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLm5iPWZ1bmN0aW9uKGEsYil7aWYoMDw9VGUodGhpcyxiKSl7dmFyIGM9dGhpcy5lLmxlbmd0aCxkPWMtMjtpZigwPT09ZClyZXR1cm4gQmEodGhpcyk7Zm9yKHZhciBkPUFycmF5KGQpLGU9MCxmPTA7Oyl7aWYoZT49YylyZXR1cm4gbmV3IGxhKHRoaXMuaix0aGlzLmctMSxkLG51bGwpO2lmKFdiLmEoYix0aGlzLmVbZV0pKWUrPTI7ZWxzZSBpZih1KWRbZl09dGhpcy5lW2VdLGRbZisxXT10aGlzLmVbZSsxXSxmKz0yLGUrPTI7ZWxzZSByZXR1cm4gbnVsbH19ZWxzZSByZXR1cm4gdGhpc307XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXthPVRlKHRoaXMsYik7aWYoLTE9PT1hKXtpZih0aGlzLmc8WmUpe2E9dGhpcy5lO2Zvcih2YXIgZD1hLmxlbmd0aCxlPUFycmF5KGQrMiksZj0wOzspaWYoZjxkKWVbZl09YVtmXSxmKz0xO2Vsc2UgYnJlYWs7ZVtkXT1iO2VbZCsxXT1jO3JldHVybiBuZXcgbGEodGhpcy5qLHRoaXMuZysxLGUsbnVsbCl9cmV0dXJuIGViKE9hKFlkKCRlLHRoaXMpLGIsYyksdGhpcy5qKX1yZXR1cm4gYz09PXRoaXMuZVthKzFdP3RoaXM6dT8oYj12YSh0aGlzLmUpLGJbYSsxXT1jLG5ldyBsYSh0aGlzLmosdGhpcy5nLGIsbnVsbCkpOm51bGx9O2cua2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4tMSE9PVRlKHRoaXMsYil9O2cuSD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuZTtyZXR1cm4gMDw9YS5sZW5ndGgtMj9uZXcgVWUoYSwwLG51bGwpOm51bGx9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgbGEoYix0aGlzLmcsdGhpcy5lLHRoaXMubSl9O1xuZy5HPWZ1bmN0aW9uKGEsYil7aWYoSGMoYikpcmV0dXJuIE9hKHRoaXMsRC5hKGIsMCksRC5hKGIsMSkpO2Zvcih2YXIgYz10aGlzLGQ9RShiKTs7KXtpZihudWxsPT1kKXJldHVybiBjO3ZhciBlPUYoZCk7aWYoSGMoZSkpYz1PYShjLEQuYShlLDApLEQuYShlLDEpKSxkPUkoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImNvbmogb24gYSBtYXAgdGFrZXMgbWFwIGVudHJpZXMgb3Igc2VxYWJsZXMgb2YgbWFwIGVudHJpZXNcIik7fX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07XG5nLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07dmFyIFllPW5ldyBsYShudWxsLDAsW10sbnVsbCksWmU9ODtmdW5jdGlvbiBhZihhKXtmb3IodmFyIGI9YS5sZW5ndGgsYz0wLGQ9eWIoWWUpOzspaWYoYzxiKXZhciBlPWMrMixkPUJiKGQsYVtjXSxhW2MrMV0pLGM9ZTtlbHNlIHJldHVybiBBYihkKX1mdW5jdGlvbiBYZShhLGIsYyl7dGhpcy5SYT1hO3RoaXMuamE9Yjt0aGlzLmU9Yzt0aGlzLnE9NTY7dGhpcy5pPTI1OH1nPVhlLnByb3RvdHlwZTtcbmcuQWI9ZnVuY3Rpb24oYSxiKXtpZihyKHRoaXMuUmEpKXt2YXIgYz1UZSh0aGlzLGIpOzA8PWMmJih0aGlzLmVbY109dGhpcy5lW3RoaXMuamEtMl0sdGhpcy5lW2MrMV09dGhpcy5lW3RoaXMuamEtMV0sYz10aGlzLmUsYy5wb3AoKSxjLnBvcCgpLHRoaXMuamEtPTIpO3JldHVybiB0aGlzfXRocm93IEVycm9yKFwiZGlzc29jISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuY2I9ZnVuY3Rpb24oYSxiLGMpe2lmKHIodGhpcy5SYSkpe2E9VGUodGhpcyxiKTtpZigtMT09PWEpcmV0dXJuIHRoaXMuamErMjw9MipaZT8odGhpcy5qYSs9Mix0aGlzLmUucHVzaChiKSx0aGlzLmUucHVzaChjKSx0aGlzKTp4ZC5jKGJmLmE/YmYuYSh0aGlzLmphLHRoaXMuZSk6YmYuY2FsbChudWxsLHRoaXMuamEsdGhpcy5lKSxiLGMpO2MhPT10aGlzLmVbYSsxXSYmKHRoaXMuZVthKzFdPWMpO3JldHVybiB0aGlzfXRocm93IEVycm9yKFwiYXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5nLkthPWZ1bmN0aW9uKGEsYil7aWYocih0aGlzLlJhKSl7aWYoYj9iLmkmMjA0OHx8Yi5kY3x8KGIuaT8wOnMoU2EsYikpOnMoU2EsYikpcmV0dXJuIEJiKHRoaXMsY2YuYj9jZi5iKGIpOmNmLmNhbGwobnVsbCxiKSxkZi5iP2RmLmIoYik6ZGYuY2FsbChudWxsLGIpKTtmb3IodmFyIGM9RShiKSxkPXRoaXM7Oyl7dmFyIGU9RihjKTtpZihyKGUpKWM9SShjKSxkPUJiKGQsY2YuYj9jZi5iKGUpOmNmLmNhbGwobnVsbCxlKSxkZi5iP2RmLmIoZSk6ZGYuY2FsbChudWxsLGUpKTtlbHNlIHJldHVybiBkfX1lbHNlIHRocm93IEVycm9yKFwiY29uaiEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLk9hPWZ1bmN0aW9uKCl7aWYocih0aGlzLlJhKSlyZXR1cm4gdGhpcy5SYT0hMSxuZXcgbGEobnVsbCxZYyh0aGlzLmphKSx0aGlzLmUsbnVsbCk7dGhyb3cgRXJyb3IoXCJwZXJzaXN0ZW50ISBjYWxsZWQgdHdpY2VcIik7fTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O1xuZy5DPWZ1bmN0aW9uKGEsYixjKXtpZihyKHRoaXMuUmEpKXJldHVybiBhPVRlKHRoaXMsYiksLTE9PT1hP2M6dGhpcy5lW2ErMV07dGhyb3cgRXJyb3IoXCJsb29rdXAgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLkw9ZnVuY3Rpb24oKXtpZihyKHRoaXMuUmEpKXJldHVybiBZYyh0aGlzLmphKTt0aHJvdyBFcnJvcihcImNvdW50IGFmdGVyIHBlcnNpc3RlbnQhXCIpO307ZnVuY3Rpb24gYmYoYSxiKXtmb3IodmFyIGM9eWIoJGUpLGQ9MDs7KWlmKGQ8YSljPXhkLmMoYyxiW2RdLGJbZCsxXSksZCs9MjtlbHNlIHJldHVybiBjfWZ1bmN0aW9uIGVmKCl7dGhpcy5sPSExfWZ1bmN0aW9uIGZmKGEsYil7cmV0dXJuIGE9PT1iPyEwOmhkKGEsYik/ITA6dT9XYi5hKGEsYik6bnVsbH1cbnZhciBnZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCxrKXthPXZhKGEpO2FbYl09YzthW2hdPWs7cmV0dXJuIGF9ZnVuY3Rpb24gYihhLGIsYyl7YT12YShhKTthW2JdPWM7cmV0dXJuIGF9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlLGYpO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5jPWI7Yy5zPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gaGYoYSxiKXt2YXIgYz1BcnJheShhLmxlbmd0aC0yKTtLYyhhLDAsYywwLDIqYik7S2MoYSwyKihiKzEpLGMsMipiLGMubGVuZ3RoLTIqYik7cmV0dXJuIGN9XG52YXIgamY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayxsKXthPWEuTGEoYik7YS5lW2NdPWg7YS5lW2tdPWw7cmV0dXJuIGF9ZnVuY3Rpb24gYihhLGIsYyxoKXthPWEuTGEoYik7YS5lW2NdPWg7cmV0dXJuIGF9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgsayxsKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSA0OnJldHVybiBiLmNhbGwodGhpcyxjLGUsZixoKTtjYXNlIDY6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgsayxsKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5uPWI7Yy5YPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBrZihhLGIsYyl7Zm9yKHZhciBkPWEubGVuZ3RoLGU9MDs7KWlmKGU8ZCl7dmFyIGY9YVtlXTtudWxsIT1mP2M9Yi5jP2IuYyhjLGYsYVtlKzFdKTpiLmNhbGwobnVsbCxjLGYsYVtlKzFdKTooZj1hW2UrMV0sYz1udWxsIT1mP2YuVGEoYixjKTpjKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtlKz0yfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gbGYoYSxiLGMpe3RoaXMudD1hO3RoaXMuQT1iO3RoaXMuZT1jfWc9bGYucHJvdG90eXBlO2cuTGE9ZnVuY3Rpb24oYSl7aWYoYT09PXRoaXMudClyZXR1cm4gdGhpczt2YXIgYj1aYyh0aGlzLkEpLGM9QXJyYXkoMD5iPzQ6MiooYisxKSk7S2ModGhpcy5lLDAsYywwLDIqYik7cmV0dXJuIG5ldyBsZihhLHRoaXMuQSxjKX07XG5nLmdiPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9MTw8KGM+Pj5iJjMxKTtpZigwPT09KHRoaXMuQSZmKSlyZXR1cm4gdGhpczt2YXIgaD1aYyh0aGlzLkEmZi0xKSxrPXRoaXMuZVsyKmhdLGw9dGhpcy5lWzIqaCsxXTtyZXR1cm4gbnVsbD09az8oYj1sLmdiKGEsYis1LGMsZCxlKSxiPT09bD90aGlzOm51bGwhPWI/amYubih0aGlzLGEsMipoKzEsYik6dGhpcy5BPT09Zj9udWxsOnU/bWYodGhpcyxhLGYsaCk6bnVsbCk6ZmYoZCxrKT8oZVswXT0hMCxtZih0aGlzLGEsZixoKSk6dT90aGlzOm51bGx9O2Z1bmN0aW9uIG1mKGEsYixjLGQpe2lmKGEuQT09PWMpcmV0dXJuIG51bGw7YT1hLkxhKGIpO2I9YS5lO3ZhciBlPWIubGVuZ3RoO2EuQV49YztLYyhiLDIqKGQrMSksYiwyKmQsZS0yKihkKzEpKTtiW2UtMl09bnVsbDtiW2UtMV09bnVsbDtyZXR1cm4gYX1nLmViPWZ1bmN0aW9uKCl7cmV0dXJuIG5mLmI/bmYuYih0aGlzLmUpOm5mLmNhbGwobnVsbCx0aGlzLmUpfTtcbmcuVGE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4ga2YodGhpcy5lLGEsYil9O2cuTWE9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9MTw8KGI+Pj5hJjMxKTtpZigwPT09KHRoaXMuQSZlKSlyZXR1cm4gZDt2YXIgZj1aYyh0aGlzLkEmZS0xKSxlPXRoaXMuZVsyKmZdLGY9dGhpcy5lWzIqZisxXTtyZXR1cm4gbnVsbD09ZT9mLk1hKGErNSxiLGMsZCk6ZmYoYyxlKT9mOnU/ZDpudWxsfTtcbmcuaWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBoPTE8PChjPj4+YiYzMSksaz1aYyh0aGlzLkEmaC0xKTtpZigwPT09KHRoaXMuQSZoKSl7dmFyIGw9WmModGhpcy5BKTtpZigyKmw8dGhpcy5lLmxlbmd0aCl7YT10aGlzLkxhKGEpO2I9YS5lO2YubD0hMDthOmZvcihjPTIqKGwtayksZj0yKmsrKGMtMSksbD0yKihrKzEpKyhjLTEpOzspe2lmKDA9PT1jKWJyZWFrIGE7YltsXT1iW2ZdO2wtPTE7Yy09MTtmLT0xfWJbMiprXT1kO2JbMiprKzFdPWU7YS5BfD1oO3JldHVybiBhfWlmKDE2PD1sKXtrPVtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdO2tbYz4+PmImMzFdPW9mLmlhKGEsYis1LGMsZCxlLGYpO2ZvcihlPWQ9MDs7KWlmKDMyPmQpMCE9PVxuKHRoaXMuQT4+PmQmMSkmJihrW2RdPW51bGwhPXRoaXMuZVtlXT9vZi5pYShhLGIrNSxUYih0aGlzLmVbZV0pLHRoaXMuZVtlXSx0aGlzLmVbZSsxXSxmKTp0aGlzLmVbZSsxXSxlKz0yKSxkKz0xO2Vsc2UgYnJlYWs7cmV0dXJuIG5ldyBwZihhLGwrMSxrKX1yZXR1cm4gdT8oYj1BcnJheSgyKihsKzQpKSxLYyh0aGlzLmUsMCxiLDAsMiprKSxiWzIqa109ZCxiWzIqaysxXT1lLEtjKHRoaXMuZSwyKmssYiwyKihrKzEpLDIqKGwtaykpLGYubD0hMCxhPXRoaXMuTGEoYSksYS5lPWIsYS5BfD1oLGEpOm51bGx9bD10aGlzLmVbMiprXTtoPXRoaXMuZVsyKmsrMV07cmV0dXJuIG51bGw9PWw/KGw9aC5pYShhLGIrNSxjLGQsZSxmKSxsPT09aD90aGlzOmpmLm4odGhpcyxhLDIqaysxLGwpKTpmZihkLGwpP2U9PT1oP3RoaXM6amYubih0aGlzLGEsMiprKzEsZSk6dT8oZi5sPSEwLGpmLlgodGhpcyxhLDIqayxudWxsLDIqaysxLHFmLmdhP3FmLmdhKGEsYis1LGwsaCxjLGQsZSk6cWYuY2FsbChudWxsLFxuYSxiKzUsbCxoLGMsZCxlKSkpOm51bGx9O1xuZy5oYT1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPTE8PChiPj4+YSYzMSksaD1aYyh0aGlzLkEmZi0xKTtpZigwPT09KHRoaXMuQSZmKSl7dmFyIGs9WmModGhpcy5BKTtpZigxNjw9ayl7aD1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXTtoW2I+Pj5hJjMxXT1vZi5oYShhKzUsYixjLGQsZSk7Zm9yKGQ9Yz0wOzspaWYoMzI+YykwIT09KHRoaXMuQT4+PmMmMSkmJihoW2NdPW51bGwhPXRoaXMuZVtkXT9vZi5oYShhKzUsVGIodGhpcy5lW2RdKSx0aGlzLmVbZF0sdGhpcy5lW2QrMV0sZSk6dGhpcy5lW2QrMV0sZCs9MiksYys9MTtlbHNlIGJyZWFrO3JldHVybiBuZXcgcGYobnVsbCxrKzEsaCl9YT1BcnJheSgyKihrKzEpKTtLYyh0aGlzLmUsXG4wLGEsMCwyKmgpO2FbMipoXT1jO2FbMipoKzFdPWQ7S2ModGhpcy5lLDIqaCxhLDIqKGgrMSksMiooay1oKSk7ZS5sPSEwO3JldHVybiBuZXcgbGYobnVsbCx0aGlzLkF8ZixhKX1rPXRoaXMuZVsyKmhdO2Y9dGhpcy5lWzIqaCsxXTtyZXR1cm4gbnVsbD09az8oaz1mLmhhKGErNSxiLGMsZCxlKSxrPT09Zj90aGlzOm5ldyBsZihudWxsLHRoaXMuQSxnZi5jKHRoaXMuZSwyKmgrMSxrKSkpOmZmKGMsayk/ZD09PWY/dGhpczpuZXcgbGYobnVsbCx0aGlzLkEsZ2YuYyh0aGlzLmUsMipoKzEsZCkpOnU/KGUubD0hMCxuZXcgbGYobnVsbCx0aGlzLkEsZ2Yucyh0aGlzLmUsMipoLG51bGwsMipoKzEscWYuWD9xZi5YKGErNSxrLGYsYixjLGQpOnFmLmNhbGwobnVsbCxhKzUsayxmLGIsYyxkKSkpKTpudWxsfTtcbmcuZmI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPTE8PChiPj4+YSYzMSk7aWYoMD09PSh0aGlzLkEmZCkpcmV0dXJuIHRoaXM7dmFyIGU9WmModGhpcy5BJmQtMSksZj10aGlzLmVbMiplXSxoPXRoaXMuZVsyKmUrMV07cmV0dXJuIG51bGw9PWY/KGE9aC5mYihhKzUsYixjKSxhPT09aD90aGlzOm51bGwhPWE/bmV3IGxmKG51bGwsdGhpcy5BLGdmLmModGhpcy5lLDIqZSsxLGEpKTp0aGlzLkE9PT1kP251bGw6dT9uZXcgbGYobnVsbCx0aGlzLkFeZCxoZih0aGlzLmUsZSkpOm51bGwpOmZmKGMsZik/bmV3IGxmKG51bGwsdGhpcy5BXmQsaGYodGhpcy5lLGUpKTp1P3RoaXM6bnVsbH07dmFyIG9mPW5ldyBsZihudWxsLDAsW10pO1xuZnVuY3Rpb24gcmYoYSxiLGMpe3ZhciBkPWEuZTthPTIqKGEuZy0xKTtmb3IodmFyIGU9QXJyYXkoYSksZj0wLGg9MSxrPTA7OylpZihmPGEpZiE9PWMmJm51bGwhPWRbZl0mJihlW2hdPWRbZl0saCs9MixrfD0xPDxmKSxmKz0xO2Vsc2UgcmV0dXJuIG5ldyBsZihiLGssZSl9ZnVuY3Rpb24gcGYoYSxiLGMpe3RoaXMudD1hO3RoaXMuZz1iO3RoaXMuZT1jfWc9cGYucHJvdG90eXBlO2cuTGE9ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT10aGlzLnQ/dGhpczpuZXcgcGYoYSx0aGlzLmcsdmEodGhpcy5lKSl9O1xuZy5nYj1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWM+Pj5iJjMxLGg9dGhpcy5lW2ZdO2lmKG51bGw9PWgpcmV0dXJuIHRoaXM7Yj1oLmdiKGEsYis1LGMsZCxlKTtpZihiPT09aClyZXR1cm4gdGhpcztpZihudWxsPT1iKXtpZig4Pj10aGlzLmcpcmV0dXJuIHJmKHRoaXMsYSxmKTthPWpmLm4odGhpcyxhLGYsYik7YS5nLT0xO3JldHVybiBhfXJldHVybiB1P2pmLm4odGhpcyxhLGYsYik6bnVsbH07Zy5lYj1mdW5jdGlvbigpe3JldHVybiBzZi5iP3NmLmIodGhpcy5lKTpzZi5jYWxsKG51bGwsdGhpcy5lKX07Zy5UYT1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLmUubGVuZ3RoLGQ9MCxlPWI7OylpZihkPGMpe3ZhciBmPXRoaXMuZVtkXTtpZihudWxsIT1mJiYoZT1mLlRhKGEsZSksZmMoZSkpKXJldHVybiBLLmI/Sy5iKGUpOksuY2FsbChudWxsLGUpO2QrPTF9ZWxzZSByZXR1cm4gZX07XG5nLk1hPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPXRoaXMuZVtiPj4+YSYzMV07cmV0dXJuIG51bGwhPWU/ZS5NYShhKzUsYixjLGQpOmR9O2cuaWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBoPWM+Pj5iJjMxLGs9dGhpcy5lW2hdO2lmKG51bGw9PWspcmV0dXJuIGE9amYubih0aGlzLGEsaCxvZi5pYShhLGIrNSxjLGQsZSxmKSksYS5nKz0xLGE7Yj1rLmlhKGEsYis1LGMsZCxlLGYpO3JldHVybiBiPT09az90aGlzOmpmLm4odGhpcyxhLGgsYil9O2cuaGE9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1iPj4+YSYzMSxoPXRoaXMuZVtmXTtpZihudWxsPT1oKXJldHVybiBuZXcgcGYobnVsbCx0aGlzLmcrMSxnZi5jKHRoaXMuZSxmLG9mLmhhKGErNSxiLGMsZCxlKSkpO2E9aC5oYShhKzUsYixjLGQsZSk7cmV0dXJuIGE9PT1oP3RoaXM6bmV3IHBmKG51bGwsdGhpcy5nLGdmLmModGhpcy5lLGYsYSkpfTtcbmcuZmI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWI+Pj5hJjMxLGU9dGhpcy5lW2RdO3JldHVybiBudWxsIT1lPyhhPWUuZmIoYSs1LGIsYyksYT09PWU/dGhpczpudWxsPT1hPzg+PXRoaXMuZz9yZih0aGlzLG51bGwsZCk6bmV3IHBmKG51bGwsdGhpcy5nLTEsZ2YuYyh0aGlzLmUsZCxhKSk6dT9uZXcgcGYobnVsbCx0aGlzLmcsZ2YuYyh0aGlzLmUsZCxhKSk6bnVsbCk6dGhpc307ZnVuY3Rpb24gdGYoYSxiLGMpe2IqPTI7Zm9yKHZhciBkPTA7OylpZihkPGIpe2lmKGZmKGMsYVtkXSkpcmV0dXJuIGQ7ZCs9Mn1lbHNlIHJldHVybi0xfWZ1bmN0aW9uIHVmKGEsYixjLGQpe3RoaXMudD1hO3RoaXMucmE9Yjt0aGlzLmc9Yzt0aGlzLmU9ZH1nPXVmLnByb3RvdHlwZTtcbmcuTGE9ZnVuY3Rpb24oYSl7aWYoYT09PXRoaXMudClyZXR1cm4gdGhpczt2YXIgYj1BcnJheSgyKih0aGlzLmcrMSkpO0tjKHRoaXMuZSwwLGIsMCwyKnRoaXMuZyk7cmV0dXJuIG5ldyB1ZihhLHRoaXMucmEsdGhpcy5nLGIpfTtnLmdiPWZ1bmN0aW9uKGEsYixjLGQsZSl7Yj10Zih0aGlzLmUsdGhpcy5nLGQpO2lmKC0xPT09YilyZXR1cm4gdGhpcztlWzBdPSEwO2lmKDE9PT10aGlzLmcpcmV0dXJuIG51bGw7YT10aGlzLkxhKGEpO2U9YS5lO2VbYl09ZVsyKnRoaXMuZy0yXTtlW2IrMV09ZVsyKnRoaXMuZy0xXTtlWzIqdGhpcy5nLTFdPW51bGw7ZVsyKnRoaXMuZy0yXT1udWxsO2EuZy09MTtyZXR1cm4gYX07Zy5lYj1mdW5jdGlvbigpe3JldHVybiBuZi5iP25mLmIodGhpcy5lKTpuZi5jYWxsKG51bGwsdGhpcy5lKX07Zy5UYT1mdW5jdGlvbihhLGIpe3JldHVybiBrZih0aGlzLmUsYSxiKX07XG5nLk1hPWZ1bmN0aW9uKGEsYixjLGQpe2E9dGYodGhpcy5lLHRoaXMuZyxjKTtyZXR1cm4gMD5hP2Q6ZmYoYyx0aGlzLmVbYV0pP3RoaXMuZVthKzFdOnU/ZDpudWxsfTtcbmcuaWE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe2lmKGM9PT10aGlzLnJhKXtiPXRmKHRoaXMuZSx0aGlzLmcsZCk7aWYoLTE9PT1iKXtpZih0aGlzLmUubGVuZ3RoPjIqdGhpcy5nKXJldHVybiBhPWpmLlgodGhpcyxhLDIqdGhpcy5nLGQsMip0aGlzLmcrMSxlKSxmLmw9ITAsYS5nKz0xLGE7Yz10aGlzLmUubGVuZ3RoO2I9QXJyYXkoYysyKTtLYyh0aGlzLmUsMCxiLDAsYyk7YltjXT1kO2JbYysxXT1lO2YubD0hMDtmPXRoaXMuZysxO2E9PT10aGlzLnQ/KHRoaXMuZT1iLHRoaXMuZz1mLGE9dGhpcyk6YT1uZXcgdWYodGhpcy50LHRoaXMucmEsZixiKTtyZXR1cm4gYX1yZXR1cm4gdGhpcy5lW2IrMV09PT1lP3RoaXM6amYubih0aGlzLGEsYisxLGUpfXJldHVybihuZXcgbGYoYSwxPDwodGhpcy5yYT4+PmImMzEpLFtudWxsLHRoaXMsbnVsbCxudWxsXSkpLmlhKGEsYixjLGQsZSxmKX07XG5nLmhhPWZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuIGI9PT10aGlzLnJhPyhhPXRmKHRoaXMuZSx0aGlzLmcsYyksLTE9PT1hPyhhPTIqdGhpcy5nLGI9QXJyYXkoYSsyKSxLYyh0aGlzLmUsMCxiLDAsYSksYlthXT1jLGJbYSsxXT1kLGUubD0hMCxuZXcgdWYobnVsbCx0aGlzLnJhLHRoaXMuZysxLGIpKTpXYi5hKHRoaXMuZVthXSxkKT90aGlzOm5ldyB1ZihudWxsLHRoaXMucmEsdGhpcy5nLGdmLmModGhpcy5lLGErMSxkKSkpOihuZXcgbGYobnVsbCwxPDwodGhpcy5yYT4+PmEmMzEpLFtudWxsLHRoaXNdKSkuaGEoYSxiLGMsZCxlKX07Zy5mYj1mdW5jdGlvbihhLGIsYyl7YT10Zih0aGlzLmUsdGhpcy5nLGMpO3JldHVybi0xPT09YT90aGlzOjE9PT10aGlzLmc/bnVsbDp1P25ldyB1ZihudWxsLHRoaXMucmEsdGhpcy5nLTEsaGYodGhpcy5lLFljKGEpKSk6bnVsbH07XG52YXIgcWY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayxsLG4pe3ZhciBxPVRiKGMpO2lmKHE9PT1rKXJldHVybiBuZXcgdWYobnVsbCxxLDIsW2MsaCxsLG5dKTt2YXIgdD1uZXcgZWY7cmV0dXJuIG9mLmlhKGEsYixxLGMsaCx0KS5pYShhLGIsayxsLG4sdCl9ZnVuY3Rpb24gYihhLGIsYyxoLGssbCl7dmFyIG49VGIoYik7aWYobj09PWgpcmV0dXJuIG5ldyB1ZihudWxsLG4sMixbYixjLGssbF0pO3ZhciBxPW5ldyBlZjtyZXR1cm4gb2YuaGEoYSxuLGIsYyxxKS5oYShhLGgsayxsLHEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSA2OnJldHVybiBiLmNhbGwodGhpcyxjLGUsZixoLGssbCk7Y2FzZSA3OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoLGssbCxuKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5YPWI7Yy5nYT1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gdmYoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmthPWI7dGhpcy5wPWM7dGhpcy5yPWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyMzc0ODYwfWc9dmYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMucj9uZXcgVyhudWxsLDIsNSxYLFt0aGlzLmthW3RoaXMucF0sdGhpcy5rYVt0aGlzLnArMV1dLG51bGwpOkYodGhpcy5yKX07XG5nLlM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5yP25mLmM/bmYuYyh0aGlzLmthLHRoaXMucCsyLG51bGwpOm5mLmNhbGwobnVsbCx0aGlzLmthLHRoaXMucCsyLG51bGwpOm5mLmM/bmYuYyh0aGlzLmthLHRoaXMucCxJKHRoaXMucikpOm5mLmNhbGwobnVsbCx0aGlzLmthLHRoaXMucCxJKHRoaXMucikpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyB2ZihiLHRoaXMua2EsdGhpcy5wLHRoaXMucix0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtcbnZhciBuZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKG51bGw9PWMpZm9yKGM9YS5sZW5ndGg7OylpZihiPGMpe2lmKG51bGwhPWFbYl0pcmV0dXJuIG5ldyB2ZihudWxsLGEsYixudWxsLG51bGwpO3ZhciBoPWFbYisxXTtpZihyKGgpJiYoaD1oLmViKCkscihoKSkpcmV0dXJuIG5ldyB2ZihudWxsLGEsYisyLGgsbnVsbCk7Yis9Mn1lbHNlIHJldHVybiBudWxsO2Vsc2UgcmV0dXJuIG5ldyB2ZihudWxsLGEsYixjLG51bGwpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMuYyhhLDAsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5jPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiB3ZihhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMua2E9Yjt0aGlzLnA9Yzt0aGlzLnI9ZDt0aGlzLm09ZTt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ4NjB9Zz13Zi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRih0aGlzLnIpfTtcbmcuUz1mdW5jdGlvbigpe3JldHVybiBzZi5uP3NmLm4obnVsbCx0aGlzLmthLHRoaXMucCxJKHRoaXMucikpOnNmLmNhbGwobnVsbCxudWxsLHRoaXMua2EsdGhpcy5wLEkodGhpcy5yKSl9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHdmKGIsdGhpcy5rYSx0aGlzLnAsdGhpcy5yLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xudmFyIHNmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoKXtpZihudWxsPT1oKWZvcihoPWIubGVuZ3RoOzspaWYoYzxoKXt2YXIgaz1iW2NdO2lmKHIoaykmJihrPWsuZWIoKSxyKGspKSlyZXR1cm4gbmV3IHdmKGEsYixjKzEsayxudWxsKTtjKz0xfWVsc2UgcmV0dXJuIG51bGw7ZWxzZSByZXR1cm4gbmV3IHdmKGEsYixjLGgsbnVsbCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYy5uKG51bGwsYSwwLG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLm49YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIHhmKGEsYixjLGQsZSxmKXt0aGlzLmo9YTt0aGlzLmc9Yjt0aGlzLnJvb3Q9Yzt0aGlzLlQ9ZDt0aGlzLlk9ZTt0aGlzLm09Zjt0aGlzLmk9MTYxMjM2NjM7dGhpcy5xPTgxOTZ9Zz14Zi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFZlLmI/VmUuYih0aGlzKTpWZS5jYWxsKG51bGwsdGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gUWUoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFdlLmI/V2UuYih0aGlzKTpXZS5jYWxsKG51bGwsdGhpcykpfTtnLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07Zy5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtcbmcuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbnVsbD09Yj90aGlzLlQ/dGhpcy5ZOmM6bnVsbD09dGhpcy5yb290P2M6dT90aGlzLnJvb3QuTWEoMCxUYihiKSxiLGMpOm51bGx9O1xuZy5aYT1mdW5jdGlvbihhLGIsYyl7YT10aGlzLlQ/Yi5jP2IuYyhjLG51bGwsdGhpcy5ZKTpiLmNhbGwobnVsbCxjLG51bGwsdGhpcy5ZKTpjO3JldHVybiBmYyhhKT9LLmI/Sy5iKGEpOksuY2FsbChudWxsLGEpOm51bGwhPXRoaXMucm9vdD90aGlzLnJvb3QuVGEoYixhKTp1P2E6bnVsbH07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBNZSh0aGlzLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB5Zih7fSx0aGlzLnJvb3QsdGhpcy5nLHRoaXMuVCx0aGlzLlkpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gZWIoJGUsdGhpcy5qKX07XG5nLm5iPWZ1bmN0aW9uKGEsYil7aWYobnVsbD09YilyZXR1cm4gdGhpcy5UP25ldyB4Zih0aGlzLmosdGhpcy5nLTEsdGhpcy5yb290LCExLG51bGwsbnVsbCk6dGhpcztpZihudWxsPT10aGlzLnJvb3QpcmV0dXJuIHRoaXM7aWYodSl7dmFyIGM9dGhpcy5yb290LmZiKDAsVGIoYiksYik7cmV0dXJuIGM9PT10aGlzLnJvb3Q/dGhpczpuZXcgeGYodGhpcy5qLHRoaXMuZy0xLGMsdGhpcy5ULHRoaXMuWSxudWxsKX1yZXR1cm4gbnVsbH07XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXtpZihudWxsPT1iKXJldHVybiB0aGlzLlQmJmM9PT10aGlzLlk/dGhpczpuZXcgeGYodGhpcy5qLHRoaXMuVD90aGlzLmc6dGhpcy5nKzEsdGhpcy5yb290LCEwLGMsbnVsbCk7YT1uZXcgZWY7Yj0obnVsbD09dGhpcy5yb290P29mOnRoaXMucm9vdCkuaGEoMCxUYihiKSxiLGMsYSk7cmV0dXJuIGI9PT10aGlzLnJvb3Q/dGhpczpuZXcgeGYodGhpcy5qLGEubD90aGlzLmcrMTp0aGlzLmcsYix0aGlzLlQsdGhpcy5ZLG51bGwpfTtnLmtiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGw9PWI/dGhpcy5UOm51bGw9PXRoaXMucm9vdD8hMTp1P3RoaXMucm9vdC5NYSgwLFRiKGIpLGIsTGMpIT09TGM6bnVsbH07Zy5IPWZ1bmN0aW9uKCl7aWYoMDx0aGlzLmcpe3ZhciBhPW51bGwhPXRoaXMucm9vdD90aGlzLnJvb3QuZWIoKTpudWxsO3JldHVybiB0aGlzLlQ/TShuZXcgVyhudWxsLDIsNSxYLFtudWxsLHRoaXMuWV0sbnVsbCksYSk6YX1yZXR1cm4gbnVsbH07XG5nLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHhmKGIsdGhpcy5nLHRoaXMucm9vdCx0aGlzLlQsdGhpcy5ZLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe2lmKEhjKGIpKXJldHVybiBPYSh0aGlzLEQuYShiLDApLEQuYShiLDEpKTtmb3IodmFyIGM9dGhpcyxkPUUoYik7Oyl7aWYobnVsbD09ZClyZXR1cm4gYzt2YXIgZT1GKGQpO2lmKEhjKGUpKWM9T2EoYyxELmEoZSwwKSxELmEoZSwxKSksZD1JKGQpO2Vsc2UgdGhyb3cgRXJyb3IoXCJjb25qIG9uIGEgbWFwIHRha2VzIG1hcCBlbnRyaWVzIG9yIHNlcWFibGVzIG9mIG1hcCBlbnRyaWVzXCIpO319O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O3ZhciAkZT1uZXcgeGYobnVsbCwwLG51bGwsITEsbnVsbCwwKTtmdW5jdGlvbiBzYyhhLGIpe2Zvcih2YXIgYz1hLmxlbmd0aCxkPTAsZT15YigkZSk7OylpZihkPGMpdmFyIGY9ZCsxLGU9ZS5jYihudWxsLGFbZF0sYltkXSksZD1mO2Vsc2UgcmV0dXJuIEFiKGUpfVxuZnVuY3Rpb24geWYoYSxiLGMsZCxlKXt0aGlzLnQ9YTt0aGlzLnJvb3Q9Yjt0aGlzLmNvdW50PWM7dGhpcy5UPWQ7dGhpcy5ZPWU7dGhpcy5xPTU2O3RoaXMuaT0yNTh9Zz15Zi5wcm90b3R5cGU7Zy5BYj1mdW5jdGlvbihhLGIpe2lmKHRoaXMudClpZihudWxsPT1iKXRoaXMuVCYmKHRoaXMuVD0hMSx0aGlzLlk9bnVsbCx0aGlzLmNvdW50LT0xKTtlbHNle2lmKG51bGwhPXRoaXMucm9vdCl7dmFyIGM9bmV3IGVmLGQ9dGhpcy5yb290LmdiKHRoaXMudCwwLFRiKGIpLGIsYyk7ZCE9PXRoaXMucm9vdCYmKHRoaXMucm9vdD1kKTtyKGNbMF0pJiYodGhpcy5jb3VudC09MSl9fWVsc2UgdGhyb3cgRXJyb3IoXCJkaXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO3JldHVybiB0aGlzfTtnLmNiPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gemYodGhpcyxiLGMpfTtcbmcuS2E9ZnVuY3Rpb24oYSxiKXt2YXIgYzthOntpZih0aGlzLnQpe2lmKGI/Yi5pJjIwNDh8fGIuZGN8fChiLmk/MDpzKFNhLGIpKTpzKFNhLGIpKXtjPXpmKHRoaXMsY2YuYj9jZi5iKGIpOmNmLmNhbGwobnVsbCxiKSxkZi5iP2RmLmIoYik6ZGYuY2FsbChudWxsLGIpKTticmVhayBhfWM9RShiKTtmb3IodmFyIGQ9dGhpczs7KXt2YXIgZT1GKGMpO2lmKHIoZSkpYz1JKGMpLGQ9emYoZCxjZi5iP2NmLmIoZSk6Y2YuY2FsbChudWxsLGUpLGRmLmI/ZGYuYihlKTpkZi5jYWxsKG51bGwsZSkpO2Vsc2V7Yz1kO2JyZWFrIGF9fX1lbHNlIHRocm93IEVycm9yKFwiY29uaiEgYWZ0ZXIgcGVyc2lzdGVudFwiKTtjPXZvaWQgMH1yZXR1cm4gY307XG5nLk9hPWZ1bmN0aW9uKCl7dmFyIGE7aWYodGhpcy50KXRoaXMudD1udWxsLGE9bmV3IHhmKG51bGwsdGhpcy5jb3VudCx0aGlzLnJvb3QsdGhpcy5ULHRoaXMuWSxudWxsKTtlbHNlIHRocm93IEVycm9yKFwicGVyc2lzdGVudCEgY2FsbGVkIHR3aWNlXCIpO3JldHVybiBhfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbD09Yj90aGlzLlQ/dGhpcy5ZOm51bGw6bnVsbD09dGhpcy5yb290P251bGw6dGhpcy5yb290Lk1hKDAsVGIoYiksYil9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/dGhpcy5UP3RoaXMuWTpjOm51bGw9PXRoaXMucm9vdD9jOnRoaXMucm9vdC5NYSgwLFRiKGIpLGIsYyl9O2cuTD1mdW5jdGlvbigpe2lmKHRoaXMudClyZXR1cm4gdGhpcy5jb3VudDt0aHJvdyBFcnJvcihcImNvdW50IGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5mdW5jdGlvbiB6ZihhLGIsYyl7aWYoYS50KXtpZihudWxsPT1iKWEuWSE9PWMmJihhLlk9YyksYS5UfHwoYS5jb3VudCs9MSxhLlQ9ITApO2Vsc2V7dmFyIGQ9bmV3IGVmO2I9KG51bGw9PWEucm9vdD9vZjphLnJvb3QpLmlhKGEudCwwLFRiKGIpLGIsYyxkKTtiIT09YS5yb290JiYoYS5yb290PWIpO2QubCYmKGEuY291bnQrPTEpfXJldHVybiBhfXRocm93IEVycm9yKFwiYXNzb2MhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO31mdW5jdGlvbiBBZihhLGIsYyl7Zm9yKHZhciBkPWI7OylpZihudWxsIT1hKWI9Yz9hLmxlZnQ6YS5yaWdodCxkPXBjLmEoZCxhKSxhPWI7ZWxzZSByZXR1cm4gZH1mdW5jdGlvbiBCZihhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuc3RhY2s9Yjt0aGlzLmliPWM7dGhpcy5nPWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyMzc0ODYyfWc9QmYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O1xuZy5MPWZ1bmN0aW9uKCl7cmV0dXJuIDA+dGhpcy5nP08oSSh0aGlzKSkrMTp0aGlzLmd9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHljKHRoaXMuc3RhY2spfTtnLlM9ZnVuY3Rpb24oKXt2YXIgYT1GKHRoaXMuc3RhY2spLGE9QWYodGhpcy5pYj9hLnJpZ2h0OmEubGVmdCxJKHRoaXMuc3RhY2spLHRoaXMuaWIpO3JldHVybiBudWxsIT1hP25ldyBCZihudWxsLGEsdGhpcy5pYix0aGlzLmctMSxudWxsKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307XG5nLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEJmKGIsdGhpcy5zdGFjayx0aGlzLmliLHRoaXMuZyx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtmdW5jdGlvbiBDZihhLGIsYyl7cmV0dXJuIG5ldyBCZihudWxsLEFmKGEsbnVsbCxiKSxiLGMsbnVsbCl9ZnVuY3Rpb24gRGYoYSxiLGMsZCl7cmV0dXJuIGMgaW5zdGFuY2VvZiBZP2MubGVmdCBpbnN0YW5jZW9mIFk/bmV3IFkoYy5rZXksYy5sLGMubGVmdC5xYSgpLG5ldyAkKGEsYixjLnJpZ2h0LGQsbnVsbCksbnVsbCk6Yy5yaWdodCBpbnN0YW5jZW9mIFk/bmV3IFkoYy5yaWdodC5rZXksYy5yaWdodC5sLG5ldyAkKGMua2V5LGMubCxjLmxlZnQsYy5yaWdodC5sZWZ0LG51bGwpLG5ldyAkKGEsYixjLnJpZ2h0LnJpZ2h0LGQsbnVsbCksbnVsbCk6dT9uZXcgJChhLGIsYyxkLG51bGwpOm51bGw6bmV3ICQoYSxiLGMsZCxudWxsKX1cbmZ1bmN0aW9uIEVmKGEsYixjLGQpe3JldHVybiBkIGluc3RhbmNlb2YgWT9kLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWShkLmtleSxkLmwsbmV3ICQoYSxiLGMsZC5sZWZ0LG51bGwpLGQucmlnaHQucWEoKSxudWxsKTpkLmxlZnQgaW5zdGFuY2VvZiBZP25ldyBZKGQubGVmdC5rZXksZC5sZWZ0LmwsbmV3ICQoYSxiLGMsZC5sZWZ0LmxlZnQsbnVsbCksbmV3ICQoZC5rZXksZC5sLGQubGVmdC5yaWdodCxkLnJpZ2h0LG51bGwpLG51bGwpOnU/bmV3ICQoYSxiLGMsZCxudWxsKTpudWxsOm5ldyAkKGEsYixjLGQsbnVsbCl9XG5mdW5jdGlvbiBGZihhLGIsYyxkKXtpZihjIGluc3RhbmNlb2YgWSlyZXR1cm4gbmV3IFkoYSxiLGMucWEoKSxkLG51bGwpO2lmKGQgaW5zdGFuY2VvZiAkKXJldHVybiBFZihhLGIsYyxkLmhiKCkpO2lmKGQgaW5zdGFuY2VvZiBZJiZkLmxlZnQgaW5zdGFuY2VvZiAkKXJldHVybiBuZXcgWShkLmxlZnQua2V5LGQubGVmdC5sLG5ldyAkKGEsYixjLGQubGVmdC5sZWZ0LG51bGwpLEVmKGQua2V5LGQubCxkLmxlZnQucmlnaHQsZC5yaWdodC5oYigpKSxudWxsKTtpZih1KXRocm93IEVycm9yKFwicmVkLWJsYWNrIHRyZWUgaW52YXJpYW50IHZpb2xhdGlvblwiKTtyZXR1cm4gbnVsbH1cbnZhciBIZj1mdW5jdGlvbiBHZihiLGMsZCl7ZD1udWxsIT1iLmxlZnQ/R2YoYi5sZWZ0LGMsZCk6ZDtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtkPWMuYz9jLmMoZCxiLmtleSxiLmwpOmMuY2FsbChudWxsLGQsYi5rZXksYi5sKTtpZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtiPW51bGwhPWIucmlnaHQ/R2YoYi5yaWdodCxjLGQpOmQ7cmV0dXJuIGZjKGIpP0suYj9LLmIoYik6Sy5jYWxsKG51bGwsYik6Yn07ZnVuY3Rpb24gJChhLGIsYyxkLGUpe3RoaXMua2V5PWE7dGhpcy5sPWI7dGhpcy5sZWZ0PWM7dGhpcy5yaWdodD1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjQwMjIwN31nPSQucHJvdG90eXBlO2cuSGI9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuSmIodGhpcyl9O2cuaGI9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFkodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCx0aGlzLnJpZ2h0LG51bGwpfTtnLnFhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5HYj1mdW5jdGlvbihhKXtyZXR1cm4gYS5JYih0aGlzKX07Zy5yZXBsYWNlPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBuZXcgJChhLGIsYyxkLG51bGwpfTtnLkliPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgJChhLmtleSxhLmwsdGhpcyxhLnJpZ2h0LG51bGwpfTtnLkpiPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgJChhLmtleSxhLmwsYS5sZWZ0LHRoaXMsbnVsbCl9O2cuVGE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSGYodGhpcyxhLGIpfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRC5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gRC5jKHRoaXMsYixjKX07Zy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA9PT1iP3RoaXMua2V5OjE9PT1iP3RoaXMubDpudWxsfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMD09PWI/dGhpcy5rZXk6MT09PWI/dGhpcy5sOnU/YzpudWxsfTtcbmcuUGE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybihuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpKS5QYShudWxsLGIsYyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gMn07Zy4kYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmtleX07Zy5hYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtnLkphPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBXKG51bGwsMSw1LFgsW3RoaXMua2V5XSxudWxsKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gcWV9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBSLmMobmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSxiLGMpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gRGEoRGEoSCx0aGlzLmwpLHRoaXMua2V5KX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBXKG51bGwsMyw1LFgsW3RoaXMua2V5LHRoaXMubCxiXSxudWxsKX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtcbmcuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07ZnVuY3Rpb24gWShhLGIsYyxkLGUpe3RoaXMua2V5PWE7dGhpcy5sPWI7dGhpcy5sZWZ0PWM7dGhpcy5yaWdodD1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjQwMjIwN31nPVkucHJvdG90eXBlO2cuSGI9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBZKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQsYSxudWxsKX07Zy5oYj1mdW5jdGlvbigpe3Rocm93IEVycm9yKFwicmVkLWJsYWNrIHRyZWUgaW52YXJpYW50IHZpb2xhdGlvblwiKTt9O2cucWE9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3ICQodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCx0aGlzLnJpZ2h0LG51bGwpfTtcbmcuR2I9ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBZKHRoaXMua2V5LHRoaXMubCxhLHRoaXMucmlnaHQsbnVsbCl9O2cucmVwbGFjZT1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gbmV3IFkoYSxiLGMsZCxudWxsKX07Zy5JYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5sZWZ0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LnFhKCksbmV3ICQoYS5rZXksYS5sLHRoaXMucmlnaHQsYS5yaWdodCxudWxsKSxudWxsKTp0aGlzLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLnJpZ2h0LmtleSx0aGlzLnJpZ2h0LmwsbmV3ICQodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdCx0aGlzLnJpZ2h0LmxlZnQsbnVsbCksbmV3ICQoYS5rZXksYS5sLHRoaXMucmlnaHQucmlnaHQsYS5yaWdodCxudWxsKSxudWxsKTp1P25ldyAkKGEua2V5LGEubCx0aGlzLGEucmlnaHQsbnVsbCk6bnVsbH07XG5nLkpiPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJpZ2h0IGluc3RhbmNlb2YgWT9uZXcgWSh0aGlzLmtleSx0aGlzLmwsbmV3ICQoYS5rZXksYS5sLGEubGVmdCx0aGlzLmxlZnQsbnVsbCksdGhpcy5yaWdodC5xYSgpLG51bGwpOnRoaXMubGVmdCBpbnN0YW5jZW9mIFk/bmV3IFkodGhpcy5sZWZ0LmtleSx0aGlzLmxlZnQubCxuZXcgJChhLmtleSxhLmwsYS5sZWZ0LHRoaXMubGVmdC5sZWZ0LG51bGwpLG5ldyAkKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQucmlnaHQsdGhpcy5yaWdodCxudWxsKSxudWxsKTp1P25ldyAkKGEua2V5LGEubCxhLmxlZnQsdGhpcyxudWxsKTpudWxsfTtnLlRhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEhmKHRoaXMsYSxiKX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIEQuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIEQuYyh0aGlzLGIsYyl9O1xuZy5KPWZ1bmN0aW9uKGEsYil7cmV0dXJuIDA9PT1iP3RoaXMua2V5OjE9PT1iP3RoaXMubDpudWxsfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMD09PWI/dGhpcy5rZXk6MT09PWI/dGhpcy5sOnU/YzpudWxsfTtnLlBhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4obmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSkuUGEobnVsbCxiLGMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIDJ9O2cuJGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5rZXl9O2cuYWI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubH07Zy5KYT1mdW5jdGlvbigpe3JldHVybiBuZXcgVyhudWxsLDEsNSxYLFt0aGlzLmtleV0sbnVsbCl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtcbmcudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gcWV9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHRoaXMsYil9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtnLnVhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gUi5jKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCksYixjKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIERhKERhKEgsdGhpcy5sKSx0aGlzLmtleSl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCksYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVyhudWxsLDMsNSxYLFt0aGlzLmtleSx0aGlzLmwsYl0sbnVsbCl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O1xudmFyIEpmPWZ1bmN0aW9uIElmKGIsYyxkLGUsZil7aWYobnVsbD09YylyZXR1cm4gbmV3IFkoZCxlLG51bGwsbnVsbCxudWxsKTt2YXIgaD1iLmE/Yi5hKGQsYy5rZXkpOmIuY2FsbChudWxsLGQsYy5rZXkpO3JldHVybiAwPT09aD8oZlswXT1jLG51bGwpOjA+aD8oYj1JZihiLGMubGVmdCxkLGUsZiksbnVsbCE9Yj9jLkdiKGIpOm51bGwpOnU/KGI9SWYoYixjLnJpZ2h0LGQsZSxmKSxudWxsIT1iP2MuSGIoYik6bnVsbCk6bnVsbH0sTGY9ZnVuY3Rpb24gS2YoYixjKXtpZihudWxsPT1iKXJldHVybiBjO2lmKG51bGw9PWMpcmV0dXJuIGI7aWYoYiBpbnN0YW5jZW9mIFkpe2lmKGMgaW5zdGFuY2VvZiBZKXt2YXIgZD1LZihiLnJpZ2h0LGMubGVmdCk7cmV0dXJuIGQgaW5zdGFuY2VvZiBZP25ldyBZKGQua2V5LGQubCxuZXcgWShiLmtleSxiLmwsYi5sZWZ0LGQubGVmdCxudWxsKSxuZXcgWShjLmtleSxjLmwsZC5yaWdodCxjLnJpZ2h0LG51bGwpLG51bGwpOm5ldyBZKGIua2V5LGIubCxcbmIubGVmdCxuZXcgWShjLmtleSxjLmwsZCxjLnJpZ2h0LG51bGwpLG51bGwpfXJldHVybiBuZXcgWShiLmtleSxiLmwsYi5sZWZ0LEtmKGIucmlnaHQsYyksbnVsbCl9cmV0dXJuIGMgaW5zdGFuY2VvZiBZP25ldyBZKGMua2V5LGMubCxLZihiLGMubGVmdCksYy5yaWdodCxudWxsKTp1PyhkPUtmKGIucmlnaHQsYy5sZWZ0KSxkIGluc3RhbmNlb2YgWT9uZXcgWShkLmtleSxkLmwsbmV3ICQoYi5rZXksYi5sLGIubGVmdCxkLmxlZnQsbnVsbCksbmV3ICQoYy5rZXksYy5sLGQucmlnaHQsYy5yaWdodCxudWxsKSxudWxsKTpGZihiLmtleSxiLmwsYi5sZWZ0LG5ldyAkKGMua2V5LGMubCxkLGMucmlnaHQsbnVsbCkpKTpudWxsfSxOZj1mdW5jdGlvbiBNZihiLGMsZCxlKXtpZihudWxsIT1jKXt2YXIgZj1iLmE/Yi5hKGQsYy5rZXkpOmIuY2FsbChudWxsLGQsYy5rZXkpO2lmKDA9PT1mKXJldHVybiBlWzBdPWMsTGYoYy5sZWZ0LGMucmlnaHQpO2lmKDA+ZilyZXR1cm4gYj1NZihiLGMubGVmdCxcbmQsZSksbnVsbCE9Ynx8bnVsbCE9ZVswXT9jLmxlZnQgaW5zdGFuY2VvZiAkP0ZmKGMua2V5LGMubCxiLGMucmlnaHQpOm5ldyBZKGMua2V5LGMubCxiLGMucmlnaHQsbnVsbCk6bnVsbDtpZih1KXtiPU1mKGIsYy5yaWdodCxkLGUpO2lmKG51bGwhPWJ8fG51bGwhPWVbMF0paWYoYy5yaWdodCBpbnN0YW5jZW9mICQpaWYoZT1jLmtleSxkPWMubCxjPWMubGVmdCxiIGluc3RhbmNlb2YgWSljPW5ldyBZKGUsZCxjLGIucWEoKSxudWxsKTtlbHNlIGlmKGMgaW5zdGFuY2VvZiAkKWM9RGYoZSxkLGMuaGIoKSxiKTtlbHNlIGlmKGMgaW5zdGFuY2VvZiBZJiZjLnJpZ2h0IGluc3RhbmNlb2YgJCljPW5ldyBZKGMucmlnaHQua2V5LGMucmlnaHQubCxEZihjLmtleSxjLmwsYy5sZWZ0LmhiKCksYy5yaWdodC5sZWZ0KSxuZXcgJChlLGQsYy5yaWdodC5yaWdodCxiLG51bGwpLG51bGwpO2Vsc2V7aWYodSl0aHJvdyBFcnJvcihcInJlZC1ibGFjayB0cmVlIGludmFyaWFudCB2aW9sYXRpb25cIik7XG5jPW51bGx9ZWxzZSBjPW5ldyBZKGMua2V5LGMubCxjLmxlZnQsYixudWxsKTtlbHNlIGM9bnVsbDtyZXR1cm4gY319cmV0dXJuIG51bGx9LFBmPWZ1bmN0aW9uIE9mKGIsYyxkLGUpe3ZhciBmPWMua2V5LGg9Yi5hP2IuYShkLGYpOmIuY2FsbChudWxsLGQsZik7cmV0dXJuIDA9PT1oP2MucmVwbGFjZShmLGUsYy5sZWZ0LGMucmlnaHQpOjA+aD9jLnJlcGxhY2UoZixjLmwsT2YoYixjLmxlZnQsZCxlKSxjLnJpZ2h0KTp1P2MucmVwbGFjZShmLGMubCxjLmxlZnQsT2YoYixjLnJpZ2h0LGQsZSkpOm51bGx9O2Z1bmN0aW9uIFFmKGEsYixjLGQsZSl7dGhpcy5aPWE7dGhpcy5tYT1iO3RoaXMuZz1jO3RoaXMuaj1kO3RoaXMubT1lO3RoaXMuaT00MTg3NzY4NDc7dGhpcy5xPTgxOTJ9Zz1RZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFZlLmI/VmUuYih0aGlzKTpWZS5jYWxsKG51bGwsdGhpcykpfTtcbmcuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBRZShFKHRoaXMpKX07Zy52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoV2UuYj9XZS5iKHRoaXMpOldlLmNhbGwobnVsbCx0aGlzKSl9O2cuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtnLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuZm9yRWFjaD1mdW5jdGlvbihhKXtmb3IodmFyIGI9RSh0aGlzKSxjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSksaD1QLmMoZiwwLG51bGwpLGY9UC5jKGYsMSxudWxsKTthLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKTtlKz0xfWVsc2UgaWYoYj1FKGIpKUljKGIpPyhjPUhiKGIpLGI9SWIoYiksaD1jLGQ9TyhjKSxjPWgpOihjPUYoYiksaD1QLmMoYywwLG51bGwpLGY9UC5jKGMsMSxudWxsKSxhLmE/YS5hKGYsaCk6YS5jYWxsKG51bGwsZixoKSxiPUkoYiksYz1udWxsLGQ9MCksZT0wO2Vsc2UgcmV0dXJuIG51bGx9O1xuZnVuY3Rpb24gUmYoYSxiKXtmb3IodmFyIGM9YS5tYTs7KWlmKG51bGwhPWMpe3ZhciBkPWEuWi5hP2EuWi5hKGIsYy5rZXkpOmEuWi5jYWxsKG51bGwsYixjLmtleSk7aWYoMD09PWQpcmV0dXJuIGM7aWYoMD5kKWM9Yy5sZWZ0O2Vsc2UgaWYodSljPWMucmlnaHQ7ZWxzZSByZXR1cm4gbnVsbH1lbHNlIHJldHVybiBudWxsfWcudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXthPVJmKHRoaXMsYik7cmV0dXJuIG51bGwhPWE/YS5sOmN9O2cuWmE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsIT10aGlzLm1hP0hmKHRoaXMubWEsYixjKTpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nfTtnLlhhPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP0NmKHRoaXMubWEsITEsdGhpcy5nKTpudWxsfTtcbmcuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTWUodGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oU2YsdGhpcy5qKX07Zy5uYj1mdW5jdGlvbihhLGIpe3ZhciBjPVtudWxsXSxkPU5mKHRoaXMuWix0aGlzLm1hLGIsYyk7cmV0dXJuIG51bGw9PWQ/bnVsbD09UC5hKGMsMCk/dGhpczpuZXcgUWYodGhpcy5aLG51bGwsMCx0aGlzLmosbnVsbCk6bmV3IFFmKHRoaXMuWixkLnFhKCksdGhpcy5nLTEsdGhpcy5qLG51bGwpfTtcbmcudWE9ZnVuY3Rpb24oYSxiLGMpe2E9W251bGxdO3ZhciBkPUpmKHRoaXMuWix0aGlzLm1hLGIsYyxhKTtyZXR1cm4gbnVsbD09ZD8oYT1QLmEoYSwwKSxXYi5hKGMsYS5sKT90aGlzOm5ldyBRZih0aGlzLlosUGYodGhpcy5aLHRoaXMubWEsYixjKSx0aGlzLmcsdGhpcy5qLG51bGwpKTpuZXcgUWYodGhpcy5aLGQucWEoKSx0aGlzLmcrMSx0aGlzLmosbnVsbCl9O2cua2I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbCE9UmYodGhpcyxiKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP0NmKHRoaXMubWEsITAsdGhpcy5nKTpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFFmKHRoaXMuWix0aGlzLm1hLHRoaXMuZyxiLHRoaXMubSl9O1xuZy5HPWZ1bmN0aW9uKGEsYil7aWYoSGMoYikpcmV0dXJuIE9hKHRoaXMsRC5hKGIsMCksRC5hKGIsMSkpO2Zvcih2YXIgYz10aGlzLGQ9RShiKTs7KXtpZihudWxsPT1kKXJldHVybiBjO3ZhciBlPUYoZCk7aWYoSGMoZSkpYz1PYShjLEQuYShlLDApLEQuYShlLDEpKSxkPUkoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImNvbmogb24gYSBtYXAgdGFrZXMgbWFwIGVudHJpZXMgb3Igc2VxYWJsZXMgb2YgbWFwIGVudHJpZXNcIik7fX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07XG5nLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07Zy55Yj1mdW5jdGlvbihhLGIpe3JldHVybiAwPHRoaXMuZz9DZih0aGlzLm1hLGIsdGhpcy5nKTpudWxsfTtnLnpiPWZ1bmN0aW9uKGEsYixjKXtpZigwPHRoaXMuZyl7YT1udWxsO2Zvcih2YXIgZD10aGlzLm1hOzspaWYobnVsbCE9ZCl7dmFyIGU9dGhpcy5aLmE/dGhpcy5aLmEoYixkLmtleSk6dGhpcy5aLmNhbGwobnVsbCxiLGQua2V5KTtpZigwPT09ZSlyZXR1cm4gbmV3IEJmKG51bGwscGMuYShhLGQpLGMsLTEsbnVsbCk7aWYocihjKSkwPmU/KGE9cGMuYShhLGQpLGQ9ZC5sZWZ0KTpkPWQucmlnaHQ7ZWxzZSBpZih1KTA8ZT8oYT1wYy5hKGEsZCksZD1kLnJpZ2h0KTpkPWQubGVmdDtlbHNlIHJldHVybiBudWxsfWVsc2UgcmV0dXJuIG51bGw9PWE/bnVsbDpuZXcgQmYobnVsbCxhLGMsLTEsbnVsbCl9ZWxzZSByZXR1cm4gbnVsbH07XG5nLnhiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGNmLmI/Y2YuYihiKTpjZi5jYWxsKG51bGwsYil9O2cud2I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5afTtcbnZhciBTZj1uZXcgUWYoWGIsbnVsbCwwLG51bGwsMCksVGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7YT1FKGEpO2Zvcih2YXIgYj15YigkZSk7OylpZihhKXt2YXIgZT1JKEkoYSkpLGI9eGQuYyhiLEYoYSksRihJKGEpKSk7YT1lfWVsc2UgcmV0dXJuIEFiKGIpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpLFVmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBuZXcgbGEobnVsbCxZYyhPKGEpKSxTLmEod2EsXG5hKSxudWxsKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxWZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXthPUUoYSk7Zm9yKHZhciBiPVNmOzspaWYoYSl7dmFyIGU9SShJKGEpKSxiPVIuYyhiLEYoYSksRihJKGEpKSk7YT1lfWVsc2UgcmV0dXJuIGJ9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCksV2Y9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsXG5iKXtmb3IodmFyIGU9RShiKSxmPW5ldyBRZihRYyhhKSxudWxsLDAsbnVsbCwwKTs7KWlmKGUpdmFyIGg9SShJKGUpKSxmPVIuYyhmLEYoZSksRihJKGUpKSksZT1oO2Vsc2UgcmV0dXJuIGZ9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIFhmKGEsYil7dGhpcy5WPWE7dGhpcy5XPWI7dGhpcy5xPTA7dGhpcy5pPTMyMzc0OTg4fWc9WGYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLld9O2cuVT1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVixhPShhP2EuaSYxMjh8fGEub2J8fChhLmk/MDpzKEphLGEpKTpzKEphLGEpKT90aGlzLlYuVShudWxsKTpJKHRoaXMuVik7cmV0dXJuIG51bGw9PWE/bnVsbDpuZXcgWGYoYSx0aGlzLlcpfTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gY2ModGhpcyl9O1xuZy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5XKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLlYuUShudWxsKS4kYShudWxsKX07Zy5TPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5WLGE9KGE/YS5pJjEyOHx8YS5vYnx8KGEuaT8wOnMoSmEsYSkpOnMoSmEsYSkpP3RoaXMuVi5VKG51bGwpOkkodGhpcy5WKTtyZXR1cm4gbnVsbCE9YT9uZXcgWGYoYSx0aGlzLlcpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFhmKHRoaXMuVixiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07ZnVuY3Rpb24gVmUoYSl7cmV0dXJuKGE9RShhKSk/bmV3IFhmKGEsbnVsbCk6bnVsbH1cbmZ1bmN0aW9uIGNmKGEpe3JldHVybiBUYShhKX1mdW5jdGlvbiBZZihhLGIpe3RoaXMuVj1hO3RoaXMuVz1iO3RoaXMucT0wO3RoaXMuaT0zMjM3NDk4OH1nPVlmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfTtnLlU9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlYsYT0oYT9hLmkmMTI4fHxhLm9ifHwoYS5pPzA6cyhKYSxhKSk6cyhKYSxhKSk/dGhpcy5WLlUobnVsbCk6SSh0aGlzLlYpO3JldHVybiBudWxsPT1hP251bGw6bmV3IFlmKGEsdGhpcy5XKX07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLlcpfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuVi5RKG51bGwpLmFiKG51bGwpfTtcbmcuUz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVixhPShhP2EuaSYxMjh8fGEub2J8fChhLmk/MDpzKEphLGEpKTpzKEphLGEpKT90aGlzLlYuVShudWxsKTpJKHRoaXMuVik7cmV0dXJuIG51bGwhPWE/bmV3IFlmKGEsdGhpcy5XKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBZZih0aGlzLlYsYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2Z1bmN0aW9uIFdlKGEpe3JldHVybihhPUUoYSkpP25ldyBZZihhLG51bGwpOm51bGx9ZnVuY3Rpb24gZGYoYSl7cmV0dXJuIFVhKGEpfVxudmFyIFpmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiByKEVkKEZkLGEpKT9DLmEoZnVuY3Rpb24oYSxiKXtyZXR1cm4gcGMuYShyKGEpP2E6WWUsYil9LGEpOm51bGx9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCk7ZnVuY3Rpb24gJGYoYSxiLGMpe3RoaXMuaj1hO3RoaXMuU2E9Yjt0aGlzLm09Yzt0aGlzLmk9MTUwNzc2NDc7dGhpcy5xPTgxOTZ9Zz0kZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gU2UoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtcbmcuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtnLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIE5hKHRoaXMuU2EsYik/YjpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gQWEodGhpcy5TYSl9O1xuZy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBEYyhiKSYmTyh0aGlzKT09PU8oYikmJkRkKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX19KHRoaXMpLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBhZyh5Yih0aGlzLlNhKSl9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKGJnLHRoaXMuail9O2cudmI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3ICRmKHRoaXMuaixRYSh0aGlzLlNhLGIpLG51bGwpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gVmUodGhpcy5TYSl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgJGYoYix0aGlzLlNhLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgJGYodGhpcy5qLFIuYyh0aGlzLlNhLGIsbnVsbCksbnVsbCl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy51KG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLkMobnVsbCxjLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O3ZhciBiZz1uZXcgJGYobnVsbCxZZSwwKTtmdW5jdGlvbiBhZyhhKXt0aGlzLmxhPWE7dGhpcy5pPTI1OTt0aGlzLnE9MTM2fWc9YWcucHJvdG90eXBlO1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gTGEuYyh0aGlzLmxhLGMsTGMpPT09TGM/bnVsbDpjO2Nhc2UgMzpyZXR1cm4gTGEuYyh0aGlzLmxhLGMsTGMpPT09TGM/ZDpjfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiBMYS5jKHRoaXMubGEsYSxMYyk9PT1MYz9udWxsOmF9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMubGEsYSxMYyk9PT1MYz9iOmF9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBMYS5jKHRoaXMsYixudWxsKX07Zy5DPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gTGEuYyh0aGlzLmxhLGIsTGMpPT09TGM/YzpifTtcbmcuTD1mdW5jdGlvbigpe3JldHVybiBPKHRoaXMubGEpfTtnLk9iPWZ1bmN0aW9uKGEsYil7dGhpcy5sYT15ZC5hKHRoaXMubGEsYik7cmV0dXJuIHRoaXN9O2cuS2E9ZnVuY3Rpb24oYSxiKXt0aGlzLmxhPXhkLmModGhpcy5sYSxiLG51bGwpO3JldHVybiB0aGlzfTtnLk9hPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyAkZihudWxsLEFiKHRoaXMubGEpLG51bGwpfTtmdW5jdGlvbiBjZyhhLGIsYyl7dGhpcy5qPWE7dGhpcy5uYT1iO3RoaXMubT1jO3RoaXMuaT00MTc3MzA4MzE7dGhpcy5xPTgxOTJ9Zz1jZy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5rZXlzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtnLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gU2UoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKEUodGhpcykpfTtnLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07XG5nLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7YT1SZih0aGlzLm5hLGIpO3JldHVybiBudWxsIT1hP2Eua2V5OmN9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiBPKHRoaXMubmEpfTtcbmcuWGE9ZnVuY3Rpb24oKXtyZXR1cm4gMDxPKHRoaXMubmEpP0tkLmEoY2YscGIodGhpcy5uYSkpOm51bGx9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRGMoYikmJk8odGhpcyk9PT1PKGIpJiZEZChmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9fSh0aGlzKSxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oZGcsdGhpcy5qKX07Zy52Yj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgY2codGhpcy5qLHRjLmEodGhpcy5uYSxiKSxudWxsKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIFZlKHRoaXMubmEpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGNnKGIsdGhpcy5uYSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGNnKHRoaXMuaixSLmModGhpcy5uYSxiLG51bGwpLG51bGwpfTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtnLnliPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEtkLmEoY2YscWIodGhpcy5uYSxiKSl9O2cuemI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBLZC5hKGNmLHJiKHRoaXMubmEsYixjKSl9O2cueGI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYn07Zy53Yj1mdW5jdGlvbigpe3JldHVybiB0Yih0aGlzLm5hKX07XG52YXIgZGc9bmV3IGNnKG51bGwsU2YsMCk7ZnVuY3Rpb24gZWcoYSl7YT1FKGEpO2lmKG51bGw9PWEpcmV0dXJuIGJnO2lmKGEgaW5zdGFuY2VvZiBhYyYmMD09PWEucCl7YT1hLmU7YTp7Zm9yKHZhciBiPTAsYz15YihiZyk7OylpZihiPGEubGVuZ3RoKXZhciBkPWIrMSxjPWMuS2EobnVsbCxhW2JdKSxiPWQ7ZWxzZXthPWM7YnJlYWsgYX1hPXZvaWQgMH1yZXR1cm4gYS5PYShudWxsKX1pZih1KWZvcihkPXliKGJnKTs7KWlmKG51bGwhPWEpYj1hLlUobnVsbCksZD1kLkthKG51bGwsYS5RKG51bGwpKSxhPWI7ZWxzZSByZXR1cm4gZC5PYShudWxsKTtlbHNlIHJldHVybiBudWxsfVxudmFyIGZnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBDLmMoRGEsZGcsYSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCksZ2c9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIEMuYyhEYSxuZXcgY2cobnVsbCxXZihhKSwwKSxiKX1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxhKX07YS5kPWI7cmV0dXJuIGF9KCk7XG5mdW5jdGlvbiBoZyhhKXtmb3IodmFyIGI9cWU7OylpZihJKGEpKWI9cGMuYShiLEYoYSkpLGE9SShhKTtlbHNlIHJldHVybiBFKGIpfWZ1bmN0aW9uIGlkKGEpe2lmKGEmJihhLnEmNDA5Nnx8YS5mYykpcmV0dXJuIGEubmFtZTtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIGE7dGhyb3cgRXJyb3IoXCJEb2Vzbid0IHN1cHBvcnQgbmFtZTogXCIrQS5iKGEpKTt9XG52YXIgaWc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4oYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKSk+KGEuYj9hLmIoYyk6YS5jYWxsKG51bGwsYykpP2I6Y312YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrLGwpe3ZhciBuPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYobj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxrLG4pfWZ1bmN0aW9uIGMoYSxkLGUsbCl7cmV0dXJuIEMuYyhmdW5jdGlvbihjLGQpe3JldHVybiBiLmMoYSxjLGQpfSxiLmMoYSxkLGUpLGwpfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgbD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsbCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBlO1xuY2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxiLGUsZik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxmLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTM7Yi5mPWMuZjtiLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYn07Yi5jPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxqZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGYpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGg9RShmKTtyZXR1cm4gaD9NKE1kKGEsaCksYy5jKGEsYixOZChiLGgpKSk6bnVsbH0sbnVsbCxudWxsKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7XG59O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLGxnPWZ1bmN0aW9uIGtnKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZD1FKGMpO3JldHVybiBkP3IoYi5iP2IuYihGKGQpKTpiLmNhbGwobnVsbCxGKGQpKSk/TShGKGQpLGtnKGIsRyhkKSkpOm51bGw6bnVsbH0sbnVsbCxudWxsKX07ZnVuY3Rpb24gbWcoYSxiLGMpe3JldHVybiBmdW5jdGlvbihkKXt2YXIgZT10YihhKTtyZXR1cm4gYi5hP2IuYShlLmE/ZS5hKHNiKGEsZCksYyk6ZS5jYWxsKG51bGwsc2IoYSxkKSxjKSwwKTpiLmNhbGwobnVsbCxlLmE/ZS5hKHNiKGEsZCksYyk6ZS5jYWxsKG51bGwsc2IoYSxkKSxjKSwwKX19XG52YXIgbmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayl7dmFyIGw9cmIoYSxjLCEwKTtpZihyKGwpKXt2YXIgbj1QLmMobCwwLG51bGwpO3JldHVybiBsZyhtZyhhLGgsaykscihtZyhhLGIsYykuY2FsbChudWxsLG4pKT9sOkkobCkpfXJldHVybiBudWxsfWZ1bmN0aW9uIGIoYSxiLGMpe3ZhciBoPW1nKGEsYixjKSxrO2E6e2s9W1VjLFZjXTt2YXIgbD1rLmxlbmd0aDtpZihsPD1aZSlmb3IodmFyIG49MCxxPXliKFllKTs7KWlmKG48bCl2YXIgdD1uKzEscT1CYihxLGtbbl0sbnVsbCksbj10O2Vsc2V7az1uZXcgJGYobnVsbCxBYihxKSxudWxsKTticmVhayBhfWVsc2UgZm9yKG49MCxxPXliKGJnKTs7KWlmKG48bCl0PW4rMSxxPXpiKHEsa1tuXSksbj10O2Vsc2V7az1BYihxKTticmVhayBhfWs9dm9pZCAwfXJldHVybiByKGsuY2FsbChudWxsLGIpKT8oYT1yYihhLGMsITApLHIoYSk/KGI9UC5jKGEsMCxudWxsKSxyKGguYj9oLmIoYik6aC5jYWxsKG51bGwsYikpP2E6XG5JKGEpKTpudWxsKTpsZyhoLHFiKGEsITApKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxjLGUsZik7Y2FzZSA1OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmM9YjtjLnM9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBvZyhhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuc3RhcnQ9Yjt0aGlzLmVuZD1jO3RoaXMuc3RlcD1kO3RoaXMubT1lO3RoaXMuaT0zMjM3NTAwNjt0aGlzLnE9ODE5Mn1nPW9nLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtcbmcuSj1mdW5jdGlvbihhLGIpe2lmKGI8QWEodGhpcykpcmV0dXJuIHRoaXMuc3RhcnQrYip0aGlzLnN0ZXA7aWYodGhpcy5zdGFydD50aGlzLmVuZCYmMD09PXRoaXMuc3RlcClyZXR1cm4gdGhpcy5zdGFydDt0aHJvdyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHNcIik7fTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYjxBYSh0aGlzKT90aGlzLnN0YXJ0K2IqdGhpcy5zdGVwOnRoaXMuc3RhcnQ+dGhpcy5lbmQmJjA9PT10aGlzLnN0ZXA/dGhpcy5zdGFydDpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtcbmcuVT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuc3RlcD90aGlzLnN0YXJ0K3RoaXMuc3RlcDx0aGlzLmVuZD9uZXcgb2codGhpcy5qLHRoaXMuc3RhcnQrdGhpcy5zdGVwLHRoaXMuZW5kLHRoaXMuc3RlcCxudWxsKTpudWxsOnRoaXMuc3RhcnQrdGhpcy5zdGVwPnRoaXMuZW5kP25ldyBvZyh0aGlzLmosdGhpcy5zdGFydCt0aGlzLnN0ZXAsdGhpcy5lbmQsdGhpcy5zdGVwLG51bGwpOm51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiBzYShsYih0aGlzKSk/MDpNYXRoLmNlaWwoKHRoaXMuZW5kLXRoaXMuc3RhcnQpL3RoaXMuc3RlcCl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmModGhpcyxiLGMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09bGIodGhpcyk/bnVsbDp0aGlzLnN0YXJ0fTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9bGIodGhpcyk/bmV3IG9nKHRoaXMuaix0aGlzLnN0YXJ0K3RoaXMuc3RlcCx0aGlzLmVuZCx0aGlzLnN0ZXAsbnVsbCk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5zdGVwP3RoaXMuc3RhcnQ8dGhpcy5lbmQ/dGhpczpudWxsOnRoaXMuc3RhcnQ+dGhpcy5lbmQ/dGhpczpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IG9nKGIsdGhpcy5zdGFydCx0aGlzLmVuZCx0aGlzLnN0ZXAsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG52YXIgcGc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gbmV3IG9nKG51bGwsYSxiLGMsbnVsbCl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBlLmMoYSxiLDEpfWZ1bmN0aW9uIGMoYSl7cmV0dXJuIGUuYygwLGEsMSl9ZnVuY3Rpb24gZCgpe3JldHVybiBlLmMoMCxOdW1iZXIuTUFYX1ZBTFVFLDEpfXZhciBlPW51bGwsZT1mdW5jdGlvbihlLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gZC5jYWxsKHRoaXMpO2Nhc2UgMTpyZXR1cm4gYy5jYWxsKHRoaXMsZSk7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxlLGgpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsZSxoLGspfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtlLm89ZDtlLmI9YztlLmE9YjtlLmM9YTtyZXR1cm4gZX0oKSxxZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtmb3IoOzspaWYoRShiKSYmMDxhKXt2YXIgYz1hLTEsaD1cbkkoYik7YT1jO2I9aH1lbHNlIHJldHVybiBudWxsfWZ1bmN0aW9uIGIoYSl7Zm9yKDs7KWlmKEUoYSkpYT1JKGEpO2Vsc2UgcmV0dXJuIG51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxyZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtxZy5hKGEsYik7cmV0dXJuIGJ9ZnVuY3Rpb24gYihhKXtxZy5iKGEpO3JldHVybiBhfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO1xufTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBzZyhhLGIpe2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYil7dmFyIGM9YS5leGVjKGIpO3JldHVybiBXYi5hKEYoYyksYik/MT09PU8oYyk/RihjKTp3ZShjKTpudWxsfXRocm93IG5ldyBUeXBlRXJyb3IoXCJyZS1tYXRjaGVzIG11c3QgbWF0Y2ggYWdhaW5zdCBhIHN0cmluZy5cIik7fWZ1bmN0aW9uIHRnKGEpe3ZhciBiO2I9L14oPzpcXChcXD8oW2lkbXN1eF0qKVxcKSk/KC4qKS87aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKWE9Yi5leGVjKGEpLGI9bnVsbD09YT9udWxsOjE9PT1PKGEpP0YoYSk6d2UoYSk7ZWxzZSB0aHJvdyBuZXcgVHlwZUVycm9yKFwicmUtZmluZCBtdXN0IG1hdGNoIGFnYWluc3QgYSBzdHJpbmcuXCIpO1AuYyhiLDAsbnVsbCk7YT1QLmMoYiwxLG51bGwpO2I9UC5jKGIsMixudWxsKTtyZXR1cm4gbmV3IFJlZ0V4cChiLGEpfVxuZnVuY3Rpb24gdWcoYSxiLGMsZCxlLGYsaCl7dmFyIGs9amE7dHJ5e2phPW51bGw9PWphP251bGw6amEtMTtpZihudWxsIT1qYSYmMD5qYSlyZXR1cm4gdWIoYSxcIiNcIik7dWIoYSxjKTtFKGgpJiYoYi5jP2IuYyhGKGgpLGEsZik6Yi5jYWxsKG51bGwsRihoKSxhLGYpKTtmb3IodmFyIGw9SShoKSxuPXJhLmIoZiktMTs7KWlmKCFsfHxudWxsIT1uJiYwPT09bil7RShsKSYmMD09PW4mJih1YihhLGQpLHViKGEsXCIuLi5cIikpO2JyZWFrfWVsc2V7dWIoYSxkKTtiLmM/Yi5jKEYobCksYSxmKTpiLmNhbGwobnVsbCxGKGwpLGEsZik7dmFyIHE9SShsKTtjPW4tMTtsPXE7bj1jfXJldHVybiB1YihhLGUpfWZpbmFsbHl7amE9a319XG52YXIgdmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsYil7Zm9yKHZhciBlPUUoYiksZj1udWxsLGg9MCxrPTA7OylpZihrPGgpe3ZhciBsPWYuSihudWxsLGspO3ViKGEsbCk7ays9MX1lbHNlIGlmKGU9RShlKSlmPWUsSWMoZik/KGU9SGIoZiksaD1JYihmKSxmPWUsbD1PKGUpLGU9aCxoPWwpOihsPUYoZiksdWIoYSxsKSxlPUkoZiksZj1udWxsLGg9MCksaz0wO2Vsc2UgcmV0dXJuIG51bGx9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpLHdnPXsnXCInOidcXFxcXCInLFwiXFxcXFwiOlwiXFxcXFxcXFxcIixcIlxcYlwiOlwiXFxcXGJcIixcIlxcZlwiOlwiXFxcXGZcIixcIlxcblwiOlwiXFxcXG5cIixcIlxcclwiOlwiXFxcXHJcIixcIlxcdFwiOlwiXFxcXHRcIn07XG5mdW5jdGlvbiB4ZyhhKXtyZXR1cm4nXCInK0EuYihhLnJlcGxhY2UoUmVnRXhwKCdbXFxcXFxcXFxcIlxcYlxcZlxcblxcclxcdF0nLFwiZ1wiKSxmdW5jdGlvbihhKXtyZXR1cm4gd2dbYV19KSkrJ1wiJ31cbnZhciBBZz1mdW5jdGlvbiB5ZyhiLGMsZCl7aWYobnVsbD09YilyZXR1cm4gdWIoYyxcIm5pbFwiKTtpZih2b2lkIDA9PT1iKXJldHVybiB1YihjLFwiI1xceDNjdW5kZWZpbmVkXFx4M2VcIik7aWYodSl7cihmdW5jdGlvbigpe3ZhciBjPVEuYShkLHBhKTtyZXR1cm4gcihjKT8oYz1iP2IuaSYxMzEwNzJ8fGIuZWM/ITA6Yi5pPyExOnMoYmIsYik6cyhiYixiKSk/eGMoYik6YzpjfSgpKSYmKHViKGMsXCJeXCIpLHlnKHhjKGIpLGMsZCksdWIoYyxcIiBcIikpO2lmKG51bGw9PWIpcmV0dXJuIHViKGMsXCJuaWxcIik7aWYoYi5EYilyZXR1cm4gYi5UYihiLGMsZCk7aWYoYiYmKGIuaSYyMTQ3NDgzNjQ4fHxiLkspKXJldHVybiBiLncobnVsbCxjLGQpO2lmKHRhKGIpPT09Qm9vbGVhbnx8XCJudW1iZXJcIj09PXR5cGVvZiBiKXJldHVybiB1YihjLFwiXCIrQS5iKGIpKTtpZihudWxsIT1iJiZiLmNvbnN0cnVjdG9yPT09T2JqZWN0KXJldHVybiB1YihjLFwiI2pzIFwiKSx6Zy5uP3pnLm4oS2QuYShmdW5jdGlvbihjKXtyZXR1cm4gbmV3IFcobnVsbCxcbjIsNSxYLFtqZC5iKGMpLGJbY11dLG51bGwpfSxKYyhiKSkseWcsYyxkKTp6Zy5jYWxsKG51bGwsS2QuYShmdW5jdGlvbihjKXtyZXR1cm4gbmV3IFcobnVsbCwyLDUsWCxbamQuYihjKSxiW2NdXSxudWxsKX0sSmMoYikpLHlnLGMsZCk7aWYoYiBpbnN0YW5jZW9mIEFycmF5KXJldHVybiB1ZyhjLHlnLFwiI2pzIFtcIixcIiBcIixcIl1cIixkLGIpO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBiKXJldHVybiByKG9hLmIoZCkpP3ViKGMseGcoYikpOnViKGMsYik7aWYodWMoYikpcmV0dXJuIHZnLmQoYyxKKFtcIiNcXHgzY1wiLFwiXCIrQS5iKGIpLFwiXFx4M2VcIl0sMCkpO2lmKGIgaW5zdGFuY2VvZiBEYXRlKXt2YXIgZT1mdW5jdGlvbihiLGMpe2Zvcih2YXIgZD1cIlwiK0EuYihiKTs7KWlmKE8oZCk8YylkPVwiMFwiK0EuYihkKTtlbHNlIHJldHVybiBkfTtyZXR1cm4gdmcuZChjLEooWycjaW5zdCBcIicsXCJcIitBLmIoYi5nZXRVVENGdWxsWWVhcigpKSxcIi1cIixlKGIuZ2V0VVRDTW9udGgoKSsxLDIpLFwiLVwiLGUoYi5nZXRVVENEYXRlKCksXG4yKSxcIlRcIixlKGIuZ2V0VVRDSG91cnMoKSwyKSxcIjpcIixlKGIuZ2V0VVRDTWludXRlcygpLDIpLFwiOlwiLGUoYi5nZXRVVENTZWNvbmRzKCksMiksXCIuXCIsZShiLmdldFVUQ01pbGxpc2Vjb25kcygpLDMpLFwiLVwiLCcwMDowMFwiJ10sMCkpfXJldHVybiBiIGluc3RhbmNlb2YgUmVnRXhwP3ZnLmQoYyxKKFsnI1wiJyxiLnNvdXJjZSwnXCInXSwwKSk6KGI/Yi5pJjIxNDc0ODM2NDh8fGIuS3x8KGIuaT8wOnModmIsYikpOnModmIsYikpP3diKGIsYyxkKTp1P3ZnLmQoYyxKKFtcIiNcXHgzY1wiLFwiXCIrQS5iKGIpLFwiXFx4M2VcIl0sMCkpOm51bGx9cmV0dXJuIG51bGx9O1xuZnVuY3Rpb24gQmcoYSxiKXt2YXIgYz1uZXcgZWE7YTp7dmFyIGQ9bmV3IEtiKGMpO0FnKEYoYSksZCxiKTtmb3IodmFyIGU9RShJKGEpKSxmPW51bGwsaD0wLGs9MDs7KWlmKGs8aCl7dmFyIGw9Zi5KKG51bGwsayk7dWIoZCxcIiBcIik7QWcobCxkLGIpO2srPTF9ZWxzZSBpZihlPUUoZSkpZj1lLEljKGYpPyhlPUhiKGYpLGg9SWIoZiksZj1lLGw9TyhlKSxlPWgsaD1sKToobD1GKGYpLHViKGQsXCIgXCIpLEFnKGwsZCxiKSxlPUkoZiksZj1udWxsLGg9MCksaz0wO2Vsc2UgYnJlYWsgYX1yZXR1cm4gY31cbnZhciBDZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXt2YXIgYj1rYSgpO3JldHVybiBCYyhhKT9cIlwiOlwiXCIrQS5iKEJnKGEsYikpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIHpnKGEsYixjLGQpe3JldHVybiB1ZyhjLGZ1bmN0aW9uKGEsYyxkKXtiLmM/Yi5jKFRhKGEpLGMsZCk6Yi5jYWxsKG51bGwsVGEoYSksYyxkKTt1YihjLFwiIFwiKTtyZXR1cm4gYi5jP2IuYyhVYShhKSxjLGQpOmIuY2FsbChudWxsLFVhKGEpLGMsZCl9LFwie1wiLFwiLCBcIixcIn1cIixkLEUoYSkpfWFjLnByb3RvdHlwZS5LPSEwO1xuYWMucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1YucHJvdG90eXBlLks9ITA7Vi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07QmYucHJvdG90eXBlLks9ITA7QmYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O3ZmLnByb3RvdHlwZS5LPSEwO3ZmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTskLnByb3RvdHlwZS5LPSEwOyQucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiW1wiLFwiIFwiLFwiXVwiLGMsdGhpcyl9O1VlLnByb3RvdHlwZS5LPSEwO1VlLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtcbmNnLnByb3RvdHlwZS5LPSEwO2NnLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIiN7XCIsXCIgXCIsXCJ9XCIsYyx0aGlzKX07eWUucHJvdG90eXBlLks9ITA7eWUucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O2dkLnByb3RvdHlwZS5LPSEwO2dkLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtrYy5wcm90b3R5cGUuSz0hMDtrYy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07eGYucHJvdG90eXBlLks9ITA7eGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB6Zyh0aGlzLEFnLGIsYyl9O3dmLnByb3RvdHlwZS5LPSEwO3dmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtcbkFlLnByb3RvdHlwZS5LPSEwO0FlLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIltcIixcIiBcIixcIl1cIixjLHRoaXMpfTtRZi5wcm90b3R5cGUuSz0hMDtRZi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHpnKHRoaXMsQWcsYixjKX07JGYucHJvdG90eXBlLks9ITA7JGYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiI3tcIixcIiBcIixcIn1cIixjLHRoaXMpfTtvZC5wcm90b3R5cGUuSz0hMDtvZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07WWYucHJvdG90eXBlLks9ITA7WWYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1kucHJvdG90eXBlLks9ITA7WS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCJbXCIsXCIgXCIsXCJdXCIsYyx0aGlzKX07XG5XLnByb3RvdHlwZS5LPSEwO1cucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiW1wiLFwiIFwiLFwiXVwiLGMsdGhpcyl9O0hlLnByb3RvdHlwZS5LPSEwO0hlLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtjZC5wcm90b3R5cGUuSz0hMDtjZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIpe3JldHVybiB1YihiLFwiKClcIil9O0llLnByb3RvdHlwZS5LPSEwO0llLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIiNxdWV1ZSBbXCIsXCIgXCIsXCJdXCIsYyxFKHRoaXMpKX07bGEucHJvdG90eXBlLks9ITA7bGEucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB6Zyh0aGlzLEFnLGIsYyl9O29nLnByb3RvdHlwZS5LPSEwO29nLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtcblhmLnByb3RvdHlwZS5LPSEwO1hmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtiZC5wcm90b3R5cGUuSz0hMDtiZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07Vy5wcm90b3R5cGUubGI9ITA7Vy5wcm90b3R5cGUubWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUGMuYSh0aGlzLGIpfTtBZS5wcm90b3R5cGUubGI9ITA7QWUucHJvdG90eXBlLm1iPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFBjLmEodGhpcyxiKX07VC5wcm90b3R5cGUubGI9ITA7VC5wcm90b3R5cGUubWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gVmIodGhpcyxiKX07WmIucHJvdG90eXBlLmxiPSEwO1piLnByb3RvdHlwZS5tYj1mdW5jdGlvbihhLGIpe3JldHVybiBWYih0aGlzLGIpfTtcbmZ1bmN0aW9uIERnKGEsYil7aWYoYT9hLmdjOmEpcmV0dXJuIGEuZ2MoYSxiKTt2YXIgYztjPURnW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9RGcuXywhYykpdGhyb3cgeChcIklSZXNldC4tcmVzZXQhXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG52YXIgRWc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsZSl7aWYoYT9hLm5jOmEpcmV0dXJuIGEubmMoYSxiLGMsZCxlKTt2YXIgcTtxPUVnW20obnVsbD09YT9udWxsOmEpXTtpZighcSYmKHE9RWcuXywhcSkpdGhyb3cgeChcIklTd2FwLi1zd2FwIVwiLGEpO3JldHVybiBxLmNhbGwobnVsbCxhLGIsYyxkLGUpfWZ1bmN0aW9uIGIoYSxiLGMsZCl7aWYoYT9hLm1jOmEpcmV0dXJuIGEubWMoYSxiLGMsZCk7dmFyIGU7ZT1FZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWUmJihlPUVnLl8sIWUpKXRocm93IHgoXCJJU3dhcC4tc3dhcCFcIixhKTtyZXR1cm4gZS5jYWxsKG51bGwsYSxiLGMsZCl9ZnVuY3Rpb24gYyhhLGIsYyl7aWYoYT9hLmxjOmEpcmV0dXJuIGEubGMoYSxiLGMpO3ZhciBkO2Q9RWdbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1FZy5fLCFkKSl0aHJvdyB4KFwiSVN3YXAuLXN3YXAhXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBkKGEsYil7aWYoYT9cbmEua2M6YSlyZXR1cm4gYS5rYyhhLGIpO3ZhciBjO2M9RWdbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1FZy5fLCFjKSl0aHJvdyB4KFwiSVN3YXAuLXN3YXAhXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGU9bnVsbCxlPWZ1bmN0aW9uKGUsaCxrLGwsbil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gZC5jYWxsKHRoaXMsZSxoKTtjYXNlIDM6cmV0dXJuIGMuY2FsbCh0aGlzLGUsaCxrKTtjYXNlIDQ6cmV0dXJuIGIuY2FsbCh0aGlzLGUsaCxrLGwpO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsZSxoLGssbCxuKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZS5hPWQ7ZS5jPWM7ZS5uPWI7ZS5zPWE7cmV0dXJuIGV9KCk7ZnVuY3Rpb24gRmcoYSxiLGMsZCl7dGhpcy5zdGF0ZT1hO3RoaXMuaj1iO3RoaXMud2M9Yzt0aGlzLldiPWQ7dGhpcy5pPTIxNTM5Mzg5NDQ7dGhpcy5xPTE2Mzg2fWc9RmcucHJvdG90eXBlO1xuZy5CPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbYmFdfHwodGhpc1tiYV09KytjYSl9O2cuUmI9ZnVuY3Rpb24oYSxiLGMpe2E9RSh0aGlzLldiKTtmb3IodmFyIGQ9bnVsbCxlPTAsZj0wOzspaWYoZjxlKXt2YXIgaD1kLkoobnVsbCxmKSxrPVAuYyhoLDAsbnVsbCksaD1QLmMoaCwxLG51bGwpO2gubj9oLm4oayx0aGlzLGIsYyk6aC5jYWxsKG51bGwsayx0aGlzLGIsYyk7Zis9MX1lbHNlIGlmKGE9RShhKSlJYyhhKT8oZD1IYihhKSxhPUliKGEpLGs9ZCxlPU8oZCksZD1rKTooZD1GKGEpLGs9UC5jKGQsMCxudWxsKSxoPVAuYyhkLDEsbnVsbCksaC5uP2gubihrLHRoaXMsYixjKTpoLmNhbGwobnVsbCxrLHRoaXMsYixjKSxhPUkoYSksZD1udWxsLGU9MCksZj0wO2Vsc2UgcmV0dXJuIG51bGx9O2cudz1mdW5jdGlvbihhLGIsYyl7dWIoYixcIiNcXHgzY0F0b206IFwiKTtBZyh0aGlzLnN0YXRlLGIsYyk7cmV0dXJuIHViKGIsXCJcXHgzZVwiKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07XG5nLnViPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGV9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzPT09Yn07XG52YXIgSGc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBuZXcgRmcoYSxudWxsLG51bGwsbnVsbCl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQpe3ZhciBrPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsayl9ZnVuY3Rpb24gYihhLGMpe3ZhciBkPU1jKGMpP1MuYShUZixjKTpjLGU9US5hKGQsR2cpLGQ9US5hKGQscGEpO3JldHVybiBuZXcgRmcoYSxkLGUsbnVsbCl9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBhLmNhbGwodGhpcyxiKTtkZWZhdWx0OnJldHVybiBjLmQoYixKKGFyZ3VtZW50cywxKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIitcbmFyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTE7Yi5mPWMuZjtiLmI9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIElnKGEsYil7aWYoYSBpbnN0YW5jZW9mIEZnKXt2YXIgYz1hLndjO2lmKG51bGwhPWMmJiFyKGMuYj9jLmIoYik6Yy5jYWxsKG51bGwsYikpKXRocm93IEVycm9yKFwiQXNzZXJ0IGZhaWxlZDogVmFsaWRhdG9yIHJlamVjdGVkIHJlZmVyZW5jZSBzdGF0ZVxcblwiK0EuYihDZy5kKEooW2ZkKG5ldyBaYihudWxsLFwidmFsaWRhdGVcIixcInZhbGlkYXRlXCIsMTQzOTIzMDcwMCxudWxsKSxuZXcgWmIobnVsbCxcIm5ldy12YWx1ZVwiLFwibmV3LXZhbHVlXCIsLTE1NjczOTc0MDEsbnVsbCkpXSwwKSkpKTtjPWEuc3RhdGU7YS5zdGF0ZT1iO251bGwhPWEuV2ImJnhiKGEsYyxiKTtyZXR1cm4gYn1yZXR1cm4gRGcoYSxiKX1mdW5jdGlvbiBLKGEpe3JldHVybiBhYihhKX1cbnZhciBKZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsZCl7cmV0dXJuIGEgaW5zdGFuY2VvZiBGZz9JZyhhLGIuYz9iLmMoYS5zdGF0ZSxjLGQpOmIuY2FsbChudWxsLGEuc3RhdGUsYyxkKSk6RWcubihhLGIsYyxkKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gYSBpbnN0YW5jZW9mIEZnP0lnKGEsYi5hP2IuYShhLnN0YXRlLGMpOmIuY2FsbChudWxsLGEuc3RhdGUsYykpOkVnLmMoYSxiLGMpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gYSBpbnN0YW5jZW9mIEZnP0lnKGEsYi5iP2IuYihhLnN0YXRlKTpiLmNhbGwobnVsbCxhLnN0YXRlKSk6RWcuYShhLGIpfXZhciBkPW51bGwsZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsZix0KXt2YXIgdj1udWxsOzQ8YXJndW1lbnRzLmxlbmd0aCYmKHY9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLHYpfWZ1bmN0aW9uIGIoYSxjLGQsZSxmKXtyZXR1cm4gYSBpbnN0YW5jZW9mXG5GZz9JZyhhLFMucyhjLGEuc3RhdGUsZCxlLGYpKTpFZy5zKGEsYyxkLGUsZil9YS5rPTQ7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBmPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsYSl9O2EuZD1iO3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oZCxoLGssbCxuKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGgpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxoLGspO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxoLGssbCk7ZGVmYXVsdDpyZXR1cm4gZS5kKGQsaCxrLGwsSihhcmd1bWVudHMsNCkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9NDtkLmY9ZS5mO2QuYT1jO2QuYz1iO2Qubj1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksS2c9e307XG5mdW5jdGlvbiBMZyhhKXtpZihhP2EuYWM6YSlyZXR1cm4gYS5hYyhhKTt2YXIgYjtiPUxnW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9TGcuXywhYikpdGhyb3cgeChcIklFbmNvZGVKUy4tY2xqLVxceDNlanNcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gTWcoYSl7cmV0dXJuKGE/cihyKG51bGwpP251bGw6YS4kYil8fChhLkNiPzA6cyhLZyxhKSk6cyhLZyxhKSk/TGcoYSk6XCJzdHJpbmdcIj09PXR5cGVvZiBhfHxcIm51bWJlclwiPT09dHlwZW9mIGF8fGEgaW5zdGFuY2VvZiBUfHxhIGluc3RhbmNlb2YgWmI/TmcuYj9OZy5iKGEpOk5nLmNhbGwobnVsbCxhKTpDZy5kKEooW2FdLDApKX1cbnZhciBOZz1mdW5jdGlvbiBPZyhiKXtpZihudWxsPT1iKXJldHVybiBudWxsO2lmKGI/cihyKG51bGwpP251bGw6Yi4kYil8fChiLkNiPzA6cyhLZyxiKSk6cyhLZyxiKSlyZXR1cm4gTGcoYik7aWYoYiBpbnN0YW5jZW9mIFQpcmV0dXJuIGlkKGIpO2lmKGIgaW5zdGFuY2VvZiBaYilyZXR1cm5cIlwiK0EuYihiKTtpZihHYyhiKSl7dmFyIGM9e307Yj1FKGIpO2Zvcih2YXIgZD1udWxsLGU9MCxmPTA7OylpZihmPGUpe3ZhciBoPWQuSihudWxsLGYpLGs9UC5jKGgsMCxudWxsKSxoPVAuYyhoLDEsbnVsbCk7Y1tNZyhrKV09T2coaCk7Zis9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oZT1IYihiKSxiPUliKGIpLGQ9ZSxlPU8oZSkpOihlPUYoYiksZD1QLmMoZSwwLG51bGwpLGU9UC5jKGUsMSxudWxsKSxjW01nKGQpXT1PZyhlKSxiPUkoYiksZD1udWxsLGU9MCksZj0wO2Vsc2UgYnJlYWs7cmV0dXJuIGN9aWYoQ2MoYikpe2M9W107Yj1FKEtkLmEoT2csYikpO2Q9bnVsbDtmb3IoZj1lPTA7OylpZihmPFxuZSlrPWQuSihudWxsLGYpLGMucHVzaChrKSxmKz0xO2Vsc2UgaWYoYj1FKGIpKWQ9YixJYyhkKT8oYj1IYihkKSxmPUliKGQpLGQ9YixlPU8oYiksYj1mKTooYj1GKGQpLGMucHVzaChiKSxiPUkoZCksZD1udWxsLGU9MCksZj0wO2Vsc2UgYnJlYWs7cmV0dXJuIGN9cmV0dXJuIHU/YjpudWxsfSxQZz17fTtmdW5jdGlvbiBRZyhhLGIpe2lmKGE/YS5aYjphKXJldHVybiBhLlpiKGEsYik7dmFyIGM7Yz1RZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPVFnLl8sIWMpKXRocm93IHgoXCJJRW5jb2RlQ2xvanVyZS4tanMtXFx4M2VjbGpcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbnZhciBTZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIGIuZChhLEooW25ldyBsYShudWxsLDEsW1JnLCExXSxudWxsKV0sMCkpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkKXt2YXIgaz1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGspfWZ1bmN0aW9uIGIoYSxjKXtpZihhP3IocihudWxsKT9udWxsOmEuQ2MpfHwoYS5DYj8wOnMoUGcsYSkpOnMoUGcsYSkpcmV0dXJuIFFnKGEsUy5hKFVmLGMpKTtpZihFKGMpKXt2YXIgZD1NYyhjKT9TLmEoVGYsYyk6YyxlPVEuYShkLFJnKTtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uIHkoZSl7cmV0dXJuIE1jKGUpP3JnLmIoS2QuYSh5LGUpKTpDYyhlKT9ZZChxYyhlKSxLZC5hKHksZSkpOmUgaW5zdGFuY2VvZiBBcnJheT93ZShLZC5hKHksZSkpOnRhKGUpPT09XG5PYmplY3Q/WWQoWWUsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uIFJhKGYpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbigpe2Zvcig7Oyl7dmFyIGE9RShmKTtpZihhKXtpZihJYyhhKSl7dmFyIGI9SGIoYSksYz1PKGIpLGg9bmV3IGxkKEFycmF5KGMpLDApO2E6e2Zvcih2YXIgaz0wOzspaWYoazxjKXt2YXIgbD1ELmEoYixrKSxsPW5ldyBXKG51bGwsMiw1LFgsW2QuYj9kLmIobCk6ZC5jYWxsKG51bGwsbCkseShlW2xdKV0sbnVsbCk7aC5hZGQobCk7ays9MX1lbHNle2I9ITA7YnJlYWsgYX1iPXZvaWQgMH1yZXR1cm4gYj9wZChoLmRhKCksUmEoSWIoYSkpKTpwZChoLmRhKCksbnVsbCl9aD1GKGEpO3JldHVybiBNKG5ldyBXKG51bGwsMiw1LFgsW2QuYj9kLmIoaCk6ZC5jYWxsKG51bGwsaCkseShlW2hdKV0sbnVsbCksUmEoRyhhKSkpfXJldHVybiBudWxsfX19KGEsYixjLGQpLG51bGwsXG5udWxsKX19KGEsYixjLGQpKEpjKGUpKX0oKSk6dT9lOm51bGx9fShjLGQsZSxyKGUpP2pkOkEpKGEpfXJldHVybiBudWxsfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYS5jYWxsKHRoaXMsYik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsSihhcmd1bWVudHMsMSkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MTtiLmY9Yy5mO2IuYj1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gVGcoYSl7dGhpcy5wYj1hO3RoaXMucT0wO3RoaXMuaT0yMTUzNzc1MTA0fVxuVGcucHJvdG90eXBlLkI9ZnVuY3Rpb24oKXtmb3IodmFyIGE9Q2cuZChKKFt0aGlzXSwwKSksYj0wLGM9MDtjPGEubGVuZ3RoOysrYyliPTMxKmIrYS5jaGFyQ29kZUF0KGMpLGIlPTQyOTQ5NjcyOTY7cmV0dXJuIGJ9O1RnLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHViKGIsJyN1dWlkIFwiJytBLmIodGhpcy5wYikrJ1wiJyl9O1RnLnByb3RvdHlwZS52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIgaW5zdGFuY2VvZiBUZyYmdGhpcy5wYj09PWIucGJ9O1RnLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBifTt2YXIgVWc9bmV3IFQobnVsbCxcInBwYXRoXCIsXCJwcGF0aFwiKSxWZz1uZXcgVChcInppcFwiLFwiYnJhbmNoP1wiLFwiemlwL2JyYW5jaD9cIiksV2c9bmV3IFQobnVsbCxcInJcIixcInJcIiksWGc9bmV3IFQoXCJ6aXBcIixcImNoaWxkcmVuXCIsXCJ6aXAvY2hpbGRyZW5cIikscGE9bmV3IFQobnVsbCxcIm1ldGFcIixcIm1ldGFcIikscWE9bmV3IFQobnVsbCxcImR1cFwiLFwiZHVwXCIpLHU9bmV3IFQobnVsbCxcImVsc2VcIixcImVsc2VcIiksR2c9bmV3IFQobnVsbCxcInZhbGlkYXRvclwiLFwidmFsaWRhdG9yXCIpLFliPW5ldyBUKG51bGwsXCJkZWZhdWx0XCIsXCJkZWZhdWx0XCIpLFlnPW5ldyBUKG51bGwsXCJzZXF1ZW50aWFsXCIsXCJzZXF1ZW50aWFsXCIpLG1hPW5ldyBUKG51bGwsXCJmbHVzaC1vbi1uZXdsaW5lXCIsXCJmbHVzaC1vbi1uZXdsaW5lXCIpLFpnPW5ldyBUKG51bGwsXCJsXCIsXCJsXCIpLCRnPW5ldyBUKFwiemlwXCIsXCJtYWtlLW5vZGVcIixcInppcC9tYWtlLW5vZGVcIiksb2E9bmV3IFQobnVsbCxcInJlYWRhYmx5XCIsXCJyZWFkYWJseVwiKSxyYT1uZXcgVChudWxsLFxuXCJwcmludC1sZW5ndGhcIixcInByaW50LWxlbmd0aFwiKSxhaD1uZXcgVChudWxsLFwicG5vZGVzXCIsXCJwbm9kZXNcIiksYmg9bmV3IFQobnVsbCxcImNoYW5nZWQ/XCIsXCJjaGFuZ2VkP1wiKSxjaD1uZXcgVChudWxsLFwidGFnXCIsXCJ0YWdcIiksZGg9bmV3IFQobnVsbCxcInNldFwiLFwic2V0XCIpLGVoPW5ldyBUKG51bGwsXCJlbmRcIixcImVuZFwiKSxmaD1uZXcgVChudWxsLFwiYXRvbVwiLFwiYXRvbVwiKSxSZz1uZXcgVChudWxsLFwia2V5d29yZGl6ZS1rZXlzXCIsXCJrZXl3b3JkaXplLWtleXNcIiksZ2g9bmV3IFQobnVsbCxcIm1hcFwiLFwibWFwXCIpLGhoPW5ldyBUKFwibW9yaVwiLFwibm90LWZvdW5kXCIsXCJtb3JpL25vdC1mb3VuZFwiKSxpaD1uZXcgVChcImNsanMuY29yZVwiLFwibm90LWZvdW5kXCIsXCJjbGpzLmNvcmUvbm90LWZvdW5kXCIpO3ZhciBqaCxraDtmdW5jdGlvbiBsaChhKXtyZXR1cm4gYS5vP2EubygpOmEuY2FsbChudWxsKX1mdW5jdGlvbiBtaChhKXtyZXR1cm4gYS5vP2EubygpOmEuY2FsbChudWxsKX12YXIgbmg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gR2MoYyk/aGIoYyxhLGIpOm51bGw9PWM/YjpjIGluc3RhbmNlb2YgQXJyYXk/aGMuYyhjLGEsYik6dT9nYi5jKGMsYSxiKTpudWxsfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYy5jKGEsYS5vP2EubygpOmEuY2FsbChudWxsKSxiKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gb2goYSxiLGMsZCl7aWYoYT9hLkViOmEpcmV0dXJuIGEuRWIoYSxiLGMsZCk7dmFyIGU7ZT1vaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWUmJihlPW9oLl8sIWUpKXRocm93IHgoXCJDb2xsRm9sZC5jb2xsLWZvbGRcIixhKTtyZXR1cm4gZS5jYWxsKG51bGwsYSxiLGMsZCl9XG52YXIgcWg9ZnVuY3Rpb24gcGgoYixjKXtcInVuZGVmaW5lZFwiPT09dHlwZW9mIGpoJiYoamg9ZnVuY3Rpb24oYixjLGYsaCl7dGhpcy4kPWI7dGhpcy5RYT1jO3RoaXMudWM9Zjt0aGlzLnNjPWg7dGhpcy5xPTA7dGhpcy5pPTkxNzUwNH0samguRGI9ITAsamguQmI9XCJjbG9qdXJlLmNvcmUucmVkdWNlcnMvdDYzMjJcIixqaC5UYj1mdW5jdGlvbihiLGMpe3JldHVybiB1YihjLFwiY2xvanVyZS5jb3JlLnJlZHVjZXJzL3Q2MzIyXCIpfSxqaC5wcm90b3R5cGUuTj1mdW5jdGlvbihiLGMpe3JldHVybiBnYi5jKHRoaXMsYyxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKX0samgucHJvdG90eXBlLk09ZnVuY3Rpb24oYixjLGYpe3JldHVybiBnYi5jKHRoaXMuUWEsdGhpcy4kLmI/dGhpcy4kLmIoYyk6dGhpcy4kLmNhbGwobnVsbCxjKSxmKX0samgucHJvdG90eXBlLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY30samgucHJvdG90eXBlLkY9ZnVuY3Rpb24oYixjKXtyZXR1cm4gbmV3IGpoKHRoaXMuJCxcbnRoaXMuUWEsdGhpcy51YyxjKX0pO3JldHVybiBuZXcgamgoYyxiLHBoLG51bGwpfSxzaD1mdW5jdGlvbiByaChiLGMpe1widW5kZWZpbmVkXCI9PT10eXBlb2Yga2gmJihraD1mdW5jdGlvbihiLGMsZixoKXt0aGlzLiQ9Yjt0aGlzLlFhPWM7dGhpcy5yYz1mO3RoaXMudGM9aDt0aGlzLnE9MDt0aGlzLmk9OTE3NTA0fSxraC5EYj0hMCxraC5CYj1cImNsb2p1cmUuY29yZS5yZWR1Y2Vycy90NjMyOFwiLGtoLlRiPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIHViKGMsXCJjbG9qdXJlLmNvcmUucmVkdWNlcnMvdDYzMjhcIil9LGtoLnByb3RvdHlwZS5FYj1mdW5jdGlvbihiLGMsZixoKXtyZXR1cm4gb2godGhpcy5RYSxjLGYsdGhpcy4kLmI/dGhpcy4kLmIoaCk6dGhpcy4kLmNhbGwobnVsbCxoKSl9LGtoLnByb3RvdHlwZS5OPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGdiLmModGhpcy5RYSx0aGlzLiQuYj90aGlzLiQuYihjKTp0aGlzLiQuY2FsbChudWxsLGMpLGMubz9jLm8oKTpjLmNhbGwobnVsbCkpfSxcbmtoLnByb3RvdHlwZS5NPWZ1bmN0aW9uKGIsYyxmKXtyZXR1cm4gZ2IuYyh0aGlzLlFhLHRoaXMuJC5iP3RoaXMuJC5iKGMpOnRoaXMuJC5jYWxsKG51bGwsYyksZil9LGtoLnByb3RvdHlwZS5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGN9LGtoLnByb3RvdHlwZS5GPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIG5ldyBraCh0aGlzLiQsdGhpcy5RYSx0aGlzLnJjLGMpfSk7cmV0dXJuIG5ldyBraChjLGIscmgsbnVsbCl9LHRoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBzaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGw7cmV0dXJuIGM9ZnVuY3Rpb24oYyxlLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiBiLmE/Yi5hKGMsYS5iP2EuYihlKTphLmNhbGwobnVsbCxlKSk6Yi5jYWxsKG51bGwsYyxhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKTtjYXNlIDM6cmV0dXJuIGIuYT9cbmIuYShjLGEuYT9hLmEoZSxoKTphLmNhbGwobnVsbCxlLGgpKTpiLmNhbGwobnVsbCxjLGEuYT9hLmEoZSxoKTphLmNhbGwobnVsbCxlLGgpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksdWg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIHNoKGIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbDtyZXR1cm4gYz1mdW5jdGlvbihjLGUsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5vP1xuYi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gcihhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKT9iLmE/Yi5hKGMsZSk6Yi5jYWxsKG51bGwsYyxlKTpjO2Nhc2UgMzpyZXR1cm4gcihhLmE/YS5hKGUsaCk6YS5jYWxsKG51bGwsZSxoKSk/Yi5jP2IuYyhjLGUsaCk6Yi5jYWxsKG51bGwsYyxlLGgpOmN9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHZoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gc2goYSxcbmZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe3ZhciBiPW51bGw7cmV0dXJuIGI9ZnVuY3Rpb24oYixkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBhLm8/YS5vKCk6YS5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gRmMoZCk/Yy5iKGQpLk0obnVsbCxhLGIpOmEuYT9hLmEoYixkKTphLmNhbGwobnVsbCxiLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0pfWZ1bmN0aW9uIGIoKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGMuYihhKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIuY2FsbCh0aGlzKTtjYXNlIDE6cmV0dXJuIGEuY2FsbCh0aGlzLGMpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLm89YjtjLmI9YTtyZXR1cm4gY30oKSx3aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxcbmIpe3JldHVybiB1aC5hKEdkKGEpLGIpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx4aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gcWgoYixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPWZ1bmN0aW9uKGMsZSxoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gcihhLmI/YS5iKGUpOmEuY2FsbChudWxsLGUpKT9iLmE/Yi5hKGMsZSk6Yi5jYWxsKG51bGwsYyxlKTpcbm5ldyBlYyhjKTtjYXNlIDM6cmV0dXJuIHIoYS5hP2EuYShlLGgpOmEuY2FsbChudWxsLGUsaCkpP2IuYz9iLmMoYyxlLGgpOmIuY2FsbChudWxsLGMsZSxoKTpuZXcgZWMoYyl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHloPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBxaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPVxuZnVuY3Rpb24oYyxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Y2FzZSAyOnJldHVybiBKZy5hKGEsV2MpLDA+YWIoYSk/bmV3IGVjKGMpOmIuYT9iLmEoYyxkKTpiLmNhbGwobnVsbCxjLGQpO2Nhc2UgMzpyZXR1cm4gSmcuYShhLFdjKSwwPmFiKGEpP25ldyBlYyhjKTpiLmM/Yi5jKGMsZCxlKTpiLmNhbGwobnVsbCxjLGQsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfShIZy5iKGEpKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7XG59O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHpoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBxaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPWZ1bmN0aW9uKGMsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gSmcuYShhLFdjKSwwPmFiKGEpP2IuYT9iLmEoYyxkKTpiLmNhbGwobnVsbCxjLGQpOmM7Y2FzZSAzOnJldHVybiBKZy5hKGEsV2MpLDA+YWIoYSk/Yi5jP2IuYyhjLGQsZSk6Yi5jYWxsKG51bGwsYyxkLGUpOmN9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfShIZy5iKGEpKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLEJoPWZ1bmN0aW9uIEFoKGIsYyxkLGUpe2lmKEJjKGIpKXJldHVybiBkLm8/ZC5vKCk6ZC5jYWxsKG51bGwpO2lmKE8oYik8PWMpcmV0dXJuIG5oLmMoZSxkLm8/ZC5vKCk6ZC5jYWxsKG51bGwpLGIpO2lmKHUpe3ZhciBmPVljKE8oYikpLGg9emUuYyhiLDAsZik7Yj16ZS5jKGIsZixPKGIpKTtyZXR1cm4gbGgoZnVuY3Rpb24oYixjLGUsZil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGI9ZihjKSxoO2g9ZihlKTtyZXR1cm4gZC5hP2QuYShiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpLG1oKGgpKTpkLmNhbGwobnVsbCxiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpLG1oKGgpKX19KGYsaCxiLGZ1bmN0aW9uKGIsZixoKXtyZXR1cm4gZnVuY3Rpb24ocSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIEFoKHEsXG5jLGQsZSl9fShiLGYsaCl9fShmLGgsYikpKX1yZXR1cm4gbnVsbH07Vy5wcm90b3R5cGUuRWI9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIEJoKHRoaXMsYixjLGQpfTtvaC5vYmplY3Q9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIG5oLmMoZCxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpLGEpfTtvaFtcIm51bGxcIl09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpfTtmdW5jdGlvbiBDaChhLGIpe3ZhciBjPVMuYyhpZyxhLGIpO3JldHVybiBNKGMsVmQoZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yn19KGMpLGIpKX1cbnZhciBEaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTyhhKTxPKGIpP0MuYyhwYyxiLGEpOkMuYyhwYyxhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxsKX1mdW5jdGlvbiBiKGEsYyxkKXthPUNoKE8scGMuZChkLGMsSihbYV0sMCkpKTtyZXR1cm4gQy5jKFlkLEYoYSksRyhhKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYmc7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixcbmUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2Iubz1mdW5jdGlvbigpe3JldHVybiBiZ307Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpLEVoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe2Zvcig7OylpZihPKGIpPE8oYSkpe3ZhciBjPWE7YT1iO2I9Y31lbHNlIHJldHVybiBDLmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtyZXR1cm4gT2MoYixjKT9hOkFjLmEoYSxjKX19KGEsYiksYSxhKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7YT1DaChmdW5jdGlvbihhKXtyZXR1cm4tTyhhKX0sXG5wYy5kKGUsZCxKKFthXSwwKSkpO3JldHVybiBDLmMoYixGKGEpLEcoYSkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxGaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gTyhhKTxPKGIpP0MuYyhmdW5jdGlvbihhLGMpe3JldHVybiBPYyhiLGMpP0FjLmEoYSxjKTphfSxhLGEpOkMuYyhBYyxhLGIpfXZhciBiPW51bGwsXG5jPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe3JldHVybiBDLmMoYixhLHBjLmEoZSxkKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9XG5jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gR2goYSxiKXtyZXR1cm4gV2IuYShhLGIpP25ldyBXKG51bGwsMyw1LFgsW251bGwsbnVsbCxhXSxudWxsKTpuZXcgVyhudWxsLDMsNSxYLFthLGIsbnVsbF0sbnVsbCl9ZnVuY3Rpb24gSGgoYSl7cmV0dXJuIEUoYSk/Qy5jKGZ1bmN0aW9uKGEsYyl7dmFyIGQ9UC5jKGMsMCxudWxsKSxlPVAuYyhjLDEsbnVsbCk7cmV0dXJuIFIuYyhhLGQsZSl9LHdlKE9kLmEoUy5hKFhjLFZlKGEpKSxudWxsKSksYSk6bnVsbH1cbmZ1bmN0aW9uIEloKGEsYixjKXt2YXIgZD1RLmEoYSxjKSxlPVEuYShiLGMpLGY9SmguYT9KaC5hKGQsZSk6SmguY2FsbChudWxsLGQsZSksaD1QLmMoZiwwLG51bGwpLGs9UC5jKGYsMSxudWxsKSxmPVAuYyhmLDIsbnVsbCk7YT1PYyhhLGMpO2I9T2MoYixjKTtkPWEmJmImJihudWxsIT1mfHxudWxsPT1kJiZudWxsPT1lKTtyZXR1cm4gbmV3IFcobnVsbCwzLDUsWCxbIWF8fG51bGw9PWgmJmQ/bnVsbDpuZXcgYWYoW2MsaF0pLCFifHxudWxsPT1rJiZkP251bGw6bmV3IGFmKFtjLGtdKSxkP25ldyBhZihbYyxmXSk6bnVsbF0sbnVsbCl9XG52YXIgS2g9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gQy5jKGZ1bmN0aW9uKGEsYil7cmV0dXJuIHJnLmIoS2QuYyhaZixhLGIpKX0sbmV3IFcobnVsbCwzLDUsWCxbbnVsbCxudWxsLG51bGxdLG51bGwpLEtkLmEoSWQuYyhJaCxhLGIpLGMpKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGIsRGguYShWZShhKSxWZShiKSkpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBMaChhLGIpe3JldHVybiB3ZShLZC5hKEhoLEtoLmMoSGMoYSk/YTp3ZShhKSxIYyhiKT9iOndlKGIpLHBnLmIoZnVuY3Rpb24oKXt2YXIgYz1PKGEpLGQ9TyhiKTtyZXR1cm4gYz5kP2M6ZH0oKSkpKSl9ZnVuY3Rpb24gTWgoYSxiKXtyZXR1cm4gbmV3IFcobnVsbCwzLDUsWCxbQ2QoRmguYShhLGIpKSxDZChGaC5hKGIsYSkpLENkKEVoLmEoYSxiKSldLG51bGwpfWZ1bmN0aW9uIE5oKGEpe2lmKGE/YS5xYzphKXJldHVybiBhLnFjKGEpO3ZhciBiO2I9TmhbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1OaC5fLCFiKSl0aHJvdyB4KFwiRXF1YWxpdHlQYXJ0aXRpb24uZXF1YWxpdHktcGFydGl0aW9uXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gT2goYSxiKXtpZihhP2EucGM6YSlyZXR1cm4gYS5wYyhhLGIpO3ZhciBjO2M9T2hbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1PaC5fLCFjKSl0aHJvdyB4KFwiRGlmZi5kaWZmLXNpbWlsYXJcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1OaC5fPWZ1bmN0aW9uKGEpe3JldHVybihhP2EuaSYxMDI0fHxhLmNjfHwoYS5pPzA6cyhQYSxhKSk6cyhQYSxhKSk/Z2g6KGE/YS5pJjQwOTZ8fGEuamN8fChhLmk/MDpzKFZhLGEpKTpzKFZhLGEpKT9kaDooYT9hLmkmMTY3NzcyMTZ8fGEuaWN8fChhLmk/MDpzKG1iLGEpKTpzKG1iLGEpKT9ZZzpZYj9maDpudWxsfTtOaFtcImJvb2xlYW5cIl09ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O05oW1wiZnVuY3Rpb25cIl09ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O05oLmFycmF5PWZ1bmN0aW9uKCl7cmV0dXJuIFlnfTtOaC5udW1iZXI9ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O05oLnN0cmluZz1mdW5jdGlvbigpe3JldHVybiBmaH07XG5OaFtcIm51bGxcIl09ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O09oLl89ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXtzd2l0Y2goTmgoYSlpbnN0YW5jZW9mIFQ/TmgoYSkuc2E6bnVsbCl7Y2FzZSBcIm1hcFwiOnJldHVybiBLaDtjYXNlIFwic2VxdWVudGlhbFwiOnJldHVybiBMaDtjYXNlIFwic2V0XCI6cmV0dXJuIE1oO2Nhc2UgXCJhdG9tXCI6cmV0dXJuIEdoO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJObyBtYXRjaGluZyBjbGF1c2U6IFwiK0EuYihOaChhKSkpO319KCkuY2FsbChudWxsLGEsYil9O09oW1wiYm9vbGVhblwiXT1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtPaFtcImZ1bmN0aW9uXCJdPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEdoKGEsYil9O09oLmFycmF5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExoKGEsYil9O09oLm51bWJlcj1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtPaC5zdHJpbmc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07XG5PaFtcIm51bGxcIl09ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07ZnVuY3Rpb24gSmgoYSxiKXtyZXR1cm4gV2IuYShhLGIpP25ldyBXKG51bGwsMyw1LFgsW251bGwsbnVsbCxhXSxudWxsKTpXYi5hKE5oKGEpLE5oKGIpKT9PaChhLGIpOkdoKGEsYil9O2Z1bmN0aW9uIFBoKGEpe2lmKGE/YS5VYjphKXJldHVybiBhLlViKCk7dmFyIGI7Yj1QaFttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPVBoLl8sIWIpKXRocm93IHgoXCJQdXNoYmFja1JlYWRlci5yZWFkLWNoYXJcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gUWgoYSxiKXtpZihhP2EuVmI6YSlyZXR1cm4gYS5WYigwLGIpO3ZhciBjO2M9UWhbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1RaC5fLCFjKSl0aHJvdyB4KFwiUHVzaGJhY2tSZWFkZXIudW5yZWFkXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gUmgoYSxiLGMpe3RoaXMucj1hO3RoaXMuYnVmZmVyPWI7dGhpcy5GYj1jfVJoLnByb3RvdHlwZS5VYj1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5idWZmZXIubGVuZ3RoPyh0aGlzLkZiKz0xLHRoaXMuclt0aGlzLkZiXSk6dGhpcy5idWZmZXIucG9wKCl9O1JoLnByb3RvdHlwZS5WYj1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmJ1ZmZlci5wdXNoKGIpfTtcbmZ1bmN0aW9uIFNoKGEpe3ZhciBiPSEvW15cXHRcXG5cXHIgXS8udGVzdChhKTtyZXR1cm4gcihiKT9iOlwiLFwiPT09YX12YXIgVGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsMCxlKX1mdW5jdGlvbiBiKGEsYil7dGhyb3cgRXJyb3IoUy5hKEEsYikpO31hLms9MTthLmY9ZnVuY3Rpb24oYSl7RihhKTthPUcoYSk7cmV0dXJuIGIoMCxhKX07YS5kPWI7cmV0dXJuIGF9KCk7XG5mdW5jdGlvbiBVaChhLGIpe2Zvcih2YXIgYz1uZXcgZWEoYiksZD1QaChhKTs7KXt2YXIgZTtpZighKGU9bnVsbD09ZHx8U2goZCkpKXtlPWQ7dmFyIGY9XCIjXCIhPT1lO2U9Zj8oZj1cIidcIiE9PWUpPyhmPVwiOlwiIT09ZSk/VmguYj9WaC5iKGUpOlZoLmNhbGwobnVsbCxlKTpmOmY6Zn1pZihlKXJldHVybiBRaChhLGQpLGMudG9TdHJpbmcoKTtjLmFwcGVuZChkKTtkPVBoKGEpfX1mdW5jdGlvbiBXaChhKXtmb3IoOzspe3ZhciBiPVBoKGEpO2lmKFwiXFxuXCI9PT1ifHxcIlxcclwiPT09Ynx8bnVsbD09YilyZXR1cm4gYX19dmFyIFhoPXRnKFwiXihbLStdPykoPzooMCl8KFsxLTldWzAtOV0qKXwwW3hYXShbMC05QS1GYS1mXSspfDAoWzAtN10rKXwoWzEtOV1bMC05XT8pW3JSXShbMC05QS1aYS16XSspKShOKT8kXCIpLFloPXRnKFwiXihbLStdP1swLTldKykvKFswLTldKykkXCIpLFpoPXRnKFwiXihbLStdP1swLTldKyhcXFxcLlswLTldKik/KFtlRV1bLStdP1swLTldKyk/KShNKT8kXCIpLCRoPXRnKFwiXls6XT8oW14wLTkvXS4qLyk/KFteMC05L11bXi9dKikkXCIpO1xuZnVuY3Rpb24gYWkoYSxiKXt2YXIgYz1hLmV4ZWMoYik7cmV0dXJuIG51bGwhPWMmJmNbMF09PT1iPzE9PT1jLmxlbmd0aD9jWzBdOmM6bnVsbH12YXIgYmk9dGcoXCJeWzAtOUEtRmEtZl17Mn0kXCIpLGNpPXRnKFwiXlswLTlBLUZhLWZdezR9JFwiKTtmdW5jdGlvbiBkaShhLGIsYyxkKXtyZXR1cm4gcihzZyhhLGQpKT9kOlRoLmQoYixKKFtcIlVuZXhwZWN0ZWQgdW5pY29kZSBlc2NhcGUgXFxcXFwiLGMsZF0sMCkpfWZ1bmN0aW9uIGVpKGEpe3JldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGEsMTYpKX1cbmZ1bmN0aW9uIGZpKGEpe3ZhciBiPVBoKGEpLGM9XCJ0XCI9PT1iP1wiXFx0XCI6XCJyXCI9PT1iP1wiXFxyXCI6XCJuXCI9PT1iP1wiXFxuXCI6XCJcXFxcXCI9PT1iP1wiXFxcXFwiOidcIic9PT1iPydcIic6XCJiXCI9PT1iP1wiXFxiXCI6XCJmXCI9PT1iP1wiXFxmXCI6bnVsbDtyKGMpP2E9YzpcInhcIj09PWI/KGM9KG5ldyBlYShQaChhKSxQaChhKSkpLnRvU3RyaW5nKCksYT1laShkaShiaSxhLGIsYykpKTpcInVcIj09PWI/KGM9KG5ldyBlYShQaChhKSxQaChhKSxQaChhKSxQaChhKSkpLnRvU3RyaW5nKCksYT1laShkaShjaSxhLGIsYykpKTphPS9bXjAtOV0vLnRlc3QoYik/dT9UaC5kKGEsSihbXCJVbmV4cGVjdGVkIHVuaWNvZGUgZXNjYXBlIFxcXFxcIixiXSwwKSk6bnVsbDpTdHJpbmcuZnJvbUNoYXJDb2RlKGIpO3JldHVybiBhfVxuZnVuY3Rpb24gZ2koYSxiKXtmb3IodmFyIGM9eWIocWUpOzspe3ZhciBkO2E6e2Q9U2g7Zm9yKHZhciBlPWIsZj1QaChlKTs7KWlmKHIoZC5iP2QuYihmKTpkLmNhbGwobnVsbCxmKSkpZj1QaChlKTtlbHNle2Q9ZjticmVhayBhfWQ9dm9pZCAwfXIoZCl8fFRoLmQoYixKKFtcIkVPRiB3aGlsZSByZWFkaW5nXCJdLDApKTtpZihhPT09ZClyZXR1cm4gQWIoYyk7ZT1WaC5iP1ZoLmIoZCk6VmguY2FsbChudWxsLGQpO3IoZSk/ZD1lLmE/ZS5hKGIsZCk6ZS5jYWxsKG51bGwsYixkKTooUWgoYixkKSxkPWhpLm4/aGkubihiLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxiLCEwLG51bGwpKTtjPWQ9PT1iP2M6d2QuYShjLGQpfX1mdW5jdGlvbiBpaShhLGIpe3JldHVybiBUaC5kKGEsSihbXCJSZWFkZXIgZm9yIFwiLGIsXCIgbm90IGltcGxlbWVudGVkIHlldFwiXSwwKSl9XG5mdW5jdGlvbiBqaShhLGIpe3ZhciBjPVBoKGEpLGQ9a2kuYj9raS5iKGMpOmtpLmNhbGwobnVsbCxjKTtpZihyKGQpKXJldHVybiBkLmE/ZC5hKGEsYik6ZC5jYWxsKG51bGwsYSxiKTtkPWxpLmE/bGkuYShhLGMpOmxpLmNhbGwobnVsbCxhLGMpO3JldHVybiByKGQpP2Q6VGguZChhLEooW1wiTm8gZGlzcGF0Y2ggbWFjcm8gZm9yIFwiLGNdLDApKX1mdW5jdGlvbiBtaShhLGIpe3JldHVybiBUaC5kKGEsSihbXCJVbm1hY2hlZCBkZWxpbWl0ZXIgXCIsYl0sMCkpfWZ1bmN0aW9uIG5pKGEpe3JldHVybiBTLmEoZmQsZ2koXCIpXCIsYSkpfWZ1bmN0aW9uIG9pKGEpe3JldHVybiBnaShcIl1cIixhKX1cbmZ1bmN0aW9uIHBpKGEpe3ZhciBiPWdpKFwifVwiLGEpLGM9TyhiKTtpZihcIm51bWJlclwiIT09dHlwZW9mIGN8fGlzTmFOKGMpfHxJbmZpbml0eT09PWN8fHBhcnNlRmxvYXQoYykhPT1wYXJzZUludChjLDEwKSl0aHJvdyBFcnJvcihcIkFyZ3VtZW50IG11c3QgYmUgYW4gaW50ZWdlcjogXCIrQS5iKGMpKTswIT09KGMmMSkmJlRoLmQoYSxKKFtcIk1hcCBsaXRlcmFsIG11c3QgY29udGFpbiBhbiBldmVuIG51bWJlciBvZiBmb3Jtc1wiXSwwKSk7cmV0dXJuIFMuYShUZixiKX1mdW5jdGlvbiBxaShhKXtmb3IodmFyIGI9bmV3IGVhLGM9UGgoYSk7Oyl7aWYobnVsbD09YylyZXR1cm4gVGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO2lmKFwiXFxcXFwiPT09YyliLmFwcGVuZChmaShhKSksYz1QaChhKTtlbHNle2lmKCdcIic9PT1jKXJldHVybiBiLnRvU3RyaW5nKCk7aWYoWWIpYi5hcHBlbmQoYyksYz1QaChhKTtlbHNlIHJldHVybiBudWxsfX19XG5mdW5jdGlvbiByaShhKXtmb3IodmFyIGI9bmV3IGVhLGM9UGgoYSk7Oyl7aWYobnVsbD09YylyZXR1cm4gVGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO2lmKFwiXFxcXFwiPT09Yyl7Yi5hcHBlbmQoYyk7dmFyIGQ9UGgoYSk7aWYobnVsbD09ZClyZXR1cm4gVGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpO3ZhciBlPWZ1bmN0aW9uKCl7dmFyIGE9YjthLmFwcGVuZChkKTtyZXR1cm4gYX0oKSxmPVBoKGEpLGI9ZSxjPWZ9ZWxzZXtpZignXCInPT09YylyZXR1cm4gYi50b1N0cmluZygpO2lmKHUpZT1mdW5jdGlvbigpe3ZhciBhPWI7YS5hcHBlbmQoYyk7cmV0dXJuIGF9KCksZj1QaChhKSxiPWUsYz1mO2Vsc2UgcmV0dXJuIG51bGx9fX1cbmZ1bmN0aW9uIHNpKGEsYil7dmFyIGM9VWgoYSxiKTtpZihyKC0xIT1jLmluZGV4T2YoXCIvXCIpKSljPSRiLmEoYWQuYyhjLDAsYy5pbmRleE9mKFwiL1wiKSksYWQuYyhjLGMuaW5kZXhPZihcIi9cIikrMSxjLmxlbmd0aCkpO2Vsc2UgdmFyIGQ9JGIuYihjKSxjPVwibmlsXCI9PT1jP251bGw6XCJ0cnVlXCI9PT1jPyEwOlwiZmFsc2VcIj09PWM/ITE6dT9kOm51bGw7cmV0dXJuIGN9ZnVuY3Rpb24gdGkoYSl7dmFyIGI9VWgoYSxQaChhKSksYz1haSgkaCxiKSxiPWNbMF0sZD1jWzFdLGM9Y1syXTtyZXR1cm4gdm9pZCAwIT09ZCYmXCI6L1wiPT09ZC5zdWJzdHJpbmcoZC5sZW5ndGgtMixkLmxlbmd0aCl8fFwiOlwiPT09Y1tjLmxlbmd0aC0xXXx8LTEhPT1iLmluZGV4T2YoXCI6OlwiLDEpP1RoLmQoYSxKKFtcIkludmFsaWQgdG9rZW46IFwiLGJdLDApKTpudWxsIT1kJiYwPGQubGVuZ3RoP2pkLmEoZC5zdWJzdHJpbmcoMCxkLmluZGV4T2YoXCIvXCIpKSxjKTpqZC5iKGIpfVxuZnVuY3Rpb24gdWkoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBEYShEYShILGhpLm4/aGkubihiLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxiLCEwLG51bGwpKSxhKX19ZnVuY3Rpb24gdmkoKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIFRoLmQoYSxKKFtcIlVucmVhZGFibGUgZm9ybVwiXSwwKSl9fVxuZnVuY3Rpb24gd2koYSl7dmFyIGI7Yj1oaS5uP2hpLm4oYSwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYSwhMCxudWxsKTtiPWIgaW5zdGFuY2VvZiBaYj9uZXcgbGEobnVsbCwxLFtjaCxiXSxudWxsKTpcInN0cmluZ1wiPT09dHlwZW9mIGI/bmV3IGxhKG51bGwsMSxbY2gsYl0sbnVsbCk6YiBpbnN0YW5jZW9mIFQ/bmV3IGFmKFtiLCEwXSk6dT9iOm51bGw7R2MoYil8fFRoLmQoYSxKKFtcIk1ldGFkYXRhIG11c3QgYmUgU3ltYm9sLEtleXdvcmQsU3RyaW5nIG9yIE1hcFwiXSwwKSk7dmFyIGM9aGkubj9oaS5uKGEsITAsbnVsbCwhMCk6aGkuY2FsbChudWxsLGEsITAsbnVsbCk7cmV0dXJuKGM/Yy5pJjI2MjE0NHx8Yy5vY3x8KGMuaT8wOnMoZGIsYykpOnMoZGIsYykpP04oYyxaZi5kKEooW3hjKGMpLGJdLDApKSk6VGguZChhLEooW1wiTWV0YWRhdGEgY2FuIG9ubHkgYmUgYXBwbGllZCB0byBJV2l0aE1ldGFzXCJdLDApKX1mdW5jdGlvbiB4aShhKXtyZXR1cm4gZWcoZ2koXCJ9XCIsYSkpfVxuZnVuY3Rpb24geWkoYSl7cmV0dXJuIHRnKHJpKGEpKX1mdW5jdGlvbiB6aShhKXtoaS5uP2hpLm4oYSwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYSwhMCxudWxsKTtyZXR1cm4gYX1mdW5jdGlvbiBWaChhKXtyZXR1cm4nXCInPT09YT9xaTpcIjpcIj09PWE/dGk6XCI7XCI9PT1hP1doOlwiJ1wiPT09YT91aShuZXcgWmIobnVsbCxcInF1b3RlXCIsXCJxdW90ZVwiLDEzNzc5MTYyODIsbnVsbCkpOlwiQFwiPT09YT91aShuZXcgWmIobnVsbCxcImRlcmVmXCIsXCJkZXJlZlwiLDE0OTQ5NDQ3MzIsbnVsbCkpOlwiXlwiPT09YT93aTpcImBcIj09PWE/aWk6XCJ+XCI9PT1hP2lpOlwiKFwiPT09YT9uaTpcIilcIj09PWE/bWk6XCJbXCI9PT1hP29pOlwiXVwiPT09YT9taTpcIntcIj09PWE/cGk6XCJ9XCI9PT1hP21pOlwiXFxcXFwiPT09YT9QaDpcIiNcIj09PWE/amk6bnVsbH1mdW5jdGlvbiBraShhKXtyZXR1cm5cIntcIj09PWE/eGk6XCJcXHgzY1wiPT09YT92aSgpOidcIic9PT1hP3lpOlwiIVwiPT09YT9XaDpcIl9cIj09PWE/emk6bnVsbH1cbmZ1bmN0aW9uIGhpKGEsYixjKXtmb3IoOzspe3ZhciBkPVBoKGEpO2lmKG51bGw9PWQpcmV0dXJuIHIoYik/VGguZChhLEooW1wiRU9GIHdoaWxlIHJlYWRpbmdcIl0sMCkpOmM7aWYoIVNoKGQpKWlmKFwiO1wiPT09ZClhPVdoLmE/V2guYShhLGQpOldoLmNhbGwobnVsbCxhKTtlbHNlIGlmKHUpe3ZhciBlPVZoKGQpO2lmKHIoZSkpZT1lLmE/ZS5hKGEsZCk6ZS5jYWxsKG51bGwsYSxkKTtlbHNle3ZhciBlPWEsZj12b2lkIDA7IShmPSEvW14wLTldLy50ZXN0KGQpKSYmKGY9dm9pZCAwLGY9XCIrXCI9PT1kfHxcIi1cIj09PWQpJiYoZj1QaChlKSxRaChlLGYpLGY9IS9bXjAtOV0vLnRlc3QoZikpO2lmKGYpYTp7ZT1hO2Q9bmV3IGVhKGQpO2ZvcihmPVBoKGUpOzspe3ZhciBoO2g9bnVsbD09ZjtofHwoaD0oaD1TaChmKSk/aDpWaC5iP1ZoLmIoZik6VmguY2FsbChudWxsLGYpKTtpZihyKGgpKXtRaChlLGYpO2Y9ZD1kLnRvU3RyaW5nKCk7aD12b2lkIDA7aWYocihhaShYaCxmKSkpaWYoZj1haShYaCxcbmYpLG51bGwhPWZbMl0paD0wO2Vsc2V7aD1yKGZbM10pP1tmWzNdLDEwXTpyKGZbNF0pP1tmWzRdLDE2XTpyKGZbNV0pP1tmWzVdLDhdOnIoZls2XSk/W2ZbN10scGFyc2VJbnQoZls2XSwxMCldOnU/W251bGwsbnVsbF06bnVsbDt2YXIgaz1oWzBdO251bGw9PWs/aD1udWxsOihoPXBhcnNlSW50KGssaFsxXSksaD1cIi1cIj09PWZbMV0/LWg6aCl9ZWxzZSBoPXZvaWQgMCxyKGFpKFloLGYpKT8oZj1haShZaCxmKSxoPXBhcnNlSW50KGZbMV0sMTApL3BhcnNlSW50KGZbMl0sMTApKTpoPXIoYWkoWmgsZikpP3BhcnNlRmxvYXQoZik6bnVsbDtmPWg7ZT1yKGYpP2Y6VGguZChlLEooW1wiSW52YWxpZCBudW1iZXIgZm9ybWF0IFtcIixkLFwiXVwiXSwwKSk7YnJlYWsgYX1kLmFwcGVuZChmKTtmPVBoKGUpfWU9dm9pZCAwfWVsc2UgZT11P3NpKGEsZCk6bnVsbH1pZihlIT09YSlyZXR1cm4gZX1lbHNlIHJldHVybiBudWxsfX1cbmZ1bmN0aW9uIEFpKGEpe2lmKFdiLmEoMyxPKGEpKSlyZXR1cm4gYTtpZigzPE8oYSkpcmV0dXJuIGFkLmMoYSwwLDMpO2lmKHUpZm9yKGE9bmV3IGVhKGEpOzspaWYoMz5hLlZhLmxlbmd0aClhPWEuYXBwZW5kKFwiMFwiKTtlbHNlIHJldHVybiBhLnRvU3RyaW5nKCk7ZWxzZSByZXR1cm4gbnVsbH12YXIgQmk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXtyZXR1cm4gUS5hKHIoZCk/YjphLGMpfX0obmV3IFcobnVsbCwxMyw1LFgsW251bGwsMzEsMjgsMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdLG51bGwpLG5ldyBXKG51bGwsMTMsNSxYLFtudWxsLDMxLDI5LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXSxudWxsKSksQ2k9LyhcXGRcXGRcXGRcXGQpKD86LShcXGRcXGQpKD86LShcXGRcXGQpKD86W1RdKFxcZFxcZCkoPzo6KFxcZFxcZCkoPzo6KFxcZFxcZCkoPzpbLl0oXFxkKykpPyk/KT8pPyk/KT8oPzpbWl18KFstK10pKFxcZFxcZCk6KFxcZFxcZCkpPy87XG5mdW5jdGlvbiBEaShhKXthPXBhcnNlSW50KGEsMTApO3JldHVybiBzYShpc05hTihhKSk/YTpudWxsfWZ1bmN0aW9uIEVpKGEsYixjLGQpe2E8PWImJmI8PWN8fFRoLmQobnVsbCxKKFtcIlwiK0EuYihkKStcIiBGYWlsZWQ6ICBcIitBLmIoYSkrXCJcXHgzY1xceDNkXCIrQS5iKGIpK1wiXFx4M2NcXHgzZFwiK0EuYihjKV0sMCkpO3JldHVybiBifVxuZnVuY3Rpb24gRmkoYSl7dmFyIGI9c2coQ2ksYSk7UC5jKGIsMCxudWxsKTt2YXIgYz1QLmMoYiwxLG51bGwpLGQ9UC5jKGIsMixudWxsKSxlPVAuYyhiLDMsbnVsbCksZj1QLmMoYiw0LG51bGwpLGg9UC5jKGIsNSxudWxsKSxrPVAuYyhiLDYsbnVsbCksbD1QLmMoYiw3LG51bGwpLG49UC5jKGIsOCxudWxsKSxxPVAuYyhiLDksbnVsbCksdD1QLmMoYiwxMCxudWxsKTtpZihzYShiKSlyZXR1cm4gVGguZChudWxsLEooW1wiVW5yZWNvZ25pemVkIGRhdGUvdGltZSBzeW50YXg6IFwiK0EuYihhKV0sMCkpO2E9RGkoYyk7dmFyIGI9ZnVuY3Rpb24oKXt2YXIgYT1EaShkKTtyZXR1cm4gcihhKT9hOjF9KCksYz1mdW5jdGlvbigpe3ZhciBhPURpKGUpO3JldHVybiByKGEpP2E6MX0oKSx2PWZ1bmN0aW9uKCl7dmFyIGE9RGkoZik7cmV0dXJuIHIoYSk/YTowfSgpLHc9ZnVuY3Rpb24oKXt2YXIgYT1EaShoKTtyZXR1cm4gcihhKT9hOjB9KCkseT1mdW5jdGlvbigpe3ZhciBhPURpKGspO3JldHVybiByKGEpP1xuYTowfSgpLEI9ZnVuY3Rpb24oKXt2YXIgYT1EaShBaShsKSk7cmV0dXJuIHIoYSk/YTowfSgpLG49KFdiLmEobixcIi1cIik/LTE6MSkqKDYwKmZ1bmN0aW9uKCl7dmFyIGE9RGkocSk7cmV0dXJuIHIoYSk/YTowfSgpK2Z1bmN0aW9uKCl7dmFyIGE9RGkodCk7cmV0dXJuIHIoYSk/YTowfSgpKTtyZXR1cm4gbmV3IFcobnVsbCw4LDUsWCxbYSxFaSgxLGIsMTIsXCJ0aW1lc3RhbXAgbW9udGggZmllbGQgbXVzdCBiZSBpbiByYW5nZSAxLi4xMlwiKSxFaSgxLGMsQmkuYT9CaS5hKGIsMD09PShhJTQrNCklNCYmKDAhPT0oYSUxMDArMTAwKSUxMDB8fDA9PT0oYSU0MDArNDAwKSU0MDApKTpCaS5jYWxsKG51bGwsYiwwPT09KGElNCs0KSU0JiYoMCE9PShhJTEwMCsxMDApJTEwMHx8MD09PShhJTQwMCs0MDApJTQwMCkpLFwidGltZXN0YW1wIGRheSBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDEuLmxhc3QgZGF5IGluIG1vbnRoXCIpLEVpKDAsdiwyMyxcInRpbWVzdGFtcCBob3VyIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uMjNcIiksXG5FaSgwLHcsNTksXCJ0aW1lc3RhbXAgbWludXRlIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uNTlcIiksRWkoMCx5LFdiLmEodyw1OSk/NjA6NTksXCJ0aW1lc3RhbXAgc2Vjb25kIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMC4uNjBcIiksRWkoMCxCLDk5OSxcInRpbWVzdGFtcCBtaWxsaXNlY29uZCBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDAuLjk5OVwiKSxuXSxudWxsKX1cbnZhciBHaT1IZy5iKG5ldyBsYShudWxsLDQsW1wiaW5zdFwiLGZ1bmN0aW9uKGEpe3ZhciBiO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlpZihiPUZpKGEpLHIoYikpe2E9UC5jKGIsMCxudWxsKTt2YXIgYz1QLmMoYiwxLG51bGwpLGQ9UC5jKGIsMixudWxsKSxlPVAuYyhiLDMsbnVsbCksZj1QLmMoYiw0LG51bGwpLGg9UC5jKGIsNSxudWxsKSxrPVAuYyhiLDYsbnVsbCk7Yj1QLmMoYiw3LG51bGwpO2I9bmV3IERhdGUoRGF0ZS5VVEMoYSxjLTEsZCxlLGYsaCxrKS02RTQqYil9ZWxzZSBiPVRoLmQobnVsbCxKKFtcIlVucmVjb2duaXplZCBkYXRlL3RpbWUgc3ludGF4OiBcIitBLmIoYSldLDApKTtlbHNlIGI9VGguZChudWxsLEooW1wiSW5zdGFuY2UgbGl0ZXJhbCBleHBlY3RzIGEgc3RyaW5nIGZvciBpdHMgdGltZXN0YW1wLlwiXSwwKSk7cmV0dXJuIGJ9LFwidXVpZFwiLGZ1bmN0aW9uKGEpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYT9uZXcgVGcoYSk6VGguZChudWxsLEooW1wiVVVJRCBsaXRlcmFsIGV4cGVjdHMgYSBzdHJpbmcgYXMgaXRzIHJlcHJlc2VudGF0aW9uLlwiXSxcbjApKX0sXCJxdWV1ZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBIYyhhKT9ZZChKZSxhKTpUaC5kKG51bGwsSihbXCJRdWV1ZSBsaXRlcmFsIGV4cGVjdHMgYSB2ZWN0b3IgZm9yIGl0cyBlbGVtZW50cy5cIl0sMCkpfSxcImpzXCIsZnVuY3Rpb24oYSl7aWYoSGMoYSkpe3ZhciBiPVtdO2E9RShhKTtmb3IodmFyIGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKTtiLnB1c2goZik7ZSs9MX1lbHNlIGlmKGE9RShhKSljPWEsSWMoYyk/KGE9SGIoYyksZT1JYihjKSxjPWEsZD1PKGEpLGE9ZSk6KGE9RihjKSxiLnB1c2goYSksYT1JKGMpLGM9bnVsbCxkPTApLGU9MDtlbHNlIGJyZWFrO3JldHVybiBifWlmKEdjKGEpKXtiPXt9O2E9RShhKTtjPW51bGw7Zm9yKGU9ZD0wOzspaWYoZTxkKXt2YXIgaD1jLkoobnVsbCxlKSxmPVAuYyhoLDAsbnVsbCksaD1QLmMoaCwxLG51bGwpO2JbaWQoZildPWg7ZSs9MX1lbHNlIGlmKGE9RShhKSlJYyhhKT8oZD1IYihhKSxhPUliKGEpLGM9ZCxcbmQ9TyhkKSk6KGQ9RihhKSxjPVAuYyhkLDAsbnVsbCksZD1QLmMoZCwxLG51bGwpLGJbaWQoYyldPWQsYT1JKGEpLGM9bnVsbCxkPTApLGU9MDtlbHNlIGJyZWFrO3JldHVybiBifXJldHVybiB1P1RoLmQobnVsbCxKKFtcIkpTIGxpdGVyYWwgZXhwZWN0cyBhIHZlY3RvciBvciBtYXAgY29udGFpbmluZyBvbmx5IHN0cmluZyBvciB1bnF1YWxpZmllZCBrZXl3b3JkIGtleXNcIl0sMCkpOm51bGx9XSxudWxsKSksSGk9SGcuYihudWxsKTtcbmZ1bmN0aW9uIGxpKGEsYil7dmFyIGM9c2koYSxiKSxkPVEuYShhYihHaSksXCJcIitBLmIoYykpLGU9YWIoSGkpO3JldHVybiByKGQpP2QuYj9kLmIoaGkoYSwhMCxudWxsKSk6ZC5jYWxsKG51bGwsaGkoYSwhMCxudWxsKSk6cihlKT9lLmE/ZS5hKGMsaGkoYSwhMCxudWxsKSk6ZS5jYWxsKG51bGwsYyxoaShhLCEwLG51bGwpKTp1P1RoLmQoYSxKKFtcIkNvdWxkIG5vdCBmaW5kIHRhZyBwYXJzZXIgZm9yIFwiLFwiXCIrQS5iKGMpLFwiIGluIFwiLENnLmQoSihbVmUoYWIoR2kpKV0sMCkpXSwwKSk6bnVsbH07cChcIm1vcmkuYXBwbHlcIixTKTtwKFwibW9yaS5jb3VudFwiLE8pO3AoXCJtb3JpLmRpc3RpbmN0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uIGMoYSxlKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihhLGQpe2Zvcig7Oyl7dmFyIGU9YSxsPVAuYyhlLDAsbnVsbCk7aWYoZT1FKGUpKWlmKE9jKGQsbCkpbD1HKGUpLGU9ZCxhPWwsZD1lO2Vsc2UgcmV0dXJuIE0obCxjKEcoZSkscGMuYShkLGwpKSk7ZWxzZSByZXR1cm4gbnVsbH19LmNhbGwobnVsbCxhLGUpfSxudWxsLG51bGwpfShhLGJnKX0pO3AoXCJtb3JpLmVtcHR5XCIscWMpO3AoXCJtb3JpLmZpcnN0XCIsRik7cChcIm1vcmkucmVzdFwiLEcpO3AoXCJtb3JpLnNlcVwiLEUpO3AoXCJtb3JpLmNvbmpcIixwYyk7cChcIm1vcmkuY29uc1wiLE0pO1xucChcIm1vcmkuZmluZFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGwhPWEmJkVjKGEpJiZPYyhhLGIpP25ldyBXKG51bGwsMiw1LFgsW2IsUS5hKGEsYildLG51bGwpOm51bGx9KTtwKFwibW9yaS5udGhcIixQKTtwKFwibW9yaS5sYXN0XCIsb2MpO3AoXCJtb3JpLmFzc29jXCIsUik7cChcIm1vcmkuZGlzc29jXCIsdGMpO3AoXCJtb3JpLmdldF9pblwiLCRkKTtwKFwibW9yaS51cGRhdGVfaW5cIixhZSk7cChcIm1vcmkuYXNzb2NfaW5cIixmdW5jdGlvbiBJaShiLGMsZCl7dmFyIGU9UC5jKGMsMCxudWxsKTtyZXR1cm4oYz0kYyhjKSk/Ui5jKGIsZSxJaShRLmEoYixlKSxjLGQpKTpSLmMoYixlLGQpfSk7cChcIm1vcmkuZm5pbFwiLEpkKTtwKFwibW9yaS5kaXNqXCIsQWMpO3AoXCJtb3JpLnBvcFwiLHpjKTtwKFwibW9yaS5wZWVrXCIseWMpO3AoXCJtb3JpLmhhc2hcIixUYik7cChcIm1vcmkuZ2V0XCIsUSk7cChcIm1vcmkuaGFzX2tleVwiLE9jKTtwKFwibW9yaS5pc19lbXB0eVwiLEJjKTtwKFwibW9yaS5yZXZlcnNlXCIsZWQpO1xucChcIm1vcmkudGFrZVwiLE1kKTtwKFwibW9yaS5kcm9wXCIsTmQpO3AoXCJtb3JpLnRha2VfbnRoXCIsZnVuY3Rpb24gSmkoYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBkPUUoYyk7cmV0dXJuIGQ/TShGKGQpLEppKGIsTmQoYixkKSkpOm51bGx9LG51bGwsbnVsbCl9KTtwKFwibW9yaS5wYXJ0aXRpb25cIixaZCk7cChcIm1vcmkucGFydGl0aW9uX2FsbFwiLGpnKTtwKFwibW9yaS5wYXJ0aXRpb25fYnlcIixmdW5jdGlvbiBLaShiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGQ9RShjKTtpZihkKXt2YXIgZT1GKGQpLGY9Yi5iP2IuYihlKTpiLmNhbGwobnVsbCxlKSxlPU0oZSxsZyhmdW5jdGlvbihjLGQpe3JldHVybiBmdW5jdGlvbihjKXtyZXR1cm4gV2IuYShkLGIuYj9iLmIoYyk6Yi5jYWxsKG51bGwsYykpfX0oZSxmLGQsZCksSShkKSkpO3JldHVybiBNKGUsS2koYixFKE5kKE8oZSksZCkpKSl9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9KTtcbnAoXCJtb3JpLml0ZXJhdGVcIixmdW5jdGlvbiBMaShiLGMpe3JldHVybiBNKGMsbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBMaShiLGIuYj9iLmIoYyk6Yi5jYWxsKG51bGwsYykpfSxudWxsLG51bGwpKX0pO3AoXCJtb3JpLmludG9cIixZZCk7cChcIm1vcmkubWVyZ2VcIixaZik7cChcIm1vcmkuc3VidmVjXCIsemUpO3AoXCJtb3JpLnRha2Vfd2hpbGVcIixsZyk7cChcIm1vcmkuZHJvcF93aGlsZVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oYyl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGMoYSxiKX19KGZ1bmN0aW9uKGEsYil7Zm9yKDs7KXt2YXIgZT1FKGIpLGY7Zj0oZj1lKT9hLmI/YS5iKEYoZSkpOmEuY2FsbChudWxsLEYoZSkpOmY7aWYocihmKSlmPWEsZT1HKGUpLGE9ZixiPWU7ZWxzZSByZXR1cm4gZX19KSxudWxsLG51bGwpfSk7XG5wKFwibW9yaS5ncm91cF9ieVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIEMuYyhmdW5jdGlvbihiLGQpe3ZhciBlPWEuYj9hLmIoZCk6YS5jYWxsKG51bGwsZCk7cmV0dXJuIFIuYyhiLGUscGMuYShRLmMoYixlLHFlKSxkKSl9LFllLGIpfSk7cChcIm1vcmkuaW50ZXJwb3NlXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gTmQoMSxRZC5hKE9kLmIoYSksYikpfSk7cChcIm1vcmkuaW50ZXJsZWF2ZVwiLFFkKTtwKFwibW9yaS5jb25jYXRcIix0ZCk7cChcIm1vcmkuY29uajFcIixmdW5jdGlvbihhLGIpe3JldHVybiBhLkcobnVsbCxiKX0pO2Z1bmN0aW9uIFhkKGEpe3JldHVybiBhIGluc3RhbmNlb2YgQXJyYXl8fEZjKGEpfXAoXCJtb3JpLmZsYXR0ZW5cIixmdW5jdGlvbihhKXtyZXR1cm4gVWQoZnVuY3Rpb24oYSl7cmV0dXJuIVhkKGEpfSxHKFdkKGEpKSl9KTtwKFwibW9yaS5sYXp5X3NlcVwiLGZ1bmN0aW9uKGEpe3JldHVybiBuZXcgVihudWxsLGEsbnVsbCxudWxsKX0pO3AoXCJtb3JpLmtleXNcIixWZSk7XG5wKFwibW9yaS5zZWxlY3Rfa2V5c1wiLGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVllLGQ9RShiKTs7KWlmKGQpdmFyIGU9RihkKSxmPVEuYyhhLGUsaWgpLGM9QmQuYShmLGloKT9SLmMoYyxlLGYpOmMsZD1JKGQpO2Vsc2UgcmV0dXJuIGN9KTtwKFwibW9yaS52YWxzXCIsV2UpO3AoXCJtb3JpLnByaW1fc2VxXCIsbWMpO3AoXCJtb3JpLm1hcFwiLEtkKTtwKFwibW9yaS5tYXBjYXRcIixTZCk7cChcIm1vcmkucmVkdWNlXCIsQyk7cChcIm1vcmkucmVkdWNlX2t2XCIsZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsIT1jP2hiKGMsYSxiKTpifSk7cChcIm1vcmkuZmlsdGVyXCIsVWQpO3AoXCJtb3JpLnJlbW92ZVwiLFZkKTtwKFwibW9yaS5zb21lXCIsRWQpO3AoXCJtb3JpLmV2ZXJ5XCIsRGQpO3AoXCJtb3JpLmVxdWFsc1wiLFdiKTtwKFwibW9yaS5yYW5nZVwiLHBnKTtwKFwibW9yaS5yZXBlYXRcIixPZCk7cChcIm1vcmkucmVwZWF0ZWRseVwiLFBkKTtwKFwibW9yaS5zb3J0XCIsU2MpO3AoXCJtb3JpLnNvcnRfYnlcIixUYyk7XG5wKFwibW9yaS5pbnRvX2FycmF5XCIseGEpO3AoXCJtb3JpLnN1YnNlcVwiLG5nKTtwKFwibW9yaS5ybWFwXCIsdGgpO3AoXCJtb3JpLnJmaWx0ZXJcIix1aCk7cChcIm1vcmkucnJlbW92ZVwiLHdoKTtwKFwibW9yaS5ydGFrZVwiLHloKTtwKFwibW9yaS5ydGFrZV93aGlsZVwiLHhoKTtwKFwibW9yaS5yZHJvcFwiLHpoKTtwKFwibW9yaS5yZmxhdHRlblwiLHZoKTtwKFwibW9yaS5saXN0XCIsZmQpO3AoXCJtb3JpLnZlY3RvclwiLHhlKTtwKFwibW9yaS5hcnJheV9tYXBcIixVZik7cChcIm1vcmkuaGFzaF9tYXBcIixUZik7cChcIm1vcmkuc2V0XCIsZWcpO3AoXCJtb3JpLnNvcnRlZF9zZXRcIixmZyk7cChcIm1vcmkuc29ydGVkX3NldF9ieVwiLGdnKTtwKFwibW9yaS5zb3J0ZWRfbWFwXCIsVmYpO3AoXCJtb3JpLnNvcnRlZF9tYXBfYnlcIixXZik7XG5wKFwibW9yaS5xdWV1ZVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBZZC5hP1lkLmEoSmUsYSk6WWQuY2FsbChudWxsLEplLGEpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpKTtwKFwibW9yaS5rZXl3b3JkXCIsamQpO3AoXCJtb3JpLnN5bWJvbFwiLCRiKTtwKFwibW9yaS56aXBtYXBcIixmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz15YihZZSksZD1FKGEpLGU9RShiKTs7KWlmKGQmJmUpYz14ZC5jKGMsRihkKSxGKGUpKSxkPUkoZCksZT1JKGUpO2Vsc2UgcmV0dXJuIEFiKGMpfSk7XG5wKFwibW9yaS5pc19saXN0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YS5pJjMzNTU0NDMyfHxhLkVjPyEwOmEuaT8hMTpzKG5iLGEpOnMobmIsYSl9KTtwKFwibW9yaS5pc19zZXFcIixNYyk7cChcIm1vcmkuaXNfdmVjdG9yXCIsSGMpO3AoXCJtb3JpLmlzX21hcFwiLEdjKTtwKFwibW9yaS5pc19zZXRcIixEYyk7cChcIm1vcmkuaXNfa2V5d29yZFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgVH0pO3AoXCJtb3JpLmlzX3N5bWJvbFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgWmJ9KTtwKFwibW9yaS5pc19jb2xsZWN0aW9uXCIsQ2MpO3AoXCJtb3JpLmlzX3NlcXVlbnRpYWxcIixGYyk7cChcIm1vcmkuaXNfYXNzb2NpYXRpdmVcIixFYyk7cChcIm1vcmkuaXNfY291bnRlZFwiLGljKTtwKFwibW9yaS5pc19pbmRleGVkXCIsamMpO3AoXCJtb3JpLmlzX3JlZHVjZWFibGVcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hLmkmNTI0Mjg4fHxhLk5iPyEwOmEuaT8hMTpzKGZiLGEpOnMoZmIsYSl9KTtcbnAoXCJtb3JpLmlzX3NlcWFibGVcIixmdW5jdGlvbihhKXtyZXR1cm4gYT9hLmkmODM4ODYwOHx8YS5oYz8hMDphLmk/ITE6cyhrYixhKTpzKGtiLGEpfSk7cChcIm1vcmkuaXNfcmV2ZXJzaWJsZVwiLGRkKTtwKFwibW9yaS51bmlvblwiLERoKTtwKFwibW9yaS5pbnRlcnNlY3Rpb25cIixFaCk7cChcIm1vcmkuZGlmZmVyZW5jZVwiLEZoKTtwKFwibW9yaS5pc19zdWJzZXRcIixmdW5jdGlvbihhLGIpe3JldHVybiBPKGEpPD1PKGIpJiZEZChmdW5jdGlvbihhKXtyZXR1cm4gT2MoYixhKX0sYSl9KTtwKFwibW9yaS5pc19zdXBlcnNldFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIE8oYSk+PU8oYikmJkRkKGZ1bmN0aW9uKGIpe3JldHVybiBPYyhhLGIpfSxiKX0pO3AoXCJtb3JpLnBhcnRpYWxcIixJZCk7cChcIm1vcmkuY29tcFwiLEhkKTtcbnAoXCJtb3JpLnBpcGVsaW5lXCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIEMuYT9DLmEoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi5iP2IuYihhKTpiLmNhbGwobnVsbCxhKX0sYSk6Qy5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi5iP2IuYihhKTpiLmNhbGwobnVsbCxhKX0sYSl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCkpO1xucChcIm1vcmkuY3VycnlcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkKXt2YXIgZT1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGU9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxhLGUpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIFMuYShhLE0uYT9NLmEoZSxiKTpNLmNhbGwobnVsbCxlLGIpKX19YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpKTtcbnAoXCJtb3JpLmp1eHRcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEpe3ZhciBjPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGUuY2FsbCh0aGlzLGMpfWZ1bmN0aW9uIGUoYil7cmV0dXJuIHhhLmI/eGEuYihLZC5hP0tkLmEoZnVuY3Rpb24oYSl7cmV0dXJuIFMuYShhLGIpfSxhKTpLZC5jYWxsKG51bGwsZnVuY3Rpb24oYSl7cmV0dXJuIFMuYShhLGIpfSxhKSk6eGEuY2FsbChudWxsLEtkLmE/S2QuYShmdW5jdGlvbihhKXtyZXR1cm4gUy5hKGEsYil9LGEpOktkLmNhbGwobnVsbCxmdW5jdGlvbihhKXtyZXR1cm4gUy5hKGEsXG5iKX0sYSkpfWIuaz0wO2IuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGUoYSl9O2IuZD1lO3JldHVybiBifSgpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpKTtcbnAoXCJtb3JpLmtuaXRcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIHhhLmI/eGEuYihLZC5jP0tkLmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKX0sYSxiKTpLZC5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKX0sYSxiKSk6eGEuY2FsbChudWxsLEtkLmM/S2QuYyhmdW5jdGlvbihhLGIpe3JldHVybiBhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpfSxhLGIpOktkLmNhbGwobnVsbCxmdW5jdGlvbihhLGIpe3JldHVybiBhLmI/YS5iKGIpOmEuY2FsbChudWxsLGIpfSxhLGIpKX19YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07XG5hLmQ9YjtyZXR1cm4gYX0oKSk7cChcIm1vcmkuZGlmZlwiLEpoKTtwKFwibW9yaS5zdW1cIixmdW5jdGlvbihhLGIpe3JldHVybiBhK2J9KTtwKFwibW9yaS5pbmNcIixmdW5jdGlvbihhKXtyZXR1cm4gYSsxfSk7cChcIm1vcmkuZGVjXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEtMX0pO3AoXCJtb3JpLmlzX2V2ZW5cIixmdW5jdGlvbihhKXtyZXR1cm4gMD09PShhJTIrMiklMn0pO3AoXCJtb3JpLmlzX29kZFwiLGZ1bmN0aW9uKGEpe3JldHVybiAxPT09KGElMisyKSUyfSk7cChcIm1vcmkuZWFjaFwiLGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPUUoYSksZD1udWxsLGU9MCxmPTA7OylpZihmPGUpe3ZhciBoPWQuSihudWxsLGYpO2IuYj9iLmIoaCk6Yi5jYWxsKG51bGwsaCk7Zis9MX1lbHNlIGlmKGM9RShjKSlkPWMsSWMoZCk/KGM9SGIoZCksZT1JYihkKSxkPWMsaD1PKGMpLGM9ZSxlPWgpOihoPUYoZCksYi5iP2IuYihoKTpiLmNhbGwobnVsbCxoKSxjPUkoZCksZD1udWxsLGU9MCksZj0wO2Vsc2UgcmV0dXJuIG51bGx9KTtcbnAoXCJtb3JpLmlkZW50aXR5XCIsRmQpO3AoXCJtb3JpLmNvbnN0YW50bHlcIixmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGIpezA8YXJndW1lbnRzLmxlbmd0aCYmSihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCk7cmV0dXJuIGF9Yi5rPTA7Yi5mPWZ1bmN0aW9uKGIpe0UoYik7cmV0dXJuIGF9O2IuZD1mdW5jdGlvbigpe3JldHVybiBhfTtyZXR1cm4gYn0oKX0pO3AoXCJtb3JpLmNsal90b19qc1wiLE5nKTtcbnAoXCJtb3JpLmpzX3RvX2NsalwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBTZy5kKGEsSihbUmcsYl0sMCkpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIFNnLmIoYSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSk7cChcIm1vcmkucGFyc2VcIixmdW5jdGlvbihhKXtyZXR1cm4gaGkobmV3IFJoKGEsW10sLTEpLCExLG51bGwpfSk7XG5wKFwibW9yaS5jb25maWd1cmVcIixmdW5jdGlvbihhLGIpe3N3aXRjaChhKXtjYXNlIFwicHJpbnQtbGVuZ3RoXCI6cmV0dXJuIGlhPWI7Y2FzZSBcInByaW50LWxldmVsXCI6cmV0dXJuIGphPWI7ZGVmYXVsdDp0aHJvdyBFcnJvcihcIk5vIG1hdGNoaW5nIGNsYXVzZTogXCIrQS5iKGEpKTt9fSk7XG5wKFwibW9yaS5wcm94eVwiLGZ1bmN0aW9uKGEpe2lmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgUHJveHkpcmV0dXJuIFByb3h5LmNyZWF0ZShmdW5jdGlvbigpe3JldHVybntoYXM6ZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9LGhhc093bjpmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX0sZ2V0OmZ1bmN0aW9uKGIsYyl7dmFyIGQ9US5jP1EuYyhhLGMsaGgpOlEuY2FsbChudWxsLGEsYyxoaCk7cmV0dXJuIGhkKGQsaGgpP2ljKGEpJiZcImxlbmd0aFwiPT09Yz9PLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpOm51bGw6dT9kOm51bGx9LHNldDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxlbnVtZXJhdGU6ZnVuY3Rpb24oKXtyZXR1cm4geGEuYj94YS5iKFZlLmI/VmUuYihhKTpWZS5jYWxsKG51bGwsYSkpOnhhLmNhbGwobnVsbCxWZS5iP1ZlLmIoYSk6VmUuY2FsbChudWxsLGEpKX0sa2V5czpmdW5jdGlvbigpe3JldHVybiBHYyhhKT94YS5iP3hhLmIoVmUuYj9WZS5iKGEpOlZlLmNhbGwobnVsbCxcbmEpKTp4YS5jYWxsKG51bGwsVmUuYj9WZS5iKGEpOlZlLmNhbGwobnVsbCxhKSk6SGMoYSk/eGEuYj94YS5iKHBnLmI/cGcuYihPLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpKTpwZy5jYWxsKG51bGwsTy5iP08uYihhKTpPLmNhbGwobnVsbCxhKSkpOnhhLmNhbGwobnVsbCxwZy5iP3BnLmIoTy5iP08uYihhKTpPLmNhbGwobnVsbCxhKSk6cGcuY2FsbChudWxsLE8uYj9PLmIoYSk6Ty5jYWxsKG51bGwsYSkpKTpudWxsfX19KCkpO3Rocm93IEVycm9yKFwiRVM2IFByb3h5IG5vdCBzdXBwb3J0ZWQhXCIpO30pO1YucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTthYy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2tjLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07QmYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtcbnZmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07d2YucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtiZC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2dkLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07Y2QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtXLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07b2QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTt5ZS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O0FlLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07XG4kLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07WS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2xhLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07eGYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtRZi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9OyRmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07Y2cucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtvZy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1QucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtcblpiLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07SWUucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtIZS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O3AoXCJtb3JpLl9lcXVpdlwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuSGMoYil9KTtwKFwibW9yaS5fa2V5c1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmtleXMoKX0pO3AoXCJtb3JpLl92YWx1ZXNcIixmdW5jdGlvbihhKXtyZXR1cm4gYS52YWx1ZXMoKX0pO3AoXCJtb3JpLl9lbnRyaWVzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuZW50cmllcygpfSk7cChcIm1vcmkuX2hhc1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmhhcygpfSk7cChcIm1vcmkuX2dldFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmdldCgpfSk7cChcIm1vcmkuX2ZvckVhY2hcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5mb3JFYWNoKCl9KTtcbnAoXCJtb3JpLl9uZXh0XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEubmV4dCgpfSk7cChcIm1vcmkubXV0YWJsZS50aGF3XCIsZnVuY3Rpb24oYSl7cmV0dXJuIHliKGEpfSk7cChcIm1vcmkubXV0YWJsZS5mcmVlemVcIix2ZCk7cChcIm1vcmkubXV0YWJsZS5jb25qMVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuS2EobnVsbCxiKX0pO3AoXCJtb3JpLm11dGFibGUuY29ualwiLHdkKTtwKFwibW9yaS5tdXRhYmxlLmFzc29jXCIseGQpO3AoXCJtb3JpLm11dGFibGUuZGlzc29jXCIseWQpO3AoXCJtb3JpLm11dGFibGUucG9wXCIsZnVuY3Rpb24oYSl7cmV0dXJuIEViKGEpfSk7cChcIm1vcmkubXV0YWJsZS5kaXNqXCIsemQpO2Z1bmN0aW9uIE1pKGEsYixjLGQpe3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2QsbnVsbF0sbnVsbCksbmV3IGxhKG51bGwsMyxbJGcsYyxYZyxiLFZnLGFdLG51bGwpKX1mdW5jdGlvbiBOaShhKXtyZXR1cm4gYS5iP2EuYigwKTphLmNhbGwobnVsbCwwKX1mdW5jdGlvbiBPaShhKXtyZXR1cm4gVmcuYih4YyhhKSkuY2FsbChudWxsLE5pKGEpKX1mdW5jdGlvbiBQaShhKXtpZihyKE9pKGEpKSlyZXR1cm4gWGcuYih4YyhhKSkuY2FsbChudWxsLE5pKGEpKTt0aHJvd1wiY2FsbGVkIGNoaWxkcmVuIG9uIGEgbGVhZiBub2RlXCI7fWZ1bmN0aW9uIFFpKGEsYixjKXtyZXR1cm4gJGcuYih4YyhhKSkuY2FsbChudWxsLGIsYyl9XG5mdW5jdGlvbiBSaShhKXtpZihyKE9pKGEpKSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksZD1QaShhKSxlPVAuYyhkLDAsbnVsbCksZj0kYyhkKTtyZXR1cm4gcihkKT9OKG5ldyBXKG51bGwsMiw1LFgsW2UsbmV3IGxhKG51bGwsNCxbWmcscWUsYWgscihjKT9wYy5hKGFoLmIoYyksYik6bmV3IFcobnVsbCwxLDUsWCxbYl0sbnVsbCksVWcsYyxXZyxmXSxudWxsKV0sbnVsbCkseGMoYSkpOm51bGx9cmV0dXJuIG51bGx9XG5mdW5jdGlvbiBTaShhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxkPU1jKGMpP1MuYShUZixjKTpjLGM9US5hKGQsWmcpLGU9US5hKGQsVWcpLGY9US5hKGQsYWgpLGg9US5hKGQsV2cpLGQ9US5hKGQsYmgpO3JldHVybiByKGYpPyhmPXljKGYpLE4ocihkKT9uZXcgVyhudWxsLDIsNSxYLFtRaShhLGYsdGQuYShjLE0oYixoKSkpLHIoZSk/Ui5jKGUsYmgsITApOmVdLG51bGwpOm5ldyBXKG51bGwsMiw1LFgsW2YsZV0sbnVsbCkseGMoYSkpKTpudWxsfWZ1bmN0aW9uIFRpKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyksZj1QLmMoZSwwLG51bGwpLGg9JGMoZSk7cmV0dXJuIHIocihjKT9lOmMpP04obmV3IFcobnVsbCwyLDUsWCxbZixSLmQoYyxaZyxwYy5hKGQsYiksSihbV2csaF0sMCkpXSxudWxsKSx4YyhhKSk6bnVsbH1cbmZ1bmN0aW9uIFVpKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyk7cmV0dXJuIHIocihjKT9lOmMpP04obmV3IFcobnVsbCwyLDUsWCxbb2MoZSksUi5kKGMsWmcsUy5uKHBjLGQsYixoZyhlKSksSihbV2csbnVsbF0sMCkpXSxudWxsKSx4YyhhKSk6YX1mdW5jdGlvbiBWaShhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxjPU1jKGMpP1MuYShUZixjKTpjLGQ9US5hKGMsWmcpLGU9US5hKGMsV2cpO3JldHVybiByKHIoYyk/RShkKTpjKT9OKG5ldyBXKG51bGwsMiw1LFgsW3ljKGQpLFIuZChjLFpnLHpjKGQpLEooW1dnLE0oYixlKV0sMCkpXSxudWxsKSx4YyhhKSk6bnVsbH1cbmZ1bmN0aW9uIFdpKGEsYil7UC5jKGEsMCxudWxsKTt2YXIgYz1QLmMoYSwxLG51bGwpO3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2IsUi5jKGMsYmgsITApXSxudWxsKSx4YyhhKSl9dmFyIFhpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQsZSl7dmFyIGY9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxkLGYpfWZ1bmN0aW9uIGIoYSxiLGUpe3JldHVybiBXaShhLFMuYyhiLE5pKGEpLGUpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUcoYSk7cmV0dXJuIGIoZCxlLGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtwKFwibW9yaS56aXAuemlwcGVyXCIsTWkpO3AoXCJtb3JpLnppcC5zZXFfemlwXCIsZnVuY3Rpb24oYSl7cmV0dXJuIE1pKE1jLEZkLGZ1bmN0aW9uKGEsYyl7cmV0dXJuIE4oYyx4YyhhKSl9LGEpfSk7cChcIm1vcmkuemlwLnZlY3Rvcl96aXBcIixmdW5jdGlvbihhKXtyZXR1cm4gTWkoSGMsRSxmdW5jdGlvbihhLGMpe3JldHVybiBOKHdlKGMpLHhjKGEpKX0sYSl9KTtwKFwibW9yaS56aXAubm9kZVwiLE5pKTtwKFwibW9yaS56aXAuaXNfYnJhbmNoXCIse30ueGMpO3AoXCJtb3JpLnppcC5jaGlsZHJlblwiLFBpKTtwKFwibW9yaS56aXAubWFrZV9ub2RlXCIsUWkpO3AoXCJtb3JpLnppcC5wYXRoXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGFoLmIoYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSl9KTtwKFwibW9yaS56aXAubGVmdHNcIixmdW5jdGlvbihhKXtyZXR1cm4gRShaZy5iKGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpKX0pO1xucChcIm1vcmkuemlwLnJpZ2h0c1wiLGZ1bmN0aW9uKGEpe3JldHVybiBXZy5iKGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpfSk7cChcIm1vcmkuemlwLmRvd25cIixSaSk7cChcIm1vcmkuemlwLnVwXCIsU2kpO3AoXCJtb3JpLnppcC5yb290XCIsZnVuY3Rpb24oYSl7Zm9yKDs7KXtpZihXYi5hKGVoLGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpKXJldHVybiBOaShhKTt2YXIgYj1TaShhKTtpZihyKGIpKWE9YjtlbHNlIHJldHVybiBOaShhKX19KTtwKFwibW9yaS56aXAucmlnaHRcIixUaSk7cChcIm1vcmkuemlwLnJpZ2h0bW9zdFwiLFVpKTtwKFwibW9yaS56aXAubGVmdFwiLFZpKTtcbnAoXCJtb3JpLnppcC5sZWZ0bW9zdFwiLGZ1bmN0aW9uKGEpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGM9TWMoYyk/Uy5hKFRmLGMpOmMsZD1RLmEoYyxaZyksZT1RLmEoYyxXZyk7cmV0dXJuIHIocihjKT9FKGQpOmMpP04obmV3IFcobnVsbCwyLDUsWCxbRihkKSxSLmQoYyxaZyxxZSxKKFtXZyx0ZC5kKEcoZCksbmV3IFcobnVsbCwxLDUsWCxbYl0sbnVsbCksSihbZV0sMCkpXSwwKSldLG51bGwpLHhjKGEpKTphfSk7cChcIm1vcmkuemlwLmluc2VydF9sZWZ0XCIsZnVuY3Rpb24oYSxiKXt2YXIgYz1QLmMoYSwwLG51bGwpLGQ9UC5jKGEsMSxudWxsKSxkPU1jKGQpP1MuYShUZixkKTpkLGU9US5hKGQsWmcpO2lmKG51bGw9PWQpdGhyb3dcIkluc2VydCBhdCB0b3BcIjtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFtjLFIuZChkLFpnLHBjLmEoZSxiKSxKKFtiaCwhMF0sMCkpXSxudWxsKSx4YyhhKSl9KTtcbnAoXCJtb3JpLnppcC5pbnNlcnRfcmlnaHRcIixmdW5jdGlvbihhLGIpe3ZhciBjPVAuYyhhLDAsbnVsbCksZD1QLmMoYSwxLG51bGwpLGQ9TWMoZCk/Uy5hKFRmLGQpOmQsZT1RLmEoZCxXZyk7aWYobnVsbD09ZCl0aHJvd1wiSW5zZXJ0IGF0IHRvcFwiO3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW2MsUi5kKGQsV2csTShiLGUpLEooW2JoLCEwXSwwKSldLG51bGwpLHhjKGEpKX0pO3AoXCJtb3JpLnppcC5yZXBsYWNlXCIsV2kpO3AoXCJtb3JpLnppcC5lZGl0XCIsWGkpO3AoXCJtb3JpLnppcC5pbnNlcnRfY2hpbGRcIixmdW5jdGlvbihhLGIpe3JldHVybiBXaShhLFFpKGEsTmkoYSksTShiLFBpKGEpKSkpfSk7cChcIm1vcmkuemlwLmFwcGVuZF9jaGlsZFwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIFdpKGEsUWkoYSxOaShhKSx0ZC5hKFBpKGEpLG5ldyBXKG51bGwsMSw1LFgsW2JdLG51bGwpKSkpfSk7XG5wKFwibW9yaS56aXAubmV4dFwiLGZ1bmN0aW9uKGEpe2lmKFdiLmEoZWgsYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSkpcmV0dXJuIGE7dmFyIGI7Yj1PaShhKTtiPXIoYik/UmkoYSk6YjtpZihyKGIpKXJldHVybiBiO2I9VGkoYSk7aWYocihiKSlyZXR1cm4gYjtmb3IoOzspaWYocihTaShhKSkpe2I9VGkoU2koYSkpO2lmKHIoYikpcmV0dXJuIGI7YT1TaShhKX1lbHNlIHJldHVybiBuZXcgVyhudWxsLDIsNSxYLFtOaShhKSxlaF0sbnVsbCl9KTtwKFwibW9yaS56aXAucHJldlwiLGZ1bmN0aW9uKGEpe3ZhciBiPVZpKGEpO2lmKHIoYikpZm9yKGE9Yjs7KWlmKGI9T2koYSksYj1yKGIpP1JpKGEpOmIscihiKSlhPVVpKGIpO2Vsc2UgcmV0dXJuIGE7ZWxzZSByZXR1cm4gU2koYSl9KTtwKFwibW9yaS56aXAuaXNfZW5kXCIsZnVuY3Rpb24oYSl7cmV0dXJuIFdiLmEoZWgsYS5iP2EuYigxKTphLmNhbGwobnVsbCwxKSl9KTtcbnAoXCJtb3JpLnppcC5yZW1vdmVcIixmdW5jdGlvbihhKXtQLmMoYSwwLG51bGwpO3ZhciBiPVAuYyhhLDEsbnVsbCksYj1NYyhiKT9TLmEoVGYsYik6YixjPVEuYShiLFpnKSxkPVEuYShiLFVnKSxlPVEuYShiLGFoKSxmPVEuYShiLFdnKTtpZihudWxsPT1iKXRocm93XCJSZW1vdmUgYXQgdG9wXCI7aWYoMDxPKGMpKWZvcihhPU4obmV3IFcobnVsbCwyLDUsWCxbeWMoYyksUi5kKGIsWmcsemMoYyksSihbYmgsITBdLDApKV0sbnVsbCkseGMoYSkpOzspaWYoYj1PaShhKSxiPXIoYik/UmkoYSk6YixyKGIpKWE9VWkoYik7ZWxzZSByZXR1cm4gYTtlbHNlIHJldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW1FpKGEseWMoZSksZikscihkKT9SLmMoZCxiaCwhMCk6ZF0sbnVsbCkseGMoYSkpfSk7O3JldHVybiB0aGlzLm1vcmk7fS5jYWxsKHt9KTt9KTtcbiIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogQSBgU2VxdWVuY2VyYCBhZHZhbmNlcyBpdHMgdW5kZXJseWluZyBzZXF1ZW5jZSBvbiBgYWR2YW5jZSgpYCwgYW5kIHByb3ZpZGVzIHRoYXQgdmFsdWUgb24gYHZhbHVlKClgLiBUaGUgb25seVxuICAgKiBndWFyYW50ZWUgYSBzZXF1ZW5jZXIgcHJvdmlkZXMgaXMgdGhhdCBgdmFsdWUoKWAgaXMgYWx3YXlzIG5vbi1kZWNyZWFzaW5nIG92ZXIgdGltZSAoaS5lLiwgYWZ0ZXIgbXVsdGlwbGUgY2FsbHNcbiAgICogdG8gYGFkdmFuY2UoKWAsIGEgc2VxdWVuY2VyIHdpbGwgbmV2ZXIgYmUgc21hbGxlciB0aGFuIHRoZSBwcmV2aW91cyBjYWxsIC0gYnV0IGl0IG1heSBhbHNvIG5vdCBiZSBiaWdnZXIpLlxuICAgKlxuICAgKi9cbiAgdmFyIFVuaXRTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChVbml0U2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgICAgICAgICAgID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc2VxdWVuY2UgPSBvcHRzLmdldE9yRWxzZShcImluaXRpYWxTZXF1ZW5jZVwiLCAwKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQWR2YW5jZXMgaXRzIHNlcXVlbmNlIGJ5IGBieWAsIG9yIGJ5IGAxYCBpZiBgYnlgIGlzIG5vdCBwcm92aWRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBieSB7bnVtYmVyfSB0aGUgYW1vdW50IHRvIGFkdmFuY2UgYnkuIERlZmF1bHRzIHRvIGAxYC5cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx1bmRlZmluZWQ+fVxuICAgICAqL1xuICAgIGFkdmFuY2U6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGJ5KSB7XG4gICAgICAvLyBXYWhoIHdhaGggLSBkb24ndCB1c2UgYGJ5IHx8IDFgLCBvciB5b3UgY2FuJ3QgYWR2YW5jZSBieSAwLCB3aGljaCBpcyBzaWxseVxuICAgICAgLy8gYnV0IHBvdGVudGlhbGx5IG5lY2Vzc2FyeS5cbiAgICAgIGJ5ICAgICAgICAgICAgID0gXy5pc1VuZGVmaW5lZChieSkgPyAxIDogYnk7XG5cbiAgICAgIGlmIChieSA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5pdFNlcXVlbmNlciNhZHZhbmNlKCkgcmVxdWlyZXMgcG9zaXRpdmUgYGJ5YCBvZmZzZXRcIik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3NlcXVlbmNlID0gdGhpcy5fc2VxdWVuY2UgKyBieTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgc2VxdWVuY2UuIFRoaXMgdmFsdWUgc2hvdWxkIGFsd2F5cyBiZSB0aGUgc2FtZVxuICAgICAqIG9yIGdyZWF0ZXIgdGhhbiBhIHZhbHVlIHJldHVybmVkIHByZXZpb3VzbHkgKGluIHRpbWUpLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIGN1cnJlbnQgc2VxdWVuY2VcbiAgICAgKi9cbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2VxdWVuY2U7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gVW5pdFNlcXVlbmNlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogU2VlIGBVbml0U2VxdWVuY2VyYCBmb3IgYSBoaWdoLWxldmVsIGV4cGxhbmF0aW9uIG9mIFNlcXVlbmNlciBzZW1hbnRpY3MuXG4gICAqXG4gICAqIEEgU2VxdWVuY2VyIHdoaWNoIGFkdmFuY2VzIGJ5IHJlYWRpbmcgZnJvbSBhIENsb2NrLlxuICAgKiBOb3RlIHRoYXQgdGhpcyBDbG9ja1NlcXVlbmNlciByZWxpZXMgb24gdGhlIENsb2NrIHByb3RvY29sLCB3aGljaFxuICAgKiBvbmx5IHByb3ZpZGVzIGBDbG9jayNnZXRUaW1lKClgLiBJdCBkb2VzIG5vdCBtb2RpZnkgdGhlIGNsb2NrIGl0c2VsZi5cbiAgICogVGhpcyBtZWFucyBpZiB5b3UncmUgdXNpbmcgYSBMb2dpY2FsQ2xvY2ssIGl0J3Mgc3RpbGwgdXAgdG8gdGhlIGNsb2NrJ3NcbiAgICogb3duZXIgdG8gYWR2YW5jZSB0aGUgY2xvY2sgZm9yIHRoZSBzZXF1ZW5jZXIgdG8gYWR2YW5jZS5cbiAgICovXG4gIHZhciBDbG9ja1NlcXVlbmNlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgXy5leHRlbmQoQ2xvY2tTZXF1ZW5jZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5fY2xvY2sgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJjbG9ja1wiKTtcbiAgICAgIHRoaXMuX3NlcXVlbmNlID0gb3B0cy5nZXRPckVsc2UoXCJpbml0aWFsU2VxdWVuY2VcIiwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFkdmFuY2VzIGJ5IHNldHRpbmcgaXRzIHNlcXVlbmNlIHRvIHRoZSBiYWNraW5nIGNsb2NrJ3MgdGltZS5cbiAgICAgKiBOb3RlIHRoYXQgaWYgdGhpcyBtZXRob2QgaXMgY2FsbGVkIHR3aWNlIHdpdGhpbiB0aGUgc2FtZSB0aW1lIHVuaXQsXG4gICAgICogdGhlIHNlcXVlbmNlIHdpbGwgbm90IGFjdHVhbGx5IGFkdmFuY2UsIHNpbmNlIHVuaXF1ZSB0aW1lIGlzIG5vdFxuICAgICAqIGd1YXJhbnRlZWQgYnkgb3VyIGNsb2Nrcy5cbiAgICAgKlxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPD59XG4gICAgICovXG4gICAgYWR2YW5jZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fY2xvY2suZ2V0VGltZSgpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbih0KSB7XG4gICAgICAgICAgdGhpcy5fc2VxdWVuY2UgPSB0O1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgc2VxdWVuY2UuIFRoaXMgdmFsdWUgc2hvdWxkIGFsd2F5cyBiZSB0aGUgc2FtZVxuICAgICAqIG9yIGdyZWF0ZXIgdGhhbiBhIHZhbHVlIHJldHVybmVkIHByZXZpb3VzbHkgKGluIHRpbWUpLlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIGN1cnJlbnQgc2VxdWVuY2VcbiAgICAgKi9cbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2VxdWVuY2U7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ2xvY2tTZXF1ZW5jZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIFNlZSBgVW5pdFNlcXVlbmNlcmAgZm9yIGEgaGlnaC1sZXZlbCBleHBsYW5hdGlvbiBvZiBTZXF1ZW5jZXIgc2VtYW50aWNzLlxuICAgKlxuICAgKiBBIFVuaXRTZXF1ZW5jZXIgd2hpY2ggcmVwb3J0cyBpdHMgc2VxdWVuY2Ugc3VtbWVkIHdpdGggdGhlIHNlcXVlbmNlc1xuICAgKiBvZiBpdHMgaW50ZXJuYWwgY29sbGVjdGlvbiBvZiBzZXF1ZW5jZXJzLlxuICAgKlxuICAgKiBUaGlzIGRldmljZSBpcyB1c2VmdWwgZm9yIHRyYWNraW5nIHRoZSBzdGF0ZSBvZiBkYXRhIGNvbXByaXNlZCBmcm9tIG11bHRpcGxlXG4gICAqIHNvdXJjZXMuIEZvciBpbnN0YW5jZSwgeW91IG1pZ2h0IGhhdmUgQ2FjaGluZ0RhdGFTdG9yZShBKSBzdG9yaW5nIGRhdGFcbiAgICogZnJvbSBTb3VyY2UoQSksIHRyYWNrZWQgYnkgU2VxdWVuY2VyKEEpLCBhbmQgQ2FjaGluZ0RhdGFTdG9yZShCKSBzdG9yaW5nXG4gICAqIGRhdGEgZnJvbSBTb3VyY2UoQiksIHRyYWNrZWQgYnkgU2VxdWVuY2VyKEIpLiBNZWFud2hpbGUsIHlvdSBtYXkgaGF2ZVxuICAgKiBDYWNoaW5nRGF0YVN0b3JlKEMpLCBzdG9yaW5nIGRhdGEgZnJvbSBTb3VyY2UoQSArIEIpLCBhbmQgdHJhY2tlZCBieVxuICAgKiBTZXF1ZW5jZXIoQykgPSBTZXF1ZW5jZXIoQSArIEIpIC0gYSBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyLlxuICAgKlxuICAgKiBUaHVzLCBpZiBTZXF1ZW5jZXIoQSkgaXMgYWR2YW5jZWQsIGl0IG1heSBpbnZhbGlkYXRlIENhY2hpbmdEYXRhU3RvcmUoQSkgb3JcbiAgICogQ2FjaGluZ0RhdGFTdG9yZShDKSBvciBib3RoLlxuICAgKlxuICAgKiBOb3RlIHRoaXMgcGFydGljdWxhciB1c2FnZSBpcyBnZW5lcmFsbHkgb25seSB1c2VmdWwgZm9yIFVuaXQgc2VxdWVuY2Vycy5cbiAgICpcbiAgICogSWYgeW91J2QgbGlrZSB0aGUgYWJvdmUgZnVuY3Rpb25hbGl0eSwgYnV0IHdpdGggU2VxdWVuY2VyKEEpIGFuZFxuICAgKiBTZXF1ZW5jZXIoQikgYXMgQ2xvY2tTZXF1ZW5jZXJzLCBhbmQgU2VxdWVuY2VyKEMpIG1lcmVseSB0cmFja2luZ1xuICAgKiBtb2RpZmljYXRpb24sIHlvdSdkIG5lZWQgdG8gdXNlIGEgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIgZm9yIEEgYW5kIEIsXG4gICAqIGZvcndhcmRpbmcgdGhlbSB0byBVbml0U2VxdWVuY2VyKEMpLlxuICAgKlxuICAgKiBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyIGFuZCBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlciBhcmUgZWZmZWN0aXZseVxuICAgKiBvcHBvc2l0ZXMgb2YgZWFjaCBvdGhlci4gRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlciBjb21wb3NlcyB0aGUgYHZhbHVlYFxuICAgKiBvZiBtdWx0aXBsZSB1bmRlcmx5aW5nIHNlcXVlbmNlcnMgKHB1bGwpLCBhbmQgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXJcbiAgICogZm9yd2FyZHMgdGhlIGBhZHZhbmNlYCBjYWxsIHRvIG11bHRpcGxlIHRhcmdldHMgKHB1c2gpLlxuICAgKi9cbiAgdmFyIERlbGVnYXRpbmdDb21wb3NpdGVTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZVNlcXVlbmNlciA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpO1xuICAgICAgdGhpcy5fc2VxdWVuY2VycyA9IF8uY2xvbmUob3B0cy5nZXRPckVsc2UoXCJzZXF1ZW5jZXJzXCIsIFtdKSk7XG4gICAgfSxcbiAgICBhZGRTZXF1ZW5jZXI6IGZ1bmN0aW9uKHNlcSkge1xuICAgICAgdGhpcy5fc2VxdWVuY2Vycy5wdXNoKHNlcSk7XG4gICAgfSxcbiAgICBhZHZhbmNlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzID0gdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXI7XG4gICAgICByZXR1cm4gcy5hZHZhbmNlLmFwcGx5KHMsIGFyZ3VtZW50cyk7XG4gICAgfSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gX1xuICAgICAgICAuY2hhaW4odGhpcy5fc2VxdWVuY2VycylcbiAgICAgICAgLmludm9rZShcInZhbHVlXCIpXG4gICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24oc3VtLCBuKSB7XG4gICAgICAgICAgcmV0dXJuIHN1bSArIG47XG4gICAgICAgIH0sIDApXG4gICAgICAgIC52YWx1ZSgpICsgdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXIudmFsdWUoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBTZWUgYFVuaXRTZXF1ZW5jZXJgIGZvciBhIGhpZ2gtbGV2ZWwgZXhwbGFuYXRpb24gb2YgU2VxdWVuY2VyIHNlbWFudGljcy5cbiAgICpcbiAgICogQSBTZXF1ZW5jZXIgd2hpY2ggZGVsZWdhdGVzIHRvIGFub3RoZXIgc2VxdWVuY2VyIGZvciBib3RoIGBhZHZhbmNlYCBhbmQgYHZhbHVlYCwgYW5kIGFsc28gZm9yd2FyZHMgYGFkdmFuY2VgIHRvXG4gICAqIG90aGVyIGB0YXJnZXRgIHNlcXVlbmNlcnMuIEl0IGlzIHRoZSBsb2dpY2FsIGNvbXBsZW1lbnQgb2YgYSBgRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlcmAsIHdoaWNoIGRlcml2ZXMgaXRzIGB2YWx1ZWAgZnJvbVxuICAgKiBpdHMgdW5kZXJseWluZyBgc2VxdWVuY2Vyc2AuXG4gICAqXG4gICAqXG4gICAqL1xuICB2YXIgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXIgPSBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKTtcbiAgICAgIHRoaXMuX2ZvcndhcmRUYXJnZXRzID0gXy5jbG9uZShvcHRzLmdldE9yRWxzZShcInRhcmdldHNcIiwgW10pKTtcbiAgICB9LFxuICAgIGFkZFRhcmdldDogZnVuY3Rpb24oc2VxKSB7XG4gICAgICB0aGlzLl9mb3J3YXJkVGFyZ2V0cy5wdXNoKHNlcSk7XG4gICAgfSxcbiAgICBhZHZhbmNlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzID0gdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXI7XG4gICAgICByZXR1cm4gcy5hZHZhbmNlLmFwcGx5KHMsIGFyZ3VtZW50cylcbiAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAudGhlbihmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYWxsKF8uaW52b2tlKHRoaXMuX2ZvcndhcmRUYXJnZXRzLCBcImFkdmFuY2VcIikpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoZSBkZWxlZ2F0ZSBzZXF1ZW5jZXInc1xuICAgICAgICAgICAgLy8gYWR2YW5jZSBjYWxsIChpZiBhbnkpLiBUaGUgYWR2YW5jZW1lbnQgb2YgdGhlIGZvcndhcmRcbiAgICAgICAgICAgIC8vIHRhcmdldHMgc2hvdWxkIGJlIHRyYW5zcGFyZW50LlxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pLFxuICAgIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzID0gdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXI7XG4gICAgICByZXR1cm4gcy52YWx1ZS5hcHBseShzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuICAvKipcbiAgICogQSBDbG9jayB3aGljaCBhbGxvd3MgbWFudWFsbHkgbWFuaXB1bGF0aW5nIHRoZSB1bmRlcmx5aW5nIHRpbWUgdmFsdWUsXG4gICAqIGlycmVzcGVjdGl2ZSBvZiByZWFsIHRpbWUuIFVzZWZ1bCBmb3IgdGVzdGluZy5cbiAgICovXG4gIHZhciBMb2dpY2FsQ2xvY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMb2dpY2FsQ2xvY2sucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2N1cnJlbnRUaW1lID0gb3B0cy5nZXRPckVsc2UoXCJpbml0aWFsVGltZVwiLCAwKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8bnVtYmVyPn0gVGltZSBpbiBtaWxsaXNlY29uZHMgc2luY2UgZXBvY2hcbiAgICAgKiBAc2VlIENsb2NrI2dldFRpbWUoKVxuICAgICAqL1xuICAgIGdldFRpbWU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRUaW1lO1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogQWR2YW5jZXMgaW50ZXJuYWwgdGltZSwgZWl0aGVyIGBvcHRzLmJ5YCBhIGNlcnRhaW4gb2Zmc2V0LCBvclxuICAgICAqIGBvcHRzLnRvYCBhIHBhcnRpY3VsYXIgYWJzb2x1dGUgdGltZS4gSWYgc3VjY2Vzc2Z1bCwgcmV0dXJucyB0aGUgcmVzdWx0XG4gICAgICogb2YgY2FsbGluZyBgTG9naWNhbENsb2NrI2dldFRpbWUoKWAgYXMgYSBjb252ZW5pZW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRzLnRvIHtudW1iZXJ9IGFic29sdXRlIHRpbWUgdG8gc2V0IGNsb2NrIHRvLiBNdXN0IGJlIGxhcmdlclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgIHRoYW4gdGhlIGN1cnJlbnQgdGltZVxuICAgICAqIEBwYXJhbSBvcHRzLmJ5IHtudW1iZXJ9IG9mZnNldCB0byBhZGQgdG8gY3VycmVudCB0aW1lLiBNdXN0IGJlIHBvc2l0aXZlLlxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgIERlZmF1bHRzIHRvIGAxYCBpZiBuZWl0aGVyIGBvcHRzLnRvYCBvciBgb3B0cy5ieWBcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICBhcmUgc3BlY2lmaWVkLlxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG51bWJlcj59IHJlc3VsdCBvZiBgTG9naWNhbENsb2NrI2dldFRpbWUoKWBcbiAgICAgKi9cbiAgICBhZHZhbmNlVGltZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ob3B0cyl7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdmFyIGJ5ID0gb3B0cy5nZXRPckVsc2UoXCJieVwiLCAxKSxcbiAgICAgICAgICB0byA9IG9wdHMuZ2V0T3JFbHNlKFwidG9cIiwgdW5kZWZpbmVkKTtcbiAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh0bykpIHtcbiAgICAgICAgaWYgKHRvIDwgdGhpcy5fY3VycmVudFRpbWUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMb2dpY2FsQ2xvY2sjYWR2YW5jZVRpbWUoKSByZXF1aXJlcyBmb3J3YXJkIG1vdmVtZW50IG9mIHRpbWVcIilcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdXJyZW50VGltZSA9IHRvO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGJ5IDwgMCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxvZ2ljYWxDbG9jayNhZHZhbmNlVGltZSgpIHJlcXVpcmVzIGZvcndhcmQgbW92ZW1lbnQgb2YgdGltZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdXJyZW50VGltZSA9IHRoaXMuX2N1cnJlbnRUaW1lICsgYnk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5nZXRUaW1lKCk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIExvZ2ljYWxDbG9jaztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2Vcbikge1xuXG4gIC8qKlxuICAgKiBBIENsb2NrIHdoaWNoIGRlbGVnYXRlcyB0byB0aGUgc3lzdGVtIGNsb2NrLlxuICAgKi9cbiAgdmFyIFN5c3RlbUNsb2NrID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoU3lzdGVtQ2xvY2sucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcbiAgICAvKipcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxudW1iZXI+fSBUaW1lIGluIG1pbGxpc2Vjb25kcyBzaW5jZSBlcG9jaFxuICAgICAqIEBzZWUgQ2xvY2sjZ2V0VGltZSgpXG4gICAgICovXG4gICAgZ2V0VGltZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRGF0ZS5ub3coKTtcbiAgICB9KVxuICB9KTtcblxuICByZXR1cm4gU3lzdGVtQ2xvY2s7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBTY29wZWRDb25maWd1cmF0aW9uXG4pIHtcblxuICAvKipcbiAgICogQSBkZXZpY2UgZm9yIHJlc29sdmluZyBhIHNldCBvZiByYXcgY29uZmlndXJhdGlvbnMgZ2l2ZW4gYSBzZXQgb2ZcbiAgICogc2NvcGVzLlxuICAgKlxuICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3IgaGF2aW5nIHRoaW5ncyBsaWtlIHJlZ2lvbi0gb3Igc3RhZ2Utc3BlY2lmaWMgKGFuZC9vciBib3RoKVxuICAgKiBjb25maWd1cmF0aW9ucy5cbiAgICpcbiAgICogR2l2ZW4gc2V0cyBvZiByYXcgY29uZmlndXJhdGlvbnMgb2YgdGhlIGZvcm06XG4gICAqXG4gICAqICAge1xuICAgKiAgICAgXCJzY29wZS0xXCIgOiB7XG4gICAqICAgICAgIFwia2V5MVwiIDogXCJ2YWwxXCJcbiAgICogICAgIH0sXG4gICAqICAgICBcInNjb3BlLTErZW52MVwiOiB7XG4gICAqICAgICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTFcIlxuICAgKiAgICAgfSxcbiAgICogICAgIFwic2NvcGUtMStlbnYyXCI6IHtcbiAgICogICAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMlwiXG4gICAqICAgICB9XG4gICAqICAgfVxuICAgKlxuICAgKiBgcmVzb2x2ZShbXCJzY29wZS0xXCJdKWAgd2lsbCByZXR1cm46XG4gICAqXG4gICAqICAge1xuICAgKiAgICAgXCJrZXkxXCIgOiBcInZhbDJcIlxuICAgKiAgIH1cbiAgICpcbiAgICogYHJlc29sdmUoW1wic2NvcGUtMVwiLCBcImVudi0xXCJdKWAgd2lsbCByZXR1cm46XG4gICAqXG4gICAqICAge1xuICAgKiAgICAgXCJrZXkxXCIgOiBcInZhbDFcIixcbiAgICogICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTFcIlxuICAgKiAgIH1cbiAgICpcbiAgICogYHJlc29sdmUoW1wic2NvcGUtMVwiLCBcImVudi0yXCJdKWAgd2lsbCByZXR1cm46XG4gICAqXG4gICAqICAge1xuICAgKiAgICAgXCJrZXkxXCIgOiBcInZhbDFcIixcbiAgICogICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTJcIlxuICAgKiAgIH1cbiAgICpcbiAgICogU2NvcGVzIHVuaW9ucyBhcmUgcmVzb2x2ZWQgaW4gdGhlIGZvbGxvd2luZyBtYW5uZXI6XG4gICAqICAgMS4gYSBnaXZlbiBzY29wZSB1bmlvbidzIHBhcnRzIGFyZSBzb3J0ZWRcbiAgICogICAyLiBzY29wZSB1bmlvbnMgYXMgYSB3aG9sZSBhcmUgYXBwbGllZCBpbiBzb3J0ZWQgb3JkZXJcbiAgICogICAzLiByZXBlYXQgdGhlIHByb2Nlc3MgZm9yIGEgZ2l2ZW4gY29uZmlndXJhdGlvblxuICAgKlxuICAgKiBTbywgZ2l2ZW4gdGhyZWUgY29uZmlnczpcbiAgICpcbiAgICogIHtcbiAgICogICAgXCJhYWFcIjogLi4uIC8vIDFcbiAgICogICAgXCJjY2NcIjogLi4uIC8vIDJcbiAgICogIH1cbiAgICpcbiAgICogIHtcbiAgICogICAgXCJhYWErY2NjXCI6IC4uLiAvLyAzXG4gICAqICAgIFwiY2NjXCIgICAgOiAuLi4gLy8gNFxuICAgKiAgfVxuICAgKlxuICAgKiAge1xuICAgKiAgICBcImFhYStiYmJcIjogLi4uIC8vIDVcbiAgICogICAgXCJiYmJcIiAgICA6IC4uLiAvLyA2XG4gICAqICB9XG4gICAqXG4gICAqIFRoZSByZXN1bHRpbmcgb3JkZXIgd2lsbCBiZTpcbiAgICogICAxLCAyLCA0LCAzLCA2LCA1XG4gICAqXG4gICAqIE5vdGljZSAzIGNvbWVzIGJlZm9yZSA1IGV2ZW4gdGhvdWdoIGl0J3MgbG9naWNhbGx5IFwiYWZ0ZXJcIiBpbiBzb3J0ZWQgb3JkZXIsXG4gICAqIGJlY2F1c2UgY29uZmlndXJhdGlvbiBvcmRlciBvdmVycmlkZXMgc2NvcGUgb3JkZXIuIFRoYXQgaXMsIHNjb3BlIHVuaW9uc1xuICAgKiBhcmUgb3JkZXJlZCB3aXRoaW4gYSBjb25maWcsIGFuZCB0aGVuIGluIGNvbmZpZyBvcmRlci5cbiAgICpcbiAgICovXG4gIHZhciBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2NvbmZpZ3MgPSBbXTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQSByYXdDb25maWcgaXMgYSBzZXQgb2YgY29uZmlndXJhdGlvbiBzY29wZXMgYW5kIHRoZWlyIGNvbmZpZ3VyYXRpb25cbiAgICAgKiB2YWx1ZXMsIGUuZy46XG4gICAgICpcbiAgICAgKiAgIHtcbiAgICAgKiAgICAgXCJzY29wZS0xXCIgOiB7XG4gICAgICogICAgICAgXCJrZXkxXCIgOiBcInZhbDFcIlxuICAgICAqICAgICB9LFxuICAgICAqICAgICBcInNjb3BlLTErZW52MVwiOiB7XG4gICAgICogICAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMVwiXG4gICAgICogICAgIH0sXG4gICAgICogICAgIFwic2NvcGUtMStlbnYyXCI6IHtcbiAgICAgKiAgICAgICBcImtleTJcIiA6IFwidmFsLWVudi0yXCJcbiAgICAgKiAgICAgfVxuICAgICAqICAgfVxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoZSBwbHVzICgrKSBzaWduIGlzIHJlc2VydmVkIGZvciBzcGVjaWZ5aW5nIHNjb3BlIHVuaW9ucy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByYXdDb25maWcge29iamVjdH0gKHJlcXVpcmVkKVxuICAgICAqXG4gICAgICogQHJldHVybnMgdGhpc1xuICAgICAqL1xuICAgIGFkZDogZnVuY3Rpb24ocmF3Q29uZmlnKSB7XG4gICAgICB0aGlzLl9jb25maWdzLnB1c2gobmV3IFNjb3BlZENvbmZpZ3VyYXRpb24ocmF3Q29uZmlnKSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVzb2x2ZXMgYSBjb21wdXRlZCBmaW5hbCBjb25maWd1cmF0aW9uIGdpdmVuIGEgc2V0IG9mIHNjb3BlcyB0byBhcHBseSxcbiAgICAgKiBhbmQgYSBzZXQgb2YgY29uZmlncyBsb2FkZWQgdmlhIGBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXIjYWRkKClgLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3BlcyB7QXJyYXk8c3RyaW5nPn1cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IHRoZSBjb21wdXRlZCBjb25maWd1cmF0aW9uXG4gICAgICovXG4gICAgcmVzb2x2ZTogZnVuY3Rpb24oc2NvcGVzKSB7XG4gICAgICBzY29wZXMgPSBwb3dlcnNldChfLmNsb25lKHNjb3Blcykuc29ydCgpKTtcbiAgICAgIHNjb3Blcy5zaGlmdCgpOyAvLyBHZXQgcmlkIG9mIHRoZSBlbXB0eSBzZXQuXG5cbiAgICAgIHNjb3BlcyA9IF8uY29sbGVjdChzY29wZXMsIGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgcmV0dXJuIHMuam9pbihcIitcIik7XG4gICAgICB9KTtcblxuICAgICAgdmFyIHJlbGV2YW50Q29uZmlncyA9IF9cbiAgICAgICAgLmNoYWluKHRoaXMuX2NvbmZpZ3MpXG4gICAgICAgIC5jb2xsZWN0KGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgICByZXR1cm4gXy5jb2xsZWN0KHNjb3BlcywgZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjLmJsb2JGb3JTY29wZShzY29wZSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSkuZmxhdHRlbigpLnZhbHVlKCk7XG5cbiAgICAgIHJlbGV2YW50Q29uZmlncy51bnNoaWZ0KHt9KTtcbiAgICAgIHJldHVybiBfLmV4dGVuZC5hcHBseShfLCByZWxldmFudENvbmZpZ3MpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIHBvd2Vyc2V0ID0gZnVuY3Rpb24gKGFyeSkge1xuICAgICAgdmFyIHBzID0gW1tdXTtcbiAgICAgIGZvciAodmFyIGk9MDsgaSA8IGFyeS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGZvciAodmFyIGogPSAwLCBsZW4gPSBwcy5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgICAgICAgICBwcy5wdXNoKHBzW2pdLmNvbmNhdChhcnlbaV0pKTtcbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcHM7XG4gIH1cblxuICByZXR1cm4gU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi9zY29wZWQtY29uZmlndXJhdGlvblwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICogR2l2ZW4gYSByYXcgY29uZmlnLCBlbnN1cmVzIGJsb2JzIGNhbiBiZSBmZXRjaGVkIHJlZ2FyZGxlc3Mgb2ZcbiAgICogc2NvcGUgdW5pb24gc2NvcGUgKGkuZS4sIGRvZXMgdW5pb24gY2Fub25pY2FsaXphdGlvbikuXG4gICAqXG4gICAqIEZvciBleGFtcGxlLCBhIGNvbmZpZyB3aXRoIHNjb3BlIHVuaW9uIGBcImJiYithYWFcImAgY2FuIGxhdGVyIGJlXG4gICAqIGZldGNoZWQgdXNpbmcgZWl0aGVyIGBcImFhYStiYmJcImAgb3IgYFwiYmJiK2FhYVwiYC4gSXQgZG9lcyB0aGlzXG4gICAqIGJ5IHVuaWZvcm1seSBvcmRlcmluZyB0aGUgdW5pb24ncyBjb21wb3NpdGUgc2NvcGVzLlxuICAgKlxuICAgKiBUaGlzIHByb2JhYmx5IGlzbid0IGEgdXNlZnVsIGNsYXNzIG9uIGl0cyBvd24uIEluc3RlYWQsIGRlZmVyIHRvXG4gICAqIGBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXJgIG9yIGBDb25maWd1cmF0aW9uTWFnaWNgLlxuICAgKi9cbiAgdmFyIFNjb3BlZENvbmZpZ3VyYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKFNjb3BlZENvbmZpZ3VyYXRpb24ucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ocmF3Q29uZmlnKSB7XG4gICAgICByYXdDb25maWcgPSByYXdDb25maWcgfHwge307XG4gICAgICB0aGlzLl9zY29wZXMgPSB7fTtcbiAgICAgIC8vIFNvcnQgdGhlIHNjb3BlIHN0cmluZ3NcbiAgICAgIF8uZWFjaChyYXdDb25maWcsIGZ1bmN0aW9uKGNvbmZpZywgc2NvcGVTdHJpbmcpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gc2NvcGVTdHJpbmcuc3BsaXQoXCIrXCIpLnNvcnQoKS5qb2luKFwiK1wiKTtcbiAgICAgICAgdGhpcy5fc2NvcGVzW3Njb3BlXSA9IGNvbmZpZztcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBibG9iRm9yU2NvcGU6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICByZXR1cm4gXy5jbG9uZSh0aGlzLl9zY29wZXNbc2NvcGUuc3BsaXQoXCIrXCIpLnNvcnQoKS5qb2luKFwiK1wiKV0gfHwge30pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFNjb3BlZENvbmZpZ3VyYXRpb247XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUmVmLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogQSBMb2dnZXIuXG4gICAqXG4gICAqIEFueSBhcHBlbmRlciBwcm92aWRlZCB0byBgYWRkQXBwZW5kZXJgIHNob3VsZCBoYXZlIGEgLmxvZyBtZXRob2QgKHNlZSBgQ29uc29sZUxvZ0FwcGVuZGVyYCkuXG4gICAqXG4gICAqL1xuICB2YXIgTG9nZ2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9nZ2VyLnByb3RvdHlwZSwge1xuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX25hbWUgICAgICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwibmFtZVwiLCBcIkRlZmF1bHRcIik7XG4gICAgICB0aGlzLl9sb2dMZXZlbCAgICAgPSBvcHRzLmdldE9yRWxzZShcImxvZ0xldmVsXCIsIExvZ1V0aWwuTGV2ZWwuSW5mbyk7XG4gICAgICB0aGlzLl9wYXJlbnQgICAgICAgPSBvcHRzLmdldE9yRWxzZUZuKFwicmVmUGFyZW50XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gUmVmKG51bGwpIH0pO1xuICAgICAgdGhpcy5fbXV0ZWQgICAgICAgID0ge307XG4gICAgICB0aGlzLl9hcHBlbmRlcnMgPSBbXTtcbiAgICB9LFxuXG4gICAgbXV0ZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgdGhpcy5fbXV0ZWRbbmFtZV0gPSB0cnVlO1xuICAgIH0sXG5cbiAgICB1bm11dGU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIGRlbGV0ZSB0aGlzLl9tdXRlZFtuYW1lXTtcbiAgICB9LFxuXG4gICAgdHJhY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuVHJhY2UsIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgZGVidWc6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuRGVidWcsIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgaW5mbzogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sb2coTG9nVXRpbC5MZXZlbC5JbmZvLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIHdhcm46IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuV2FybiwgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sb2coTG9nVXRpbC5MZXZlbC5FcnJvciwgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICBmYXRhbDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9sb2coTG9nVXRpbC5MZXZlbC5GYXRhbCwgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICBpc1RyYWNlRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0xvZ0xldmVsRW5hYmxlZChMb2dVdGlsLkxldmVsLlRyYWNlKTtcbiAgICB9LFxuXG4gICAgaXNEZWJ1Z0VuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5EZWJ1Zyk7XG4gICAgfSxcblxuICAgIGlzSW5mb0VuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5JbmZvKTtcbiAgICB9LFxuXG4gICAgaXNXYXJuRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0xvZ0xldmVsRW5hYmxlZChMb2dVdGlsLkxldmVsLldhcm4pO1xuICAgIH0sXG5cbiAgICBpc0Vycm9yRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0xvZ0xldmVsRW5hYmxlZChMb2dVdGlsLkxldmVsLkVycm9yKTtcbiAgICB9LFxuXG4gICAgaXNGYXRhbEVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5GYXRhbCk7XG4gICAgfSxcblxuICAgIGlzTG9nTGV2ZWxFbmFibGVkOiBmdW5jdGlvbihsb2dMZXZlbCkge1xuICAgICAgdmFyIGNvZXJjZWRMb2dMZXZlbCA9IGIobG9nTGV2ZWwpO1xuICAgICAgcmV0dXJuIHRoaXMuX2lzQ29lcmNlZExvZ0xldmVsRW5hYmxlZChjb2VyY2VkTG9nTGV2ZWwpO1xuICAgIH0sXG5cbiAgICBfaXNDb2VyY2VkTG9nTGV2ZWxFbmFibGVkOiBmdW5jdGlvbihjb2VyY2VkTG9nTGV2ZWwpIHtcbiAgICAgIHJldHVybiAoKHRoaXMuX2xvZ0xldmVsICYgY29lcmNlZExvZ0xldmVsKSA9PT0gY29lcmNlZExvZ0xldmVsKSB8fFxuICAgICAgICAodGhpcy5fcGFyZW50LmdldCgpICYmIHRoaXMuX3BhcmVudC5nZXQoKS5faXNDb2VyY2VkTG9nTGV2ZWxFbmFibGVkKGNvZXJjZWRMb2dMZXZlbCkpO1xuICAgIH0sXG5cbiAgICBhZGRBcHBlbmRlcjogZnVuY3Rpb24oYXBwZW5kZXIpIHtcbiAgICAgIHRoaXMuX2FwcGVuZGVycy5wdXNoKGFwcGVuZGVyKTtcbiAgICB9LFxuXG4gICAgc2V0TG9nTGV2ZWw6IGZ1bmN0aW9uKGxvZ0xldmVsKSB7XG4gICAgICAvLyBTYXZlIGEgY29weSBmb3IgdGhlIHBvdGVudGlhbCBlcnJvciBtZXNzYWdlXG4gICAgICB2YXIgb3JpZ2luYWxMb2dMZXZlbCA9IGxvZ0xldmVsO1xuXG4gICAgICAvLyBJZiBuYW1lIGlzIHNwZWNpZmllZCwgZS5nLiwgXCJJbmZvXCIsIGNvbnZlcnQgdG9cbiAgICAgIC8vIGludFxuICAgICAgaWYgKF8uaXNTdHJpbmcobG9nTGV2ZWwpKSB7XG4gICAgICAgIGxvZ0xldmVsID0gTG9nVXRpbC5MZXZlbFtsb2dMZXZlbF1cbiAgICAgIH1cblxuICAgICAgdmFyIGV4aXN0cyA9IF8uZGV0ZWN0KExvZ1V0aWwuTGV2ZWwsIGZ1bmN0aW9uKGxldmVsLCBuYW1lKSB7XG4gICAgICAgIHJldHVybiBsZXZlbCA9PT0gbG9nTGV2ZWw7XG4gICAgICB9KTtcblxuICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBsb2dMZXZlbDogXCIgKyBvcmlnaW5hbExvZ0xldmVsKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fbG9nTGV2ZWwgPSBsb2dMZXZlbDtcbiAgICB9LFxuXG5cbiAgICBfbG9nOiBmdW5jdGlvbihsb2dMZXZlbCwgbG9nQXJncykge1xuICAgICAgdGhpcy5fbG9nV2l0aE1ldGFkYXRhKFtdLCBsb2dMZXZlbCwgbG9nQXJncyk7XG4gICAgfSxcblxuICAgIF9pc011dGVkOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gISF0aGlzLl9tdXRlZFtuYW1lXTtcbiAgICB9LFxuXG4gICAgX2xvZ1dpdGhNZXRhZGF0YTogZnVuY3Rpb24oZGVzY2VuZGFudHMsIGxvZ0xldmVsLCBhcmdzKSB7XG4gICAgICB2YXIgbGVhZiA9IGRlc2NlbmRhbnRzW2Rlc2NlbmRhbnRzLmxlbmd0aCAtIDFdIHx8IHRoaXMuX25hbWU7XG4gICAgICBpZiAodGhpcy5pc0xvZ0xldmVsRW5hYmxlZChsb2dMZXZlbCkgJiYgIXRoaXMuX2lzTXV0ZWQobGVhZikpIHtcbiAgICAgICAgXy5lYWNoKHRoaXMuX2FwcGVuZGVycywgZnVuY3Rpb24oYXBwZW5kZXIpIHtcbiAgICAgICAgICBhcHBlbmRlci5sb2codGhpcy5fbmFtZSwgZGVzY2VuZGFudHMsIGxvZ0xldmVsLCBMb2dVdGlsLl9MYWJlbFtsb2dMZXZlbF0sIGFyZ3MpO1xuICAgICAgICB9LCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX3BhcmVudC5nZXQoKSkge1xuICAgICAgICB0aGlzLl9wYXJlbnQuZ2V0KCkuX2xvZ1dpdGhNZXRhZGF0YShbdGhpcy5fbmFtZV0uY29uY2F0KGRlc2NlbmRhbnRzKSwgbG9nTGV2ZWwsIGFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdmFyIExvZ1V0aWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICAvLyBDb2VyY2UgKGp1c3QgdXNlIHJpZ2h0bW9zdCA4IGJpdHMpITsgYmVjYXVzZSBKUyBpcyBkdW1iLCBhbmQgZXZlcnl0aGluZyBpc1xuICAvLyBhY3R1YWxseSBhIGZsb2F0IHdpdGggNTMtYml0IHByZWNpc2lvblxuICB2YXIgYiA9IGZ1bmN0aW9uKHYpIHtcbiAgICByZXR1cm4gMHhGRiAmIHY7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9nVXRpbCwge1xuICAgIExldmVsOiB7XG4gICAgICBUcmFjZTogYihwYXJzZUludChcIjExMTExMVwiLCAyKSksXG4gICAgICBEZWJ1ZzogYihwYXJzZUludChcIjAxMTExMVwiLCAyKSksXG4gICAgICBJbmZvOiAgYihwYXJzZUludChcIjAwMTExMVwiLCAyKSksXG4gICAgICBXYXJuOiAgYihwYXJzZUludChcIjAwMDExMVwiLCAyKSksXG4gICAgICBFcnJvcjogYihwYXJzZUludChcIjAwMDAxMVwiLCAyKSksXG4gICAgICBGYXRhbDogYihwYXJzZUludChcIjAwMDAwMVwiLCAyKSlcbiAgICB9XG4gIH0pO1xuXG4gIF8uZXh0ZW5kKExvZ1V0aWwucHJvdG90eXBlLCB7XG4gICAgTGV2ZWw6IExvZ1V0aWwuTGV2ZWwsXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9yb290TG9nZ2VyID0gUmVmKG5ldyBMb2dnZXIoe1xuICAgICAgICBuYW1lOiBcIlJvb3RcIlxuICAgICAgfSkpO1xuICAgIH0sXG5cbiAgICBjcmVhdGU6IGZ1bmN0aW9uKG5hbWUsIG9wdHMpIHtcbiAgICAgIG9wdHMgPSBfLmNsb25lKG9wdHMgfHwge30pO1xuXG4gICAgICB2YXIgcGFyZW50O1xuICAgICAgaWYgKG9wdHMucGFyZW50KSB7XG4gICAgICAgIHBhcmVudCA9IFJlZihvcHRzLnBhcmVudCk7XG4gICAgICAgIGRlbGV0ZShvcHRzLnBhcmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJlbnQgPSBSZWYuZGVsZWdhdGluZyh0aGlzLl9yb290TG9nZ2VyKTtcbiAgICAgIH1cblxuICAgICAgb3B0cy5yZWZQYXJlbnQgPSBwYXJlbnQ7XG5cbiAgICAgIG9wdHMubmFtZSA9IG5hbWU7XG5cbiAgICAgIHJldHVybiBuZXcgTG9nZ2VyKG9wdHMpO1xuICAgIH0sXG5cbiAgICByb290OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yb290TG9nZ2VyLmdldCgpO1xuICAgIH0sXG5cbiAgICByZXNldFJvb3RMb2dnZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fcm9vdExvZ2dlci5zZXQobmV3IExvZ2dlcih7XG4gICAgICAgIG5hbWU6IFwiUm9vdFwiXG4gICAgICB9KSk7XG4gICAgfVxuICB9KTtcblxuXG4gIExvZ1V0aWwuX0xhYmVsID0gXy5yZWR1Y2UoTG9nVXRpbC5MZXZlbCwgZnVuY3Rpb24obWVtbywgdmFsLCBrZXkpIHtcbiAgICBtZW1vW3ZhbF0gPSBrZXk7XG4gICAgcmV0dXJuIG1lbW87XG4gIH0sIHt9KTtcblxuICByZXR1cm4gbmV3IExvZ1V0aWwoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL3JlZlwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTSxcbiAgVVVJRCxcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZFxuKSB7XG5cbiAgLyoqXG4gICAqIEEgY2hhbm5lbCBpcyBhIHBhdGggdGhyb3VnaCB3aGljaCBtZXNzYWdlcyBmbG93LlxuICAgKlxuICAgKiBDaGFubmVscyBhcmUgbWVhbnQgdG8gaGF2ZSBhIHNpbmdsZSBwdWJsaXNoZXIsIG11bHRpcGxlIHN1YnNjcmliZXJzLlxuICAgKlxuICAgKiBUaGlzIGlzIFwiZW5mb3JjZWRcIiB1c2luZyBhIHNlbnRpbmVsLiBUaGUgc2FtZSBzZW50aW5lbCBwcm92aWRlZCBkdXJpbmdcbiAgICogaW5zdGFudGlhdGlvbiBtdXN0IGJlIHVzZWQgd2hlbiBjYWxsaW5nIGBwdWJsaXNoYCwgZWxzZSBhbiBleGNlcHRpb25cbiAgICogaXMgcmFpc2VkLlxuICAgKlxuICAgKi9cbiAgdmFyIENoYW5uZWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDaGFubmVsLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX3NlbnRpbmVsICAgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJzZW50aW5lbFwiKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICAgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gTS5oYXNoX21hcCgpO1xuICAgIH0sXG5cbiAgICByZXNldDogZnVuY3Rpb24oKSB7XG4gICAgICBNLmVhY2godGhpcy5fc3Vic2NyaXB0aW9ucywgZnVuY3Rpb24ocGFpcikge1xuICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwb3NlKCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmhhc2hfbWFwKCk7XG4gICAgfSxcblxuICAgIHB1Ymxpc2g6IGZ1bmN0aW9uKHNlbnRpbmVsLCBtc2cpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wdWJsaXNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuXG4gICAgc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cblxuICAgIGlzRGlzcG9zZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG5cblxuICAgIF9wdWJsaXNoOiBmdW5jdGlvbihzZW50aW5lbCwgbXNnKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgaWYgKHRoaXMuX3NlbnRpbmVsICE9PSBzZW50aW5lbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHNlbnRpbmVsIHByb3ZpZGVkOyBwdWJsaXNoZXIgbXVzdCBoYXZlIHNhbWUgc2VudGluZWwgcHJvdmlkZWQgZHVyaW5nIGluc3RhbnRpYXRpb24uXCIpO1xuICAgICAgfVxuICAgICAgdGhpcy5fZGlzcGF0Y2gobXNnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cblxuICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgc3ViID0gbmV3IFN1YnNjcmlwdGlvbih0aGlzLCBoYW5kbGVyKSxcbiAgICAgICAgICBpZCAgPSBzdWIuaWQoKTtcblxuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uYXNzb2ModGhpcy5fc3Vic2NyaXB0aW9ucywgaWQsIHN1Yik7XG5cbiAgICAgIHJldHVybiBzdWI7XG4gICAgfSxcblxuXG4gICAgX2Rpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gR25hcmx5LCBhcyB0aGlzIGhvcHMgYmFjayBhbmQgZm9ydGggYmV0d2VlbiB0aGUgY2hhbm5lbCBhbmQgdGhlIHN1YiwgYnV0XG4gICAgICAvLyBlYXNpZXIgdGhhbiBzcGxpdHRpbmcgdGhlIGRpc3Bvc2UgbG9naWMgaW50byB0d28gbWV0aG9kcyBpbiB0aGUgc3ViLlxuICAgICAgTS5lYWNoKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG5cbiAgICBfZGlzcGF0Y2g6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgTS5lYWNoKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcGF0Y2gobXNnKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIF9kaXNwb3NlSGFuZGxlOiBmdW5jdGlvbihpZCkge1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uZGlzc29jKHRoaXMuX3N1YnNjcmlwdGlvbnMsIGlkKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBTdWJzY3JpcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdWJzY3JpcHRpb24ucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oY2hhbm5lbCwgaGFuZGxlcikge1xuICAgICAgdGhpcy5faWQgICAgICAgICA9IFVVSUQudjQoKTtcbiAgICAgIHRoaXMuX2NoYW5uZWwgICAgPSBjaGFubmVsO1xuICAgICAgdGhpcy5faGFuZGxlciAgICA9IGhhbmRsZXI7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJkaXNwb3NlXCIpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fY2hhbm5lbC5fZGlzcG9zZUhhbmRsZSh0aGlzLl9pZCk7XG5cbiAgICAgIHRoaXMuX2hhbmRsZXIgPSBudWxsO1xuICAgICAgdGhpcy5fY2hhbm5lbCA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG5cbiAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfSxcblxuXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5faGFuZGxlcihtc2cpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENoYW5uZWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9zdGF0ZS1ndWFyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBNLFxuICBPcHRpb25zLFxuICBDaGFubmVsXG4pIHtcblxuICAvLyBGSVhNRTogRGVsZXRlIHRoaXMgaW4gZmF2b3Igb2YgQ29tcG9zaXRlQ2hhbm5lbFxuICB2YXIgQ2hhaW5lZENoYW5uZWwgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDaGFpbmVkQ2hhbm5lbC5wcm90b3R5cGUsIENoYW5uZWwucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgQ2hhbm5lbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2ZvcndhcmRcIik7XG4gICAgICB0aGlzLl9jaGFpbmVkU3VicyA9IE0udmVjdG9yKCk7XG5cbiAgICAgIHZhciBpbml0aWFsbHlDaGFpbmVkVG8gPSBvcHRzLmdldE9yRWxzZShcImNoYWluVG9cIik7XG4gICAgICBpZiAoaW5pdGlhbGx5Q2hhaW5lZFRvKSB7XG4gICAgICAgIHRoaXMuY2hhaW5Ubyhpbml0aWFsbHlDaGFpbmVkVG8pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBjaGFpblRvOiBmdW5jdGlvbihvdGhlckNoYW5uZWwpIHtcbiAgICAgIHRoaXMuX2NoYWluZWRTdWJzID0gTS5jb25qKHRoaXMuX2NoYWluZWRTdWJzLCBvdGhlckNoYW5uZWwuc3Vic2NyaWJlKHRoaXMuX2ZvcndhcmQpKTtcbiAgICB9LFxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc3VicyA9IHRoaXMuX2NoYWluZWRTdWJzO1xuXG4gICAgICB0aGlzLl9jaGFpbmVkU3VicyA9IE0udmVjdG9yKCk7XG5cbiAgICAgIE0uZWFjaChzdWJzLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICBfZm9yd2FyZDogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLl9wdWJsaXNoKHRoaXMuX3NlbnRpbmVsLCBtc2cpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENoYWluZWRDaGFubmVsO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2NoYW5uZWxcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgQ2hhbm5lbFxuKSB7XG5cbiAgLyoqXG4gICAqIEEgY2hhbm5lbCB3aGljaCBsaXN0ZW5zIHRvIG90aGVyIGNoYW5uZWxzLCBhbmQgZm9yd2FyZHMgdGhlaXIgbWVzc2FnZXMgYXMgdGhyb3VnaCBwdWJsaXNoZWQgdG8gdGhpcyBjaGFubmVsXG4gICAqXG4gICAqL1xuICB2YXIgQ29tcG9zaXRlQ2hhbm5lbCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENvbXBvc2l0ZUNoYW5uZWwucHJvdG90eXBlLCBDaGFubmVsLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIENoYW5uZWwucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX2ZvcndhcmRpbmcgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIHZhciBsaXN0ZW4gPSBvcHRzLmdldE9yRWxzZShcImxpc3RlblwiLCBbXSk7XG4gICAgICBpZiAoIV8uaXNBcnJheShsaXN0ZW4pKSB7XG4gICAgICAgIGxpc3RlbiA9IFtsaXN0ZW5dO1xuICAgICAgfVxuXG4gICAgICBfLmVhY2gobGlzdGVuLCBfLmJpbmQoZnVuY3Rpb24oYykge1xuICAgICAgICB0aGlzLmxpc3RlbihjKTtcbiAgICAgIH0sIHRoaXMpKTtcbiAgICB9LFxuXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIENoYW5uZWwucHJvdG90eXBlLmRpc3Bvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIHZhciBmb3J3YXJkaW5nID0gdGhpcy5fZm9yd2FyZGluZztcbiAgICAgIHRoaXMuX2ZvcndhcmRpbmcgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIE0uZWFjaChmb3J3YXJkaW5nLCBfLmJpbmQoZnVuY3Rpb24ocGFpcikge1xuICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwb3NlKCk7XG4gICAgICB9LCB0aGlzKSk7XG4gICAgfSxcblxuXG4gICAgbGlzdGVuOiBmdW5jdGlvbihjaGFubmVsKSB7XG4gICAgICB2YXIgc3ViID0gY2hhbm5lbC5zdWJzY3JpYmUoXy5iaW5kKGZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLl9mb3J3YXJkKG1zZylcbiAgICAgIH0sIHRoaXMpKTtcbiAgICAgIHRoaXMuX2ZvcndhcmRpbmcgPSBNLmFzc29jKHRoaXMuX2ZvcndhcmRpbmcsIGNoYW5uZWwsIHN1Yik7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRpc3Bvc2U6IF8uYmluZChmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9mb3J3YXJkaW5nID0gTS5kaXNzb2ModGhpcy5fZm9yd2FyZGluZywgY2hhbm5lbCk7XG4gICAgICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgICAgfSwgdGhpcylcbiAgICAgIH07XG4gICAgfSxcblxuXG4gICAgX2ZvcndhcmQ6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5wdWJsaXNoKHRoaXMuX3NlbnRpbmVsLCBtc2cpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbXBvc2l0ZUNoYW5uZWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vY2hhbm5lbFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBTdGF0ZUd1YXJkLFxuICBMb2dnZXJcbikge1xuXG4gIC8qKlxuICAgKiBBIGZpYmVyIGRpY3RhdGVzIGhvdyBhbiBFeGNoYW5nZSdzIG1lc3NhZ2VzIGFyZSBhY3R1YWxseSBzZW50LiBXaGVuIHNvbWVvbmUgcmVxdWVzdHMgYSBtYWlsYm94IGZyb20gYW4gRXhjaGFuZ2UsXG4gICAqIHRoYXQgZXhjaGFuZ2UgcmVnaXN0ZXJzIGl0c2VsZiBhcyBhbiBlbnRpdHkgd2l0aCB0aGF0IGFkZHJlc3Mgb24gdGhlIG1haWxib3gncyBiZWhhbGYuIFdoZW4gYSBtZXNzYWdlIGZvciB0aGF0XG4gICAqIGFkZHJlc3MgaXMgcmVjZWl2ZWQgYnkgdGhlIGZpYmVyLCBpdCByb3V0ZXMgaXQgdG8gdGhlIGV4Y2hhbmdlLCB3aGljaCBmb3J3YXJkcyBpdCB0byB0aGUgbWFpbGJveCwgYW5kIG9ud2FyZC5cbiAgICpcbiAgICogVGhlcmUncyBhIHBpY3R1cmUgaW4gYENvdXJpZXJgIHRoYXQgaWxsdXN0cmF0ZXMgdGhlIGNvbXBvbmVudCBsYXlvdXQuXG4gICAqXG4gICAqIEFuIGBJbk1lbW9yeUZpYmVyYCBvbmx5IGhhcyBsb2NhbCBlbnRpdGllcywgYW5kIG9ubHkgcGVyZm9ybXMgbG9jYWwgZGlzcGF0Y2guIEEgYExpbmthYmxlRmliZXJgIGlzIGFuXG4gICAqIGBJbk1lbW9yeUZpYmVyYCB3aGljaCB3aWxsIGZvcndhcmQgbWVzc2FnZXMgdG8gaXRzIGxpbmtlZCBmaWJlcnMgaW4gdGhlIGV2ZW50IGEgbG9jYWwgZW50aXR5IGhhc24ndCBiZWVuXG4gICAqIHJlZ2lzdGVyZWQgd2l0aCB0aGUgYWRkcmVzcyBmb3Igd2hpY2ggYSBtZXNzYWdlIGlzIGJvdW5kLlxuICAgKi9cbiAgdmFyIEluTWVtb3J5RmliZXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIEtsYXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuXG4gICAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJJbk1lbW9yeUxvZ2dlclwiKTtcblxuICAgIF8uZXh0ZW5kKEtsYXNzLnByb3RvdHlwZSwge1xuICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHRoaXMuX2VudGl0aWVzID0gTS5oYXNoX21hcCgpO1xuICAgICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFbHNlKFwiaWRlbnRpdHlcIiwgVVVJRC52NCgpKTtcblxuICAgICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9yZWNlaXZlXCIpO1xuICAgICAgfSxcblxuXG4gICAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pZGVudGl0eTtcbiAgICAgIH0sXG5cblxuICAgICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kaXNwb3NlKCk7XG4gICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICAgIH0sXG5cbiAgICAgIF9kaXNwb3NlOiBmdW5jdGlvbigpIHtcblxuICAgICAgICB2YXIgZW50aXRpZXMgPSB0aGlzLl9lbnRpdGllcztcbiAgICAgICAgTS5lYWNoKGVudGl0aWVzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgICAgTS5udGgocGFpciwgMSkuZGlzcG9zZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9lbnRpdGllcyA9IG51bGw7XG4gICAgICB9LFxuXG4gICAgICByZWdpc3RlckVudGl0eTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHZhciBpZGVudGl0eSA9IG9wdHMuZ2V0T3JFcnJvcihcImlkZW50aXR5XCIpLFxuICAgICAgICAgICAgZW50aXR5ICAgPSBuZXcgTG9jYWxFbnRpdHkoe1xuICAgICAgICAgICAgICBpZGVudGl0eTogaWRlbnRpdHksXG4gICAgICAgICAgICAgIGRlbGVnYXRlOiBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fZW50aXRpZXMgPSBNLmFzc29jKHRoaXMuX2VudGl0aWVzLCBpZGVudGl0eSwgZW50aXR5KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuXG4gICAgICAvKipcbiAgICAgICAqIFJldHVybnMgYSBwcm9taXNlIHdoaWNoIGlzIGZ1bGZpbGxlZCB3aGVuIHRoZSBtZXNzYWdlIGlzXG4gICAgICAgKiBzZW50LCBub3QgcmVjZWl2ZWQgYnkgdGhlIHJlbW90ZSBlbmQuIFRoaXMgdG8gbGV0IHRoZVxuICAgICAgICogY2FsbGVyIGtub3cgd2hldGhlciBvciBub3QgdGhlIG1lc3NhZ2UgaXMgc3R1Y2tcbiAgICAgICAqIGluIGEgYnVmZmVyIHNvbWV3aGVyZSB3aGVuIGNhbGN1bGF0aW5nIGl0cyB0aW1lb3V0cy5cbiAgICAgICAqL1xuICAgICAgc2VuZDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ob3B0cykge1xuICAgICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgICB2YXIgZnJvbSAgID0gb3B0cy5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgICAgIHRvICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInRvXCIpLFxuICAgICAgICAgICAgYm9keSAgID0gb3B0cy5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgICAgIG1zZ0lkICA9IG9wdHMuZ2V0T3JFcnJvcihcIm1zZ0lkXCIpLFxuXG4gICAgICAgICAgICBtVCAgICAgPSBvcHRzLmdldE9yRWxzZShcIm1UXCIpLFxuICAgICAgICAgICAgck1zZ0lkID0gb3B0cy5nZXRPckVsc2UoXCJyTXNnSWRcIik7XG5cblxuICAgICAgICAvL1hYWDogVGhpcyBpcyBpbi1tZW1vcnksIHNvIGl0J3MgYXMgc2ltcGxlXG4gICAgICAgIC8vIGFzIGludm9raW5nIF9yZWNlaXZlIGluIGEgZnV0dXJlIGNhbGwgc3RhY2tcbiAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXy5kZWZlcih0aGlzLl9yZWNlaXZlLCB7XG4gICAgICAgICAgICAgIGZyb206ICAgZnJvbSxcbiAgICAgICAgICAgICAgdG86ICAgICB0byxcbiAgICAgICAgICAgICAgYm9keTogICBib2R5LFxuICAgICAgICAgICAgICBtc2dJZDogIG1zZ0lkLFxuICAgICAgICAgICAgICBtVDogICAgIG1ULFxuICAgICAgICAgICAgICByTXNnSWQ6IHJNc2dJZCxcbiAgICAgICAgICAgICAgb0ZpYjogICB0aGlzLl9pZGVudGl0eVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBtc2dJZDtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pLFxuXG4gICAgICBfcmVjZWl2ZTogZnVuY3Rpb24oZW52KSB7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGVudiA9IE9wdGlvbnMuZnJvbU9iamVjdChlbnYpO1xuICAgICAgICB2YXIgdG8sIGZyb20sIGJvZHksIG1zZ0lkLCBvcmlnaW5GaWJlciwgbVQsIHJNc2dJZDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIHRvICAgICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJ0b1wiKTtcbiAgICAgICAgICBmcm9tICAgICAgICA9IGVudi5nZXRPckVycm9yKFwiZnJvbVwiKTtcbiAgICAgICAgICBib2R5ICAgICAgICA9IGVudi5nZXRPckVycm9yKFwiYm9keVwiKTtcbiAgICAgICAgICBtc2dJZCAgICAgICA9IGVudi5nZXRPckVycm9yKFwibXNnSWRcIik7XG5cbiAgICAgICAgICAvLyBGdXR1cmUtcHJvb2ZpbmcgZm9yIG11bHRpLWZpYmVyIGZhYnJpYy5cbiAgICAgICAgICBvcmlnaW5GaWJlciA9IGVudi5nZXRPckVycm9yKFwib0ZpYlwiKTtcblxuICAgICAgICAgIG1UICAgICA9IGVudi5nZXRPckVsc2UoXCJtVFwiKTtcbiAgICAgICAgICByTXNnSWQgPSBlbnYuZ2V0T3JFbHNlKFwick1zZ0lkXCIpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgTG9nLmVycm9yKFwiUmVjZWl2ZWQgbWFsZm9ybWVkIG1lc3NhZ2VcIiwgZW52KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBlbnRpdHkgPSBNLmdldCh0aGlzLl9lbnRpdGllcywgdG8pO1xuXG4gICAgICAgIGlmIChlbnRpdHkpIHtcbiAgICAgICAgICBlbnRpdHkuZGlzcGF0Y2goe1xuICAgICAgICAgICAgdG86ICAgICB0byxcbiAgICAgICAgICAgIGZyb206ICAgZnJvbSxcbiAgICAgICAgICAgIGJvZHk6ICAgYm9keSxcbiAgICAgICAgICAgIG1zZ0lkOiAgbXNnSWQsXG4gICAgICAgICAgICByTXNnSWQ6IHJNc2dJZCxcbiAgICAgICAgICAgIG9GaWI6ICAgb3JpZ2luRmliZXIsXG4gICAgICAgICAgICBoRmliOiAgIHRoaXMuX2lkZW50aXR5LFxuICAgICAgICAgICAgbVQ6IG1UXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBLbGFzcztcbiAgfSkoKTtcblxuXG5cbiAgdmFyIExvY2FsRW50aXR5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9jYWxFbnRpdHkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5faWRlbnRpdHkgPSBvcHRzLmdldE9yRXJyb3IoXCJpZGVudGl0eVwiKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlID0gb3B0cy5nZXRPckVycm9yKFwiZGVsZWdhdGVcIik7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuICAgIH0sXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuICAgIGRpc3BhdGNoOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZS5yZWNlaXZlRmliZXJNZXNzYWdlKGVudik7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gSW5NZW1vcnlGaWJlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIEluTWVtb3J5RmliZXIsXG4gIENoYW5uZWwsXG4gIENvbXBvc2l0ZUNoYW5uZWxcbikge1xuXG4gIC8qKlxuICAgKiBMaW5rYWJsZUZpYmVyIGlzIGEgcmVmZXJlbmNlIGltcGxlbWVudGF0aW9uIGZvciBpbXBsZW1lbnRpbmcgYSBtdWx0aS1maWJlciBcImZhYnJpY1wiLiBXaGVyZWFzIGFuIGBJbk1lbW9yeUZpYmVyYFxuICAgKiBvbmx5IGhhcyBsb2NhbCBlbnRpdGllcywgYW5kIG9ubHkgcGVyZm9ybXMgbG9jYWwgZGlzcGF0Y2gsIGEgYExpbmthYmxlRmliZXJgIGlzIGFuIGBJbk1lbW9yeUZpYmVyYCB3aGljaCB3aWxsXG4gICAqIGZvcndhcmQgbWVzc2FnZXMgdG8gaXRzIGxpbmtlZCBmaWJlcnMgaW4gdGhlIGV2ZW50IGEgbG9jYWwgZW50aXR5IGhhc24ndCBiZWVuIHJlZ2lzdGVyZWQgd2l0aCB0aGUgYWRkcmVzcyBmb3JcbiAgICogd2hpY2ggYSBtZXNzYWdlIGlzIGJvdW5kLlxuICAgKlxuICAgKiBGb3IgYW4gZXhhbXBsZSBvZiBob3cgdGhpcyBtaWdodCB3b3JrIGluIGEgbXVsdGktcHJvY2VzcyBvciBtdWx0aS1tYWNoaW5lIGVudmlyb25tZW50LCBzZWUgdGhlXG4gICAqIGB0aGlja2V0LXptcS1maWJlcmAgbm9kZSBtb2R1bGUuXG4gICAqL1xuICB2YXIgTGlua2FibGVGaWJlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExpbmthYmxlRmliZXIucHJvdG90eXBlLCBJbk1lbW9yeUZpYmVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIEluTWVtb3J5RmliZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cblxuICAgICAgdGhpcy5fbG9jYWxEaXNwYXRjaCAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwgPSBuZXcgQ29tcG9zaXRlQ2hhbm5lbCh7XG4gICAgICAgIHNlbnRpbmVsOiB0aGlzLFxuICAgICAgICBsaXN0ZW46ICAgdGhpcy5fbG9jYWxEaXNwYXRjaFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2VncmVzc0NoYW5uZWwgID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcblxuICAgICAgLy8gX3JlY2VpdmUgaXMgZGVmaW5lZCBhbmQgYm91bmQgaW4gSW5NZW1vcnlGaWJlciAoXCJwcm90ZWN0ZWRcIiBtZXRob2QpXG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbC5zdWJzY3JpYmUodGhpcy5fcmVjZWl2ZSk7XG4gICAgfSxcblxuXG4gICAgbGlzdGVuOiBmdW5jdGlvbihjaGFubmVsKSB7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbC5saXN0ZW4oY2hhbm5lbCk7XG4gICAgfSxcblxuXG4gICAgZWdyZXNzQ2hhbm5lbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZWdyZXNzQ2hhbm5lbDtcbiAgICB9LFxuXG5cbiAgICBfZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBJbk1lbW9yeUZpYmVyLnByb3RvdHlwZS5fZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0sXG5cbiAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihvcHRzKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdmFyIGZyb20gICA9IG9wdHMuZ2V0T3JFcnJvcihcImZyb21cIiksXG4gICAgICAgICAgdG8gICAgID0gb3B0cy5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgICAgYm9keSAgID0gb3B0cy5nZXRPckVycm9yKFwiYm9keVwiKSxcbiAgICAgICAgICBtc2dJZCAgPSBvcHRzLmdldE9yRXJyb3IoXCJtc2dJZFwiKSxcbiAgICAgICAgICBtVCAgICAgPSBvcHRzLmdldE9yRWxzZShcIm1UXCIpLFxuICAgICAgICAgIHJNc2dJZCA9IG9wdHMuZ2V0T3JFbHNlKFwick1zZ0lkXCIpLFxuICAgICAgICAgIGNoYW4gICA9IG51bGw7XG5cbiAgICAgIHZhciBtc2cgPSB7XG4gICAgICAgIGZyb206ICAgZnJvbSxcbiAgICAgICAgdG86ICAgICB0byxcbiAgICAgICAgYm9keTogICBib2R5LFxuICAgICAgICBtc2dJZDogIG1zZ0lkLFxuICAgICAgICBtVDogICAgIG1ULFxuICAgICAgICByTXNnSWQ6IHJNc2dJZCxcbiAgICAgICAgb0ZpYjogICB0aGlzLl9pZGVudGl0eVxuICAgICAgfTtcblxuICAgICAgLy8gTG9jYWwgZGlzcGF0Y2gsIHNraXAgdGhlIHJvdW5kLXRyaXBcbiAgICAgIGlmIChNLmdldCh0aGlzLl9lbnRpdGllcywgdG8pKSB7XG4gICAgICAgIGNoYW4gPSB0aGlzLl9sb2NhbERpc3BhdGNoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbiA9IHRoaXMuX2VncmVzc0NoYW5uZWw7XG4gICAgICB9XG5cbiAgICAgIF8uZGVmZXIoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICBjaGFuLnB1Ymxpc2godGhpcywgbXNnKTtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgcmV0dXJuIG1zZ0lkO1xuICAgIH0pXG5cblxuICB9KTtcblxuICByZXR1cm4gTGlua2FibGVGaWJlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWZpYmVyXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2NoYW5uZWwvY29tcG9zaXRlLWNoYW5uZWxcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgJ3NlcmRlJyBpcyBhIHRoaW5nIHRoYXQgY2FuIFwic2VyXCItaWFsaXplIGFuZCBcImRlXCItZXJpYWxpemUgYW4gb2JqZWN0LiBUaGlzIG9uZSBqdXN0IGRvZXMgSlNPTiwgYW5kIGlnbm9yZXNcbiAgICogYW55IGFkZGl0aW9uYWwgb3B0aW9ucy5cbiAgICpcbiAgICpcbiAgICovXG4gIHZhciBKU09OU2VyZGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChKU09OU2VyZGUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcblxuICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24ocGF5bG9hZCwgb3B0cykge1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHBheWxvYWQpO1xuICAgIH0sXG5cbiAgICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24ocGF5bG9hZCwgb3B0cykge1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UocGF5bG9hZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gSlNPTlNlcmRlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIEJhc2VDbGllbnRcbikge1xuXG4gIHZhciBDbGllbnRCdWlsZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ2xpZW50QnVpbGRlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc3BlYyA9IG9wdHMuZ2V0T3JFcnJvcihcInNwZWNcIik7XG4gICAgfSxcblxuICAgIGJ1aWxkOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICB2YXIgYyA9IG5ldyBCYXNlQ2xpZW50KF8uZXh0ZW5kKHt9LCB0aGlzLl9zcGVjLmluaXRPcHRpb25zKCksIG9wdHMpKTtcbiAgICAgIF8uZWFjaCh0aGlzLl9zcGVjLm1ldGhvZHMoKSwgZnVuY3Rpb24oc3BlYywgbmFtZSkge1xuICAgICAgICBjLl9fcmVnaXN0ZXJNZXRob2QobmFtZSwgc3BlYyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENsaWVudEJ1aWxkZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2Jhc2UtY2xpZW50XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIE1ldGhvZFNwZWNcbikge1xuXG4gIHZhciBDbGllbnRTcGVjID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ2xpZW50U3BlYy5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fbWV0aG9kU3BlY3MgPSBfLnJlZHVjZShvcHRzLmdldE9yRWxzZShcIm1ldGhvZHNcIiwge30pLCBmdW5jdGlvbihtZW1vLCBzcGVjLCBuYW1lKSB7XG4gICAgICAgIG1lbW9bbmFtZV0gPSBuZXcgTWV0aG9kU3BlYyhzcGVjKTtcbiAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICB9LCB7fSk7XG4gICAgICB0aGlzLl9pbml0T3B0aW9ucyA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdE9wdGlvbnNcIiwge30pO1xuICAgIH0sXG5cbiAgICBtZXRob2RzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tZXRob2RTcGVjcztcbiAgICB9LFxuXG4gICAgaW5pdE9wdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2luaXRPcHRpb25zO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENsaWVudFNwZWM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL21ldGhvZC1zcGVjXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFJlZixcbiAgRGVsZWdhdGluZ1JlZlxuKSB7XG5cbiAgdmFyIGhlbHBlciA9IGZ1bmN0aW9uKHZhbCkge1xuICAgIHJldHVybiBuZXcgUmVmKHZhbCk7XG4gIH07XG5cbiAgaGVscGVyLmRlbGVnYXRpbmcgPSBmdW5jdGlvbihyZWYpIHtcbiAgICByZXR1cm4gbmV3IERlbGVnYXRpbmdSZWYocmVmKTtcbiAgfTtcblxuICByZXR1cm4gaGVscGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi9yZWZcIiksXG4gIHJlcXVpcmUoXCIuL2RlbGVnYXRpbmctcmVmXCIpXG4pO1xuXG59KSgpIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBQcm9taXNlID0gcmVxdWlyZShcIi4vcHJvbWlzZS5qc1wiKSgpO1xubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlOyIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogQW4gYXBwZW5kZXIgd2hpY2ggbG9ncyB0byB0aGUgZ2xvYmFsIGBjb25zb2xlYC5cbiAgICpcbiAgICovXG4gIHZhciBDb25zb2xlTG9nQXBwZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgcCA9IGZ1bmN0aW9uKG51bSkge1xuICAgIGlmICgoXCJcIiArIG51bSkubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXR1cm4gXCIwXCIgKyBudW07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudW07XG4gICAgfVxuICB9O1xuXG4gIF8uZXh0ZW5kKENvbnNvbGVMb2dBcHBlbmRlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fY29uc29sZSA9IG9wdHMuZ2V0T3JFbHNlKFwiY29uc29sZVwiLCBjb25zb2xlKTtcbiAgICAgIHRoaXMuX3RpbWVEZWxlZ2F0ZSA9IG9wdHMuZ2V0T3JFbHNlKFwidGltZURlbGVnYXRlXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIFtkLmdldFVUQ0Z1bGxZZWFyKCksIHAoZC5nZXRVVENNb250aCgpKSwgcChkLmdldFVUQ0RheSgpKV0uam9pbihcIi9cIikgK1xuICAgICAgICAgIFwiIFwiICsgW3AoZC5nZXRVVENIb3VycygpKSwgcChkLmdldFVUQ01pbnV0ZXMoKSksIHAoZC5nZXRVVENTZWNvbmRzKCkpXS5qb2luKFwiOlwiKSArXG4gICAgICAgICAgXCIuXCIgKyBkLmdldFVUQ01pbGxpc2Vjb25kcygpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGxvZzogZnVuY3Rpb24obG9nZ2VyTmFtZSwgZGVzY2VuZGFudHMsIGxvZ0xldmVsLCBsb2dMZXZlbE5hbWUsIGFyZ3MpIHtcbiAgICAgIC8vIFVzZSB0aGUgZnVydGhlc3QgYW5jZXN0b3IgYXMgdGhlIGxvZ2dlZCBuYW1lIChzaW5jZSBpdCBvcmlnaW5hdGVkIHRoZXJlKVxuICAgICAgdmFyIGZ1cnRoZXN0QW5jZXN0b3IgPSBkZXNjZW5kYW50c1tkZXNjZW5kYW50cy5sZW5ndGggLSAxXTtcbiAgICAgIGlmIChmdXJ0aGVzdEFuY2VzdG9yKSB7XG4gICAgICAgIGxvZ2dlck5hbWUgPSBmdXJ0aGVzdEFuY2VzdG9yO1xuICAgICAgfVxuICAgICAgdGhpcy5fbG9nKFtcIltcIitsb2dMZXZlbE5hbWUrXCJdW1wiK3RoaXMuX2dldFRpbWUoKStcIl1bXCIrbG9nZ2VyTmFtZStcIl1cIl0uY29uY2F0KGFyZ3MpKTtcbiAgICB9LFxuXG4gICAgX2dldFRpbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RpbWVEZWxlZ2F0ZSgpO1xuICAgIH0sXG5cbiAgICBfbG9nOiBmdW5jdGlvbihsb2dJdGVtcykge1xuICAgICAgLy8gV2h5IGRvZXMgaGUgZG8gdGhpcz8gSXMgaGUgaW5zYW5lPyBXZWxsLCB5ZXMuXG4gICAgICAvL1xuICAgICAgLy8gQnV0IG1vc3RseSwgSSBkbyB0aGlzIGJlY2F1c2UgY29uc29sZS5sb2cgaXNuJ3QsIGluIGFsbCBjYXNlcyxcbiAgICAgIC8vIHNvbWV0aGluZyB5b3UgY2FuIGNhbGwgLmFwcGx5IG9uLiBMYXN0IEkgY2hlY2tlZCwgaW4gSUUgY2FsbGluZ1xuICAgICAgLy8gY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW10pIHdpbGwgdGhyb3cgYW4gZXJyb3IuIFNvIHRoYXQncyB3aHkgdGhlXG4gICAgICAvLyBiaWcgdWdseSBzd2l0Y2guXG4gICAgICAvL1xuICAgICAgLy8gSWYgeW91IG5lZWQgbW9yZSB0aGFuIDcgaXRlbXMsIHdlbGwsIEkgY2FuJ3QgaGVscCB5b3UgKGJ1dCB5b3UgY2FuIC0gYWRkIGFub3RoZXJcbiAgICAgIC8vIHN3aXRjaCBjYXNlKS5cbiAgICAgIHN3aXRjaChsb2dJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0sIGxvZ0l0ZW1zWzFdLCBsb2dJdGVtc1syXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdLCBsb2dJdGVtc1szXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdLCBsb2dJdGVtc1szXSwgbG9nSXRlbXNbNF0pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2cobG9nSXRlbXNbMF0sIGxvZ0l0ZW1zWzFdLCBsb2dJdGVtc1syXSwgbG9nSXRlbXNbM10sIGxvZ0l0ZW1zWzRdLCBsb2dJdGVtc1s1XSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdLCBsb2dJdGVtc1szXSwgbG9nSXRlbXNbNF0sIGxvZ0l0ZW1zWzVdLCBsb2dJdGVtc1s2XSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdmFyIGxhYmVsID0gbG9nSXRlbXMuc2hpZnQoKTtcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsYWJlbCwgbG9nSXRlbXMpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbnNvbGVMb2dBcHBlbmRlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBMb2dnZXIsXG4gIENvbmZpZ3VyYXRpb25NYWdpYyxcbiAgQXBwQ29udGFpbmVyXG4pIHtcbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJCb290c3RyYXBwZXJcIik7XG5cbiAgdmFyIEJvb3RzdHJhcHBlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEJvb3RzdHJhcHBlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fY29uZmlncyA9IG9wdHMuZ2V0T3JFcnJvcihcImNvbmZpZ3VyYXRpb25zXCIpO1xuICAgICAgdGhpcy5fc2NvcGVzID0gb3B0cy5nZXRPckVycm9yKFwic2NvcGVzXCIpO1xuICAgICAgdGhpcy5fYXBwS2xhc3MgPSBvcHRzLmdldE9yRXJyb3IoXCJhcHBsaWNhdGlvbkNvbnN0cnVjdG9yXCIpO1xuICAgIH0sXG4gICAgYm9vdHN0cmFwOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBjb25maWcgICAgICAgPSBDb25maWd1cmF0aW9uTWFnaWMucmVzb2x2ZUNvbmZpZyh0aGlzLl9zY29wZXMsIHRoaXMuX2NvbmZpZ3MpLFxuICAgICAgICAgICAgICBBcHBLbGFzcyAgICAgPSB0aGlzLl9hcHBLbGFzcztcblxuICAgICAgICAgIExvZy5pbmZvKFwiVXNpbmcgcmVzb2x2ZWQgY29uZmlndXJhdGlvbjogXCIsIEpTT04uc3RyaW5naWZ5KGNvbmZpZykpO1xuXG4gICAgICAgICAgdmFyIGFwcCAgICAgICAgICA9IG5ldyBBcHBLbGFzcyh7Y29uZmlndXJhdGlvbjogY29uZmlnfSksXG4gICAgICAgICAgICAgIGFwcENvbnRhaW5lciA9IG5ldyBBcHBDb250YWluZXIoe2FwcDogYXBwfSk7XG5cbiAgICAgICAgICByZXR1cm4gYXBwQ29udGFpbmVyO1xuICAgICAgICB9KTtcbiAgICB9KVxuICB9KTtcblxuICByZXR1cm4gQm9vdHN0cmFwcGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpLFxuICByZXF1aXJlKFwiLi9jb25maWd1cmF0aW9uLW1hZ2ljXCIpLFxuICByZXF1aXJlKFwiLi93ZWItYXBwLWNvbnRhaW5lclwiKVxuKTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIHZhciBXZWJTY2hlZHVsZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChXZWJTY2hlZHVsZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcblxuICAgIHJ1blNvb246IGZ1bmN0aW9uKGZuKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlKGZuKTtcbiAgICB9LFxuXG4gICAgc2NoZWR1bGU6IGZ1bmN0aW9uKGZuLCBkZWxheSkge1xuICAgICAgZGVsYXkgPSBkZWxheSB8fCAxO1xuICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIGRlbGF5KTtcbiAgICB9LFxuXG4gICAgdW5zY2hlZHVsZTogZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiBjbGVhclRpbWVvdXQoaWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFdlYlNjaGVkdWxlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcbiIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlLCBwcm9jZXNzOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgTG9nZ2VyXG4pIHtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkFwcENvbnRhaW5lclwiKTtcblxuICB2YXIgV2ViQXBwQ29udGFpbmVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoV2ViQXBwQ29udGFpbmVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cylcbiAgICAgIHRoaXMuX2FwcCA9IG9wdHMuZ2V0T3JFcnJvcihcImFwcFwiKTtcbiAgICB9LFxuXG4gICAgc3RhcnQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcC5zdGFydCgpO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIHN0b3A6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgcmV0dXJuIHRoaXMuX2FwcC5zdG9wKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHJlYXNvbikge1xuICAgICAgICAgIExvZy5lcnJvcihcIlN0b3BwaW5nIGR1ZSB0byByZWFzb246XCIsIHJlYXNvbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBXZWJBcHBDb250YWluZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9ucyxcbiAgUmVmLFxuICBTZXRUaW1lb3V0U2NoZWR1bGVyXG4pIHtcblxuICB2YXIgRGVmYXVsdFJ1bnRpbWUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEZWZhdWx0UnVudGltZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9zY2hlZHVsZXJSZWYgPSBSZWYob3B0cy5nZXRPckVsc2VGbihcInNjaGVkdWxlclwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXRUaW1lb3V0U2NoZWR1bGVyKCk7XG4gICAgICB9KSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtSZWY8U2NoZWR1bGVyPn1cbiAgICAgKi9cbiAgICBzY2hlZHVsZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFJlZi5kZWxlZ2F0aW5nKHRoaXMuX3NjaGVkdWxlclJlZik7XG4gICAgfSxcblxuICAgIHNldFNjaGVkdWxlcjogZnVuY3Rpb24oc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLl9zY2hlZHVsZXJSZWYuc2V0KHNjaGVkdWxlcik7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRGVmYXVsdFJ1bnRpbWU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3JlZlwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2NoZWR1bGVyL3NldC10aW1lb3V0LXNjaGVkdWxlclwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcblxuICB2YXIgU3RvcmVFbnRyeSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN0b3JlRW50cnkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIC8vIFBlcmZlY3RseSBhY2NlcHRhYmxlIHRvIHBhc3MgaW4gdW5kZWZpbmVkLi4uXG4gICAgICB0aGlzLl92YWx1ZSA9IG9wdHMuZ2V0T3JFbHNlKFwidmFsdWVcIiwgdW5kZWZpbmVkKTtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IG9wdHMuZ2V0T3JFcnJvcihcImluaXRpYWxTZXF1ZW5jZVwiKTtcblxuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIik7XG4gICAgfSxcblxuICAgIGlzRXhwaXJlZDogZnVuY3Rpb24oc2VxdWVuY2UsIGZhbGxiYWNrVHRsKSB7XG4gICAgICB2YXIgdHRsID0gdGhpcy5fdHRsIHx8IGZhbGxiYWNrVHRsO1xuICAgICAgaWYgKCF0dGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gVFRMIHNwZWNpZmllZCFcIik7XG4gICAgICB9XG4gICAgICAvLyBFLmcuLCBsYXN0U2VxdWVuY2UgPSA0LCB0dGwgPSAxLCBzZXF1ZW5jZSA9IDU6IGV4cGlyZWRcbiAgICAgIC8vICAgICAgIGxhc3RTZXF1ZW5jZSA9IDQsIHR0bCA9IDEsIHNlcXVlbmNlID0gNDogbm90IGV4cGlyZWRcbiAgICAgIC8vICAgICAgIGxhc3RTZXF1ZW5jZSA9IDQsIHR0bCA9IDIsIHNlcXVlbmNlID0gNTogbm90IGV4cGlyZWRcbiAgICAgIHJldHVybiAhKHRoaXMuX2xhc3RTZXF1ZW5jZSArIHR0bCA+IHNlcXVlbmNlKTtcbiAgICB9LFxuXG4gICAgdG91Y2g6IGZ1bmN0aW9uKHNlcXVlbmNlKSB7XG4gICAgICB0aGlzLl9sYXN0U2VxdWVuY2UgPSBzZXF1ZW5jZTtcbiAgICB9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbih2YWwsIHNlcXVlbmNlLCBvcHRzKSB7XG4gICAgICB0aGlzLl92YWx1ZSAgICAgICAgPSB2YWw7XG4gICAgICB0aGlzLl9sYXN0U2VxdWVuY2UgPSBzZXF1ZW5jZTtcblxuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3R0bCA9IG9wdHMuZ2V0T3JFbHNlKFwidHRsXCIpO1xuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3ZhbHVlICAgICAgICA9IG51bGw7XG4gICAgICB0aGlzLl9sYXN0U2VxdWVuY2UgPSBudWxsO1xuICAgIH0sXG5cbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gU3RvcmVFbnRyeTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBMb2dnZXIsXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBURU5fTUlOVVRFU19JTl9NSUxMSVNFQ09ORFMgPSA2MCAqIDEwMDAgKiAxMDtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIlByb2Nlc3NLZWVwQWxpdmVcIik7XG5cbiAgLyoqXG4gICAqIEtlZXBzIGEgKG5vZGUpIHByb2Nlc3MgXCJhbGl2ZVwiIGJ5IGtlZXBpbmcgYXQgbGVhc3Qgb25lIGJpdCBvZiAobm9vcCkgd29yayBzY2hlZHVsZWQgZm9yIGV4ZWN1dGlvbi5cbiAgICpcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgUHJvY2Vzc0tlZXBBbGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFByb2Nlc3NLZWVwQWxpdmUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciA9IG9wdHMuZ2V0T3JFcnJvcihcInNjaGVkdWxlclwiKTtcbiAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9jeWNsZVwiKTtcbiAgICB9LFxuICAgIHN0YXJ0OiBmdW5jdGlvbigpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIlN0YXJ0aW5nIFByb2Nlc3NLZWVwQWxpdmVcIik7XG4gICAgICB0aGlzLl9jeWNsZSgpO1xuICAgIH0sXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cuZGVidWcoXCJTdG9wcGluZyBQcm9jZXNzS2VlcEFsaXZlXCIpO1xuICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZCkge1xuICAgICAgICB0aGlzLl9zY2hlZHVsZXIuZ2V0KCkudW5zY2hlZHVsZSh0aGlzLl90aW1lb3V0SWQpO1xuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgX2N5Y2xlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IHRoaXMuX3NjaGVkdWxlci5nZXQoKS5zY2hlZHVsZShcbiAgICAgICAgdGhpcy5fY3ljbGUsXG4gICAgICAgIFRFTl9NSU5VVEVTX0lOX01JTExJU0VDT05EU1xuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBQcm9jZXNzS2VlcEFsaXZlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBNLFxuICBPcHRpb25zLFxuICBVVUlELFxuICBDaGFpbmVkQ2hhbm5lbCxcbiAgQ2hhbm5lbCxcbiAgQ29tcG9zaXRlQ2hhbm5lbCxcbiAgU3RhdGVHdWFyZFxuKSB7XG5cblxuICB2YXIgTWFpbGJveCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKE1haWxib3gucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2lkICAgICAgICAgICAgICAgICAgICA9IFVVSUQudjQoKTtcbiAgICAgIHRoaXMuX293bmVySWRlbnRpdHkgICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcIm93bmVySWRlbnRpdHlcIik7XG4gICAgICB0aGlzLl9leGNoYW5nZSAgICAgICAgICAgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJleGNoYW5nZVwiKTtcbiAgICAgIHRoaXMuX29uZVNob3RDaGFubmVsICAgICAgICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsICAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwgICAgICAgID0gbmV3IENvbXBvc2l0ZUNoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgbGlzdGVuOiBbdGhpcy5fb25lU2hvdENoYW5uZWwsIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWxdXG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICAgICAgICAgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcblxuICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5zZXQoKTtcbiAgICB9LFxuXG4gICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xuICAgIH0sXG5cbiAgICBvd25lcklkZW50aXR5OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vd25lcklkZW50aXR5O1xuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSl7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5Q2hhbm5lbC5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbC5kaXNwb3NlKCk7XG5cbiAgICAgIC8vIEF0dGVtcHQgdG8gY2FuY2VsIGFsbCBvdXRzdGFuZGluZyByZXF1ZXN0cy5cbiAgICAgIC8vIFRoaXMgaXMgYW4gYXN5bmMgcmVxdWVzdCwgc28gd2UganVzdCBoYXZlIHRvIGZpcmUgYW5kXG4gICAgICAvLyBmb3JnZSB0aGVtLlxuICAgICAgLy9cbiAgICAgIC8vIElmIHlvdSdyZSBkaXNwb3Npbmcgb2YgYSBtYWlsYm94IGJlZm9yZSByZXF1ZXN0c1xuICAgICAgLy8gY29tcGxldGUsIHlvdSBtaWdodCBoYXZlIGEgYmFkIHRpbWUuIFRoZSBnb29kXG4gICAgICAvLyBuZXdzIGlzIGJlY2F1c2UgcmVzcG9uc2VzIGFyZSBmZXJyaWVkIGJhY2sgZnJvbSB0aGUgZmliZXJcbiAgICAgIC8vIHRvIHRoZSBtYWlsYm94IGNhbGxlciB2aWEgdGhlIFByb21pc2UgaW50ZXJmYWNlIHJhdGhlclxuICAgICAgLy8gdGhhbiBjaGFubmVscywgdGhleSBzaG91bGQgc3RpbGwgZ2V0IENhbmNlbGxhdGlvbkVycm9yc1xuICAgICAgdmFyIHJlcXMgPSB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHM7XG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLnNldCgpO1xuXG4gICAgICBNLmVhY2gocmVxcywgXy5iaW5kKGZ1bmN0aW9uKHJlcUlkKSB7XG4gICAgICAgIHRoaXMuX2V4Y2hhbmdlLmNhbmNlbFNlbmRBbmRSZWNlaXZlKHJlcUlkKTtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwgICAgICA9IG51bGw7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsID0gbnVsbDtcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsICAgICAgPSBudWxsO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgQ2hhaW5lZENoYW5uZWwgY2hhaW5lZCB0byB0aGlzIE1haWxib3gnc1xuICAgICAqIHByaXZhdGVseS1vd25lZCBpbmJvdW5kIENoYW5uZWwuXG4gICAgICogQHJldHVybnMge0NoYWluZWRDaGFubmVsfVxuICAgICAqL1xuICAgIGluZ3Jlc3NDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pbmdyZXNzQ2hhbm5lbDtcbiAgICB9LFxuXG4gICAgb25lU2hvdENoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX29uZVNob3RDaGFubmVsO1xuICAgIH0sXG5cbiAgICByZXF1ZXN0UmVwbHlDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsO1xuICAgIH0sXG5cbiAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBlbnYgPSBfLmV4dGVuZCh7fSwgZW52IHx8IHt9LCB7XG4gICAgICAgIGZyb206IHRoaXMuX293bmVySWRlbnRpdHlcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMuX2V4Y2hhbmdlLnNlbmQoZW52KTtcbiAgICB9KSxcblxuICAgIHJlcGx5OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihtc2dJZCwgZW52KSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgZW52ID0gXy5leHRlbmQoe30sIGVudiB8fCB7fSwge1xuICAgICAgICByTXNnSWQ6IG1zZ0lkLFxuICAgICAgICBmcm9tOiB0aGlzLl9vd25lcklkZW50aXR5XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2V4Y2hhbmdlLnJlcGx5KGVudik7XG4gICAgfSksXG5cbiAgICBzZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oZW52LCBvcHRzKSB7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmRlbnkoXCJkaXNwb3NlZFwiKTtcblxuICAgICAgdmFyIHJlcUlkID0gKG9wdHMgfHwge30pLnJlcUlkIHx8IFVVSUQudjQoKTtcblxuICAgICAgZW52ID0gXy5leHRlbmQoe30sIGVudiB8fCB7fSwge1xuICAgICAgICBmcm9tOiB0aGlzLl9vd25lcklkZW50aXR5XG4gICAgICB9KTtcblxuICAgICAgb3B0cyA9IF8uZXh0ZW5kKHt9LCBvcHRzIHx8IHt9LCB7XG4gICAgICAgIHJlcUlkOiByZXFJZFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uY29uaih0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMsIHJlcUlkKTtcblxuICAgICAgcmV0dXJuIHRoaXMuX2V4Y2hhbmdlXG4gICAgICAgIC5zZW5kQW5kUmVjZWl2ZShlbnYsIG9wdHMpXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3ApIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgICAgcmV0dXJuIHJlc3A7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5kaXNqKHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcywgcmVxSWQpO1xuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChQcm9taXNlLlRpbWVvdXRFcnJvciwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5kaXNqKHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcywgcmVxSWQpO1xuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cblxuICAgIG91dHN0YW5kaW5nUmVxdWVzdENvdW50OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBNLmNvdW50KHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyk7XG4gICAgfSxcblxuXG4gICAgY2FuY2VsU2VuZEFuZFJlY2VpdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKHJlcUlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2VcbiAgICAgICAgLmNhbmNlbFNlbmRBbmRSZWNlaXZlKHJlcUlkKVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgX3JlY2VpdmVPbmVTaG90OiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMuX29uZVNob3RDaGFubmVsLnB1Ymxpc2godGhpcywgbXNnKTtcbiAgICB9LFxuXG4gICAgX3JlY2VpdmVSZXF1ZXN0UmVwbHk6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fcmVxdWVzdFJlcGx5Q2hhbm5lbC5wdWJsaXNoKHRoaXMsIG1zZyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gTWFpbGJveDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jb21wb3NpdGUtY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvc3RhdGUtZ3VhcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgTGFuZyxcbiAgVVVJRCxcbiAgQ291cmllclxuKSB7XG5cbiAgdmFyIEJhc2VDbGllbnQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChCYXNlQ2xpZW50LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX2V4Y2hhbmdlID0gb3B0cy5nZXRPckVycm9yKFwiZXhjaGFuZ2VcIik7XG4gICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJpZGVudGl0eVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFVVSUQudjQoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5fc2VydmljZUlkZW50aXR5ID0gb3B0cy5nZXRPckVycm9yKFwic2VydmljZUlkZW50aXR5XCIpO1xuICAgICAgdGhpcy5fbWFpbGJveCAgICAgICAgID0gdGhpcy5fZXhjaGFuZ2UubWFpbGJveCh0aGlzLl9pZGVudGl0eSk7XG4gICAgICB0aGlzLl9jb3VyaWVyICAgICAgICAgPSBuZXcgQ291cmllcih7XG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLFxuICAgICAgICBtYWlsYm94OiB0aGlzLl9tYWlsYm94XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgX19yZWdpc3Rlck1ldGhvZDogZnVuY3Rpb24obmFtZSwgbWV0aG9kU3BlYykge1xuICAgICAgdmFyIGFyZ3MgICAgICAgICAgPSBtZXRob2RTcGVjLmFyZ3MoKSxcbiAgICAgICAgICBkZWZhdWx0cyAgICAgID0gbWV0aG9kU3BlYy5kZWZhdWx0cygpLFxuICAgICAgICAgIG1UeXBlICAgICAgICAgPSBtZXRob2RTcGVjLm1UeXBlKCkgfHwgbmFtZSxcbiAgICAgICAgICBjb3VyaWVyTWV0aG9kID0gbWV0aG9kU3BlYy5yZXF1ZXN0UmVwbHkoKSA/IFwic2VuZEFuZFJlY2VpdmVcIiA6IFwic2VuZFwiO1xuXG4gICAgICB2YXIgZ2V0QXJncyA9IF8uYmluZChmdW5jdGlvbihkZWZhdWx0cywgbWV0aG9kQXJncykge1xuICAgICAgICB2YXIgZmluYWxBcmdzID0ge30sIGFyZ05hbWUsIGFyZ1ZhbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgYXJnTmFtZSA9IGFyZ3NbaV07XG4gICAgICAgICAgYXJnVmFsID0gbWV0aG9kQXJnc1tpXTtcbiAgICAgICAgICBpZiAodHlwZW9mIGFyZ1ZhbCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgaWYgKGRlZmF1bHRzLmhhc093blByb3BlcnR5KGFyZ05hbWUpKSB7XG4gICAgICAgICAgICAgIGZpbmFsQXJnc1thcmdOYW1lXSA9IGRlZmF1bHRzW2FyZ05hbWVdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yLkFyZ3VtZW50TWlzc2luZ0Vycm9yKFwiYXJndW1lbnQgbWlzc2luZzogXCIgKyBhcmdOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmluYWxBcmdzW2FyZ05hbWVdID0gYXJnVmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmluYWxBcmdzO1xuICAgICAgfSwgbnVsbCwgZGVmYXVsdHMpO1xuXG4gICAgICB0aGlzW25hbWVdID0gUHJvbWlzZS5tZXRob2QoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbXNnID0gXy5leHRlbmQoe1xuICAgICAgICAgIG1UOiBtVHlwZVxuICAgICAgICB9LCBnZXRBcmdzKF8udG9BcnJheShhcmd1bWVudHMpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb3VyaWVyW2NvdXJpZXJNZXRob2RdKHRoaXMuX3NlcnZpY2VJZGVudGl0eSwgbXNnKTtcbiAgICAgIH0sIHRoaXMpKTtcblxuICAgIH1cbiAgfSk7XG5cbiAgdmFyIEVycm9yID0ge1xuICAgIEFyZ3VtZW50TWlzc2luZ0Vycm9yOiBMYW5nLm1ha2VFcnJvckNsYXNzKFwiQXJndW1lbnRNaXNzaW5nRXJyb3JcIiwgXCJhcmd1bWVudCBtaXNzaW5nXCIpXG4gIH07XG5cbiAgQmFzZUNsaWVudC5FcnJvciA9IEVycm9yO1xuXG4gIHJldHVybiBCYXNlQ2xpZW50O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2xhbmdcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL3V1aWRcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9tZXNzYWdpbmcvY291cmllclwiKVxuKTtcblxufSkoKSIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbnByb2Nlc3MubmV4dFRpY2sgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYW5TZXRJbW1lZGlhdGUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICYmIHdpbmRvdy5zZXRJbW1lZGlhdGU7XG4gICAgdmFyIGNhblBvc3QgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgICYmIHdpbmRvdy5wb3N0TWVzc2FnZSAmJiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lclxuICAgIDtcblxuICAgIGlmIChjYW5TZXRJbW1lZGlhdGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB3aW5kb3cuc2V0SW1tZWRpYXRlKGYpIH07XG4gICAgfVxuXG4gICAgaWYgKGNhblBvc3QpIHtcbiAgICAgICAgdmFyIHF1ZXVlID0gW107XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gZXYuc291cmNlO1xuICAgICAgICAgICAgaWYgKChzb3VyY2UgPT09IHdpbmRvdyB8fCBzb3VyY2UgPT09IG51bGwpICYmIGV2LmRhdGEgPT09ICdwcm9jZXNzLXRpY2snKSB7XG4gICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZuID0gcXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBuZXh0VGljayhmbikge1xuICAgICAgICAgICAgcXVldWUucHVzaChmbik7XG4gICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ3Byb2Nlc3MtdGljaycsICcqJyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZm4sIDApO1xuICAgIH07XG59KSgpO1xuXG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59XG5cbi8vIFRPRE8oc2h0eWxtYW4pXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbiIsIihmdW5jdGlvbihwcm9jZXNzKXsvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIG9sZDtcbmlmICh0eXBlb2YgUHJvbWlzZSAhPT0gXCJ1bmRlZmluZWRcIikgb2xkID0gUHJvbWlzZTtcbmZ1bmN0aW9uIG5vQ29uZmxpY3QoYmx1ZWJpcmQpIHtcbiAgICB0cnkgeyBpZiAoUHJvbWlzZSA9PT0gYmx1ZWJpcmQpIFByb21pc2UgPSBvbGQ7IH1cbiAgICBjYXRjaCAoZSkge31cbiAgICByZXR1cm4gYmx1ZWJpcmQ7XG59XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xuXG52YXIgSU5URVJOQUwgPSBmdW5jdGlvbigpe307XG52YXIgQVBQTFkgPSB7fTtcbnZhciBORVhUX0ZJTFRFUiA9IHtlOiBudWxsfTtcblxudmFyIGNhc3QgPSByZXF1aXJlKFwiLi90aGVuYWJsZXMuanNcIikoUHJvbWlzZSwgSU5URVJOQUwpO1xudmFyIFByb21pc2VBcnJheSA9IHJlcXVpcmUoXCIuL3Byb21pc2VfYXJyYXkuanNcIikoUHJvbWlzZSwgSU5URVJOQUwsIGNhc3QpO1xudmFyIENhcHR1cmVkVHJhY2UgPSByZXF1aXJlKFwiLi9jYXB0dXJlZF90cmFjZS5qc1wiKSgpO1xudmFyIENhdGNoRmlsdGVyID0gcmVxdWlyZShcIi4vY2F0Y2hfZmlsdGVyLmpzXCIpKE5FWFRfRklMVEVSKTtcbnZhciBQcm9taXNlUmVzb2x2ZXIgPSByZXF1aXJlKFwiLi9wcm9taXNlX3Jlc29sdmVyLmpzXCIpO1xuXG52YXIgaXNBcnJheSA9IHV0aWwuaXNBcnJheTtcblxudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciB0cnlDYXRjaDIgPSB1dGlsLnRyeUNhdGNoMjtcbnZhciB0cnlDYXRjaEFwcGx5ID0gdXRpbC50cnlDYXRjaEFwcGx5O1xudmFyIFJhbmdlRXJyb3IgPSBlcnJvcnMuUmFuZ2VFcnJvcjtcbnZhciBUeXBlRXJyb3IgPSBlcnJvcnMuVHlwZUVycm9yO1xudmFyIENhbmNlbGxhdGlvbkVycm9yID0gZXJyb3JzLkNhbmNlbGxhdGlvbkVycm9yO1xudmFyIFRpbWVvdXRFcnJvciA9IGVycm9ycy5UaW1lb3V0RXJyb3I7XG52YXIgT3BlcmF0aW9uYWxFcnJvciA9IGVycm9ycy5PcGVyYXRpb25hbEVycm9yO1xudmFyIG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uID0gZXJyb3JzLm9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uO1xudmFyIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbiA9IGVycm9ycy5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb247XG52YXIgY2FuQXR0YWNoID0gZXJyb3JzLmNhbkF0dGFjaDtcbnZhciB0aHJvd2VyID0gdXRpbC50aHJvd2VyO1xudmFyIGFwaVJlamVjdGlvbiA9IHJlcXVpcmUoXCIuL2Vycm9yc19hcGlfcmVqZWN0aW9uXCIpKFByb21pc2UpO1xuXG5cbnZhciBtYWtlU2VsZlJlc29sdXRpb25FcnJvciA9IGZ1bmN0aW9uIFByb21pc2UkX21ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCkge1xuICAgIHJldHVybiBuZXcgVHlwZUVycm9yKFwiY2lyY3VsYXIgcHJvbWlzZSByZXNvbHV0aW9uIGNoYWluXCIpO1xufTtcblxuZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICAgIGlmICh0eXBlb2YgcmVzb2x2ZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwidGhlIHByb21pc2UgY29uc3RydWN0b3IgcmVxdWlyZXMgYSByZXNvbHZlciBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY29uc3RydWN0b3IgIT09IFByb21pc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBpbnZva2VkIGRpcmVjdGx5XCIpO1xuICAgIH1cbiAgICB0aGlzLl9iaXRGaWVsZCA9IDA7XG4gICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9yZWplY3Rpb25IYW5kbGVyMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9wcm9taXNlMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9yZWNlaXZlcjAgPSB2b2lkIDA7XG4gICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdm9pZCAwO1xuICAgIHRoaXMuX2JvdW5kVG8gPSB2b2lkIDA7XG4gICAgaWYgKHJlc29sdmVyICE9PSBJTlRFUk5BTCkgdGhpcy5fcmVzb2x2ZUZyb21SZXNvbHZlcihyZXNvbHZlcik7XG59XG5cblByb21pc2UucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiBQcm9taXNlJGJpbmQodGhpc0FyZykge1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9mb2xsb3codGhpcyk7XG4gICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHRoaXMsIDIgfCAxKTtcbiAgICByZXQuX3NldEJvdW5kVG8odGhpc0FyZyk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gUHJvbWlzZSR0b1N0cmluZygpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IFByb21pc2VdXCI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5jYXVnaHQgPSBQcm9taXNlLnByb3RvdHlwZVtcImNhdGNoXCJdID1cbmZ1bmN0aW9uIFByb21pc2UkY2F0Y2goZm4pIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBpZiAobGVuID4gMSkge1xuICAgICAgICB2YXIgY2F0Y2hJbnN0YW5jZXMgPSBuZXcgQXJyYXkobGVuIC0gMSksXG4gICAgICAgICAgICBqID0gMCwgaTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbiAtIDE7ICsraSkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGNhdGNoSW5zdGFuY2VzW2orK10gPSBpdGVtO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY2F0Y2hGaWx0ZXJUeXBlRXJyb3IgPVxuICAgICAgICAgICAgICAgICAgICBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJBIGNhdGNoIGZpbHRlciBtdXN0IGJlIGFuIGVycm9yIGNvbnN0cnVjdG9yIFwiXG4gICAgICAgICAgICAgICAgICAgICAgICArIFwib3IgYSBmaWx0ZXIgZnVuY3Rpb25cIik7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRhY2hFeHRyYVRyYWNlKGNhdGNoRmlsdGVyVHlwZUVycm9yKTtcbiAgICAgICAgICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fcmVqZWN0LCB0aGlzLCBjYXRjaEZpbHRlclR5cGVFcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoSW5zdGFuY2VzLmxlbmd0aCA9IGo7XG4gICAgICAgIGZuID0gYXJndW1lbnRzW2ldO1xuXG4gICAgICAgIHRoaXMuX3Jlc2V0VHJhY2UoKTtcbiAgICAgICAgdmFyIGNhdGNoRmlsdGVyID0gbmV3IENhdGNoRmlsdGVyKGNhdGNoSW5zdGFuY2VzLCBmbiwgdGhpcyk7XG4gICAgICAgIHJldHVybiB0aGlzLl90aGVuKHZvaWQgMCwgY2F0Y2hGaWx0ZXIuZG9GaWx0ZXIsIHZvaWQgMCxcbiAgICAgICAgICAgIGNhdGNoRmlsdGVyLCB2b2lkIDApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fdGhlbih2b2lkIDAsIGZuLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRoZW4gPVxuZnVuY3Rpb24gUHJvbWlzZSR0aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICByZXR1cm4gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLFxuICAgICAgICB2b2lkIDAsIHZvaWQgMCk7XG59O1xuXG5cblByb21pc2UucHJvdG90eXBlLmRvbmUgPVxuZnVuY3Rpb24gUHJvbWlzZSRkb25lKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3RoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcyxcbiAgICAgICAgdm9pZCAwLCB2b2lkIDApO1xuICAgIHByb21pc2UuX3NldElzRmluYWwoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnNwcmVhZCA9IGZ1bmN0aW9uIFByb21pc2Ukc3ByZWFkKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCkge1xuICAgIHJldHVybiB0aGlzLl90aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgdm9pZCAwLFxuICAgICAgICBBUFBMWSwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmlzQ2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJGlzQ2FuY2VsbGFibGUoKSB7XG4gICAgcmV0dXJuICF0aGlzLmlzUmVzb2x2ZWQoKSAmJlxuICAgICAgICB0aGlzLl9jYW5jZWxsYWJsZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gUHJvbWlzZSR0b0pTT04oKSB7XG4gICAgdmFyIHJldCA9IHtcbiAgICAgICAgaXNGdWxmaWxsZWQ6IGZhbHNlLFxuICAgICAgICBpc1JlamVjdGVkOiBmYWxzZSxcbiAgICAgICAgZnVsZmlsbG1lbnRWYWx1ZTogdm9pZCAwLFxuICAgICAgICByZWplY3Rpb25SZWFzb246IHZvaWQgMFxuICAgIH07XG4gICAgaWYgKHRoaXMuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICByZXQuZnVsZmlsbG1lbnRWYWx1ZSA9IHRoaXMuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgcmV0LmlzRnVsZmlsbGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHJldC5yZWplY3Rpb25SZWFzb24gPSB0aGlzLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgIHJldC5pc1JlamVjdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uIFByb21pc2UkYWxsKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZUFycmF5KHRoaXMpLnByb21pc2UoKTtcbn07XG5cblxuUHJvbWlzZS5pcyA9IGZ1bmN0aW9uIFByb21pc2UkSXModmFsKSB7XG4gICAgcmV0dXJuIHZhbCBpbnN0YW5jZW9mIFByb21pc2U7XG59O1xuXG5Qcm9taXNlLmFsbCA9IGZ1bmN0aW9uIFByb21pc2UkQWxsKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlQXJyYXkocHJvbWlzZXMpLnByb21pc2UoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gUHJvbWlzZSRfZXJyb3IoZm4pIHtcbiAgICByZXR1cm4gdGhpcy5jYXVnaHQob3JpZ2luYXRlc0Zyb21SZWplY3Rpb24sIGZuKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZXNvbHZlRnJvbVN5bmNWYWx1ZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZXNvbHZlRnJvbVN5bmNWYWx1ZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICAgICAgdGhpcy5fc2V0UmVqZWN0ZWQoKTtcbiAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdmFsdWUuZTtcbiAgICAgICAgdGhpcy5fZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWUsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICB0aGlzLl9mb2xsb3cobWF5YmVQcm9taXNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NsZWFuVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLl9zZXRGdWxmaWxsZWQoKTtcbiAgICAgICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuUHJvbWlzZS5tZXRob2QgPSBmdW5jdGlvbiBQcm9taXNlJF9NZXRob2QoZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX21ldGhvZCgpIHtcbiAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6IHZhbHVlID0gdHJ5Q2F0Y2gxKGZuLCB0aGlzLCB2b2lkIDApOyBicmVhaztcbiAgICAgICAgY2FzZSAxOiB2YWx1ZSA9IHRyeUNhdGNoMShmbiwgdGhpcywgYXJndW1lbnRzWzBdKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgMjogdmFsdWUgPSB0cnlDYXRjaDIoZm4sIHRoaXMsIGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKTsgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuKTsgZm9yKHZhciAkX2kgPSAwOyAkX2kgPCAkX2xlbjsgKyskX2kpIHthcmdzWyRfaV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgICAgICAgICB2YWx1ZSA9IHRyeUNhdGNoQXBwbHkoZm4sIGFyZ3MsIHRoaXMpOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgIHJldC5fcmVzb2x2ZUZyb21TeW5jVmFsdWUodmFsdWUpO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG59O1xuXG5Qcm9taXNlLmF0dGVtcHQgPSBQcm9taXNlW1widHJ5XCJdID0gZnVuY3Rpb24gUHJvbWlzZSRfVHJ5KGZuLCBhcmdzLCBjdHgpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgdmFyIHZhbHVlID0gaXNBcnJheShhcmdzKVxuICAgICAgICA/IHRyeUNhdGNoQXBwbHkoZm4sIGFyZ3MsIGN0eClcbiAgICAgICAgOiB0cnlDYXRjaDEoZm4sIGN0eCwgYXJncyk7XG5cbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICByZXQuX3Jlc29sdmVGcm9tU3luY1ZhbHVlKHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5kZWZlciA9IFByb21pc2UucGVuZGluZyA9IGZ1bmN0aW9uIFByb21pc2UkRGVmZXIoKSB7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcHJvbWlzZS5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2VSZXNvbHZlcihwcm9taXNlKTtcbn07XG5cblByb21pc2UuYmluZCA9IGZ1bmN0aW9uIFByb21pc2UkQmluZCh0aGlzQXJnKSB7XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgcmV0Ll9zZXRGdWxmaWxsZWQoKTtcbiAgICByZXQuX3NldEJvdW5kVG8odGhpc0FyZyk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UuY2FzdCA9IGZ1bmN0aW9uIFByb21pc2UkX0Nhc3Qob2JqKSB7XG4gICAgdmFyIHJldCA9IGNhc3Qob2JqLCB2b2lkIDApO1xuICAgIGlmICghKHJldCBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIHZhciB2YWwgPSByZXQ7XG4gICAgICAgIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICByZXQuX3NldEZ1bGZpbGxlZCgpO1xuICAgICAgICByZXQuX2NsZWFuVmFsdWVzKCk7XG4gICAgICAgIHJldC5fc2V0dGxlZFZhbHVlID0gdmFsO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5yZXNvbHZlID0gUHJvbWlzZS5mdWxmaWxsZWQgPSBQcm9taXNlLmNhc3Q7XG5cblByb21pc2UucmVqZWN0ID0gUHJvbWlzZS5yZWplY3RlZCA9IGZ1bmN0aW9uIFByb21pc2UkUmVqZWN0KHJlYXNvbikge1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgIG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihyZWFzb24pO1xuICAgIHJldC5fY2xlYW5WYWx1ZXMoKTtcbiAgICByZXQuX3NldFJlamVjdGVkKCk7XG4gICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSByZWFzb247XG4gICAgaWYgKCFjYW5BdHRhY2gocmVhc29uKSkge1xuICAgICAgICB2YXIgdHJhY2UgPSBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgICAgIHJldC5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuICAgIH1cbiAgICByZXQuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLm9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPVxuZnVuY3Rpb24gUHJvbWlzZSRPblBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKGZuKSB7XG4gICAgICAgIENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPSB0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZm4gOiB2b2lkIDA7XG59O1xuXG52YXIgdW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZDtcblByb21pc2Uub25VbmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2Ukb25VbmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkKGZuKSB7XG4gICAgdW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZCA9IHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiID8gZm4gOiB2b2lkIDA7XG59O1xuXG52YXIgZGVidWdnaW5nID0gZmFsc2UgfHwgISEoXG4gICAgdHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICB0eXBlb2YgcHJvY2Vzcy5leGVjUGF0aCA9PT0gXCJzdHJpbmdcIiAmJlxuICAgIHR5cGVvZiBwcm9jZXNzLmVudiA9PT0gXCJvYmplY3RcIiAmJlxuICAgIChwcm9jZXNzLmVudltcIkJMVUVCSVJEX0RFQlVHXCJdIHx8XG4gICAgICAgIHByb2Nlc3MuZW52W1wiTk9ERV9FTlZcIl0gPT09IFwiZGV2ZWxvcG1lbnRcIilcbik7XG5cblxuUHJvbWlzZS5sb25nU3RhY2tUcmFjZXMgPSBmdW5jdGlvbiBQcm9taXNlJExvbmdTdGFja1RyYWNlcygpIHtcbiAgICBpZiAoYXN5bmMuaGF2ZUl0ZW1zUXVldWVkKCkgJiZcbiAgICAgICAgZGVidWdnaW5nID09PSBmYWxzZVxuICAgKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbm5vdCBlbmFibGUgbG9uZyBzdGFjayB0cmFjZXMgYWZ0ZXIgcHJvbWlzZXMgaGF2ZSBiZWVuIGNyZWF0ZWRcIik7XG4gICAgfVxuICAgIGRlYnVnZ2luZyA9IENhcHR1cmVkVHJhY2UuaXNTdXBwb3J0ZWQoKTtcbn07XG5cblByb21pc2UuaGFzTG9uZ1N0YWNrVHJhY2VzID0gZnVuY3Rpb24gUHJvbWlzZSRIYXNMb25nU3RhY2tUcmFjZXMoKSB7XG4gICAgcmV0dXJuIGRlYnVnZ2luZyAmJiBDYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdGhlbiA9XG5mdW5jdGlvbiBQcm9taXNlJF90aGVuKFxuICAgIGRpZEZ1bGZpbGwsXG4gICAgZGlkUmVqZWN0LFxuICAgIGRpZFByb2dyZXNzLFxuICAgIHJlY2VpdmVyLFxuICAgIGludGVybmFsRGF0YVxuKSB7XG4gICAgdmFyIGhhdmVJbnRlcm5hbERhdGEgPSBpbnRlcm5hbERhdGEgIT09IHZvaWQgMDtcbiAgICB2YXIgcmV0ID0gaGF2ZUludGVybmFsRGF0YSA/IGludGVybmFsRGF0YSA6IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcblxuICAgIGlmICghaGF2ZUludGVybmFsRGF0YSkge1xuICAgICAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgICAgICB2YXIgaGF2ZVNhbWVDb250ZXh0ID0gdGhpcy5fcGVla0NvbnRleHQoKSA9PT0gdGhpcy5fdHJhY2VQYXJlbnQ7XG4gICAgICAgICAgICByZXQuX3RyYWNlUGFyZW50ID0gaGF2ZVNhbWVDb250ZXh0ID8gdGhpcy5fdHJhY2VQYXJlbnQgOiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCA3KTtcbiAgICB9XG5cbiAgICB2YXIgY2FsbGJhY2tJbmRleCA9XG4gICAgICAgIHRoaXMuX2FkZENhbGxiYWNrcyhkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLCByZXQsIHJlY2VpdmVyKTtcblxuICAgIGlmICh0aGlzLmlzUmVzb2x2ZWQoKSkge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fcXVldWVTZXR0bGVBdCwgdGhpcywgY2FsbGJhY2tJbmRleCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9sZW5ndGggPSBmdW5jdGlvbiBQcm9taXNlJF9sZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2JpdEZpZWxkICYgMjYyMTQzO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA5Mzk1MjQwOTYpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0ZvbGxvd2luZyA9IGZ1bmN0aW9uIFByb21pc2UkX2lzRm9sbG93aW5nKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA1MzY4NzA5MTIpID09PSA1MzY4NzA5MTI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0TGVuZ3RoID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0TGVuZ3RoKGxlbikge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gKHRoaXMuX2JpdEZpZWxkICYgLTI2MjE0NCkgfFxuICAgICAgICAobGVuICYgMjYyMTQzKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRGdWxmaWxsZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRGdWxmaWxsZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDI2ODQzNTQ1Njtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRSZWplY3RlZCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldFJlamVjdGVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAxMzQyMTc3Mjg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0Rm9sbG93aW5nID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0Rm9sbG93aW5nKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA1MzY4NzA5MTI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0SXNGaW5hbCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldElzRmluYWwoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDMzNTU0NDMyO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzRmluYWwgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0ZpbmFsKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAzMzU1NDQzMikgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfY2FuY2VsbGFibGUoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDY3MTA4ODY0KSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0Q2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRDYW5jZWxsYWJsZSgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNjcxMDg4NjQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRDYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0Q2FuY2VsbGFibGUoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+NjcxMDg4NjQpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFJlamVjdGlvbklzVW5oYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldFJlamVjdGlvbklzVW5oYW5kbGVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAyMDk3MTUyO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4yMDk3MTUyKTtcbiAgICBpZiAodGhpcy5faXNVbmhhbmRsZWRSZWplY3Rpb25Ob3RpZmllZCgpKSB7XG4gICAgICAgIHRoaXMuX3Vuc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCgpO1xuICAgICAgICB0aGlzLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb25Jc0hhbmRsZWQoKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNSZWplY3Rpb25VbmhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfaXNSZWplY3Rpb25VbmhhbmRsZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDIwOTcxNTIpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDUyNDI4ODtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjUyNDI4OCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNVbmhhbmRsZWRSZWplY3Rpb25Ob3RpZmllZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9pc1VuaGFuZGxlZFJlamVjdGlvbk5vdGlmaWVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA1MjQyODgpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXRDYXJyaWVkU3RhY2tUcmFjZShjYXB0dXJlZFRyYWNlKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDEwNDg1NzY7XG4gICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IGNhcHR1cmVkVHJhY2U7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF91bnNldENhcnJpZWRTdGFja1RyYWNlKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjEwNDg1NzYpO1xuICAgIHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjAgPSB2b2lkIDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNDYXJyeWluZ1N0YWNrVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfaXNDYXJyeWluZ1N0YWNrVHJhY2UoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDEwNDg1NzYpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNDYXJyeWluZ1N0YWNrVHJhY2UoKVxuICAgICAgICA/IHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlcjBcbiAgICAgICAgOiB2b2lkIDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVjZWl2ZXJBdCA9IGZ1bmN0aW9uIFByb21pc2UkX3JlY2VpdmVyQXQoaW5kZXgpIHtcbiAgICB2YXIgcmV0ID0gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9yZWNlaXZlcjBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDRdO1xuICAgIGlmICh0aGlzLl9pc0JvdW5kKCkgJiYgcmV0ID09PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kVG87XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvbWlzZUF0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcHJvbWlzZUF0KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fcHJvbWlzZTBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDNdO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGxtZW50SGFuZGxlckF0ID1cbmZ1bmN0aW9uIFByb21pc2UkX2Z1bGZpbGxtZW50SGFuZGxlckF0KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMFxuICAgICAgICA6IHRoaXNbKGluZGV4IDw8IDIpICsgaW5kZXggLSA1ICsgMF07XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0aW9uSGFuZGxlckF0ID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdGlvbkhhbmRsZXJBdChpbmRleCkge1xuICAgIHJldHVybiBpbmRleCA9PT0gMFxuICAgICAgICA/IHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAxXTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9hZGRDYWxsYmFja3MgPSBmdW5jdGlvbiBQcm9taXNlJF9hZGRDYWxsYmFja3MoXG4gICAgZnVsZmlsbCxcbiAgICByZWplY3QsXG4gICAgcHJvZ3Jlc3MsXG4gICAgcHJvbWlzZSxcbiAgICByZWNlaXZlclxuKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fbGVuZ3RoKCk7XG5cbiAgICBpZiAoaW5kZXggPj0gMjYyMTQzIC0gNSkge1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3NldExlbmd0aCgwKTtcbiAgICB9XG5cbiAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZTAgPSBwcm9taXNlO1xuICAgICAgICBpZiAocmVjZWl2ZXIgIT09IHZvaWQgMCkgdGhpcy5fcmVjZWl2ZXIwID0gcmVjZWl2ZXI7XG4gICAgICAgIGlmICh0eXBlb2YgZnVsZmlsbCA9PT0gXCJmdW5jdGlvblwiICYmICF0aGlzLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpKVxuICAgICAgICAgICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IGZ1bGZpbGw7XG4gICAgICAgIGlmICh0eXBlb2YgcmVqZWN0ID09PSBcImZ1bmN0aW9uXCIpIHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwID0gcmVqZWN0O1xuICAgICAgICBpZiAodHlwZW9mIHByb2dyZXNzID09PSBcImZ1bmN0aW9uXCIpIHRoaXMuX3Byb2dyZXNzSGFuZGxlcjAgPSBwcm9ncmVzcztcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgYmFzZSA9IChpbmRleCA8PCAyKSArIGluZGV4IC0gNTtcbiAgICAgICAgdGhpc1tiYXNlICsgM10gPSBwcm9taXNlO1xuICAgICAgICB0aGlzW2Jhc2UgKyA0XSA9IHJlY2VpdmVyO1xuICAgICAgICB0aGlzW2Jhc2UgKyAwXSA9IHR5cGVvZiBmdWxmaWxsID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBmdWxmaWxsIDogdm9pZCAwO1xuICAgICAgICB0aGlzW2Jhc2UgKyAxXSA9IHR5cGVvZiByZWplY3QgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHJlamVjdCA6IHZvaWQgMDtcbiAgICAgICAgdGhpc1tiYXNlICsgMl0gPSB0eXBlb2YgcHJvZ3Jlc3MgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHByb2dyZXNzIDogdm9pZCAwO1xuICAgIH1cbiAgICB0aGlzLl9zZXRMZW5ndGgoaW5kZXggKyAxKTtcbiAgICByZXR1cm4gaW5kZXg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0UHJveHlIYW5kbGVycyA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXRQcm94eUhhbmRsZXJzKHJlY2VpdmVyLCBwcm9taXNlU2xvdFZhbHVlKSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fbGVuZ3RoKCk7XG5cbiAgICBpZiAoaW5kZXggPj0gMjYyMTQzIC0gNSkge1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3NldExlbmd0aCgwKTtcbiAgICB9XG4gICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2UwID0gcHJvbWlzZVNsb3RWYWx1ZTtcbiAgICAgICAgdGhpcy5fcmVjZWl2ZXIwID0gcmVjZWl2ZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGJhc2UgPSAoaW5kZXggPDwgMikgKyBpbmRleCAtIDU7XG4gICAgICAgIHRoaXNbYmFzZSArIDNdID0gcHJvbWlzZVNsb3RWYWx1ZTtcbiAgICAgICAgdGhpc1tiYXNlICsgNF0gPSByZWNlaXZlcjtcbiAgICAgICAgdGhpc1tiYXNlICsgMF0gPVxuICAgICAgICB0aGlzW2Jhc2UgKyAxXSA9XG4gICAgICAgIHRoaXNbYmFzZSArIDJdID0gdm9pZCAwO1xuICAgIH1cbiAgICB0aGlzLl9zZXRMZW5ndGgoaW5kZXggKyAxKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm94eVByb21pc2VBcnJheSA9XG5mdW5jdGlvbiBQcm9taXNlJF9wcm94eVByb21pc2VBcnJheShwcm9taXNlQXJyYXksIGluZGV4KSB7XG4gICAgdGhpcy5fc2V0UHJveHlIYW5kbGVycyhwcm9taXNlQXJyYXksIGluZGV4KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm94eVByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlJF9wcm94eVByb21pc2UocHJvbWlzZSkge1xuICAgIHByb21pc2UuX3NldFByb3hpZWQoKTtcbiAgICB0aGlzLl9zZXRQcm94eUhhbmRsZXJzKHByb21pc2UsIC0xKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRCb3VuZFRvID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0Qm91bmRUbyhvYmopIHtcbiAgICBpZiAob2JqICE9PSB2b2lkIDApIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDgzODg2MDg7XG4gICAgICAgIHRoaXMuX2JvdW5kVG8gPSBvYmo7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+ODM4ODYwOCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzQm91bmQgPSBmdW5jdGlvbiBQcm9taXNlJF9pc0JvdW5kKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA4Mzg4NjA4KSA9PT0gODM4ODYwODtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZXNvbHZlRnJvbVJlc29sdmVyID1cbmZ1bmN0aW9uIFByb21pc2UkX3Jlc29sdmVGcm9tUmVzb2x2ZXIocmVzb2x2ZXIpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgdGhpcy5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICB0aGlzLl9wdXNoQ29udGV4dCgpO1xuXG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVzb2x2ZXIodmFsKSB7XG4gICAgICAgIGlmIChwcm9taXNlLl90cnlGb2xsb3codmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHByb21pc2UuX2Z1bGZpbGwodmFsKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0ZXIodmFsKSB7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaCh2YWwpID8gdmFsIDogbmV3IEVycm9yKHZhbCArIFwiXCIpO1xuICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKHZhbCk7XG4gICAgICAgIHByb21pc2UuX3JlamVjdCh2YWwsIHRyYWNlID09PSB2YWwgPyB2b2lkIDAgOiB0cmFjZSk7XG4gICAgfVxuICAgIHZhciByID0gdHJ5Q2F0Y2gyKHJlc29sdmVyLCB2b2lkIDAsIFByb21pc2UkX3Jlc29sdmVyLCBQcm9taXNlJF9yZWplY3Rlcik7XG4gICAgdGhpcy5fcG9wQ29udGV4dCgpO1xuXG4gICAgaWYgKHIgIT09IHZvaWQgMCAmJiByID09PSBlcnJvck9iaikge1xuICAgICAgICB2YXIgZSA9IHIuZTtcbiAgICAgICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKGUpID8gZSA6IG5ldyBFcnJvcihlICsgXCJcIik7XG4gICAgICAgIHByb21pc2UuX3JlamVjdChlLCB0cmFjZSk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NwcmVhZFNsb3dDYXNlID1cbmZ1bmN0aW9uIFByb21pc2UkX3NwcmVhZFNsb3dDYXNlKHRhcmdldEZuLCBwcm9taXNlLCB2YWx1ZXMsIGJvdW5kVG8pIHtcbiAgICB2YXIgcHJvbWlzZUZvckFsbCA9IG5ldyBQcm9taXNlQXJyYXkodmFsdWVzKS5wcm9taXNlKCk7XG4gICAgdmFyIHByb21pc2UyID0gcHJvbWlzZUZvckFsbC5fdGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldEZuLmFwcGx5KGJvdW5kVG8sIGFyZ3VtZW50cyk7XG4gICAgfSwgdm9pZCAwLCB2b2lkIDAsIEFQUExZLCB2b2lkIDApO1xuICAgIHByb21pc2UuX2ZvbGxvdyhwcm9taXNlMik7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2FsbFNwcmVhZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9jYWxsU3ByZWFkKGhhbmRsZXIsIHByb21pc2UsIHZhbHVlKSB7XG4gICAgdmFyIGJvdW5kVG8gPSB0aGlzLl9ib3VuZFRvO1xuICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChjYXN0KHZhbHVlW2ldLCB2b2lkIDApIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NwcmVhZFNsb3dDYXNlKGhhbmRsZXIsIHByb21pc2UsIHZhbHVlLCBib3VuZFRvKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvbWlzZS5fcHVzaENvbnRleHQoKTtcbiAgICByZXR1cm4gdHJ5Q2F0Y2hBcHBseShoYW5kbGVyLCB2YWx1ZSwgYm91bmRUbyk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2FsbEhhbmRsZXIgPVxuZnVuY3Rpb24gUHJvbWlzZSRfY2FsbEhhbmRsZXIoXG4gICAgaGFuZGxlciwgcmVjZWl2ZXIsIHByb21pc2UsIHZhbHVlKSB7XG4gICAgdmFyIHg7XG4gICAgaWYgKHJlY2VpdmVyID09PSBBUFBMWSAmJiAhdGhpcy5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgeCA9IHRoaXMuX2NhbGxTcHJlYWQoaGFuZGxlciwgcHJvbWlzZSwgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHByb21pc2UuX3B1c2hDb250ZXh0KCk7XG4gICAgICAgIHggPSB0cnlDYXRjaDEoaGFuZGxlciwgcmVjZWl2ZXIsIHZhbHVlKTtcbiAgICB9XG4gICAgcHJvbWlzZS5fcG9wQ29udGV4dCgpO1xuICAgIHJldHVybiB4O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VGcm9tSGFuZGxlciA9XG5mdW5jdGlvbiBQcm9taXNlJF9zZXR0bGVQcm9taXNlRnJvbUhhbmRsZXIoXG4gICAgaGFuZGxlciwgcmVjZWl2ZXIsIHZhbHVlLCBwcm9taXNlXG4pIHtcbiAgICBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgaGFuZGxlci5jYWxsKHJlY2VpdmVyLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHggPSB0aGlzLl9jYWxsSGFuZGxlcihoYW5kbGVyLCByZWNlaXZlciwgcHJvbWlzZSwgdmFsdWUpO1xuICAgIGlmIChwcm9taXNlLl9pc0ZvbGxvd2luZygpKSByZXR1cm47XG5cbiAgICBpZiAoeCA9PT0gZXJyb3JPYmogfHwgeCA9PT0gcHJvbWlzZSB8fCB4ID09PSBORVhUX0ZJTFRFUikge1xuICAgICAgICB2YXIgZXJyID0geCA9PT0gcHJvbWlzZVxuICAgICAgICAgICAgICAgICAgICA/IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKClcbiAgICAgICAgICAgICAgICAgICAgOiB4LmU7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChlcnIpID8gZXJyIDogbmV3IEVycm9yKGVyciArIFwiXCIpO1xuICAgICAgICBpZiAoeCAhPT0gTkVYVF9GSUxURVIpIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICBwcm9taXNlLl9yZWplY3RVbmNoZWNrZWQoZXJyLCB0cmFjZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGNhc3RWYWx1ZSA9IGNhc3QoeCwgcHJvbWlzZSk7XG4gICAgICAgIGlmIChjYXN0VmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAoY2FzdFZhbHVlLmlzUmVqZWN0ZWQoKSAmJlxuICAgICAgICAgICAgICAgICFjYXN0VmFsdWUuX2lzQ2FycnlpbmdTdGFja1RyYWNlKCkgJiZcbiAgICAgICAgICAgICAgICAhY2FuQXR0YWNoKGNhc3RWYWx1ZS5fc2V0dGxlZFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHZhciB0cmFjZSA9IG5ldyBFcnJvcihjYXN0VmFsdWUuX3NldHRsZWRWYWx1ZSArIFwiXCIpO1xuICAgICAgICAgICAgICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgICAgIGNhc3RWYWx1ZS5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvbWlzZS5fZm9sbG93KGNhc3RWYWx1ZSk7XG4gICAgICAgICAgICBwcm9taXNlLl9wcm9wYWdhdGVGcm9tKGNhc3RWYWx1ZSwgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9taXNlLl9mdWxmaWxsVW5jaGVja2VkKHgpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2ZvbGxvdyA9XG5mdW5jdGlvbiBQcm9taXNlJF9mb2xsb3cocHJvbWlzZSkge1xuICAgIHRoaXMuX3NldEZvbGxvd2luZygpO1xuXG4gICAgaWYgKHByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgdGhpcy5fcHJvcGFnYXRlRnJvbShwcm9taXNlLCAxKTtcbiAgICAgICAgcHJvbWlzZS5fcHJveHlQcm9taXNlKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAocHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgIHRoaXMuX2Z1bGZpbGxVbmNoZWNrZWQocHJvbWlzZS5fc2V0dGxlZFZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocHJvbWlzZS5fc2V0dGxlZFZhbHVlLFxuICAgICAgICAgICAgcHJvbWlzZS5fZ2V0Q2FycmllZFN0YWNrVHJhY2UoKSk7XG4gICAgfVxuXG4gICAgaWYgKHByb21pc2UuX2lzUmVqZWN0aW9uVW5oYW5kbGVkKCkpIHByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcblxuICAgIGlmIChkZWJ1Z2dpbmcgJiZcbiAgICAgICAgcHJvbWlzZS5fdHJhY2VQYXJlbnQgPT0gbnVsbCkge1xuICAgICAgICBwcm9taXNlLl90cmFjZVBhcmVudCA9IHRoaXM7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3RyeUZvbGxvdyA9XG5mdW5jdGlvbiBQcm9taXNlJF90cnlGb2xsb3codmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSB8fFxuICAgICAgICB2YWx1ZSA9PT0gdGhpcykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlLCB2b2lkIDApO1xuICAgIGlmICghKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5fZm9sbG93KG1heWJlUHJvbWlzZSk7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVzZXRUcmFjZSA9IGZ1bmN0aW9uIFByb21pc2UkX3Jlc2V0VHJhY2UoKSB7XG4gICAgaWYgKGRlYnVnZ2luZykge1xuICAgICAgICB0aGlzLl90cmFjZSA9IG5ldyBDYXB0dXJlZFRyYWNlKHRoaXMuX3BlZWtDb250ZXh0KCkgPT09IHZvaWQgMCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFRyYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0VHJhY2UocGFyZW50KSB7XG4gICAgaWYgKGRlYnVnZ2luZykge1xuICAgICAgICB2YXIgY29udGV4dCA9IHRoaXMuX3BlZWtDb250ZXh0KCk7XG4gICAgICAgIHRoaXMuX3RyYWNlUGFyZW50ID0gY29udGV4dDtcbiAgICAgICAgdmFyIGlzVG9wTGV2ZWwgPSBjb250ZXh0ID09PSB2b2lkIDA7XG4gICAgICAgIGlmIChwYXJlbnQgIT09IHZvaWQgMCAmJlxuICAgICAgICAgICAgcGFyZW50Ll90cmFjZVBhcmVudCA9PT0gY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fdHJhY2UgPSBwYXJlbnQuX3RyYWNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdHJhY2UgPSBuZXcgQ2FwdHVyZWRUcmFjZShpc1RvcExldmVsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9hdHRhY2hFeHRyYVRyYWNlID1cbmZ1bmN0aW9uIFByb21pc2UkX2F0dGFjaEV4dHJhVHJhY2UoZXJyb3IpIHtcbiAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgIHZhciBwcm9taXNlID0gdGhpcztcbiAgICAgICAgdmFyIHN0YWNrID0gZXJyb3Iuc3RhY2s7XG4gICAgICAgIHN0YWNrID0gdHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiID8gc3RhY2suc3BsaXQoXCJcXG5cIikgOiBbXTtcbiAgICAgICAgQ2FwdHVyZWRUcmFjZS5wcm90ZWN0RXJyb3JNZXNzYWdlTmV3bGluZXMoc3RhY2spO1xuICAgICAgICB2YXIgaGVhZGVyTGluZUNvdW50ID0gMTtcbiAgICAgICAgdmFyIGNvbWJpbmVkVHJhY2VzID0gMTtcbiAgICAgICAgd2hpbGUocHJvbWlzZSAhPSBudWxsICYmXG4gICAgICAgICAgICBwcm9taXNlLl90cmFjZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBzdGFjayA9IENhcHR1cmVkVHJhY2UuY29tYmluZShcbiAgICAgICAgICAgICAgICBzdGFjayxcbiAgICAgICAgICAgICAgICBwcm9taXNlLl90cmFjZS5zdGFjay5zcGxpdChcIlxcblwiKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHByb21pc2UgPSBwcm9taXNlLl90cmFjZVBhcmVudDtcbiAgICAgICAgICAgIGNvbWJpbmVkVHJhY2VzKys7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3RhY2tUcmFjZUxpbWl0ID0gRXJyb3Iuc3RhY2tUcmFjZUxpbWl0IHx8IDEwO1xuICAgICAgICB2YXIgbWF4ID0gKHN0YWNrVHJhY2VMaW1pdCArIGhlYWRlckxpbmVDb3VudCkgKiBjb21iaW5lZFRyYWNlcztcbiAgICAgICAgdmFyIGxlbiA9IHN0YWNrLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA+IG1heCkge1xuICAgICAgICAgICAgc3RhY2subGVuZ3RoID0gbWF4O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxlbiA+IDApXG4gICAgICAgICAgICBzdGFja1swXSA9IHN0YWNrWzBdLnNwbGl0KFwiXFx1MDAwMlxcdTAwMDBcXHUwMDAxXCIpLmpvaW4oXCJcXG5cIik7XG5cbiAgICAgICAgaWYgKHN0YWNrLmxlbmd0aCA8PSBoZWFkZXJMaW5lQ291bnQpIHtcbiAgICAgICAgICAgIGVycm9yLnN0YWNrID0gXCIoTm8gc3RhY2sgdHJhY2UpXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnJvci5zdGFjayA9IHN0YWNrLmpvaW4oXCJcXG5cIik7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2xlYW5WYWx1ZXMgPSBmdW5jdGlvbiBQcm9taXNlJF9jbGVhblZhbHVlcygpIHtcbiAgICBpZiAodGhpcy5fY2FuY2VsbGFibGUoKSkge1xuICAgICAgICB0aGlzLl9jYW5jZWxsYXRpb25QYXJlbnQgPSB2b2lkIDA7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb3BhZ2F0ZUZyb20gPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJvcGFnYXRlRnJvbShwYXJlbnQsIGZsYWdzKSB7XG4gICAgaWYgKChmbGFncyAmIDEpID4gMCAmJiBwYXJlbnQuX2NhbmNlbGxhYmxlKCkpIHtcbiAgICAgICAgdGhpcy5fc2V0Q2FuY2VsbGFibGUoKTtcbiAgICAgICAgdGhpcy5fY2FuY2VsbGF0aW9uUGFyZW50ID0gcGFyZW50O1xuICAgIH1cbiAgICBpZiAoKGZsYWdzICYgNCkgPiAwKSB7XG4gICAgICAgIHRoaXMuX3NldEJvdW5kVG8ocGFyZW50Ll9ib3VuZFRvKTtcbiAgICB9XG4gICAgaWYgKChmbGFncyAmIDIpID4gMCkge1xuICAgICAgICB0aGlzLl9zZXRUcmFjZShwYXJlbnQpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9mdWxmaWxsID0gZnVuY3Rpb24gUHJvbWlzZSRfZnVsZmlsbCh2YWx1ZSkge1xuICAgIGlmICh0aGlzLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fZnVsZmlsbFVuY2hlY2tlZCh2YWx1ZSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0ID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdChyZWFzb24sIGNhcnJpZWRTdGFja1RyYWNlKSB7XG4gICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocmVhc29uLCBjYXJyaWVkU3RhY2tUcmFjZSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZUF0ID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0dGxlUHJvbWlzZUF0KGluZGV4KSB7XG4gICAgdmFyIGhhbmRsZXIgPSB0aGlzLmlzRnVsZmlsbGVkKClcbiAgICAgICAgPyB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXJBdChpbmRleClcbiAgICAgICAgOiB0aGlzLl9yZWplY3Rpb25IYW5kbGVyQXQoaW5kZXgpO1xuXG4gICAgdmFyIHZhbHVlID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3JlY2VpdmVyQXQoaW5kZXgpO1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZUF0KGluZGV4KTtcblxuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRoaXMuX3NldHRsZVByb21pc2VGcm9tSGFuZGxlcihoYW5kbGVyLCByZWNlaXZlciwgdmFsdWUsIHByb21pc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBkb25lID0gZmFsc2U7XG4gICAgICAgIHZhciBpc0Z1bGZpbGxlZCA9IHRoaXMuaXNGdWxmaWxsZWQoKTtcbiAgICAgICAgaWYgKHJlY2VpdmVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2UgJiZcbiAgICAgICAgICAgICAgICByZWNlaXZlci5faXNQcm94aWVkKCkpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlci5fdW5zZXRQcm94aWVkKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNGdWxmaWxsZWQpIHJlY2VpdmVyLl9mdWxmaWxsVW5jaGVja2VkKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBlbHNlIHJlY2VpdmVyLl9yZWplY3RVbmNoZWNrZWQodmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2dldENhcnJpZWRTdGFja1RyYWNlKCkpO1xuICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2VBcnJheSkge1xuICAgICAgICAgICAgICAgIGlmIChpc0Z1bGZpbGxlZCkgcmVjZWl2ZXIuX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgICAgIGVsc2UgcmVjZWl2ZXIuX3Byb21pc2VSZWplY3RlZCh2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWRvbmUpIHtcbiAgICAgICAgICAgIGlmIChpc0Z1bGZpbGxlZCkgcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG4gICAgICAgICAgICBlbHNlIHByb21pc2UuX3JlamVjdCh2YWx1ZSwgdGhpcy5fZ2V0Q2FycmllZFN0YWNrVHJhY2UoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaW5kZXggPj0gMjU2KSB7XG4gICAgICAgIHRoaXMuX3F1ZXVlR0MoKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNQcm94aWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNQcm94aWVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA0MTk0MzA0KSA9PT0gNDE5NDMwNDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRQcm94aWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0UHJveGllZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNDE5NDMwNDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldFByb3hpZWQgPSBmdW5jdGlvbiBQcm9taXNlJF91bnNldFByb3hpZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+NDE5NDMwNCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNHY1F1ZXVlZCA9IGZ1bmN0aW9uIFByb21pc2UkX2lzR2NRdWV1ZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIC0xMDczNzQxODI0KSA9PT0gLTEwNzM3NDE4MjQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0R2NRdWV1ZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRHY1F1ZXVlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgLTEwNzM3NDE4MjQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRHY1F1ZXVlZCA9IGZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0R2NRdWV1ZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+LTEwNzM3NDE4MjQpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3F1ZXVlR0MgPSBmdW5jdGlvbiBQcm9taXNlJF9xdWV1ZUdDKCkge1xuICAgIGlmICh0aGlzLl9pc0djUXVldWVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9zZXRHY1F1ZXVlZCgpO1xuICAgIGFzeW5jLmludm9rZUxhdGVyKHRoaXMuX2djLCB0aGlzLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2djID0gZnVuY3Rpb24gUHJvbWlzZSRnYygpIHtcbiAgICB2YXIgbGVuID0gdGhpcy5fbGVuZ3RoKCkgKiA1O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZGVsZXRlIHRoaXNbaV07XG4gICAgfVxuICAgIHRoaXMuX3NldExlbmd0aCgwKTtcbiAgICB0aGlzLl91bnNldEdjUXVldWVkKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcXVldWVTZXR0bGVBdCA9IGZ1bmN0aW9uIFByb21pc2UkX3F1ZXVlU2V0dGxlQXQoaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZWplY3Rpb25VbmhhbmRsZWQoKSkgdGhpcy5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgIGFzeW5jLmludm9rZSh0aGlzLl9zZXR0bGVQcm9taXNlQXQsIHRoaXMsIGluZGV4KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9mdWxmaWxsVW5jaGVja2VkID1cbmZ1bmN0aW9uIFByb21pc2UkX2Z1bGZpbGxVbmNoZWNrZWQodmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuaXNQZW5kaW5nKCkpIHJldHVybjtcbiAgICBpZiAodmFsdWUgPT09IHRoaXMpIHtcbiAgICAgICAgdmFyIGVyciA9IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCk7XG4gICAgICAgIHRoaXMuX2F0dGFjaEV4dHJhVHJhY2UoZXJyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdFVuY2hlY2tlZChlcnIsIHZvaWQgMCk7XG4gICAgfVxuICAgIHRoaXMuX2NsZWFuVmFsdWVzKCk7XG4gICAgdGhpcy5fc2V0RnVsZmlsbGVkKCk7XG4gICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuXG4gICAgaWYgKGxlbiA+IDApIHtcbiAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX3NldHRsZVByb21pc2VzLCB0aGlzLCBsZW4pO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3RVbmNoZWNrZWRDaGVja0Vycm9yID1cbmZ1bmN0aW9uIFByb21pc2UkX3JlamVjdFVuY2hlY2tlZENoZWNrRXJyb3IocmVhc29uKSB7XG4gICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKHJlYXNvbikgPyByZWFzb24gOiBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgdGhpcy5fcmVqZWN0VW5jaGVja2VkKHJlYXNvbiwgdHJhY2UgPT09IHJlYXNvbiA/IHZvaWQgMCA6IHRyYWNlKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3RVbmNoZWNrZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0VW5jaGVja2VkKHJlYXNvbiwgdHJhY2UpIHtcbiAgICBpZiAoIXRoaXMuaXNQZW5kaW5nKCkpIHJldHVybjtcbiAgICBpZiAocmVhc29uID09PSB0aGlzKSB7XG4gICAgICAgIHZhciBlcnIgPSBtYWtlU2VsZlJlc29sdXRpb25FcnJvcigpO1xuICAgICAgICB0aGlzLl9hdHRhY2hFeHRyYVRyYWNlKGVycik7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZWplY3RVbmNoZWNrZWQoZXJyKTtcbiAgICB9XG4gICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICB0aGlzLl9zZXRSZWplY3RlZCgpO1xuICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcblxuICAgIGlmICh0aGlzLl9pc0ZpbmFsKCkpIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhyb3dlciwgdm9pZCAwLCB0cmFjZSA9PT0gdm9pZCAwID8gcmVhc29uIDogdHJhY2UpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcblxuICAgIGlmICh0cmFjZSAhPT0gdm9pZCAwKSB0aGlzLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSk7XG5cbiAgICBpZiAobGVuID4gMCkge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fcmVqZWN0UHJvbWlzZXMsIHRoaXMsIG51bGwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCgpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3RQcm9taXNlcyA9IGZ1bmN0aW9uIFByb21pc2UkX3JlamVjdFByb21pc2VzKCkge1xuICAgIHRoaXMuX3NldHRsZVByb21pc2VzKCk7XG4gICAgdGhpcy5fdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VzID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0dGxlUHJvbWlzZXMoKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdGhpcy5fc2V0dGxlUHJvbWlzZUF0KGkpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9lbnN1cmVQb3NzaWJsZVJlamVjdGlvbkhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkKCkge1xuICAgIHRoaXMuX3NldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgaWYgKENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gIT09IHZvaWQgMCkge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aGlzLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb24sIHRoaXMsIHZvaWQgMCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbklzSGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb25Jc0hhbmRsZWQoKSB7XG4gICAgaWYgKHR5cGVvZiB1bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodW5oYW5kbGVkUmVqZWN0aW9uSGFuZGxlZCwgdm9pZCAwLCB0aGlzKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uID1cbmZ1bmN0aW9uIFByb21pc2UkX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbigpIHtcbiAgICBpZiAodGhpcy5faXNSZWplY3Rpb25VbmhhbmRsZWQoKSkge1xuICAgICAgICB2YXIgcmVhc29uID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICB2YXIgdHJhY2UgPSB0aGlzLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xuXG4gICAgICAgIHRoaXMuX3NldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQoKTtcblxuICAgICAgICBpZiAodHJhY2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgdGhpcy5fdW5zZXRDYXJyaWVkU3RhY2tUcmFjZSgpO1xuICAgICAgICAgICAgcmVhc29uID0gdHJhY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBDYXB0dXJlZFRyYWNlLnBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24ocmVhc29uLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBjb250ZXh0U3RhY2sgPSBbXTtcblByb21pc2UucHJvdG90eXBlLl9wZWVrQ29udGV4dCA9IGZ1bmN0aW9uIFByb21pc2UkX3BlZWtDb250ZXh0KCkge1xuICAgIHZhciBsYXN0SW5kZXggPSBjb250ZXh0U3RhY2subGVuZ3RoIC0gMTtcbiAgICBpZiAobGFzdEluZGV4ID49IDApIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHRTdGFja1tsYXN0SW5kZXhdO1xuICAgIH1cbiAgICByZXR1cm4gdm9pZCAwO1xuXG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHVzaENvbnRleHQgPSBmdW5jdGlvbiBQcm9taXNlJF9wdXNoQ29udGV4dCgpIHtcbiAgICBpZiAoIWRlYnVnZ2luZykgcmV0dXJuO1xuICAgIGNvbnRleHRTdGFjay5wdXNoKHRoaXMpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3BvcENvbnRleHQgPSBmdW5jdGlvbiBQcm9taXNlJF9wb3BDb250ZXh0KCkge1xuICAgIGlmICghZGVidWdnaW5nKSByZXR1cm47XG4gICAgY29udGV4dFN0YWNrLnBvcCgpO1xufTtcblxuUHJvbWlzZS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gUHJvbWlzZSROb0NvbmZsaWN0KCkge1xuICAgIHJldHVybiBub0NvbmZsaWN0KFByb21pc2UpO1xufTtcblxuUHJvbWlzZS5zZXRTY2hlZHVsZXIgPSBmdW5jdGlvbihmbikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICBhc3luYy5fc2NoZWR1bGUgPSBmbjtcbn07XG5cbmlmICghQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCgpKSB7XG4gICAgUHJvbWlzZS5sb25nU3RhY2tUcmFjZXMgPSBmdW5jdGlvbigpe307XG4gICAgZGVidWdnaW5nID0gZmFsc2U7XG59XG5cblByb21pc2UuX21ha2VTZWxmUmVzb2x1dGlvbkVycm9yID0gbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3I7XG5yZXF1aXJlKFwiLi9maW5hbGx5LmpzXCIpKFByb21pc2UsIE5FWFRfRklMVEVSLCBjYXN0KTtcbnJlcXVpcmUoXCIuL2RpcmVjdF9yZXNvbHZlLmpzXCIpKFByb21pc2UpO1xucmVxdWlyZShcIi4vc3luY2hyb25vdXNfaW5zcGVjdGlvbi5qc1wiKShQcm9taXNlKTtcbnJlcXVpcmUoXCIuL2pvaW4uanNcIikoUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBjYXN0LCBJTlRFUk5BTCk7XG5Qcm9taXNlLlJhbmdlRXJyb3IgPSBSYW5nZUVycm9yO1xuUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciA9IENhbmNlbGxhdGlvbkVycm9yO1xuUHJvbWlzZS5UaW1lb3V0RXJyb3IgPSBUaW1lb3V0RXJyb3I7XG5Qcm9taXNlLlR5cGVFcnJvciA9IFR5cGVFcnJvcjtcblByb21pc2UuT3BlcmF0aW9uYWxFcnJvciA9IE9wZXJhdGlvbmFsRXJyb3I7XG5Qcm9taXNlLlJlamVjdGlvbkVycm9yID0gT3BlcmF0aW9uYWxFcnJvcjtcblByb21pc2UuQWdncmVnYXRlRXJyb3IgPSBlcnJvcnMuQWdncmVnYXRlRXJyb3I7XG5cbnV0aWwudG9GYXN0UHJvcGVydGllcyhQcm9taXNlKTtcbnV0aWwudG9GYXN0UHJvcGVydGllcyhQcm9taXNlLnByb3RvdHlwZSk7XG5Qcm9taXNlLlByb21pc2UgPSBQcm9taXNlO1xucmVxdWlyZSgnLi90aW1lcnMuanMnKShQcm9taXNlLElOVEVSTkFMLGNhc3QpO1xucmVxdWlyZSgnLi9yYWNlLmpzJykoUHJvbWlzZSxJTlRFUk5BTCxjYXN0KTtcbnJlcXVpcmUoJy4vY2FsbF9nZXQuanMnKShQcm9taXNlKTtcbnJlcXVpcmUoJy4vZ2VuZXJhdG9ycy5qcycpKFByb21pc2UsYXBpUmVqZWN0aW9uLElOVEVSTkFMLGNhc3QpO1xucmVxdWlyZSgnLi9tYXAuanMnKShQcm9taXNlLFByb21pc2VBcnJheSxhcGlSZWplY3Rpb24sY2FzdCxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL25vZGVpZnkuanMnKShQcm9taXNlKTtcbnJlcXVpcmUoJy4vcHJvbWlzaWZ5LmpzJykoUHJvbWlzZSxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL3Byb3BzLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXksY2FzdCk7XG5yZXF1aXJlKCcuL3JlZHVjZS5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5LGFwaVJlamVjdGlvbixjYXN0LElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vc2V0dGxlLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXkpO1xucmVxdWlyZSgnLi9zb21lLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXksYXBpUmVqZWN0aW9uKTtcbnJlcXVpcmUoJy4vcHJvZ3Jlc3MuanMnKShQcm9taXNlLFByb21pc2VBcnJheSk7XG5yZXF1aXJlKCcuL2NhbmNlbC5qcycpKFByb21pc2UsSU5URVJOQUwpO1xucmVxdWlyZSgnLi9maWx0ZXIuanMnKShQcm9taXNlLElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vYW55LmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXkpO1xucmVxdWlyZSgnLi9lYWNoLmpzJykoUHJvbWlzZSxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL3VzaW5nLmpzJykoUHJvbWlzZSxhcGlSZWplY3Rpb24sY2FzdCk7XG5cblByb21pc2UucHJvdG90eXBlID0gUHJvbWlzZS5wcm90b3R5cGU7XG5yZXR1cm4gUHJvbWlzZTtcblxufTtcblxufSkocmVxdWlyZShcIl9fYnJvd3NlcmlmeV9wcm9jZXNzXCIpKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICogQSBiYXNpYyBSZWYgc2VydmVzIGFzIGEgbWVhbnMgb2YgaW5kaXJlY3Rpb24gYmV0d2VlbiByZWZlcmVuY2VzIGFuZCB0aGVpclxuICAgKiB2YWx1ZXMsIGFsbG93aW5nIGFuIG91dHNpZGUgYWdlbnQgdG8gbW9kaWZ5IHRoZSB1bmRlcmx5aW5nIHZhbHVlLlxuICAgKi9cbiAgdmFyIFJlZiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFJlZi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbih2YWwpIHtcbiAgICAgIHRoaXMuX3ZhbCA9IHZhbDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSB2YWx1ZSBib3hlZCBieSB0aGlzIFJlZlxuICAgICAqXG4gICAgICogQHJldHVybnMge2R5bmFtaWN9XG4gICAgICovXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWw7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBhIG5ldyBib3hlZCB2YWx1ZS4gTm90ZSB0aGlzIG1ldGhvZCBpcyBzcGVjaWZpYyB0byB0aGlzIFJlZlxuICAgICAqIGltcGxlbWVudGF0aW9uLCBhbmQgbm90IHRoZSBSZWYgcHJvdG9jb2wsIHdoaWNoIG9ubHkgZGVmaW5lc1xuICAgICAqIGBSZWYjZ2V0KClgLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5ld1ZhbCB7ZHluYW1pY30gdGhlIHZhbHVlIHRvIGJveFxuICAgICAqL1xuICAgIHNldDogZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICBpZiAobmV3VmFsIGluc3RhbmNlb2YgUmVmKSB7XG4gICAgICAgIHRoaXMuX3ZhbCA9IG5ld1ZhbC5nZXQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3ZhbCA9IG5ld1ZhbDtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBSZWY7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgcmVmIHdob3NlIGJveGVkIHZhbHVlIGlzIGFub3RoZXIgcmVmXG4gICAqL1xuICB2YXIgRGVsZWdhdGluZ1JlZiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKERlbGVnYXRpbmdSZWYucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ocmVmKSB7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZVJlZiA9IHJlZjtcbiAgICB9LFxuICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGVsZWdhdGVSZWYuZ2V0KCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRGVsZWdhdGluZ1JlZjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbmZ1bmN0aW9uIFByb21pc2VJbnNwZWN0aW9uKHByb21pc2UpIHtcbiAgICBpZiAocHJvbWlzZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gcHJvbWlzZS5fYml0RmllbGQ7XG4gICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHByb21pc2UuaXNSZXNvbHZlZCgpXG4gICAgICAgICAgICA/IHByb21pc2UuX3NldHRsZWRWYWx1ZVxuICAgICAgICAgICAgOiB2b2lkIDA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IDA7XG4gICAgICAgIHRoaXMuX3NldHRsZWRWYWx1ZSA9IHZvaWQgMDtcbiAgICB9XG59XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc0Z1bGZpbGxlZCA9XG5Qcm9taXNlLnByb3RvdHlwZS5pc0Z1bGZpbGxlZCA9IGZ1bmN0aW9uIFByb21pc2UkaXNGdWxmaWxsZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDI2ODQzNTQ1NikgPiAwO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmlzUmVqZWN0ZWQgPVxuUHJvbWlzZS5wcm90b3R5cGUuaXNSZWplY3RlZCA9IGZ1bmN0aW9uIFByb21pc2UkaXNSZWplY3RlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMTM0MjE3NzI4KSA+IDA7XG59O1xuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuaXNQZW5kaW5nID1cblByb21pc2UucHJvdG90eXBlLmlzUGVuZGluZyA9IGZ1bmN0aW9uIFByb21pc2UkaXNQZW5kaW5nKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA0MDI2NTMxODQpID09PSAwO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLnZhbHVlID1cblByb21pc2UucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gUHJvbWlzZSR2YWx1ZSgpIHtcbiAgICBpZiAoIXRoaXMuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2Fubm90IGdldCBmdWxmaWxsbWVudCB2YWx1ZSBvZiBhIG5vbi1mdWxmaWxsZWQgcHJvbWlzZVwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3NldHRsZWRWYWx1ZTtcbn07XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5lcnJvciA9XG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUucmVhc29uID1cblByb21pc2UucHJvdG90eXBlLnJlYXNvbiA9IGZ1bmN0aW9uIFByb21pc2UkcmVhc29uKCkge1xuICAgIGlmICghdGhpcy5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbm5vdCBnZXQgcmVqZWN0aW9uIHJlYXNvbiBvZiBhIG5vbi1yZWplY3RlZCBwcm9taXNlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fc2V0dGxlZFZhbHVlO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmlzUmVzb2x2ZWQgPVxuUHJvbWlzZS5wcm90b3R5cGUuaXNSZXNvbHZlZCA9IGZ1bmN0aW9uIFByb21pc2UkaXNSZXNvbHZlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNDAyNjUzMTg0KSA+IDA7XG59O1xuXG5Qcm9taXNlLlByb21pc2VJbnNwZWN0aW9uID0gUHJvbWlzZUluc3BlY3Rpb247XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciBQcm9taXNlTWFwID0gUHJvbWlzZS5tYXA7XG5cblByb21pc2UucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIFByb21pc2UkZmlsdGVyKGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIFByb21pc2VNYXAodGhpcywgZm4sIG9wdGlvbnMsIElOVEVSTkFMKTtcbn07XG5cblByb21pc2UuZmlsdGVyID0gZnVuY3Rpb24gUHJvbWlzZSRGaWx0ZXIocHJvbWlzZXMsIGZuLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIFByb21pc2VNYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBJTlRFUk5BTCk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciBTb21lUHJvbWlzZUFycmF5ID0gUHJvbWlzZS5fU29tZVByb21pc2VBcnJheTtcbmZ1bmN0aW9uIFByb21pc2UkX0FueShwcm9taXNlcykge1xuICAgIHZhciByZXQgPSBuZXcgU29tZVByb21pc2VBcnJheShwcm9taXNlcyk7XG4gICAgdmFyIHByb21pc2UgPSByZXQucHJvbWlzZSgpO1xuICAgIGlmIChwcm9taXNlLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9XG4gICAgcmV0LnNldEhvd01hbnkoMSk7XG4gICAgcmV0LnNldFVud3JhcCgpO1xuICAgIHJldC5pbml0KCk7XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5cblByb21pc2UuYW55ID0gZnVuY3Rpb24gUHJvbWlzZSRBbnkocHJvbWlzZXMpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfQW55KHByb21pc2VzKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmFueSA9IGZ1bmN0aW9uIFByb21pc2UkYW55KCkge1xuICAgIHJldHVybiBQcm9taXNlJF9BbnkodGhpcyk7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwpIHtcbnZhciBQcm9taXNlUmVkdWNlID0gUHJvbWlzZS5yZWR1Y2U7XG5cblByb21pc2UucHJvdG90eXBlLmVhY2ggPSBmdW5jdGlvbiBQcm9taXNlJGVhY2goZm4pIHtcbiAgICByZXR1cm4gUHJvbWlzZVJlZHVjZSh0aGlzLCBmbiwgbnVsbCwgSU5URVJOQUwpO1xufTtcblxuUHJvbWlzZS5lYWNoID0gZnVuY3Rpb24gUHJvbWlzZSRFYWNoKHByb21pc2VzLCBmbikge1xuICAgIHJldHVybiBQcm9taXNlUmVkdWNlKHByb21pc2VzLCBmbiwgbnVsbCwgSU5URVJOQUwpO1xufTtcbn07XG4iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICB2YXIgU2V0VGltZW91dFNjaGVkdWxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgXy5leHRlbmQoU2V0VGltZW91dFNjaGVkdWxlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuXG4gICAgcnVuU29vbjogZnVuY3Rpb24oZm4pIHtcbiAgICAgIHRoaXMuc2NoZWR1bGUoZm4pO1xuICAgIH0sXG5cbiAgICBzY2hlZHVsZTogZnVuY3Rpb24oZm4sIGRlbGF5KSB7XG4gICAgICBkZWxheSA9IGRlbGF5IHx8IDE7XG4gICAgICByZXR1cm4gc2V0VGltZW91dChmbiwgZGVsYXkpO1xuICAgIH0sXG5cbiAgICB1bnNjaGVkdWxlOiBmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChpZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gU2V0VGltZW91dFNjaGVkdWxlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgZXM1ID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpO1xudmFyIGhhdmVHZXR0ZXJzID0gKGZ1bmN0aW9uKCl7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIG8gPSB7fTtcbiAgICAgICAgZXM1LmRlZmluZVByb3BlcnR5KG8sIFwiZlwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvLmYgPT09IDM7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbn0pKCk7XG52YXIgY2FuRXZhbHVhdGUgPSB0eXBlb2YgbmF2aWdhdG9yID09IFwidW5kZWZpbmVkXCI7XG52YXIgZXJyb3JPYmogPSB7ZToge319O1xuZnVuY3Rpb24gdHJ5Q2F0Y2gxKGZuLCByZWNlaXZlciwgYXJnKSB7XG4gICAgdHJ5IHsgcmV0dXJuIGZuLmNhbGwocmVjZWl2ZXIsIGFyZyk7IH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdHJ5Q2F0Y2gyKGZuLCByZWNlaXZlciwgYXJnLCBhcmcyKSB7XG4gICAgdHJ5IHsgcmV0dXJuIGZuLmNhbGwocmVjZWl2ZXIsIGFyZywgYXJnMik7IH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdHJ5Q2F0Y2gzKGZuLCByZWNlaXZlciwgYXJnLCBhcmcyLCBhcmczKSB7XG4gICAgdHJ5IHsgcmV0dXJuIGZuLmNhbGwocmVjZWl2ZXIsIGFyZywgYXJnMiwgYXJnMyk7IH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdHJ5Q2F0Y2g0KGZuLCByZWNlaXZlciwgYXJnLCBhcmcyLCBhcmczLCBhcmc0KSB7XG4gICAgdHJ5IHsgcmV0dXJuIGZuLmNhbGwocmVjZWl2ZXIsIGFyZywgYXJnMiwgYXJnMywgYXJnNCk7IH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdHJ5Q2F0Y2hBcHBseShmbiwgYXJncywgcmVjZWl2ZXIpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uYXBwbHkocmVjZWl2ZXIsIGFyZ3MpOyB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG59XG5cbnZhciBpbmhlcml0cyA9IGZ1bmN0aW9uKENoaWxkLCBQYXJlbnQpIHtcbiAgICB2YXIgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5O1xuXG4gICAgZnVuY3Rpb24gVCgpIHtcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IENoaWxkO1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yJCA9IFBhcmVudDtcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHlOYW1lIGluIFBhcmVudC5wcm90b3R5cGUpIHtcbiAgICAgICAgICAgIGlmIChoYXNQcm9wLmNhbGwoUGFyZW50LnByb3RvdHlwZSwgcHJvcGVydHlOYW1lKSAmJlxuICAgICAgICAgICAgICAgIHByb3BlcnR5TmFtZS5jaGFyQXQocHJvcGVydHlOYW1lLmxlbmd0aC0xKSAhPT0gXCIkXCJcbiAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eU5hbWUgKyBcIiRcIl0gPSBQYXJlbnQucHJvdG90eXBlW3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgVC5wcm90b3R5cGUgPSBQYXJlbnQucHJvdG90eXBlO1xuICAgIENoaWxkLnByb3RvdHlwZSA9IG5ldyBUKCk7XG4gICAgcmV0dXJuIENoaWxkLnByb3RvdHlwZTtcbn07XG5cbmZ1bmN0aW9uIGFzU3RyaW5nKHZhbCkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiID8gdmFsIDogKFwiXCIgKyB2YWwpO1xufVxuXG5mdW5jdGlvbiBpc1ByaW1pdGl2ZSh2YWwpIHtcbiAgICByZXR1cm4gdmFsID09IG51bGwgfHwgdmFsID09PSB0cnVlIHx8IHZhbCA9PT0gZmFsc2UgfHxcbiAgICAgICAgdHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgdmFsID09PSBcIm51bWJlclwiO1xuXG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gICAgcmV0dXJuICFpc1ByaW1pdGl2ZSh2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIG1heWJlV3JhcEFzRXJyb3IobWF5YmVFcnJvcikge1xuICAgIGlmICghaXNQcmltaXRpdmUobWF5YmVFcnJvcikpIHJldHVybiBtYXliZUVycm9yO1xuXG4gICAgcmV0dXJuIG5ldyBFcnJvcihhc1N0cmluZyhtYXliZUVycm9yKSk7XG59XG5cbmZ1bmN0aW9uIHdpdGhBcHBlbmRlZCh0YXJnZXQsIGFwcGVuZGVlKSB7XG4gICAgdmFyIGxlbiA9IHRhcmdldC5sZW5ndGg7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICB2YXIgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgcmV0W2ldID0gdGFyZ2V0W2ldO1xuICAgIH1cbiAgICByZXRbaV0gPSBhcHBlbmRlZTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBnZXREYXRhUHJvcGVydHlPckRlZmF1bHQob2JqLCBrZXksIGRlZmF1bHRWYWx1ZSkge1xuICAgIGlmIChlczUuaXNFUzUpIHtcbiAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KTtcbiAgICAgICAgaWYgKGRlc2MgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIGRlc2MuZ2V0ID09IG51bGwgJiYgZGVzYy5zZXQgPT0gbnVsbFxuICAgICAgICAgICAgICAgICAgICA/IGRlc2MudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge30uaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkgPyBvYmpba2V5XSA6IHZvaWQgMDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vdEVudW1lcmFibGVQcm9wKG9iaiwgbmFtZSwgdmFsdWUpIHtcbiAgICBpZiAoaXNQcmltaXRpdmUob2JqKSkgcmV0dXJuIG9iajtcbiAgICB2YXIgZGVzY3JpcHRvciA9IHtcbiAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH07XG4gICAgZXM1LmRlZmluZVByb3BlcnR5KG9iaiwgbmFtZSwgZGVzY3JpcHRvcik7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuXG52YXIgd3JhcHNQcmltaXRpdmVSZWNlaXZlciA9IChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcyAhPT0gXCJzdHJpbmdcIjtcbn0pLmNhbGwoXCJzdHJpbmdcIik7XG5cbmZ1bmN0aW9uIHRocm93ZXIocikge1xuICAgIHRocm93IHI7XG59XG5cbnZhciBpbmhlcml0ZWREYXRhS2V5cyA9IChmdW5jdGlvbigpIHtcbiAgICBpZiAoZXM1LmlzRVM1KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihvYmosIG9wdHMpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgICAgIHZhciB2aXNpdGVkS2V5cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgICAgICB2YXIgZ2V0S2V5cyA9IE9iamVjdChvcHRzKS5pbmNsdWRlSGlkZGVuXG4gICAgICAgICAgICAgICAgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lc1xuICAgICAgICAgICAgICAgIDogT2JqZWN0LmtleXM7XG4gICAgICAgICAgICB3aGlsZSAob2JqICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIga2V5cztcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBrZXlzID0gZ2V0S2V5cyhvYmopO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlzaXRlZEtleXNba2V5XSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIHZpc2l0ZWRLZXlzW2tleV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzYyAhPSBudWxsICYmIGRlc2MuZ2V0ID09IG51bGwgJiYgZGVzYy5zZXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2goa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvYmogPSBlczUuZ2V0UHJvdG90eXBlT2Yob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgLypqc2hpbnQgZm9yaW46ZmFsc2UgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICByZXQucHVzaChrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7XG5cbmZ1bmN0aW9uIGlzQ2xhc3MoZm4pIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHZhciBrZXlzID0gZXM1LmtleXMoZm4ucHJvdG90eXBlKTtcbiAgICAgICAgICAgIHJldHVybiBrZXlzLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgICAgICAhKGtleXMubGVuZ3RoID09PSAxICYmIGtleXNbMF0gPT09IFwiY29uc3RydWN0b3JcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdG9GYXN0UHJvcGVydGllcyhvYmopIHtcbiAgICAvKmpzaGludCAtVzAyNyovXG4gICAgZnVuY3Rpb24gZigpIHt9XG4gICAgZi5wcm90b3R5cGUgPSBvYmo7XG4gICAgcmV0dXJuIGY7XG4gICAgZXZhbChvYmopO1xufVxuXG52YXIgcmlkZW50ID0gL15bYS16JF9dW2EteiRfMC05XSokL2k7XG5mdW5jdGlvbiBpc0lkZW50aWZpZXIoc3RyKSB7XG4gICAgcmV0dXJuIHJpZGVudC50ZXN0KHN0cik7XG59XG5cbmZ1bmN0aW9uIGZpbGxlZFJhbmdlKGNvdW50LCBwcmVmaXgsIHN1ZmZpeCkge1xuICAgIHZhciByZXQgPSBuZXcgQXJyYXkoY291bnQpO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7XG4gICAgICAgIHJldFtpXSA9IHByZWZpeCArIGkgKyBzdWZmaXg7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbnZhciByZXQgPSB7XG4gICAgaXNDbGFzczogaXNDbGFzcyxcbiAgICBpc0lkZW50aWZpZXI6IGlzSWRlbnRpZmllcixcbiAgICBpbmhlcml0ZWREYXRhS2V5czogaW5oZXJpdGVkRGF0YUtleXMsXG4gICAgZ2V0RGF0YVByb3BlcnR5T3JEZWZhdWx0OiBnZXREYXRhUHJvcGVydHlPckRlZmF1bHQsXG4gICAgdGhyb3dlcjogdGhyb3dlcixcbiAgICBpc0FycmF5OiBlczUuaXNBcnJheSxcbiAgICBoYXZlR2V0dGVyczogaGF2ZUdldHRlcnMsXG4gICAgbm90RW51bWVyYWJsZVByb3A6IG5vdEVudW1lcmFibGVQcm9wLFxuICAgIGlzUHJpbWl0aXZlOiBpc1ByaW1pdGl2ZSxcbiAgICBpc09iamVjdDogaXNPYmplY3QsXG4gICAgY2FuRXZhbHVhdGU6IGNhbkV2YWx1YXRlLFxuICAgIGVycm9yT2JqOiBlcnJvck9iaixcbiAgICB0cnlDYXRjaDE6IHRyeUNhdGNoMSxcbiAgICB0cnlDYXRjaDI6IHRyeUNhdGNoMixcbiAgICB0cnlDYXRjaDM6IHRyeUNhdGNoMyxcbiAgICB0cnlDYXRjaDQ6IHRyeUNhdGNoNCxcbiAgICB0cnlDYXRjaEFwcGx5OiB0cnlDYXRjaEFwcGx5LFxuICAgIGluaGVyaXRzOiBpbmhlcml0cyxcbiAgICB3aXRoQXBwZW5kZWQ6IHdpdGhBcHBlbmRlZCxcbiAgICBhc1N0cmluZzogYXNTdHJpbmcsXG4gICAgbWF5YmVXcmFwQXNFcnJvcjogbWF5YmVXcmFwQXNFcnJvcixcbiAgICB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyOiB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyLFxuICAgIHRvRmFzdFByb3BlcnRpZXM6IHRvRmFzdFByb3BlcnRpZXMsXG4gICAgZmlsbGVkUmFuZ2U6IGZpbGxlZFJhbmdlXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJldDtcbiIsIihmdW5jdGlvbihwcm9jZXNzKXsvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHNjaGVkdWxlID0gcmVxdWlyZShcIi4vc2NoZWR1bGUuanNcIik7XG52YXIgUXVldWUgPSByZXF1aXJlKFwiLi9xdWV1ZS5qc1wiKTtcbnZhciBlcnJvck9iaiA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikuZXJyb3JPYmo7XG52YXIgdHJ5Q2F0Y2gxID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS50cnlDYXRjaDE7XG52YXIgX3Byb2Nlc3MgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiA/IHByb2Nlc3MgOiB2b2lkIDA7XG5cbmZ1bmN0aW9uIEFzeW5jKCkge1xuICAgIHRoaXMuX2lzVGlja1VzZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9zY2hlZHVsZSA9IHNjaGVkdWxlO1xuICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgdGhpcy5fbGF0ZUJ1ZmZlciA9IG5ldyBRdWV1ZSgxNik7XG4gICAgdGhpcy5fZnVuY3Rpb25CdWZmZXIgPSBuZXcgUXVldWUoNjU1MzYpO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmNvbnN1bWVGdW5jdGlvbkJ1ZmZlciA9IGZ1bmN0aW9uIEFzeW5jJGNvbnN1bWVGdW5jdGlvbkJ1ZmZlcigpIHtcbiAgICAgICAgc2VsZi5fY29uc3VtZUZ1bmN0aW9uQnVmZmVyKCk7XG4gICAgfTtcbn1cblxuQXN5bmMucHJvdG90eXBlLmhhdmVJdGVtc1F1ZXVlZCA9IGZ1bmN0aW9uIEFzeW5jJGhhdmVJdGVtc1F1ZXVlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGVuZ3RoID4gMDtcbn07XG5cbkFzeW5jLnByb3RvdHlwZS5pbnZva2VMYXRlciA9IGZ1bmN0aW9uIEFzeW5jJGludm9rZUxhdGVyKGZuLCByZWNlaXZlciwgYXJnKSB7XG4gICAgaWYgKF9wcm9jZXNzICE9PSB2b2lkIDAgJiZcbiAgICAgICAgX3Byb2Nlc3MuZG9tYWluICE9IG51bGwgJiZcbiAgICAgICAgIWZuLmRvbWFpbikge1xuICAgICAgICBmbiA9IF9wcm9jZXNzLmRvbWFpbi5iaW5kKGZuKTtcbiAgICB9XG4gICAgdGhpcy5fbGF0ZUJ1ZmZlci5wdXNoKGZuLCByZWNlaXZlciwgYXJnKTtcbiAgICB0aGlzLl9xdWV1ZVRpY2soKTtcbn07XG5cbkFzeW5jLnByb3RvdHlwZS5pbnZva2UgPSBmdW5jdGlvbiBBc3luYyRpbnZva2UoZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICBpZiAoX3Byb2Nlc3MgIT09IHZvaWQgMCAmJlxuICAgICAgICBfcHJvY2Vzcy5kb21haW4gIT0gbnVsbCAmJlxuICAgICAgICAhZm4uZG9tYWluKSB7XG4gICAgICAgIGZuID0gX3Byb2Nlc3MuZG9tYWluLmJpbmQoZm4pO1xuICAgIH1cbiAgICB2YXIgZnVuY3Rpb25CdWZmZXIgPSB0aGlzLl9mdW5jdGlvbkJ1ZmZlcjtcbiAgICBmdW5jdGlvbkJ1ZmZlci5wdXNoKGZuLCByZWNlaXZlciwgYXJnKTtcbiAgICB0aGlzLl9sZW5ndGggPSBmdW5jdGlvbkJ1ZmZlci5sZW5ndGgoKTtcbiAgICB0aGlzLl9xdWV1ZVRpY2soKTtcbn07XG5cbkFzeW5jLnByb3RvdHlwZS5fY29uc3VtZUZ1bmN0aW9uQnVmZmVyID1cbmZ1bmN0aW9uIEFzeW5jJF9jb25zdW1lRnVuY3Rpb25CdWZmZXIoKSB7XG4gICAgdmFyIGZ1bmN0aW9uQnVmZmVyID0gdGhpcy5fZnVuY3Rpb25CdWZmZXI7XG4gICAgd2hpbGUgKGZ1bmN0aW9uQnVmZmVyLmxlbmd0aCgpID4gMCkge1xuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbkJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICB2YXIgcmVjZWl2ZXIgPSBmdW5jdGlvbkJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICB2YXIgYXJnID0gZnVuY3Rpb25CdWZmZXIuc2hpZnQoKTtcbiAgICAgICAgZm4uY2FsbChyZWNlaXZlciwgYXJnKTtcbiAgICB9XG4gICAgdGhpcy5fcmVzZXQoKTtcbiAgICB0aGlzLl9jb25zdW1lTGF0ZUJ1ZmZlcigpO1xufTtcblxuQXN5bmMucHJvdG90eXBlLl9jb25zdW1lTGF0ZUJ1ZmZlciA9IGZ1bmN0aW9uIEFzeW5jJF9jb25zdW1lTGF0ZUJ1ZmZlcigpIHtcbiAgICB2YXIgYnVmZmVyID0gdGhpcy5fbGF0ZUJ1ZmZlcjtcbiAgICB3aGlsZShidWZmZXIubGVuZ3RoKCkgPiAwKSB7XG4gICAgICAgIHZhciBmbiA9IGJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICB2YXIgcmVjZWl2ZXIgPSBidWZmZXIuc2hpZnQoKTtcbiAgICAgICAgdmFyIGFyZyA9IGJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2gxKGZuLCByZWNlaXZlciwgYXJnKTtcbiAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgIHRoaXMuX3F1ZXVlVGljaygpO1xuICAgICAgICAgICAgaWYgKGZuLmRvbWFpbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZm4uZG9tYWluLmVtaXQoXCJlcnJvclwiLCByZXMuZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IHJlcy5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxuQXN5bmMucHJvdG90eXBlLl9xdWV1ZVRpY2sgPSBmdW5jdGlvbiBBc3luYyRfcXVldWUoKSB7XG4gICAgaWYgKCF0aGlzLl9pc1RpY2tVc2VkKSB7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlKHRoaXMuY29uc3VtZUZ1bmN0aW9uQnVmZmVyKTtcbiAgICAgICAgdGhpcy5faXNUaWNrVXNlZCA9IHRydWU7XG4gICAgfVxufTtcblxuQXN5bmMucHJvdG90eXBlLl9yZXNldCA9IGZ1bmN0aW9uIEFzeW5jJF9yZXNldCgpIHtcbiAgICB0aGlzLl9pc1RpY2tVc2VkID0gZmFsc2U7XG4gICAgdGhpcy5fbGVuZ3RoID0gMDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEFzeW5jKCk7XG5cbn0pKHJlcXVpcmUoXCJfX2Jyb3dzZXJpZnlfcHJvY2Vzc1wiKSkiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIE9iamVjdGZyZWV6ZSA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKS5mcmVlemU7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgaW5oZXJpdHMgPSB1dGlsLmluaGVyaXRzO1xudmFyIG5vdEVudW1lcmFibGVQcm9wID0gdXRpbC5ub3RFbnVtZXJhYmxlUHJvcDtcblxuZnVuY3Rpb24gbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKGUpIHtcbiAgICB0cnkge1xuICAgICAgICBub3RFbnVtZXJhYmxlUHJvcChlLCBcImlzT3BlcmF0aW9uYWxcIiwgdHJ1ZSk7XG4gICAgfVxuICAgIGNhdGNoKGlnbm9yZSkge31cbn1cblxuZnVuY3Rpb24gb3JpZ2luYXRlc0Zyb21SZWplY3Rpb24oZSkge1xuICAgIGlmIChlID09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gKChlIGluc3RhbmNlb2YgT3BlcmF0aW9uYWxFcnJvcikgfHxcbiAgICAgICAgZVtcImlzT3BlcmF0aW9uYWxcIl0gPT09IHRydWUpO1xufVxuXG5mdW5jdGlvbiBpc0Vycm9yKG9iaikge1xuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBFcnJvcjtcbn1cblxuZnVuY3Rpb24gY2FuQXR0YWNoKG9iaikge1xuICAgIHJldHVybiBpc0Vycm9yKG9iaik7XG59XG5cbmZ1bmN0aW9uIHN1YkVycm9yKG5hbWVQcm9wZXJ0eSwgZGVmYXVsdE1lc3NhZ2UpIHtcbiAgICBmdW5jdGlvbiBTdWJFcnJvcihtZXNzYWdlKSB7XG4gICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBTdWJFcnJvcikpIHJldHVybiBuZXcgU3ViRXJyb3IobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IHR5cGVvZiBtZXNzYWdlID09PSBcInN0cmluZ1wiID8gbWVzc2FnZSA6IGRlZmF1bHRNZXNzYWdlO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lUHJvcGVydHk7XG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW5oZXJpdHMoU3ViRXJyb3IsIEVycm9yKTtcbiAgICByZXR1cm4gU3ViRXJyb3I7XG59XG5cbnZhciBfVHlwZUVycm9yLCBfUmFuZ2VFcnJvcjtcbnZhciBDYW5jZWxsYXRpb25FcnJvciA9IHN1YkVycm9yKFwiQ2FuY2VsbGF0aW9uRXJyb3JcIiwgXCJjYW5jZWxsYXRpb24gZXJyb3JcIik7XG52YXIgVGltZW91dEVycm9yID0gc3ViRXJyb3IoXCJUaW1lb3V0RXJyb3JcIiwgXCJ0aW1lb3V0IGVycm9yXCIpO1xudmFyIEFnZ3JlZ2F0ZUVycm9yID0gc3ViRXJyb3IoXCJBZ2dyZWdhdGVFcnJvclwiLCBcImFnZ3JlZ2F0ZSBlcnJvclwiKTtcbnRyeSB7XG4gICAgX1R5cGVFcnJvciA9IFR5cGVFcnJvcjtcbiAgICBfUmFuZ2VFcnJvciA9IFJhbmdlRXJyb3I7XG59IGNhdGNoKGUpIHtcbiAgICBfVHlwZUVycm9yID0gc3ViRXJyb3IoXCJUeXBlRXJyb3JcIiwgXCJ0eXBlIGVycm9yXCIpO1xuICAgIF9SYW5nZUVycm9yID0gc3ViRXJyb3IoXCJSYW5nZUVycm9yXCIsIFwicmFuZ2UgZXJyb3JcIik7XG59XG5cbnZhciBtZXRob2RzID0gKFwiam9pbiBwb3AgcHVzaCBzaGlmdCB1bnNoaWZ0IHNsaWNlIGZpbHRlciBmb3JFYWNoIHNvbWUgXCIgK1xuICAgIFwiZXZlcnkgbWFwIGluZGV4T2YgbGFzdEluZGV4T2YgcmVkdWNlIHJlZHVjZVJpZ2h0IHNvcnQgcmV2ZXJzZVwiKS5zcGxpdChcIiBcIik7XG5cbmZvciAodmFyIGkgPSAwOyBpIDwgbWV0aG9kcy5sZW5ndGg7ICsraSkge1xuICAgIGlmICh0eXBlb2YgQXJyYXkucHJvdG90eXBlW21ldGhvZHNbaV1dID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgQWdncmVnYXRlRXJyb3IucHJvdG90eXBlW21ldGhvZHNbaV1dID0gQXJyYXkucHJvdG90eXBlW21ldGhvZHNbaV1dO1xuICAgIH1cbn1cblxuQWdncmVnYXRlRXJyb3IucHJvdG90eXBlLmxlbmd0aCA9IDA7XG5BZ2dyZWdhdGVFcnJvci5wcm90b3R5cGVbXCJpc09wZXJhdGlvbmFsXCJdID0gdHJ1ZTtcbnZhciBsZXZlbCA9IDA7XG5BZ2dyZWdhdGVFcnJvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaW5kZW50ID0gQXJyYXkobGV2ZWwgKiA0ICsgMSkuam9pbihcIiBcIik7XG4gICAgdmFyIHJldCA9IFwiXFxuXCIgKyBpbmRlbnQgKyBcIkFnZ3JlZ2F0ZUVycm9yIG9mOlwiICsgXCJcXG5cIjtcbiAgICBsZXZlbCsrO1xuICAgIGluZGVudCA9IEFycmF5KGxldmVsICogNCArIDEpLmpvaW4oXCIgXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIgc3RyID0gdGhpc1tpXSA9PT0gdGhpcyA/IFwiW0NpcmN1bGFyIEFnZ3JlZ2F0ZUVycm9yXVwiIDogdGhpc1tpXSArIFwiXCI7XG4gICAgICAgIHZhciBsaW5lcyA9IHN0ci5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBsaW5lcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgICAgbGluZXNbal0gPSBpbmRlbnQgKyBsaW5lc1tqXTtcbiAgICAgICAgfVxuICAgICAgICBzdHIgPSBsaW5lcy5qb2luKFwiXFxuXCIpO1xuICAgICAgICByZXQgKz0gc3RyICsgXCJcXG5cIjtcbiAgICB9XG4gICAgbGV2ZWwtLTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuZnVuY3Rpb24gT3BlcmF0aW9uYWxFcnJvcihtZXNzYWdlKSB7XG4gICAgdGhpcy5uYW1lID0gXCJPcGVyYXRpb25hbEVycm9yXCI7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB0aGlzLmNhdXNlID0gbWVzc2FnZTtcbiAgICB0aGlzW1wiaXNPcGVyYXRpb25hbFwiXSA9IHRydWU7XG5cbiAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZTtcbiAgICAgICAgdGhpcy5zdGFjayA9IG1lc3NhZ2Uuc3RhY2s7XG4gICAgfSBlbHNlIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICB9XG5cbn1cbmluaGVyaXRzKE9wZXJhdGlvbmFsRXJyb3IsIEVycm9yKTtcblxudmFyIGtleSA9IFwiX19CbHVlYmlyZEVycm9yVHlwZXNfX1wiO1xudmFyIGVycm9yVHlwZXMgPSBFcnJvcltrZXldO1xuaWYgKCFlcnJvclR5cGVzKSB7XG4gICAgZXJyb3JUeXBlcyA9IE9iamVjdGZyZWV6ZSh7XG4gICAgICAgIENhbmNlbGxhdGlvbkVycm9yOiBDYW5jZWxsYXRpb25FcnJvcixcbiAgICAgICAgVGltZW91dEVycm9yOiBUaW1lb3V0RXJyb3IsXG4gICAgICAgIE9wZXJhdGlvbmFsRXJyb3I6IE9wZXJhdGlvbmFsRXJyb3IsXG4gICAgICAgIFJlamVjdGlvbkVycm9yOiBPcGVyYXRpb25hbEVycm9yLFxuICAgICAgICBBZ2dyZWdhdGVFcnJvcjogQWdncmVnYXRlRXJyb3JcbiAgICB9KTtcbiAgICBub3RFbnVtZXJhYmxlUHJvcChFcnJvciwga2V5LCBlcnJvclR5cGVzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgRXJyb3I6IEVycm9yLFxuICAgIFR5cGVFcnJvcjogX1R5cGVFcnJvcixcbiAgICBSYW5nZUVycm9yOiBfUmFuZ2VFcnJvcixcbiAgICBDYW5jZWxsYXRpb25FcnJvcjogZXJyb3JUeXBlcy5DYW5jZWxsYXRpb25FcnJvcixcbiAgICBPcGVyYXRpb25hbEVycm9yOiBlcnJvclR5cGVzLk9wZXJhdGlvbmFsRXJyb3IsXG4gICAgVGltZW91dEVycm9yOiBlcnJvclR5cGVzLlRpbWVvdXRFcnJvcixcbiAgICBBZ2dyZWdhdGVFcnJvcjogZXJyb3JUeXBlcy5BZ2dyZWdhdGVFcnJvcixcbiAgICBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbjogb3JpZ2luYXRlc0Zyb21SZWplY3Rpb24sXG4gICAgbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uOiBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24sXG4gICAgY2FuQXR0YWNoOiBjYW5BdHRhY2hcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGNhbkF0dGFjaCA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5jYW5BdHRhY2g7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xudmFyIGlzT2JqZWN0ID0gdXRpbC5pc09iamVjdDtcblxuZnVuY3Rpb24gZ2V0VGhlbihvYmopIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gb2JqLnRoZW47XG4gICAgfVxuICAgIGNhdGNoKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFByb21pc2UkX0Nhc3Qob2JqLCBvcmlnaW5hbFByb21pc2UpIHtcbiAgICBpZiAoaXNPYmplY3Qob2JqKSkge1xuICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0FueUJsdWViaXJkUHJvbWlzZShvYmopKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICAgICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICAgICAgb2JqLl90aGVuKFxuICAgICAgICAgICAgICAgIHJldC5fZnVsZmlsbFVuY2hlY2tlZCxcbiAgICAgICAgICAgICAgICByZXQuX3JlamVjdFVuY2hlY2tlZENoZWNrRXJyb3IsXG4gICAgICAgICAgICAgICAgcmV0Ll9wcm9ncmVzc1VuY2hlY2tlZCxcbiAgICAgICAgICAgICAgICByZXQsXG4gICAgICAgICAgICAgICAgbnVsbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldC5fc2V0Rm9sbG93aW5nKCk7XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aGVuID0gZ2V0VGhlbihvYmopO1xuICAgICAgICBpZiAodGhlbiA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgIGlmIChvcmlnaW5hbFByb21pc2UgIT09IHZvaWQgMCAmJiBjYW5BdHRhY2godGhlbi5lKSkge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsUHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0aGVuLmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHRoZW4uZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoZW4gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UkX2RvVGhlbmFibGUob2JqLCB0aGVuLCBvcmlnaW5hbFByb21pc2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG59XG5cbnZhciBoYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHk7XG5mdW5jdGlvbiBpc0FueUJsdWViaXJkUHJvbWlzZShvYmopIHtcbiAgICByZXR1cm4gaGFzUHJvcC5jYWxsKG9iaiwgXCJfcHJvbWlzZTBcIik7XG59XG5cbmZ1bmN0aW9uIFByb21pc2UkX2RvVGhlbmFibGUoeCwgdGhlbiwgb3JpZ2luYWxQcm9taXNlKSB7XG4gICAgdmFyIHJlc29sdmVyID0gUHJvbWlzZS5kZWZlcigpO1xuICAgIHZhciBjYWxsZWQgPSBmYWxzZTtcbiAgICB0cnkge1xuICAgICAgICB0aGVuLmNhbGwoXG4gICAgICAgICAgICB4LFxuICAgICAgICAgICAgUHJvbWlzZSRfcmVzb2x2ZUZyb21UaGVuYWJsZSxcbiAgICAgICAgICAgIFByb21pc2UkX3JlamVjdEZyb21UaGVuYWJsZSxcbiAgICAgICAgICAgIFByb21pc2UkX3Byb2dyZXNzRnJvbVRoZW5hYmxlXG4gICAgICAgICk7XG4gICAgfSBjYXRjaChlKSB7XG4gICAgICAgIGlmICghY2FsbGVkKSB7XG4gICAgICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKGUpID8gZSA6IG5ldyBFcnJvcihlICsgXCJcIik7XG4gICAgICAgICAgICBpZiAob3JpZ2luYWxQcm9taXNlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZXIucHJvbWlzZS5fcmVqZWN0KGUsIHRyYWNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZXIucHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIFByb21pc2UkX3Jlc29sdmVGcm9tVGhlbmFibGUoeSkge1xuICAgICAgICBpZiAoY2FsbGVkKSByZXR1cm47XG4gICAgICAgIGNhbGxlZCA9IHRydWU7XG5cbiAgICAgICAgaWYgKHggPT09IHkpIHtcbiAgICAgICAgICAgIHZhciBlID0gUHJvbWlzZS5fbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IoKTtcbiAgICAgICAgICAgIGlmIChvcmlnaW5hbFByb21pc2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsUHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZShlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc29sdmVyLnByb21pc2UuX3JlamVjdChlLCB2b2lkIDApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJlc29sdmVyLnJlc29sdmUoeSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0RnJvbVRoZW5hYmxlKHIpIHtcbiAgICAgICAgaWYgKGNhbGxlZCkgcmV0dXJuO1xuICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2gocikgPyByIDogbmV3IEVycm9yKHIgKyBcIlwiKTtcbiAgICAgICAgaWYgKG9yaWdpbmFsUHJvbWlzZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBvcmlnaW5hbFByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJlc29sdmVyLnByb21pc2UuX3JlamVjdChyLCB0cmFjZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcHJvZ3Jlc3NGcm9tVGhlbmFibGUodikge1xuICAgICAgICBpZiAoY2FsbGVkKSByZXR1cm47XG4gICAgICAgIHZhciBwcm9taXNlID0gcmVzb2x2ZXIucHJvbWlzZTtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9taXNlLl9wcm9ncmVzcyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBwcm9taXNlLl9wcm9ncmVzcyh2KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxucmV0dXJuIFByb21pc2UkX0Nhc3Q7XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwsIGNhc3QpIHtcbnZhciBjYW5BdHRhY2ggPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIikuY2FuQXR0YWNoO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXk7XG5cbmZ1bmN0aW9uIHRvUmVzb2x1dGlvblZhbHVlKHZhbCkge1xuICAgIHN3aXRjaCh2YWwpIHtcbiAgICBjYXNlIC0xOiByZXR1cm4gdm9pZCAwO1xuICAgIGNhc2UgLTI6IHJldHVybiBbXTtcbiAgICBjYXNlIC0zOiByZXR1cm4ge307XG4gICAgfVxufVxuXG5mdW5jdGlvbiBQcm9taXNlQXJyYXkodmFsdWVzKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLl9wcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHZhciBwYXJlbnQgPSB2b2lkIDA7XG4gICAgaWYgKHZhbHVlcyBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcGFyZW50ID0gdmFsdWVzO1xuICAgICAgICBwcm9taXNlLl9wcm9wYWdhdGVGcm9tKHBhcmVudCwgMSB8IDQpO1xuICAgIH1cbiAgICBwcm9taXNlLl9zZXRUcmFjZShwYXJlbnQpO1xuICAgIHRoaXMuX3ZhbHVlcyA9IHZhbHVlcztcbiAgICB0aGlzLl9sZW5ndGggPSAwO1xuICAgIHRoaXMuX3RvdGFsUmVzb2x2ZWQgPSAwO1xuICAgIHRoaXMuX2luaXQodm9pZCAwLCAtMik7XG59XG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uIFByb21pc2VBcnJheSRsZW5ndGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xlbmd0aDtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2VBcnJheSRwcm9taXNlKCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9taXNlO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX2luaXQoXywgcmVzb2x2ZVZhbHVlSWZFbXB0eSkge1xuICAgIHZhciB2YWx1ZXMgPSBjYXN0KHRoaXMuX3ZhbHVlcywgdm9pZCAwKTtcbiAgICBpZiAodmFsdWVzIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICB0aGlzLl92YWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIHZhbHVlcy5fc2V0Qm91bmRUbyh0aGlzLl9wcm9taXNlLl9ib3VuZFRvKTtcbiAgICAgICAgaWYgKHZhbHVlcy5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICB2YWx1ZXMgPSB2YWx1ZXMuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgICAgIGlmICghaXNBcnJheSh2YWx1ZXMpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVyciA9IG5ldyBQcm9taXNlLlR5cGVFcnJvcihcImV4cGVjdGluZyBhbiBhcnJheSwgYSBwcm9taXNlIG9yIGEgdGhlbmFibGVcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5fX2hhcmRSZWplY3RfXyhlcnIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZXMuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgIHZhbHVlcy5fdGhlbihcbiAgICAgICAgICAgICAgICBQcm9taXNlQXJyYXkkX2luaXQsXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVqZWN0LFxuICAgICAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgIHJlc29sdmVWYWx1ZUlmRW1wdHlcbiAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlcy5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgdGhpcy5fcmVqZWN0KHZhbHVlcy5fc2V0dGxlZFZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIWlzQXJyYXkodmFsdWVzKSkge1xuICAgICAgICB2YXIgZXJyID0gbmV3IFByb21pc2UuVHlwZUVycm9yKFwiZXhwZWN0aW5nIGFuIGFycmF5LCBhIHByb21pc2Ugb3IgYSB0aGVuYWJsZVwiKTtcbiAgICAgICAgdGhpcy5fX2hhcmRSZWplY3RfXyhlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgaWYgKHJlc29sdmVWYWx1ZUlmRW1wdHkgPT09IC01KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlRW1wdHlBcnJheSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0b1Jlc29sdXRpb25WYWx1ZShyZXNvbHZlVmFsdWVJZkVtcHR5KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbGVuID0gdGhpcy5nZXRBY3R1YWxMZW5ndGgodmFsdWVzLmxlbmd0aCk7XG4gICAgdmFyIG5ld0xlbiA9IGxlbjtcbiAgICB2YXIgbmV3VmFsdWVzID0gdGhpcy5zaG91bGRDb3B5VmFsdWVzKCkgPyBuZXcgQXJyYXkobGVuKSA6IHRoaXMuX3ZhbHVlcztcbiAgICB2YXIgaXNEaXJlY3RTY2FuTmVlZGVkID0gZmFsc2U7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdCh2YWx1ZXNbaV0sIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICAgICAgaXNEaXJlY3RTY2FuTmVlZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzRGlyZWN0U2Nhbk5lZWRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgbmV3VmFsdWVzW2ldID0gbWF5YmVQcm9taXNlO1xuICAgIH1cbiAgICB0aGlzLl92YWx1ZXMgPSBuZXdWYWx1ZXM7XG4gICAgdGhpcy5fbGVuZ3RoID0gbmV3TGVuO1xuICAgIGlmIChpc0RpcmVjdFNjYW5OZWVkZWQpIHtcbiAgICAgICAgdGhpcy5fc2NhbkRpcmVjdFZhbHVlcyhsZW4pO1xuICAgIH1cbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3NldHRsZVByb21pc2VBdCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3NldHRsZVByb21pc2VBdChpbmRleCkge1xuICAgIHZhciB2YWx1ZSA9IHRoaXMuX3ZhbHVlc1tpbmRleF07XG4gICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICB0aGlzLl9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBpbmRleCk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2VGdWxmaWxsZWQodmFsdWUuX3NldHRsZWRWYWx1ZSwgaW5kZXgpO1xuICAgIH0gZWxzZSBpZiAodmFsdWUuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2VSZWplY3RlZCh2YWx1ZS5fc2V0dGxlZFZhbHVlLCBpbmRleCk7XG4gICAgfVxufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fc2NhbkRpcmVjdFZhbHVlcyA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3NjYW5EaXJlY3RWYWx1ZXMobGVuKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXR0bGVQcm9taXNlQXQoaSk7XG4gICAgfVxufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faXNSZXNvbHZlZCA9IGZ1bmN0aW9uIFByb21pc2VBcnJheSRfaXNSZXNvbHZlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWVzID09PSBudWxsO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVzb2x2ZSA9IGZ1bmN0aW9uIFByb21pc2VBcnJheSRfcmVzb2x2ZSh2YWx1ZSkge1xuICAgIHRoaXMuX3ZhbHVlcyA9IG51bGw7XG4gICAgdGhpcy5fcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9faGFyZFJlamVjdF9fID1cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3JlamVjdCA9IGZ1bmN0aW9uIFByb21pc2VBcnJheSRfcmVqZWN0KHJlYXNvbikge1xuICAgIHRoaXMuX3ZhbHVlcyA9IG51bGw7XG4gICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKHJlYXNvbikgPyByZWFzb24gOiBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgdGhpcy5fcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgdGhpcy5fcHJvbWlzZS5fcmVqZWN0KHJlYXNvbiwgdHJhY2UpO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVByb2dyZXNzZWQgPVxuZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9wcm9taXNlUHJvZ3Jlc3NlZChwcm9ncmVzc1ZhbHVlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9wcm9taXNlLl9wcm9ncmVzcyh7XG4gICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgdmFsdWU6IHByb2dyZXNzVmFsdWVcbiAgICB9KTtcbn07XG5cblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3ZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICBpZiAodG90YWxSZXNvbHZlZCA+PSB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXMpO1xuICAgIH1cbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VSZWplY3RlZCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3Byb21pc2VSZWplY3RlZChyZWFzb24sIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3RvdGFsUmVzb2x2ZWQrKztcbiAgICB0aGlzLl9yZWplY3QocmVhc29uKTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuc2hvdWxkQ29weVZhbHVlcyA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3Nob3VsZENvcHlWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLmdldEFjdHVhbExlbmd0aCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkZ2V0QWN0dWFsTGVuZ3RoKGxlbikge1xuICAgIHJldHVybiBsZW47XG59O1xuXG5yZXR1cm4gUHJvbWlzZUFycmF5O1xufTtcbiIsIihmdW5jdGlvbigpey8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xudmFyIGluaGVyaXRzID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5pbmhlcml0cztcbnZhciBkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKS5kZWZpbmVQcm9wZXJ0eTtcblxudmFyIHJpZ25vcmUgPSBuZXcgUmVnRXhwKFxuICAgIFwiXFxcXGIoPzpbYS16QS1aMC05Ll0rXFxcXCRfXFxcXHcrfFwiICtcbiAgICBcInRyeUNhdGNoKD86MXwyfDN8NHxBcHBseSl8bmV3IFxcXFx3KlByb21pc2VBcnJheXxcIiArXG4gICAgXCJcXFxcdypQcm9taXNlQXJyYXlcXFxcLlxcXFx3KlByb21pc2VBcnJheXxcIiArXG4gICAgXCJzZXRUaW1lb3V0fENhdGNoRmlsdGVyXFxcXCRfXFxcXHcrfG1ha2VOb2RlUHJvbWlzaWZpZWR8cHJvY2Vzc0ltbWVkaWF0ZXxcIiArXG4gICAgXCJwcm9jZXNzLl90aWNrQ2FsbGJhY2t8bmV4dFRpY2t8QXN5bmNcXFxcJFxcXFx3KylcXFxcYlwiXG4pO1xuXG52YXIgcnRyYWNlbGluZSA9IG51bGw7XG52YXIgZm9ybWF0U3RhY2sgPSBudWxsO1xuXG5mdW5jdGlvbiBmb3JtYXROb25FcnJvcihvYmopIHtcbiAgICB2YXIgc3RyO1xuICAgIGlmICh0eXBlb2Ygb2JqID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgc3RyID0gXCJbZnVuY3Rpb24gXCIgK1xuICAgICAgICAgICAgKG9iai5uYW1lIHx8IFwiYW5vbnltb3VzXCIpICtcbiAgICAgICAgICAgIFwiXVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHN0ciA9IG9iai50b1N0cmluZygpO1xuICAgICAgICB2YXIgcnVzZWxlc3NUb1N0cmluZyA9IC9cXFtvYmplY3QgW2EtekEtWjAtOSRfXStcXF0vO1xuICAgICAgICBpZiAocnVzZWxlc3NUb1N0cmluZy50ZXN0KHN0cikpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1N0ciA9IEpTT04uc3RyaW5naWZ5KG9iaik7XG4gICAgICAgICAgICAgICAgc3RyID0gbmV3U3RyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2goZSkge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0ci5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHN0ciA9IFwiKGVtcHR5IGFycmF5KVwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoXCIoPFwiICsgc25pcChzdHIpICsgXCI+LCBubyBzdGFjayB0cmFjZSlcIik7XG59XG5cbmZ1bmN0aW9uIHNuaXAoc3RyKSB7XG4gICAgdmFyIG1heENoYXJzID0gNDE7XG4gICAgaWYgKHN0ci5sZW5ndGggPCBtYXhDaGFycykge1xuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgICByZXR1cm4gc3RyLnN1YnN0cigwLCBtYXhDaGFycyAtIDMpICsgXCIuLi5cIjtcbn1cblxuZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZShpZ25vcmVVbnRpbCwgaXNUb3BMZXZlbCkge1xuICAgIHRoaXMuY2FwdHVyZVN0YWNrVHJhY2UoQ2FwdHVyZWRUcmFjZSwgaXNUb3BMZXZlbCk7XG5cbn1cbmluaGVyaXRzKENhcHR1cmVkVHJhY2UsIEVycm9yKTtcblxuQ2FwdHVyZWRUcmFjZS5wcm90b3R5cGUuY2FwdHVyZVN0YWNrVHJhY2UgPVxuZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZSRjYXB0dXJlU3RhY2tUcmFjZShpZ25vcmVVbnRpbCwgaXNUb3BMZXZlbCkge1xuICAgIGNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIGlnbm9yZVVudGlsLCBpc1RvcExldmVsKTtcbn07XG5cbkNhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPVxuZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZSRQb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbihyZWFzb24pIHtcbiAgICBpZiAodHlwZW9mIGNvbnNvbGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgdmFyIG1lc3NhZ2U7XG4gICAgICAgIGlmICh0eXBlb2YgcmVhc29uID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiByZWFzb24gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIHN0YWNrID0gcmVhc29uLnN0YWNrO1xuICAgICAgICAgICAgbWVzc2FnZSA9IFwiUG9zc2libHkgdW5oYW5kbGVkIFwiICsgZm9ybWF0U3RhY2soc3RhY2ssIHJlYXNvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtZXNzYWdlID0gXCJQb3NzaWJseSB1bmhhbmRsZWQgXCIgKyBTdHJpbmcocmVhc29uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUuZXJyb3IgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICAgICAgICAgdHlwZW9mIGNvbnNvbGUuZXJyb3IgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbnNvbGUubG9nID09PSBcImZ1bmN0aW9uXCIgfHxcbiAgICAgICAgICAgIHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5DYXB0dXJlZFRyYWNlLmNvbWJpbmUgPSBmdW5jdGlvbiBDYXB0dXJlZFRyYWNlJENvbWJpbmUoY3VycmVudCwgcHJldikge1xuICAgIHZhciBjdXJMYXN0ID0gY3VycmVudC5sZW5ndGggLSAxO1xuICAgIGZvciAodmFyIGkgPSBwcmV2Lmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBsaW5lID0gcHJldltpXTtcbiAgICAgICAgaWYgKGN1cnJlbnRbY3VyTGFzdF0gPT09IGxpbmUpIHtcbiAgICAgICAgICAgIGN1cnJlbnQucG9wKCk7XG4gICAgICAgICAgICBjdXJMYXN0LS07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGN1cnJlbnQucHVzaChcIkZyb20gcHJldmlvdXMgZXZlbnQ6XCIpO1xuICAgIHZhciBsaW5lcyA9IGN1cnJlbnQuY29uY2F0KHByZXYpO1xuXG4gICAgdmFyIHJldCA9IFtdO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpbmVzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG5cbiAgICAgICAgaWYgKChyaWdub3JlLnRlc3QobGluZXNbaV0pIHx8XG4gICAgICAgICAgICAoaSA+IDAgJiYgIXJ0cmFjZWxpbmUudGVzdChsaW5lc1tpXSkpICYmXG4gICAgICAgICAgICBsaW5lc1tpXSAhPT0gXCJGcm9tIHByZXZpb3VzIGV2ZW50OlwiKVxuICAgICAgICkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0LnB1c2gobGluZXNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufTtcblxuQ2FwdHVyZWRUcmFjZS5wcm90ZWN0RXJyb3JNZXNzYWdlTmV3bGluZXMgPSBmdW5jdGlvbihzdGFjaykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RhY2subGVuZ3RoOyArK2kpIHtcbiAgICAgICAgaWYgKHJ0cmFjZWxpbmUudGVzdChzdGFja1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGkgPD0gMSkgcmV0dXJuO1xuXG4gICAgdmFyIGVycm9yTWVzc2FnZUxpbmVzID0gW107XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBpOyArK2opIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlTGluZXMucHVzaChzdGFjay5zaGlmdCgpKTtcbiAgICB9XG4gICAgc3RhY2sudW5zaGlmdChlcnJvck1lc3NhZ2VMaW5lcy5qb2luKFwiXFx1MDAwMlxcdTAwMDBcXHUwMDAxXCIpKTtcbn07XG5cbkNhcHR1cmVkVHJhY2UuaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiBDYXB0dXJlZFRyYWNlJElzU3VwcG9ydGVkKCkge1xuICAgIHJldHVybiB0eXBlb2YgY2FwdHVyZVN0YWNrVHJhY2UgPT09IFwiZnVuY3Rpb25cIjtcbn07XG5cbnZhciBjYXB0dXJlU3RhY2tUcmFjZSA9IChmdW5jdGlvbiBzdGFja0RldGVjdGlvbigpIHtcbiAgICBpZiAodHlwZW9mIEVycm9yLnN0YWNrVHJhY2VMaW1pdCA9PT0gXCJudW1iZXJcIiAmJlxuICAgICAgICB0eXBlb2YgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBydHJhY2VsaW5lID0gL15cXHMqYXRcXHMqLztcbiAgICAgICAgZm9ybWF0U3RhY2sgPSBmdW5jdGlvbihzdGFjaywgZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIpIHJldHVybiBzdGFjaztcblxuICAgICAgICAgICAgaWYgKGVycm9yLm5hbWUgIT09IHZvaWQgMCAmJlxuICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlcnJvci5uYW1lICsgXCIuIFwiICsgZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmb3JtYXROb25FcnJvcihlcnJvcik7XG5cblxuICAgICAgICB9O1xuICAgICAgICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkX2NhcHR1cmVTdGFja1RyYWNlKFxuICAgICAgICAgICAgcmVjZWl2ZXIsIGlnbm9yZVVudGlsKSB7XG4gICAgICAgICAgICBjYXB0dXJlU3RhY2tUcmFjZShyZWNlaXZlciwgaWdub3JlVW50aWwpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICB2YXIgZXJyID0gbmV3IEVycm9yKCk7XG5cbiAgICBpZiAodHlwZW9mIGVyci5zdGFjayA9PT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICB0eXBlb2YgXCJcIi5zdGFydHNXaXRoID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgKGVyci5zdGFjay5zdGFydHNXaXRoKFwic3RhY2tEZXRlY3Rpb25AXCIpKSAmJlxuICAgICAgICBzdGFja0RldGVjdGlvbi5uYW1lID09PSBcInN0YWNrRGV0ZWN0aW9uXCIpIHtcblxuICAgICAgICBkZWZpbmVQcm9wZXJ0eShFcnJvciwgXCJzdGFja1RyYWNlTGltaXRcIiwge1xuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICB2YWx1ZTogMjVcbiAgICAgICAgfSk7XG4gICAgICAgIHJ0cmFjZWxpbmUgPSAvQC87XG4gICAgICAgIHZhciBybGluZSA9IC9bQFxcbl0vO1xuXG4gICAgICAgIGZvcm1hdFN0YWNrID0gZnVuY3Rpb24oc3RhY2ssIGVycm9yKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChlcnJvci5uYW1lICsgXCIuIFwiICsgZXJyb3IubWVzc2FnZSArIFwiXFxuXCIgKyBzdGFjayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChlcnJvci5uYW1lICE9PSB2b2lkIDAgJiZcbiAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IubmFtZSArIFwiLiBcIiArIGVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Tm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBjYXB0dXJlU3RhY2tUcmFjZShvKSB7XG4gICAgICAgICAgICB2YXIgc3RhY2sgPSBuZXcgRXJyb3IoKS5zdGFjaztcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IHN0YWNrLnNwbGl0KHJsaW5lKTtcbiAgICAgICAgICAgIHZhciBsZW4gPSBzcGxpdC5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgcmV0ID0gXCJcIjtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDIpIHtcbiAgICAgICAgICAgICAgICByZXQgKz0gc3BsaXRbaV07XG4gICAgICAgICAgICAgICAgcmV0ICs9IFwiQFwiO1xuICAgICAgICAgICAgICAgIHJldCArPSBzcGxpdFtpICsgMV07XG4gICAgICAgICAgICAgICAgcmV0ICs9IFwiXFxuXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvLnN0YWNrID0gcmV0O1xuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1hdFN0YWNrID0gZnVuY3Rpb24oc3RhY2ssIGVycm9yKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YWNrID09PSBcInN0cmluZ1wiKSByZXR1cm4gc3RhY2s7XG5cbiAgICAgICAgICAgIGlmICgodHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiIHx8XG4gICAgICAgICAgICAgICAgdHlwZW9mIGVycm9yID09PSBcImZ1bmN0aW9uXCIpICYmXG4gICAgICAgICAgICAgICAgZXJyb3IubmFtZSAhPT0gdm9pZCAwICYmXG4gICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yLm5hbWUgKyBcIi4gXCIgKyBlcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59KSgpO1xuXG5yZXR1cm4gQ2FwdHVyZWRUcmFjZTtcbn07XG5cbn0pKCkiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihORVhUX0ZJTFRFUikge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIga2V5cyA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKS5rZXlzO1xudmFyIFR5cGVFcnJvciA9IGVycm9ycy5UeXBlRXJyb3I7XG5cbmZ1bmN0aW9uIENhdGNoRmlsdGVyKGluc3RhbmNlcywgY2FsbGJhY2ssIHByb21pc2UpIHtcbiAgICB0aGlzLl9pbnN0YW5jZXMgPSBpbnN0YW5jZXM7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB0aGlzLl9wcm9taXNlID0gcHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gQ2F0Y2hGaWx0ZXIkX3NhZmVQcmVkaWNhdGUocHJlZGljYXRlLCBlKSB7XG4gICAgdmFyIHNhZmVPYmplY3QgPSB7fTtcbiAgICB2YXIgcmV0ZmlsdGVyID0gdHJ5Q2F0Y2gxKHByZWRpY2F0ZSwgc2FmZU9iamVjdCwgZSk7XG5cbiAgICBpZiAocmV0ZmlsdGVyID09PSBlcnJvck9iaikgcmV0dXJuIHJldGZpbHRlcjtcblxuICAgIHZhciBzYWZlS2V5cyA9IGtleXMoc2FmZU9iamVjdCk7XG4gICAgaWYgKHNhZmVLZXlzLmxlbmd0aCkge1xuICAgICAgICBlcnJvck9iai5lID0gbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICAgIFwiQ2F0Y2ggZmlsdGVyIG11c3QgaW5oZXJpdCBmcm9tIEVycm9yIFwiXG4gICAgICAgICAgKyBcIm9yIGJlIGEgc2ltcGxlIHByZWRpY2F0ZSBmdW5jdGlvblwiKTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbiAgICByZXR1cm4gcmV0ZmlsdGVyO1xufVxuXG5DYXRjaEZpbHRlci5wcm90b3R5cGUuZG9GaWx0ZXIgPSBmdW5jdGlvbiBDYXRjaEZpbHRlciRfZG9GaWx0ZXIoZSkge1xuICAgIHZhciBjYiA9IHRoaXMuX2NhbGxiYWNrO1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZTtcbiAgICB2YXIgYm91bmRUbyA9IHByb21pc2UuX2JvdW5kVG87XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2luc3RhbmNlcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgaXRlbSA9IHRoaXMuX2luc3RhbmNlc1tpXTtcbiAgICAgICAgdmFyIGl0ZW1Jc0Vycm9yVHlwZSA9IGl0ZW0gPT09IEVycm9yIHx8XG4gICAgICAgICAgICAoaXRlbSAhPSBudWxsICYmIGl0ZW0ucHJvdG90eXBlIGluc3RhbmNlb2YgRXJyb3IpO1xuXG4gICAgICAgIGlmIChpdGVtSXNFcnJvclR5cGUgJiYgZSBpbnN0YW5jZW9mIGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaDEoY2IsIGJvdW5kVG8sIGUpO1xuICAgICAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICBORVhUX0ZJTFRFUi5lID0gcmV0LmU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE5FWFRfRklMVEVSO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbSA9PT0gXCJmdW5jdGlvblwiICYmICFpdGVtSXNFcnJvclR5cGUpIHtcbiAgICAgICAgICAgIHZhciBzaG91bGRIYW5kbGUgPSBDYXRjaEZpbHRlciRfc2FmZVByZWRpY2F0ZShpdGVtLCBlKTtcbiAgICAgICAgICAgIGlmIChzaG91bGRIYW5kbGUgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYWNlID0gZXJyb3JzLmNhbkF0dGFjaChlcnJvck9iai5lKVxuICAgICAgICAgICAgICAgICAgICA/IGVycm9yT2JqLmVcbiAgICAgICAgICAgICAgICAgICAgOiBuZXcgRXJyb3IoZXJyb3JPYmouZSArIFwiXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgICAgIGUgPSBlcnJvck9iai5lO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzaG91bGRIYW5kbGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gxKGNiLCBib3VuZFRvLCBlKTtcbiAgICAgICAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICAgICAgICBORVhUX0ZJTFRFUi5lID0gcmV0LmU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBORVhUX0ZJTFRFUi5lID0gZTtcbiAgICByZXR1cm4gTkVYVF9GSUxURVI7XG59O1xuXG5yZXR1cm4gQ2F0Y2hGaWx0ZXI7XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBtYXliZVdyYXBBc0Vycm9yID0gdXRpbC5tYXliZVdyYXBBc0Vycm9yO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciBUaW1lb3V0RXJyb3IgPSBlcnJvcnMuVGltZW91dEVycm9yO1xudmFyIE9wZXJhdGlvbmFsRXJyb3IgPSBlcnJvcnMuT3BlcmF0aW9uYWxFcnJvcjtcbnZhciBhc3luYyA9IHJlcXVpcmUoXCIuL2FzeW5jLmpzXCIpO1xudmFyIGhhdmVHZXR0ZXJzID0gdXRpbC5oYXZlR2V0dGVycztcbnZhciBlczUgPSByZXF1aXJlKFwiLi9lczUuanNcIik7XG5cbmZ1bmN0aW9uIGlzVW50eXBlZEVycm9yKG9iaikge1xuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBFcnJvciAmJlxuICAgICAgICBlczUuZ2V0UHJvdG90eXBlT2Yob2JqKSA9PT0gRXJyb3IucHJvdG90eXBlO1xufVxuXG5mdW5jdGlvbiB3cmFwQXNPcGVyYXRpb25hbEVycm9yKG9iaikge1xuICAgIHZhciByZXQ7XG4gICAgaWYgKGlzVW50eXBlZEVycm9yKG9iaikpIHtcbiAgICAgICAgcmV0ID0gbmV3IE9wZXJhdGlvbmFsRXJyb3Iob2JqKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXQgPSBvYmo7XG4gICAgfVxuICAgIGVycm9ycy5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24ocmV0KTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSkge1xuICAgIGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRfY2FsbGJhY2soZXJyLCB2YWx1ZSkge1xuICAgICAgICBpZiAocHJvbWlzZSA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIHZhciB3cmFwcGVkID0gd3JhcEFzT3BlcmF0aW9uYWxFcnJvcihtYXliZVdyYXBBc0Vycm9yKGVycikpO1xuICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTtcbiAgICAgICAgICAgIHByb21pc2UuX3JlamVjdCh3cmFwcGVkKTtcbiAgICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgdmFyICRfbGVuID0gYXJndW1lbnRzLmxlbmd0aDt2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbiAtIDEpOyBmb3IodmFyICRfaSA9IDE7ICRfaSA8ICRfbGVuOyArKyRfaSkge2FyZ3NbJF9pIC0gMV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgICAgICAgICBwcm9taXNlLl9mdWxmaWxsKGFyZ3MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2VSZXNvbHZlciRfY2FsbGJhY2s7XG59XG5cblxudmFyIFByb21pc2VSZXNvbHZlcjtcbmlmICghaGF2ZUdldHRlcnMpIHtcbiAgICBQcm9taXNlUmVzb2x2ZXIgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIocHJvbWlzZSkge1xuICAgICAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlO1xuICAgICAgICB0aGlzLmFzQ2FsbGJhY2sgPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSB0aGlzLmFzQ2FsbGJhY2s7XG4gICAgfTtcbn1cbmVsc2Uge1xuICAgIFByb21pc2VSZXNvbHZlciA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlcihwcm9taXNlKSB7XG4gICAgICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7XG4gICAgfTtcbn1cbmlmIChoYXZlR2V0dGVycykge1xuICAgIHZhciBwcm9wID0ge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGViYWNrRm9yUHJvbWlzZSh0aGlzLnByb21pc2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBlczUuZGVmaW5lUHJvcGVydHkoUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZSwgXCJhc0NhbGxiYWNrXCIsIHByb3ApO1xuICAgIGVzNS5kZWZpbmVQcm9wZXJ0eShQcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLCBcImNhbGxiYWNrXCIsIHByb3ApO1xufVxuXG5Qcm9taXNlUmVzb2x2ZXIuX25vZGViYWNrRm9yUHJvbWlzZSA9IG5vZGViYWNrRm9yUHJvbWlzZTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciR0b1N0cmluZygpIHtcbiAgICByZXR1cm4gXCJbb2JqZWN0IFByb21pc2VSZXNvbHZlcl1cIjtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUucmVzb2x2ZSA9XG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLmZ1bGZpbGwgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkcmVzb2x2ZSh2YWx1ZSkge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlUmVzb2x2ZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbGxlZ2FsIGludm9jYXRpb24sIHJlc29sdmVyIHJlc29sdmUvcmVqZWN0IG11c3QgYmUgY2FsbGVkIHdpdGhpbiBhIHJlc29sdmVyIGNvbnRleHQuIENvbnNpZGVyIHVzaW5nIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGluc3RlYWQuXCIpO1xuICAgIH1cblxuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuICAgIGlmIChwcm9taXNlLl90cnlGb2xsb3codmFsdWUpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYXN5bmMuaW52b2tlKHByb21pc2UuX2Z1bGZpbGwsIHByb21pc2UsIHZhbHVlKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUucmVqZWN0ID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHJlamVjdChyZWFzb24pIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZVJlc29sdmVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSWxsZWdhbCBpbnZvY2F0aW9uLCByZXNvbHZlciByZXNvbHZlL3JlamVjdCBtdXN0IGJlIGNhbGxlZCB3aXRoaW4gYSByZXNvbHZlciBjb250ZXh0LiBDb25zaWRlciB1c2luZyB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciBpbnN0ZWFkLlwiKTtcbiAgICB9XG5cbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcbiAgICBlcnJvcnMubWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKHJlYXNvbik7XG4gICAgdmFyIHRyYWNlID0gZXJyb3JzLmNhbkF0dGFjaChyZWFzb24pID8gcmVhc29uIDogbmV3IEVycm9yKHJlYXNvbiArIFwiXCIpO1xuICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgIGFzeW5jLmludm9rZShwcm9taXNlLl9yZWplY3QsIHByb21pc2UsIHJlYXNvbik7XG4gICAgaWYgKHRyYWNlICE9PSByZWFzb24pIHtcbiAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX3NldENhcnJpZWRTdGFja1RyYWNlLCB0aGlzLCB0cmFjZSk7XG4gICAgfVxufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5wcm9ncmVzcyA9XG5mdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkcHJvZ3Jlc3ModmFsdWUpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZVJlc29sdmVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSWxsZWdhbCBpbnZvY2F0aW9uLCByZXNvbHZlciByZXNvbHZlL3JlamVjdCBtdXN0IGJlIGNhbGxlZCB3aXRoaW4gYSByZXNvbHZlciBjb250ZXh0LiBDb25zaWRlciB1c2luZyB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciBpbnN0ZWFkLlwiKTtcbiAgICB9XG4gICAgYXN5bmMuaW52b2tlKHRoaXMucHJvbWlzZS5fcHJvZ3Jlc3MsIHRoaXMucHJvbWlzZSwgdmFsdWUpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkY2FuY2VsKCkge1xuICAgIGFzeW5jLmludm9rZSh0aGlzLnByb21pc2UuY2FuY2VsLCB0aGlzLnByb21pc2UsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnRpbWVvdXQgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkdGltZW91dCgpIHtcbiAgICB0aGlzLnJlamVjdChuZXcgVGltZW91dEVycm9yKFwidGltZW91dFwiKSk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLmlzUmVzb2x2ZWQgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkaXNSZXNvbHZlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlLmlzUmVzb2x2ZWQoKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHRvSlNPTigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlLnRvSlNPTigpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5fc2V0Q2FycmllZFN0YWNrVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJF9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSkge1xuICAgIGlmICh0aGlzLnByb21pc2UuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHRoaXMucHJvbWlzZS5fc2V0Q2FycmllZFN0YWNrVHJhY2UodHJhY2UpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUHJvbWlzZVJlc29sdmVyO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgTkVYVF9GSUxURVIsIGNhc3QpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyID0gdXRpbC53cmFwc1ByaW1pdGl2ZVJlY2VpdmVyO1xudmFyIGlzUHJpbWl0aXZlID0gdXRpbC5pc1ByaW1pdGl2ZTtcbnZhciB0aHJvd2VyID0gdXRpbC50aHJvd2VyO1xuXG5mdW5jdGlvbiByZXR1cm5UaGlzKCkge1xuICAgIHJldHVybiB0aGlzO1xufVxuZnVuY3Rpb24gdGhyb3dUaGlzKCkge1xuICAgIHRocm93IHRoaXM7XG59XG5mdW5jdGlvbiByZXR1cm4kKHIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfcmV0dXJuZXIoKSB7XG4gICAgICAgIHJldHVybiByO1xuICAgIH07XG59XG5mdW5jdGlvbiB0aHJvdyQocikge1xuICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF90aHJvd2VyKCkge1xuICAgICAgICB0aHJvdyByO1xuICAgIH07XG59XG5mdW5jdGlvbiBwcm9taXNlZEZpbmFsbHkocmV0LCByZWFzb25PclZhbHVlLCBpc0Z1bGZpbGxlZCkge1xuICAgIHZhciB0aGVuO1xuICAgIGlmICh3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyICYmIGlzUHJpbWl0aXZlKHJlYXNvbk9yVmFsdWUpKSB7XG4gICAgICAgIHRoZW4gPSBpc0Z1bGZpbGxlZCA/IHJldHVybiQocmVhc29uT3JWYWx1ZSkgOiB0aHJvdyQocmVhc29uT3JWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhlbiA9IGlzRnVsZmlsbGVkID8gcmV0dXJuVGhpcyA6IHRocm93VGhpcztcbiAgICB9XG4gICAgcmV0dXJuIHJldC5fdGhlbih0aGVuLCB0aHJvd2VyLCB2b2lkIDAsIHJlYXNvbk9yVmFsdWUsIHZvaWQgMCk7XG59XG5cbmZ1bmN0aW9uIGZpbmFsbHlIYW5kbGVyKHJlYXNvbk9yVmFsdWUpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcbiAgICB2YXIgaGFuZGxlciA9IHRoaXMuaGFuZGxlcjtcblxuICAgIHZhciByZXQgPSBwcm9taXNlLl9pc0JvdW5kKClcbiAgICAgICAgICAgICAgICAgICAgPyBoYW5kbGVyLmNhbGwocHJvbWlzZS5fYm91bmRUbylcbiAgICAgICAgICAgICAgICAgICAgOiBoYW5kbGVyKCk7XG5cbiAgICBpZiAocmV0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmV0LCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VkRmluYWxseShtYXliZVByb21pc2UsIHJlYXNvbk9yVmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlLmlzRnVsZmlsbGVkKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHByb21pc2UuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIE5FWFRfRklMVEVSLmUgPSByZWFzb25PclZhbHVlO1xuICAgICAgICByZXR1cm4gTkVYVF9GSUxURVI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlYXNvbk9yVmFsdWU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0YXBIYW5kbGVyKHZhbHVlKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG4gICAgdmFyIGhhbmRsZXIgPSB0aGlzLmhhbmRsZXI7XG5cbiAgICB2YXIgcmV0ID0gcHJvbWlzZS5faXNCb3VuZCgpXG4gICAgICAgICAgICAgICAgICAgID8gaGFuZGxlci5jYWxsKHByb21pc2UuX2JvdW5kVG8sIHZhbHVlKVxuICAgICAgICAgICAgICAgICAgICA6IGhhbmRsZXIodmFsdWUpO1xuXG4gICAgaWYgKHJldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJldCwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9taXNlZEZpbmFsbHkobWF5YmVQcm9taXNlLCB2YWx1ZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5fcGFzc1Rocm91Z2hIYW5kbGVyID1cbmZ1bmN0aW9uIFByb21pc2UkX3Bhc3NUaHJvdWdoSGFuZGxlcihoYW5kbGVyLCBpc0ZpbmFsbHkpIHtcbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIHRoaXMudGhlbigpO1xuXG4gICAgdmFyIHByb21pc2VBbmRIYW5kbGVyID0ge1xuICAgICAgICBwcm9taXNlOiB0aGlzLFxuICAgICAgICBoYW5kbGVyOiBoYW5kbGVyXG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLl90aGVuKFxuICAgICAgICAgICAgaXNGaW5hbGx5ID8gZmluYWxseUhhbmRsZXIgOiB0YXBIYW5kbGVyLFxuICAgICAgICAgICAgaXNGaW5hbGx5ID8gZmluYWxseUhhbmRsZXIgOiB2b2lkIDAsIHZvaWQgMCxcbiAgICAgICAgICAgIHByb21pc2VBbmRIYW5kbGVyLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUubGFzdGx5ID1cblByb21pc2UucHJvdG90eXBlW1wiZmluYWxseVwiXSA9IGZ1bmN0aW9uIFByb21pc2UkZmluYWxseShoYW5kbGVyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Bhc3NUaHJvdWdoSGFuZGxlcihoYW5kbGVyLCB0cnVlKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRhcCA9IGZ1bmN0aW9uIFByb21pc2UkdGFwKGhhbmRsZXIpIHtcbiAgICByZXR1cm4gdGhpcy5fcGFzc1Rocm91Z2hIYW5kbGVyKGhhbmRsZXIsIGZhbHNlKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBpc1ByaW1pdGl2ZSA9IHV0aWwuaXNQcmltaXRpdmU7XG52YXIgd3JhcHNQcmltaXRpdmVSZWNlaXZlciA9IHV0aWwud3JhcHNQcmltaXRpdmVSZWNlaXZlcjtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlKSB7XG52YXIgcmV0dXJuZXIgPSBmdW5jdGlvbiBQcm9taXNlJF9yZXR1cm5lcigpIHtcbiAgICByZXR1cm4gdGhpcztcbn07XG52YXIgdGhyb3dlciA9IGZ1bmN0aW9uIFByb21pc2UkX3Rocm93ZXIoKSB7XG4gICAgdGhyb3cgdGhpcztcbn07XG5cbnZhciB3cmFwcGVyID0gZnVuY3Rpb24gUHJvbWlzZSRfd3JhcHBlcih2YWx1ZSwgYWN0aW9uKSB7XG4gICAgaWYgKGFjdGlvbiA9PT0gMSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfdGhyb3dlcigpIHtcbiAgICAgICAgICAgIHRocm93IHZhbHVlO1xuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF9yZXR1cm5lcigpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICB9XG59O1xuXG5cblByb21pc2UucHJvdG90eXBlW1wicmV0dXJuXCJdID1cblByb21pc2UucHJvdG90eXBlLnRoZW5SZXR1cm4gPVxuZnVuY3Rpb24gUHJvbWlzZSR0aGVuUmV0dXJuKHZhbHVlKSB7XG4gICAgaWYgKHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgJiYgaXNQcmltaXRpdmUodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aGVuKFxuICAgICAgICAgICAgd3JhcHBlcih2YWx1ZSwgMiksXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICB2b2lkIDBcbiAgICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fdGhlbihyZXR1cm5lciwgdm9pZCAwLCB2b2lkIDAsIHZhbHVlLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGVbXCJ0aHJvd1wiXSA9XG5Qcm9taXNlLnByb3RvdHlwZS50aGVuVGhyb3cgPVxuZnVuY3Rpb24gUHJvbWlzZSR0aGVuVGhyb3cocmVhc29uKSB7XG4gICAgaWYgKHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgJiYgaXNQcmltaXRpdmUocmVhc29uKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGhlbihcbiAgICAgICAgICAgIHdyYXBwZXIocmVhc29uLCAxKSxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMFxuICAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl90aGVuKHRocm93ZXIsIHZvaWQgMCwgdm9pZCAwLCByZWFzb24sIHZvaWQgMCk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9XG5mdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGNhc3QsIElOVEVSTkFMKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgY2FuRXZhbHVhdGUgPSB1dGlsLmNhbkV2YWx1YXRlO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcblxuXG5pZiAoY2FuRXZhbHVhdGUpIHtcbiAgICB2YXIgdGhlbkNhbGxiYWNrID0gZnVuY3Rpb24oaSkge1xuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwidmFsdWVcIiwgXCJob2xkZXJcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBob2xkZXIucEluZGV4ID0gdmFsdWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBob2xkZXIuY2hlY2tGdWxmaWxsbWVudCh0aGlzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIi5yZXBsYWNlKC9JbmRleC9nLCBpKSk7XG4gICAgfTtcblxuICAgIHZhciBjYWxsZXIgPSBmdW5jdGlvbihjb3VudCkge1xuICAgICAgICB2YXIgdmFsdWVzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IGNvdW50OyArK2kpIHZhbHVlcy5wdXNoKFwiaG9sZGVyLnBcIiArIGkpO1xuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwiaG9sZGVyXCIsIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gaG9sZGVyLmZuOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKHZhbHVlcyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCIucmVwbGFjZSgvdmFsdWVzL2csIHZhbHVlcy5qb2luKFwiLCBcIikpKTtcbiAgICB9O1xuICAgIHZhciB0aGVuQ2FsbGJhY2tzID0gW107XG4gICAgdmFyIGNhbGxlcnMgPSBbdm9pZCAwXTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8PSA1OyArK2kpIHtcbiAgICAgICAgdGhlbkNhbGxiYWNrcy5wdXNoKHRoZW5DYWxsYmFjayhpKSk7XG4gICAgICAgIGNhbGxlcnMucHVzaChjYWxsZXIoaSkpO1xuICAgIH1cblxuICAgIHZhciBIb2xkZXIgPSBmdW5jdGlvbih0b3RhbCwgZm4pIHtcbiAgICAgICAgdGhpcy5wMSA9IHRoaXMucDIgPSB0aGlzLnAzID0gdGhpcy5wNCA9IHRoaXMucDUgPSBudWxsO1xuICAgICAgICB0aGlzLmZuID0gZm47XG4gICAgICAgIHRoaXMudG90YWwgPSB0b3RhbDtcbiAgICAgICAgdGhpcy5ub3cgPSAwO1xuICAgIH07XG5cbiAgICBIb2xkZXIucHJvdG90eXBlLmNhbGxlcnMgPSBjYWxsZXJzO1xuICAgIEhvbGRlci5wcm90b3R5cGUuY2hlY2tGdWxmaWxsbWVudCA9IGZ1bmN0aW9uKHByb21pc2UpIHtcbiAgICAgICAgdmFyIG5vdyA9IHRoaXMubm93O1xuICAgICAgICBub3crKztcbiAgICAgICAgdmFyIHRvdGFsID0gdGhpcy50b3RhbDtcbiAgICAgICAgaWYgKG5vdyA+PSB0b3RhbCkge1xuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSB0aGlzLmNhbGxlcnNbdG90YWxdO1xuICAgICAgICAgICAgdmFyIHJldCA9IHRyeUNhdGNoMShoYW5kbGVyLCB2b2lkIDAsIHRoaXMpO1xuICAgICAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9yZWplY3RVbmNoZWNrZWQocmV0LmUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghcHJvbWlzZS5fdHJ5Rm9sbG93KHJldCkpIHtcbiAgICAgICAgICAgICAgICBwcm9taXNlLl9mdWxmaWxsVW5jaGVja2VkKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5vdyA9IG5vdztcbiAgICAgICAgfVxuICAgIH07XG59XG5cblxuXG5cblByb21pc2Uuam9pbiA9IGZ1bmN0aW9uIFByb21pc2UkSm9pbigpIHtcbiAgICB2YXIgbGFzdCA9IGFyZ3VtZW50cy5sZW5ndGggLSAxO1xuICAgIHZhciBmbjtcbiAgICBpZiAobGFzdCA+IDAgJiYgdHlwZW9mIGFyZ3VtZW50c1tsYXN0XSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGZuID0gYXJndW1lbnRzW2xhc3RdO1xuICAgICAgICBpZiAobGFzdCA8IDYgJiYgY2FuRXZhbHVhdGUpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgICAgICB2YXIgaG9sZGVyID0gbmV3IEhvbGRlcihsYXN0LCBmbik7XG4gICAgICAgICAgICB2YXIgcmVqZWN0ID0gcmV0Ll9yZWplY3Q7XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2tzID0gdGhlbkNhbGxiYWNrcztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGFzdDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QoYXJndW1lbnRzW2ldLCB2b2lkIDApO1xuICAgICAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdGhlbihjYWxsYmFja3NbaV0sIHJlamVjdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIDAsIHJldCwgaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGwocmV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl9zZXR0bGVkVmFsdWUsIGhvbGRlcik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXQuX3JlamVjdChtYXliZVByb21pc2UuX3NldHRsZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrc1tpXS5jYWxsKHJldCwgbWF5YmVQcm9taXNlLCBob2xkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyICRfbGVuID0gYXJndW1lbnRzLmxlbmd0aDt2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbik7IGZvcih2YXIgJF9pID0gMDsgJF9pIDwgJF9sZW47ICsrJF9pKSB7YXJnc1skX2ldID0gYXJndW1lbnRzWyRfaV07fVxuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZUFycmF5KGFyZ3MpLnByb21pc2UoKTtcbiAgICByZXR1cm4gZm4gIT09IHZvaWQgMCA/IHJldC5zcHJlYWQoZm4pIDogcmV0O1xufTtcblxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMLCBjYXN0KSB7XG52YXIgYXBpUmVqZWN0aW9uID0gcmVxdWlyZShcIi4vZXJyb3JzX2FwaV9yZWplY3Rpb24uanNcIikoUHJvbWlzZSk7XG52YXIgaXNBcnJheSA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikuaXNBcnJheTtcblxudmFyIHJhY2VMYXRlciA9IGZ1bmN0aW9uIFByb21pc2UkX3JhY2VMYXRlcihwcm9taXNlKSB7XG4gICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbihhcnJheSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZSRfUmFjZShhcnJheSwgcHJvbWlzZSk7XG4gICAgfSk7XG59O1xuXG52YXIgaGFzT3duID0ge30uaGFzT3duUHJvcGVydHk7XG5mdW5jdGlvbiBQcm9taXNlJF9SYWNlKHByb21pc2VzLCBwYXJlbnQpIHtcbiAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChwcm9taXNlcywgdm9pZCAwKTtcblxuICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHJldHVybiByYWNlTGF0ZXIobWF5YmVQcm9taXNlKTtcbiAgICB9IGVsc2UgaWYgKCFpc0FycmF5KHByb21pc2VzKSkge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZXhwZWN0aW5nIGFuIGFycmF5LCBhIHByb21pc2Ugb3IgYSB0aGVuYWJsZVwiKTtcbiAgICB9XG5cbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIGlmIChwYXJlbnQgIT09IHZvaWQgMCkge1xuICAgICAgICByZXQuX3Byb3BhZ2F0ZUZyb20ocGFyZW50LCA3KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgfVxuICAgIHZhciBmdWxmaWxsID0gcmV0Ll9mdWxmaWxsO1xuICAgIHZhciByZWplY3QgPSByZXQuX3JlamVjdDtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcHJvbWlzZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdmFyIHZhbCA9IHByb21pc2VzW2ldO1xuXG4gICAgICAgIGlmICh2YWwgPT09IHZvaWQgMCAmJiAhKGhhc093bi5jYWxsKHByb21pc2VzLCBpKSkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgUHJvbWlzZS5jYXN0KHZhbCkuX3RoZW4oZnVsZmlsbCwgcmVqZWN0LCB2b2lkIDAsIHJldCwgbnVsbCk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cblByb21pc2UucmFjZSA9IGZ1bmN0aW9uIFByb21pc2UkUmFjZShwcm9taXNlcykge1xuICAgIHJldHVybiBQcm9taXNlJF9SYWNlKHByb21pc2VzLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUucmFjZSA9IGZ1bmN0aW9uIFByb21pc2UkcmFjZSgpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfUmFjZSh0aGlzLCB2b2lkIDApO1xufTtcblxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgY3IgPSBPYmplY3QuY3JlYXRlO1xuaWYgKGNyKSB7XG4gICAgdmFyIGNhbGxlckNhY2hlID0gY3IobnVsbCk7XG4gICAgdmFyIGdldHRlckNhY2hlID0gY3IobnVsbCk7XG4gICAgY2FsbGVyQ2FjaGVbXCIgc2l6ZVwiXSA9IGdldHRlckNhY2hlW1wiIHNpemVcIl0gPSAwO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBjYW5FdmFsdWF0ZSA9IHV0aWwuY2FuRXZhbHVhdGU7XG52YXIgaXNJZGVudGlmaWVyID0gdXRpbC5pc0lkZW50aWZpZXI7XG5cbmZ1bmN0aW9uIG1ha2VNZXRob2RDYWxsZXIgKG1ldGhvZE5hbWUpIHtcbiAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKFwib2JqXCIsIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgJ3VzZSBzdHJpY3QnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgc3dpdGNoKGxlbikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIG9iai5tZXRob2ROYW1lKHRoaXNbMF0pOyAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG9iai5tZXRob2ROYW1lKHRoaXNbMF0sIHRoaXNbMV0pOyAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIG9iai5tZXRob2ROYW1lKHRoaXNbMF0sIHRoaXNbMV0sIHRoaXNbMl0pOyAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIG9iai5tZXRob2ROYW1lKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBvYmoubWV0aG9kTmFtZS5hcHBseShvYmosIHRoaXMpOyAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgXCIucmVwbGFjZSgvbWV0aG9kTmFtZS9nLCBtZXRob2ROYW1lKSk7XG59XG5cbmZ1bmN0aW9uIG1ha2VHZXR0ZXIgKHByb3BlcnR5TmFtZSkge1xuICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJvYmpcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICByZXR1cm4gb2JqLnByb3BlcnR5TmFtZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBcIi5yZXBsYWNlKFwicHJvcGVydHlOYW1lXCIsIHByb3BlcnR5TmFtZSkpO1xufVxuXG5mdW5jdGlvbiBnZXRDb21waWxlZChuYW1lLCBjb21waWxlciwgY2FjaGUpIHtcbiAgICB2YXIgcmV0ID0gY2FjaGVbbmFtZV07XG4gICAgaWYgKHR5cGVvZiByZXQgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBpZiAoIWlzSWRlbnRpZmllcihuYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ID0gY29tcGlsZXIobmFtZSk7XG4gICAgICAgIGNhY2hlW25hbWVdID0gcmV0O1xuICAgICAgICBjYWNoZVtcIiBzaXplXCJdKys7XG4gICAgICAgIGlmIChjYWNoZVtcIiBzaXplXCJdID4gNTEyKSB7XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGNhY2hlKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyArK2kpIGRlbGV0ZSBjYWNoZVtrZXlzW2ldXTtcbiAgICAgICAgICAgIGNhY2hlW1wiIHNpemVcIl0gPSBrZXlzLmxlbmd0aCAtIDI1NjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBnZXRNZXRob2RDYWxsZXIobmFtZSkge1xuICAgIHJldHVybiBnZXRDb21waWxlZChuYW1lLCBtYWtlTWV0aG9kQ2FsbGVyLCBjYWxsZXJDYWNoZSk7XG59XG5cbmZ1bmN0aW9uIGdldEdldHRlcihuYW1lKSB7XG4gICAgcmV0dXJuIGdldENvbXBpbGVkKG5hbWUsIG1ha2VHZXR0ZXIsIGdldHRlckNhY2hlKTtcbn1cblxuZnVuY3Rpb24gY2FsbGVyKG9iaikge1xuICAgIHJldHVybiBvYmpbdGhpcy5wb3AoKV0uYXBwbHkob2JqLCB0aGlzKTtcbn1cblByb21pc2UucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiBQcm9taXNlJGNhbGwobWV0aG9kTmFtZSkge1xuICAgIHZhciAkX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGg7dmFyIGFyZ3MgPSBuZXcgQXJyYXkoJF9sZW4gLSAxKTsgZm9yKHZhciAkX2kgPSAxOyAkX2kgPCAkX2xlbjsgKyskX2kpIHthcmdzWyRfaSAtIDFdID0gYXJndW1lbnRzWyRfaV07fVxuICAgIGlmIChjYW5FdmFsdWF0ZSkge1xuICAgICAgICB2YXIgbWF5YmVDYWxsZXIgPSBnZXRNZXRob2RDYWxsZXIobWV0aG9kTmFtZSk7XG4gICAgICAgIGlmIChtYXliZUNhbGxlciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4obWF5YmVDYWxsZXIsIHZvaWQgMCwgdm9pZCAwLCBhcmdzLCB2b2lkIDApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFyZ3MucHVzaChtZXRob2ROYW1lKTtcbiAgICByZXR1cm4gdGhpcy5fdGhlbihjYWxsZXIsIHZvaWQgMCwgdm9pZCAwLCBhcmdzLCB2b2lkIDApO1xufTtcblxuZnVuY3Rpb24gbmFtZWRHZXR0ZXIob2JqKSB7XG4gICAgcmV0dXJuIG9ialt0aGlzXTtcbn1cbmZ1bmN0aW9uIGluZGV4ZWRHZXR0ZXIob2JqKSB7XG4gICAgcmV0dXJuIG9ialt0aGlzXTtcbn1cblByb21pc2UucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIFByb21pc2UkZ2V0KHByb3BlcnR5TmFtZSkge1xuICAgIHZhciBpc0luZGV4ID0gKHR5cGVvZiBwcm9wZXJ0eU5hbWUgPT09IFwibnVtYmVyXCIpO1xuICAgIHZhciBnZXR0ZXI7XG4gICAgaWYgKCFpc0luZGV4KSB7XG4gICAgICAgIGlmIChjYW5FdmFsdWF0ZSkge1xuICAgICAgICAgICAgdmFyIG1heWJlR2V0dGVyID0gZ2V0R2V0dGVyKHByb3BlcnR5TmFtZSk7XG4gICAgICAgICAgICBnZXR0ZXIgPSBtYXliZUdldHRlciAhPT0gbnVsbCA/IG1heWJlR2V0dGVyIDogbmFtZWRHZXR0ZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZXR0ZXIgPSBuYW1lZEdldHRlcjtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldHRlciA9IGluZGV4ZWRHZXR0ZXI7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl90aGVuKGdldHRlciwgdm9pZCAwLCB2b2lkIDAsIHByb3BlcnR5TmFtZSwgdm9pZCAwKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgYXBpUmVqZWN0aW9uLCBJTlRFUk5BTCwgY2FzdCkge1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciBUeXBlRXJyb3IgPSBlcnJvcnMuVHlwZUVycm9yO1xudmFyIGRlcHJlY2F0ZWQgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLmRlcHJlY2F0ZWQ7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIHlpZWxkSGFuZGxlcnMgPSBbXTtcblxuZnVuY3Rpb24gcHJvbWlzZUZyb21ZaWVsZEhhbmRsZXIodmFsdWUsIHlpZWxkSGFuZGxlcnMpIHtcbiAgICB2YXIgX2Vycm9yT2JqID0gZXJyb3JPYmo7XG4gICAgdmFyIF9Qcm9taXNlID0gUHJvbWlzZTtcbiAgICB2YXIgbGVuID0geWllbGRIYW5kbGVycy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2gxKHlpZWxkSGFuZGxlcnNbaV0sIHZvaWQgMCwgdmFsdWUpO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBfZXJyb3JPYmopIHtcbiAgICAgICAgICAgIHJldHVybiBfUHJvbWlzZS5yZWplY3QoX2Vycm9yT2JqLmUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJlc3VsdCwgcHJvbWlzZUZyb21ZaWVsZEhhbmRsZXIpO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgX1Byb21pc2UpIHJldHVybiBtYXliZVByb21pc2U7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBQcm9taXNlU3Bhd24oZ2VuZXJhdG9yRnVuY3Rpb24sIHJlY2VpdmVyLCB5aWVsZEhhbmRsZXIpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcHJvbWlzZS5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICB0aGlzLl9nZW5lcmF0b3JGdW5jdGlvbiA9IGdlbmVyYXRvckZ1bmN0aW9uO1xuICAgIHRoaXMuX3JlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgdGhpcy5fZ2VuZXJhdG9yID0gdm9pZCAwO1xuICAgIHRoaXMuX3lpZWxkSGFuZGxlcnMgPSB0eXBlb2YgeWllbGRIYW5kbGVyID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgPyBbeWllbGRIYW5kbGVyXS5jb25jYXQoeWllbGRIYW5kbGVycylcbiAgICAgICAgOiB5aWVsZEhhbmRsZXJzO1xufVxuXG5Qcm9taXNlU3Bhd24ucHJvdG90eXBlLnByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlU3Bhd24kcHJvbWlzZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbn07XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUuX3J1biA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRfcnVuKCkge1xuICAgIHRoaXMuX2dlbmVyYXRvciA9IHRoaXMuX2dlbmVyYXRvckZ1bmN0aW9uLmNhbGwodGhpcy5fcmVjZWl2ZXIpO1xuICAgIHRoaXMuX3JlY2VpdmVyID1cbiAgICAgICAgdGhpcy5fZ2VuZXJhdG9yRnVuY3Rpb24gPSB2b2lkIDA7XG4gICAgdGhpcy5fbmV4dCh2b2lkIDApO1xufTtcblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fY29udGludWUgPSBmdW5jdGlvbiBQcm9taXNlU3Bhd24kX2NvbnRpbnVlKHJlc3VsdCkge1xuICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRvciA9IHZvaWQgMDtcbiAgICAgICAgdmFyIHRyYWNlID0gZXJyb3JzLmNhbkF0dGFjaChyZXN1bHQuZSlcbiAgICAgICAgICAgID8gcmVzdWx0LmUgOiBuZXcgRXJyb3IocmVzdWx0LmUgKyBcIlwiKTtcbiAgICAgICAgdGhpcy5fcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgIHRoaXMuX3Byb21pc2UuX3JlamVjdChyZXN1bHQuZSwgdHJhY2UpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgIGlmIChyZXN1bHQuZG9uZSA9PT0gdHJ1ZSkge1xuICAgICAgICB0aGlzLl9nZW5lcmF0b3IgPSB2b2lkIDA7XG4gICAgICAgIGlmICghdGhpcy5fcHJvbWlzZS5fdHJ5Rm9sbG93KHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5fcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdCh2YWx1ZSwgdm9pZCAwKTtcbiAgICAgICAgaWYgKCEobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZSA9XG4gICAgICAgICAgICAgICAgcHJvbWlzZUZyb21ZaWVsZEhhbmRsZXIobWF5YmVQcm9taXNlLCB0aGlzLl95aWVsZEhhbmRsZXJzKTtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90aHJvdyhuZXcgVHlwZUVycm9yKFwiQSB2YWx1ZSB3YXMgeWllbGRlZCB0aGF0IGNvdWxkIG5vdCBiZSB0cmVhdGVkIGFzIGEgcHJvbWlzZVwiKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG1heWJlUHJvbWlzZS5fdGhlbihcbiAgICAgICAgICAgIHRoaXMuX25leHQsXG4gICAgICAgICAgICB0aGlzLl90aHJvdyxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBudWxsXG4gICAgICAgKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlU3Bhd24ucHJvdG90eXBlLl90aHJvdyA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRfdGhyb3cocmVhc29uKSB7XG4gICAgaWYgKGVycm9ycy5jYW5BdHRhY2gocmVhc29uKSlcbiAgICAgICAgdGhpcy5fcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZShyZWFzb24pO1xuICAgIHRoaXMuX2NvbnRpbnVlKFxuICAgICAgICB0cnlDYXRjaDEodGhpcy5fZ2VuZXJhdG9yW1widGhyb3dcIl0sIHRoaXMuX2dlbmVyYXRvciwgcmVhc29uKVxuICAgKTtcbn07XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUuX25leHQgPSBmdW5jdGlvbiBQcm9taXNlU3Bhd24kX25leHQodmFsdWUpIHtcbiAgICB0aGlzLl9jb250aW51ZShcbiAgICAgICAgdHJ5Q2F0Y2gxKHRoaXMuX2dlbmVyYXRvci5uZXh0LCB0aGlzLl9nZW5lcmF0b3IsIHZhbHVlKVxuICAgKTtcbn07XG5cblByb21pc2UuY29yb3V0aW5lID1cbmZ1bmN0aW9uIFByb21pc2UkQ29yb3V0aW5lKGdlbmVyYXRvckZ1bmN0aW9uLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBnZW5lcmF0b3JGdW5jdGlvbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJnZW5lcmF0b3JGdW5jdGlvbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIHZhciB5aWVsZEhhbmRsZXIgPSBPYmplY3Qob3B0aW9ucykueWllbGRIYW5kbGVyO1xuICAgIHZhciBQcm9taXNlU3Bhd24kID0gUHJvbWlzZVNwYXduO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnZW5lcmF0b3IgPSBnZW5lcmF0b3JGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB2YXIgc3Bhd24gPSBuZXcgUHJvbWlzZVNwYXduJCh2b2lkIDAsIHZvaWQgMCwgeWllbGRIYW5kbGVyKTtcbiAgICAgICAgc3Bhd24uX2dlbmVyYXRvciA9IGdlbmVyYXRvcjtcbiAgICAgICAgc3Bhd24uX25leHQodm9pZCAwKTtcbiAgICAgICAgcmV0dXJuIHNwYXduLnByb21pc2UoKTtcbiAgICB9O1xufTtcblxuUHJvbWlzZS5jb3JvdXRpbmUuYWRkWWllbGRIYW5kbGVyID0gZnVuY3Rpb24oZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgeWllbGRIYW5kbGVycy5wdXNoKGZuKTtcbn07XG5cblByb21pc2Uuc3Bhd24gPSBmdW5jdGlvbiBQcm9taXNlJFNwYXduKGdlbmVyYXRvckZ1bmN0aW9uKSB7XG4gICAgZGVwcmVjYXRlZChcIlByb21pc2Uuc3Bhd24gaXMgZGVwcmVjYXRlZC4gVXNlIFByb21pc2UuY29yb3V0aW5lIGluc3RlYWQuXCIpO1xuICAgIGlmICh0eXBlb2YgZ2VuZXJhdG9yRnVuY3Rpb24gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZ2VuZXJhdG9yRnVuY3Rpb24gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICB2YXIgc3Bhd24gPSBuZXcgUHJvbWlzZVNwYXduKGdlbmVyYXRvckZ1bmN0aW9uLCB0aGlzKTtcbiAgICB2YXIgcmV0ID0gc3Bhd24ucHJvbWlzZSgpO1xuICAgIHNwYXduLl9ydW4oUHJvbWlzZS5zcGF3bik7XG4gICAgcmV0dXJuIHJldDtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBhcGlSZWplY3Rpb24sIGNhc3QsIElOVEVSTkFMKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgdHJ5Q2F0Y2gzID0gdXRpbC50cnlDYXRjaDM7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xudmFyIFBFTkRJTkcgPSB7fTtcbnZhciBFTVBUWV9BUlJBWSA9IFtdO1xuXG5mdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5KHByb21pc2VzLCBmbiwgbGltaXQsIF9maWx0ZXIpIHtcbiAgICB0aGlzLmNvbnN0cnVjdG9yJChwcm9taXNlcyk7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSBmbjtcbiAgICB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXMgPSBfZmlsdGVyID09PSBJTlRFUk5BTFxuICAgICAgICA/IG5ldyBBcnJheSh0aGlzLmxlbmd0aCgpKVxuICAgICAgICA6IG51bGw7XG4gICAgdGhpcy5fbGltaXQgPSBsaW1pdDtcbiAgICB0aGlzLl9pbkZsaWdodCA9IDA7XG4gICAgdGhpcy5fcXVldWUgPSBsaW1pdCA+PSAxID8gW10gOiBFTVBUWV9BUlJBWTtcbiAgICB0aGlzLl9pbml0JCh2b2lkIDAsIC0yKTtcbn1cbnV0aWwuaW5oZXJpdHMoTWFwcGluZ1Byb21pc2VBcnJheSwgUHJvbWlzZUFycmF5KTtcblxuTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX2luaXQgPSBmdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5JF9pbml0KCkge307XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgdmFyIHZhbHVlcyA9IHRoaXMuX3ZhbHVlcztcbiAgICBpZiAodmFsdWVzID09PSBudWxsKSByZXR1cm47XG5cbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcbiAgICB2YXIgcHJlc2VydmVkVmFsdWVzID0gdGhpcy5fcHJlc2VydmVkVmFsdWVzO1xuICAgIHZhciBsaW1pdCA9IHRoaXMuX2xpbWl0O1xuICAgIGlmICh2YWx1ZXNbaW5kZXhdID09PSBQRU5ESU5HKSB7XG4gICAgICAgIHZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICAgICAgaWYgKGxpbWl0ID49IDEpIHtcbiAgICAgICAgICAgIHRoaXMuX2luRmxpZ2h0LS07XG4gICAgICAgICAgICB0aGlzLl9kcmFpblF1ZXVlKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobGltaXQgPj0gMSAmJiB0aGlzLl9pbkZsaWdodCA+PSBsaW1pdCkge1xuICAgICAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fcXVldWUucHVzaChpbmRleCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZXNlcnZlZFZhbHVlcyAhPT0gbnVsbCkgcHJlc2VydmVkVmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuXG4gICAgICAgIHZhciBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xuICAgICAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9wcm9taXNlLl9ib3VuZFRvO1xuICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gzKGNhbGxiYWNrLCByZWNlaXZlciwgdmFsdWUsIGluZGV4LCBsZW5ndGgpO1xuICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikgcmV0dXJuIHRoaXMuX3JlamVjdChyZXQuZSk7XG5cbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmV0LCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIGlmIChsaW1pdCA+PSAxKSB0aGlzLl9pbkZsaWdodCsrO1xuICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSBQRU5ESU5HO1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXliZVByb21pc2UuX3Byb3h5UHJvbWlzZUFycmF5KHRoaXMsIGluZGV4KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF5YmVQcm9taXNlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBtYXliZVByb21pc2UudmFsdWUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdChtYXliZVByb21pc2UucmVhc29uKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhbHVlc1tpbmRleF0gPSByZXQ7XG4gICAgfVxuICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgIGlmICh0b3RhbFJlc29sdmVkID49IGxlbmd0aCkge1xuICAgICAgICBpZiAocHJlc2VydmVkVmFsdWVzICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9maWx0ZXIodmFsdWVzLCBwcmVzZXJ2ZWRWYWx1ZXMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgICB9XG5cbiAgICB9XG59O1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZHJhaW5RdWV1ZSA9XG5mdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5JF9kcmFpblF1ZXVlKCkge1xuICAgIHZhciBxdWV1ZSA9IHRoaXMuX3F1ZXVlO1xuICAgIHZhciBsaW1pdCA9IHRoaXMuX2xpbWl0O1xuICAgIHZhciB2YWx1ZXMgPSB0aGlzLl92YWx1ZXM7XG4gICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDAgJiYgdGhpcy5faW5GbGlnaHQgPCBsaW1pdCkge1xuICAgICAgICB2YXIgaW5kZXggPSBxdWV1ZS5wb3AoKTtcbiAgICAgICAgdGhpcy5fcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZXNbaW5kZXhdLCBpbmRleCk7XG4gICAgfVxufTtcblxuTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX2ZpbHRlciA9XG5mdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5JF9maWx0ZXIoYm9vbGVhbnMsIHZhbHVlcykge1xuICAgIHZhciBsZW4gPSB2YWx1ZXMubGVuZ3RoO1xuICAgIHZhciByZXQgPSBuZXcgQXJyYXkobGVuKTtcbiAgICB2YXIgaiA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICBpZiAoYm9vbGVhbnNbaV0pIHJldFtqKytdID0gdmFsdWVzW2ldO1xuICAgIH1cbiAgICByZXQubGVuZ3RoID0gajtcbiAgICB0aGlzLl9yZXNvbHZlKHJldCk7XG59O1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5wcmVzZXJ2ZWRWYWx1ZXMgPVxuZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheSRwcmVzZXJ2ZVZhbHVlcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJlc2VydmVkVmFsdWVzO1xufTtcblxuZnVuY3Rpb24gbWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgX2ZpbHRlcikge1xuICAgIHZhciBsaW1pdCA9IHR5cGVvZiBvcHRpb25zID09PSBcIm9iamVjdFwiICYmIG9wdGlvbnMgIT09IG51bGxcbiAgICAgICAgPyBvcHRpb25zLmNvbmN1cnJlbmN5XG4gICAgICAgIDogMDtcbiAgICBsaW1pdCA9IHR5cGVvZiBsaW1pdCA9PT0gXCJudW1iZXJcIiAmJlxuICAgICAgICBpc0Zpbml0ZShsaW1pdCkgJiYgbGltaXQgPj0gMSA/IGxpbWl0IDogMDtcbiAgICByZXR1cm4gbmV3IE1hcHBpbmdQcm9taXNlQXJyYXkocHJvbWlzZXMsIGZuLCBsaW1pdCwgX2ZpbHRlcik7XG59XG5cblByb21pc2UucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uIFByb21pc2UkbWFwKGZuLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuXG4gICAgcmV0dXJuIG1hcCh0aGlzLCBmbiwgb3B0aW9ucywgbnVsbCkucHJvbWlzZSgpO1xufTtcblxuUHJvbWlzZS5tYXAgPSBmdW5jdGlvbiBQcm9taXNlJE1hcChwcm9taXNlcywgZm4sIG9wdGlvbnMsIF9maWx0ZXIpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgcmV0dXJuIG1hcChwcm9taXNlcywgZm4sIG9wdGlvbnMsIF9maWx0ZXIpLnByb21pc2UoKTtcbn07XG5cblxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBhc3luYyA9IHJlcXVpcmUoXCIuL2FzeW5jLmpzXCIpO1xudmFyIHRyeUNhdGNoMiA9IHV0aWwudHJ5Q2F0Y2gyO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcblxuZnVuY3Rpb24gdGhyb3dlcihyKSB7XG4gICAgdGhyb3cgcjtcbn1cblxuZnVuY3Rpb24gUHJvbWlzZSRfc3ByZWFkQWRhcHRlcih2YWwsIHJlY2VpdmVyKSB7XG4gICAgaWYgKCF1dGlsLmlzQXJyYXkodmFsKSkgcmV0dXJuIFByb21pc2UkX3N1Y2Nlc3NBZGFwdGVyKHZhbCwgcmVjZWl2ZXIpO1xuICAgIHZhciByZXQgPSB1dGlsLnRyeUNhdGNoQXBwbHkodGhpcywgW251bGxdLmNvbmNhdCh2YWwpLCByZWNlaXZlcik7XG4gICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhyb3dlciwgdm9pZCAwLCByZXQuZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBQcm9taXNlJF9zdWNjZXNzQWRhcHRlcih2YWwsIHJlY2VpdmVyKSB7XG4gICAgdmFyIG5vZGViYWNrID0gdGhpcztcbiAgICB2YXIgcmV0ID0gdmFsID09PSB2b2lkIDBcbiAgICAgICAgPyB0cnlDYXRjaDEobm9kZWJhY2ssIHJlY2VpdmVyLCBudWxsKVxuICAgICAgICA6IHRyeUNhdGNoMihub2RlYmFjaywgcmVjZWl2ZXIsIG51bGwsIHZhbCk7XG4gICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhyb3dlciwgdm9pZCAwLCByZXQuZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gUHJvbWlzZSRfZXJyb3JBZGFwdGVyKHJlYXNvbiwgcmVjZWl2ZXIpIHtcbiAgICB2YXIgbm9kZWJhY2sgPSB0aGlzO1xuICAgIHZhciByZXQgPSB0cnlDYXRjaDEobm9kZWJhY2ssIHJlY2VpdmVyLCByZWFzb24pO1xuICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHRocm93ZXIsIHZvaWQgMCwgcmV0LmUpO1xuICAgIH1cbn1cblxuUHJvbWlzZS5wcm90b3R5cGUubm9kZWlmeSA9IGZ1bmN0aW9uIFByb21pc2Ukbm9kZWlmeShub2RlYmFjaywgb3B0aW9ucykge1xuICAgIGlmICh0eXBlb2Ygbm9kZWJhY2sgPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHZhciBhZGFwdGVyID0gUHJvbWlzZSRfc3VjY2Vzc0FkYXB0ZXI7XG4gICAgICAgIGlmIChvcHRpb25zICE9PSB2b2lkIDAgJiYgT2JqZWN0KG9wdGlvbnMpLnNwcmVhZCkge1xuICAgICAgICAgICAgYWRhcHRlciA9IFByb21pc2UkX3NwcmVhZEFkYXB0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGhlbihcbiAgICAgICAgICAgIGFkYXB0ZXIsXG4gICAgICAgICAgICBQcm9taXNlJF9lcnJvckFkYXB0ZXIsXG4gICAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgICBub2RlYmFjayxcbiAgICAgICAgICAgIHRoaXMuX2JvdW5kVG9cbiAgICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgYXBpUmVqZWN0aW9uLCBjYXN0LCBJTlRFUk5BTCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIHRyeUNhdGNoNCA9IHV0aWwudHJ5Q2F0Y2g0O1xudmFyIHRyeUNhdGNoMyA9IHV0aWwudHJ5Q2F0Y2gzO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbmZ1bmN0aW9uIFJlZHVjdGlvblByb21pc2VBcnJheShwcm9taXNlcywgZm4sIGFjY3VtLCBfZWFjaCkge1xuICAgIHRoaXMuY29uc3RydWN0b3IkKHByb21pc2VzKTtcbiAgICB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXMgPSBfZWFjaCA9PT0gSU5URVJOQUwgPyBbXSA6IG51bGw7XG4gICAgdGhpcy5femVyb3RoSXNBY2N1bSA9IChhY2N1bSA9PT0gdm9pZCAwKTtcbiAgICB0aGlzLl9nb3RBY2N1bSA9IGZhbHNlO1xuICAgIHRoaXMuX3JlZHVjaW5nSW5kZXggPSAodGhpcy5femVyb3RoSXNBY2N1bSA/IDEgOiAwKTtcbiAgICB0aGlzLl92YWx1ZXNQaGFzZSA9IHVuZGVmaW5lZDtcblxuICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KGFjY3VtLCB2b2lkIDApO1xuICAgIHZhciByZWplY3RlZCA9IGZhbHNlO1xuICAgIHZhciBpc1Byb21pc2UgPSBtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlO1xuICAgIGlmIChpc1Byb21pc2UpIHtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCAtMSk7XG4gICAgICAgIH0gZWxzZSBpZiAobWF5YmVQcm9taXNlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgIGFjY3VtID0gbWF5YmVQcm9taXNlLnZhbHVlKCk7XG4gICAgICAgICAgICB0aGlzLl9nb3RBY2N1bSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgIHRoaXMuX3JlamVjdChtYXliZVByb21pc2UucmVhc29uKCkpO1xuICAgICAgICAgICAgcmVqZWN0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghKGlzUHJvbWlzZSB8fCB0aGlzLl96ZXJvdGhJc0FjY3VtKSkgdGhpcy5fZ290QWNjdW0gPSB0cnVlO1xuICAgIHRoaXMuX2NhbGxiYWNrID0gZm47XG4gICAgdGhpcy5fYWNjdW0gPSBhY2N1bTtcbiAgICBpZiAoIXJlamVjdGVkKSB0aGlzLl9pbml0JCh2b2lkIDAsIC01KTtcbn1cbnV0aWwuaW5oZXJpdHMoUmVkdWN0aW9uUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuXG5SZWR1Y3Rpb25Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID1cbmZ1bmN0aW9uIFJlZHVjdGlvblByb21pc2VBcnJheSRfaW5pdCgpIHt9O1xuXG5SZWR1Y3Rpb25Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZXNvbHZlRW1wdHlBcnJheSA9XG5mdW5jdGlvbiBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkkX3Jlc29sdmVFbXB0eUFycmF5KCkge1xuICAgIGlmICh0aGlzLl9nb3RBY2N1bSB8fCB0aGlzLl96ZXJvdGhJc0FjY3VtKSB7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fcHJlc2VydmVkVmFsdWVzICE9PSBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFtdIDogdGhpcy5fYWNjdW0pO1xuICAgIH1cbn07XG5cblJlZHVjdGlvblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gUmVkdWN0aW9uUHJvbWlzZUFycmF5JF9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBpbmRleCkge1xuICAgIHZhciB2YWx1ZXMgPSB0aGlzLl92YWx1ZXM7XG4gICAgaWYgKHZhbHVlcyA9PT0gbnVsbCkgcmV0dXJuO1xuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgIHZhciBwcmVzZXJ2ZWRWYWx1ZXMgPSB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXM7XG4gICAgdmFyIGlzRWFjaCA9IHByZXNlcnZlZFZhbHVlcyAhPT0gbnVsbDtcbiAgICB2YXIgZ290QWNjdW0gPSB0aGlzLl9nb3RBY2N1bTtcbiAgICB2YXIgdmFsdWVzUGhhc2UgPSB0aGlzLl92YWx1ZXNQaGFzZTtcbiAgICB2YXIgdmFsdWVzUGhhc2VJbmRleDtcbiAgICBpZiAoIXZhbHVlc1BoYXNlKSB7XG4gICAgICAgIHZhbHVlc1BoYXNlID0gdGhpcy5fdmFsdWVzUGhhc2UgPSBBcnJheShsZW5ndGgpO1xuICAgICAgICBmb3IgKHZhbHVlc1BoYXNlSW5kZXg9MDsgdmFsdWVzUGhhc2VJbmRleDxsZW5ndGg7ICsrdmFsdWVzUGhhc2VJbmRleCkge1xuICAgICAgICAgICAgdmFsdWVzUGhhc2VbdmFsdWVzUGhhc2VJbmRleF0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhbHVlc1BoYXNlSW5kZXggPSB2YWx1ZXNQaGFzZVtpbmRleF07XG5cbiAgICBpZiAoaW5kZXggPT09IDAgJiYgdGhpcy5femVyb3RoSXNBY2N1bSkge1xuICAgICAgICBpZiAoIWdvdEFjY3VtKSB7XG4gICAgICAgICAgICB0aGlzLl9hY2N1bSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fZ290QWNjdW0gPSBnb3RBY2N1bSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWVzUGhhc2VbaW5kZXhdID0gKCh2YWx1ZXNQaGFzZUluZGV4ID09PSAwKVxuICAgICAgICAgICAgPyAxIDogMik7XG4gICAgfSBlbHNlIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKCFnb3RBY2N1bSkge1xuICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gZ290QWNjdW0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHZhbHVlc1BoYXNlSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHZhbHVlc1BoYXNlW2luZGV4XSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZXNQaGFzZVtpbmRleF0gPSAyO1xuICAgICAgICAgICAgaWYgKGdvdEFjY3VtKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWNjdW0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWdvdEFjY3VtKSByZXR1cm47XG5cbiAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjaztcbiAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9wcm9taXNlLl9ib3VuZFRvO1xuICAgIHZhciByZXQ7XG5cbiAgICBmb3IgKHZhciBpID0gdGhpcy5fcmVkdWNpbmdJbmRleDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhbHVlc1BoYXNlSW5kZXggPSB2YWx1ZXNQaGFzZVtpXTtcbiAgICAgICAgaWYgKHZhbHVlc1BoYXNlSW5kZXggPT09IDIpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZHVjaW5nSW5kZXggPSBpICsgMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZXNQaGFzZUluZGV4ICE9PSAxKSByZXR1cm47XG5cbiAgICAgICAgdmFsdWUgPSB2YWx1ZXNbaV07XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5fc2V0dGxlZFZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWUuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0KHZhbHVlLnJlYXNvbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0VhY2gpIHtcbiAgICAgICAgICAgIHByZXNlcnZlZFZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHJldCA9IHRyeUNhdGNoMyhjYWxsYmFjaywgcmVjZWl2ZXIsIHZhbHVlLCBpLCBsZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gdHJ5Q2F0Y2g0KGNhbGxiYWNrLCByZWNlaXZlciwgdGhpcy5fYWNjdW0sIHZhbHVlLCBpLCBsZW5ndGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHJldHVybiB0aGlzLl9yZWplY3QocmV0LmUpO1xuXG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJldCwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZXNQaGFzZVtpXSA9IDQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZS5fcHJveHlQcm9taXNlQXJyYXkodGhpcywgaSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1heWJlUHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gbWF5YmVQcm9taXNlLnZhbHVlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3QobWF5YmVQcm9taXNlLnJlYXNvbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3JlZHVjaW5nSW5kZXggPSBpICsgMTtcbiAgICAgICAgdGhpcy5fYWNjdW0gPSByZXQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3JlZHVjaW5nSW5kZXggPCBsZW5ndGgpIHJldHVybjtcbiAgICB0aGlzLl9yZXNvbHZlKGlzRWFjaCA/IHByZXNlcnZlZFZhbHVlcyA6IHRoaXMuX2FjY3VtKTtcbn07XG5cbmZ1bmN0aW9uIHJlZHVjZShwcm9taXNlcywgZm4sIGluaXRpYWxWYWx1ZSwgX2VhY2gpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgdmFyIGFycmF5ID0gbmV3IFJlZHVjdGlvblByb21pc2VBcnJheShwcm9taXNlcywgZm4sIGluaXRpYWxWYWx1ZSwgX2VhY2gpO1xuICAgIHJldHVybiBhcnJheS5wcm9taXNlKCk7XG59XG5cblByb21pc2UucHJvdG90eXBlLnJlZHVjZSA9IGZ1bmN0aW9uIFByb21pc2UkcmVkdWNlKGZuLCBpbml0aWFsVmFsdWUpIHtcbiAgICByZXR1cm4gcmVkdWNlKHRoaXMsIGZuLCBpbml0aWFsVmFsdWUsIG51bGwpO1xufTtcblxuUHJvbWlzZS5yZWR1Y2UgPSBmdW5jdGlvbiBQcm9taXNlJFJlZHVjZShwcm9taXNlcywgZm4sIGluaXRpYWxWYWx1ZSwgX2VhY2gpIHtcbiAgICByZXR1cm4gcmVkdWNlKHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9XG4gICAgZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5KSB7XG52YXIgUHJvbWlzZUluc3BlY3Rpb24gPSBQcm9taXNlLlByb21pc2VJbnNwZWN0aW9uO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xuXG5mdW5jdGlvbiBTZXR0bGVkUHJvbWlzZUFycmF5KHZhbHVlcykge1xuICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG59XG51dGlsLmluaGVyaXRzKFNldHRsZWRQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVzb2x2ZWQgPVxuZnVuY3Rpb24gU2V0dGxlZFByb21pc2VBcnJheSRfcHJvbWlzZVJlc29sdmVkKGluZGV4LCBpbnNwZWN0aW9uKSB7XG4gICAgdGhpcy5fdmFsdWVzW2luZGV4XSA9IGluc3BlY3Rpb247XG4gICAgdmFyIHRvdGFsUmVzb2x2ZWQgPSArK3RoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgaWYgKHRvdGFsUmVzb2x2ZWQgPj0gdGhpcy5fbGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzKTtcbiAgICB9XG59O1xuXG5TZXR0bGVkUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBTZXR0bGVkUHJvbWlzZUFycmF5JF9wcm9taXNlRnVsZmlsbGVkKHZhbHVlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2VJbnNwZWN0aW9uKCk7XG4gICAgcmV0Ll9iaXRGaWVsZCA9IDI2ODQzNTQ1NjtcbiAgICByZXQuX3NldHRsZWRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuX3Byb21pc2VSZXNvbHZlZChpbmRleCwgcmV0KTtcbn07XG5TZXR0bGVkUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVJlamVjdGVkID1cbmZ1bmN0aW9uIFNldHRsZWRQcm9taXNlQXJyYXkkX3Byb21pc2VSZWplY3RlZChyZWFzb24sIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZUluc3BlY3Rpb24oKTtcbiAgICByZXQuX2JpdEZpZWxkID0gMTM0MjE3NzI4O1xuICAgIHJldC5fc2V0dGxlZFZhbHVlID0gcmVhc29uO1xuICAgIHRoaXMuX3Byb21pc2VSZXNvbHZlZChpbmRleCwgcmV0KTtcbn07XG5cblByb21pc2Uuc2V0dGxlID0gZnVuY3Rpb24gUHJvbWlzZSRTZXR0bGUocHJvbWlzZXMpIHtcbiAgICByZXR1cm4gbmV3IFNldHRsZWRQcm9taXNlQXJyYXkocHJvbWlzZXMpLnByb21pc2UoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnNldHRsZSA9IGZ1bmN0aW9uIFByb21pc2Ukc2V0dGxlKCkge1xuICAgIHJldHVybiBuZXcgU2V0dGxlZFByb21pc2VBcnJheSh0aGlzKS5wcm9taXNlKCk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9XG5mdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGFwaVJlamVjdGlvbikge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIFJhbmdlRXJyb3IgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIikuUmFuZ2VFcnJvcjtcbnZhciBBZ2dyZWdhdGVFcnJvciA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5BZ2dyZWdhdGVFcnJvcjtcbnZhciBpc0FycmF5ID0gdXRpbC5pc0FycmF5O1xuXG5cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkodmFsdWVzKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQodmFsdWVzKTtcbiAgICB0aGlzLl9ob3dNYW55ID0gMDtcbiAgICB0aGlzLl91bndyYXAgPSBmYWxzZTtcbiAgICB0aGlzLl9pbml0aWFsaXplZCA9IGZhbHNlO1xufVxudXRpbC5pbmhlcml0cyhTb21lUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2luaXQoKSB7XG4gICAgaWYgKCF0aGlzLl9pbml0aWFsaXplZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLl9ob3dNYW55ID09PSAwKSB7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUoW10pO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2luaXQkKHZvaWQgMCwgLTUpO1xuICAgIHZhciBpc0FycmF5UmVzb2x2ZWQgPSBpc0FycmF5KHRoaXMuX3ZhbHVlcyk7XG4gICAgaWYgKCF0aGlzLl9pc1Jlc29sdmVkKCkgJiZcbiAgICAgICAgaXNBcnJheVJlc29sdmVkICYmXG4gICAgICAgIHRoaXMuX2hvd01hbnkgPiB0aGlzLl9jYW5Qb3NzaWJseUZ1bGZpbGwoKSkge1xuICAgICAgICB0aGlzLl9yZWplY3QodGhpcy5fZ2V0UmFuZ2VFcnJvcih0aGlzLmxlbmd0aCgpKSk7XG4gICAgfVxufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkaW5pdCgpIHtcbiAgICB0aGlzLl9pbml0aWFsaXplZCA9IHRydWU7XG4gICAgdGhpcy5faW5pdCgpO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuc2V0VW53cmFwID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRzZXRVbndyYXAoKSB7XG4gICAgdGhpcy5fdW53cmFwID0gdHJ1ZTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLmhvd01hbnkgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JGhvd01hbnkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2hvd01hbnk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zZXRIb3dNYW55ID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkc2V0SG93TWFueShjb3VudCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9ob3dNYW55ID0gY291bnQ7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9wcm9taXNlRnVsZmlsbGVkKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX2FkZEZ1bGZpbGxlZCh2YWx1ZSk7XG4gICAgaWYgKHRoaXMuX2Z1bGZpbGxlZCgpID09PSB0aGlzLmhvd01hbnkoKSkge1xuICAgICAgICB0aGlzLl92YWx1ZXMubGVuZ3RoID0gdGhpcy5ob3dNYW55KCk7XG4gICAgICAgIGlmICh0aGlzLmhvd01hbnkoKSA9PT0gMSAmJiB0aGlzLl91bndyYXApIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzWzBdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUodGhpcy5fdmFsdWVzKTtcbiAgICAgICAgfVxuICAgIH1cblxufTtcblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfcHJvbWlzZVJlamVjdGVkKHJlYXNvbikge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9hZGRSZWplY3RlZChyZWFzb24pO1xuICAgIGlmICh0aGlzLmhvd01hbnkoKSA+IHRoaXMuX2NhblBvc3NpYmx5RnVsZmlsbCgpKSB7XG4gICAgICAgIHZhciBlID0gbmV3IEFnZ3JlZ2F0ZUVycm9yKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmxlbmd0aCgpOyBpIDwgdGhpcy5fdmFsdWVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBlLnB1c2godGhpcy5fdmFsdWVzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZWplY3QoZSk7XG4gICAgfVxufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2Z1bGZpbGxlZCA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2Z1bGZpbGxlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdG90YWxSZXNvbHZlZDtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZWplY3RlZCA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX3JlamVjdGVkKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZXMubGVuZ3RoIC0gdGhpcy5sZW5ndGgoKTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9hZGRSZWplY3RlZCA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9hZGRSZWplY3RlZChyZWFzb24pIHtcbiAgICB0aGlzLl92YWx1ZXMucHVzaChyZWFzb24pO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2FkZEZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9hZGRGdWxmaWxsZWQodmFsdWUpIHtcbiAgICB0aGlzLl92YWx1ZXNbdGhpcy5fdG90YWxSZXNvbHZlZCsrXSA9IHZhbHVlO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2NhblBvc3NpYmx5RnVsZmlsbCA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9jYW5Qb3NzaWJseUZ1bGZpbGwoKSB7XG4gICAgcmV0dXJuIHRoaXMubGVuZ3RoKCkgLSB0aGlzLl9yZWplY3RlZCgpO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2dldFJhbmdlRXJyb3IgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfZ2V0UmFuZ2VFcnJvcihjb3VudCkge1xuICAgIHZhciBtZXNzYWdlID0gXCJJbnB1dCBhcnJheSBtdXN0IGNvbnRhaW4gYXQgbGVhc3QgXCIgK1xuICAgICAgICAgICAgdGhpcy5faG93TWFueSArIFwiIGl0ZW1zIGJ1dCBjb250YWlucyBvbmx5IFwiICsgY291bnQgKyBcIiBpdGVtc1wiO1xuICAgIHJldHVybiBuZXcgUmFuZ2VFcnJvcihtZXNzYWdlKTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZXNvbHZlRW1wdHlBcnJheSA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9yZXNvbHZlRW1wdHlBcnJheSgpIHtcbiAgICB0aGlzLl9yZWplY3QodGhpcy5fZ2V0UmFuZ2VFcnJvcigwKSk7XG59O1xuXG5mdW5jdGlvbiBQcm9taXNlJF9Tb21lKHByb21pc2VzLCBob3dNYW55KSB7XG4gICAgaWYgKChob3dNYW55IHwgMCkgIT09IGhvd01hbnkgfHwgaG93TWFueSA8IDApIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImV4cGVjdGluZyBhIHBvc2l0aXZlIGludGVnZXJcIik7XG4gICAgfVxuICAgIHZhciByZXQgPSBuZXcgU29tZVByb21pc2VBcnJheShwcm9taXNlcyk7XG4gICAgdmFyIHByb21pc2UgPSByZXQucHJvbWlzZSgpO1xuICAgIGlmIChwcm9taXNlLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9XG4gICAgcmV0LnNldEhvd01hbnkoaG93TWFueSk7XG4gICAgcmV0LmluaXQoKTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cblxuUHJvbWlzZS5zb21lID0gZnVuY3Rpb24gUHJvbWlzZSRTb21lKHByb21pc2VzLCBob3dNYW55KSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1NvbWUocHJvbWlzZXMsIGhvd01hbnkpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuc29tZSA9IGZ1bmN0aW9uIFByb21pc2Ukc29tZShob3dNYW55KSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1NvbWUodGhpcywgaG93TWFueSk7XG59O1xuXG5Qcm9taXNlLl9Tb21lUHJvbWlzZUFycmF5ID0gU29tZVByb21pc2VBcnJheTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXkpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBhc3luYyA9IHJlcXVpcmUoXCIuL2FzeW5jLmpzXCIpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciB0cnlDYXRjaDEgPSB1dGlsLnRyeUNhdGNoMTtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG5cblByb21pc2UucHJvdG90eXBlLnByb2dyZXNzZWQgPSBmdW5jdGlvbiBQcm9taXNlJHByb2dyZXNzZWQoaGFuZGxlcikge1xuICAgIHJldHVybiB0aGlzLl90aGVuKHZvaWQgMCwgdm9pZCAwLCBoYW5kbGVyLCB2b2lkIDAsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvZ3Jlc3MgPSBmdW5jdGlvbiBQcm9taXNlJF9wcm9ncmVzcyhwcm9ncmVzc1ZhbHVlKSB7XG4gICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9wcm9ncmVzc1VuY2hlY2tlZChwcm9ncmVzc1ZhbHVlKTtcblxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb2dyZXNzSGFuZGxlckF0ID1cbmZ1bmN0aW9uIFByb21pc2UkX3Byb2dyZXNzSGFuZGxlckF0KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fcHJvZ3Jlc3NIYW5kbGVyMFxuICAgICAgICA6IHRoaXNbKGluZGV4IDw8IDIpICsgaW5kZXggLSA1ICsgMl07XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZG9Qcm9ncmVzc1dpdGggPVxuZnVuY3Rpb24gUHJvbWlzZSRfZG9Qcm9ncmVzc1dpdGgocHJvZ3Jlc3Npb24pIHtcbiAgICB2YXIgcHJvZ3Jlc3NWYWx1ZSA9IHByb2dyZXNzaW9uLnZhbHVlO1xuICAgIHZhciBoYW5kbGVyID0gcHJvZ3Jlc3Npb24uaGFuZGxlcjtcbiAgICB2YXIgcHJvbWlzZSA9IHByb2dyZXNzaW9uLnByb21pc2U7XG4gICAgdmFyIHJlY2VpdmVyID0gcHJvZ3Jlc3Npb24ucmVjZWl2ZXI7XG5cbiAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gxKGhhbmRsZXIsIHJlY2VpdmVyLCBwcm9ncmVzc1ZhbHVlKTtcbiAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICBpZiAocmV0LmUgIT0gbnVsbCAmJlxuICAgICAgICAgICAgcmV0LmUubmFtZSAhPT0gXCJTdG9wUHJvZ3Jlc3NQcm9wYWdhdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKHJldC5lKVxuICAgICAgICAgICAgICAgID8gcmV0LmUgOiBuZXcgRXJyb3IocmV0LmUgKyBcIlwiKTtcbiAgICAgICAgICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICAgICAgcHJvbWlzZS5fcHJvZ3Jlc3MocmV0LmUpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChyZXQgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHJldC5fdGhlbihwcm9taXNlLl9wcm9ncmVzcywgbnVsbCwgbnVsbCwgcHJvbWlzZSwgdm9pZCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwcm9taXNlLl9wcm9ncmVzcyhyZXQpO1xuICAgIH1cbn07XG5cblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb2dyZXNzVW5jaGVja2VkID1cbmZ1bmN0aW9uIFByb21pc2UkX3Byb2dyZXNzVW5jaGVja2VkKHByb2dyZXNzVmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuaXNQZW5kaW5nKCkpIHJldHVybjtcbiAgICB2YXIgbGVuID0gdGhpcy5fbGVuZ3RoKCk7XG4gICAgdmFyIHByb2dyZXNzID0gdGhpcy5fcHJvZ3Jlc3M7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX3Byb2dyZXNzSGFuZGxlckF0KGkpO1xuICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2VBdChpKTtcbiAgICAgICAgaWYgKCEocHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgICAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9yZWNlaXZlckF0KGkpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVyLmNhbGwocmVjZWl2ZXIsIHByb2dyZXNzVmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2UgJiYgcmVjZWl2ZXIuX2lzUHJveGllZCgpKSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIuX3Byb2dyZXNzVW5jaGVja2VkKHByb2dyZXNzVmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNlaXZlciBpbnN0YW5jZW9mIFByb21pc2VBcnJheSkge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVyLl9wcm9taXNlUHJvZ3Jlc3NlZChwcm9ncmVzc1ZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGFzeW5jLmludm9rZSh0aGlzLl9kb1Byb2dyZXNzV2l0aCwgdGhpcywge1xuICAgICAgICAgICAgICAgIGhhbmRsZXI6IGhhbmRsZXIsXG4gICAgICAgICAgICAgICAgcHJvbWlzZTogcHJvbWlzZSxcbiAgICAgICAgICAgICAgICByZWNlaXZlcjogdGhpcy5fcmVjZWl2ZXJBdChpKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogcHJvZ3Jlc3NWYWx1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhc3luYy5pbnZva2UocHJvZ3Jlc3MsIHByb21pc2UsIHByb2dyZXNzVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCkge1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciBjYW5BdHRhY2ggPSBlcnJvcnMuY2FuQXR0YWNoO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgQ2FuY2VsbGF0aW9uRXJyb3IgPSBlcnJvcnMuQ2FuY2VsbGF0aW9uRXJyb3I7XG5cblByb21pc2UucHJvdG90eXBlLl9jYW5jZWwgPSBmdW5jdGlvbiBQcm9taXNlJF9jYW5jZWwocmVhc29uKSB7XG4gICAgaWYgKCF0aGlzLmlzQ2FuY2VsbGFibGUoKSkgcmV0dXJuIHRoaXM7XG4gICAgdmFyIHBhcmVudDtcbiAgICB2YXIgcHJvbWlzZVRvUmVqZWN0ID0gdGhpcztcbiAgICB3aGlsZSAoKHBhcmVudCA9IHByb21pc2VUb1JlamVjdC5fY2FuY2VsbGF0aW9uUGFyZW50KSAhPT0gdm9pZCAwICYmXG4gICAgICAgIHBhcmVudC5pc0NhbmNlbGxhYmxlKCkpIHtcbiAgICAgICAgcHJvbWlzZVRvUmVqZWN0ID0gcGFyZW50O1xuICAgIH1cbiAgICBwcm9taXNlVG9SZWplY3QuX2F0dGFjaEV4dHJhVHJhY2UocmVhc29uKTtcbiAgICBwcm9taXNlVG9SZWplY3QuX3JlamVjdFVuY2hlY2tlZChyZWFzb24pO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gUHJvbWlzZSRjYW5jZWwocmVhc29uKSB7XG4gICAgaWYgKCF0aGlzLmlzQ2FuY2VsbGFibGUoKSkgcmV0dXJuIHRoaXM7XG4gICAgcmVhc29uID0gcmVhc29uICE9PSB2b2lkIDBcbiAgICAgICAgPyAoY2FuQXR0YWNoKHJlYXNvbikgPyByZWFzb24gOiBuZXcgRXJyb3IocmVhc29uICsgXCJcIikpXG4gICAgICAgIDogbmV3IENhbmNlbGxhdGlvbkVycm9yKCk7XG4gICAgYXN5bmMuaW52b2tlTGF0ZXIodGhpcy5fY2FuY2VsLCB0aGlzLCByZWFzb24pO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuY2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJGNhbmNlbGxhYmxlKCkge1xuICAgIGlmICh0aGlzLl9jYW5jZWxsYWJsZSgpKSByZXR1cm4gdGhpcztcbiAgICB0aGlzLl9zZXRDYW5jZWxsYWJsZSgpO1xuICAgIHRoaXMuX2NhbmNlbGxhdGlvblBhcmVudCA9IHZvaWQgMDtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cblByb21pc2UucHJvdG90eXBlLnVuY2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJHVuY2FuY2VsbGFibGUoKSB7XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX3Byb3BhZ2F0ZUZyb20odGhpcywgMiB8IDQpO1xuICAgIHJldC5fZm9sbG93KHRoaXMpO1xuICAgIHJldC5fdW5zZXRDYW5jZWxsYWJsZSgpO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5mb3JrID1cbmZ1bmN0aW9uIFByb21pc2UkZm9yayhkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzKSB7XG4gICAgdmFyIHJldCA9IHRoaXMuX3RoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIDAsIHZvaWQgMCk7XG5cbiAgICByZXQuX3NldENhbmNlbGxhYmxlKCk7XG4gICAgcmV0Ll9jYW5jZWxsYXRpb25QYXJlbnQgPSB2b2lkIDA7XG4gICAgcmV0dXJuIHJldDtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKFByb21pc2UsIGFwaVJlamVjdGlvbiwgY2FzdCkge1xuICAgIHZhciBUeXBlRXJyb3IgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIikuVHlwZUVycm9yO1xuICAgIHZhciBpbmhlcml0cyA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikuaW5oZXJpdHM7XG4gICAgdmFyIFByb21pc2VJbnNwZWN0aW9uID0gUHJvbWlzZS5Qcm9taXNlSW5zcGVjdGlvbjtcblxuICAgIGZ1bmN0aW9uIGluc3BlY3Rpb25NYXBwZXIoaW5zcGVjdGlvbnMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGluc3BlY3Rpb25zLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgdmFyIGluc3BlY3Rpb24gPSBpbnNwZWN0aW9uc1tpXTtcbiAgICAgICAgICAgIGlmIChpbnNwZWN0aW9uLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChpbnNwZWN0aW9uLmVycm9yKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5zcGVjdGlvbnNbaV0gPSBpbnNwZWN0aW9uLnZhbHVlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluc3BlY3Rpb25zO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRocm93ZXIoZSkge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgZTt9LCAwKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwb3NlKHJlc291cmNlcywgaW5zcGVjdGlvbikge1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciBsZW4gPSByZXNvdXJjZXMubGVuZ3RoO1xuICAgICAgICB2YXIgcmV0ID0gUHJvbWlzZS5kZWZlcigpO1xuICAgICAgICBmdW5jdGlvbiBpdGVyYXRvcigpIHtcbiAgICAgICAgICAgIGlmIChpID49IGxlbikgcmV0dXJuIHJldC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXNvdXJjZXNbaSsrXSwgdm9pZCAwKTtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlICYmXG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl9pc0Rpc3Bvc2FibGUoKSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZSA9IGNhc3QobWF5YmVQcm9taXNlLl9nZXREaXNwb3NlcigpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRyeURpc3Bvc2UoaW5zcGVjdGlvbiksIHZvaWQgMCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhyb3dlcihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZS5fdGhlbihpdGVyYXRvciwgdGhyb3dlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsLCBudWxsLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpdGVyYXRvcigpO1xuICAgICAgICB9XG4gICAgICAgIGl0ZXJhdG9yKCk7XG4gICAgICAgIHJldHVybiByZXQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwb3NlclN1Y2Nlc3ModmFsdWUpIHtcbiAgICAgICAgdmFyIGluc3BlY3Rpb24gPSBuZXcgUHJvbWlzZUluc3BlY3Rpb24oKTtcbiAgICAgICAgaW5zcGVjdGlvbi5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgICAgIGluc3BlY3Rpb24uX2JpdEZpZWxkID0gMjY4NDM1NDU2O1xuICAgICAgICByZXR1cm4gZGlzcG9zZSh0aGlzLCBpbnNwZWN0aW9uKS50aGVuUmV0dXJuKHZhbHVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkaXNwb3NlckZhaWwocmVhc29uKSB7XG4gICAgICAgIHZhciBpbnNwZWN0aW9uID0gbmV3IFByb21pc2VJbnNwZWN0aW9uKCk7XG4gICAgICAgIGluc3BlY3Rpb24uX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcbiAgICAgICAgaW5zcGVjdGlvbi5fYml0RmllbGQgPSAxMzQyMTc3Mjg7XG4gICAgICAgIHJldHVybiBkaXNwb3NlKHRoaXMsIGluc3BlY3Rpb24pLnRoZW5UaHJvdyhyZWFzb24pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIERpc3Bvc2VyKGRhdGEsIHByb21pc2UpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgICAgIHRoaXMuX3Byb21pc2UgPSBwcm9taXNlO1xuICAgIH1cblxuICAgIERpc3Bvc2VyLnByb3RvdHlwZS5kYXRhID0gZnVuY3Rpb24gRGlzcG9zZXIkZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gICAgfTtcblxuICAgIERpc3Bvc2VyLnByb3RvdHlwZS5wcm9taXNlID0gZnVuY3Rpb24gRGlzcG9zZXIkcHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XG4gICAgfTtcblxuICAgIERpc3Bvc2VyLnByb3RvdHlwZS5yZXNvdXJjZSA9IGZ1bmN0aW9uIERpc3Bvc2VyJHJlc291cmNlKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9taXNlKCkuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZSgpLnZhbHVlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcblxuICAgIERpc3Bvc2VyLnByb3RvdHlwZS50cnlEaXNwb3NlID0gZnVuY3Rpb24oaW5zcGVjdGlvbikge1xuICAgICAgICB2YXIgcmVzb3VyY2UgPSB0aGlzLnJlc291cmNlKCk7XG4gICAgICAgIHZhciByZXQgPSByZXNvdXJjZSAhPT0gbnVsbFxuICAgICAgICAgICAgPyB0aGlzLmRvRGlzcG9zZShyZXNvdXJjZSwgaW5zcGVjdGlvbikgOiBudWxsO1xuICAgICAgICB0aGlzLl9wcm9taXNlLl91bnNldERpc3Bvc2FibGUoKTtcbiAgICAgICAgdGhpcy5fZGF0YSA9IHRoaXMuX3Byb21pc2UgPSBudWxsO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBGdW5jdGlvbkRpc3Bvc2VyKGZuLCBwcm9taXNlKSB7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IkKGZuLCBwcm9taXNlKTtcbiAgICB9XG4gICAgaW5oZXJpdHMoRnVuY3Rpb25EaXNwb3NlciwgRGlzcG9zZXIpO1xuXG4gICAgRnVuY3Rpb25EaXNwb3Nlci5wcm90b3R5cGUuZG9EaXNwb3NlID0gZnVuY3Rpb24gKHJlc291cmNlLCBpbnNwZWN0aW9uKSB7XG4gICAgICAgIHZhciBmbiA9IHRoaXMuZGF0YSgpO1xuICAgICAgICByZXR1cm4gZm4uY2FsbChyZXNvdXJjZSwgcmVzb3VyY2UsIGluc3BlY3Rpb24pO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnVzaW5nID0gZnVuY3Rpb24gUHJvbWlzZSR1c2luZygpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPCAyKSByZXR1cm4gYXBpUmVqZWN0aW9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ5b3UgbXVzdCBwYXNzIGF0IGxlYXN0IDIgYXJndW1lbnRzIHRvIFByb21pc2UudXNpbmdcIik7XG4gICAgICAgIHZhciBmbiA9IGFyZ3VtZW50c1tsZW4gLSAxXTtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgICAgICBsZW4tLTtcbiAgICAgICAgdmFyIHJlc291cmNlcyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICB2YXIgcmVzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBpZiAocmVzb3VyY2UgaW5zdGFuY2VvZiBEaXNwb3Nlcikge1xuICAgICAgICAgICAgICAgIHZhciBkaXNwb3NlciA9IHJlc291cmNlO1xuICAgICAgICAgICAgICAgIHJlc291cmNlID0gcmVzb3VyY2UucHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIHJlc291cmNlLl9zZXREaXNwb3NhYmxlKGRpc3Bvc2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc291cmNlc1tpXSA9IHJlc291cmNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2Uuc2V0dGxlKHJlc291cmNlcylcbiAgICAgICAgICAgIC50aGVuKGluc3BlY3Rpb25NYXBwZXIpXG4gICAgICAgICAgICAuc3ByZWFkKGZuKVxuICAgICAgICAgICAgLl90aGVuKGRpc3Bvc2VyU3VjY2VzcywgZGlzcG9zZXJGYWlsLCB2b2lkIDAsIHJlc291cmNlcywgdm9pZCAwKTtcbiAgICB9O1xuXG4gICAgUHJvbWlzZS5wcm90b3R5cGUuX3NldERpc3Bvc2FibGUgPVxuICAgIGZ1bmN0aW9uIFByb21pc2UkX3NldERpc3Bvc2FibGUoZGlzcG9zZXIpIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDI2MjE0NDtcbiAgICAgICAgdGhpcy5fZGlzcG9zZXIgPSBkaXNwb3NlcjtcbiAgICB9O1xuXG4gICAgUHJvbWlzZS5wcm90b3R5cGUuX2lzRGlzcG9zYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkX2lzRGlzcG9zYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDI2MjE0NCkgPiAwO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5fZ2V0RGlzcG9zZXIgPSBmdW5jdGlvbiBQcm9taXNlJF9nZXREaXNwb3NlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc3Bvc2VyO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5fdW5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXREaXNwb3NhYmxlKCkge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4yNjIxNDQpO1xuICAgICAgICB0aGlzLl9kaXNwb3NlciA9IHZvaWQgMDtcbiAgICB9O1xuXG4gICAgUHJvbWlzZS5wcm90b3R5cGUuZGlzcG9zZXIgPSBmdW5jdGlvbiBQcm9taXNlJGRpc3Bvc2VyKGZuKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBGdW5jdGlvbkRpc3Bvc2VyKGZuLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XG4gICAgfTtcblxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciBUeXBlRXJyb3IgPSByZXF1aXJlKCcuL2Vycm9ycy5qcycpLlR5cGVFcnJvcjtcblxuZnVuY3Rpb24gYXBpUmVqZWN0aW9uKG1zZykge1xuICAgIHZhciBlcnJvciA9IG5ldyBUeXBlRXJyb3IobXNnKTtcbiAgICB2YXIgcmV0ID0gUHJvbWlzZS5yZWplY3RlZChlcnJvcik7XG4gICAgdmFyIHBhcmVudCA9IHJldC5fcGVla0NvbnRleHQoKTtcbiAgICBpZiAocGFyZW50ICE9IG51bGwpIHtcbiAgICAgICAgcGFyZW50Ll9hdHRhY2hFeHRyYVRyYWNlKGVycm9yKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxucmV0dXJuIGFwaVJlamVjdGlvbjtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIF9zZXRUaW1lb3V0ID0gZnVuY3Rpb24oZm4sIG1zKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgdmFyIGFyZzAgPSBhcmd1bWVudHNbMl07XG4gICAgdmFyIGFyZzEgPSBhcmd1bWVudHNbM107XG4gICAgdmFyIGFyZzIgPSBsZW4gPj0gNSA/IGFyZ3VtZW50c1s0XSA6IHZvaWQgMDtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBmbihhcmcwLCBhcmcxLCBhcmcyKTtcbiAgICB9LCBtcyk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMLCBjYXN0KSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIGFwaVJlamVjdGlvbiA9IHJlcXVpcmUoXCIuL2Vycm9yc19hcGlfcmVqZWN0aW9uXCIpKFByb21pc2UpO1xudmFyIFRpbWVvdXRFcnJvciA9IFByb21pc2UuVGltZW91dEVycm9yO1xuXG52YXIgYWZ0ZXJUaW1lb3V0ID0gZnVuY3Rpb24gUHJvbWlzZSRfYWZ0ZXJUaW1lb3V0KHByb21pc2UsIG1lc3NhZ2UsIG1zKSB7XG4gICAgaWYgKCFwcm9taXNlLmlzUGVuZGluZygpKSByZXR1cm47XG4gICAgaWYgKHR5cGVvZiBtZXNzYWdlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG1lc3NhZ2UgPSBcIm9wZXJhdGlvbiB0aW1lZCBvdXQgYWZ0ZXJcIiArIFwiIFwiICsgbXMgKyBcIiBtc1wiXG4gICAgfVxuICAgIHZhciBlcnIgPSBuZXcgVGltZW91dEVycm9yKG1lc3NhZ2UpO1xuICAgIGVycm9ycy5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24oZXJyKTtcbiAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKGVycik7XG4gICAgcHJvbWlzZS5fY2FuY2VsKGVycik7XG59O1xuXG52YXIgYWZ0ZXJEZWxheSA9IGZ1bmN0aW9uIFByb21pc2UkX2FmdGVyRGVsYXkodmFsdWUsIHByb21pc2UpIHtcbiAgICBwcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbn07XG5cbnZhciBkZWxheSA9IFByb21pc2UuZGVsYXkgPSBmdW5jdGlvbiBQcm9taXNlJERlbGF5KHZhbHVlLCBtcykge1xuICAgIGlmIChtcyA9PT0gdm9pZCAwKSB7XG4gICAgICAgIG1zID0gdmFsdWU7XG4gICAgICAgIHZhbHVlID0gdm9pZCAwO1xuICAgIH1cbiAgICBtcyA9ICttcztcbiAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdCh2YWx1ZSwgdm9pZCAwKTtcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcblxuICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHByb21pc2UuX3Byb3BhZ2F0ZUZyb20obWF5YmVQcm9taXNlLCA3KTtcbiAgICAgICAgcHJvbWlzZS5fZm9sbG93KG1heWJlUHJvbWlzZSk7XG4gICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmRlbGF5KHZhbHVlLCBtcyk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHByb21pc2UuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgIF9zZXRUaW1lb3V0KGFmdGVyRGVsYXksIG1zLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNlO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuZGVsYXkgPSBmdW5jdGlvbiBQcm9taXNlJGRlbGF5KG1zKSB7XG4gICAgcmV0dXJuIGRlbGF5KHRoaXMsIG1zKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLnRpbWVvdXQgPSBmdW5jdGlvbiBQcm9taXNlJHRpbWVvdXQobXMsIG1lc3NhZ2UpIHtcbiAgICBtcyA9ICttcztcblxuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHRoaXMsIDcpO1xuICAgIHJldC5fZm9sbG93KHRoaXMpO1xuICAgIF9zZXRUaW1lb3V0KGFmdGVyVGltZW91dCwgbXMsIHJldCwgbWVzc2FnZSwgbXMpO1xuICAgIHJldHVybiByZXQuY2FuY2VsbGFibGUoKTtcbn07XG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGNhc3QpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBhcGlSZWplY3Rpb24gPSByZXF1aXJlKFwiLi9lcnJvcnNfYXBpX3JlamVjdGlvblwiKShQcm9taXNlKTtcbnZhciBpc09iamVjdCA9IHV0aWwuaXNPYmplY3Q7XG52YXIgZXM1ID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpO1xuXG5mdW5jdGlvbiBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5KG9iaikge1xuICAgIHZhciBrZXlzID0gZXM1LmtleXMob2JqKTtcbiAgICB2YXIgbGVuID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW4gKiAyKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICB2YWx1ZXNbaV0gPSBvYmpba2V5XTtcbiAgICAgICAgdmFsdWVzW2kgKyBsZW5dID0ga2V5O1xuICAgIH1cbiAgICB0aGlzLmNvbnN0cnVjdG9yJCh2YWx1ZXMpO1xufVxudXRpbC5pbmhlcml0cyhQcm9wZXJ0aWVzUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuXG5Qcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9XG5mdW5jdGlvbiBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5JF9pbml0KCkge1xuICAgIHRoaXMuX2luaXQkKHZvaWQgMCwgLTMpIDtcbn07XG5cblByb3BlcnRpZXNQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3ZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcbiAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICBpZiAodG90YWxSZXNvbHZlZCA+PSB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgdmFyIHZhbCA9IHt9O1xuICAgICAgICB2YXIga2V5T2Zmc2V0ID0gdGhpcy5sZW5ndGgoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMubGVuZ3RoKCk7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgdmFsW3RoaXMuX3ZhbHVlc1tpICsga2V5T2Zmc2V0XV0gPSB0aGlzLl92YWx1ZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVzb2x2ZSh2YWwpO1xuICAgIH1cbn07XG5cblByb3BlcnRpZXNQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUHJvZ3Jlc3NlZCA9XG5mdW5jdGlvbiBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5JF9wcm9taXNlUHJvZ3Jlc3NlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG5cbiAgICB0aGlzLl9wcm9taXNlLl9wcm9ncmVzcyh7XG4gICAgICAgIGtleTogdGhpcy5fdmFsdWVzW2luZGV4ICsgdGhpcy5sZW5ndGgoKV0sXG4gICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgIH0pO1xufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuc2hvdWxkQ29weVZhbHVlcyA9XG5mdW5jdGlvbiBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5JF9zaG91bGRDb3B5VmFsdWVzKCkge1xuICAgIHJldHVybiBmYWxzZTtcbn07XG5cblByb3BlcnRpZXNQcm9taXNlQXJyYXkucHJvdG90eXBlLmdldEFjdHVhbExlbmd0aCA9XG5mdW5jdGlvbiBQcm9wZXJ0aWVzUHJvbWlzZUFycmF5JGdldEFjdHVhbExlbmd0aChsZW4pIHtcbiAgICByZXR1cm4gbGVuID4+IDE7XG59O1xuXG5mdW5jdGlvbiBQcm9taXNlJF9Qcm9wcyhwcm9taXNlcykge1xuICAgIHZhciByZXQ7XG4gICAgdmFyIGNhc3RWYWx1ZSA9IGNhc3QocHJvbWlzZXMsIHZvaWQgMCk7XG5cbiAgICBpZiAoIWlzT2JqZWN0KGNhc3RWYWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGFwaVJlamVjdGlvbihcImNhbm5vdCBhd2FpdCBwcm9wZXJ0aWVzIG9mIGEgbm9uLW9iamVjdFwiKTtcbiAgICB9IGVsc2UgaWYgKGNhc3RWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0ID0gY2FzdFZhbHVlLl90aGVuKFByb21pc2UucHJvcHMsIHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0ID0gbmV3IFByb3BlcnRpZXNQcm9taXNlQXJyYXkoY2FzdFZhbHVlKS5wcm9taXNlKCk7XG4gICAgfVxuXG4gICAgaWYgKGNhc3RWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0Ll9wcm9wYWdhdGVGcm9tKGNhc3RWYWx1ZSwgNCk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cblByb21pc2UucHJvdG90eXBlLnByb3BzID0gZnVuY3Rpb24gUHJvbWlzZSRwcm9wcygpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfUHJvcHModGhpcyk7XG59O1xuXG5Qcm9taXNlLnByb3BzID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9wcyhwcm9taXNlcykge1xuICAgIHJldHVybiBQcm9taXNlJF9Qcm9wcyhwcm9taXNlcyk7XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgVEhJUyA9IHt9O1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIG5vZGViYWNrRm9yUHJvbWlzZSA9IHJlcXVpcmUoXCIuL3Byb21pc2VfcmVzb2x2ZXIuanNcIilcbiAgICAuX25vZGViYWNrRm9yUHJvbWlzZTtcbnZhciB3aXRoQXBwZW5kZWQgPSB1dGlsLndpdGhBcHBlbmRlZDtcbnZhciBtYXliZVdyYXBBc0Vycm9yID0gdXRpbC5tYXliZVdyYXBBc0Vycm9yO1xudmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbnZhciBUeXBlRXJyb3IgPSByZXF1aXJlKFwiLi9lcnJvcnNcIikuVHlwZUVycm9yO1xudmFyIGRlZmF1bHRTdWZmaXggPSBcIkFzeW5jXCI7XG52YXIgZGVmYXVsdEZpbHRlciA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHtcbiAgICByZXR1cm4gdXRpbC5pc0lkZW50aWZpZXIobmFtZSkgJiZcbiAgICAgICAgbmFtZS5jaGFyQXQoMCkgIT09IFwiX1wiICYmXG4gICAgICAgICF1dGlsLmlzQ2xhc3MoZnVuYyk7XG59O1xudmFyIGRlZmF1bHRQcm9taXNpZmllZCA9IHtfX2lzUHJvbWlzaWZpZWRfXzogdHJ1ZX07XG5cblxuZnVuY3Rpb24gZXNjYXBlSWRlbnRSZWdleChzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbJF0pLywgXCJcXFxcJFwiKTtcbn1cblxuZnVuY3Rpb24gaXNQcm9taXNpZmllZChmbikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmbi5fX2lzUHJvbWlzaWZpZWRfXyA9PT0gdHJ1ZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaGFzUHJvbWlzaWZpZWQob2JqLCBrZXksIHN1ZmZpeCkge1xuICAgIHZhciB2YWwgPSB1dGlsLmdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdChvYmosIGtleSArIHN1ZmZpeCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFByb21pc2lmaWVkKTtcbiAgICByZXR1cm4gdmFsID8gaXNQcm9taXNpZmllZCh2YWwpIDogZmFsc2U7XG59XG5mdW5jdGlvbiBjaGVja1ZhbGlkKHJldCwgc3VmZml4LCBzdWZmaXhSZWdleHApIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICB2YXIga2V5ID0gcmV0W2ldO1xuICAgICAgICBpZiAoc3VmZml4UmVnZXhwLnRlc3Qoa2V5KSkge1xuICAgICAgICAgICAgdmFyIGtleVdpdGhvdXRBc3luY1N1ZmZpeCA9IGtleS5yZXBsYWNlKHN1ZmZpeFJlZ2V4cCwgXCJcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJldC5sZW5ndGg7IGogKz0gMikge1xuICAgICAgICAgICAgICAgIGlmIChyZXRbal0gPT09IGtleVdpdGhvdXRBc3luY1N1ZmZpeCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHByb21pc2lmeSBhbiBBUEkgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aGF0IGhhcyBub3JtYWwgbWV0aG9kcyB3aXRoICdcIitzdWZmaXgrXCInLXN1ZmZpeFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByb21pc2lmaWFibGVNZXRob2RzKG9iaiwgc3VmZml4LCBzdWZmaXhSZWdleHAsIGZpbHRlcikge1xuICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyhvYmopO1xuICAgIHZhciByZXQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgICAgICFpc1Byb21pc2lmaWVkKHZhbHVlKSAmJlxuICAgICAgICAgICAgIWhhc1Byb21pc2lmaWVkKG9iaiwga2V5LCBzdWZmaXgpICYmXG4gICAgICAgICAgICBmaWx0ZXIoa2V5LCB2YWx1ZSwgb2JqKSkge1xuICAgICAgICAgICAgcmV0LnB1c2goa2V5LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2hlY2tWYWxpZChyZXQsIHN1ZmZpeCwgc3VmZml4UmVnZXhwKTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihsaWtlbHlBcmd1bWVudENvdW50KSB7XG4gICAgdmFyIHJldCA9IFtsaWtlbHlBcmd1bWVudENvdW50XTtcbiAgICB2YXIgbWluID0gTWF0aC5tYXgoMCwgbGlrZWx5QXJndW1lbnRDb3VudCAtIDEgLSA1KTtcbiAgICBmb3IodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50IC0gMTsgaSA+PSBtaW47IC0taSkge1xuICAgICAgICBpZiAoaSA9PT0gbGlrZWx5QXJndW1lbnRDb3VudCkgY29udGludWU7XG4gICAgICAgIHJldC5wdXNoKGkpO1xuICAgIH1cbiAgICBmb3IodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50ICsgMTsgaSA8PSA1OyArK2kpIHtcbiAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGFyZ3VtZW50U2VxdWVuY2UoYXJndW1lbnRDb3VudCkge1xuICAgIHJldHVybiB1dGlsLmZpbGxlZFJhbmdlKGFyZ3VtZW50Q291bnQsIFwiYXJndW1lbnRzW1wiLCBcIl1cIik7XG59XG5cbmZ1bmN0aW9uIHBhcmFtZXRlckRlY2xhcmF0aW9uKHBhcmFtZXRlckNvdW50KSB7XG4gICAgcmV0dXJuIHV0aWwuZmlsbGVkUmFuZ2UocGFyYW1ldGVyQ291bnQsIFwiX2FyZ1wiLCBcIlwiKTtcbn1cblxuZnVuY3Rpb24gcGFyYW1ldGVyQ291bnQoZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoTWF0aC5taW4oZm4ubGVuZ3RoLCAxMDIzICsgMSksIDApO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVQcm9wZXJ0eUFjY2VzcyhrZXkpIHtcbiAgICBpZiAodXRpbC5pc0lkZW50aWZpZXIoa2V5KSkge1xuICAgICAgICByZXR1cm4gXCIuXCIgKyBrZXk7XG4gICAgfVxuICAgIGVsc2UgcmV0dXJuIFwiWydcIiArIGtleS5yZXBsYWNlKC8oWydcXFxcXSkvZywgXCJcXFxcJDFcIikgKyBcIiddXCI7XG59XG5cbmZ1bmN0aW9uIG1ha2VOb2RlUHJvbWlzaWZpZWRFdmFsKGNhbGxiYWNrLCByZWNlaXZlciwgb3JpZ2luYWxOYW1lLCBmbiwgc3VmZml4KSB7XG4gICAgdmFyIG5ld1BhcmFtZXRlckNvdW50ID0gTWF0aC5tYXgoMCwgcGFyYW1ldGVyQ291bnQoZm4pIC0gMSk7XG4gICAgdmFyIGFyZ3VtZW50T3JkZXIgPSBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihuZXdQYXJhbWV0ZXJDb3VudCk7XG4gICAgdmFyIGNhbGxiYWNrTmFtZSA9XG4gICAgICAgICh0eXBlb2Ygb3JpZ2luYWxOYW1lID09PSBcInN0cmluZ1wiICYmIHV0aWwuaXNJZGVudGlmaWVyKG9yaWdpbmFsTmFtZSlcbiAgICAgICAgICAgID8gb3JpZ2luYWxOYW1lICsgc3VmZml4XG4gICAgICAgICAgICA6IFwicHJvbWlzaWZpZWRcIik7XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZUNhbGxGb3JBcmd1bWVudENvdW50KGNvdW50KSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRTZXF1ZW5jZShjb3VudCkuam9pbihcIiwgXCIpO1xuICAgICAgICB2YXIgY29tbWEgPSBjb3VudCA+IDAgPyBcIiwgXCIgOiBcIlwiO1xuICAgICAgICB2YXIgcmV0O1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICByZXQgPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIHRoaXMubWV0aG9kKGFyZ3MsIGZuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCIucmVwbGFjZShcIi5tZXRob2RcIiwgZ2VuZXJhdGVQcm9wZXJ0eUFjY2VzcyhjYWxsYmFjaykpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyID09PSBUSElTKSB7XG4gICAgICAgICAgICByZXQgPSAgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgYXJncywgZm4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCI7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgcmV0ID0gIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHJlY2VpdmVyLCBhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQucmVwbGFjZShcImFyZ3NcIiwgYXJncykucmVwbGFjZShcIiwgXCIsIGNvbW1hKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZUFyZ3VtZW50U3dpdGNoQ2FzZSgpIHtcbiAgICAgICAgdmFyIHJldCA9IFwiXCI7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBhcmd1bWVudE9yZGVyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICByZXQgKz0gXCJjYXNlIFwiICsgYXJndW1lbnRPcmRlcltpXSArXCI6XCIgK1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlQ2FsbEZvckFyZ3VtZW50Q291bnQoYXJndW1lbnRPcmRlcltpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvZGVGb3JDYWxsO1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb2RlRm9yQ2FsbCA9IFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuYXBwbHkodGhpcywgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIi5wcm9wZXJ0eVwiLCBnZW5lcmF0ZVByb3BlcnR5QWNjZXNzKGNhbGxiYWNrKSk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgPT09IFRISVMpIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkocmVjZWl2ZXIsIGFyZ3MpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldCArPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBkZWZhdWx0OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkobGVuICsgMSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGkgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgYXJnc1tpXSA9IGZuOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgW0NvZGVGb3JDYWxsXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgYnJlYWs7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBcIi5yZXBsYWNlKFwiW0NvZGVGb3JDYWxsXVwiLCBjb2RlRm9yQ2FsbCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIlByb21pc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjZWl2ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2l0aEFwcGVuZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heWJlV3JhcEFzRXJyb3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZWJhY2tGb3JQcm9taXNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIklOVEVSTkFMXCIsXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHZhciByZXQgPSBmdW5jdGlvbiBGdW5jdGlvbk5hbWUoUGFyYW1ldGVycykgeyAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgZm4gPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB0cnkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgc3dpdGNoKGxlbikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgICAgIFtDb2RlRm9yU3dpdGNoQ2FzZV0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSBtYXliZVdyYXBBc0Vycm9yKGUpOyAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIH07ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldC5fX2lzUHJvbWlzaWZpZWRfXyA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldHVybiByZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiXG4gICAgICAgIC5yZXBsYWNlKFwiRnVuY3Rpb25OYW1lXCIsIGNhbGxiYWNrTmFtZSlcbiAgICAgICAgLnJlcGxhY2UoXCJQYXJhbWV0ZXJzXCIsIHBhcmFtZXRlckRlY2xhcmF0aW9uKG5ld1BhcmFtZXRlckNvdW50KSlcbiAgICAgICAgLnJlcGxhY2UoXCJbQ29kZUZvclN3aXRjaENhc2VdXCIsIGdlbmVyYXRlQXJndW1lbnRTd2l0Y2hDYXNlKCkpKShcbiAgICAgICAgICAgIFByb21pc2UsXG4gICAgICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgICAgIHJlY2VpdmVyLFxuICAgICAgICAgICAgd2l0aEFwcGVuZGVkLFxuICAgICAgICAgICAgbWF5YmVXcmFwQXNFcnJvcixcbiAgICAgICAgICAgIG5vZGViYWNrRm9yUHJvbWlzZSxcbiAgICAgICAgICAgIElOVEVSTkFMXG4gICAgICAgICk7XG59XG5cbmZ1bmN0aW9uIG1ha2VOb2RlUHJvbWlzaWZpZWRDbG9zdXJlKGNhbGxiYWNrLCByZWNlaXZlcikge1xuICAgIGZ1bmN0aW9uIHByb21pc2lmaWVkKCkge1xuICAgICAgICB2YXIgX3JlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgICAgIGlmIChyZWNlaXZlciA9PT0gVEhJUykgX3JlY2VpdmVyID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSBfcmVjZWl2ZXJbY2FsbGJhY2tdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICB2YXIgZm4gPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShfcmVjZWl2ZXIsIHdpdGhBcHBlbmRlZChhcmd1bWVudHMsIGZuKSk7XG4gICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSBtYXliZVdyYXBBc0Vycm9yKGUpO1xuICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTtcbiAgICAgICAgICAgIHByb21pc2UuX3JlamVjdCh3cmFwcGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9XG4gICAgcHJvbWlzaWZpZWQuX19pc1Byb21pc2lmaWVkX18gPSB0cnVlO1xuICAgIHJldHVybiBwcm9taXNpZmllZDtcbn1cblxudmFyIG1ha2VOb2RlUHJvbWlzaWZpZWQgPSBjYW5FdmFsdWF0ZVxuICAgID8gbWFrZU5vZGVQcm9taXNpZmllZEV2YWxcbiAgICA6IG1ha2VOb2RlUHJvbWlzaWZpZWRDbG9zdXJlO1xuXG5mdW5jdGlvbiBwcm9taXNpZnlBbGwob2JqLCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpIHtcbiAgICB2YXIgc3VmZml4UmVnZXhwID0gbmV3IFJlZ0V4cChlc2NhcGVJZGVudFJlZ2V4KHN1ZmZpeCkgKyBcIiRcIik7XG4gICAgdmFyIG1ldGhvZHMgPVxuICAgICAgICBwcm9taXNpZmlhYmxlTWV0aG9kcyhvYmosIHN1ZmZpeCwgc3VmZml4UmVnZXhwLCBmaWx0ZXIpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG1ldGhvZHMubGVuZ3RoOyBpIDwgbGVuOyBpKz0gMikge1xuICAgICAgICB2YXIga2V5ID0gbWV0aG9kc1tpXTtcbiAgICAgICAgdmFyIGZuID0gbWV0aG9kc1tpKzFdO1xuICAgICAgICB2YXIgcHJvbWlzaWZpZWRLZXkgPSBrZXkgKyBzdWZmaXg7XG4gICAgICAgIG9ialtwcm9taXNpZmllZEtleV0gPSBwcm9taXNpZmllciA9PT0gbWFrZU5vZGVQcm9taXNpZmllZFxuICAgICAgICAgICAgICAgID8gbWFrZU5vZGVQcm9taXNpZmllZChrZXksIFRISVMsIGtleSwgZm4sIHN1ZmZpeClcbiAgICAgICAgICAgICAgICA6IHByb21pc2lmaWVyKGZuKTtcbiAgICB9XG4gICAgdXRpbC50b0Zhc3RQcm9wZXJ0aWVzKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gcHJvbWlzaWZ5KGNhbGxiYWNrLCByZWNlaXZlcikge1xuICAgIHJldHVybiBtYWtlTm9kZVByb21pc2lmaWVkKGNhbGxiYWNrLCByZWNlaXZlciwgdm9pZCAwLCBjYWxsYmFjayk7XG59XG5cblByb21pc2UucHJvbWlzaWZ5ID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9taXNpZnkoZm4sIHJlY2VpdmVyKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGlmIChpc1Byb21pc2lmaWVkKGZuKSkge1xuICAgICAgICByZXR1cm4gZm47XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNpZnkoZm4sIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gVEhJUyA6IHJlY2VpdmVyKTtcbn07XG5cblByb21pc2UucHJvbWlzaWZ5QWxsID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9taXNpZnlBbGwodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ0aGUgdGFyZ2V0IG9mIHByb21pc2lmeUFsbCBtdXN0IGJlIGFuIG9iamVjdCBvciBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICBvcHRpb25zID0gT2JqZWN0KG9wdGlvbnMpO1xuICAgIHZhciBzdWZmaXggPSBvcHRpb25zLnN1ZmZpeDtcbiAgICBpZiAodHlwZW9mIHN1ZmZpeCAhPT0gXCJzdHJpbmdcIikgc3VmZml4ID0gZGVmYXVsdFN1ZmZpeDtcbiAgICB2YXIgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXI7XG4gICAgaWYgKHR5cGVvZiBmaWx0ZXIgIT09IFwiZnVuY3Rpb25cIikgZmlsdGVyID0gZGVmYXVsdEZpbHRlcjtcbiAgICB2YXIgcHJvbWlzaWZpZXIgPSBvcHRpb25zLnByb21pc2lmaWVyO1xuICAgIGlmICh0eXBlb2YgcHJvbWlzaWZpZXIgIT09IFwiZnVuY3Rpb25cIikgcHJvbWlzaWZpZXIgPSBtYWtlTm9kZVByb21pc2lmaWVkO1xuXG4gICAgaWYgKCF1dGlsLmlzSWRlbnRpZmllcihzdWZmaXgpKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwic3VmZml4IG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyXCIpO1xuICAgIH1cblxuICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyh0YXJnZXQsIHtpbmNsdWRlSGlkZGVuOiB0cnVlfSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRhcmdldFtrZXlzW2ldXTtcbiAgICAgICAgaWYgKGtleXNbaV0gIT09IFwiY29uc3RydWN0b3JcIiAmJlxuICAgICAgICAgICAgdXRpbC5pc0NsYXNzKHZhbHVlKSkge1xuICAgICAgICAgICAgcHJvbWlzaWZ5QWxsKHZhbHVlLnByb3RvdHlwZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgICAgIHByb21pc2lmeUFsbCh2YWx1ZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNpZnlBbGwodGFyZ2V0LCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpO1xufTtcbn07XG5cbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xudmFyIGlzRVM1ID0gKGZ1bmN0aW9uKCl7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgcmV0dXJuIHRoaXMgPT09IHZvaWQgMDtcbn0pKCk7XG5cbmlmIChpc0VTNSkge1xuICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgICBmcmVlemU6IE9iamVjdC5mcmVlemUsXG4gICAgICAgIGRlZmluZVByb3BlcnR5OiBPYmplY3QuZGVmaW5lUHJvcGVydHksXG4gICAgICAgIGtleXM6IE9iamVjdC5rZXlzLFxuICAgICAgICBnZXRQcm90b3R5cGVPZjogT2JqZWN0LmdldFByb3RvdHlwZU9mLFxuICAgICAgICBpc0FycmF5OiBBcnJheS5pc0FycmF5LFxuICAgICAgICBpc0VTNTogaXNFUzVcbiAgICB9O1xufSBlbHNlIHtcbiAgICB2YXIgaGFzID0ge30uaGFzT3duUHJvcGVydHk7XG4gICAgdmFyIHN0ciA9IHt9LnRvU3RyaW5nO1xuICAgIHZhciBwcm90byA9IHt9LmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcblxuICAgIHZhciBPYmplY3RLZXlzID0gZnVuY3Rpb24gT2JqZWN0S2V5cyhvKSB7XG4gICAgICAgIHZhciByZXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG8pIHtcbiAgICAgICAgICAgIGlmIChoYXMuY2FsbChvLCBrZXkpKSB7XG4gICAgICAgICAgICAgICAgcmV0LnB1c2goa2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxuICAgIHZhciBPYmplY3REZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0aW9uIE9iamVjdERlZmluZVByb3BlcnR5KG8sIGtleSwgZGVzYykge1xuICAgICAgICBvW2tleV0gPSBkZXNjLnZhbHVlO1xuICAgICAgICByZXR1cm4gbztcbiAgICB9XG5cbiAgICB2YXIgT2JqZWN0RnJlZXplID0gZnVuY3Rpb24gT2JqZWN0RnJlZXplKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIHZhciBPYmplY3RHZXRQcm90b3R5cGVPZiA9IGZ1bmN0aW9uIE9iamVjdEdldFByb3RvdHlwZU9mKG9iaikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdChvYmopLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIHByb3RvO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIEFycmF5SXNBcnJheSA9IGZ1bmN0aW9uIEFycmF5SXNBcnJheShvYmopIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBzdHIuY2FsbChvYmopID09PSBcIltvYmplY3QgQXJyYXldXCI7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2goZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgICAgIGlzQXJyYXk6IEFycmF5SXNBcnJheSxcbiAgICAgICAga2V5czogT2JqZWN0S2V5cyxcbiAgICAgICAgZGVmaW5lUHJvcGVydHk6IE9iamVjdERlZmluZVByb3BlcnR5LFxuICAgICAgICBmcmVlemU6IE9iamVjdEZyZWV6ZSxcbiAgICAgICAgZ2V0UHJvdG90eXBlT2Y6IE9iamVjdEdldFByb3RvdHlwZU9mLFxuICAgICAgICBpc0VTNTogaXNFUzVcbiAgICB9O1xufVxuIiwiKGZ1bmN0aW9uKHByb2Nlc3Mpey8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgc2NoZWR1bGU7XG52YXIgX011dGF0aW9uT2JzZXJ2ZXI7XG5pZiAodHlwZW9mIHByb2Nlc3MgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHByb2Nlc3MudmVyc2lvbiA9PT0gXCJzdHJpbmdcIikge1xuICAgIHNjaGVkdWxlID0gZnVuY3Rpb24gUHJvbWlzZSRfU2NoZWR1bGVyKGZuKSB7XG4gICAgICAgIHByb2Nlc3MubmV4dFRpY2soZm4pO1xuICAgIH07XG59XG5lbHNlIGlmICgodHlwZW9mIE11dGF0aW9uT2JzZXJ2ZXIgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICAgICAgIChfTXV0YXRpb25PYnNlcnZlciA9IE11dGF0aW9uT2JzZXJ2ZXIpKSB8fFxuICAgICAgICAgKHR5cGVvZiBXZWJLaXRNdXRhdGlvbk9ic2VydmVyICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgICAoX011dGF0aW9uT2JzZXJ2ZXIgPSBXZWJLaXRNdXRhdGlvbk9ic2VydmVyKSkpIHtcbiAgICBzY2hlZHVsZSA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHZhciBxdWV1ZWRGbiA9IHZvaWQgMDtcbiAgICAgICAgdmFyIG9ic2VydmVyID0gbmV3IF9NdXRhdGlvbk9ic2VydmVyKFxuICAgICAgICAgICAgZnVuY3Rpb24gUHJvbWlzZSRfU2NoZWR1bGVyKCkge1xuICAgICAgICAgICAgICAgIHZhciBmbiA9IHF1ZXVlZEZuO1xuICAgICAgICAgICAgICAgIHF1ZXVlZEZuID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgKTtcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShkaXYsIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF9TY2hlZHVsZXIoZm4pIHtcbiAgICAgICAgICAgIHF1ZXVlZEZuID0gZm47XG4gICAgICAgICAgICBkaXYuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJmb29cIik7XG4gICAgICAgIH07XG5cbiAgICB9KSgpO1xufVxuZWxzZSBpZiAodHlwZW9mIHNldFRpbWVvdXQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBzY2hlZHVsZSA9IGZ1bmN0aW9uIFByb21pc2UkX1NjaGVkdWxlcihmbikge1xuICAgICAgICBzZXRUaW1lb3V0KGZuLCAwKTtcbiAgICB9O1xufVxuZWxzZSB0aHJvdyBuZXcgRXJyb3IoXCJubyBhc3luYyBzY2hlZHVsZXIgYXZhaWxhYmxlXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBzY2hlZHVsZTtcblxufSkocmVxdWlyZShcIl9fYnJvd3NlcmlmeV9wcm9jZXNzXCIpKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5mdW5jdGlvbiBhcnJheUNvcHkoc3JjLCBzcmNJbmRleCwgZHN0LCBkc3RJbmRleCwgbGVuKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBsZW47ICsraikge1xuICAgICAgICBkc3RbaiArIGRzdEluZGV4XSA9IHNyY1tqICsgc3JjSW5kZXhdO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUXVldWUoY2FwYWNpdHkpIHtcbiAgICB0aGlzLl9jYXBhY2l0eSA9IGNhcGFjaXR5O1xuICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgdGhpcy5fZnJvbnQgPSAwO1xuICAgIHRoaXMuX21ha2VDYXBhY2l0eSgpO1xufVxuXG5RdWV1ZS5wcm90b3R5cGUuX3dpbGxCZU92ZXJDYXBhY2l0eSA9XG5mdW5jdGlvbiBRdWV1ZSRfd2lsbEJlT3ZlckNhcGFjaXR5KHNpemUpIHtcbiAgICByZXR1cm4gdGhpcy5fY2FwYWNpdHkgPCBzaXplO1xufTtcblxuUXVldWUucHJvdG90eXBlLl9wdXNoT25lID0gZnVuY3Rpb24gUXVldWUkX3B1c2hPbmUoYXJnKSB7XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgdGhpcy5fY2hlY2tDYXBhY2l0eShsZW5ndGggKyAxKTtcbiAgICB2YXIgaSA9ICh0aGlzLl9mcm9udCArIGxlbmd0aCkgJiAodGhpcy5fY2FwYWNpdHkgLSAxKTtcbiAgICB0aGlzW2ldID0gYXJnO1xuICAgIHRoaXMuX2xlbmd0aCA9IGxlbmd0aCArIDE7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIFF1ZXVlJHB1c2goZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKSArIDM7XG4gICAgaWYgKHRoaXMuX3dpbGxCZU92ZXJDYXBhY2l0eShsZW5ndGgpKSB7XG4gICAgICAgIHRoaXMuX3B1c2hPbmUoZm4pO1xuICAgICAgICB0aGlzLl9wdXNoT25lKHJlY2VpdmVyKTtcbiAgICAgICAgdGhpcy5fcHVzaE9uZShhcmcpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBqID0gdGhpcy5fZnJvbnQgKyBsZW5ndGggLSAzO1xuICAgIHRoaXMuX2NoZWNrQ2FwYWNpdHkobGVuZ3RoKTtcbiAgICB2YXIgd3JhcE1hc2sgPSB0aGlzLl9jYXBhY2l0eSAtIDE7XG4gICAgdGhpc1soaiArIDApICYgd3JhcE1hc2tdID0gZm47XG4gICAgdGhpc1soaiArIDEpICYgd3JhcE1hc2tdID0gcmVjZWl2ZXI7XG4gICAgdGhpc1soaiArIDIpICYgd3JhcE1hc2tdID0gYXJnO1xuICAgIHRoaXMuX2xlbmd0aCA9IGxlbmd0aDtcbn07XG5cblF1ZXVlLnByb3RvdHlwZS5zaGlmdCA9IGZ1bmN0aW9uIFF1ZXVlJHNoaWZ0KCkge1xuICAgIHZhciBmcm9udCA9IHRoaXMuX2Zyb250LFxuICAgICAgICByZXQgPSB0aGlzW2Zyb250XTtcblxuICAgIHRoaXNbZnJvbnRdID0gdm9pZCAwO1xuICAgIHRoaXMuX2Zyb250ID0gKGZyb250ICsgMSkgJiAodGhpcy5fY2FwYWNpdHkgLSAxKTtcbiAgICB0aGlzLl9sZW5ndGgtLTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUXVldWUucHJvdG90eXBlLmxlbmd0aCA9IGZ1bmN0aW9uIFF1ZXVlJGxlbmd0aCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xufTtcblxuUXVldWUucHJvdG90eXBlLl9tYWtlQ2FwYWNpdHkgPSBmdW5jdGlvbiBRdWV1ZSRfbWFrZUNhcGFjaXR5KCkge1xuICAgIHZhciBsZW4gPSB0aGlzLl9jYXBhY2l0eTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHRoaXNbaV0gPSB2b2lkIDA7XG4gICAgfVxufTtcblxuUXVldWUucHJvdG90eXBlLl9jaGVja0NhcGFjaXR5ID0gZnVuY3Rpb24gUXVldWUkX2NoZWNrQ2FwYWNpdHkoc2l6ZSkge1xuICAgIGlmICh0aGlzLl9jYXBhY2l0eSA8IHNpemUpIHtcbiAgICAgICAgdGhpcy5fcmVzaXplVG8odGhpcy5fY2FwYWNpdHkgPDwgMyk7XG4gICAgfVxufTtcblxuUXVldWUucHJvdG90eXBlLl9yZXNpemVUbyA9IGZ1bmN0aW9uIFF1ZXVlJF9yZXNpemVUbyhjYXBhY2l0eSkge1xuICAgIHZhciBvbGRGcm9udCA9IHRoaXMuX2Zyb250O1xuICAgIHZhciBvbGRDYXBhY2l0eSA9IHRoaXMuX2NhcGFjaXR5O1xuICAgIHZhciBvbGRRdWV1ZSA9IG5ldyBBcnJheShvbGRDYXBhY2l0eSk7XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG5cbiAgICBhcnJheUNvcHkodGhpcywgMCwgb2xkUXVldWUsIDAsIG9sZENhcGFjaXR5KTtcbiAgICB0aGlzLl9jYXBhY2l0eSA9IGNhcGFjaXR5O1xuICAgIHRoaXMuX21ha2VDYXBhY2l0eSgpO1xuICAgIHRoaXMuX2Zyb250ID0gMDtcbiAgICBpZiAob2xkRnJvbnQgKyBsZW5ndGggPD0gb2xkQ2FwYWNpdHkpIHtcbiAgICAgICAgYXJyYXlDb3B5KG9sZFF1ZXVlLCBvbGRGcm9udCwgdGhpcywgMCwgbGVuZ3RoKTtcbiAgICB9IGVsc2UgeyAgICAgICAgdmFyIGxlbmd0aEJlZm9yZVdyYXBwaW5nID1cbiAgICAgICAgICAgIGxlbmd0aCAtICgob2xkRnJvbnQgKyBsZW5ndGgpICYgKG9sZENhcGFjaXR5IC0gMSkpO1xuXG4gICAgICAgIGFycmF5Q29weShvbGRRdWV1ZSwgb2xkRnJvbnQsIHRoaXMsIDAsIGxlbmd0aEJlZm9yZVdyYXBwaW5nKTtcbiAgICAgICAgYXJyYXlDb3B5KG9sZFF1ZXVlLCAwLCB0aGlzLCBsZW5ndGhCZWZvcmVXcmFwcGluZyxcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoIC0gbGVuZ3RoQmVmb3JlV3JhcHBpbmcpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUXVldWU7XG4iXX0=
;