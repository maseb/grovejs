;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  ComponentRegistry,
  webAliases,
  nodeAliases
) {
  var c = new ComponentRegistry();


  c.registerMany([
    {
      module: require("./util/component-loader"),
      as: "component-loader"
    },

    {
      module: require("./util/periodic"),
      as: "periodic"
    },

    {
      module: require("./util/retryable"),
      as: "retryable"
    },

    {
      module: require("./util/timer"),
      as: "timer"
    },

    {
      module: require("./core/dispatcher"),
      as: "dispatcher"
    },

    {
      module: require("./core/countdown-latch"),
      as: "countdown-latch"
    },

    {
      module: require("./core/options"),
      as: "options"
    },

    {
      module: require("./core/lang"),
      as: "lang"
    },

    {
      module: require("./core/ref"),
      as: "ref"
    },

    {
      module: require("./core/state-guard"),
      as: "state-guard"
    },


    {
      module: require("./core/pub-sub"),
      as: "pub-sub"
    },

    {
      module: require("./core/sequencer/unit-sequencer"),
      as: ["unit-sequencer", "sequencer"]
    },


    {
      module: require("./core/sequencer/clock-sequencer"),
      as: "clock-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-composite-sequencer"),
      as: "delegating-composite-sequencer"
    },

    {
      module: require("./core/sequencer/delegating-forwarding-sequencer"),
      as: "delegating-forwarding-sequencer"
    },

    {
      module: require("./collection/doubly-linked-list"),
      as: "doubly-linked-list"
    },

    {
      module: require("./collection/object-hash-map"),
      as: ["hash-map", "object-hash-map"]
    },

    {
      module: require("./collection/lru-hash-map"),
      as: "lru-hash-map"
    },

    {
      module: require("./storage/caching-data-store"),
      as: "caching-data-store"
    },

    {
      module: require("./storage/in-memory-data-store"),
      as: "in-memory-data-store"
    },

    {
      module: require("./storage/lru-data-store"),
      as: "lru-data-store"
    },

    {
      module: require("./storage/signaling-data-store"),
      as: "signaling-data-store"
    },

    {
      module: require("./time/clock/logical-clock"),
      as: "logical-clock"
    },

    {
      module: require("./time/clock/system-clock"),
      as: "system-clock"
    },

    {
      module: require("./appkit/configuration-magic"),
      as: "configuration-magic"
    },

    {
      module: require("./appkit/config/scoped-configuration-resolver"),
      as: "scoped-configuration-resolver"
    },

    {
      module: require("./appkit/config/scoped-configuration"),
      as: ["scoped-configuration", "config/scoped-configuration"]
    },

    {
      module: require("./appkit/app"),
      as: "app"
    },

    {
      module: require("./runtime"),
      as: "runtime"
    },

    {
      module: require("./core/logging/logger"),
      as: "logger"
    },

    {
      module: require("./core/logging/appenders/console-log-appender"),
      as: ["appenders/console-log", "console-log-appender"]
    },

    {
      module: require("./core/channel/channel"),
      as: "channel"
    },

    {
      module: require("./core/channel/chained-channel"),
      as: "chained-channel"
    },

    {
      module: require("./core/channel/composite-channel"),
      as: "composite-channel"
    },

    {
      module: require("./messaging/exchange"),
      as: "messaging/exchange"
    },

    {
      module: require("./messaging/courier"),
      as: "messaging/courier"
    },

    {
      module: require("./messaging/fiber/in-memory-fiber"),
      as: "messaging/fibers/in-memory"
    },

    {
      module: require("./messaging/fiber/linkable-fiber"),
      as: "messaging/fibers/linkable"
    },

    {
      module: require("./core/uuid"),
      as: "uuid"
    },

    {
      module: require("./core/serde/json-serde"),
      as: ["serde/json", "json-serde"]
    },

    {
      module: require("./platform/client-builder/client-builder"),
      as: "experimental/platform/client-builder"
    },

    {
      module: require("./platform/client-builder/client-spec"),
      as: "experimental/platform/client-spec"
    }
  ]);

  c.selfRegister({
    as: "component-registry"
  });

  webAliases(c);
  nodeAliases(c);

  return c;
};

var g = (typeof window === "undefined" ? {} : window);
g.thicket = module.exports = mod(
  require("./util/component-registry"),
  require("./web"),
  require("./node")
);

})()
},{"./util/component-loader":2,"./util/retryable":3,"./util/periodic":4,"./util/timer":5,"./core/dispatcher":6,"./core/countdown-latch":7,"./core/options":8,"./core/lang":9,"./core/state-guard":10,"./core/sequencer/unit-sequencer":11,"./core/pub-sub":12,"./core/sequencer/clock-sequencer":13,"./core/sequencer/delegating-composite-sequencer":14,"./core/sequencer/delegating-forwarding-sequencer":15,"./collection/doubly-linked-list":16,"./collection/object-hash-map":17,"./collection/lru-hash-map":18,"./storage/caching-data-store":19,"./storage/in-memory-data-store":20,"./storage/lru-data-store":21,"./storage/signaling-data-store":22,"./time/clock/logical-clock":23,"./time/clock/system-clock":24,"./appkit/configuration-magic":25,"./appkit/config/scoped-configuration-resolver":26,"./appkit/config/scoped-configuration":27,"./appkit/app":28,"./core/logging/logger":29,"./core/logging/appenders/console-log-appender":30,"./core/channel/channel":31,"./core/channel/chained-channel":32,"./core/channel/composite-channel":33,"./messaging/exchange":34,"./messaging/courier":35,"./messaging/fiber/in-memory-fiber":36,"./messaging/fiber/linkable-fiber":37,"./core/serde/json-serde":38,"./core/uuid":39,"./platform/client-builder/client-spec":40,"./platform/client-builder/client-builder":41,"./util/component-registry":42,"./web":43,"./node":44,"./core/ref":45,"./runtime":46}],44:[function(require,module,exports){
module.exports = function(c) {};

},{}],43:[function(require,module,exports){
module.exports = function(c) {
  c.registerMany([
    {
      module: require("./appkit/bootstrapper"),
      as: "bootstrapper"
    },
    {
      module: require("./appkit/web-app-container"),
      as: "app-container"
    },
    {
      module: require("./scheduler/web-scheduler"),
      as: "scheduler"
    }
  ]);

  require("./browserify2-list");
};

},{"./appkit/bootstrapper":47,"./appkit/web-app-container":48,"./scheduler/web-scheduler":49,"./browserify2-list":50}],46:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

module.exports = require("./default-runtime");

})()
},{"./default-runtime":51}],50:[function(require,module,exports){
(function(){require("./appkit/app.js");
require("./appkit/bootstrapper.js");
require("./appkit/config/scoped-configuration-resolver.js");
require("./appkit/config/scoped-configuration.js");
require("./appkit/configuration-magic.js");
require("./appkit/internal/process-keep-alive.js");
require("./appkit/web-app-container.js");
require("./collection/doubly-linked-list.js");
require("./collection/lru-hash-map.js");
require("./collection/object-hash-map.js");
require("./core/channel/chained-channel.js");
require("./core/channel/channel.js");
require("./core/channel/composite-channel.js");
require("./core/countdown-latch.js");
require("./core/dispatcher.js");
require("./core/lang.js");
require("./core/logging/appenders/console-log-appender.js");
require("./core/logging/logger.js");
require("./core/options.js");
require("./core/pub-sub.js");
require("./core/ref/delegating-ref.js");
require("./core/ref/index.js");
require("./core/ref/ref.js");
require("./core/scheduler/set-timeout-scheduler.js");
require("./core/sequencer/clock-sequencer.js");
require("./core/sequencer/delegating-composite-sequencer.js");
require("./core/sequencer/delegating-forwarding-sequencer.js");
require("./core/sequencer/unit-sequencer.js");
require("./core/serde/json-serde.js");
require("./core/state-guard.js");
require("./core/uuid.js");
require("./index.js");
require("./messaging/courier.js");
require("./messaging/exchange.js");
require("./messaging/fiber/in-memory-fiber.js");
require("./messaging/fiber/linkable-fiber.js");
require("./messaging/internals/mailbox.js");
require("./node.js");
require("./platform/client-builder/base-client.js");
require("./platform/client-builder/client-builder.js");
require("./platform/client-builder/client-spec.js");
require("./platform/client-builder/method-spec.js");
require("./runtime/default-runtime.js");
require("./runtime/index.js");
require("./scheduler/index.js");
require("./scheduler/web-scheduler.js");
require("./storage/caching-data-store.js");
require("./storage/in-memory-data-store.js");
require("./storage/internals/expiring-entry.js");
require("./storage/lru-data-store.js");
require("./storage/signaling-data-store.js");
require("./time/clock/logical-clock.js");
require("./time/clock/system-clock.js");
require("./util/component-loader.js");
require("./util/component-registry.js");
require("./util/periodic.js");
require("./util/retryable.js");
require("./util/timer.js");
require("./web.js");

})()
},{"./appkit/app.js":28,"./appkit/bootstrapper.js":47,"./appkit/config/scoped-configuration-resolver.js":26,"./appkit/config/scoped-configuration.js":27,"./appkit/configuration-magic.js":25,"./appkit/web-app-container.js":48,"./appkit/internal/process-keep-alive.js":52,"./collection/doubly-linked-list.js":16,"./collection/object-hash-map.js":17,"./collection/lru-hash-map.js":18,"./core/channel/chained-channel.js":32,"./core/channel/channel.js":31,"./core/channel/composite-channel.js":33,"./core/countdown-latch.js":7,"./core/dispatcher.js":6,"./core/lang.js":9,"./core/logging/appenders/console-log-appender.js":30,"./core/logging/logger.js":29,"./core/options.js":8,"./core/pub-sub.js":12,"./core/ref/delegating-ref.js":53,"./core/ref/index.js":45,"./core/ref/ref.js":54,"./core/scheduler/set-timeout-scheduler.js":55,"./core/sequencer/clock-sequencer.js":13,"./core/sequencer/delegating-composite-sequencer.js":14,"./core/sequencer/delegating-forwarding-sequencer.js":15,"./core/sequencer/unit-sequencer.js":11,"./core/serde/json-serde.js":38,"./core/state-guard.js":10,"./core/uuid.js":39,"./index.js":1,"./messaging/courier.js":35,"./messaging/exchange.js":34,"./messaging/fiber/in-memory-fiber.js":36,"./messaging/fiber/linkable-fiber.js":37,"./node.js":44,"./messaging/internals/mailbox.js":56,"./platform/client-builder/base-client.js":57,"./platform/client-builder/client-builder.js":41,"./platform/client-builder/client-spec.js":40,"./platform/client-builder/method-spec.js":58,"./runtime/default-runtime.js":51,"./runtime/index.js":46,"./scheduler/index.js":59,"./scheduler/web-scheduler.js":49,"./storage/caching-data-store.js":19,"./storage/in-memory-data-store.js":20,"./storage/lru-data-store.js":21,"./storage/internals/expiring-entry.js":60,"./storage/signaling-data-store.js":22,"./time/clock/logical-clock.js":23,"./time/clock/system-clock.js":24,"./util/component-loader.js":2,"./util/component-registry.js":42,"./util/periodic.js":4,"./util/retryable.js":3,"./web.js":43,"./util/timer.js":5}],58:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  Lang
) {

  var MethodSpec = Lang.pojoClass(["args", "defaults", "mType", "requestReply"], {
    defaults: {
      args:         [],
      defaults:     {},
      requestReply: true
    }
  });

  return MethodSpec;
};

module.exports = mod(
  require("../../core/lang")
);

})()
},{"../../core/lang":9}],2:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Options
) {

  /**
   * Like a `ComponentRegistry`, but modules are loaded on-demand rather than eagerly required and aliased. This is
   * done by providing the top-level `require` method as an initialization parameter, which maintains the appropriate
   * path context for resolving relative imports later.
   *
   * Note this only works in Node, not environments like Browserify, which need to eagerly resolve all required
   * modules via static analysis. For that, use the `ComponentRegistry`.
   */
  var ComponentLoader = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentLoader.prototype, {
    initialize: function(requireFun) {
      this._requireFun = requireFun;
      this._aliases = {};
      this._pathTransform = function(id) { return id;};
    },

    setPathTransform: function(pathTransform) {
      this._pathTransform = pathTransform;
      return this;
    },

    alias: function(opts) {
      opts = Options.fromObject(opts);
      var aliasName  = opts.getOrError("as");
      this._aliases[aliasName] = opts.getOrError("module");
    },

    bulkAlias: function(aliases) {
      _.each(aliases, function(aliasNames, moduleName) {
        if (!_.isArray(aliasNames)) {
          aliasNames = [aliasNames]
        }
        _.each(aliasNames, function(aliasName) {
          this.alias({module: moduleName, as: aliasName});
        }, this);
      }, this);
    },

    component: function(alias) {
      var mod = this._aliases[alias];
      if (!mod) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return this._requireFun(this._pathTransform(mod));
    },

    c: function(alias) {
      return this.component.apply(this, arguments);
    }
  });

  return ComponentLoader;
};

module.exports = factory(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":61}],3:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Lang,
  StateGuard,
  Logger
) {

  var Log = Logger.create("Retryable");

  var DEFAULT_BACKOFF_CEILING = 60 * 1000 * 10; // 10 minutes


  /**
   * A device which retries the provided Promisified `task` until it completes without error, or `retries` times
   * (default is forever). The results of the `task` are accessible via the `result()` promise, which will be fulfilled
   * or rejected on success or error (such as Retryable.Error.MaxRetriesError or Promise.CancellationError).
   *
   * If an error occurs, the `task` is retried after some time, as determined by the `backoff` `strategy`, of which two
   * are supported: `Retryable.Backoff.Linear` and `Retryable.Backoff.Exponential`. The default strategy is
   * `Retryable.Backoff.Linear`, with the period determined by:
   *
   * `coefficient * attemptNum * factor`
   *
   * Default options for Linear backoff are: `factor` = 1, `coefficient` = 250.
   *
   * For `Retryable.Backoff.Exponential, the period is determined by:
   *
   * `coefficient * Math.pow(base, attemptNum)`
   *
   * Default options for Exponential backoff are: `coefficient = 250`, `base = 2`.
   *
   * Regardless of backoff strategy, a `backoffCeiling` can be provided. If provided, this is the upper bound of
   * the period between unsuccessful task runs. This allows, for example, an exponential backoff up to a ceiling (e.g.,
   * five minutes), after which point the period will simply be the ceiling (e.g., five minutes).
   *
   */
  var Retryable = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Retryable.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler  = opts.getOrError("scheduler");
      this._task       = opts.getOrError("task");
      // If not provided, go on forever.
      this._retries    = opts.getOrElse("retries");
      this._currentTry = 0;
      this._deferred   = Lang.deferred();

      var backoff = Options.fromObject(opts.getOrElseFn("backoff", function() {
        return {
          strategy: Retryable.Backoff.Linear,
          factor: 1,
          coefficient: 250
        };
      }));

      var StrategyClass = BackoffStrategy[backoff.getOrError("strategy")];

      this._backoffStrategy = new StrategyClass(backoff.toObject());
      this._backoffCeiling  = opts.getOrElse("backoffCeiling", DEFAULT_BACKOFF_CEILING);
      this._disposedGuard   = StateGuard.scoped("disposed");

      _.bindAll(this, "_attempt");
      this._currentRun = null;
      this._scheduler.get().runSoon(this._attempt);
    },

    dispose: function() {
      if (this._disposedGuard.applied()) {
        return;
      }

      if (this._currentRun) {
        this._currentRun.cancel(new Retryable.Error.DisposedError());
        this._currentRun = null;
      }

      this._task = null;

      this._disposedGuard.apply();
    },

    result: function() {
      return this._deferred.promise;
    },

    _attempt: function() {
      if (this._disposedGuard.applied()) {
        return;
      }

      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          if (this._deferred.promise.isPending()) {
            this._deferred.resolve(result);
          }
        })
        .caught(Retryable.Error.DisposedError, function() {
          this._deferred.promise.cancel(new Promise.CancellationError());
        })
        .caught(function(err) {
          if (this._disposedGuard.applied()) {
            Log.warn("Caught retryable run error, but retryable is already disposed");
            return;
          }

          Log.debug("Received error in attempt", this._currentTry);
          var nextTry = this._currentTry + 1;

          if (this._retries >= 0 && nextTry > this._retries) {
            Log.debug("Hit max number of retries:", this._retries);
            var e = new Retryable.Error.MaxRetriesError();
            e.cause = err;
            throw e;
          }

          // Schedule us up to try again;
          this._currentRun = null;
          this._currentTry = nextTry;

          var time = this._backoffStrategy.time(this._currentTry);
          this._scheduler.get().schedule(this._attempt, Math.min(time, this._backoffCeiling));
        })
        .caught(Retryable.Error.MaxRetriesError, function(err) {
          if (this._deferred.promise.isPending()) {
            this._deferred.reject(err.cause);
          }
        });
    }
  });

  _.extend(Retryable, {
    Backoff: {
      Linear:      "linear",
      Exponential: "exponential"
    },
    Error: {
      DisposedError: Lang.makeErrorClass("DisposedError", "Retryable was disposed"),
      MaxRetriesError: Lang.makeErrorClass("MaxRetriesError", "Retryable was retried too many times")
    }
  })

  var BackoffStrategy = (function() {
    var Linear = function() {
      this.initialize.apply(this, arguments);
    };

    _.extend(Linear.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);
        this._factor        = opts.getOrElse("factor", 1);
        this._coefficient   = opts.getOrElse("coefficient", 250);
      },

      time: function(iteration) {
        return this._factor * this._coefficient * iteration;
      }
    });

    var Exponential = function() {
      this.initialize.apply(this, arguments);
    };

    _.extend(Exponential.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._base        = opts.getOrElse("base", 2);
        this._coefficient = opts.getOrElse("coefficient", 250);
      },

      time: function(iteration) {
        return this._coefficient * (Math.pow(this._base, iteration));
      }
    })


    var backoffs = {};

    backoffs[Retryable.Backoff.Linear]      = Linear;
    backoffs[Retryable.Backoff.Exponential] = Exponential;

    return backoffs;
  }());

  return Retryable;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/lang"),
  require("../core/state-guard"),
  require("../core/logging/logger")
);

})()
},{"../core/options":8,"../core/lang":9,"../core/state-guard":10,"../core/logging/logger":29,"underscore":61,"bluebird":62}],5:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A simple timer.
   *
   * Start it, stop it, get the delta.
   *
   * Or, start it, and repeatedly call `lap` for the time between the last `lap` call and now.
   *
   */
  var Timer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Timer.prototype, {
    initialize: function() {
      this._startTime = null;
      this._endTime = null;
      this._lastLap = null;
    },


    start: function() {
      this._startTime = this._lastLap = +new Date();
      return this;
    },


    stop: function() {
      this._endTime = +new Date();
      return this;
    },

    lap: function() {
      if (!this._lastLap) return 0;

      var oldLastLap = this._lastLap;
      this._lastLap = +new Date();
      return (this._lastLap - oldLastLap);
    },


    delta: function() {
      return (this._endTime - this._startTime);
    }
  });

  return Timer;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],4:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  StateGuard,
  Channel,
  ChainedChannel,
  Logger
) {

  /**
   * Upon `start()`, runs the provided Promisified `task` every `interval` milliseconds until `stop()` is called. The results
   * of each `task` are sent along the `egressChannel()`, as `msg.result` or `msg.err`.
   *
   * @constructor
   */
  var Periodic = function() {
    this.initialize.apply(this, arguments);
  };

  var Log = Logger.create("Periodic");

  _.extend(Periodic.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._schedulerRef = opts.getOrError("scheduler");
      this._task         = opts.getOrElse("task");
      this._interval     = opts.getOrError("interval");

      this._stateGuard   = new StateGuard(["disposed", "started"]);
      this._channel      = new Channel({ sentinel: this });
      this._taskId       = null;

      _.bindAll(this, "_runTask");
    },


    start: function(){
      this._stateGuard
        .deny("disposed", "started")
        .apply("started");

      this._scheduleNext(true);
    },


    stop: function() {
      this._cancelPending();
      this._cancelOutstanding();
      this._stateGuard.unapply("started");
    },

    egressChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._channel
      });
    },

    _runTask: function() {
      var results = {
        mT: "results",
        result: null,
        err: null
      };

      this._taskId = null;
      this._currentRun = Promise
        .bind(this)
        .cancellable()
        .then(function() {
          return this._task();
        })
        .then(function(result) {
          results.result = result;
        })
        .caught(Promise.CancellationError, function() {
          // Let it be. Don't want it to trickle into the results.
        })
        .caught(function(err) {
          results.err = err;
        })
        .lastly(function() {
          this._currentRun = null;
          this._notifyResults(results);
          this._scheduleNext();
        });
    },


    _notifyResults: function(results) {
      this._schedulerRef.get().runSoon(_.bind(function() {

        if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
          return;
        }

        if (Log.isTraceEnabled()) {
          Log.trace("Notifying results", results);
        }

        this._channel.publish(this, results);
      }, this));
    },


    _scheduleNext: function(now) {
      if (this._stateGuard.applied("disposed") || !this._stateGuard.applied("started")) {
        return;
      }
      this._taskId = this._schedulerRef.get().schedule(this._runTask, now ? 0 : this._interval);
      Log.trace("Scheduled task", this._taskId);
    },


    _cancelPending: function() {
      Log.trace("cancelPending requested, looking for pending task.");
      if (this._taskId) {
        Log.trace("Found pending task; cancelling", this._taskId);
        this._schedulerRef.get().unschedule(this._taskId);
        this._taskId = null;
      }
    },

    _cancelOutstanding: function() {
      Log.trace("cancelOutstanding requested, looking for outstanding work.");
      if (this._currentRun) {
        Log.trace("Outstanding work found; cancelling");
        this._currentRun.cancel();
        this._currentRun = null;
      }
    },

    dispose: function(){
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._cancelPending();
      this._cancelOutstanding();

      this._stateGuard.apply("disposed");
    }
  });

  return Periodic;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/logging/logger")
);

})()
},{"../core/options":8,"../core/state-guard":10,"../core/channel/channel":31,"../core/channel/chained-channel":32,"../core/logging/logger":29,"underscore":61,"bluebird":62}],6:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  StateGuard
) {

  /**
   * Attempts to intelligently dispatch an object with an mT attribute, using
   * the rules provided at instantiation.
   *
   * For a given mTyped object, searches the provided `delegate` for a method
   * named [prefix][camel-cased mT], and if present, calls it. If not found,
   * looks for [prefix]Else. If the mT attribute isn't found, dispatches to
   * [prefix]Malformed.
   */
  var Dispatcher = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_CONTEXT_DELEGATE = function() {
    return {};
  };

  _.extend(Dispatcher.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegate        = opts.getOrError("delegate"),
      this._prefix          = opts.getOrElse("prefix", "onMsg");
      this._elseSuffix      = opts.getOrElse("elseSuffix", "else");
      this._malformedSuffix = opts.getOrElse("malformedSuffix", "malformed");
      this._contextDelegate = opts.getOrElse("contextDelegate", DEFAULT_CONTEXT_DELEGATE);
      this._stateGuard      = new StateGuard(["disposed"]);
      this._subs            = M.hash_map();

      var channels = opts.getOrElse("listen", []);

      if (!_.isArray(channels)) {
        channels = [channels];
      }

      _.each(channels, _.bind(function(c) {
        this.listen(c)
      }, this));
    },

    listen: function(channel) {
      this._stateGuard.deny("disposed");

      var sub = channel.subscribe(_.bind(function(msg) {
        this.dispatch(msg);
      }, this));

      this._subs = M.assoc(this._subs, sub.id(), sub);

      return {
        dispose: _.bind(function(){
          var nSub = M.get(this._subs, sub.id());
          if (nSub) {
            this._subs = M.dissoc(this._subs, sub.id());
            nSub.dispose();
          }
        }, this)
      }
    },

    dispatch: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);

      if (handler) {
        this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    /**
     * Like `dispatch`, but expects delegate to return a Promise<object>
     */
    dispatchAsync: function(mTyped, ctx) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var handler = this._getVettedHandlerName(mTyped);
      if (handler) {
        return this._delegate[handler](mTyped, this._contextDelegate(mTyped, ctx));
      }
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      var subs = this._subs;
      this._subs = M.hash_map();

      M.each(subs, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _getHandlerName: function(prefix, suffix) {
      return prefix + suffix.charAt(0).toUpperCase() + suffix.substr(1);
    },

    // FIXME: Check for "reserved" mTypes (_elseSuffix, _malformedSuffix, etc), log warning
    _getVettedHandlerName: function(mTyped) {
      var mT = mTyped.mT,
          prefix = this._prefix,
          potentialHandlerName,
          finalHandlerName;

      if (!mT) {
        finalHandlerName = this._getHandlerName(prefix, this._malformedSuffix);
      } else {
        potentialHandlerName = this._getHandlerName(prefix, mT);
        if (_.isFunction(this._delegate[potentialHandlerName])) {
          finalHandlerName = potentialHandlerName;
        } else {
          finalHandlerName = this._getHandlerName(prefix, this._elseSuffix);
        }
      }

      if (_.isFunction(this._delegate[finalHandlerName])) {
        return finalHandlerName;
      }
    }
  });

  return Dispatcher;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("./options"),
  require("./state-guard")
);

})()
},{"./options":8,"./state-guard":10,"underscore":61,"mori":63}],8:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _
) {

  /**
   *
   * Helper for dealing with hash-style function arguments, which can be useful
   * in methods with optional/default values.
   *
   * Usage:
   *
   *   var foo = function(opts) {
   *       opts = Options.fromObject(opts);
   *
   *       var one = opts.getOrError("one"),
   *           two = opts.getOrElse("two", 2),
   *           three = opts.getOrElseFn("three", function() {
   *             return 3;
   *           });
   *
   *     console.log(one, two, three);
   *   };
   *
   *   foo({ one: 1 }); // logs "1, 2, 3"
   *   foo(); // throws Error
   *   foo({one: 1, two: false, three: 4}); // logs "1, false, 4"
   *
   */
  var Options = function(opts) {
    this.initialize.apply(this, arguments);
  }

  _.extend(Options.prototype, {
    initialize: function(opts) {
      this._providedOpts = opts || {};
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead returns the provided `fallbackValue`.
     *
     * @param key (required) attribute to be read
     * @param fallbackValue  returned if `key` attribute is null or undefined
     *
     * @returns requested value for `key`, or fallbackValue`
     */
    getOrElse: function(key, defaultValue) {
      if (this._isUndefOrNull(key)) {
        return defaultValue;
      } else {
        return this._providedOpts[key];
      }
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, throws an error.
     *
     * @param key (required) attribute to be read
     * @param err            message provided to Error constructor if `key`
     *                       is null or not defined
     *
     * @returns the value for the requested key
     */
    getOrError: function(key, errorMsg) {
      if (this._isUndefOrNull(key)) {
        errorMsg = errorMsg || "Option requested but not found: `"+key+"`";
        throw new Error(errorMsg);
      }

      return this._providedOpts[key];
    },

    /**
     * Attempts to return the value for the requested `key`. If the value
     * is undefined or null, instead evaluates `fallbackValueFn` and returns
     * its value.
     *
     * This is useful for simulating non-strict evaluation.
     *
     * @param key (required)  attribute to be read
     * @param fallbackValueFn evaluated and return value returned if `key`
     *                        attribute is null or undefined
     *
     * @returns requested value for `key` or the return value of evaluated
     *          `fallbackValueFn`
     */
    getOrElseFn: function(key, defaultValueFn) {
      if (typeof defaultValueFn !== "function") {
        throw new Error("Options#getOrElseFn requires a defaultValueFn");
      }

      if (this._isUndefOrNull(key)) {
        return defaultValueFn();
      } else {
        return this._providedOpts[key];
      }
    },


    toObject: function() {
      return _.clone(this._providedOpts);
    },

    scope: function(prefix) {
      return Options.fromObjectWithPrefix(this.toObject(), prefix);
    },

    _isUndefOrNull: function(key) {
      return typeof this._providedOpts[key] === "undefined" || this._providedOpts[key] === null;
    }
  });

  _.extend(Options, {
    fromObject: function(opts) {
      return new Options(opts);
    },


    fromObjectWithPrefix: function(opts, prefix) {
      opts = _.reduce(opts, function(memo, val, key) {
        var rest, newKey;
        if (key.indexOf(prefix) === 0) {
          rest = key.substr(prefix.length);
          if (rest.length > 1) {
            newKey = rest.charAt(0).toLowerCase() + rest.substr(1);
            memo[newKey] = val;
          }
        }
        return memo;
      }, {});

      return new Options(opts);
    }
  })

  return Options;
};

module.exports = factory(
  require("underscore")
);

})()
},{"underscore":61}],7:[function(require,module,exports){
(function(){/*global require: false, module: false */

var mod = function (
  _
  ) {

  /**
   * A device which calls the provided completionCallback after `steps` calls to `CountdownLatch#step()`.
   *
   */

  var CountdownLatch = function () {
        this.initialize.apply(this, arguments);
      },
      noop = function() {};

  _.extend(CountdownLatch.prototype, {
    initialize: function (steps, completionCallback) {
      this._steps = steps || 0;
      this._completionCallback = completionCallback || noop;
      _.bindAll(this, "_completionCallback", "_triggerCompletion");
      if(isNaN(this._steps) || this._steps < 0) {
        throw new Error("CountdownLatch: Number of steps are invalid.");
      }
      this._current = 0;
      this._complete = false;
      this._error = null;
      if(this._steps === 0) {
        _.defer(this._triggerCompletion);
        return;
      }
    },
    step: function (steps) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._current += steps || 1;
      if (this._current >= this._steps) {
        this._triggerCompletion();
      }
    },
    error: function (err) {
      if (this._complete || this._steps === 0) {
        return;
      }
      this._error = err;
      this._triggerCompletion();
    },
    _triggerCompletion: function () {
      if (this._complete) {
        return;
      }
      this._complete = true;
      if (this._error) {
        _.defer(_.bind(this._completionCallback, null, this._error));
      } else {
        _.defer(this._completionCallback);
      }
    }
  });

  return CountdownLatch;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],9:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var factory = function(
  _,
  Promise,
  Options
) {

  /**
   * A utility singleton for "language extensions".
   */
  var Lang = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Lang.prototype, {
    initialize: function(){}
  });

  _.extend(Lang, {
    noop: function() {},

    partiallyApply: function() {
      var args = _.toArray(arguments),
          fun  = args.shift();

      return function() {
        return fun.apply(null, args.concat(arguments));
      };
    },

    makeErrorClass: function(name, defaultMessage) {
      if (!name) {
        throw new Error("makeErrorClass requires `name`");
      }

      var klass = function(message) {
        this.name    = name;
        this.message = this.name + ": " + (message || defaultMessage || "An unexpected error occurred");

        if (Error.captureStackTrace) {
          Error.captureStackTrace(this, klass);
        }
      };

      klass.prototype = Object.create(Error.prototype);
      klass.prototype.constructor = klass;
      return klass;
    },

    pojoClass: function(attributes, options) {
      if (!_.isArray(attributes)) {
        throw new Error("Lang#pojoClass requires attributes array");
      }

      var options = Options.fromObject(options),
          // optional specifies keys that are optional, with values that are default if not provided
          defaults = options.getOrElse("defaults", {}),
          optionalAttributes = _.keys(defaults);

      var toAttributeName = function(attr) {
            return "_" + attr;
          },
          toGetter = function(attr) {
            return attr;
          },
          toSetter = function(attr) {
            return "set" + attr.charAt(0).toUpperCase() + attr.substr(1);
          };

      var klass = function() {
        this.initialize.apply(this, arguments);
      };

      _.extend(klass.prototype, {
        initialize: function(opts) {
          opts = Options.fromObject(opts);
          _.each(attributes, function(attr) {
            if (_.contains(optionalAttributes, attr)) {
              this[toAttributeName(attr)] = opts.getOrElse(attr, defaults[attr]);
            } else {
              this[toAttributeName(attr)] = opts.getOrError(attr);
            }
          }, this);
        }
      });

      _.each(attributes, function(attr) {
        klass.prototype[toGetter(attr)] = function() {
          return this[toAttributeName(attr)];
        };
        klass.prototype[toSetter(attr)] = function(v) {
          this[toAttributeName(attr)] = v;
        };
      });

      return klass;
    },

    deferred: function(promiseClass) {
      promiseClass = promiseClass || Promise;
      var res = null, rej = null;
      var p = new promiseClass(function() {
        res = arguments[0];
        rej = arguments[1];
      });

      return {
        promise: p,
        resolve: res,
        reject:  rej
      };
    }
  });

  return Lang;
};

module.exports = factory(
  require("underscore"),
  require("bluebird"),
  require("./options")
);

})()
},{"./options":8,"underscore":61,"bluebird":62}],10:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A StateGuard does what its name implies. Valid states are provided during instantiation, and are applied, ensured,
   * denied, etc, through the course of the owner's lifetime.
   *
   * For example, if you'd like to ensure that Foo#bar raises an error after Foo#dispose is called, you might do the
   * following:
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = new StateGuard(["disposed"]);
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied("disposed")) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply("disposed");
   *     },
   *     bar: function() {
   *       this._stateGuard.deny("disposed"); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   * In this case, where we have only one state, it's useful to simply create a scoped StateGuard, which behaves
   * identically to a regular one, except every enforcement/query method has the scope provided during instantiation
   * as a first, implicit argument:
   *
   *   // Identical to previous version.
   *
   *   var Foo = function() {
   *     this.initialize.apply(this, arguments);
   *   };
   *
   *   _.extend(Foo.prototype, {
   *     initialize: function() {
   *       this._expensiveResource = new ExpensiveResource();
   *       this._stateGuard = StateGuard.scoped("disposed");
   *     },
   *     dispose: function() {
   *       // #dispose should be idempotent, so here we just check to see if we've already disposed, and return.
   *       // Note that if dispose were async, we'd need to add a "disposing" state.
   *       if (this._stateGuard.applied()) {
   *         return;
   *       }
   *
   *       if (this._expensiveResource) {
   *         this._expensiveResource.dispose();
   *         this._expensiveResource = null;
   *       }
   *       this._stateGuard.apply();
   *     },
   *     bar: function() {
   *       this._stateGuard.deny(); // Throws exception if #dispose was called
   *
   *       return this._expensiveResource.someMethod();
   *     }
   *   });
   *
   */
  var StateGuard = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StateGuard.prototype, {
    initialize: function(states) {
      this._validStates = _.reduce(states, function(memo, state) {
        memo[state] = true;
        return memo;
      }, {});

      this._appliedStates = {};
    },

    scope: function(state) {
      var skip = ["scope", "initialize"],
          self = this,
          scoped = {};

      _.each(StateGuard.prototype, function(fun, methodName) {
        if (_.contains(skip, methodName)) {
          return;
        }

        scoped[methodName] = function() {
          var args = _.toArray(arguments);
          args.unshift(state);
          return fun.apply(self, args);
        };
      });

      return scoped;
    },

    apply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        this._appliedStates[state] = true;
      }, this);

      return this;
    },

    applyAsync: Promise.method(function() {
      return this.apply.apply(this, arguments);
    }),

    applyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.applyAsync.apply(this, args);
      }, this);
    },

    unapply: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      _.each(states, function(state) {
        if (this._appliedStates[state]) {
          delete this._appliedStates[state];
        }
      }, this);

      return this;
    },

    unapplyAsync: Promise.method(function() {
      return this.unapply.apply(this, arguments);
    }),

    unapplyAsyncFn: function(states) {
      var args = arguments;
      return _.bind(function() {
        return this.unapplyAsync.apply(this, args)
      }, this);
    },

    deny: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      var applied = _.filter(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (applied.length > 0) {
        throw new Error("State denial requested, but applied: " + pretty(applied));
      }

      return this;
    },

    denyAsync: Promise.method(function() {
      return this.deny.apply(this, arguments);
    }),

    denyAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.denyAsync.apply(this, args)
      }, this);
    },

    ensure: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);
      var missing = _.reject(states, function(state) {
        return this._appliedStates[state];
      }, this);

      if (missing.length > 0) {
        throw new Error("State ensurance requested, but not applied: " + pretty(missing));
      }
      return this;
    },

    ensureAsync: Promise.method(function() {
      return this.ensure.apply(this, arguments);
    }),

    ensureAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.ensureAsync.apply(this, args);
      }, this);
    },

    applied: function() {
      var states = aryOrVariadicToArray(arguments);
      checkValidStatesOrThrow(this._validStates, states);

      return _.every(states, function(state) {
        return this._appliedStates[state];
      }, this);
    },

    appliedAsync: Promise.method(function() {
      return this.applied.apply(this, arguments);
    }),

    appliedAsyncFn: function() {
      var args = arguments;
      return _.bind(function() {
        return this.appliedAsync.apply(this, args)
      }, this);
    }
  });

  var aryOrVariadicToArray = function(args) {
    return _.chain(args).toArray().flatten().value();
  };

  var checkValidStatesOrThrow = function(validStatesMap, states) {
    var invalidStates = _.reject(states, function(state) {
      return !!validStatesMap[state];
    });

    if (invalidStates.length > 0) {
      throw new Error("Invalid states provided: " + pretty(invalidStates));
    }
  };

  var pretty = function(states) {
    return "["+states.join(",")+"]";
  };

  _.extend(StateGuard, {
    scoped: function(scope) {
      return (new StateGuard([scope])).scope(scope);
    }
  })

  return StateGuard;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"underscore":61,"bluebird":62}],12:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A mixin enabling pubsub on an object. To use, copy the singleton methods into the object or object prototype:
   *
   *     var myObj = _.extend({}, PubSub);
   *     myObj.on('foo', function(evt) { console.log(evt) }); // logs `{ 'some': 'data' }`
   *     myObj.notify('foo', { some: 'data' });
   *
   */
  var PubSub = {
    on: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.subscribe(handler, context);
    },
    off: function(eventName, handler, context) {
      var bucket = this.__pubSubBucket(eventName);
      bucket.unsubscribe(handler, context);
    },
    notify: function() {
      var args      = _.toArray(arguments),
          eventName = args.shift();

      var bucket = this.__pubSubBucket(eventName);
      bucket.notify(args);
    },
    __pubSubBucket: function(eventName) {
      this.__pubSubEvents = this.__pubSubEvents || {};
      this.__pubSubEvents[eventName] = this.__pubSubEvents[eventName] || new EventBucket(eventName);
      return this.__pubSubEvents[eventName];
    }
  };

  var EventBucket = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(EventBucket.prototype, {
    initialize: function(eventName) {
      this._eventName = eventName;
      this._subscriptions = [];
    },
    subscribe: function(handler, context) {
      if (handler) {
        this._subscriptions.push(new Subscription(handler, context));
      } else {
        throw new Error("Subscription requires handler: " + this._eventName);
      }
    },
    unsubscribe: function(handler, context) {
      var subs;
      if (handler) {
        subs = _.filter(this._subscriptions, function(sub) {
          return sub.matches(handler, context);
        });
      } else {
        subs = this._subscriptions;
      }

      _.each(subs, function(sub) {
        sub.dispose();
      });

      this._subscriptions = _.difference(this._subscriptions, subs);
    },
    notify: function(args) {
      _.invoke(this._subscriptions, "notify", args);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(handler, context) {
      this._handler = handler;
      this._context = context;
    },
    matches: function(handler, context) {
      if (this._context) {
        // Compare context refs as refs iff we have a context object
        return (handler === this._handler && context === this._context);
      } else {
        // Otherwise, just make sure we don't have a context (null or undefined are fine)
        return (handler === this._handler && !context);
      }
    },
    notify: function(args) {
      // We shouldn't be called after dispose, but
      // just in case...
      if (this._handler) {
        this._handler.apply(this._context, args);
      } else {
        console.log("WTF");
      }
    },
    dispose: function() {
      this._handler = null;
      this._context = null;
    }
  })

  return PubSub;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],17:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * Delegates storage to a JS object.
   */
  var ObjectHashMap = function() {
    this.initialize.apply(this, arguments);
  };


  _.extend(ObjectHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._store = {};
      this._keyPrefix = opts.getOrElse("keyPrefix", "ohm-");
    },
    get: function(key){
      return this._store[this._makeKey(key)];
    },
    put: function(key, val) {
      this._store[this._makeKey(key)] = val;
    },
    remove: function(key) {
      var val;
      key = this._makeKey(key);
      if (_.has(this._store, key)) {
        val = this._store[key];
        delete this._store[key];
      }
      return val;
    },
    exists: function(key) {
      return _.has(this._store, this._makeKey(key));
    },
    size: function() {
      return _.size(this._store);
    },
    clear: function() {
      this._store = {};
    },
    _makeKey: function(key) {
      return this._keyPrefix + key;
    }
  });


  return ObjectHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":61}],16:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * A doubly-linked list implementation.
   *
   */
  var DoublyLinkedList = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DoublyLinkedList.prototype, {
    initialize: function() {
      this._front = null;
      this._back = null;
      this._size = 0;
    },

    get: function(idx) {
      this._checkElementIdxOrThrow(idx);
      var node = this._walkToIdx(idx);
      return node.value();
    },

    exists: function(value) {
      var node = this._walkToValue(value);
      return !!node;
    },

    size: function() {
      return this._size;
    },

    add: function(value) {
      return this.addBack.apply(this, arguments);
    },

    addFront: function(value) {
      this._linkFront(value);
    },

    addBack: function(value) {
      this._linkBack(value);
    },

    remove: function(value) {
      var node = this._walkToValue(value);
      return this._unlink(node);
    },

    removeFront: function() {
      if (this._front === null) {
        throw new Error("No such element");
      }
      return this._unlinkFront(this._front);
    },

    removeBack: function() {
      if (this._back === null) {
        throw new Error("No such element");
      }
      return this._unlinkBack(this._back);
    },

    insertAtIndex: function(idx, value) {
      this._checkIsElementPositionOrThrow(idx);

      if (idx === this._size) {
        this.addBack(value);
      } else {
        var node = this._walkToIdx(idx);
        this._linkBefore(value, node);
      }
    },

    removeAtIndex: function(idx) {
      this._checkElementIdxOrThrow(idx);
      if (idx === 0) {
        return this._unlinkFront(this._front);
      } else if ( idx === (this._size - 1) ) {
        return this._unlinkBack(this._back);
      } else {
        var node = this._walkToIdx(idx);
        return this._unlink(node);
      }
    },

    clear: function() {
      var node = this._front,
          next;

      while (node !== null) {
        next = node.next();
        node.dispose();
        node = next;
      }
      this._front = null;
      this._back  = null;
      this._size = 0;
    },

    _linkFront: function(value) {
      var oldFront = this._front,
          newNode = new Node({value: value});
      this._front = newNode;

      if (oldFront === null) {
        this._back = newNode;
      } else {
        oldFront.setPrev(newNode);
        newNode.setNext(oldFront);
      }

      this._size++;
      return newNode;
    },

    _linkBack: function(value) {
      var oldBack = this._back,
          newNode = new Node({value: value});

      this._back = newNode;
      if (oldBack === null) {
        this._front = newNode;
      } else {
        oldBack.setNext(newNode);
        newNode.setPrev(oldBack);
      }

      this._size++;
      return newNode;
    },

    _linkBefore: function(value, node) {
      var pred    = node.prev(),
          newNode = new Node({value: value, prev: pred, next: node});

      node.setPrev(newNode);
      if (pred === null) {
        this._front = newNode;
      } else {
        pred.setNext(newNode);
      }
      this._size++;
      return newNode;
    },

    _unlinkFront: function(node) {
      var value    = node.value(),
          newFront = node.next();

      node.dispose();
      this._front = newFront;
      if (newFront === null) {
        this._back = null;
      } else {
        newFront.setPrev(null);
      }
      this._size--;
      return value;
    },

    _unlinkBack: function(node) {
      var value   = node.value(),
          newBack = node.prev();

      node.dispose();
      this._back = newBack;
      if (newBack == null) {
        this._front = null;
      } else {
        newBack.setNext(null);
      }
      this._size--;
      return value;
    },

    _unlink: function(node) {
      var prev  = node.prev(),
          next  = node.next(),
          value = node.value();

      if (prev === null) {
        this._front = next;
      } else {
        prev.setNext(next);
      }

      if (next === null) {
        this._back = prev;
      } else {
        next.setPrev(prev);
      }

      node.dispose();
      this._size--;
      return value;
    },

    _walkToIdx: function(idx) {
      var node, current;
      if (idx < this._size / 2) {
        node = this._front;
        current = 0;
        while(current !== idx) {
          node = node.next();
          current++;
        }
      } else {
        node = this._back;
        current = this._size - 1;

        while(current !== idx) {
          node = node.prev();
          current--;
        }
      }
      return node;
    },

    _walkToValue: function(value) {
      var n = this._front;
      while (n !==null ) {
        if (n.match(value)) {
          return n;
        }
        n = n.next();
      }
      return null;
    },

    _isElementIdx: function(idx) {
      return (idx >= 0 && idx < this._size);
    },

    _isElementPosition: function(idx) {
      return (idx >= 0 && idx <= this._size);
    },

    _checkElementIdxOrThrow: function(idx) {
      if (!this._isElementIdx(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    },

    _checkIsElementPositionOrThrow: function(idx) {
      if (!this._isElementPosition(idx)) {
        throw new Error("Index out of bounds; size: " + this._size + "; idx: " + idx);
      }
    }

  });

  var Node = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Node.prototype, {
    initialize: function(opts) {
      opts        = Options.fromObject(opts);
      this._next  = opts.getOrElse("next", null);
      this._prev  = opts.getOrElse("prev", null);
      this._value = opts.getOrElse("value", null);
    },

    next: function() {
      return this._next;
    },

    prev: function() {
      return this._prev;
    },

    setNext: function(node) {
      this._next = node;
    },

    setPrev: function(node) {
      this._prev = node;
    },

    value: function() {
      return this._value;
    },

    dispose: function() {
      this._next  = null;
      this._prev  = null;
      this._value = null;
    },

    match: function(value) {
      return this._value === value;
    }
  });

  return DoublyLinkedList;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":61}],18:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  ObjectHashMap,
  DoublyLinkedList
) {

  /**
   * An in-memory hash map with an LRU eviction policy.
   *
   */
  var LRUHashMap = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUHashMap.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._capacity = opts.getOrError("capacity");
      this._keyAccessList = new DoublyLinkedList();
      // TODO: Really need a proper HashMap at some point...
      this._store = new ObjectHashMap();
    },
    get: function(key) {
      var entry = this._store.get(key);
      if (!entry) {
        return;
      }

      // As a perf optimization, we keep a ref
      // to the node in the entry.
      var node = entry.node();
      this._keyAccessList._unlink(node);

      // Get the new node
      node = this._keyAccessList._linkFront(entry.key());

      // Save it
      entry.setNode(node);
      // Return the value
      return entry.value();
    },

    put: function(key, val) {
      var entry = this._store.get(key),
          node;
      if (!entry) {
        // If no entry, make a new entry
        if (this._keyAccessList.size() >= this._capacity) {
          // Have to make room for it
          var evictedKey = this._keyAccessList.removeBack(),
              evictedEntry = this._store.get(evictedKey);

          evictedEntry.dispose();
          this._store.remove(evictedKey);
        }

        node = this._keyAccessList._linkFront(key);
        entry = new Entry({
          key: key,
          value: val,
          node: node
        });
        this._store.put(key, entry);
      } else {
        // "Touch" the entry, set new value
        node = entry.node();
        this._keyAccessList._unlink(node);
        node = this._keyAccessList._linkFront(entry.key());
        // Update with the new node and value
        entry.setNode(node);
        entry.setValue(val);
      }
    },

    remove: function(key) {
      var entry = this._store.get(key),
          value,
          node;
      if (entry) {
        value = entry.value();
        node = entry.node();
        this._keyAccessList._unlink(node);
        entry.dispose();
        this._store.remove(key);
        return value;
      }
    },

    exists: function(key) {
      return this._store.exists(key);
    },

    size: function() {
      return this._store.size();
    },

    clear: function() {
      this._store.clear();
      this._keyAccessList.clear();
    }
  });

  var Entry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Entry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Though the Node should have the key, if the node
      // is unlinked from the list, its boxed value will disappear
      this._key   = opts.getOrError("key");
      this._value = opts.getOrError("value");
      this._node  = opts.getOrError("node");
    },
    node: function() {
      return this._node;
    },
    setNode: function(node) {
      this._node = node;
    },
    value: function() {
      return this._value;
    },
    setValue: function(value) {
      this._value = value;
    },
    key: function() {
      return this._key;
    },
    dispose: function() {
      this._key = null;
      this._value = null;
      this._node = null;
    }
  });

  return LRUHashMap;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./object-hash-map"),
  require("./doubly-linked-list")
);

})()
},{"../core/options":8,"./object-hash-map":17,"./doubly-linked-list":16,"underscore":61}],19:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  InMemoryDataStore,
  UnitSequencer,
  Entry
) {

  // Appropriate for the default sequencer (non-temporal)
  var DEFAULT_TTL = 1;


  /**
   * A look-aside caching data store. Note: it's generally not useful to allow
   * null/undefined stored values. When an item is evicted from the cache, a
   * subsequent `get` call will return `undefined`, so it can be difficult to
   * determine if there was a cache miss if the value you're storing is, in fact,
   * `undefined`, unless you prefix every check with `exists`, which also does
   * cache eviction on check.
   */
  var CachingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CachingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      // Default sequencer is a linear/unit sequencer. The default TTL is
      // 1. Therefore, all values will expire with single advance of the
      // sequencer. Note that the data store doesn't advance the
      // sequencer itself. The store owner is responsible for doing
      // this.
      //
      // This is especially important to note for time-based sequencers.
      // Time will not advance automatically. The store owner is responsible
      // for scheduling the sequencer to advance with time. This keeps the
      // CachingDataStore's lifecycle simple with respect to time.
      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      // By default, we delegate to an in-memory store. Fine for simple
      // cases, but not optimal.
      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      // Updates the lastUpdated time to "now" on read - keeps entries
      // from expiring when they're being accessed, but can cause
      // staleness issues.
      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);
    },

    sequencer: function() {
      return this._sequencer;
    },


    /**
     * Gets the value associated with the provided key. If the object has
     * expired, it will be evicted from the cache, and `undefined` will
     * be returned instead.
     *
     * @param key {string} (required)
     * @async
     * @returns {Promise<Object>} requested value
     */
    get: Promise.method(function(key) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry){
          if (!entry) {
            return;
          }

          if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
            if (this._shouldTouchOnRead) {
              entry.touch(this._sequencer.value());
            }
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .return(entry.value());
          } else {
            return Promise
              .bind(this)
              .then(function() {
                return this.remove(key)
              })
              .then(function() {
                // .thenReturn is a lie.
                return;
              });
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`
     *
     * @param `key` {string}  (required) identifier for value to be stored
     * @param `val` {dynamic} (required) value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val) {
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          // If we have an entry, we should just update
          // Else, we make new one.
          // Pesist, then return nothing.
          if (entry) {
            entry.update(val, this._sequencer.value());
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value()
            });
          }

          return Promise
            .bind(this)
            .then(function() {
              return this._backingStore.put(key, entry)
            })
            .then(function() {
              return;
            });
        });
    }),

    /**
     * Removes the value associated with the provided `key`
     *
     * @param `key` {string} (required) identifier for value to be removed
     * @async
     * @returns {Promise<dynamic>} Removed value, if present in store.
     */
    remove: Promise.method(function(key) {
      var val;
      return this._backingStore
        .remove(key)
        .then(function(entry) {
          if (entry) {
            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),

    exists: Promise.method(function(key){
      // It's not sufficient to delegate this call to the underlying
      // backing store. We need to perform eviction, as a subsequent call
      // to get would do the same. If the `exists` check says it exists,
      // bet it doesn't when we `get`, then `exists` is a worthless operation.
      //
      // Note that if you're using a CachingDataStore backed by an InMemoryDataStore
      // backed by an LRUHashMap, this will cause the entry to be "touched", whereas
      // a normal "exists" check would not.
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
            if (!entry) {
              return false;
            } else {
              if (!entry.isExpired(this._sequencer.value(), this._ttl)) {
                return true;
              } else {
                return this._backingStore.remove(key)
                  .then(function() {
                    entry.dispose();
                  })
                  .thenReturn(false);
              }
            }
        });
    }),

    clear: Promise.method(function() {
      return this._backingStore.clear();
    })
  });

  return CachingDataStore;

};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../core/sequencer/unit-sequencer"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":8,"../core/sequencer/unit-sequencer":11,"./in-memory-data-store":20,"./internals/expiring-entry":60,"underscore":61,"bluebird":62}],21:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  InMemoryDataStore,
  LRUHashMap
) {

  /**
   * A Data Store with an LRU eviction policy.
   *
   */
  var LRUDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LRUDataStore.prototype, InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      var map = new LRUHashMap({
        capacity: opts.getOrError("capacity")
      });
      InMemoryDataStore.prototype.initialize.call(this, {
        backingHashMap: map
      });
    }
  });

  return LRUDataStore;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("./in-memory-data-store"),
  require("../collection/lru-hash-map")
);

})()
},{"../core/options":8,"./in-memory-data-store":20,"../collection/lru-hash-map":18,"underscore":61}],20:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  ObjectHashMap
) {

  /**
   * InMemoryDataStore delegates to a backing HashMap. By default, this
   * will be a "poor man's HashMap", a.k.a., the ObjectHashMap.
   */
  var InMemoryDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(InMemoryDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._map = opts.getOrElseFn("backingHashMap", function() {
        return new ObjectHashMap();
      });
    },

    get: Promise.method(function(key) {
      return this._map.get(key);
    }),

    put: Promise.method(function(key, val) {
      return this._map.put(key, val);
    }),

    remove: Promise.method(function(key) {
      return this._map.remove(key);
    }),

    exists: Promise.method(function(key){
      return this._map.exists(key);
    }),

    clear: Promise.method(function() {
      return this._map.clear();
    })
  });

  return InMemoryDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../collection/object-hash-map")
);

})()
},{"../core/options":8,"../collection/object-hash-map":17,"underscore":61,"bluebird":62}],22:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  Channel,
  ChainedChannel,
  UnitSequencer,
  DelegatingForwardingSequencer,
  InMemoryDataStore,
  Entry
) {

  /**
   * Semantically similar to a CachingDataStore, except:
   *   1) Expiry is check both on access, and whenever `advance` is
   *      called on the `sentrySequencer`.
   *   2) Records are not automatically removed; instead, a signal is sent
   *      along the `signalChannel`. The signal dispatch is deferred, so
   *      an access-triggered evocation signal won't be received until a
   *      subsequent tick. Since promises are asynchronous, this means
   *      the caller may receive a value from the store, and may also
   *      receive an event from the Store indicating expiry - in non-deterministic
   *      order. It's up to the caller to choose a resolution.
   *      Additionally, there is no guarantee that a single expiry event
   *      will be sent for a given key; instead, the event will continue
   *      to be dispatched for as long as the key remains in the store.
   * @constructor
   */
  var SignalingDataStore = function() {
    this.initialize.apply(this, arguments);
  };

  var DEFAULT_TTL = 1;

  _.extend(SignalingDataStore.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl", DEFAULT_TTL);

      this._sequencer = opts.getOrElseFn("sequencer", function() {
        return new UnitSequencer();
      });

      _.bindAll(this, "_doCheck");

      this._sentrySequencer = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [{
          advance: this._doCheck
        }]
      });

      this._backingStore = opts.getOrElseFn("backingStore", function() {
        return new InMemoryDataStore();
      });

      this._shouldTouchOnRead = opts.getOrElse("touchOnRead", false);

      this._signalChannel = new Channel({ sentinel: this });

      this._keys = M.set();
    },

    sequencer: function() {
      return this._sequencer;
    },

    sentrySequencer: function() {
      return this._sentrySequencer;
    },

    signalChannel: function() {
      return new ChainedChannel({
        sentinel: this,
        chainTo: this._signalChannel
      });
    },

    _doCheck: function() {
      var work = M.map(_.bind(function(key) {
        return Promise
          .bind(this)
          .then(function() {
            return this._backingStore.get(key);
          })
          .then(function(entry) {
            if (entry && entry.isExpired(this._sequencer.value(), this._ttl)) {
              this._signalExpirySoon(key, this._sequencer.value());
            }
          });
        }, this), this._keys);

      return Promise.all(M.into_array(work));
    },

    /**
     * Gets the value associated with the provided `key`. If the object
     * has expired, it will still be returned from the Store, but an mT:expired
     * message will be sent along the `signalChannel`.
     *
     * @param key {string}
     * @async
     * @returns {Promise<object>} requested value
     */
    get: Promise.method(function(key){
      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (!entry) {
            return;
          }

          var isExpired = entry.isExpired(this._sequencer.value(), this._ttl);

          if (isExpired) {
            this._signalExpirySoon(key, this._sequencer.value());
          }

          if (!isExpired && this._shouldTouchOnRead) {
            entry.touch(this._sequencer.value());
            return Promise
              .bind(this)
              .then(function() {
                return this._backingStore.put(key, entry);
              })
              .thenReturn(entry.value());
          } else {
            return entry.value();
          }
        });
    }),

    /**
     * Stores the provided `val`, identified by `key`, with a TTL optionally
     * supplied by `opts.ttl` (overrides pre-configured Store TTL.
     *
     * @param key {String}
     * @param val {object} value to be stored
     * @async
     * @returns {Promise<>}
     */
    put: Promise.method(function(key, val, opts) {
      opts = Options.fromObject(opts);

      return Promise
        .bind(this)
        .then(function() {
          return this._backingStore.get(key);
        })
        .then(function(entry) {
          if (entry) {
            entry.update(val, this._sequencer.value(), {
              ttl: opts.getOrElse("ttl")
            });
          } else {
            entry = new Entry({
              value: val,
              initialSequence: this._sequencer.value(),
              ttl: opts.getOrElse("ttl")
            });
          }
          return Promise
            .bind(this)
            .then(function () {
              return this._backingStore.put(key, entry);
            })
            .then(function() {
              this._keys = M.conj(this._keys, key);
              return; // Because thenReturn doesn't work with an empty value.
            });
        });
    }),


    /**
     * Removes the value associated with the provided `key`
     */
    remove: Promise.method(function(key){
      var val;
      return this._backingStore
        .remove(key)
        .bind(this)
        .then(function(entry) {
          if (entry) {
            this._keys = M.disj(this._keys, key);

            val = entry.value();
            entry.dispose();
            return val;
          }
        });
    }),


    exists: Promise.method(function(key){
      // Unlike in the CachingDataStore, where we have to perform eviction rules before
      // returning the answer, here we can just delegate straight to the backing store.
      return this._backingStore.exists(key);
    }),


    clear: Promise.method(function(){
      return this._backingStore.clear();
    }),


    _signalExpirySoon: function(key, sequence) {
      _.defer(_.bind(function(){
        this._signalChannel.publish(this, {
          mT: "expired",
          key: key,
          sequence: sequence
        });
      }, this));
    }
  });

  return SignalingDataStore;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/channel/channel"),
  require("../core/channel/chained-channel"),
  require("../core/sequencer/unit-sequencer"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("./in-memory-data-store"),
  require("./internals/expiring-entry")
);

})()
},{"../core/options":8,"../core/channel/channel":31,"../core/channel/chained-channel":32,"../core/sequencer/unit-sequencer":11,"../core/sequencer/delegating-forwarding-sequencer":15,"./in-memory-data-store":20,"./internals/expiring-entry":60,"underscore":61,"bluebird":62,"mori":63}],25:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfigurationResolver
) {

  /**
   * A utility "class" for configuration-related functionality.
   * @constructor
   */
  var ConfigurationMagic = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ConfigurationMagic.prototype, {
    initialize: function() {}
  });

  _.extend(ConfigurationMagic, {
    /**
     * Returns a resolved configuration, given multiple configuration documents and a set of scopes. See
     * `ScopedConfigurationResolver`.
     */
    resolveConfig: function(scopes, configObjects) {
      var r = new ScopedConfigurationResolver();
      _.each(configObjects, function(c) {
        r.add(c);
      });
      return r.resolve(scopes);
    }
  });

  return ConfigurationMagic;
};

module.exports = mod(
  require("underscore"),
  require("./config/scoped-configuration-resolver")
);

})()
},{"./config/scoped-configuration-resolver":26,"underscore":61}],28:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Logger,
  Options,
  StateGuard,
  Runtime,
  ProcessKeepAlive
) {
  var Log = Logger.create("App");

  var App = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(App.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._guard = new StateGuard(["starting", "started", "stopping", "stopped"]);
      this._rawConfig = opts.getOrError("configuration");
      this._config = Options.fromObject(this._rawConfig);

      // The default Runtime has sensible defaults.
      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._keepAlive = new ProcessKeepAlive({
        scheduler: this._runtime.scheduler()
      });

      var up   = opts.getOrElse("up"),
          down = opts.getOrElse("down");

      if (up) {
        this.up = Promise.method(_.bind(function() {
          return up.call(this, this._config);
        }, this));
      }

      if (down) {
        this.down = Promise.method(_.bind(function() {
          return down.call(this, this._config);
        }, this));
      }

    },

    start: Promise.method(function() {
      Log.debug("Starting App");
      this._guard
        .deny("starting")
        .apply("starting");

      this._keepAlive.start();
      Log.debug("Calling App#up()");

      return this.up()
        .then(this._guard.applyAsyncFn("started"));
    }),

    stop: Promise.method(function() {
      Log.debug("Stopping App");
      this._guard
        .deny("stopping")
        .apply("stopping");

      this._keepAlive.stop();
      Log.debug("Calling App#down()");

      return this.down()
        .then(this._guard.applyAsyncFn("stopped"));
    }),

    /**
     * Returns the requested configuration value, or throws an error.
     * @param key the configuration key request from the Configuration.
     * @returns {Object}
     */
    config: function(key) {
      return this._config.getOrError(key);
    },

    /**
     * TODO: Doc. Subclass should override.
     */
    up: Promise.method(function() {}),

    /**
     * TODO: Doc. Subclass should override.
     */
    down: Promise.method(function() {})
  });

  return App;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/state-guard"),
  require("../runtime"),
  require("./internal/process-keep-alive")
);

})()
},{"../core/logging/logger":29,"../core/options":8,"../core/state-guard":10,"./internal/process-keep-alive":52,"../runtime":46,"underscore":61,"bluebird":62}],34:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Logger,
  Options,
  UUID,
  DelegatingForwardingSequencer,
  UnitSequencer,
  InMemoryFiber,
  Mailbox,
  Dispatcher,
  SignalingDataStore,
  Periodic,
  ClockSequencer,
  SystemClock,
  Runtime
  ) {

  /**
   * An `Exchange` vends mailboxes. Messages sent from a mailbox are managed by the Exchange which vended the mailbox.
   * The Exchange handles the work of:
   *
   *   1. Wrapping the message in the appropriate message envelope for the verb used (`send`, `sendAndReceive`,
   *      `reply`)
   *   2. Pairing a given `reply` with the originating `sendAndReceive` call, and fulfilling the associated result
   *      promise.
   *   3. Handling message timeouts for `sendAndReceive` calls. When a message times out, the promise associated with
   *      the result is canceled.
   *
   * The actual work of sending messages is handled by an Exchange's underlying `Fiber`. The default fiber is
   * an `InMemoryFiber`, which performs only local dispatch.
   *
   * Generally speaking, mailboxes sharing an underlying fiber (either by both being spawned from the same mailbox,
   * or being spawned by exchanges sharing the same fiber) can send messages to each other, provided they know
   * each other's addresses.
   *
   */
  var Exchange = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_SEND             = Exchange.MSG_SEND             = "send",
      MSG_SEND_AND_RECEIVE = Exchange.MSG_SEND_AND_RECEIVE = "sendAndReceive",
      MSG_REPLY            = Exchange.MSG_REPLY            = "reply";

  // 7.5 seconds is reasonable, yes?
  var DEFAULT_REPLY_TIMEOUT = 7500;

  var Log = Logger.create("Exchange");


  _.extend(Exchange.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrElse("identity", UUID.v4());

      this._runtime = opts.getOrElseFn("runtime", function() {
        return new Runtime();
      });

      this._mailboxFiberDelegate = {
        receiveFiberMessage: this._receiveMailboxFiberMessage.bind(this)
      };

      this._mailboxes = M.hash_map();

      this._fiber     = opts.getOrElseFn("fiber", function() {
        return new InMemoryFiber();
      });

      this._fiber.registerEntity({
        identity: this._identity,
        delegate: this
      });

      this._mailboxDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onMbx"
      });

      var usedDefaultClock = false;

      // For requester-provided requestId to messageId mapping.
      // Used for cancelling outstanding sendAndReceive requests.
      this._reqToMsg = M.hash_map();

      // Data store for pending requests
      this._outstandingRequests = new SignalingDataStore({
        ttl: opts.getOrElse("replyTimeout", DEFAULT_REPLY_TIMEOUT),
        sequencer: new ClockSequencer({
          clock: opts.getOrElseFn("clock", function() {
            usedDefaultClock = true;
            return new SystemClock();
          }),
          // Hax - Since we want time to be async, but provide a default system clock
          // we need to get the initial clock sequence sync, by bypassing the clock call.
          // If you provide an async clock, you should either provide an initial time, or
          // ensure that the first getTime has resolved before instantiating the exchange.
          // OR, in the future, we have to add a start()/stop() to Exchange.
          initialSequence: opts.getOrElse("initialSequence", (usedDefaultClock ? +new Date() : undefined))
        })
      });

      // Dispatches store signals (e.g., expiry)
      this._expiryDispatcher = new Dispatcher({
        delegate: this,
        prefix: "_onStoreSignal",
        listen: this._outstandingRequests.signalChannel()
      });

      this._compositeSeq = new DelegatingForwardingSequencer({
        delegate: new UnitSequencer(),
        targets: [this._outstandingRequests.sequencer(), this._outstandingRequests.sentrySequencer()]
      })

      // This guy triggers periodic expiry checks in the store
      this._checkExpiry = new Periodic({
        scheduler: this._runtime.scheduler(),
        task: _.bind(function() {
          return this._compositeSeq.advance();
        }, this),
        interval: opts.getOrElse("expiryInterval", 1000)
      });

      this._checkExpiry.start();
    },


    dispose: function() {
      // TODO: Cancel outstanding requests

      this._expiryDispatcher.dispose();

      this._outstandingRequests.clear();

      // TODO: Dispose all the things
      this._checkExpiry.dispose();
    },


    /**
     * Builds a Mailbox for the provided `requesterIdentity`. The
     * `RequesterIdentity` must never have been used for requesting
     * a mailbox previously.
     *
     * We attempt to validate unique mailbox names, but because mailbox names
     * are global and there is no checking between fibers, it's only a best-effort.
     *
     * @param requesterIdentity
     * @returns {Mailbox}
     */
    mailbox: function(requesterIdentity) {
      this._assertUniqueOwner(requesterIdentity);

      var mailbox = new Mailbox({
        exchange:      this,
        ownerIdentity: requesterIdentity
      });

      this._mailboxes = M.assoc(this._mailboxes, requesterIdentity, mailbox);

      this._fiber.registerEntity({
        identity: requesterIdentity,
        delegate: this._mailboxFiberDelegate
      });

      return mailbox;
    },


    send: function(env) {
      env = Options.fromObject(env);

      return this._fiber.send({
        from:  env.getOrError("from"),
        to:    env.getOrError("to"),
        body:  env.getOrError("body"),
        mT:    MSG_SEND,
        msgId: UUID.v4()
      });
    },


    reply: function(env) {
      env = Options.fromObject(env);
      return this._fiber.send({
        from:   env.getOrError("from"),
        to:     env.getOrError("to"),
        body:   env.getOrError("body"),
        mT:     MSG_REPLY,
        msgId:  UUID.v4(),
        rMsgId: env.getOrError("rMsgId")
      });
    },


    sendAndReceive: function(env, opts) {
      env  = Options.fromObject(env);
      opts = Options.fromObject(opts);

      var msgId = UUID.v4(),
          reqId    = opts.getOrError("reqId"),
          deferred = defer(),
          fibEnv   = {
            from:  env.getOrError("from"),
            to:    env.getOrError("to"),
            body:  env.getOrError("body"),
            mT:    MSG_SEND_AND_RECEIVE,
            msgId: msgId
          },
          req      = {
            reqId:    reqId,
            deferred: deferred,
            fibEnv:   fibEnv
          };

      this._reqToMsg = M.assoc(this._reqToMsg, reqId, msgId);

      return this
        ._outstandingRequests
        .put(msgId, req, {ttl: opts.getOrElse("replyTimeout")})
        .bind(this)
        .then(function() {
          return this._fiber.send(fibEnv);
        })
        .then(function() {
          return req.deferred.promise;
        });
    },

    cancelSendAndReceive: Promise.method(function(reqId) {
      var msgId = M.get(this._reqToMsg, reqId);

      if (msgId) {
        Log.debug("Canceling request", reqId, "with msgId", msgId);
        this._reqToMsg = M.dissoc(this._reqToMsg, reqId);

        return Promise
          .bind(this)
          .then(function() {
            return this._outstandingRequests.remove(msgId);
          })
          .then(function(req) {
            if (req) {
              req.deferred.reject(new Promise.CancellationError());
            }
          })
      } else {
        Log.warn("Tried to cancel request, but no oustanding request with that ID found;", reqId);
      }
    }),


    _assertUniqueOwner: function(identity) {
      if (M.get(this._mailboxes, identity)) {
        throw new Error("Mailbox registration requires a unique identity");
      }
    },


    /**
     * Fiber delegate protocol method for a message bound for a Mailbox owned by
     * this exchange.
     *
     * @param env
     * @private
     */
    _receiveMailboxFiberMessage: function(env) {
      this._mailboxDispatcher.dispatch(env);
    },


    _onMbxSend: function(env) {
      var oEnv     = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body     = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveOneShot(env);
      }
    },

    // TODO: Should this go along the mailbox ingress channel?
    // Or should it be cb-based?
    _onMbxSendAndReceive: function(env) {
      var oEnv = Options.fromObject(env),
          identity = oEnv.getOrElse("to"),
          body = oEnv.getOrElse("body");

      if (!(identity || body)) {
        Log.info("Exchange received a message with missing envelope information", env);
        return;
      }

      var mbox = M.get(this._mailboxes, identity);
      if (mbox) {
        mbox._receiveRequestReply(env);
      }
    },


    _onMbxReply: function(env) {
      var oEnv     = Options.fromObject(env),
          rMsgId   = oEnv.getOrElse("rMsgId");



      // Don't dispatch vetted replies. Just fulfill the promise
      Promise
        .bind(this)
        .then(function(){
          return this._outstandingRequests.remove(rMsgId);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.resolve(env);
          }
        });
    },


    /**
     * Fired when a request in the outstanding requests store is past due.
     */
    _onStoreSignalExpired: function(sig) {
      Log.debug("Expired entry in store", sig);
      Promise
        .bind(this)
        .then(function() {
          return this._outstandingRequests.remove(sig.key);
        })
        .then(function(request) {
          if (request) {
            this._reqToMsg = M.dissoc(this._reqToMsg, request.reqId);
            request.deferred.reject(new Promise.TimeoutError());
          }
        });
    },


    /**
     * Fiber delegate protocol method for a message bound for this Exchange directly.
     *
     * @param env
     * @private
     */
    receiveFiberMessage: function(env) {
      throw new Error("Not implemented");
    }
  });


  var defer = function(){
    var res, rej;
    var p = new Promise(function() {
      res = arguments[0];
      rej = arguments[1];
    });

    return {
      promise: p,
      resolve: res,
      reject: rej
    };
  };

  return Exchange;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/logging/logger"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/sequencer/delegating-forwarding-sequencer"),
  require("../core/sequencer/unit-sequencer"),
  require("./fiber/in-memory-fiber"),
  require("./internals/mailbox"),
  require("../core/dispatcher"),
  require("../storage/signaling-data-store"),
  require("../util/periodic"),
  require("../core/sequencer/clock-sequencer"),
  require("../time/clock/system-clock"),
  require("../runtime")
);

})()
},{"../core/logging/logger":29,"../core/options":8,"../core/uuid":39,"../core/sequencer/delegating-forwarding-sequencer":15,"./fiber/in-memory-fiber":36,"../core/sequencer/unit-sequencer":11,"./internals/mailbox":56,"../core/dispatcher":6,"../storage/signaling-data-store":22,"../util/periodic":4,"../core/sequencer/clock-sequencer":13,"../time/clock/system-clock":24,"../runtime":46,"bluebird":62,"underscore":61,"mori":63}],35:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger,
  Dispatcher
) {

  /**
   * A Courier makes it easy for a maibox owner to deal with sending and receiving messages. It has a slightly more
   * natural interface for sending messages (`send(to, msg)`, `sendAndReceive(to, msg, opts)`), and automatically
   * dispatches incoming messages to delegate methods.
   *
   * Common usage is for a mailbox owner (let's call it "owner A") to create a new Courier ("courier A"), setting the
   * `delegate` to itself, and the `mailbox` to the mailbox ("mailbox A") it owns. When a remote mailbox's
   * ("mailbox B") courier ("courier B") performs a `courier.send("A", { mT: "foo" })`, it will be automatically
   * dispatched to "owner A"'s `onMsgFoo` method, if present.
   *
   * If "courier B" performs a `courier.sendAndReceive("A", { mT: "bar" })`, it will get set to "owner A"'s
   * `onReqBar` method, and the resulting promise's fulfilled value will be dispatched back to "courier B" as the
   * fulfilled result of the originating `sendAndReceive`.
   *
   * A `send` or `sendAndReceive` call initiated on CourierB will result in a method call on DelegateA, and vice versa.
   *
   *  DelegateA <-> CourierA <-> MailboxA <-> ExchangeA
   *                                            ^
   *                                             \
   *                                              v
   *                                           Fiber
   *                                            ^
   *                                             \
   *                                              v
   *                                           ExchangeB <-> MailboxB <-> CourierB <-> DelegateB
   *
   *
   *
   */
  var Courier = function() {
    this.initialize.apply(this, arguments);
  };

  var MSG_REPLY = Courier.MSG_REPLY = "cReply";

  var Log = Logger.create("Courier");

  _.extend(Courier.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._id         = UUID.v4();
      this._delegate   = opts.getOrError("delegate");
      this._mailbox    = opts.getOrError("mailbox");
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "_onOneShotMessage", "_onRequestReplyMessage", "_defaultContextDelegate");

      this._contextDelegate = opts.getOrElse("contextDelegate", this._defaultContextDelegate);

      this._oneShotDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("oneShotPrefix", "onMsg"),
        contextDelegate: this._contextDelegate
      });

      this._requestReplyDispatcher = new Dispatcher({
        delegate: this._delegate,
        prefix: opts.getOrElse("requestReplyPrefix", "onReq"),
        contextDelegate: this._contextDelegate
      });

      this._subs = M.vector(
        this._mailbox.oneShotChannel().subscribe(this._onOneShotMessage),
        this._mailbox.requestReplyChannel().subscribe(this._onRequestReplyMessage)
      );
    },


    id: function() {
      return this._id;
    },

    send: Promise.method(function(to, msg) {
      this._stateGuard.deny("disposed");

      return this._mailbox.send({
        to: to,
        body: msg
      });
    }),

    sendAndReceive: Promise.method(function(to, msg, opts) {
      this._stateGuard.deny("disposed");

      return this._mailbox
        .sendAndReceive({
          to: to,
          body: msg
        }, opts)
        .then(function(res) {

          if (res.body && res.body.mT === MSG_REPLY && res.body.body) {
            // Unwrap the remote message
            if (res.body.body.err) {
              throw new Error(res.body.body.err);
            }
            return res.body.body.res;
          } else {
            // Someone is misbehaving
            Log.warn("Received sendAndReceive reply, but it isn't Courier-compatible", this._mailbox.ownerIdentity(), res);
            return res;
          }
        })
    }),

    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }


      M.each(this._subs, function(sub) {
        sub.dispose();
      });

      this._subs     = null;
      this._mailbox  = null;
      this._delegate = null;

      this._stateGuard.apply("disposed");
    },

    _defaultContextDelegate: function(mTyped) {
      return {
        mailbox: this._mailbox
      };
    },

    _onOneShotMessage: function(msg) {
      this._oneShotDispatcher.dispatch(msg.body, msg);
    },


    _onRequestReplyMessage: function(msg) {
      this._requestReplyDispatcher
        .dispatchAsync(msg.body, msg)
        .bind({
          mbox: this._mailbox,
          err: null,
          result: null
        })
        .then(function(result){
          this.result = result;
        })
        .caught(function(err) {
          this.err = err.message;
        })
        .lastly(function() {
          this.mbox.reply(msg.msgId, {
            to: msg.from,
            body: {
              mT: MSG_REPLY,
              body: {
                err: this.err,
                res: this.result
              }
            }
          });
        });
    }
  });

  return Courier;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../core/options"),
  require("../core/uuid"),
  require("../core/state-guard"),
  require("../core/logging/logger"),
  require("../core/dispatcher")
);

})()
},{"../core/options":8,"../core/state-guard":10,"../core/uuid":39,"../core/logging/logger":29,"../core/dispatcher":6,"underscore":61,"bluebird":62,"mori":63}],39:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

/**
 * Utility for generating V4 UUIDs. Exports a singleton.
 */

var mod = function(
  _
) {

  var UUID = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UUID.prototype, {
    initialize: function() {},
    // See: http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29
    v4: function() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = Math.random() * 16 | 0;
        // 0x3       = 0b00011
        // 0x8       = 0b01000
        // 0x3 | 0x8 = 0b01011
        // r & 0x3   = (0b00000 | 0b00001 | 0b00010 | 0b00011)
        var v = (c == 'x' ? r : (r & 0x3 | 0x8));
        return v.toString(16);
      });
    }
  });

  return new UUID();
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],42:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * A registry for modules. Allows an NPM package to expose internal modules without needing to know the explicit
   * file path, which may change from release to release. Each module may have one or more aliases which can be
   * used to request it later.
   *
   */
  var ComponentRegistry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ComponentRegistry.prototype, {
    initialize: function() {
      this._modules = {};
    },


    register: function(opts) {
      opts = Options.fromObject(opts);
      var aliases   = opts.getOrError("as"),
          modObject = opts.getOrError("module");

      if (!_.isArray(aliases)) {
        aliases = [ aliases ];
      }

      _.each(aliases, _.bind(function(alias) {
        this._modules[alias] = modObject;
      }, this));

      return this;
    },

    selfRegister: function(opts) {
      opts = Options.fromObject(opts);

      return this.register({
        as: opts.getOrError("as"),
        module: ComponentRegistry
      });
    },


    registerMany: function(aliasesAry) {
      _.each(aliasesAry, _.bind(function(alias) {
        this.register(alias);
      }, this));
      return this;
    },

    component: function(alias) {
      var m = this._modules[alias];
      if (!m) {
        throw new Error("Invalid alias provided (no such module): `"+alias+"'");
      }
      return m;
    }

  });

  ComponentRegistry.prototype.c = ComponentRegistry.prototype.component;

  return ComponentRegistry;
};

module.exports = mod(
  require("underscore"),
  require("../core/options")
);

})()
},{"../core/options":8,"underscore":61}],59:[function(require,module,exports){
"use strict";

module.exports = require("./web-scheduler");

},{"./web-scheduler":49}],61:[function(require,module,exports){
(function(){//     Underscore.js 1.7.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

(function() {

  // Baseline setup
  // --------------

  // Establish the root object, `window` in the browser, or `exports` on the server.
  var root = this;

  // Save the previous value of the `_` variable.
  var previousUnderscore = root._;

  // Save bytes in the minified (but not gzipped) version:
  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;

  // Create quick reference variables for speed access to core prototypes.
  var
    push             = ArrayProto.push,
    slice            = ArrayProto.slice,
    concat           = ArrayProto.concat,
    toString         = ObjProto.toString,
    hasOwnProperty   = ObjProto.hasOwnProperty;

  // All **ECMAScript 5** native function implementations that we hope to use
  // are declared here.
  var
    nativeIsArray      = Array.isArray,
    nativeKeys         = Object.keys,
    nativeBind         = FuncProto.bind;

  // Create a safe reference to the Underscore object for use below.
  var _ = function(obj) {
    if (obj instanceof _) return obj;
    if (!(this instanceof _)) return new _(obj);
    this._wrapped = obj;
  };

  // Export the Underscore object for **Node.js**, with
  // backwards-compatibility for the old `require()` API. If we're in
  // the browser, add `_` as a global object.
  if (typeof exports !== 'undefined') {
    if (typeof module !== 'undefined' && module.exports) {
      exports = module.exports = _;
    }
    exports._ = _;
  } else {
    root._ = _;
  }

  // Current version.
  _.VERSION = '1.7.0';

  // Internal function that returns an efficient (for current engines) version
  // of the passed-in callback, to be repeatedly applied in other Underscore
  // functions.
  var createCallback = function(func, context, argCount) {
    if (context === void 0) return func;
    switch (argCount == null ? 3 : argCount) {
      case 1: return function(value) {
        return func.call(context, value);
      };
      case 2: return function(value, other) {
        return func.call(context, value, other);
      };
      case 3: return function(value, index, collection) {
        return func.call(context, value, index, collection);
      };
      case 4: return function(accumulator, value, index, collection) {
        return func.call(context, accumulator, value, index, collection);
      };
    }
    return function() {
      return func.apply(context, arguments);
    };
  };

  // A mostly-internal function to generate callbacks that can be applied
  // to each element in a collection, returning the desired result — either
  // identity, an arbitrary callback, a property matcher, or a property accessor.
  _.iteratee = function(value, context, argCount) {
    if (value == null) return _.identity;
    if (_.isFunction(value)) return createCallback(value, context, argCount);
    if (_.isObject(value)) return _.matches(value);
    return _.property(value);
  };

  // Collection Functions
  // --------------------

  // The cornerstone, an `each` implementation, aka `forEach`.
  // Handles raw objects in addition to array-likes. Treats all
  // sparse array-likes as if they were dense.
  _.each = _.forEach = function(obj, iteratee, context) {
    if (obj == null) return obj;
    iteratee = createCallback(iteratee, context);
    var i, length = obj.length;
    if (length === +length) {
      for (i = 0; i < length; i++) {
        iteratee(obj[i], i, obj);
      }
    } else {
      var keys = _.keys(obj);
      for (i = 0, length = keys.length; i < length; i++) {
        iteratee(obj[keys[i]], keys[i], obj);
      }
    }
    return obj;
  };

  // Return the results of applying the iteratee to each element.
  _.map = _.collect = function(obj, iteratee, context) {
    if (obj == null) return [];
    iteratee = _.iteratee(iteratee, context);
    var keys = obj.length !== +obj.length && _.keys(obj),
        length = (keys || obj).length,
        results = Array(length),
        currentKey;
    for (var index = 0; index < length; index++) {
      currentKey = keys ? keys[index] : index;
      results[index] = iteratee(obj[currentKey], currentKey, obj);
    }
    return results;
  };

  var reduceError = 'Reduce of empty array with no initial value';

  // **Reduce** builds up a single result from a list of values, aka `inject`,
  // or `foldl`.
  _.reduce = _.foldl = _.inject = function(obj, iteratee, memo, context) {
    if (obj == null) obj = [];
    iteratee = createCallback(iteratee, context, 4);
    var keys = obj.length !== +obj.length && _.keys(obj),
        length = (keys || obj).length,
        index = 0, currentKey;
    if (arguments.length < 3) {
      if (!length) throw new TypeError(reduceError);
      memo = obj[keys ? keys[index++] : index++];
    }
    for (; index < length; index++) {
      currentKey = keys ? keys[index] : index;
      memo = iteratee(memo, obj[currentKey], currentKey, obj);
    }
    return memo;
  };

  // The right-associative version of reduce, also known as `foldr`.
  _.reduceRight = _.foldr = function(obj, iteratee, memo, context) {
    if (obj == null) obj = [];
    iteratee = createCallback(iteratee, context, 4);
    var keys = obj.length !== + obj.length && _.keys(obj),
        index = (keys || obj).length,
        currentKey;
    if (arguments.length < 3) {
      if (!index) throw new TypeError(reduceError);
      memo = obj[keys ? keys[--index] : --index];
    }
    while (index--) {
      currentKey = keys ? keys[index] : index;
      memo = iteratee(memo, obj[currentKey], currentKey, obj);
    }
    return memo;
  };

  // Return the first value which passes a truth test. Aliased as `detect`.
  _.find = _.detect = function(obj, predicate, context) {
    var result;
    predicate = _.iteratee(predicate, context);
    _.some(obj, function(value, index, list) {
      if (predicate(value, index, list)) {
        result = value;
        return true;
      }
    });
    return result;
  };

  // Return all the elements that pass a truth test.
  // Aliased as `select`.
  _.filter = _.select = function(obj, predicate, context) {
    var results = [];
    if (obj == null) return results;
    predicate = _.iteratee(predicate, context);
    _.each(obj, function(value, index, list) {
      if (predicate(value, index, list)) results.push(value);
    });
    return results;
  };

  // Return all the elements for which a truth test fails.
  _.reject = function(obj, predicate, context) {
    return _.filter(obj, _.negate(_.iteratee(predicate)), context);
  };

  // Determine whether all of the elements match a truth test.
  // Aliased as `all`.
  _.every = _.all = function(obj, predicate, context) {
    if (obj == null) return true;
    predicate = _.iteratee(predicate, context);
    var keys = obj.length !== +obj.length && _.keys(obj),
        length = (keys || obj).length,
        index, currentKey;
    for (index = 0; index < length; index++) {
      currentKey = keys ? keys[index] : index;
      if (!predicate(obj[currentKey], currentKey, obj)) return false;
    }
    return true;
  };

  // Determine if at least one element in the object matches a truth test.
  // Aliased as `any`.
  _.some = _.any = function(obj, predicate, context) {
    if (obj == null) return false;
    predicate = _.iteratee(predicate, context);
    var keys = obj.length !== +obj.length && _.keys(obj),
        length = (keys || obj).length,
        index, currentKey;
    for (index = 0; index < length; index++) {
      currentKey = keys ? keys[index] : index;
      if (predicate(obj[currentKey], currentKey, obj)) return true;
    }
    return false;
  };

  // Determine if the array or object contains a given value (using `===`).
  // Aliased as `include`.
  _.contains = _.include = function(obj, target) {
    if (obj == null) return false;
    if (obj.length !== +obj.length) obj = _.values(obj);
    return _.indexOf(obj, target) >= 0;
  };

  // Invoke a method (with arguments) on every item in a collection.
  _.invoke = function(obj, method) {
    var args = slice.call(arguments, 2);
    var isFunc = _.isFunction(method);
    return _.map(obj, function(value) {
      return (isFunc ? method : value[method]).apply(value, args);
    });
  };

  // Convenience version of a common use case of `map`: fetching a property.
  _.pluck = function(obj, key) {
    return _.map(obj, _.property(key));
  };

  // Convenience version of a common use case of `filter`: selecting only objects
  // containing specific `key:value` pairs.
  _.where = function(obj, attrs) {
    return _.filter(obj, _.matches(attrs));
  };

  // Convenience version of a common use case of `find`: getting the first object
  // containing specific `key:value` pairs.
  _.findWhere = function(obj, attrs) {
    return _.find(obj, _.matches(attrs));
  };

  // Return the maximum element (or element-based computation).
  _.max = function(obj, iteratee, context) {
    var result = -Infinity, lastComputed = -Infinity,
        value, computed;
    if (iteratee == null && obj != null) {
      obj = obj.length === +obj.length ? obj : _.values(obj);
      for (var i = 0, length = obj.length; i < length; i++) {
        value = obj[i];
        if (value > result) {
          result = value;
        }
      }
    } else {
      iteratee = _.iteratee(iteratee, context);
      _.each(obj, function(value, index, list) {
        computed = iteratee(value, index, list);
        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {
          result = value;
          lastComputed = computed;
        }
      });
    }
    return result;
  };

  // Return the minimum element (or element-based computation).
  _.min = function(obj, iteratee, context) {
    var result = Infinity, lastComputed = Infinity,
        value, computed;
    if (iteratee == null && obj != null) {
      obj = obj.length === +obj.length ? obj : _.values(obj);
      for (var i = 0, length = obj.length; i < length; i++) {
        value = obj[i];
        if (value < result) {
          result = value;
        }
      }
    } else {
      iteratee = _.iteratee(iteratee, context);
      _.each(obj, function(value, index, list) {
        computed = iteratee(value, index, list);
        if (computed < lastComputed || computed === Infinity && result === Infinity) {
          result = value;
          lastComputed = computed;
        }
      });
    }
    return result;
  };

  // Shuffle a collection, using the modern version of the
  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher–Yates_shuffle).
  _.shuffle = function(obj) {
    var set = obj && obj.length === +obj.length ? obj : _.values(obj);
    var length = set.length;
    var shuffled = Array(length);
    for (var index = 0, rand; index < length; index++) {
      rand = _.random(0, index);
      if (rand !== index) shuffled[index] = shuffled[rand];
      shuffled[rand] = set[index];
    }
    return shuffled;
  };

  // Sample **n** random values from a collection.
  // If **n** is not specified, returns a single random element.
  // The internal `guard` argument allows it to work with `map`.
  _.sample = function(obj, n, guard) {
    if (n == null || guard) {
      if (obj.length !== +obj.length) obj = _.values(obj);
      return obj[_.random(obj.length - 1)];
    }
    return _.shuffle(obj).slice(0, Math.max(0, n));
  };

  // Sort the object's values by a criterion produced by an iteratee.
  _.sortBy = function(obj, iteratee, context) {
    iteratee = _.iteratee(iteratee, context);
    return _.pluck(_.map(obj, function(value, index, list) {
      return {
        value: value,
        index: index,
        criteria: iteratee(value, index, list)
      };
    }).sort(function(left, right) {
      var a = left.criteria;
      var b = right.criteria;
      if (a !== b) {
        if (a > b || a === void 0) return 1;
        if (a < b || b === void 0) return -1;
      }
      return left.index - right.index;
    }), 'value');
  };

  // An internal function used for aggregate "group by" operations.
  var group = function(behavior) {
    return function(obj, iteratee, context) {
      var result = {};
      iteratee = _.iteratee(iteratee, context);
      _.each(obj, function(value, index) {
        var key = iteratee(value, index, obj);
        behavior(result, value, key);
      });
      return result;
    };
  };

  // Groups the object's values by a criterion. Pass either a string attribute
  // to group by, or a function that returns the criterion.
  _.groupBy = group(function(result, value, key) {
    if (_.has(result, key)) result[key].push(value); else result[key] = [value];
  });

  // Indexes the object's values by a criterion, similar to `groupBy`, but for
  // when you know that your index values will be unique.
  _.indexBy = group(function(result, value, key) {
    result[key] = value;
  });

  // Counts instances of an object that group by a certain criterion. Pass
  // either a string attribute to count by, or a function that returns the
  // criterion.
  _.countBy = group(function(result, value, key) {
    if (_.has(result, key)) result[key]++; else result[key] = 1;
  });

  // Use a comparator function to figure out the smallest index at which
  // an object should be inserted so as to maintain order. Uses binary search.
  _.sortedIndex = function(array, obj, iteratee, context) {
    iteratee = _.iteratee(iteratee, context, 1);
    var value = iteratee(obj);
    var low = 0, high = array.length;
    while (low < high) {
      var mid = low + high >>> 1;
      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;
    }
    return low;
  };

  // Safely create a real, live array from anything iterable.
  _.toArray = function(obj) {
    if (!obj) return [];
    if (_.isArray(obj)) return slice.call(obj);
    if (obj.length === +obj.length) return _.map(obj, _.identity);
    return _.values(obj);
  };

  // Return the number of elements in an object.
  _.size = function(obj) {
    if (obj == null) return 0;
    return obj.length === +obj.length ? obj.length : _.keys(obj).length;
  };

  // Split a collection into two arrays: one whose elements all satisfy the given
  // predicate, and one whose elements all do not satisfy the predicate.
  _.partition = function(obj, predicate, context) {
    predicate = _.iteratee(predicate, context);
    var pass = [], fail = [];
    _.each(obj, function(value, key, obj) {
      (predicate(value, key, obj) ? pass : fail).push(value);
    });
    return [pass, fail];
  };

  // Array Functions
  // ---------------

  // Get the first element of an array. Passing **n** will return the first N
  // values in the array. Aliased as `head` and `take`. The **guard** check
  // allows it to work with `_.map`.
  _.first = _.head = _.take = function(array, n, guard) {
    if (array == null) return void 0;
    if (n == null || guard) return array[0];
    if (n < 0) return [];
    return slice.call(array, 0, n);
  };

  // Returns everything but the last entry of the array. Especially useful on
  // the arguments object. Passing **n** will return all the values in
  // the array, excluding the last N. The **guard** check allows it to work with
  // `_.map`.
  _.initial = function(array, n, guard) {
    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));
  };

  // Get the last element of an array. Passing **n** will return the last N
  // values in the array. The **guard** check allows it to work with `_.map`.
  _.last = function(array, n, guard) {
    if (array == null) return void 0;
    if (n == null || guard) return array[array.length - 1];
    return slice.call(array, Math.max(array.length - n, 0));
  };

  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.
  // Especially useful on the arguments object. Passing an **n** will return
  // the rest N values in the array. The **guard**
  // check allows it to work with `_.map`.
  _.rest = _.tail = _.drop = function(array, n, guard) {
    return slice.call(array, n == null || guard ? 1 : n);
  };

  // Trim out all falsy values from an array.
  _.compact = function(array) {
    return _.filter(array, _.identity);
  };

  // Internal implementation of a recursive `flatten` function.
  var flatten = function(input, shallow, strict, output) {
    if (shallow && _.every(input, _.isArray)) {
      return concat.apply(output, input);
    }
    for (var i = 0, length = input.length; i < length; i++) {
      var value = input[i];
      if (!_.isArray(value) && !_.isArguments(value)) {
        if (!strict) output.push(value);
      } else if (shallow) {
        push.apply(output, value);
      } else {
        flatten(value, shallow, strict, output);
      }
    }
    return output;
  };

  // Flatten out an array, either recursively (by default), or just one level.
  _.flatten = function(array, shallow) {
    return flatten(array, shallow, false, []);
  };

  // Return a version of the array that does not contain the specified value(s).
  _.without = function(array) {
    return _.difference(array, slice.call(arguments, 1));
  };

  // Produce a duplicate-free version of the array. If the array has already
  // been sorted, you have the option of using a faster algorithm.
  // Aliased as `unique`.
  _.uniq = _.unique = function(array, isSorted, iteratee, context) {
    if (array == null) return [];
    if (!_.isBoolean(isSorted)) {
      context = iteratee;
      iteratee = isSorted;
      isSorted = false;
    }
    if (iteratee != null) iteratee = _.iteratee(iteratee, context);
    var result = [];
    var seen = [];
    for (var i = 0, length = array.length; i < length; i++) {
      var value = array[i];
      if (isSorted) {
        if (!i || seen !== value) result.push(value);
        seen = value;
      } else if (iteratee) {
        var computed = iteratee(value, i, array);
        if (_.indexOf(seen, computed) < 0) {
          seen.push(computed);
          result.push(value);
        }
      } else if (_.indexOf(result, value) < 0) {
        result.push(value);
      }
    }
    return result;
  };

  // Produce an array that contains the union: each distinct element from all of
  // the passed-in arrays.
  _.union = function() {
    return _.uniq(flatten(arguments, true, true, []));
  };

  // Produce an array that contains every item shared between all the
  // passed-in arrays.
  _.intersection = function(array) {
    if (array == null) return [];
    var result = [];
    var argsLength = arguments.length;
    for (var i = 0, length = array.length; i < length; i++) {
      var item = array[i];
      if (_.contains(result, item)) continue;
      for (var j = 1; j < argsLength; j++) {
        if (!_.contains(arguments[j], item)) break;
      }
      if (j === argsLength) result.push(item);
    }
    return result;
  };

  // Take the difference between one array and a number of other arrays.
  // Only the elements present in just the first array will remain.
  _.difference = function(array) {
    var rest = flatten(slice.call(arguments, 1), true, true, []);
    return _.filter(array, function(value){
      return !_.contains(rest, value);
    });
  };

  // Zip together multiple lists into a single array -- elements that share
  // an index go together.
  _.zip = function(array) {
    if (array == null) return [];
    var length = _.max(arguments, 'length').length;
    var results = Array(length);
    for (var i = 0; i < length; i++) {
      results[i] = _.pluck(arguments, i);
    }
    return results;
  };

  // Converts lists into objects. Pass either a single array of `[key, value]`
  // pairs, or two parallel arrays of the same length -- one of keys, and one of
  // the corresponding values.
  _.object = function(list, values) {
    if (list == null) return {};
    var result = {};
    for (var i = 0, length = list.length; i < length; i++) {
      if (values) {
        result[list[i]] = values[i];
      } else {
        result[list[i][0]] = list[i][1];
      }
    }
    return result;
  };

  // Return the position of the first occurrence of an item in an array,
  // or -1 if the item is not included in the array.
  // If the array is large and already in sort order, pass `true`
  // for **isSorted** to use binary search.
  _.indexOf = function(array, item, isSorted) {
    if (array == null) return -1;
    var i = 0, length = array.length;
    if (isSorted) {
      if (typeof isSorted == 'number') {
        i = isSorted < 0 ? Math.max(0, length + isSorted) : isSorted;
      } else {
        i = _.sortedIndex(array, item);
        return array[i] === item ? i : -1;
      }
    }
    for (; i < length; i++) if (array[i] === item) return i;
    return -1;
  };

  _.lastIndexOf = function(array, item, from) {
    if (array == null) return -1;
    var idx = array.length;
    if (typeof from == 'number') {
      idx = from < 0 ? idx + from + 1 : Math.min(idx, from + 1);
    }
    while (--idx >= 0) if (array[idx] === item) return idx;
    return -1;
  };

  // Generate an integer Array containing an arithmetic progression. A port of
  // the native Python `range()` function. See
  // [the Python documentation](http://docs.python.org/library/functions.html#range).
  _.range = function(start, stop, step) {
    if (arguments.length <= 1) {
      stop = start || 0;
      start = 0;
    }
    step = step || 1;

    var length = Math.max(Math.ceil((stop - start) / step), 0);
    var range = Array(length);

    for (var idx = 0; idx < length; idx++, start += step) {
      range[idx] = start;
    }

    return range;
  };

  // Function (ahem) Functions
  // ------------------

  // Reusable constructor function for prototype setting.
  var Ctor = function(){};

  // Create a function bound to a given object (assigning `this`, and arguments,
  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if
  // available.
  _.bind = function(func, context) {
    var args, bound;
    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));
    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');
    args = slice.call(arguments, 2);
    bound = function() {
      if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));
      Ctor.prototype = func.prototype;
      var self = new Ctor;
      Ctor.prototype = null;
      var result = func.apply(self, args.concat(slice.call(arguments)));
      if (_.isObject(result)) return result;
      return self;
    };
    return bound;
  };

  // Partially apply a function by creating a version that has had some of its
  // arguments pre-filled, without changing its dynamic `this` context. _ acts
  // as a placeholder, allowing any combination of arguments to be pre-filled.
  _.partial = function(func) {
    var boundArgs = slice.call(arguments, 1);
    return function() {
      var position = 0;
      var args = boundArgs.slice();
      for (var i = 0, length = args.length; i < length; i++) {
        if (args[i] === _) args[i] = arguments[position++];
      }
      while (position < arguments.length) args.push(arguments[position++]);
      return func.apply(this, args);
    };
  };

  // Bind a number of an object's methods to that object. Remaining arguments
  // are the method names to be bound. Useful for ensuring that all callbacks
  // defined on an object belong to it.
  _.bindAll = function(obj) {
    var i, length = arguments.length, key;
    if (length <= 1) throw new Error('bindAll must be passed function names');
    for (i = 1; i < length; i++) {
      key = arguments[i];
      obj[key] = _.bind(obj[key], obj);
    }
    return obj;
  };

  // Memoize an expensive function by storing its results.
  _.memoize = function(func, hasher) {
    var memoize = function(key) {
      var cache = memoize.cache;
      var address = hasher ? hasher.apply(this, arguments) : key;
      if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);
      return cache[address];
    };
    memoize.cache = {};
    return memoize;
  };

  // Delays a function for the given number of milliseconds, and then calls
  // it with the arguments supplied.
  _.delay = function(func, wait) {
    var args = slice.call(arguments, 2);
    return setTimeout(function(){
      return func.apply(null, args);
    }, wait);
  };

  // Defers a function, scheduling it to run after the current call stack has
  // cleared.
  _.defer = function(func) {
    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));
  };

  // Returns a function, that, when invoked, will only be triggered at most once
  // during a given window of time. Normally, the throttled function will run
  // as much as it can, without ever going more than once per `wait` duration;
  // but if you'd like to disable the execution on the leading edge, pass
  // `{leading: false}`. To disable execution on the trailing edge, ditto.
  _.throttle = function(func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    if (!options) options = {};
    var later = function() {
      previous = options.leading === false ? 0 : _.now();
      timeout = null;
      result = func.apply(context, args);
      if (!timeout) context = args = null;
    };
    return function() {
      var now = _.now();
      if (!previous && options.leading === false) previous = now;
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0 || remaining > wait) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
        if (!timeout) context = args = null;
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  };

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.
  _.debounce = function(func, wait, immediate) {
    var timeout, args, context, timestamp, result;

    var later = function() {
      var last = _.now() - timestamp;

      if (last < wait && last > 0) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        if (!immediate) {
          result = func.apply(context, args);
          if (!timeout) context = args = null;
        }
      }
    };

    return function() {
      context = this;
      args = arguments;
      timestamp = _.now();
      var callNow = immediate && !timeout;
      if (!timeout) timeout = setTimeout(later, wait);
      if (callNow) {
        result = func.apply(context, args);
        context = args = null;
      }

      return result;
    };
  };

  // Returns the first function passed as an argument to the second,
  // allowing you to adjust arguments, run code before and after, and
  // conditionally execute the original function.
  _.wrap = function(func, wrapper) {
    return _.partial(wrapper, func);
  };

  // Returns a negated version of the passed-in predicate.
  _.negate = function(predicate) {
    return function() {
      return !predicate.apply(this, arguments);
    };
  };

  // Returns a function that is the composition of a list of functions, each
  // consuming the return value of the function that follows.
  _.compose = function() {
    var args = arguments;
    var start = args.length - 1;
    return function() {
      var i = start;
      var result = args[start].apply(this, arguments);
      while (i--) result = args[i].call(this, result);
      return result;
    };
  };

  // Returns a function that will only be executed after being called N times.
  _.after = function(times, func) {
    return function() {
      if (--times < 1) {
        return func.apply(this, arguments);
      }
    };
  };

  // Returns a function that will only be executed before being called N times.
  _.before = function(times, func) {
    var memo;
    return function() {
      if (--times > 0) {
        memo = func.apply(this, arguments);
      } else {
        func = null;
      }
      return memo;
    };
  };

  // Returns a function that will be executed at most one time, no matter how
  // often you call it. Useful for lazy initialization.
  _.once = _.partial(_.before, 2);

  // Object Functions
  // ----------------

  // Retrieve the names of an object's properties.
  // Delegates to **ECMAScript 5**'s native `Object.keys`
  _.keys = function(obj) {
    if (!_.isObject(obj)) return [];
    if (nativeKeys) return nativeKeys(obj);
    var keys = [];
    for (var key in obj) if (_.has(obj, key)) keys.push(key);
    return keys;
  };

  // Retrieve the values of an object's properties.
  _.values = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var values = Array(length);
    for (var i = 0; i < length; i++) {
      values[i] = obj[keys[i]];
    }
    return values;
  };

  // Convert an object into a list of `[key, value]` pairs.
  _.pairs = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var pairs = Array(length);
    for (var i = 0; i < length; i++) {
      pairs[i] = [keys[i], obj[keys[i]]];
    }
    return pairs;
  };

  // Invert the keys and values of an object. The values must be serializable.
  _.invert = function(obj) {
    var result = {};
    var keys = _.keys(obj);
    for (var i = 0, length = keys.length; i < length; i++) {
      result[obj[keys[i]]] = keys[i];
    }
    return result;
  };

  // Return a sorted list of the function names available on the object.
  // Aliased as `methods`
  _.functions = _.methods = function(obj) {
    var names = [];
    for (var key in obj) {
      if (_.isFunction(obj[key])) names.push(key);
    }
    return names.sort();
  };

  // Extend a given object with all the properties in passed-in object(s).
  _.extend = function(obj) {
    if (!_.isObject(obj)) return obj;
    var source, prop;
    for (var i = 1, length = arguments.length; i < length; i++) {
      source = arguments[i];
      for (prop in source) {
        if (hasOwnProperty.call(source, prop)) {
            obj[prop] = source[prop];
        }
      }
    }
    return obj;
  };

  // Return a copy of the object only containing the whitelisted properties.
  _.pick = function(obj, iteratee, context) {
    var result = {}, key;
    if (obj == null) return result;
    if (_.isFunction(iteratee)) {
      iteratee = createCallback(iteratee, context);
      for (key in obj) {
        var value = obj[key];
        if (iteratee(value, key, obj)) result[key] = value;
      }
    } else {
      var keys = concat.apply([], slice.call(arguments, 1));
      obj = new Object(obj);
      for (var i = 0, length = keys.length; i < length; i++) {
        key = keys[i];
        if (key in obj) result[key] = obj[key];
      }
    }
    return result;
  };

   // Return a copy of the object without the blacklisted properties.
  _.omit = function(obj, iteratee, context) {
    if (_.isFunction(iteratee)) {
      iteratee = _.negate(iteratee);
    } else {
      var keys = _.map(concat.apply([], slice.call(arguments, 1)), String);
      iteratee = function(value, key) {
        return !_.contains(keys, key);
      };
    }
    return _.pick(obj, iteratee, context);
  };

  // Fill in a given object with default properties.
  _.defaults = function(obj) {
    if (!_.isObject(obj)) return obj;
    for (var i = 1, length = arguments.length; i < length; i++) {
      var source = arguments[i];
      for (var prop in source) {
        if (obj[prop] === void 0) obj[prop] = source[prop];
      }
    }
    return obj;
  };

  // Create a (shallow-cloned) duplicate of an object.
  _.clone = function(obj) {
    if (!_.isObject(obj)) return obj;
    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);
  };

  // Invokes interceptor with the obj, and then returns obj.
  // The primary purpose of this method is to "tap into" a method chain, in
  // order to perform operations on intermediate results within the chain.
  _.tap = function(obj, interceptor) {
    interceptor(obj);
    return obj;
  };

  // Internal recursive comparison function for `isEqual`.
  var eq = function(a, b, aStack, bStack) {
    // Identical objects are equal. `0 === -0`, but they aren't identical.
    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).
    if (a === b) return a !== 0 || 1 / a === 1 / b;
    // A strict comparison is necessary because `null == undefined`.
    if (a == null || b == null) return a === b;
    // Unwrap any wrapped objects.
    if (a instanceof _) a = a._wrapped;
    if (b instanceof _) b = b._wrapped;
    // Compare `[[Class]]` names.
    var className = toString.call(a);
    if (className !== toString.call(b)) return false;
    switch (className) {
      // Strings, numbers, regular expressions, dates, and booleans are compared by value.
      case '[object RegExp]':
      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')
      case '[object String]':
        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is
        // equivalent to `new String("5")`.
        return '' + a === '' + b;
      case '[object Number]':
        // `NaN`s are equivalent, but non-reflexive.
        // Object(NaN) is equivalent to NaN
        if (+a !== +a) return +b !== +b;
        // An `egal` comparison is performed for other numeric values.
        return +a === 0 ? 1 / +a === 1 / b : +a === +b;
      case '[object Date]':
      case '[object Boolean]':
        // Coerce dates and booleans to numeric primitive values. Dates are compared by their
        // millisecond representations. Note that invalid dates with millisecond representations
        // of `NaN` are not equivalent.
        return +a === +b;
    }
    if (typeof a != 'object' || typeof b != 'object') return false;
    // Assume equality for cyclic structures. The algorithm for detecting cyclic
    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.
    var length = aStack.length;
    while (length--) {
      // Linear search. Performance is inversely proportional to the number of
      // unique nested structures.
      if (aStack[length] === a) return bStack[length] === b;
    }
    // Objects with different constructors are not equivalent, but `Object`s
    // from different frames are.
    var aCtor = a.constructor, bCtor = b.constructor;
    if (
      aCtor !== bCtor &&
      // Handle Object.create(x) cases
      'constructor' in a && 'constructor' in b &&
      !(_.isFunction(aCtor) && aCtor instanceof aCtor &&
        _.isFunction(bCtor) && bCtor instanceof bCtor)
    ) {
      return false;
    }
    // Add the first object to the stack of traversed objects.
    aStack.push(a);
    bStack.push(b);
    var size, result;
    // Recursively compare objects and arrays.
    if (className === '[object Array]') {
      // Compare array lengths to determine if a deep comparison is necessary.
      size = a.length;
      result = size === b.length;
      if (result) {
        // Deep compare the contents, ignoring non-numeric properties.
        while (size--) {
          if (!(result = eq(a[size], b[size], aStack, bStack))) break;
        }
      }
    } else {
      // Deep compare objects.
      var keys = _.keys(a), key;
      size = keys.length;
      // Ensure that both objects contain the same number of properties before comparing deep equality.
      result = _.keys(b).length === size;
      if (result) {
        while (size--) {
          // Deep compare each member
          key = keys[size];
          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;
        }
      }
    }
    // Remove the first object from the stack of traversed objects.
    aStack.pop();
    bStack.pop();
    return result;
  };

  // Perform a deep comparison to check if two objects are equal.
  _.isEqual = function(a, b) {
    return eq(a, b, [], []);
  };

  // Is a given array, string, or object empty?
  // An "empty" object has no enumerable own-properties.
  _.isEmpty = function(obj) {
    if (obj == null) return true;
    if (_.isArray(obj) || _.isString(obj) || _.isArguments(obj)) return obj.length === 0;
    for (var key in obj) if (_.has(obj, key)) return false;
    return true;
  };

  // Is a given value a DOM element?
  _.isElement = function(obj) {
    return !!(obj && obj.nodeType === 1);
  };

  // Is a given value an array?
  // Delegates to ECMA5's native Array.isArray
  _.isArray = nativeIsArray || function(obj) {
    return toString.call(obj) === '[object Array]';
  };

  // Is a given variable an object?
  _.isObject = function(obj) {
    var type = typeof obj;
    return type === 'function' || type === 'object' && !!obj;
  };

  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.
  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {
    _['is' + name] = function(obj) {
      return toString.call(obj) === '[object ' + name + ']';
    };
  });

  // Define a fallback version of the method in browsers (ahem, IE), where
  // there isn't any inspectable "Arguments" type.
  if (!_.isArguments(arguments)) {
    _.isArguments = function(obj) {
      return _.has(obj, 'callee');
    };
  }

  // Optimize `isFunction` if appropriate. Work around an IE 11 bug.
  if (typeof /./ !== 'function') {
    _.isFunction = function(obj) {
      return typeof obj == 'function' || false;
    };
  }

  // Is a given object a finite number?
  _.isFinite = function(obj) {
    return isFinite(obj) && !isNaN(parseFloat(obj));
  };

  // Is the given value `NaN`? (NaN is the only number which does not equal itself).
  _.isNaN = function(obj) {
    return _.isNumber(obj) && obj !== +obj;
  };

  // Is a given value a boolean?
  _.isBoolean = function(obj) {
    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';
  };

  // Is a given value equal to null?
  _.isNull = function(obj) {
    return obj === null;
  };

  // Is a given variable undefined?
  _.isUndefined = function(obj) {
    return obj === void 0;
  };

  // Shortcut function for checking if an object has a given property directly
  // on itself (in other words, not on a prototype).
  _.has = function(obj, key) {
    return obj != null && hasOwnProperty.call(obj, key);
  };

  // Utility Functions
  // -----------------

  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its
  // previous owner. Returns a reference to the Underscore object.
  _.noConflict = function() {
    root._ = previousUnderscore;
    return this;
  };

  // Keep the identity function around for default iteratees.
  _.identity = function(value) {
    return value;
  };

  _.constant = function(value) {
    return function() {
      return value;
    };
  };

  _.noop = function(){};

  _.property = function(key) {
    return function(obj) {
      return obj[key];
    };
  };

  // Returns a predicate for checking whether an object has a given set of `key:value` pairs.
  _.matches = function(attrs) {
    var pairs = _.pairs(attrs), length = pairs.length;
    return function(obj) {
      if (obj == null) return !length;
      obj = new Object(obj);
      for (var i = 0; i < length; i++) {
        var pair = pairs[i], key = pair[0];
        if (pair[1] !== obj[key] || !(key in obj)) return false;
      }
      return true;
    };
  };

  // Run a function **n** times.
  _.times = function(n, iteratee, context) {
    var accum = Array(Math.max(0, n));
    iteratee = createCallback(iteratee, context, 1);
    for (var i = 0; i < n; i++) accum[i] = iteratee(i);
    return accum;
  };

  // Return a random integer between min and max (inclusive).
  _.random = function(min, max) {
    if (max == null) {
      max = min;
      min = 0;
    }
    return min + Math.floor(Math.random() * (max - min + 1));
  };

  // A (possibly faster) way to get the current timestamp as an integer.
  _.now = Date.now || function() {
    return new Date().getTime();
  };

   // List of HTML entities for escaping.
  var escapeMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#x27;',
    '`': '&#x60;'
  };
  var unescapeMap = _.invert(escapeMap);

  // Functions for escaping and unescaping strings to/from HTML interpolation.
  var createEscaper = function(map) {
    var escaper = function(match) {
      return map[match];
    };
    // Regexes for identifying a key that needs to be escaped
    var source = '(?:' + _.keys(map).join('|') + ')';
    var testRegexp = RegExp(source);
    var replaceRegexp = RegExp(source, 'g');
    return function(string) {
      string = string == null ? '' : '' + string;
      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;
    };
  };
  _.escape = createEscaper(escapeMap);
  _.unescape = createEscaper(unescapeMap);

  // If the value of the named `property` is a function then invoke it with the
  // `object` as context; otherwise, return it.
  _.result = function(object, property) {
    if (object == null) return void 0;
    var value = object[property];
    return _.isFunction(value) ? object[property]() : value;
  };

  // Generate a unique integer id (unique within the entire client session).
  // Useful for temporary DOM ids.
  var idCounter = 0;
  _.uniqueId = function(prefix) {
    var id = ++idCounter + '';
    return prefix ? prefix + id : id;
  };

  // By default, Underscore uses ERB-style template delimiters, change the
  // following template settings to use alternative delimiters.
  _.templateSettings = {
    evaluate    : /<%([\s\S]+?)%>/g,
    interpolate : /<%=([\s\S]+?)%>/g,
    escape      : /<%-([\s\S]+?)%>/g
  };

  // When customizing `templateSettings`, if you don't want to define an
  // interpolation, evaluation or escaping regex, we need one that is
  // guaranteed not to match.
  var noMatch = /(.)^/;

  // Certain characters need to be escaped so that they can be put into a
  // string literal.
  var escapes = {
    "'":      "'",
    '\\':     '\\',
    '\r':     'r',
    '\n':     'n',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  var escaper = /\\|'|\r|\n|\u2028|\u2029/g;

  var escapeChar = function(match) {
    return '\\' + escapes[match];
  };

  // JavaScript micro-templating, similar to John Resig's implementation.
  // Underscore templating handles arbitrary delimiters, preserves whitespace,
  // and correctly escapes quotes within interpolated code.
  // NB: `oldSettings` only exists for backwards compatibility.
  _.template = function(text, settings, oldSettings) {
    if (!settings && oldSettings) settings = oldSettings;
    settings = _.defaults({}, settings, _.templateSettings);

    // Combine delimiters into one regular expression via alternation.
    var matcher = RegExp([
      (settings.escape || noMatch).source,
      (settings.interpolate || noMatch).source,
      (settings.evaluate || noMatch).source
    ].join('|') + '|$', 'g');

    // Compile the template source, escaping string literals appropriately.
    var index = 0;
    var source = "__p+='";
    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {
      source += text.slice(index, offset).replace(escaper, escapeChar);
      index = offset + match.length;

      if (escape) {
        source += "'+\n((__t=(" + escape + "))==null?'':_.escape(__t))+\n'";
      } else if (interpolate) {
        source += "'+\n((__t=(" + interpolate + "))==null?'':__t)+\n'";
      } else if (evaluate) {
        source += "';\n" + evaluate + "\n__p+='";
      }

      // Adobe VMs need the match returned to produce the correct offest.
      return match;
    });
    source += "';\n";

    // If a variable is not specified, place data values in local scope.
    if (!settings.variable) source = 'with(obj||{}){\n' + source + '}\n';

    source = "var __t,__p='',__j=Array.prototype.join," +
      "print=function(){__p+=__j.call(arguments,'');};\n" +
      source + 'return __p;\n';

    try {
      var render = new Function(settings.variable || 'obj', '_', source);
    } catch (e) {
      e.source = source;
      throw e;
    }

    var template = function(data) {
      return render.call(this, data, _);
    };

    // Provide the compiled source as a convenience for precompilation.
    var argument = settings.variable || 'obj';
    template.source = 'function(' + argument + '){\n' + source + '}';

    return template;
  };

  // Add a "chain" function. Start chaining a wrapped Underscore object.
  _.chain = function(obj) {
    var instance = _(obj);
    instance._chain = true;
    return instance;
  };

  // OOP
  // ---------------
  // If Underscore is called as a function, it returns a wrapped object that
  // can be used OO-style. This wrapper holds altered versions of all the
  // underscore functions. Wrapped objects may be chained.

  // Helper function to continue chaining intermediate results.
  var result = function(obj) {
    return this._chain ? _(obj).chain() : obj;
  };

  // Add your own custom functions to the Underscore object.
  _.mixin = function(obj) {
    _.each(_.functions(obj), function(name) {
      var func = _[name] = obj[name];
      _.prototype[name] = function() {
        var args = [this._wrapped];
        push.apply(args, arguments);
        return result.call(this, func.apply(_, args));
      };
    });
  };

  // Add all of the Underscore functions to the wrapper object.
  _.mixin(_);

  // Add all mutator Array functions to the wrapper.
  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      var obj = this._wrapped;
      method.apply(obj, arguments);
      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];
      return result.call(this, obj);
    };
  });

  // Add all accessor Array functions to the wrapper.
  _.each(['concat', 'join', 'slice'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      return result.call(this, method.apply(this._wrapped, arguments));
    };
  });

  // Extracts the result from a wrapped and chained object.
  _.prototype.value = function() {
    return this._wrapped;
  };

  // AMD registration happens at the end for compatibility with AMD loaders
  // that may not enforce next-turn semantics on modules. Even though general
  // practice for AMD registration is to be anonymous, underscore registers
  // as a named module because, like jQuery, it is a base library that is
  // popular enough to be bundled in a third party lib, but not be part of
  // an AMD load request. Those cases could generate an error when an
  // anonymous define() is called outside of a loader request.
  if (typeof define === 'function' && define.amd) {
    define('underscore', [], function() {
      return _;
    });
  }
}.call(this));

})()
},{}],63:[function(require,module,exports){
(function(definition){if(typeof exports==="object"){module.exports=definition();}else if(typeof define==="function"&&define.amd){define(definition);}else{mori=definition();}})(function(){return function(){
var g,aa=this;
function m(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}var ba="closure_uid_"+(1E9*Math.random()>>>0),ca=0;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b};function da(a,b){for(var c in a)b.call(void 0,a[c],c,a)};function ea(a,b){null!=a&&this.append.apply(this,arguments)}ea.prototype.Va="";ea.prototype.append=function(a,b,c){this.Va+=a;if(null!=b)for(var d=1;d<arguments.length;d++)this.Va+=arguments[d];return this};ea.prototype.toString=function(){return this.Va};function fa(a,b){a.sort(b||ga)}function ha(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||ga;fa(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value}function ga(a,b){return a>b?1:a<b?-1:0};var ia=null,ja=null;function ka(){return new la(null,5,[ma,!0,oa,!0,pa,!1,qa,!1,ra,ia],null)}function r(a){return null!=a&&!1!==a}function sa(a){return r(a)?!1:!0}function s(a,b){return a[m(null==b?null:b)]?!0:a._?!0:u?!1:null}function ta(a){return null==a?null:a.constructor}function x(a,b){var c=ta(b),c=r(r(c)?c.Db:c)?c.Bb:m(b);return Error(["No protocol method ",a," defined for type ",c,": ",b].join(""))}function ua(a){var b=a.Bb;return r(b)?b:""+A.b(a)}
function va(a){for(var b=a.length,c=Array(b),d=0;;)if(d<b)c[d]=a[d],d+=1;else break;return c}function wa(a){return Array.prototype.slice.call(arguments)}
var xa=function(){function a(a,b){return C.c?C.c(function(a,b){a.push(b);return a},[],b):C.call(null,function(a,b){a.push(b);return a},[],b)}function b(a){return c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,0,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),ya={},za={};
function Aa(a){if(a?a.L:a)return a.L(a);var b;b=Aa[m(null==a?null:a)];if(!b&&(b=Aa._,!b))throw x("ICounted.-count",a);return b.call(null,a)}function Ba(a){if(a?a.I:a)return a.I(a);var b;b=Ba[m(null==a?null:a)];if(!b&&(b=Ba._,!b))throw x("IEmptyableCollection.-empty",a);return b.call(null,a)}var Ca={};function Da(a,b){if(a?a.G:a)return a.G(a,b);var c;c=Da[m(null==a?null:a)];if(!c&&(c=Da._,!c))throw x("ICollection.-conj",a);return c.call(null,a,b)}
var Ea={},D=function(){function a(a,b,c){if(a?a.aa:a)return a.aa(a,b,c);var h;h=D[m(null==a?null:a)];if(!h&&(h=D._,!h))throw x("IIndexed.-nth",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.J:a)return a.J(a,b);var c;c=D[m(null==a?null:a)];if(!c&&(c=D._,!c))throw x("IIndexed.-nth",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),
Fa={};function Ha(a){if(a?a.Q:a)return a.Q(a);var b;b=Ha[m(null==a?null:a)];if(!b&&(b=Ha._,!b))throw x("ISeq.-first",a);return b.call(null,a)}function Ia(a){if(a?a.S:a)return a.S(a);var b;b=Ia[m(null==a?null:a)];if(!b&&(b=Ia._,!b))throw x("ISeq.-rest",a);return b.call(null,a)}
var Ja={},Ka={},La=function(){function a(a,b,c){if(a?a.C:a)return a.C(a,b,c);var h;h=La[m(null==a?null:a)];if(!h&&(h=La._,!h))throw x("ILookup.-lookup",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.u:a)return a.u(a,b);var c;c=La[m(null==a?null:a)];if(!c&&(c=La._,!c))throw x("ILookup.-lookup",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=
a;return c}(),Ma={};function Na(a,b){if(a?a.kb:a)return a.kb(a,b);var c;c=Na[m(null==a?null:a)];if(!c&&(c=Na._,!c))throw x("IAssociative.-contains-key?",a);return c.call(null,a,b)}function Oa(a,b,c){if(a?a.ua:a)return a.ua(a,b,c);var d;d=Oa[m(null==a?null:a)];if(!d&&(d=Oa._,!d))throw x("IAssociative.-assoc",a);return d.call(null,a,b,c)}var Pa={};function Qa(a,b){if(a?a.nb:a)return a.nb(a,b);var c;c=Qa[m(null==a?null:a)];if(!c&&(c=Qa._,!c))throw x("IMap.-dissoc",a);return c.call(null,a,b)}var Sa={};
function Ta(a){if(a?a.$a:a)return a.$a(a);var b;b=Ta[m(null==a?null:a)];if(!b&&(b=Ta._,!b))throw x("IMapEntry.-key",a);return b.call(null,a)}function Ua(a){if(a?a.ab:a)return a.ab(a);var b;b=Ua[m(null==a?null:a)];if(!b&&(b=Ua._,!b))throw x("IMapEntry.-val",a);return b.call(null,a)}var Va={};function Wa(a,b){if(a?a.vb:a)return a.vb(a,b);var c;c=Wa[m(null==a?null:a)];if(!c&&(c=Wa._,!c))throw x("ISet.-disjoin",a);return c.call(null,a,b)}
function Xa(a){if(a?a.Ia:a)return a.Ia(a);var b;b=Xa[m(null==a?null:a)];if(!b&&(b=Xa._,!b))throw x("IStack.-peek",a);return b.call(null,a)}function Ya(a){if(a?a.Ja:a)return a.Ja(a);var b;b=Ya[m(null==a?null:a)];if(!b&&(b=Ya._,!b))throw x("IStack.-pop",a);return b.call(null,a)}var Za={};function $a(a,b,c){if(a?a.Pa:a)return a.Pa(a,b,c);var d;d=$a[m(null==a?null:a)];if(!d&&(d=$a._,!d))throw x("IVector.-assoc-n",a);return d.call(null,a,b,c)}
function ab(a){if(a?a.ub:a)return a.ub(a);var b;b=ab[m(null==a?null:a)];if(!b&&(b=ab._,!b))throw x("IDeref.-deref",a);return b.call(null,a)}var bb={};function cb(a){if(a?a.D:a)return a.D(a);var b;b=cb[m(null==a?null:a)];if(!b&&(b=cb._,!b))throw x("IMeta.-meta",a);return b.call(null,a)}var db={};function eb(a,b){if(a?a.F:a)return a.F(a,b);var c;c=eb[m(null==a?null:a)];if(!c&&(c=eb._,!c))throw x("IWithMeta.-with-meta",a);return c.call(null,a,b)}
var fb={},gb=function(){function a(a,b,c){if(a?a.M:a)return a.M(a,b,c);var h;h=gb[m(null==a?null:a)];if(!h&&(h=gb._,!h))throw x("IReduce.-reduce",a);return h.call(null,a,b,c)}function b(a,b){if(a?a.N:a)return a.N(a,b);var c;c=gb[m(null==a?null:a)];if(!c&&(c=gb._,!c))throw x("IReduce.-reduce",a);return c.call(null,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function hb(a,b,c){if(a?a.Za:a)return a.Za(a,b,c);var d;d=hb[m(null==a?null:a)];if(!d&&(d=hb._,!d))throw x("IKVReduce.-kv-reduce",a);return d.call(null,a,b,c)}function ib(a,b){if(a?a.v:a)return a.v(a,b);var c;c=ib[m(null==a?null:a)];if(!c&&(c=ib._,!c))throw x("IEquiv.-equiv",a);return c.call(null,a,b)}function jb(a){if(a?a.B:a)return a.B(a);var b;b=jb[m(null==a?null:a)];if(!b&&(b=jb._,!b))throw x("IHash.-hash",a);return b.call(null,a)}var kb={};
function lb(a){if(a?a.H:a)return a.H(a);var b;b=lb[m(null==a?null:a)];if(!b&&(b=lb._,!b))throw x("ISeqable.-seq",a);return b.call(null,a)}var mb={},nb={},ob={};function pb(a){if(a?a.Xa:a)return a.Xa(a);var b;b=pb[m(null==a?null:a)];if(!b&&(b=pb._,!b))throw x("IReversible.-rseq",a);return b.call(null,a)}function qb(a,b){if(a?a.yb:a)return a.yb(a,b);var c;c=qb[m(null==a?null:a)];if(!c&&(c=qb._,!c))throw x("ISorted.-sorted-seq",a);return c.call(null,a,b)}
function rb(a,b,c){if(a?a.zb:a)return a.zb(a,b,c);var d;d=rb[m(null==a?null:a)];if(!d&&(d=rb._,!d))throw x("ISorted.-sorted-seq-from",a);return d.call(null,a,b,c)}function sb(a,b){if(a?a.xb:a)return a.xb(a,b);var c;c=sb[m(null==a?null:a)];if(!c&&(c=sb._,!c))throw x("ISorted.-entry-key",a);return c.call(null,a,b)}function tb(a){if(a?a.wb:a)return a.wb(a);var b;b=tb[m(null==a?null:a)];if(!b&&(b=tb._,!b))throw x("ISorted.-comparator",a);return b.call(null,a)}
function ub(a,b){if(a?a.Sb:a)return a.Sb(0,b);var c;c=ub[m(null==a?null:a)];if(!c&&(c=ub._,!c))throw x("IWriter.-write",a);return c.call(null,a,b)}var vb={};function wb(a,b,c){if(a?a.w:a)return a.w(a,b,c);var d;d=wb[m(null==a?null:a)];if(!d&&(d=wb._,!d))throw x("IPrintWithWriter.-pr-writer",a);return d.call(null,a,b,c)}function xb(a,b,c){if(a?a.Rb:a)return a.Rb(0,b,c);var d;d=xb[m(null==a?null:a)];if(!d&&(d=xb._,!d))throw x("IWatchable.-notify-watches",a);return d.call(null,a,b,c)}
function yb(a){if(a?a.Wa:a)return a.Wa(a);var b;b=yb[m(null==a?null:a)];if(!b&&(b=yb._,!b))throw x("IEditableCollection.-as-transient",a);return b.call(null,a)}function zb(a,b){if(a?a.Ka:a)return a.Ka(a,b);var c;c=zb[m(null==a?null:a)];if(!c&&(c=zb._,!c))throw x("ITransientCollection.-conj!",a);return c.call(null,a,b)}function Ab(a){if(a?a.Oa:a)return a.Oa(a);var b;b=Ab[m(null==a?null:a)];if(!b&&(b=Ab._,!b))throw x("ITransientCollection.-persistent!",a);return b.call(null,a)}
function Bb(a,b,c){if(a?a.cb:a)return a.cb(a,b,c);var d;d=Bb[m(null==a?null:a)];if(!d&&(d=Bb._,!d))throw x("ITransientAssociative.-assoc!",a);return d.call(null,a,b,c)}function Cb(a,b){if(a?a.Ab:a)return a.Ab(a,b);var c;c=Cb[m(null==a?null:a)];if(!c&&(c=Cb._,!c))throw x("ITransientMap.-dissoc!",a);return c.call(null,a,b)}function Db(a,b,c){if(a?a.Pb:a)return a.Pb(0,b,c);var d;d=Db[m(null==a?null:a)];if(!d&&(d=Db._,!d))throw x("ITransientVector.-assoc-n!",a);return d.call(null,a,b,c)}
function Eb(a){if(a?a.Qb:a)return a.Qb();var b;b=Eb[m(null==a?null:a)];if(!b&&(b=Eb._,!b))throw x("ITransientVector.-pop!",a);return b.call(null,a)}function Fb(a,b){if(a?a.Ob:a)return a.Ob(0,b);var c;c=Fb[m(null==a?null:a)];if(!c&&(c=Fb._,!c))throw x("ITransientSet.-disjoin!",a);return c.call(null,a,b)}function Gb(a){if(a?a.Kb:a)return a.Kb();var b;b=Gb[m(null==a?null:a)];if(!b&&(b=Gb._,!b))throw x("IChunk.-drop-first",a);return b.call(null,a)}
function Hb(a){if(a?a.sb:a)return a.sb(a);var b;b=Hb[m(null==a?null:a)];if(!b&&(b=Hb._,!b))throw x("IChunkedSeq.-chunked-first",a);return b.call(null,a)}function Ib(a){if(a?a.tb:a)return a.tb(a);var b;b=Ib[m(null==a?null:a)];if(!b&&(b=Ib._,!b))throw x("IChunkedSeq.-chunked-rest",a);return b.call(null,a)}function Jb(a){if(a?a.rb:a)return a.rb(a);var b;b=Jb[m(null==a?null:a)];if(!b&&(b=Jb._,!b))throw x("IChunkedNext.-chunked-next",a);return b.call(null,a)}
function Kb(a){this.vc=a;this.q=0;this.i=1073741824}Kb.prototype.Sb=function(a,b){return this.vc.append(b)};function Lb(a){var b=new ea;a.w(null,new Kb(b),ka());return""+A.b(b)}var Mb="undefined"!==typeof Math.imul&&0!==(Math.imul.a?Math.imul.a(4294967295,5):Math.imul.call(null,4294967295,5))?function(a,b){return Math.imul(a,b)}:function(a,b){var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};function Nb(a){a=Mb(a,3432918353);return Mb(a<<15|a>>>-15,461845907)}
function Ob(a,b){var c=a^b;return Mb(c<<13|c>>>-13,5)+3864292196}function Pb(a,b){var c=a^b,c=Mb(c^c>>>16,2246822507),c=Mb(c^c>>>13,3266489909);return c^c>>>16}var Qb={},Rb=0;function Sb(a){255<Rb&&(Qb={},Rb=0);var b=Qb[a];if("number"!==typeof b){a:if(null!=a)if(b=a.length,0<b){for(var c=0,d=0;;)if(c<b)var e=c+1,d=Mb(31,d)+a.charCodeAt(c),c=e;else{b=d;break a}b=void 0}else b=0;else b=0;Qb[a]=b;Rb+=1}return a=b}
function Tb(a){a&&(a.i&4194304||a.Dc)?a=a.B(null):"number"===typeof a?a=Math.floor(a)%2147483647:!0===a?a=1:!1===a?a=0:"string"===typeof a?(a=Sb(a),0!==a&&(a=Nb(a),a=Ob(0,a),a=Pb(a,4))):a=null==a?0:u?jb(a):null;return a}
function Ub(a){var b;b=a.name;var c;a:{c=1;for(var d=0;;)if(c<b.length){var e=c+2,d=Ob(d,Nb(b.charCodeAt(c-1)|b.charCodeAt(c)<<16));c=e}else{c=d;break a}c=void 0}c=1===(b.length&1)?c^Nb(b.charCodeAt(b.length-1)):c;b=Pb(c,Mb(2,b.length));a=Sb(a.fa);return b^a+2654435769+(b<<6)+(b>>2)}
function Vb(a,b){if(r(Wb.a?Wb.a(a,b):Wb.call(null,a,b)))return 0;var c=sa(a.fa);if(r(c?b.fa:c))return-1;if(r(a.fa)){if(sa(b.fa))return 1;c=Xb.a?Xb.a(a.fa,b.fa):Xb.call(null,a.fa,b.fa);return 0===c?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):c}return Yb?Xb.a?Xb.a(a.name,b.name):Xb.call(null,a.name,b.name):null}function Zb(a,b,c,d,e){this.fa=a;this.name=b;this.Na=c;this.Ua=d;this.W=e;this.i=2154168321;this.q=4096}g=Zb.prototype;g.w=function(a,b){return ub(b,this.Na)};
g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)};g.F=function(a,b){return new Zb(this.fa,this.name,this.Na,this.Ua,b)};g.D=function(){return this.W};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(c,this,null);case 3:return La.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(a,this,null)};
g.a=function(a,b){return La.c(a,this,b)};g.v=function(a,b){return b instanceof Zb?this.Na===b.Na:!1};g.toString=function(){return this.Na};var $b=function(){function a(a,b){var c=null!=a?""+A.b(a)+"/"+A.b(b):b;return new Zb(a,b,c,null,null)}function b(a){return a instanceof Zb?a:c.a(null,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();
function E(a){if(null==a)return null;if(a&&(a.i&8388608||a.hc))return a.H(null);if(a instanceof Array||"string"===typeof a)return 0===a.length?null:new ac(a,0);if(s(kb,a))return lb(a);if(u)throw Error(""+A.b(a)+" is not ISeqable");return null}function F(a){if(null==a)return null;if(a&&(a.i&64||a.bb))return a.Q(null);a=E(a);return null==a?null:Ha(a)}function G(a){return null!=a?a&&(a.i&64||a.bb)?a.S(null):(a=E(a))?Ia(a):H:H}function I(a){return null==a?null:a&&(a.i&128||a.ob)?a.U(null):E(G(a))}
var Wb=function(){function a(a,b){return null==a?null==b:a===b||ib(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(b.a(a,d))if(I(e))a=d,d=F(e),e=I(e);else return b.a(d,F(e));else return!1}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!0;case 2:return a.call(this,b,
e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!0};b.a=a;b.d=c.d;return b}();function bc(a,b){var c=Nb(a),c=Ob(0,c);return Pb(c,b)}function cc(a){var b=0,c=1;for(a=E(a);;)if(null!=a)b+=1,c=Mb(31,c)+Tb(F(a))|0,a=I(a);else return bc(c,b)}function dc(a){var b=0,c=0;for(a=E(a);;)if(null!=a)b+=1,c=c+Tb(F(a))|0,a=I(a);else return bc(c,b)}za["null"]=!0;Aa["null"]=function(){return 0};
Date.prototype.v=function(a,b){return b instanceof Date&&this.toString()===b.toString()};ib.number=function(a,b){return a===b};bb["function"]=!0;cb["function"]=function(){return null};ya["function"]=!0;jb._=function(a){return a[ba]||(a[ba]=++ca)};function ec(a){this.l=a;this.q=0;this.i=32768}ec.prototype.ub=function(){return this.l};function fc(a){return a instanceof ec}
var gc=function(){function a(a,b,c,d){for(var l=Aa(a);;)if(d<l){c=b.a?b.a(c,D.a(a,d)):b.call(null,c,D.a(a,d));if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=Aa(a),l=0;;)if(l<d){c=b.a?b.a(c,D.a(a,l)):b.call(null,c,D.a(a,l));if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=Aa(a);if(0===c)return b.o?b.o():b.call(null);for(var d=D.a(a,0),l=1;;)if(l<c){d=b.a?b.a(d,D.a(a,l)):b.call(null,d,D.a(a,l));if(fc(d))return K.b?K.b(d):K.call(null,
d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),hc=function(){function a(a,b,c,d){for(var l=a.length;;)if(d<l){c=b.a?b.a(c,a[d]):b.call(null,c,a[d]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=1}else return c}function b(a,b,c){for(var d=a.length,l=0;;)if(l<d){c=b.a?b.a(c,a[l]):b.call(null,c,
a[l]);if(fc(c))return K.b?K.b(c):K.call(null,c);l+=1}else return c}function c(a,b){var c=a.length;if(0===a.length)return b.o?b.o():b.call(null);for(var d=a[0],l=1;;)if(l<c){d=b.a?b.a(d,a[l]):b.call(null,d,a[l]);if(fc(d))return K.b?K.b(d):K.call(null,d);l+=1}else return d}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}();
function ic(a){return a?a.i&2||a.Yb?!0:a.i?!1:s(za,a):s(za,a)}function jc(a){return a?a.i&16||a.Lb?!0:a.i?!1:s(Ea,a):s(Ea,a)}function ac(a,b){this.e=a;this.p=b;this.i=166199550;this.q=8192}g=ac.prototype;g.toString=function(){return Lb(this)};g.J=function(a,b){var c=b+this.p;return c<this.e.length?this.e[c]:null};g.aa=function(a,b,c){a=b+this.p;return a<this.e.length?this.e[a]:c};g.U=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):null};g.L=function(){return this.e.length-this.p};
g.Xa=function(){var a=Aa(this);return 0<a?new kc(this,a-1,null):null};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return H};g.N=function(a,b){return hc.n(this.e,b,this.e[this.p],this.p+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.p)};g.Q=function(){return this.e[this.p]};g.S=function(){return this.p+1<this.e.length?new ac(this.e,this.p+1):H};g.H=function(){return this};
g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};
var mc=function(){function a(a,b){return b<a.length?new ac(a,b):null}function b(a){return c.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),J=function(){function a(a,b){return mc.a(a,b)}function b(a){return mc.a(a,0)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+
arguments.length);};c.b=b;c.a=a;return c}();function kc(a,b,c){this.jb=a;this.p=b;this.j=c;this.i=32374990;this.q=8192}g=kc.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 0<this.p?new kc(this.jb,this.p-1,null):null};g.L=function(){return this.p+1};g.B=function(){return cc(this)};g.v=function(a,b){return lc.a?lc.a(this,b):lc.call(null,this,b)};g.I=function(){return N.a?N.a(H,this.j):N.call(null,H,this.j)};
g.N=function(a,b){return nc.a?nc.a(b,this):nc.call(null,b,this)};g.M=function(a,b,c){return nc.c?nc.c(b,c,this):nc.call(null,b,c,this)};g.Q=function(){return D.a(this.jb,this.p)};g.S=function(){return 0<this.p?new kc(this.jb,this.p-1,null):H};g.H=function(){return this};g.F=function(a,b){return new kc(this.jb,this.p,b)};g.G=function(a,b){return M.a?M.a(b,this):M.call(null,b,this)};function oc(a){for(;;){var b=I(a);if(null!=b)a=b;else return F(a)}}ib._=function(a,b){return a===b};
var pc=function(){function a(a,b){return null!=a?Da(a,b):Da(H,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;)if(r(e))a=b.a(a,d),d=F(e),e=I(e);else return b.a(a,d)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+
arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function qc(a){return null==a?null:Ba(a)}function O(a){if(null!=a)if(a&&(a.i&2||a.Yb))a=a.L(null);else if(a instanceof Array)a=a.length;else if("string"===typeof a)a=a.length;else if(s(za,a))a=Aa(a);else if(u)a:{a=E(a);for(var b=0;;){if(ic(a)){a=b+Aa(a);break a}a=I(a);b+=1}a=void 0}else a=null;else a=0;return a}
var rc=function(){function a(a,b,c){for(;;){if(null==a)return c;if(0===b)return E(a)?F(a):c;if(jc(a))return D.c(a,b,c);if(E(a))a=I(a),b-=1;else return u?c:null}}function b(a,b){for(;;){if(null==a)throw Error("Index out of bounds");if(0===b){if(E(a))return F(a);throw Error("Index out of bounds");}if(jc(a))return D.a(a,b);if(E(a)){var c=I(a),h=b-1;a=c;b=h}else{if(u)throw Error("Index out of bounds");return null}}}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),P=function(){function a(a,b,c){if("number"!==typeof b)throw Error("index argument to nth must be a number.");if(null==a)return c;if(a&&(a.i&16||a.Lb))return a.aa(null,b,c);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:c;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.c(a,b,c);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}function b(a,
b){if("number"!==typeof b)throw Error("index argument to nth must be a number");if(null==a)return a;if(a&&(a.i&16||a.Lb))return a.J(null,b);if(a instanceof Array||"string"===typeof a)return b<a.length?a[b]:null;if(s(Ea,a))return D.a(a,b);if(a?a.i&64||a.bb||(a.i?0:s(Fa,a)):s(Fa,a))return rc.a(a,b);if(u)throw Error("nth not supported on this type "+A.b(ua(ta(a))));return null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+
arguments.length);};c.a=b;c.c=a;return c}(),Q=function(){function a(a,b,c){return null!=a?a&&(a.i&256||a.Mb)?a.C(null,b,c):a instanceof Array?b<a.length?a[b]:c:"string"===typeof a?b<a.length?a[b]:c:s(Ka,a)?La.c(a,b,c):u?c:null:c}function b(a,b){return null==a?null:a&&(a.i&256||a.Mb)?a.u(null,b):a instanceof Array?b<a.length?a[b]:null:"string"===typeof a?b<a.length?a[b]:null:s(Ka,a)?La.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,
c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),R=function(){function a(a,b,c){return null!=a?Oa(a,b,c):sc.a?sc.a([b],[c]):sc.call(null,[b],[c])}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){for(;;)if(a=b.c(a,d,e),r(l))d=F(l),e=F(I(l)),l=I(I(l));else return a}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,
d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.c=a;b.d=c.d;return b}(),tc=function(){function a(a,b){return null==a?null:Qa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);
if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function uc(a){var b="function"==m(a);return b?b:a?r(r(null)?null:a.Xb)?!0:a.Cb?!1:s(ya,a):s(ya,a)}
function vc(a,b){this.h=a;this.j=b;this.q=0;this.i=393217}g=vc.prototype;
g.call=function(){var a=null;return a=function(a,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc){switch(arguments.length){case 1:var z=a,z=this;return z.h.o?z.h.o():z.h.call(null);case 2:return z=a,z=this,z.h.b?z.h.b(c):z.h.call(null,c);case 3:return z=a,z=this,z.h.a?z.h.a(c,d):z.h.call(null,c,d);case 4:return z=a,z=this,z.h.c?z.h.c(c,d,e):z.h.call(null,c,d,e);case 5:return z=a,z=this,z.h.n?z.h.n(c,d,e,f):z.h.call(null,c,d,e,f);case 6:return z=a,z=this,z.h.s?z.h.s(c,d,e,f,h):z.h.call(null,c,d,e,f,
h);case 7:return z=a,z=this,z.h.X?z.h.X(c,d,e,f,h,k):z.h.call(null,c,d,e,f,h,k);case 8:return z=a,z=this,z.h.ga?z.h.ga(c,d,e,f,h,k,l):z.h.call(null,c,d,e,f,h,k,l);case 9:return z=a,z=this,z.h.Ga?z.h.Ga(c,d,e,f,h,k,l,n):z.h.call(null,c,d,e,f,h,k,l,n);case 10:return z=a,z=this,z.h.Ha?z.h.Ha(c,d,e,f,h,k,l,n,q):z.h.call(null,c,d,e,f,h,k,l,n,q);case 11:return z=a,z=this,z.h.va?z.h.va(c,d,e,f,h,k,l,n,q,t):z.h.call(null,c,d,e,f,h,k,l,n,q,t);case 12:return z=a,z=this,z.h.wa?z.h.wa(c,d,e,f,h,k,l,n,q,t,v):
z.h.call(null,c,d,e,f,h,k,l,n,q,t,v);case 13:return z=a,z=this,z.h.xa?z.h.xa(c,d,e,f,h,k,l,n,q,t,v,w):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w);case 14:return z=a,z=this,z.h.ya?z.h.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y);case 15:return z=a,z=this,z.h.za?z.h.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);case 16:return z=a,z=this,z.h.Aa?z.h.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);case 17:return z=a,z=this,
z.h.Ba?z.h.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);case 18:return z=a,z=this,z.h.Ca?z.h.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);case 19:return z=a,z=this,z.h.Da?z.h.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);case 20:return z=a,z=this,z.h.Ea?z.h.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);case 21:return z=
a,z=this,z.h.Fa?z.h.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra):z.h.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra);case 22:return z=a,z=this,S.bc?S.bc(z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc):S.call(null,z.h,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,Ra,wc)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.o=function(){return this.h.o?this.h.o():this.h.call(null)};
g.b=function(a){return this.h.b?this.h.b(a):this.h.call(null,a)};g.a=function(a,b){return this.h.a?this.h.a(a,b):this.h.call(null,a,b)};g.c=function(a,b,c){return this.h.c?this.h.c(a,b,c):this.h.call(null,a,b,c)};g.n=function(a,b,c,d){return this.h.n?this.h.n(a,b,c,d):this.h.call(null,a,b,c,d)};g.s=function(a,b,c,d,e){return this.h.s?this.h.s(a,b,c,d,e):this.h.call(null,a,b,c,d,e)};g.X=function(a,b,c,d,e,f){return this.h.X?this.h.X(a,b,c,d,e,f):this.h.call(null,a,b,c,d,e,f)};
g.ga=function(a,b,c,d,e,f,h){return this.h.ga?this.h.ga(a,b,c,d,e,f,h):this.h.call(null,a,b,c,d,e,f,h)};g.Ga=function(a,b,c,d,e,f,h,k){return this.h.Ga?this.h.Ga(a,b,c,d,e,f,h,k):this.h.call(null,a,b,c,d,e,f,h,k)};g.Ha=function(a,b,c,d,e,f,h,k,l){return this.h.Ha?this.h.Ha(a,b,c,d,e,f,h,k,l):this.h.call(null,a,b,c,d,e,f,h,k,l)};g.va=function(a,b,c,d,e,f,h,k,l,n){return this.h.va?this.h.va(a,b,c,d,e,f,h,k,l,n):this.h.call(null,a,b,c,d,e,f,h,k,l,n)};
g.wa=function(a,b,c,d,e,f,h,k,l,n,q){return this.h.wa?this.h.wa(a,b,c,d,e,f,h,k,l,n,q):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q)};g.xa=function(a,b,c,d,e,f,h,k,l,n,q,t){return this.h.xa?this.h.xa(a,b,c,d,e,f,h,k,l,n,q,t):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t)};g.ya=function(a,b,c,d,e,f,h,k,l,n,q,t,v){return this.h.ya?this.h.ya(a,b,c,d,e,f,h,k,l,n,q,t,v):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v)};
g.za=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w){return this.h.za?this.h.za(a,b,c,d,e,f,h,k,l,n,q,t,v,w):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w)};g.Aa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y){return this.h.Aa?this.h.Aa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y)};g.Ba=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B){return this.h.Ba?this.h.Ba(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B)};
g.Ca=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L){return this.h.Ca?this.h.Ca(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L)};g.Da=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U){return this.h.Da?this.h.Da(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U)};
g.Ea=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z){return this.h.Ea?this.h.Ea(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z)};g.Fa=function(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na){return this.h.Fa?this.h.Fa(a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):this.h.call(null,a,b,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na)};g.Xb=!0;g.F=function(a,b){return new vc(this.h,b)};g.D=function(){return this.j};
function N(a,b){return uc(a)&&!(a?a.i&262144||a.oc||(a.i?0:s(db,a)):s(db,a))?new vc(a,b):null==a?null:eb(a,b)}function xc(a){var b=null!=a;return(b?a?a.i&131072||a.ec||(a.i?0:s(bb,a)):s(bb,a):b)?cb(a):null}function yc(a){return null==a?null:Xa(a)}function zc(a){return null==a?null:Ya(a)}
var Ac=function(){function a(a,b){return null==a?null:Wa(a,b)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){for(;;){if(null==a)return null;a=b.a(a,d);if(r(e))d=F(e),e=I(e);else return a}}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Bc(a){return null==a||sa(E(a))}function Cc(a){return null==a?!1:a?a.i&8||a.Ac?!0:a.i?!1:s(Ca,a):s(Ca,a)}function Dc(a){return null==a?!1:a?a.i&4096||a.jc?!0:a.i?!1:s(Va,a):s(Va,a)}function Ec(a){return a?a.i&512||a.yc?!0:a.i?!1:s(Ma,a):s(Ma,a)}function Fc(a){return a?a.i&16777216||a.ic?!0:a.i?!1:s(mb,a):s(mb,a)}
function Gc(a){return null==a?!1:a?a.i&1024||a.cc?!0:a.i?!1:s(Pa,a):s(Pa,a)}function Hc(a){return a?a.i&16384||a.Gc?!0:a.i?!1:s(Za,a):s(Za,a)}function Ic(a){return a?a.q&512||a.zc?!0:!1:!1}function Jc(a){var b=[];da(a,function(a){return function(b,e){return a.push(e)}}(b));return b}function Kc(a,b,c,d,e){for(;0!==e;)c[d]=a[b],d+=1,e-=1,b+=1}var Lc={};function Mc(a){return null==a?!1:a?a.i&64||a.bb?!0:a.i?!1:s(Fa,a):s(Fa,a)}function Nc(a){return r(a)?!0:!1}
function Oc(a,b){return Q.c(a,b,Lc)===Lc?!1:!0}function Xb(a,b){if(a===b)return 0;if(null==a)return-1;if(null==b)return 1;if(ta(a)===ta(b))return a&&(a.q&2048||a.lb)?a.mb(null,b):ga(a,b);if(u)throw Error("compare on non-nil objects of different types");return null}
var Pc=function(){function a(a,b,c,h){for(;;){var k=Xb(P.a(a,h),P.a(b,h));if(0===k&&h+1<c)h+=1;else return k}}function b(a,b){var f=O(a),h=O(b);return f<h?-1:f>h?1:u?c.n(a,b,f,0):null}var c=null,c=function(c,e,f,h){switch(arguments.length){case 2:return b.call(this,c,e);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.n=a;return c}();
function Qc(a){return Wb.a(a,Xb)?Xb:function(b,c){var d=a.a?a.a(b,c):a.call(null,b,c);return"number"===typeof d?d:r(d)?-1:r(a.a?a.a(c,b):a.call(null,c,b))?1:0}}
var Sc=function(){function a(a,b){if(E(b)){var c=Rc.b?Rc.b(b):Rc.call(null,b);ha(c,Qc(a));return E(c)}return H}function b(a){return c.a(Xb,a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Tc=function(){function a(a,b,c){return Sc.a(function(c,f){return Qc(b).call(null,a.b?a.b(c):a.call(null,c),a.b?a.b(f):a.call(null,f))},c)}function b(a,b){return c.c(a,Xb,b)}
var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),nc=function(){function a(a,b,c){for(c=E(c);;)if(c){b=a.a?a.a(b,F(c)):a.call(null,b,F(c));if(fc(b))return K.b?K.b(b):K.call(null,b);c=I(c)}else return b}function b(a,b){var c=E(b);return c?C.c?C.c(a,F(c),I(c)):C.call(null,a,F(c),I(c)):a.o?a.o():a.call(null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),C=function(){function a(a,b,c){return c&&(c.i&524288||c.Nb)?c.M(null,a,b):c instanceof Array?hc.c(c,a,b):"string"===typeof c?hc.c(c,a,b):s(fb,c)?gb.c(c,a,b):u?nc.c(a,b,c):null}function b(a,b){return b&&(b.i&524288||b.Nb)?b.N(null,a):b instanceof Array?hc.a(b,a):"string"===typeof b?hc.a(b,a):s(fb,b)?gb.a(b,a):u?nc.a(a,b):null}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,
c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),Uc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>c)if(I(d))a=c,c=F(d),d=I(d);else return c>F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;
case 2:return a>d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>b};a.d=b.d;return a}(),Vc=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a>=c)if(I(d))a=c,c=F(d),d=I(d);else return c>=F(d);else return!1}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);
a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 1:return!0;case 2:return a>=d;default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.b=function(){return!0};a.a=function(a,b){return a>=b};a.d=b.d;return a}();function Wc(a){return a-1}
var Xc=function(){function a(a,b){return a>b?a:b}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a>d?a:d,e)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);
};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}();function Yc(a){a=(a-a%2)/2;return 0<=a?Math.floor.b?Math.floor.b(a):Math.floor.call(null,a):Math.ceil.b?Math.ceil.b(a):Math.ceil.call(null,a)}function Zc(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);return 16843009*(a+(a>>4)&252645135)>>24}function $c(a){var b=1;for(a=E(a);;)if(a&&0<b)b-=1,a=I(a);else return a}
var A=function(){function a(a){return null==a?"":a.toString()}var b=null,c=function(){function a(b,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return c.call(this,b,k)}function c(a,d){for(var e=new ea(b.b(a)),l=d;;)if(r(l))e=e.append(b.b(F(l))),l=I(l);else return e.toString()}a.k=1;a.f=function(a){var b=F(a);a=G(a);return c(b,a)};a.d=c;return a}(),b=function(b,e){switch(arguments.length){case 0:return"";case 1:return a.call(this,b);default:return c.d(b,J(arguments,
1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.o=function(){return""};b.b=a;b.d=c.d;return b}(),ad=function(){var a=null,a=function(a,c,d){switch(arguments.length){case 2:return a.substring(c);case 3:return a.substring(c,d)}throw Error("Invalid arity: "+arguments.length);};a.a=function(a,c){return a.substring(c)};a.c=function(a,c,d){return a.substring(c,d)};return a}();
function lc(a,b){return Nc(Fc(b)?function(){for(var c=E(a),d=E(b);;){if(null==c)return null==d;if(null==d)return!1;if(Wb.a(F(c),F(d)))c=I(c),d=I(d);else return u?!1:null}}():null)}function bd(a,b,c,d,e){this.j=a;this.first=b;this.ta=c;this.count=d;this.m=e;this.i=65937646;this.q=8192}g=bd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return 1===this.count?null:this.ta};g.L=function(){return this.count};g.Ia=function(){return this.first};g.Ja=function(){return Ia(this)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return H};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return 1===this.count?H:this.ta};g.H=function(){return this};g.F=function(a,b){return new bd(b,this.first,this.ta,this.count,this.m)};g.G=function(a,b){return new bd(this.j,b,this,this.count+1,null)};
function cd(a){this.j=a;this.i=65937614;this.q=8192}g=cd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null};g.L=function(){return 0};g.Ia=function(){return null};g.Ja=function(){throw Error("Can't pop empty list");};g.B=function(){return 0};g.v=function(a,b){return lc(this,b)};g.I=function(){return this};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null};g.S=function(){return H};
g.H=function(){return null};g.F=function(a,b){return new cd(b)};g.G=function(a,b){return new bd(this.j,b,null,1,null)};var H=new cd(null);function dd(a){return a?a.i&134217728||a.Fc?!0:a.i?!1:s(ob,a):s(ob,a)}function ed(a){return dd(a)?pb(a):C.c(pc,H,a)}
var fd=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b;if(a instanceof ac&&0===a.p)b=a.e;else a:{for(b=[];;)if(null!=a)b.push(a.Q(null)),a=a.U(null);else break a;b=void 0}a=b.length;for(var e=H;;)if(0<a){var f=a-1,e=e.G(null,b[a-1]);a=f}else return e}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function gd(a,b,c,d){this.j=a;this.first=b;this.ta=c;this.m=d;this.i=65929452;this.q=8192}
g=gd.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.U=function(){return null==this.ta?null:E(this.ta)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.first};g.S=function(){return null==this.ta?H:this.ta};g.H=function(){return this};
g.F=function(a,b){return new gd(b,this.first,this.ta,this.m)};g.G=function(a,b){return new gd(null,b,this,this.m)};function M(a,b){var c=null==b;return(c?c:b&&(b.i&64||b.bb))?new gd(null,a,b,null):new gd(null,a,E(b),null)}function T(a,b,c,d){this.fa=a;this.name=b;this.sa=c;this.Ua=d;this.i=2153775105;this.q=4096}g=T.prototype;g.w=function(a,b){return ub(b,":"+A.b(this.sa))};g.B=function(){var a=this.Ua;return null!=a?a:this.Ua=a=Ub(this)+2654435769};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return Q.a(c,this);case 3:return Q.c(c,this,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return Q.a(a,this)};g.a=function(a,b){return Q.c(a,this,b)};g.v=function(a,b){return b instanceof T?this.sa===b.sa:!1};g.toString=function(){return":"+A.b(this.sa)};
function hd(a,b){return a===b?!0:a instanceof T&&b instanceof T?a.sa===b.sa:!1}
var jd=function(){function a(a,b){return new T(a,b,""+A.b(r(a)?""+A.b(a)+"/":null)+A.b(b),null)}function b(a){if(a instanceof T)return a;if(a instanceof Zb){var b;if(a&&(a.q&4096||a.fc))b=a.fa;else throw Error("Doesn't support namespace: "+A.b(a));return new T(b,id.b?id.b(a):id.call(null,a),a.Na,null)}return"string"===typeof a?(b=a.split("/"),2===b.length?new T(b[0],b[1],a,null):new T(null,b[0],a,null)):null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,
c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}();function V(a,b,c,d){this.j=a;this.Ya=b;this.r=c;this.m=d;this.q=0;this.i=32374988}g=V.prototype;g.toString=function(){return Lb(this)};function kd(a){null!=a.Ya&&(a.r=a.Ya.o?a.Ya.o():a.Ya.call(null),a.Ya=null);return a.r}g.D=function(){return this.j};g.U=function(){lb(this);return null==this.r?null:I(this.r)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};
g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){lb(this);return null==this.r?null:F(this.r)};g.S=function(){lb(this);return null!=this.r?G(this.r):H};g.H=function(){kd(this);if(null==this.r)return null;for(var a=this.r;;)if(a instanceof V)a=kd(a);else return this.r=a,E(this.r)};g.F=function(a,b){return new V(b,this.Ya,this.r,this.m)};g.G=function(a,b){return M(b,this)};
function ld(a,b){this.qb=a;this.end=b;this.q=0;this.i=2}ld.prototype.L=function(){return this.end};ld.prototype.add=function(a){this.qb[this.end]=a;return this.end+=1};ld.prototype.da=function(){var a=new md(this.qb,0,this.end);this.qb=null;return a};function md(a,b,c){this.e=a;this.O=b;this.end=c;this.q=0;this.i=524306}g=md.prototype;g.N=function(a,b){return hc.n(this.e,b,this.e[this.O],this.O+1)};g.M=function(a,b,c){return hc.n(this.e,b,c,this.O)};
g.Kb=function(){if(this.O===this.end)throw Error("-drop-first of empty chunk");return new md(this.e,this.O+1,this.end)};g.J=function(a,b){return this.e[this.O+b]};g.aa=function(a,b,c){return 0<=b&&b<this.end-this.O?this.e[this.O+b]:c};g.L=function(){return this.end-this.O};
var nd=function(){function a(a,b,c){return new md(a,b,c)}function b(a,b){return new md(a,b,a.length)}function c(a){return new md(a,0,a.length)}var d=null,d=function(d,f,h){switch(arguments.length){case 1:return c.call(this,d);case 2:return b.call(this,d,f);case 3:return a.call(this,d,f,h)}throw Error("Invalid arity: "+arguments.length);};d.b=c;d.a=b;d.c=a;return d}();function od(a,b,c,d){this.da=a;this.oa=b;this.j=c;this.m=d;this.i=31850732;this.q=1536}g=od.prototype;g.toString=function(){return Lb(this)};
g.D=function(){return this.j};g.U=function(){if(1<Aa(this.da))return new od(Gb(this.da),this.oa,this.j,null);var a=lb(this.oa);return null==a?null:a};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return D.a(this.da,0)};g.S=function(){return 1<Aa(this.da)?new od(Gb(this.da),this.oa,this.j,null):null==this.oa?H:this.oa};g.H=function(){return this};g.sb=function(){return this.da};
g.tb=function(){return null==this.oa?H:this.oa};g.F=function(a,b){return new od(this.da,this.oa,b,this.m)};g.G=function(a,b){return M(b,this)};g.rb=function(){return null==this.oa?null:this.oa};function pd(a,b){return 0===Aa(a)?b:new od(a,b,null,null)}function Rc(a){for(var b=[];;)if(E(a))b.push(F(a)),a=I(a);else return b}function qd(a,b){if(ic(a))return O(a);for(var c=a,d=b,e=0;;)if(0<d&&E(c))c=I(c),d-=1,e+=1;else return e}
var sd=function rd(b){return null==b?null:null==I(b)?E(F(b)):u?M(F(b),rd(I(b))):null},td=function(){function a(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),d.a(Ib(c),b)):M(F(c),d.a(G(c),b)):b},null,null)}function b(a){return new V(null,function(){return a},null,null)}function c(){return new V(null,function(){return null},null,null)}var d=null,e=function(){function a(c,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,
d,f)}function b(a,c,e){return function t(a,b){return new V(null,function(){var c=E(a);return c?Ic(c)?pd(Hb(c),t(Ib(c),b)):M(F(c),t(G(c),b)):r(b)?t(F(b),I(b)):null},null,null)}(d.a(a,c),e)}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),d=function(d,h,k){switch(arguments.length){case 0:return c.call(this);case 1:return b.call(this,d);case 2:return a.call(this,d,h);default:return e.d(d,h,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};d.k=
2;d.f=e.f;d.o=c;d.b=b;d.a=a;d.d=e.d;return d}(),ud=function(){function a(a,b,c,d){return M(a,M(b,M(c,d)))}function b(a,b,c){return M(a,M(b,c))}var c=null,d=function(){function a(c,d,e,n,q){var t=null;4<arguments.length&&(t=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,n,t)}function b(a,c,d,e,f){return M(a,M(c,M(d,M(e,sd(f)))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var q=F(a);a=G(a);return b(c,d,e,q,a)};a.d=b;return a}(),c=function(c,f,
h,k,l){switch(arguments.length){case 1:return E(c);case 2:return M(c,f);case 3:return b.call(this,c,f,h);case 4:return a.call(this,c,f,h,k);default:return d.d(c,f,h,k,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};c.k=4;c.f=d.f;c.b=function(a){return E(a)};c.a=function(a,b){return M(a,b)};c.c=b;c.n=a;c.d=d.d;return c}();function vd(a){return Ab(a)}
var wd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=zb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return zb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=
function(a,b){return zb(a,b)};a.d=b.d;return a}(),xd=function(){var a=null,b=function(){function a(c,f,h,k){var l=null;3<arguments.length&&(l=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,f,h,l)}function b(a,c,d,k){for(;;)if(a=Bb(a,c,d),r(k))c=F(k),d=F(I(k)),k=I(I(k));else return a}a.k=3;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=I(a);var k=F(a);a=G(a);return b(c,h,k,a)};a.d=b;return a}(),a=function(a,d,e,f){switch(arguments.length){case 3:return Bb(a,d,e);default:return b.d(a,
d,e,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};a.k=3;a.f=b.f;a.c=function(a,b,e){return Bb(a,b,e)};a.d=b.d;return a}(),yd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Cb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,e){switch(arguments.length){case 2:return Cb(a,
d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Cb(a,b)};a.d=b.d;return a}(),zd=function(){var a=null,b=function(){function a(c,f,h){var k=null;2<arguments.length&&(k=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,f,k)}function b(a,c,d){for(;;)if(a=Fb(a,c),r(d))c=F(d),d=I(d);else return a}a.k=2;a.f=function(a){var c=F(a);a=I(a);var h=F(a);a=G(a);return b(c,h,a)};a.d=b;return a}(),a=function(a,d,
e){switch(arguments.length){case 2:return Fb(a,d);default:return b.d(a,d,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};a.k=2;a.f=b.f;a.a=function(a,b){return Fb(a,b)};a.d=b.d;return a}();
function Ad(a,b,c){var d=E(c);if(0===b)return a.o?a.o():a.call(null);c=Ha(d);var e=Ia(d);if(1===b)return a.b?a.b(c):a.b?a.b(c):a.call(null,c);var d=Ha(e),f=Ia(e);if(2===b)return a.a?a.a(c,d):a.a?a.a(c,d):a.call(null,c,d);var e=Ha(f),h=Ia(f);if(3===b)return a.c?a.c(c,d,e):a.c?a.c(c,d,e):a.call(null,c,d,e);var f=Ha(h),k=Ia(h);if(4===b)return a.n?a.n(c,d,e,f):a.n?a.n(c,d,e,f):a.call(null,c,d,e,f);var h=Ha(k),l=Ia(k);if(5===b)return a.s?a.s(c,d,e,f,h):a.s?a.s(c,d,e,f,h):a.call(null,c,d,e,f,h);var k=Ha(l),
n=Ia(l);if(6===b)return a.X?a.X(c,d,e,f,h,k):a.X?a.X(c,d,e,f,h,k):a.call(null,c,d,e,f,h,k);var l=Ha(n),q=Ia(n);if(7===b)return a.ga?a.ga(c,d,e,f,h,k,l):a.ga?a.ga(c,d,e,f,h,k,l):a.call(null,c,d,e,f,h,k,l);var n=Ha(q),t=Ia(q);if(8===b)return a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.Ga?a.Ga(c,d,e,f,h,k,l,n):a.call(null,c,d,e,f,h,k,l,n);var q=Ha(t),v=Ia(t);if(9===b)return a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.Ha?a.Ha(c,d,e,f,h,k,l,n,q):a.call(null,c,d,e,f,h,k,l,n,q);var t=Ha(v),w=Ia(v);if(10===b)return a.va?a.va(c,d,e,
f,h,k,l,n,q,t):a.va?a.va(c,d,e,f,h,k,l,n,q,t):a.call(null,c,d,e,f,h,k,l,n,q,t);var v=Ha(w),y=Ia(w);if(11===b)return a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.wa?a.wa(c,d,e,f,h,k,l,n,q,t,v):a.call(null,c,d,e,f,h,k,l,n,q,t,v);var w=Ha(y),B=Ia(y);if(12===b)return a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.xa?a.xa(c,d,e,f,h,k,l,n,q,t,v,w):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w);var y=Ha(B),L=Ia(B);if(13===b)return a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.ya?a.ya(c,d,e,f,h,k,l,n,q,t,v,w,y):a.call(null,c,d,e,f,h,k,l,n,q,
t,v,w,y);var B=Ha(L),U=Ia(L);if(14===b)return a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.za?a.za(c,d,e,f,h,k,l,n,q,t,v,w,y,B):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B);var L=Ha(U),Z=Ia(U);if(15===b)return a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.Aa?a.Aa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L);var U=Ha(Z),na=Ia(Z);if(16===b)return a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.Ba?a.Ba(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U);var Z=
Ha(na),Ga=Ia(na);if(17===b)return a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.Ca?a.Ca(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z);var na=Ha(Ga),Ra=Ia(Ga);if(18===b)return a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.Da?a.Da(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na);Ga=Ha(Ra);Ra=Ia(Ra);if(19===b)return a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.Ea?a.Ea(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga):a.call(null,
c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga);var wc=Ha(Ra);Ia(Ra);if(20===b)return a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.Fa?a.Fa(c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc):a.call(null,c,d,e,f,h,k,l,n,q,t,v,w,y,B,L,U,Z,na,Ga,wc);throw Error("Only up to 20 arguments supported on functions");}
var S=function(){function a(a,b,c,d,e){b=ud.n(b,c,d,e);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function b(a,b,c,d){b=ud.c(b,c,d);c=a.k;return a.f?(d=qd(b,c+1),d<=c?Ad(a,d,b):a.f(b)):a.apply(a,Rc(b))}function c(a,b,c){b=ud.a(b,c);c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}function d(a,b){var c=a.k;if(a.f){var d=qd(b,c+1);return d<=c?Ad(a,d,b):a.f(b)}return a.apply(a,Rc(b))}var e=null,f=function(){function a(c,d,e,f,h,w){var y=null;
5<arguments.length&&(y=J(Array.prototype.slice.call(arguments,5),0));return b.call(this,c,d,e,f,h,y)}function b(a,c,d,e,f,h){c=M(c,M(d,M(e,M(f,sd(h)))));d=a.k;return a.f?(e=qd(c,d+1),e<=d?Ad(a,e,c):a.f(c)):a.apply(a,Rc(c))}a.k=5;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=G(a);return b(c,d,e,f,h,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t){switch(arguments.length){case 2:return d.call(this,e,k);case 3:return c.call(this,e,k,l);case 4:return b.call(this,
e,k,l,n);case 5:return a.call(this,e,k,l,n,q);default:return f.d(e,k,l,n,q,J(arguments,5))}throw Error("Invalid arity: "+arguments.length);};e.k=5;e.f=f.f;e.a=d;e.c=c;e.n=b;e.s=a;e.d=f.d;return e}(),Bd=function(){function a(a,b){return!Wb.a(a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return sa(S.n(Wb,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,
d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return!1;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(){return!1};b.a=a;b.d=c.d;return b}();function Cd(a){return E(a)?a:null}function Dd(a,b){for(;;){if(null==E(b))return!0;if(r(a.b?a.b(F(b)):a.call(null,F(b)))){var c=a,d=I(b);a=c;b=d}else return u?!1:null}}
function Ed(a,b){for(;;)if(E(b)){var c=a.b?a.b(F(b)):a.call(null,F(b));if(r(c))return c;var c=a,d=I(b);a=c;b=d}else return null}function Fd(a){return a}
function Gd(a){return function(){var b=null,c=function(){function b(a,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,a,d,l)}function c(b,d,e){return sa(S.n(a,b,d,e))}b.k=2;b.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};b.d=c;return b}(),b=function(b,e,f){switch(arguments.length){case 0:return sa(a.o?a.o():a.call(null));case 1:var h=b;return sa(a.b?a.b(h):a.call(null,h));case 2:var h=b,k=e;return sa(a.a?a.a(h,k):a.call(null,
h,k));default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;return b}()}
var Hd=function(){function a(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return a.b?a.b(b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q))):a.call(null,b.b?b.b(S.s(c,d,l,n,q)):b.call(null,S.s(c,d,l,n,q)))}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 0:return a.b?
a.b(b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null))):a.call(null,b.b?b.b(c.o?c.o():c.call(null)):b.call(null,c.o?c.o():c.call(null)));case 1:var w=d;return a.b?a.b(b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w))):a.call(null,b.b?b.b(c.b?c.b(w):c.call(null,w)):b.call(null,c.b?c.b(w):c.call(null,w)));case 2:var w=d,y=k;return a.b?a.b(b.b?b.b(c.a?c.a(w,y):c.call(null,w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y))):a.call(null,b.b?b.b(c.a?c.a(w,y):c.call(null,
w,y)):b.call(null,c.a?c.a(w,y):c.call(null,w,y)));case 3:var w=d,y=k,B=t;return a.b?a.b(b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B))):a.call(null,b.b?b.b(c.c?c.c(w,y,B):c.call(null,w,y,B)):b.call(null,c.c?c.c(w,y,B):c.call(null,w,y,B)));default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function b(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&
(h=J(Array.prototype.slice.call(arguments,3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return a.b?a.b(S.s(b,c,h,k,l)):a.call(null,S.s(b,c,h,k,l))}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 0:return a.b?a.b(b.o?b.o():b.call(null)):a.call(null,b.o?b.o():b.call(null));case 1:var v=c;return a.b?a.b(b.b?b.b(v):b.call(null,v)):a.call(null,b.b?b.b(v):b.call(null,v));case 2:var v=
c,w=h;return a.b?a.b(b.a?b.a(v,w):b.call(null,v,w)):a.call(null,b.a?b.a(v,w):b.call(null,v,w));case 3:var v=c,w=h,y=q;return a.b?a.b(b.c?b.c(v,w,y):b.call(null,v,w,y)):a.call(null,b.c?b.c(v,w,y):b.call(null,v,w,y));default:return d.d(c,h,q,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var c=null,d=function(){function a(c,d,e,n){var q=null;3<arguments.length&&(q=J(Array.prototype.slice.call(arguments,3),0));return b.call(this,c,d,e,q)}function b(a,c,d,
e){return function(a){return function(){function b(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return c.call(this,d)}function c(b){b=S.a(F(a),b);for(var d=I(a);;)if(d)b=F(d).call(null,b),d=I(d);else return b}b.k=0;b.f=function(a){a=E(a);return c(a)};b.d=c;return b}()}(ed(ud.n(a,c,d,e)))}a.k=3;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=G(a);return b(c,d,e,a)};a.d=b;return a}(),c=function(c,f,h,k){switch(arguments.length){case 0:return Fd;
case 1:return c;case 2:return b.call(this,c,f);case 3:return a.call(this,c,f,h);default:return d.d(c,f,h,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;c.o=function(){return Fd};c.b=function(a){return a};c.a=b;c.c=a;c.d=d.d;return c}(),Id=function(){function a(a,b,c,d){return function(){function e(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return q.call(this,b)}function q(e){return S.s(a,b,c,d,e)}e.k=0;e.f=function(a){a=E(a);
return q(a)};e.d=q;return e}()}function b(a,b,c){return function(){function d(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,b)}function e(d){return S.n(a,b,c,d)}d.k=0;d.f=function(a){a=E(a);return e(a)};d.d=e;return d}()}function c(a,b){return function(){function c(a){var b=null;0<arguments.length&&(b=J(Array.prototype.slice.call(arguments,0),0));return d.call(this,b)}function d(c){return S.c(a,b,c)}c.k=0;c.f=function(a){a=E(a);return d(a)};
c.d=d;return c}()}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return h.call(this,c)}function h(b){return S.s(a,c,d,e,td.a(f,b))}b.k=0;b.f=function(a){a=E(a);return h(a)};b.d=h;return b}()}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);
a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 1:return d;case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.b=function(a){return a};d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Jd=function(){function a(a,b,c,d){return function(){var l=null,n=function(){function l(a,b,c,d){var e=null;
3<arguments.length&&(e=J(Array.prototype.slice.call(arguments,3),0));return n.call(this,a,b,c,e)}function n(l,q,t,B){return S.s(a,null==l?b:l,null==q?c:q,null==t?d:t,B)}l.k=3;l.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return n(b,c,d,a)};l.d=n;return l}(),l=function(l,t,v,w){switch(arguments.length){case 2:var y=l,B=t;return a.a?a.a(null==y?b:y,null==B?c:B):a.call(null,null==y?b:y,null==B?c:B);case 3:var y=l,B=t,L=v;return a.c?a.c(null==y?b:y,null==B?c:B,null==L?d:L):a.call(null,
null==y?b:y,null==B?c:B,null==L?d:L);default:return n.d(l,t,v,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};l.k=3;l.f=n.f;return l}()}function b(a,b,c){return function(){var d=null,l=function(){function d(a,b,c,e){var f=null;3<arguments.length&&(f=J(Array.prototype.slice.call(arguments,3),0));return k.call(this,a,b,c,f)}function k(d,l,n,q){return S.s(a,null==d?b:d,null==l?c:l,n,q)}d.k=3;d.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var d=F(a);a=G(a);return k(b,c,d,a)};d.d=
k;return d}(),d=function(d,k,t,v){switch(arguments.length){case 2:var w=d,y=k;return a.a?a.a(null==w?b:w,null==y?c:y):a.call(null,null==w?b:w,null==y?c:y);case 3:var w=d,y=k,B=t;return a.c?a.c(null==w?b:w,null==y?c:y,B):a.call(null,null==w?b:w,null==y?c:y,B);default:return l.d(d,k,t,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};d.k=3;d.f=l.f;return d}()}function c(a,b){return function(){var c=null,d=function(){function c(a,b,e,f){var h=null;3<arguments.length&&(h=J(Array.prototype.slice.call(arguments,
3),0));return d.call(this,a,b,e,h)}function d(c,h,k,l){return S.s(a,null==c?b:c,h,k,l)}c.k=3;c.f=function(a){var b=F(a);a=I(a);var c=F(a);a=I(a);var e=F(a);a=G(a);return d(b,c,e,a)};c.d=d;return c}(),c=function(c,h,q,t){switch(arguments.length){case 1:var v=c;return a.b?a.b(null==v?b:v):a.call(null,null==v?b:v);case 2:var v=c,w=h;return a.a?a.a(null==v?b:v,w):a.call(null,null==v?b:v,w);case 3:var v=c,w=h,y=q;return a.c?a.c(null==v?b:v,w,y):a.call(null,null==v?b:v,w,y);default:return d.d(c,h,q,J(arguments,
3))}throw Error("Invalid arity: "+arguments.length);};c.k=3;c.f=d.f;return c}()}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),Kd=function(){function a(a,b,c,e){return new V(null,function(){var n=E(b),q=E(c),t=E(e);return n&&q&&t?M(a.c?a.c(F(n),F(q),F(t)):a.call(null,F(n),F(q),F(t)),d.n(a,G(n),G(q),G(t))):null},
null,null)}function b(a,b,c){return new V(null,function(){var e=E(b),n=E(c);return e&&n?M(a.a?a.a(F(e),F(n)):a.call(null,F(e),F(n)),d.c(a,G(e),G(n))):null},null,null)}function c(a,b){return new V(null,function(){var c=E(b);if(c){if(Ic(c)){for(var e=Hb(c),n=O(e),q=new ld(Array(n),0),t=0;;)if(t<n){var v=a.b?a.b(D.a(e,t)):a.call(null,D.a(e,t));q.add(v);t+=1}else break;return pd(q.da(),d.a(a,Ib(c)))}return M(a.b?a.b(F(c)):a.call(null,F(c)),d.a(a,G(c)))}return null},null,null)}var d=null,e=function(){function a(c,
d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,e,f,h){var v=function y(a){return new V(null,function(){var b=d.a(E,a);return Dd(Fd,b)?M(d.a(F,b),y(d.a(G,b))):null},null,null)};return d.a(function(){return function(b){return S.a(a,b)}}(v),v(pc.d(h,f,J([e,c],0))))}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,
n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Md=function Ld(b,c){return new V(null,function(){if(0<b){var d=E(c);return d?M(F(d),Ld(b-1,G(d))):null}return null},null,null)};
function Nd(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b);if(0<a&&e){var f=a-1,e=G(e);a=f;b=e}else return e}}),null,null)}
var Od=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a,c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Pd=function(){function a(a,b){return Md(a,c.b(b))}function b(a){return new V(null,function(){return M(a.o?a.o():a.call(null),c.b(a))},null,null)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Qd=function(){function a(a,c){return new V(null,function(){var f=E(a),h=E(c);return f&&h?M(F(f),M(F(h),b.a(G(f),G(h)))):null},null,null)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return new V(null,function(){var c=Kd.a(E,pc.d(e,d,J([a],0)));return Dd(Fd,c)?td.a(Kd.a(F,
c),S.a(b,Kd.a(G,c))):null},null,null)}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}();function Rd(a){return function c(a,e){return new V(null,function(){var f=E(a);return f?M(F(f),c(G(f),e)):E(e)?c(F(e),G(e)):null},null,null)}(null,a)}
var Sd=function(){function a(a,b){return Rd(Kd.a(a,b))}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){return Rd(S.n(Kd,a,c,d))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};
b.k=2;b.f=c.f;b.a=a;b.d=c.d;return b}(),Ud=function Td(b,c){return new V(null,function(){var d=E(c);if(d){if(Ic(d)){for(var e=Hb(d),f=O(e),h=new ld(Array(f),0),k=0;;)if(k<f){if(r(b.b?b.b(D.a(e,k)):b.call(null,D.a(e,k)))){var l=D.a(e,k);h.add(l)}k+=1}else break;return pd(h.da(),Td(b,Ib(d)))}e=F(d);d=G(d);return r(b.b?b.b(e):b.call(null,e))?M(e,Td(b,d)):Td(b,d)}return null},null,null)};function Vd(a,b){return Ud(Gd(a),b)}
function Wd(a){var b=Xd;return function d(a){return new V(null,function(){return M(a,r(b.b?b.b(a):b.call(null,a))?Sd.a(d,E.b?E.b(a):E.call(null,a)):null)},null,null)}(a)}function Yd(a,b){return null!=a?a&&(a.q&4||a.Bc)?vd(C.c(zb,yb(a),b)):C.c(Da,a,b):C.c(pc,H,b)}
var Zd=function(){function a(a,b,c,k){return new V(null,function(){var l=E(k);if(l){var n=Md(a,l);return a===O(n)?M(n,d.n(a,b,c,Nd(b,l))):Da(H,Md(a,td.a(n,c)))}return null},null,null)}function b(a,b,c){return new V(null,function(){var k=E(c);if(k){var l=Md(a,k);return a===O(l)?M(l,d.c(a,b,Nd(b,k))):null}return null},null,null)}function c(a,b){return d.c(a,a,b)}var d=null,d=function(d,f,h,k){switch(arguments.length){case 2:return c.call(this,d,f);case 3:return b.call(this,d,f,h);case 4:return a.call(this,
d,f,h,k)}throw Error("Invalid arity: "+arguments.length);};d.a=c;d.c=b;d.n=a;return d}(),$d=function(){function a(a,b,c){var h=Lc;for(b=E(b);;)if(b){var k=a;if(k?k.i&256||k.Mb||(k.i?0:s(Ka,k)):s(Ka,k)){a=Q.c(a,F(b),h);if(h===a)return c;b=I(b)}else return c}else return a}function b(a,b){return c.c(a,b,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}(),ae=
function(){function a(a,b,c,d,f,t){var v=P.c(b,0,null);return(b=$c(b))?R.c(a,v,e.X(Q.a(a,v),b,c,d,f,t)):R.c(a,v,c.n?c.n(Q.a(a,v),d,f,t):c.call(null,Q.a(a,v),d,f,t))}function b(a,b,c,d,f){var t=P.c(b,0,null);return(b=$c(b))?R.c(a,t,e.s(Q.a(a,t),b,c,d,f)):R.c(a,t,c.c?c.c(Q.a(a,t),d,f):c.call(null,Q.a(a,t),d,f))}function c(a,b,c,d){var f=P.c(b,0,null);return(b=$c(b))?R.c(a,f,e.n(Q.a(a,f),b,c,d)):R.c(a,f,c.a?c.a(Q.a(a,f),d):c.call(null,Q.a(a,f),d))}function d(a,b,c){var d=P.c(b,0,null);return(b=$c(b))?
R.c(a,d,e.c(Q.a(a,d),b,c)):R.c(a,d,c.b?c.b(Q.a(a,d)):c.call(null,Q.a(a,d)))}var e=null,f=function(){function a(c,d,e,f,h,w,y){var B=null;6<arguments.length&&(B=J(Array.prototype.slice.call(arguments,6),0));return b.call(this,c,d,e,f,h,w,B)}function b(a,c,d,f,h,k,y){var B=P.c(c,0,null);return(c=$c(c))?R.c(a,B,S.d(e,Q.a(a,B),c,d,f,J([h,k,y],0))):R.c(a,B,S.d(d,Q.a(a,B),f,h,k,J([y],0)))}a.k=6;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=I(a);var h=F(a);a=I(a);var y=
F(a);a=G(a);return b(c,d,e,f,h,y,a)};a.d=b;return a}(),e=function(e,k,l,n,q,t,v){switch(arguments.length){case 3:return d.call(this,e,k,l);case 4:return c.call(this,e,k,l,n);case 5:return b.call(this,e,k,l,n,q);case 6:return a.call(this,e,k,l,n,q,t);default:return f.d(e,k,l,n,q,t,J(arguments,6))}throw Error("Invalid arity: "+arguments.length);};e.k=6;e.f=f.f;e.c=d;e.n=c;e.s=b;e.X=a;e.d=f.d;return e}();function be(a,b){this.t=a;this.e=b}
function ce(a){return new be(a,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null])}function de(a){return new be(a.t,va(a.e))}function ee(a){a=a.g;return 32>a?0:a-1>>>5<<5}function fe(a,b,c){for(;;){if(0===b)return c;var d=ce(a);d.e[0]=c;c=d;b-=5}}var he=function ge(b,c,d,e){var f=de(d),h=b.g-1>>>c&31;5===c?f.e[h]=e:(d=d.e[h],b=null!=d?ge(b,c-5,d,e):fe(null,c-5,e),f.e[h]=b);return f};
function ie(a,b){throw Error("No item "+A.b(a)+" in vector of length "+A.b(b));}function je(a){var b=a.root;for(a=a.shift;;)if(0<a)a-=5,b=b.e[0];else return b.e}function ke(a,b){if(b>=ee(a))return a.R;for(var c=a.root,d=a.shift;;)if(0<d)var e=d-5,c=c.e[b>>>d&31],d=e;else return c.e}function le(a,b){return 0<=b&&b<a.g?ke(a,b):ie(b,a.g)}
var ne=function me(b,c,d,e,f){var h=de(d);if(0===c)h.e[e&31]=f;else{var k=e>>>c&31;b=me(b,c-5,d.e[k],e,f);h.e[k]=b}return h},pe=function oe(b,c,d){var e=b.g-2>>>c&31;if(5<c){b=oe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d=de(d);d.e[e]=b;return d}return 0===e?null:u?(d=de(d),d.e[e]=null,d):null};function W(a,b,c,d,e,f){this.j=a;this.g=b;this.shift=c;this.root=d;this.R=e;this.m=f;this.i=167668511;this.q=8196}g=W.prototype;g.toString=function(){return Lb(this)};
g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.Za=function(a,b,c){a=[0,c];for(c=0;;)if(c<this.g){var d=ke(this,c),e=d.length;a:{for(var f=0,h=a[1];;)if(f<e){h=b.c?b.c(h,f+c,d[f]):b.call(null,h,f+c,d[f]);if(fc(h)){d=h;break a}f+=1}else{a[0]=e;d=a[1]=h;break a}d=void 0}if(fc(d))return K.b?K.b(d):K.call(null,d);c+=a[0]}else return a[1]};g.J=function(a,b){return le(this,b)[b&31]};
g.aa=function(a,b,c){return 0<=b&&b<this.g?ke(this,b)[b&31]:c};g.Pa=function(a,b,c){if(0<=b&&b<this.g)return ee(this)<=b?(a=va(this.R),a[b&31]=c,new W(this.j,this.g,this.shift,this.root,a,null)):new W(this.j,this.g,this.shift,ne(this,this.shift,this.root,b,c),this.R,null);if(b===this.g)return Da(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds  [0,"+A.b(this.g)+"]");return null};g.D=function(){return this.j};g.L=function(){return this.g};g.$a=function(){return D.a(this,0)};
g.ab=function(){return D.a(this,1)};g.Ia=function(){return 0<this.g?D.a(this,this.g-1):null};g.Ja=function(){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return eb(qe,this.j);if(1<this.g-ee(this))return new W(this.j,this.g-1,this.shift,this.root,this.R.slice(0,-1),null);if(u){var a=ke(this,this.g-2),b=pe(this,this.shift,this.root),b=null==b?X:b,c=this.g-1;return 5<this.shift&&null==b.e[1]?new W(this.j,c,this.shift-5,b.e[0],a,null):new W(this.j,c,this.shift,b,a,null)}return null};
g.Xa=function(){return 0<this.g?new kc(this,this.g-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.Wa=function(){return new re(this.g,this.shift,se.b?se.b(this.root):se.call(null,this.root),te.b?te.b(this.R):te.call(null,this.R))};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Vector's key for assoc must be a number.");};g.H=function(){return 0===this.g?null:32>=this.g?new ac(this.R,0):u?ue.n?ue.n(this,je(this),0,0):ue.call(null,this,je(this),0,0):null};g.F=function(a,b){return new W(b,this.g,this.shift,this.root,this.R,this.m)};
g.G=function(a,b){if(32>this.g-ee(this)){for(var c=this.R.length,d=Array(c+1),e=0;;)if(e<c)d[e]=this.R[e],e+=1;else break;d[c]=b;return new W(this.j,this.g+1,this.shift,this.root,d,null)}c=(d=this.g>>>5>1<<this.shift)?this.shift+5:this.shift;d?(d=ce(null),d.e[0]=this.root,e=fe(null,this.shift,new be(null,this.R)),d.e[1]=e):d=he(this,this.shift,this.root,new be(null,this.R));return new W(this.j,this.g+1,c,d,[b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};g.a=function(a,b){return this.aa(null,a,b)};
var X=new be(null,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]),qe=new W(null,0,5,X,[],0);function ve(a,b){var c=a.length,d=b?a:va(a);if(32>c)return new W(null,c,5,X,d,null);for(var e=32,f=(new W(null,32,5,X,d.slice(0,32),null)).Wa(null);;)if(e<c)var h=e+1,f=wd.a(f,d[e]),e=h;else return Ab(f)}function we(a){return Ab(C.c(zb,yb(qe),a))}
var xe=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return a instanceof ac&&0===a.p?ve.a?ve.a(a.e,!0):ve.call(null,a.e,!0):we(a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function ye(a,b,c,d,e,f){this.P=a;this.ea=b;this.p=c;this.O=d;this.j=e;this.m=f;this.i=32243948;this.q=1536}g=ye.prototype;g.toString=function(){return Lb(this)};
g.U=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?null:a}return Jb(this)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b)};
g.M=function(a,b,c){return gc.c(ze.c?ze.c(this.P,this.p+this.O,O(this.P)):ze.call(null,this.P,this.p+this.O,O(this.P)),b,c)};g.Q=function(){return this.ea[this.O]};g.S=function(){if(this.O+1<this.ea.length){var a=ue.n?ue.n(this.P,this.ea,this.p,this.O+1):ue.call(null,this.P,this.ea,this.p,this.O+1);return null==a?H:a}return Ib(this)};g.H=function(){return this};g.sb=function(){return nd.a(this.ea,this.O)};
g.tb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):H};g.F=function(a,b){return ue.s?ue.s(this.P,this.ea,this.p,this.O,b):ue.call(null,this.P,this.ea,this.p,this.O,b)};g.G=function(a,b){return M(b,this)};g.rb=function(){var a=this.p+this.ea.length;return a<Aa(this.P)?ue.n?ue.n(this.P,ke(this.P,a),a,0):ue.call(null,this.P,ke(this.P,a),a,0):null};
var ue=function(){function a(a,b,c,d,l){return new ye(a,b,c,d,l,null)}function b(a,b,c,d){return new ye(a,b,c,d,null,null)}function c(a,b,c){return new ye(a,le(a,b),b,c,null,null)}var d=null,d=function(d,f,h,k,l){switch(arguments.length){case 3:return c.call(this,d,f,h);case 4:return b.call(this,d,f,h,k);case 5:return a.call(this,d,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};d.c=c;d.n=b;d.s=a;return d}();
function Ae(a,b,c,d,e){this.j=a;this.ca=b;this.start=c;this.end=d;this.m=e;this.i=166617887;this.q=8192}g=Ae.prototype;g.toString=function(){return Lb(this)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};g.J=function(a,b){return 0>b||this.end<=this.start+b?ie(b,this.end-this.start):D.a(this.ca,this.start+b)};g.aa=function(a,b,c){return 0>b||this.end<=this.start+b?c:D.c(this.ca,this.start+b,c)};
g.Pa=function(a,b,c){var d=this,e=d.start+b;return Be.s?Be.s(d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null):Be.call(null,d.j,R.c(d.ca,e,c),d.start,function(){var a=d.end,b=e+1;return a>b?a:b}(),null)};g.D=function(){return this.j};g.L=function(){return this.end-this.start};g.Ia=function(){return D.a(this.ca,this.end-1)};
g.Ja=function(){if(this.start===this.end)throw Error("Can't pop empty vector");return Be.s?Be.s(this.j,this.ca,this.start,this.end-1,null):Be.call(null,this.j,this.ca,this.start,this.end-1,null)};g.Xa=function(){return this.start!==this.end?new kc(this,this.end-this.start-1,null):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(qe,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){if("number"===typeof b)return $a(this,b,c);throw Error("Subvec's key for assoc must be a number.");};g.H=function(){var a=this;return function(b){return function d(e){return e===a.end?null:M(D.a(a.ca,e),new V(null,function(){return function(){return d(e+1)}}(b),null,null))}}(this)(a.start)};g.F=function(a,b){return Be.s?Be.s(b,this.ca,this.start,this.end,this.m):Be.call(null,b,this.ca,this.start,this.end,this.m)};
g.G=function(a,b){return Be.s?Be.s(this.j,$a(this.ca,this.end,b),this.start,this.end+1,null):Be.call(null,this.j,$a(this.ca,this.end,b),this.start,this.end+1,null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.J(null,c);case 3:return this.aa(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.J(null,a)};
g.a=function(a,b){return this.aa(null,a,b)};function Be(a,b,c,d,e){for(;;)if(b instanceof Ae)c=b.start+c,d=b.start+d,b=b.ca;else{var f=O(b);if(0>c||0>d||c>f||d>f)throw Error("Index out of bounds");return new Ae(a,b,c,d,e)}}
var ze=function(){function a(a,b,c){return Be(null,a,b,c,null)}function b(a,b){return c.c(a,b,O(a))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();function Ce(a,b){return a===b.t?b:new be(a,va(b.e))}function se(a){return new be({},va(a.e))}
function te(a){var b=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];Kc(a,0,b,0,a.length);return b}
var Ee=function De(b,c,d,e){d=Ce(b.root.t,d);var f=b.g-1>>>c&31;if(5===c)b=e;else{var h=d.e[f];b=null!=h?De(b,c-5,h,e):fe(b.root.t,c-5,e)}d.e[f]=b;return d},Ge=function Fe(b,c,d){d=Ce(b.root.t,d);var e=b.g-2>>>c&31;if(5<c){b=Fe(b,c-5,d.e[e]);if(null==b&&0===e)return null;d.e[e]=b;return d}return 0===e?null:u?(d.e[e]=null,d):null};function re(a,b,c,d){this.g=a;this.shift=b;this.root=c;this.R=d;this.i=275;this.q=88}g=re.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return"number"===typeof b?D.c(this,b,c):c};
g.J=function(a,b){if(this.root.t)return le(this,b)[b&31];throw Error("nth after persistent!");};g.aa=function(a,b,c){return 0<=b&&b<this.g?D.a(this,b):c};g.L=function(){if(this.root.t)return this.g;throw Error("count after persistent!");};
g.Pb=function(a,b,c){var d=this;if(d.root.t){if(0<=b&&b<d.g)return ee(this)<=b?d.R[b&31]=c:(a=function(){return function f(a,k){var l=Ce(d.root.t,k);if(0===a)l.e[b&31]=c;else{var n=b>>>a&31,q=f(a-5,l.e[n]);l.e[n]=q}return l}}(this).call(null,d.shift,d.root),d.root=a),this;if(b===d.g)return zb(this,c);if(u)throw Error("Index "+A.b(b)+" out of bounds for TransientVector of length"+A.b(d.g));return null}throw Error("assoc! after persistent!");};
g.Qb=function(){if(this.root.t){if(0===this.g)throw Error("Can't pop empty vector");if(1===this.g)return this.g=0,this;if(0<(this.g-1&31))return this.g-=1,this;if(u){var a;a:if(a=this.g-2,a>=ee(this))a=this.R;else{for(var b=this.root,c=b,d=this.shift;;)if(0<d)c=Ce(b.t,c.e[a>>>d&31]),d-=5;else{a=c.e;break a}a=void 0}b=Ge(this,this.shift,this.root);b=null!=b?b:new be(this.root.t,[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,null]);5<this.shift&&null==b.e[1]?(this.root=Ce(this.root.t,b.e[0]),this.shift-=5):this.root=b;this.g-=1;this.R=a;return this}return null}throw Error("pop! after persistent!");};g.cb=function(a,b,c){if("number"===typeof b)return Db(this,b,c);throw Error("TransientVector's key for assoc! must be a number.");};
g.Ka=function(a,b){if(this.root.t){if(32>this.g-ee(this))this.R[this.g&31]=b;else{var c=new be(this.root.t,this.R),d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];d[0]=b;this.R=d;if(this.g>>>5>1<<this.shift){var d=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],e=this.shift+
5;d[0]=this.root;d[1]=fe(this.root.t,this.shift,c);this.root=new be(this.root.t,d);this.shift=e}else this.root=Ee(this,this.shift,this.root,c)}this.g+=1;return this}throw Error("conj! after persistent!");};g.Oa=function(){if(this.root.t){this.root.t=null;var a=this.g-ee(this),b=Array(a);Kc(this.R,0,b,0,a);return new W(null,this.g,this.shift,this.root,b,null)}throw Error("persistent! called twice");};function He(a,b,c,d){this.j=a;this.ba=b;this.pa=c;this.m=d;this.q=0;this.i=31850572}g=He.prototype;
g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.Q=function(){return F(this.ba)};g.S=function(){var a=I(this.ba);return a?new He(this.j,a,this.pa,null):null==this.pa?Ba(this):new He(this.j,this.pa,null,null)};g.H=function(){return this};g.F=function(a,b){return new He(b,this.ba,this.pa,this.m)};g.G=function(a,b){return M(b,this)};
function Ie(a,b,c,d,e){this.j=a;this.count=b;this.ba=c;this.pa=d;this.m=e;this.i=31858766;this.q=8192}g=Ie.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.L=function(){return this.count};g.Ia=function(){return F(this.ba)};g.Ja=function(){if(r(this.ba)){var a=I(this.ba);return a?new Ie(this.j,this.count-1,a,this.pa,null):new Ie(this.j,this.count-1,E(this.pa),qe,null)}return this};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return Je};g.Q=function(){return F(this.ba)};g.S=function(){return G(E(this))};g.H=function(){var a=E(this.pa),b=this.ba;return r(r(b)?b:a)?new He(null,this.ba,E(a),null):null};g.F=function(a,b){return new Ie(b,this.count,this.ba,this.pa,this.m)};g.G=function(a,b){var c;r(this.ba)?(c=this.pa,c=new Ie(this.j,this.count+1,this.ba,pc.a(r(c)?c:qe,b),null)):c=new Ie(this.j,this.count+1,pc.a(this.ba,b),qe,null);return c};var Je=new Ie(null,0,null,qe,0);
function Ke(){this.q=0;this.i=2097152}Ke.prototype.v=function(){return!1};var Le=new Ke;function Me(a,b){return Nc(Gc(b)?O(a)===O(b)?Dd(Fd,Kd.a(function(a){return Wb.a(Q.c(b,F(a),Le),F(I(a)))},a)):null:null)}function Ne(a){this.r=a}Ne.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:a}}return{done:!0,value:null}};function Oe(a){return new Ne(E(a))}function Pe(a){this.r=a}
Pe.prototype.next=function(){if(null!=this.r){var a=F(this.r),b=P.c(a,0,null),a=P.c(a,1,null);this.r=I(this.r);return{done:!1,value:[b,a]}}return{done:!0,value:null}};function Qe(a){return new Pe(E(a))}function Re(a){this.r=a}Re.prototype.next=function(){if(null!=this.r){var a=F(this.r);this.r=I(this.r);return{done:!1,value:[a,a]}}return{done:!0,value:null}};function Se(a){return new Re(E(a))}
function Te(a,b){var c=a.e;if(b instanceof T)a:{for(var d=c.length,e=b.sa,f=0;;){if(d<=f){c=-1;break a}var h=c[f];if(h instanceof T&&e===h.sa){c=f;break a}if(u)f+=2;else{c=null;break a}}c=void 0}else if("string"==typeof b||"number"===typeof b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(b===c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(b instanceof Zb)a:{d=c.length;e=b.Na;for(f=0;;){if(d<=f){c=-1;break a}h=c[f];if(h instanceof Zb&&e===h.Na){c=f;break a}if(u)f+=2;else{c=null;
break a}}c=void 0}else if(null==b)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(null==c[e]){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else if(u)a:{d=c.length;for(e=0;;){if(d<=e){c=-1;break a}if(Wb.a(b,c[e])){c=e;break a}if(u)e+=2;else{c=null;break a}}c=void 0}else c=null;return c}function Ue(a,b,c){this.e=a;this.p=b;this.W=c;this.q=0;this.i=32374990}g=Ue.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};
g.U=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):null};g.L=function(){return(this.e.length-this.p)/2};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return new W(null,2,5,X,[this.e[this.p],this.e[this.p+1]],null)};g.S=function(){return this.p<this.e.length-2?new Ue(this.e,this.p+2,this.W):H};g.H=function(){return this};
g.F=function(a,b){return new Ue(this.e,this.p,b)};g.G=function(a,b){return M(b,this)};function la(a,b,c,d){this.j=a;this.g=b;this.e=c;this.m=d;this.i=16647951;this.q=8196}g=la.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Te(this,b);return-1===a?c:this.e[a+1]};
g.Za=function(a,b,c){a=this.e.length;for(var d=0;;)if(d<a){c=b.c?b.c(c,this.e[d],this.e[d+1]):b.call(null,c,this.e[d],this.e[d+1]);if(fc(c))return K.b?K.b(c):K.call(null,c);d+=2}else return c};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new Xe({},this.e.length,va(this.e))};g.I=function(){return eb(Ye,this.j)};g.N=function(a,b){return nc.a(b,this)};
g.M=function(a,b,c){return nc.c(b,c,this)};g.nb=function(a,b){if(0<=Te(this,b)){var c=this.e.length,d=c-2;if(0===d)return Ba(this);for(var d=Array(d),e=0,f=0;;){if(e>=c)return new la(this.j,this.g-1,d,null);if(Wb.a(b,this.e[e]))e+=2;else if(u)d[f]=this.e[e],d[f+1]=this.e[e+1],f+=2,e+=2;else return null}}else return this};
g.ua=function(a,b,c){a=Te(this,b);if(-1===a){if(this.g<Ze){a=this.e;for(var d=a.length,e=Array(d+2),f=0;;)if(f<d)e[f]=a[f],f+=1;else break;e[d]=b;e[d+1]=c;return new la(this.j,this.g+1,e,null)}return eb(Oa(Yd($e,this),b,c),this.j)}return c===this.e[a+1]?this:u?(b=va(this.e),b[a+1]=c,new la(this.j,this.g,b,null)):null};g.kb=function(a,b){return-1!==Te(this,b)};g.H=function(){var a=this.e;return 0<=a.length-2?new Ue(a,0,null):null};g.F=function(a,b){return new la(b,this.g,this.e,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var Ye=new la(null,0,[],null),Ze=8;function af(a){for(var b=a.length,c=0,d=yb(Ye);;)if(c<b)var e=c+2,d=Bb(d,a[c],a[c+1]),c=e;else return Ab(d)}function Xe(a,b,c){this.Ra=a;this.ja=b;this.e=c;this.q=56;this.i=258}g=Xe.prototype;
g.Ab=function(a,b){if(r(this.Ra)){var c=Te(this,b);0<=c&&(this.e[c]=this.e[this.ja-2],this.e[c+1]=this.e[this.ja-1],c=this.e,c.pop(),c.pop(),this.ja-=2);return this}throw Error("dissoc! after persistent!");};g.cb=function(a,b,c){if(r(this.Ra)){a=Te(this,b);if(-1===a)return this.ja+2<=2*Ze?(this.ja+=2,this.e.push(b),this.e.push(c),this):xd.c(bf.a?bf.a(this.ja,this.e):bf.call(null,this.ja,this.e),b,c);c!==this.e[a+1]&&(this.e[a+1]=c);return this}throw Error("assoc! after persistent!");};
g.Ka=function(a,b){if(r(this.Ra)){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b))return Bb(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));for(var c=E(b),d=this;;){var e=F(c);if(r(e))c=I(c),d=Bb(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else return d}}else throw Error("conj! after persistent!");};g.Oa=function(){if(r(this.Ra))return this.Ra=!1,new la(null,Yc(this.ja),this.e,null);throw Error("persistent! called twice");};g.u=function(a,b){return La.c(this,b,null)};
g.C=function(a,b,c){if(r(this.Ra))return a=Te(this,b),-1===a?c:this.e[a+1];throw Error("lookup after persistent!");};g.L=function(){if(r(this.Ra))return Yc(this.ja);throw Error("count after persistent!");};function bf(a,b){for(var c=yb($e),d=0;;)if(d<a)c=xd.c(c,b[d],b[d+1]),d+=2;else return c}function ef(){this.l=!1}function ff(a,b){return a===b?!0:hd(a,b)?!0:u?Wb.a(a,b):null}
var gf=function(){function a(a,b,c,h,k){a=va(a);a[b]=c;a[h]=k;return a}function b(a,b,c){a=va(a);a[b]=c;return a}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function hf(a,b){var c=Array(a.length-2);Kc(a,0,c,0,2*b);Kc(a,2*(b+1),c,2*b,c.length-2*b);return c}
var jf=function(){function a(a,b,c,h,k,l){a=a.La(b);a.e[c]=h;a.e[k]=l;return a}function b(a,b,c,h){a=a.La(b);a.e[c]=h;return a}var c=null,c=function(c,e,f,h,k,l){switch(arguments.length){case 4:return b.call(this,c,e,f,h);case 6:return a.call(this,c,e,f,h,k,l)}throw Error("Invalid arity: "+arguments.length);};c.n=b;c.X=a;return c}();
function kf(a,b,c){for(var d=a.length,e=0;;)if(e<d){var f=a[e];null!=f?c=b.c?b.c(c,f,a[e+1]):b.call(null,c,f,a[e+1]):(f=a[e+1],c=null!=f?f.Ta(b,c):c);if(fc(c))return K.b?K.b(c):K.call(null,c);e+=2}else return c}function lf(a,b,c){this.t=a;this.A=b;this.e=c}g=lf.prototype;g.La=function(a){if(a===this.t)return this;var b=Zc(this.A),c=Array(0>b?4:2*(b+1));Kc(this.e,0,c,0,2*b);return new lf(a,this.A,c)};
g.gb=function(a,b,c,d,e){var f=1<<(c>>>b&31);if(0===(this.A&f))return this;var h=Zc(this.A&f-1),k=this.e[2*h],l=this.e[2*h+1];return null==k?(b=l.gb(a,b+5,c,d,e),b===l?this:null!=b?jf.n(this,a,2*h+1,b):this.A===f?null:u?mf(this,a,f,h):null):ff(d,k)?(e[0]=!0,mf(this,a,f,h)):u?this:null};function mf(a,b,c,d){if(a.A===c)return null;a=a.La(b);b=a.e;var e=b.length;a.A^=c;Kc(b,2*(d+1),b,2*d,e-2*(d+1));b[e-2]=null;b[e-1]=null;return a}g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};
g.Ta=function(a,b){return kf(this.e,a,b)};g.Ma=function(a,b,c,d){var e=1<<(b>>>a&31);if(0===(this.A&e))return d;var f=Zc(this.A&e-1),e=this.e[2*f],f=this.e[2*f+1];return null==e?f.Ma(a+5,b,c,d):ff(c,e)?f:u?d:null};
g.ia=function(a,b,c,d,e,f){var h=1<<(c>>>b&31),k=Zc(this.A&h-1);if(0===(this.A&h)){var l=Zc(this.A);if(2*l<this.e.length){a=this.La(a);b=a.e;f.l=!0;a:for(c=2*(l-k),f=2*k+(c-1),l=2*(k+1)+(c-1);;){if(0===c)break a;b[l]=b[f];l-=1;c-=1;f-=1}b[2*k]=d;b[2*k+1]=e;a.A|=h;return a}if(16<=l){k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[c>>>b&31]=of.ia(a,b+5,c,d,e,f);for(e=d=0;;)if(32>d)0!==
(this.A>>>d&1)&&(k[d]=null!=this.e[e]?of.ia(a,b+5,Tb(this.e[e]),this.e[e],this.e[e+1],f):this.e[e+1],e+=2),d+=1;else break;return new pf(a,l+1,k)}return u?(b=Array(2*(l+4)),Kc(this.e,0,b,0,2*k),b[2*k]=d,b[2*k+1]=e,Kc(this.e,2*k,b,2*(k+1),2*(l-k)),f.l=!0,a=this.La(a),a.e=b,a.A|=h,a):null}l=this.e[2*k];h=this.e[2*k+1];return null==l?(l=h.ia(a,b+5,c,d,e,f),l===h?this:jf.n(this,a,2*k+1,l)):ff(d,l)?e===h?this:jf.n(this,a,2*k+1,e):u?(f.l=!0,jf.X(this,a,2*k,null,2*k+1,qf.ga?qf.ga(a,b+5,l,h,c,d,e):qf.call(null,
a,b+5,l,h,c,d,e))):null};
g.ha=function(a,b,c,d,e){var f=1<<(b>>>a&31),h=Zc(this.A&f-1);if(0===(this.A&f)){var k=Zc(this.A);if(16<=k){h=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[b>>>a&31]=of.ha(a+5,b,c,d,e);for(d=c=0;;)if(32>c)0!==(this.A>>>c&1)&&(h[c]=null!=this.e[d]?of.ha(a+5,Tb(this.e[d]),this.e[d],this.e[d+1],e):this.e[d+1],d+=2),c+=1;else break;return new pf(null,k+1,h)}a=Array(2*(k+1));Kc(this.e,
0,a,0,2*h);a[2*h]=c;a[2*h+1]=d;Kc(this.e,2*h,a,2*(h+1),2*(k-h));e.l=!0;return new lf(null,this.A|f,a)}k=this.e[2*h];f=this.e[2*h+1];return null==k?(k=f.ha(a+5,b,c,d,e),k===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,k))):ff(c,k)?d===f?this:new lf(null,this.A,gf.c(this.e,2*h+1,d)):u?(e.l=!0,new lf(null,this.A,gf.s(this.e,2*h,null,2*h+1,qf.X?qf.X(a+5,k,f,b,c,d):qf.call(null,a+5,k,f,b,c,d)))):null};
g.fb=function(a,b,c){var d=1<<(b>>>a&31);if(0===(this.A&d))return this;var e=Zc(this.A&d-1),f=this.e[2*e],h=this.e[2*e+1];return null==f?(a=h.fb(a+5,b,c),a===h?this:null!=a?new lf(null,this.A,gf.c(this.e,2*e+1,a)):this.A===d?null:u?new lf(null,this.A^d,hf(this.e,e)):null):ff(c,f)?new lf(null,this.A^d,hf(this.e,e)):u?this:null};var of=new lf(null,0,[]);
function rf(a,b,c){var d=a.e;a=2*(a.g-1);for(var e=Array(a),f=0,h=1,k=0;;)if(f<a)f!==c&&null!=d[f]&&(e[h]=d[f],h+=2,k|=1<<f),f+=1;else return new lf(b,k,e)}function pf(a,b,c){this.t=a;this.g=b;this.e=c}g=pf.prototype;g.La=function(a){return a===this.t?this:new pf(a,this.g,va(this.e))};
g.gb=function(a,b,c,d,e){var f=c>>>b&31,h=this.e[f];if(null==h)return this;b=h.gb(a,b+5,c,d,e);if(b===h)return this;if(null==b){if(8>=this.g)return rf(this,a,f);a=jf.n(this,a,f,b);a.g-=1;return a}return u?jf.n(this,a,f,b):null};g.eb=function(){return sf.b?sf.b(this.e):sf.call(null,this.e)};g.Ta=function(a,b){for(var c=this.e.length,d=0,e=b;;)if(d<c){var f=this.e[d];if(null!=f&&(e=f.Ta(a,e),fc(e)))return K.b?K.b(e):K.call(null,e);d+=1}else return e};
g.Ma=function(a,b,c,d){var e=this.e[b>>>a&31];return null!=e?e.Ma(a+5,b,c,d):d};g.ia=function(a,b,c,d,e,f){var h=c>>>b&31,k=this.e[h];if(null==k)return a=jf.n(this,a,h,of.ia(a,b+5,c,d,e,f)),a.g+=1,a;b=k.ia(a,b+5,c,d,e,f);return b===k?this:jf.n(this,a,h,b)};g.ha=function(a,b,c,d,e){var f=b>>>a&31,h=this.e[f];if(null==h)return new pf(null,this.g+1,gf.c(this.e,f,of.ha(a+5,b,c,d,e)));a=h.ha(a+5,b,c,d,e);return a===h?this:new pf(null,this.g,gf.c(this.e,f,a))};
g.fb=function(a,b,c){var d=b>>>a&31,e=this.e[d];return null!=e?(a=e.fb(a+5,b,c),a===e?this:null==a?8>=this.g?rf(this,null,d):new pf(null,this.g-1,gf.c(this.e,d,a)):u?new pf(null,this.g,gf.c(this.e,d,a)):null):this};function tf(a,b,c){b*=2;for(var d=0;;)if(d<b){if(ff(c,a[d]))return d;d+=2}else return-1}function uf(a,b,c,d){this.t=a;this.ra=b;this.g=c;this.e=d}g=uf.prototype;
g.La=function(a){if(a===this.t)return this;var b=Array(2*(this.g+1));Kc(this.e,0,b,0,2*this.g);return new uf(a,this.ra,this.g,b)};g.gb=function(a,b,c,d,e){b=tf(this.e,this.g,d);if(-1===b)return this;e[0]=!0;if(1===this.g)return null;a=this.La(a);e=a.e;e[b]=e[2*this.g-2];e[b+1]=e[2*this.g-1];e[2*this.g-1]=null;e[2*this.g-2]=null;a.g-=1;return a};g.eb=function(){return nf.b?nf.b(this.e):nf.call(null,this.e)};g.Ta=function(a,b){return kf(this.e,a,b)};
g.Ma=function(a,b,c,d){a=tf(this.e,this.g,c);return 0>a?d:ff(c,this.e[a])?this.e[a+1]:u?d:null};
g.ia=function(a,b,c,d,e,f){if(c===this.ra){b=tf(this.e,this.g,d);if(-1===b){if(this.e.length>2*this.g)return a=jf.X(this,a,2*this.g,d,2*this.g+1,e),f.l=!0,a.g+=1,a;c=this.e.length;b=Array(c+2);Kc(this.e,0,b,0,c);b[c]=d;b[c+1]=e;f.l=!0;f=this.g+1;a===this.t?(this.e=b,this.g=f,a=this):a=new uf(this.t,this.ra,f,b);return a}return this.e[b+1]===e?this:jf.n(this,a,b+1,e)}return(new lf(a,1<<(this.ra>>>b&31),[null,this,null,null])).ia(a,b,c,d,e,f)};
g.ha=function(a,b,c,d,e){return b===this.ra?(a=tf(this.e,this.g,c),-1===a?(a=2*this.g,b=Array(a+2),Kc(this.e,0,b,0,a),b[a]=c,b[a+1]=d,e.l=!0,new uf(null,this.ra,this.g+1,b)):Wb.a(this.e[a],d)?this:new uf(null,this.ra,this.g,gf.c(this.e,a+1,d))):(new lf(null,1<<(this.ra>>>a&31),[null,this])).ha(a,b,c,d,e)};g.fb=function(a,b,c){a=tf(this.e,this.g,c);return-1===a?this:1===this.g?null:u?new uf(null,this.ra,this.g-1,hf(this.e,Yc(a))):null};
var qf=function(){function a(a,b,c,h,k,l,n){var q=Tb(c);if(q===k)return new uf(null,q,2,[c,h,l,n]);var t=new ef;return of.ia(a,b,q,c,h,t).ia(a,b,k,l,n,t)}function b(a,b,c,h,k,l){var n=Tb(b);if(n===h)return new uf(null,n,2,[b,c,k,l]);var q=new ef;return of.ha(a,n,b,c,q).ha(a,h,k,l,q)}var c=null,c=function(c,e,f,h,k,l,n){switch(arguments.length){case 6:return b.call(this,c,e,f,h,k,l);case 7:return a.call(this,c,e,f,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};c.X=b;c.ga=a;return c}();
function vf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=vf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return null==this.r?new W(null,2,5,X,[this.ka[this.p],this.ka[this.p+1]],null):F(this.r)};
g.S=function(){return null==this.r?nf.c?nf.c(this.ka,this.p+2,null):nf.call(null,this.ka,this.p+2,null):nf.c?nf.c(this.ka,this.p,I(this.r)):nf.call(null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new vf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var nf=function(){function a(a,b,c){if(null==c)for(c=a.length;;)if(b<c){if(null!=a[b])return new vf(null,a,b,null,null);var h=a[b+1];if(r(h)&&(h=h.eb(),r(h)))return new vf(null,a,b+2,h,null);b+=2}else return null;else return new vf(null,a,b,c,null)}function b(a){return c.c(a,0,null)}var c=null,c=function(c,e,f){switch(arguments.length){case 1:return b.call(this,c);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.c=a;return c}();
function wf(a,b,c,d,e){this.j=a;this.ka=b;this.p=c;this.r=d;this.m=e;this.q=0;this.i=32374860}g=wf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return F(this.r)};
g.S=function(){return sf.n?sf.n(null,this.ka,this.p,I(this.r)):sf.call(null,null,this.ka,this.p,I(this.r))};g.H=function(){return this};g.F=function(a,b){return new wf(b,this.ka,this.p,this.r,this.m)};g.G=function(a,b){return M(b,this)};
var sf=function(){function a(a,b,c,h){if(null==h)for(h=b.length;;)if(c<h){var k=b[c];if(r(k)&&(k=k.eb(),r(k)))return new wf(a,b,c+1,k,null);c+=1}else return null;else return new wf(a,b,c,h,null)}function b(a){return c.n(null,a,0,null)}var c=null,c=function(c,e,f,h){switch(arguments.length){case 1:return b.call(this,c);case 4:return a.call(this,c,e,f,h)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.n=a;return c}();
function xf(a,b,c,d,e,f){this.j=a;this.g=b;this.root=c;this.T=d;this.Y=e;this.m=f;this.i=16123663;this.q=8196}g=xf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:u?this.root.Ma(0,Tb(b),b,c):null};
g.Za=function(a,b,c){a=this.T?b.c?b.c(c,null,this.Y):b.call(null,c,null,this.Y):c;return fc(a)?K.b?K.b(a):K.call(null,a):null!=this.root?this.root.Ta(b,a):u?a:null};g.D=function(){return this.j};g.L=function(){return this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.Wa=function(){return new yf({},this.root,this.g,this.T,this.Y)};g.I=function(){return eb($e,this.j)};
g.nb=function(a,b){if(null==b)return this.T?new xf(this.j,this.g-1,this.root,!1,null,null):this;if(null==this.root)return this;if(u){var c=this.root.fb(0,Tb(b),b);return c===this.root?this:new xf(this.j,this.g-1,c,this.T,this.Y,null)}return null};
g.ua=function(a,b,c){if(null==b)return this.T&&c===this.Y?this:new xf(this.j,this.T?this.g:this.g+1,this.root,!0,c,null);a=new ef;b=(null==this.root?of:this.root).ha(0,Tb(b),b,c,a);return b===this.root?this:new xf(this.j,a.l?this.g+1:this.g,b,this.T,this.Y,null)};g.kb=function(a,b){return null==b?this.T:null==this.root?!1:u?this.root.Ma(0,Tb(b),b,Lc)!==Lc:null};g.H=function(){if(0<this.g){var a=null!=this.root?this.root.eb():null;return this.T?M(new W(null,2,5,X,[null,this.Y],null),a):a}return null};
g.F=function(a,b){return new xf(b,this.g,this.root,this.T,this.Y,this.m)};g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var $e=new xf(null,0,null,!1,null,0);function sc(a,b){for(var c=a.length,d=0,e=yb($e);;)if(d<c)var f=d+1,e=e.cb(null,a[d],b[d]),d=f;else return Ab(e)}
function yf(a,b,c,d,e){this.t=a;this.root=b;this.count=c;this.T=d;this.Y=e;this.q=56;this.i=258}g=yf.prototype;g.Ab=function(a,b){if(this.t)if(null==b)this.T&&(this.T=!1,this.Y=null,this.count-=1);else{if(null!=this.root){var c=new ef,d=this.root.gb(this.t,0,Tb(b),b,c);d!==this.root&&(this.root=d);r(c[0])&&(this.count-=1)}}else throw Error("dissoc! after persistent!");return this};g.cb=function(a,b,c){return zf(this,b,c)};
g.Ka=function(a,b){var c;a:{if(this.t){if(b?b.i&2048||b.dc||(b.i?0:s(Sa,b)):s(Sa,b)){c=zf(this,cf.b?cf.b(b):cf.call(null,b),df.b?df.b(b):df.call(null,b));break a}c=E(b);for(var d=this;;){var e=F(c);if(r(e))c=I(c),d=zf(d,cf.b?cf.b(e):cf.call(null,e),df.b?df.b(e):df.call(null,e));else{c=d;break a}}}else throw Error("conj! after persistent");c=void 0}return c};
g.Oa=function(){var a;if(this.t)this.t=null,a=new xf(null,this.count,this.root,this.T,this.Y,null);else throw Error("persistent! called twice");return a};g.u=function(a,b){return null==b?this.T?this.Y:null:null==this.root?null:this.root.Ma(0,Tb(b),b)};g.C=function(a,b,c){return null==b?this.T?this.Y:c:null==this.root?c:this.root.Ma(0,Tb(b),b,c)};g.L=function(){if(this.t)return this.count;throw Error("count after persistent!");};
function zf(a,b,c){if(a.t){if(null==b)a.Y!==c&&(a.Y=c),a.T||(a.count+=1,a.T=!0);else{var d=new ef;b=(null==a.root?of:a.root).ia(a.t,0,Tb(b),b,c,d);b!==a.root&&(a.root=b);d.l&&(a.count+=1)}return a}throw Error("assoc! after persistent!");}function Af(a,b,c){for(var d=b;;)if(null!=a)b=c?a.left:a.right,d=pc.a(d,a),a=b;else return d}function Bf(a,b,c,d,e){this.j=a;this.stack=b;this.ib=c;this.g=d;this.m=e;this.q=0;this.i=32374862}g=Bf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.j};
g.L=function(){return 0>this.g?O(I(this))+1:this.g};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return yc(this.stack)};g.S=function(){var a=F(this.stack),a=Af(this.ib?a.right:a.left,I(this.stack),this.ib);return null!=a?new Bf(null,a,this.ib,this.g-1,null):H};g.H=function(){return this};
g.F=function(a,b){return new Bf(b,this.stack,this.ib,this.g,this.m)};g.G=function(a,b){return M(b,this)};function Cf(a,b,c){return new Bf(null,Af(a,null,b),b,c,null)}function Df(a,b,c,d){return c instanceof Y?c.left instanceof Y?new Y(c.key,c.l,c.left.qa(),new $(a,b,c.right,d,null),null):c.right instanceof Y?new Y(c.right.key,c.right.l,new $(c.key,c.l,c.left,c.right.left,null),new $(a,b,c.right.right,d,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ef(a,b,c,d){return d instanceof Y?d.right instanceof Y?new Y(d.key,d.l,new $(a,b,c,d.left,null),d.right.qa(),null):d.left instanceof Y?new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),new $(d.key,d.l,d.left.right,d.right,null),null):u?new $(a,b,c,d,null):null:new $(a,b,c,d,null)}
function Ff(a,b,c,d){if(c instanceof Y)return new Y(a,b,c.qa(),d,null);if(d instanceof $)return Ef(a,b,c,d.hb());if(d instanceof Y&&d.left instanceof $)return new Y(d.left.key,d.left.l,new $(a,b,c,d.left.left,null),Ef(d.key,d.l,d.left.right,d.right.hb()),null);if(u)throw Error("red-black tree invariant violation");return null}
var Hf=function Gf(b,c,d){d=null!=b.left?Gf(b.left,c,d):d;if(fc(d))return K.b?K.b(d):K.call(null,d);d=c.c?c.c(d,b.key,b.l):c.call(null,d,b.key,b.l);if(fc(d))return K.b?K.b(d):K.call(null,d);b=null!=b.right?Gf(b.right,c,d):d;return fc(b)?K.b?K.b(b):K.call(null,b):b};function $(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=$.prototype;g.Hb=function(a){return a.Jb(this)};g.hb=function(){return new Y(this.key,this.l,this.left,this.right,null)};g.qa=function(){return this};
g.Gb=function(a){return a.Ib(this)};g.replace=function(a,b,c,d){return new $(a,b,c,d,null)};g.Ib=function(a){return new $(a.key,a.l,this,a.right,null)};g.Jb=function(a){return new $(a.key,a.l,a.left,this,null)};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};
g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};
g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();
g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};function Y(a,b,c,d,e){this.key=a;this.l=b;this.left=c;this.right=d;this.m=e;this.q=0;this.i=32402207}g=Y.prototype;g.Hb=function(a){return new Y(this.key,this.l,this.left,a,null)};g.hb=function(){throw Error("red-black tree invariant violation");};g.qa=function(){return new $(this.key,this.l,this.left,this.right,null)};
g.Gb=function(a){return new Y(this.key,this.l,a,this.right,null)};g.replace=function(a,b,c,d){return new Y(a,b,c,d,null)};g.Ib=function(a){return this.left instanceof Y?new Y(this.key,this.l,this.left.qa(),new $(a.key,a.l,this.right,a.right,null),null):this.right instanceof Y?new Y(this.right.key,this.right.l,new $(this.key,this.l,this.left,this.right.left,null),new $(a.key,a.l,this.right.right,a.right,null),null):u?new $(a.key,a.l,this,a.right,null):null};
g.Jb=function(a){return this.right instanceof Y?new Y(this.key,this.l,new $(a.key,a.l,a.left,this.left,null),this.right.qa(),null):this.left instanceof Y?new Y(this.left.key,this.left.l,new $(a.key,a.l,a.left,this.left.left,null),new $(this.key,this.l,this.left.right,this.right,null),null):u?new $(a.key,a.l,a.left,this,null):null};g.Ta=function(a,b){return Hf(this,a,b)};g.u=function(a,b){return D.c(this,b,null)};g.C=function(a,b,c){return D.c(this,b,c)};
g.J=function(a,b){return 0===b?this.key:1===b?this.l:null};g.aa=function(a,b,c){return 0===b?this.key:1===b?this.l:u?c:null};g.Pa=function(a,b,c){return(new W(null,2,5,X,[this.key,this.l],null)).Pa(null,b,c)};g.D=function(){return null};g.L=function(){return 2};g.$a=function(){return this.key};g.ab=function(){return this.l};g.Ia=function(){return this.l};g.Ja=function(){return new W(null,1,5,X,[this.key],null)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return qe};g.N=function(a,b){return gc.a(this,b)};g.M=function(a,b,c){return gc.c(this,b,c)};g.ua=function(a,b,c){return R.c(new W(null,2,5,X,[this.key,this.l],null),b,c)};g.H=function(){return Da(Da(H,this.l),this.key)};g.F=function(a,b){return N(new W(null,2,5,X,[this.key,this.l],null),b)};g.G=function(a,b){return new W(null,3,5,X,[this.key,this.l,b],null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};
var Jf=function If(b,c,d,e,f){if(null==c)return new Y(d,e,null,null,null);var h=b.a?b.a(d,c.key):b.call(null,d,c.key);return 0===h?(f[0]=c,null):0>h?(b=If(b,c.left,d,e,f),null!=b?c.Gb(b):null):u?(b=If(b,c.right,d,e,f),null!=b?c.Hb(b):null):null},Lf=function Kf(b,c){if(null==b)return c;if(null==c)return b;if(b instanceof Y){if(c instanceof Y){var d=Kf(b.right,c.left);return d instanceof Y?new Y(d.key,d.l,new Y(b.key,b.l,b.left,d.left,null),new Y(c.key,c.l,d.right,c.right,null),null):new Y(b.key,b.l,
b.left,new Y(c.key,c.l,d,c.right,null),null)}return new Y(b.key,b.l,b.left,Kf(b.right,c),null)}return c instanceof Y?new Y(c.key,c.l,Kf(b,c.left),c.right,null):u?(d=Kf(b.right,c.left),d instanceof Y?new Y(d.key,d.l,new $(b.key,b.l,b.left,d.left,null),new $(c.key,c.l,d.right,c.right,null),null):Ff(b.key,b.l,b.left,new $(c.key,c.l,d,c.right,null))):null},Nf=function Mf(b,c,d,e){if(null!=c){var f=b.a?b.a(d,c.key):b.call(null,d,c.key);if(0===f)return e[0]=c,Lf(c.left,c.right);if(0>f)return b=Mf(b,c.left,
d,e),null!=b||null!=e[0]?c.left instanceof $?Ff(c.key,c.l,b,c.right):new Y(c.key,c.l,b,c.right,null):null;if(u){b=Mf(b,c.right,d,e);if(null!=b||null!=e[0])if(c.right instanceof $)if(e=c.key,d=c.l,c=c.left,b instanceof Y)c=new Y(e,d,c,b.qa(),null);else if(c instanceof $)c=Df(e,d,c.hb(),b);else if(c instanceof Y&&c.right instanceof $)c=new Y(c.right.key,c.right.l,Df(c.key,c.l,c.left.hb(),c.right.left),new $(e,d,c.right.right,b,null),null);else{if(u)throw Error("red-black tree invariant violation");
c=null}else c=new Y(c.key,c.l,c.left,b,null);else c=null;return c}}return null},Pf=function Of(b,c,d,e){var f=c.key,h=b.a?b.a(d,f):b.call(null,d,f);return 0===h?c.replace(f,e,c.left,c.right):0>h?c.replace(f,c.l,Of(b,c.left,d,e),c.right):u?c.replace(f,c.l,c.left,Of(b,c.right,d,e)):null};function Qf(a,b,c,d,e){this.Z=a;this.ma=b;this.g=c;this.j=d;this.m=e;this.i=418776847;this.q=8192}g=Qf.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(Ve.b?Ve.b(this):Ve.call(null,this))};
g.entries=function(){return Qe(E(this))};g.values=function(){return Oe(We.b?We.b(this):We.call(null,this))};g.has=function(a){return Oc(this,a)};g.get=function(a){return this.u(null,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};
function Rf(a,b){for(var c=a.ma;;)if(null!=c){var d=a.Z.a?a.Z.a(b,c.key):a.Z.call(null,b,c.key);if(0===d)return c;if(0>d)c=c.left;else if(u)c=c.right;else return null}else return null}g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this,b);return null!=a?a.l:c};g.Za=function(a,b,c){return null!=this.ma?Hf(this.ma,b,c):c};g.D=function(){return this.j};g.L=function(){return this.g};g.Xa=function(){return 0<this.g?Cf(this.ma,!1,this.g):null};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Me(this,b)};g.I=function(){return N(Sf,this.j)};g.nb=function(a,b){var c=[null],d=Nf(this.Z,this.ma,b,c);return null==d?null==P.a(c,0)?this:new Qf(this.Z,null,0,this.j,null):new Qf(this.Z,d.qa(),this.g-1,this.j,null)};
g.ua=function(a,b,c){a=[null];var d=Jf(this.Z,this.ma,b,c,a);return null==d?(a=P.a(a,0),Wb.a(c,a.l)?this:new Qf(this.Z,Pf(this.Z,this.ma,b,c),this.g,this.j,null)):new Qf(this.Z,d.qa(),this.g+1,this.j,null)};g.kb=function(a,b){return null!=Rf(this,b)};g.H=function(){return 0<this.g?Cf(this.ma,!0,this.g):null};g.F=function(a,b){return new Qf(this.Z,this.ma,this.g,b,this.m)};
g.G=function(a,b){if(Hc(b))return Oa(this,D.a(b,0),D.a(b,1));for(var c=this,d=E(b);;){if(null==d)return c;var e=F(d);if(Hc(e))c=Oa(c,D.a(e,0),D.a(e,1)),d=I(d);else throw Error("conj on a map takes map entries or seqables of map entries");}};g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};
g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return 0<this.g?Cf(this.ma,b,this.g):null};g.zb=function(a,b,c){if(0<this.g){a=null;for(var d=this.ma;;)if(null!=d){var e=this.Z.a?this.Z.a(b,d.key):this.Z.call(null,b,d.key);if(0===e)return new Bf(null,pc.a(a,d),c,-1,null);if(r(c))0>e?(a=pc.a(a,d),d=d.left):d=d.right;else if(u)0<e?(a=pc.a(a,d),d=d.right):d=d.left;else return null}else return null==a?null:new Bf(null,a,c,-1,null)}else return null};
g.xb=function(a,b){return cf.b?cf.b(b):cf.call(null,b)};g.wb=function(){return this.Z};
var Sf=new Qf(Xb,null,0,null,0),Tf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=yb($e);;)if(a){var e=I(I(a)),b=xd.c(b,F(a),F(I(a)));a=e}else return Ab(b)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Uf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return new la(null,Yc(O(a)),S.a(wa,
a),null)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Vf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){a=E(a);for(var b=Sf;;)if(a){var e=I(I(a)),b=R.c(b,F(a),F(I(a)));a=e}else return b}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),Wf=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,
b){for(var e=E(b),f=new Qf(Qc(a),null,0,null,0);;)if(e)var h=I(I(e)),f=R.c(f,F(e),F(I(e))),e=h;else return f}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();function Xf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Xf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Xf(a,this.W)};g.B=function(){return cc(this)};
g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).$a(null)};g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Xf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Xf(this.V,b)};g.G=function(a,b){return M(b,this)};function Ve(a){return(a=E(a))?new Xf(a,null):null}
function cf(a){return Ta(a)}function Yf(a,b){this.V=a;this.W=b;this.q=0;this.i=32374988}g=Yf.prototype;g.toString=function(){return Lb(this)};g.D=function(){return this.W};g.U=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null==a?null:new Yf(a,this.W)};g.B=function(){return cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.W)};g.N=function(a,b){return nc.a(b,this)};g.M=function(a,b,c){return nc.c(b,c,this)};g.Q=function(){return this.V.Q(null).ab(null)};
g.S=function(){var a=this.V,a=(a?a.i&128||a.ob||(a.i?0:s(Ja,a)):s(Ja,a))?this.V.U(null):I(this.V);return null!=a?new Yf(a,this.W):H};g.H=function(){return this};g.F=function(a,b){return new Yf(this.V,b)};g.G=function(a,b){return M(b,this)};function We(a){return(a=E(a))?new Yf(a,null):null}function df(a){return Ua(a)}
var Zf=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return r(Ed(Fd,a))?C.a(function(a,b){return pc.a(r(a)?a:Ye,b)},a):null}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function $f(a,b,c){this.j=a;this.Sa=b;this.m=c;this.i=15077647;this.q=8196}g=$f.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};
g.has=function(a){return Oc(this,a)};g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return Na(this.Sa,b)?b:c};g.D=function(){return this.j};g.L=function(){return Aa(this.Sa)};
g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.Wa=function(){return new ag(yb(this.Sa))};g.I=function(){return N(bg,this.j)};g.vb=function(a,b){return new $f(this.j,Qa(this.Sa,b),null)};g.H=function(){return Ve(this.Sa)};g.F=function(a,b){return new $f(b,this.Sa,this.m)};g.G=function(a,b){return new $f(this.j,R.c(this.Sa,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};var bg=new $f(null,Ye,0);function ag(a){this.la=a;this.i=259;this.q=136}g=ag.prototype;
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return La.c(this.la,c,Lc)===Lc?null:c;case 3:return La.c(this.la,c,Lc)===Lc?d:c}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return La.c(this.la,a,Lc)===Lc?null:a};g.a=function(a,b){return La.c(this.la,a,Lc)===Lc?b:a};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){return La.c(this.la,b,Lc)===Lc?c:b};
g.L=function(){return O(this.la)};g.Ob=function(a,b){this.la=yd.a(this.la,b);return this};g.Ka=function(a,b){this.la=xd.c(this.la,b,null);return this};g.Oa=function(){return new $f(null,Ab(this.la),null)};function cg(a,b,c){this.j=a;this.na=b;this.m=c;this.i=417730831;this.q=8192}g=cg.prototype;g.toString=function(){return Lb(this)};g.keys=function(){return Oe(E(this))};g.entries=function(){return Se(E(this))};g.values=function(){return Oe(E(this))};g.has=function(a){return Oc(this,a)};
g.forEach=function(a){for(var b=E(this),c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e),h=P.c(f,0,null),f=P.c(f,1,null);a.a?a.a(f,h):a.call(null,f,h);e+=1}else if(b=E(b))Ic(b)?(c=Hb(b),b=Ib(b),h=c,d=O(c),c=h):(c=F(b),h=P.c(c,0,null),f=P.c(c,1,null),a.a?a.a(f,h):a.call(null,f,h),b=I(b),c=null,d=0),e=0;else return null};g.u=function(a,b){return La.c(this,b,null)};g.C=function(a,b,c){a=Rf(this.na,b);return null!=a?a.key:c};g.D=function(){return this.j};g.L=function(){return O(this.na)};
g.Xa=function(){return 0<O(this.na)?Kd.a(cf,pb(this.na)):null};g.B=function(){var a=this.m;return null!=a?a:this.m=a=dc(this)};g.v=function(a,b){return Dc(b)&&O(this)===O(b)&&Dd(function(a){return function(b){return Oc(a,b)}}(this),b)};g.I=function(){return N(dg,this.j)};g.vb=function(a,b){return new cg(this.j,tc.a(this.na,b),null)};g.H=function(){return Ve(this.na)};g.F=function(a,b){return new cg(b,this.na,this.m)};g.G=function(a,b){return new cg(this.j,R.c(this.na,b,null),null)};
g.call=function(){var a=null;return a=function(a,c,d){switch(arguments.length){case 2:return this.u(null,c);case 3:return this.C(null,c,d)}throw Error("Invalid arity: "+arguments.length);}}();g.apply=function(a,b){return this.call.apply(this,[this].concat(va(b)))};g.b=function(a){return this.u(null,a)};g.a=function(a,b){return this.C(null,a,b)};g.yb=function(a,b){return Kd.a(cf,qb(this.na,b))};g.zb=function(a,b,c){return Kd.a(cf,rb(this.na,b,c))};g.xb=function(a,b){return b};g.wb=function(){return tb(this.na)};
var dg=new cg(null,Sf,0);function eg(a){a=E(a);if(null==a)return bg;if(a instanceof ac&&0===a.p){a=a.e;a:{for(var b=0,c=yb(bg);;)if(b<a.length)var d=b+1,c=c.Ka(null,a[b]),b=d;else{a=c;break a}a=void 0}return a.Oa(null)}if(u)for(d=yb(bg);;)if(null!=a)b=a.U(null),d=d.Ka(null,a.Q(null)),a=b;else return d.Oa(null);else return null}
var fg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.c(Da,dg,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}(),gg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return C.c(Da,new cg(null,Wf(a),0),b)}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}();
function hg(a){for(var b=qe;;)if(I(a))b=pc.a(b,F(a)),a=I(a);else return E(b)}function id(a){if(a&&(a.q&4096||a.fc))return a.name;if("string"===typeof a)return a;throw Error("Doesn't support name: "+A.b(a));}
var ig=function(){function a(a,b,c){return(a.b?a.b(b):a.call(null,b))>(a.b?a.b(c):a.call(null,c))?b:c}var b=null,c=function(){function a(b,d,k,l){var n=null;3<arguments.length&&(n=J(Array.prototype.slice.call(arguments,3),0));return c.call(this,b,d,k,n)}function c(a,d,e,l){return C.c(function(c,d){return b.c(a,c,d)},b.c(a,d,e),l)}a.k=3;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=I(a);var l=F(a);a=G(a);return c(b,d,l,a)};a.d=c;return a}(),b=function(b,e,f,h){switch(arguments.length){case 2:return e;
case 3:return a.call(this,b,e,f);default:return c.d(b,e,f,J(arguments,3))}throw Error("Invalid arity: "+arguments.length);};b.k=3;b.f=c.f;b.a=function(a,b){return b};b.c=a;b.d=c.d;return b}(),jg=function(){function a(a,b,f){return new V(null,function(){var h=E(f);return h?M(Md(a,h),c.c(a,b,Nd(b,h))):null},null,null)}function b(a,b){return c.c(a,a,b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);
};c.a=b;c.c=a;return c}(),lg=function kg(b,c){return new V(null,function(){var d=E(c);return d?r(b.b?b.b(F(d)):b.call(null,F(d)))?M(F(d),kg(b,G(d))):null:null},null,null)};function mg(a,b,c){return function(d){var e=tb(a);return b.a?b.a(e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0):b.call(null,e.a?e.a(sb(a,d),c):e.call(null,sb(a,d),c),0)}}
var ng=function(){function a(a,b,c,h,k){var l=rb(a,c,!0);if(r(l)){var n=P.c(l,0,null);return lg(mg(a,h,k),r(mg(a,b,c).call(null,n))?l:I(l))}return null}function b(a,b,c){var h=mg(a,b,c),k;a:{k=[Uc,Vc];var l=k.length;if(l<=Ze)for(var n=0,q=yb(Ye);;)if(n<l)var t=n+1,q=Bb(q,k[n],null),n=t;else{k=new $f(null,Ab(q),null);break a}else for(n=0,q=yb(bg);;)if(n<l)t=n+1,q=zb(q,k[n]),n=t;else{k=Ab(q);break a}k=void 0}return r(k.call(null,b))?(a=rb(a,c,!0),r(a)?(b=P.c(a,0,null),r(h.b?h.b(b):h.call(null,b))?a:
I(a)):null):lg(h,qb(a,!0))}var c=null,c=function(c,e,f,h,k){switch(arguments.length){case 3:return b.call(this,c,e,f);case 5:return a.call(this,c,e,f,h,k)}throw Error("Invalid arity: "+arguments.length);};c.c=b;c.s=a;return c}();function og(a,b,c,d,e){this.j=a;this.start=b;this.end=c;this.step=d;this.m=e;this.i=32375006;this.q=8192}g=og.prototype;g.toString=function(){return Lb(this)};
g.J=function(a,b){if(b<Aa(this))return this.start+b*this.step;if(this.start>this.end&&0===this.step)return this.start;throw Error("Index out of bounds");};g.aa=function(a,b,c){return b<Aa(this)?this.start+b*this.step:this.start>this.end&&0===this.step?this.start:c};g.D=function(){return this.j};
g.U=function(){return 0<this.step?this.start+this.step<this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null:this.start+this.step>this.end?new og(this.j,this.start+this.step,this.end,this.step,null):null};g.L=function(){return sa(lb(this))?0:Math.ceil((this.end-this.start)/this.step)};g.B=function(){var a=this.m;return null!=a?a:this.m=a=cc(this)};g.v=function(a,b){return lc(this,b)};g.I=function(){return N(H,this.j)};g.N=function(a,b){return gc.a(this,b)};
g.M=function(a,b,c){return gc.c(this,b,c)};g.Q=function(){return null==lb(this)?null:this.start};g.S=function(){return null!=lb(this)?new og(this.j,this.start+this.step,this.end,this.step,null):H};g.H=function(){return 0<this.step?this.start<this.end?this:null:this.start>this.end?this:null};g.F=function(a,b){return new og(b,this.start,this.end,this.step,this.m)};g.G=function(a,b){return M(b,this)};
var pg=function(){function a(a,b,c){return new og(null,a,b,c,null)}function b(a,b){return e.c(a,b,1)}function c(a){return e.c(0,a,1)}function d(){return e.c(0,Number.MAX_VALUE,1)}var e=null,e=function(e,h,k){switch(arguments.length){case 0:return d.call(this);case 1:return c.call(this,e);case 2:return b.call(this,e,h);case 3:return a.call(this,e,h,k)}throw Error("Invalid arity: "+arguments.length);};e.o=d;e.b=c;e.a=b;e.c=a;return e}(),qg=function(){function a(a,b){for(;;)if(E(b)&&0<a){var c=a-1,h=
I(b);a=c;b=h}else return null}function b(a){for(;;)if(E(a))a=I(a);else return null}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),rg=function(){function a(a,b){qg.a(a,b);return b}function b(a){qg.b(a);return a}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}();function sg(a,b){if("string"===typeof b){var c=a.exec(b);return Wb.a(F(c),b)?1===O(c)?F(c):we(c):null}throw new TypeError("re-matches must match against a string.");}function tg(a){var b;b=/^(?:\(\?([idmsux]*)\))?(.*)/;if("string"===typeof a)a=b.exec(a),b=null==a?null:1===O(a)?F(a):we(a);else throw new TypeError("re-find must match against a string.");P.c(b,0,null);a=P.c(b,1,null);b=P.c(b,2,null);return new RegExp(b,a)}
function ug(a,b,c,d,e,f,h){var k=ja;try{ja=null==ja?null:ja-1;if(null!=ja&&0>ja)return ub(a,"#");ub(a,c);E(h)&&(b.c?b.c(F(h),a,f):b.call(null,F(h),a,f));for(var l=I(h),n=ra.b(f)-1;;)if(!l||null!=n&&0===n){E(l)&&0===n&&(ub(a,d),ub(a,"..."));break}else{ub(a,d);b.c?b.c(F(l),a,f):b.call(null,F(l),a,f);var q=I(l);c=n-1;l=q;n=c}return ub(a,e)}finally{ja=k}}
var vg=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){for(var e=E(b),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(a,l);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(a,l),e=I(f),f=null,h=0),k=0;else return null}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}(),wg={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};
function xg(a){return'"'+A.b(a.replace(RegExp('[\\\\"\b\f\n\r\t]',"g"),function(a){return wg[a]}))+'"'}
var Ag=function yg(b,c,d){if(null==b)return ub(c,"nil");if(void 0===b)return ub(c,"#\x3cundefined\x3e");if(u){r(function(){var c=Q.a(d,pa);return r(c)?(c=b?b.i&131072||b.ec?!0:b.i?!1:s(bb,b):s(bb,b))?xc(b):c:c}())&&(ub(c,"^"),yg(xc(b),c,d),ub(c," "));if(null==b)return ub(c,"nil");if(b.Db)return b.Tb(b,c,d);if(b&&(b.i&2147483648||b.K))return b.w(null,c,d);if(ta(b)===Boolean||"number"===typeof b)return ub(c,""+A.b(b));if(null!=b&&b.constructor===Object)return ub(c,"#js "),zg.n?zg.n(Kd.a(function(c){return new W(null,
2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d):zg.call(null,Kd.a(function(c){return new W(null,2,5,X,[jd.b(c),b[c]],null)},Jc(b)),yg,c,d);if(b instanceof Array)return ug(c,yg,"#js ["," ","]",d,b);if("string"==typeof b)return r(oa.b(d))?ub(c,xg(b)):ub(c,b);if(uc(b))return vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0));if(b instanceof Date){var e=function(b,c){for(var d=""+A.b(b);;)if(O(d)<c)d="0"+A.b(d);else return d};return vg.d(c,J(['#inst "',""+A.b(b.getUTCFullYear()),"-",e(b.getUTCMonth()+1,2),"-",e(b.getUTCDate(),
2),"T",e(b.getUTCHours(),2),":",e(b.getUTCMinutes(),2),":",e(b.getUTCSeconds(),2),".",e(b.getUTCMilliseconds(),3),"-",'00:00"'],0))}return b instanceof RegExp?vg.d(c,J(['#"',b.source,'"'],0)):(b?b.i&2147483648||b.K||(b.i?0:s(vb,b)):s(vb,b))?wb(b,c,d):u?vg.d(c,J(["#\x3c",""+A.b(b),"\x3e"],0)):null}return null};
function Bg(a,b){var c=new ea;a:{var d=new Kb(c);Ag(F(a),d,b);for(var e=E(I(a)),f=null,h=0,k=0;;)if(k<h){var l=f.J(null,k);ub(d," ");Ag(l,d,b);k+=1}else if(e=E(e))f=e,Ic(f)?(e=Hb(f),h=Ib(f),f=e,l=O(e),e=h,h=l):(l=F(f),ub(d," "),Ag(l,d,b),e=I(f),f=null,h=0),k=0;else break a}return c}
var Cg=function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){var b=ka();return Bc(a)?"":""+A.b(Bg(a,b))}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}();function zg(a,b,c,d){return ug(c,function(a,c,d){b.c?b.c(Ta(a),c,d):b.call(null,Ta(a),c,d);ub(c," ");return b.c?b.c(Ua(a),c,d):b.call(null,Ua(a),c,d)},"{",", ","}",d,E(a))}ac.prototype.K=!0;
ac.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};V.prototype.K=!0;V.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Bf.prototype.K=!0;Bf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};vf.prototype.K=!0;vf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};$.prototype.K=!0;$.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Ue.prototype.K=!0;Ue.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
cg.prototype.K=!0;cg.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};ye.prototype.K=!0;ye.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};gd.prototype.K=!0;gd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};kc.prototype.K=!0;kc.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};xf.prototype.K=!0;xf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};wf.prototype.K=!0;wf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Ae.prototype.K=!0;Ae.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};Qf.prototype.K=!0;Qf.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};$f.prototype.K=!0;$f.prototype.w=function(a,b,c){return ug(b,Ag,"#{"," ","}",c,this)};od.prototype.K=!0;od.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Yf.prototype.K=!0;Yf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};Y.prototype.K=!0;Y.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};
W.prototype.K=!0;W.prototype.w=function(a,b,c){return ug(b,Ag,"["," ","]",c,this)};He.prototype.K=!0;He.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};cd.prototype.K=!0;cd.prototype.w=function(a,b){return ub(b,"()")};Ie.prototype.K=!0;Ie.prototype.w=function(a,b,c){return ug(b,Ag,"#queue ["," ","]",c,E(this))};la.prototype.K=!0;la.prototype.w=function(a,b,c){return zg(this,Ag,b,c)};og.prototype.K=!0;og.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};
Xf.prototype.K=!0;Xf.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};bd.prototype.K=!0;bd.prototype.w=function(a,b,c){return ug(b,Ag,"("," ",")",c,this)};W.prototype.lb=!0;W.prototype.mb=function(a,b){return Pc.a(this,b)};Ae.prototype.lb=!0;Ae.prototype.mb=function(a,b){return Pc.a(this,b)};T.prototype.lb=!0;T.prototype.mb=function(a,b){return Vb(this,b)};Zb.prototype.lb=!0;Zb.prototype.mb=function(a,b){return Vb(this,b)};
function Dg(a,b){if(a?a.gc:a)return a.gc(a,b);var c;c=Dg[m(null==a?null:a)];if(!c&&(c=Dg._,!c))throw x("IReset.-reset!",a);return c.call(null,a,b)}
var Eg=function(){function a(a,b,c,d,e){if(a?a.nc:a)return a.nc(a,b,c,d,e);var q;q=Eg[m(null==a?null:a)];if(!q&&(q=Eg._,!q))throw x("ISwap.-swap!",a);return q.call(null,a,b,c,d,e)}function b(a,b,c,d){if(a?a.mc:a)return a.mc(a,b,c,d);var e;e=Eg[m(null==a?null:a)];if(!e&&(e=Eg._,!e))throw x("ISwap.-swap!",a);return e.call(null,a,b,c,d)}function c(a,b,c){if(a?a.lc:a)return a.lc(a,b,c);var d;d=Eg[m(null==a?null:a)];if(!d&&(d=Eg._,!d))throw x("ISwap.-swap!",a);return d.call(null,a,b,c)}function d(a,b){if(a?
a.kc:a)return a.kc(a,b);var c;c=Eg[m(null==a?null:a)];if(!c&&(c=Eg._,!c))throw x("ISwap.-swap!",a);return c.call(null,a,b)}var e=null,e=function(e,h,k,l,n){switch(arguments.length){case 2:return d.call(this,e,h);case 3:return c.call(this,e,h,k);case 4:return b.call(this,e,h,k,l);case 5:return a.call(this,e,h,k,l,n)}throw Error("Invalid arity: "+arguments.length);};e.a=d;e.c=c;e.n=b;e.s=a;return e}();function Fg(a,b,c,d){this.state=a;this.j=b;this.wc=c;this.Wb=d;this.i=2153938944;this.q=16386}g=Fg.prototype;
g.B=function(){return this[ba]||(this[ba]=++ca)};g.Rb=function(a,b,c){a=E(this.Wb);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);h.n?h.n(k,this,b,c):h.call(null,k,this,b,c);f+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),k=d,e=O(d),d=k):(d=F(a),k=P.c(d,0,null),h=P.c(d,1,null),h.n?h.n(k,this,b,c):h.call(null,k,this,b,c),a=I(a),d=null,e=0),f=0;else return null};g.w=function(a,b,c){ub(b,"#\x3cAtom: ");Ag(this.state,b,c);return ub(b,"\x3e")};g.D=function(){return this.j};
g.ub=function(){return this.state};g.v=function(a,b){return this===b};
var Hg=function(){function a(a){return new Fg(a,null,null,null)}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Gg),d=Q.a(d,pa);return new Fg(a,d,e,null)}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+
arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Ig(a,b){if(a instanceof Fg){var c=a.wc;if(null!=c&&!r(c.b?c.b(b):c.call(null,b)))throw Error("Assert failed: Validator rejected reference state\n"+A.b(Cg.d(J([fd(new Zb(null,"validate","validate",1439230700,null),new Zb(null,"new-value","new-value",-1567397401,null))],0))));c=a.state;a.state=b;null!=a.Wb&&xb(a,c,b);return b}return Dg(a,b)}function K(a){return ab(a)}
var Jg=function(){function a(a,b,c,d){return a instanceof Fg?Ig(a,b.c?b.c(a.state,c,d):b.call(null,a.state,c,d)):Eg.n(a,b,c,d)}function b(a,b,c){return a instanceof Fg?Ig(a,b.a?b.a(a.state,c):b.call(null,a.state,c)):Eg.c(a,b,c)}function c(a,b){return a instanceof Fg?Ig(a,b.b?b.b(a.state):b.call(null,a.state)):Eg.a(a,b)}var d=null,e=function(){function a(c,d,e,f,t){var v=null;4<arguments.length&&(v=J(Array.prototype.slice.call(arguments,4),0));return b.call(this,c,d,e,f,v)}function b(a,c,d,e,f){return a instanceof
Fg?Ig(a,S.s(c,a.state,d,e,f)):Eg.s(a,c,d,e,f)}a.k=4;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=I(a);var e=F(a);a=I(a);var f=F(a);a=G(a);return b(c,d,e,f,a)};a.d=b;return a}(),d=function(d,h,k,l,n){switch(arguments.length){case 2:return c.call(this,d,h);case 3:return b.call(this,d,h,k);case 4:return a.call(this,d,h,k,l);default:return e.d(d,h,k,l,J(arguments,4))}throw Error("Invalid arity: "+arguments.length);};d.k=4;d.f=e.f;d.a=c;d.c=b;d.n=a;d.d=e.d;return d}(),Kg={};
function Lg(a){if(a?a.ac:a)return a.ac(a);var b;b=Lg[m(null==a?null:a)];if(!b&&(b=Lg._,!b))throw x("IEncodeJS.-clj-\x3ejs",a);return b.call(null,a)}function Mg(a){return(a?r(r(null)?null:a.$b)||(a.Cb?0:s(Kg,a)):s(Kg,a))?Lg(a):"string"===typeof a||"number"===typeof a||a instanceof T||a instanceof Zb?Ng.b?Ng.b(a):Ng.call(null,a):Cg.d(J([a],0))}
var Ng=function Og(b){if(null==b)return null;if(b?r(r(null)?null:b.$b)||(b.Cb?0:s(Kg,b)):s(Kg,b))return Lg(b);if(b instanceof T)return id(b);if(b instanceof Zb)return""+A.b(b);if(Gc(b)){var c={};b=E(b);for(var d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f),k=P.c(h,0,null),h=P.c(h,1,null);c[Mg(k)]=Og(h);f+=1}else if(b=E(b))Ic(b)?(e=Hb(b),b=Ib(b),d=e,e=O(e)):(e=F(b),d=P.c(e,0,null),e=P.c(e,1,null),c[Mg(d)]=Og(e),b=I(b),d=null,e=0),f=0;else break;return c}if(Cc(b)){c=[];b=E(Kd.a(Og,b));d=null;for(f=e=0;;)if(f<
e)k=d.J(null,f),c.push(k),f+=1;else if(b=E(b))d=b,Ic(d)?(b=Hb(d),f=Ib(d),d=b,e=O(b),b=f):(b=F(d),c.push(b),b=I(d),d=null,e=0),f=0;else break;return c}return u?b:null},Pg={};function Qg(a,b){if(a?a.Zb:a)return a.Zb(a,b);var c;c=Qg[m(null==a?null:a)];if(!c&&(c=Qg._,!c))throw x("IEncodeClojure.-js-\x3eclj",a);return c.call(null,a,b)}
var Sg=function(){function a(a){return b.d(a,J([new la(null,1,[Rg,!1],null)],0))}var b=null,c=function(){function a(c,d){var k=null;1<arguments.length&&(k=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,c,k)}function b(a,c){if(a?r(r(null)?null:a.Cc)||(a.Cb?0:s(Pg,a)):s(Pg,a))return Qg(a,S.a(Uf,c));if(E(c)){var d=Mc(c)?S.a(Tf,c):c,e=Q.a(d,Rg);return function(a,b,c,d){return function y(e){return Mc(e)?rg.b(Kd.a(y,e)):Cc(e)?Yd(qc(e),Kd.a(y,e)):e instanceof Array?we(Kd.a(y,e)):ta(e)===
Object?Yd(Ye,function(){return function(a,b,c,d){return function Ra(f){return new V(null,function(a,b,c,d){return function(){for(;;){var a=E(f);if(a){if(Ic(a)){var b=Hb(a),c=O(b),h=new ld(Array(c),0);a:{for(var k=0;;)if(k<c){var l=D.a(b,k),l=new W(null,2,5,X,[d.b?d.b(l):d.call(null,l),y(e[l])],null);h.add(l);k+=1}else{b=!0;break a}b=void 0}return b?pd(h.da(),Ra(Ib(a))):pd(h.da(),null)}h=F(a);return M(new W(null,2,5,X,[d.b?d.b(h):d.call(null,h),y(e[h])],null),Ra(G(a)))}return null}}}(a,b,c,d),null,
null)}}(a,b,c,d)(Jc(e))}()):u?e:null}}(c,d,e,r(e)?jd:A)(a)}return null}a.k=1;a.f=function(a){var c=F(a);a=G(a);return b(c,a)};a.d=b;return a}(),b=function(b,e){switch(arguments.length){case 1:return a.call(this,b);default:return c.d(b,J(arguments,1))}throw Error("Invalid arity: "+arguments.length);};b.k=1;b.f=c.f;b.b=a;b.d=c.d;return b}();function Tg(a){this.pb=a;this.q=0;this.i=2153775104}
Tg.prototype.B=function(){for(var a=Cg.d(J([this],0)),b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=4294967296;return b};Tg.prototype.w=function(a,b){return ub(b,'#uuid "'+A.b(this.pb)+'"')};Tg.prototype.v=function(a,b){return b instanceof Tg&&this.pb===b.pb};Tg.prototype.toString=function(){return this.pb};var Ug=new T(null,"ppath","ppath"),Vg=new T("zip","branch?","zip/branch?"),Wg=new T(null,"r","r"),Xg=new T("zip","children","zip/children"),pa=new T(null,"meta","meta"),qa=new T(null,"dup","dup"),u=new T(null,"else","else"),Gg=new T(null,"validator","validator"),Yb=new T(null,"default","default"),Yg=new T(null,"sequential","sequential"),ma=new T(null,"flush-on-newline","flush-on-newline"),Zg=new T(null,"l","l"),$g=new T("zip","make-node","zip/make-node"),oa=new T(null,"readably","readably"),ra=new T(null,
"print-length","print-length"),ah=new T(null,"pnodes","pnodes"),bh=new T(null,"changed?","changed?"),ch=new T(null,"tag","tag"),dh=new T(null,"set","set"),eh=new T(null,"end","end"),fh=new T(null,"atom","atom"),Rg=new T(null,"keywordize-keys","keywordize-keys"),gh=new T(null,"map","map"),hh=new T("mori","not-found","mori/not-found"),ih=new T("cljs.core","not-found","cljs.core/not-found");var jh,kh;function lh(a){return a.o?a.o():a.call(null)}function mh(a){return a.o?a.o():a.call(null)}var nh=function(){function a(a,b,c){return Gc(c)?hb(c,a,b):null==c?b:c instanceof Array?hc.c(c,a,b):u?gb.c(c,a,b):null}function b(a,b){return c.c(a,a.o?a.o():a.call(null),b)}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function oh(a,b,c,d){if(a?a.Eb:a)return a.Eb(a,b,c,d);var e;e=oh[m(null==a?null:a)];if(!e&&(e=oh._,!e))throw x("CollFold.coll-fold",a);return e.call(null,a,b,c,d)}
var qh=function ph(b,c){"undefined"===typeof jh&&(jh=function(b,c,f,h){this.$=b;this.Qa=c;this.uc=f;this.sc=h;this.q=0;this.i=917504},jh.Db=!0,jh.Bb="clojure.core.reducers/t6322",jh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6322")},jh.prototype.N=function(b,c){return gb.c(this,c,c.o?c.o():c.call(null))},jh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},jh.prototype.D=function(){return this.sc},jh.prototype.F=function(b,c){return new jh(this.$,
this.Qa,this.uc,c)});return new jh(c,b,ph,null)},sh=function rh(b,c){"undefined"===typeof kh&&(kh=function(b,c,f,h){this.$=b;this.Qa=c;this.rc=f;this.tc=h;this.q=0;this.i=917504},kh.Db=!0,kh.Bb="clojure.core.reducers/t6328",kh.Tb=function(b,c){return ub(c,"clojure.core.reducers/t6328")},kh.prototype.Eb=function(b,c,f,h){return oh(this.Qa,c,f,this.$.b?this.$.b(h):this.$.call(null,h))},kh.prototype.N=function(b,c){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),c.o?c.o():c.call(null))},
kh.prototype.M=function(b,c,f){return gb.c(this.Qa,this.$.b?this.$.b(c):this.$.call(null,c),f)},kh.prototype.D=function(){return this.tc},kh.prototype.F=function(b,c){return new kh(this.$,this.Qa,this.rc,c)});return new kh(c,b,rh,null)},th=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return b.a?b.a(c,a.b?a.b(e):a.call(null,e)):b.call(null,c,a.b?a.b(e):a.call(null,e));case 3:return b.a?
b.a(c,a.a?a.a(e,h):a.call(null,e,h)):b.call(null,c,a.a?a.a(e,h):a.call(null,e,h))}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),uh=function(){function a(a,b){return sh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?
b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):c;case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):c}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),vh=function(){function a(a){return sh(a,
function(a){return function(){var b=null;return b=function(b,d){switch(arguments.length){case 0:return a.o?a.o():a.call(null);case 2:return Fc(d)?c.b(d).M(null,a,b):a.a?a.a(b,d):a.call(null,b,d)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(){return function(a){return c.b(a)}}var c=null,c=function(c){switch(arguments.length){case 0:return b.call(this);case 1:return a.call(this,c)}throw Error("Invalid arity: "+arguments.length);};c.o=b;c.b=a;return c}(),wh=function(){function a(a,
b){return uh.a(Gd(a),b)}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),xh=function(){function a(a,b){return qh(b,function(b){return function(){var c=null;return c=function(c,e,h){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return r(a.b?a.b(e):a.call(null,e))?b.a?b.a(c,e):b.call(null,c,e):
new ec(c);case 3:return r(a.a?a.a(e,h):a.call(null,e,h))?b.c?b.c(c,e,h):b.call(null,c,e,h):new ec(c)}throw Error("Invalid arity: "+arguments.length);}}()})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),yh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=
function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.a?b.a(c,d):b.call(null,c,d);case 3:return Jg.a(a,Wc),0>ab(a)?new ec(c):b.c?b.c(c,d,e):b.call(null,c,d,e)}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);
};c.b=b;c.a=a;return c}(),zh=function(){function a(a,b){return qh(b,function(b){return function(a){return function(){var c=null;return c=function(c,d,e){switch(arguments.length){case 0:return b.o?b.o():b.call(null);case 2:return Jg.a(a,Wc),0>ab(a)?b.a?b.a(c,d):b.call(null,c,d):c;case 3:return Jg.a(a,Wc),0>ab(a)?b.c?b.c(c,d,e):b.call(null,c,d,e):c}throw Error("Invalid arity: "+arguments.length);}}()}(Hg.b(a))})}function b(a){return function(b){return c.a(a,b)}}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,
c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}(),Bh=function Ah(b,c,d,e){if(Bc(b))return d.o?d.o():d.call(null);if(O(b)<=c)return nh.c(e,d.o?d.o():d.call(null),b);if(u){var f=Yc(O(b)),h=ze.c(b,0,f);b=ze.c(b,f,O(b));return lh(function(b,c,e,f){return function(){var b=f(c),h;h=f(e);return d.a?d.a(b.o?b.o():b.call(null),mh(h)):d.call(null,b.o?b.o():b.call(null),mh(h))}}(f,h,b,function(b,f,h){return function(q){return function(){return function(){return Ah(q,
c,d,e)}}(b,f,h)}}(f,h,b)))}return null};W.prototype.Eb=function(a,b,c,d){return Bh(this,b,c,d)};oh.object=function(a,b,c,d){return nh.c(d,c.o?c.o():c.call(null),a)};oh["null"]=function(a,b,c){return c.o?c.o():c.call(null)};function Ch(a,b){var c=S.c(ig,a,b);return M(c,Vd(function(a){return function(b){return a===b}}(c),b))}
var Dh=function(){function a(a,b){return O(a)<O(b)?C.c(pc,b,a):C.c(pc,a,b)}var b=null,c=function(){function a(c,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,c,d,l)}function b(a,c,d){a=Ch(O,pc.d(d,c,J([a],0)));return C.c(Yd,F(a),G(a))}a.k=2;a.f=function(a){var c=F(a);a=I(a);var d=F(a);a=G(a);return b(c,d,a)};a.d=b;return a}(),b=function(b,e,f){switch(arguments.length){case 0:return bg;case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,
e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.o=function(){return bg};b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Eh=function(){function a(a,b){for(;;)if(O(b)<O(a)){var c=a;a=b;b=c}else return C.c(function(a,b){return function(a,c){return Oc(b,c)?a:Ac.a(a,c)}}(a,b),a,a)}var b=null,c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){a=Ch(function(a){return-O(a)},
pc.d(e,d,J([a],0)));return C.c(b,F(a),G(a))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=c.d;return b}(),Fh=function(){function a(a,b){return O(a)<O(b)?C.c(function(a,c){return Oc(b,c)?Ac.a(a,c):a},a,a):C.c(Ac,a,b)}var b=null,
c=function(){function a(b,d,k){var l=null;2<arguments.length&&(l=J(Array.prototype.slice.call(arguments,2),0));return c.call(this,b,d,l)}function c(a,d,e){return C.c(b,a,pc.a(e,d))}a.k=2;a.f=function(a){var b=F(a);a=I(a);var d=F(a);a=G(a);return c(b,d,a)};a.d=c;return a}(),b=function(b,e,f){switch(arguments.length){case 1:return b;case 2:return a.call(this,b,e);default:return c.d(b,e,J(arguments,2))}throw Error("Invalid arity: "+arguments.length);};b.k=2;b.f=c.f;b.b=function(a){return a};b.a=a;b.d=
c.d;return b}();function Gh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):new W(null,3,5,X,[a,b,null],null)}function Hh(a){return E(a)?C.c(function(a,c){var d=P.c(c,0,null),e=P.c(c,1,null);return R.c(a,d,e)},we(Od.a(S.a(Xc,Ve(a)),null)),a):null}
function Ih(a,b,c){var d=Q.a(a,c),e=Q.a(b,c),f=Jh.a?Jh.a(d,e):Jh.call(null,d,e),h=P.c(f,0,null),k=P.c(f,1,null),f=P.c(f,2,null);a=Oc(a,c);b=Oc(b,c);d=a&&b&&(null!=f||null==d&&null==e);return new W(null,3,5,X,[!a||null==h&&d?null:new af([c,h]),!b||null==k&&d?null:new af([c,k]),d?new af([c,f]):null],null)}
var Kh=function(){function a(a,b,c){return C.c(function(a,b){return rg.b(Kd.c(Zf,a,b))},new W(null,3,5,X,[null,null,null],null),Kd.a(Id.c(Ih,a,b),c))}function b(a,b){return c.c(a,b,Dh.a(Ve(a),Ve(b)))}var c=null,c=function(c,e,f){switch(arguments.length){case 2:return b.call(this,c,e);case 3:return a.call(this,c,e,f)}throw Error("Invalid arity: "+arguments.length);};c.a=b;c.c=a;return c}();
function Lh(a,b){return we(Kd.a(Hh,Kh.c(Hc(a)?a:we(a),Hc(b)?b:we(b),pg.b(function(){var c=O(a),d=O(b);return c>d?c:d}()))))}function Mh(a,b){return new W(null,3,5,X,[Cd(Fh.a(a,b)),Cd(Fh.a(b,a)),Cd(Eh.a(a,b))],null)}function Nh(a){if(a?a.qc:a)return a.qc(a);var b;b=Nh[m(null==a?null:a)];if(!b&&(b=Nh._,!b))throw x("EqualityPartition.equality-partition",a);return b.call(null,a)}
function Oh(a,b){if(a?a.pc:a)return a.pc(a,b);var c;c=Oh[m(null==a?null:a)];if(!c&&(c=Oh._,!c))throw x("Diff.diff-similar",a);return c.call(null,a,b)}Nh._=function(a){return(a?a.i&1024||a.cc||(a.i?0:s(Pa,a)):s(Pa,a))?gh:(a?a.i&4096||a.jc||(a.i?0:s(Va,a)):s(Va,a))?dh:(a?a.i&16777216||a.ic||(a.i?0:s(mb,a)):s(mb,a))?Yg:Yb?fh:null};Nh["boolean"]=function(){return fh};Nh["function"]=function(){return fh};Nh.array=function(){return Yg};Nh.number=function(){return fh};Nh.string=function(){return fh};
Nh["null"]=function(){return fh};Oh._=function(a,b){return function(){switch(Nh(a)instanceof T?Nh(a).sa:null){case "map":return Kh;case "sequential":return Lh;case "set":return Mh;case "atom":return Gh;default:throw Error("No matching clause: "+A.b(Nh(a)));}}().call(null,a,b)};Oh["boolean"]=function(a,b){return Gh(a,b)};Oh["function"]=function(a,b){return Gh(a,b)};Oh.array=function(a,b){return Lh(a,b)};Oh.number=function(a,b){return Gh(a,b)};Oh.string=function(a,b){return Gh(a,b)};
Oh["null"]=function(a,b){return Gh(a,b)};function Jh(a,b){return Wb.a(a,b)?new W(null,3,5,X,[null,null,a],null):Wb.a(Nh(a),Nh(b))?Oh(a,b):Gh(a,b)};function Ph(a){if(a?a.Ub:a)return a.Ub();var b;b=Ph[m(null==a?null:a)];if(!b&&(b=Ph._,!b))throw x("PushbackReader.read-char",a);return b.call(null,a)}function Qh(a,b){if(a?a.Vb:a)return a.Vb(0,b);var c;c=Qh[m(null==a?null:a)];if(!c&&(c=Qh._,!c))throw x("PushbackReader.unread",a);return c.call(null,a,b)}function Rh(a,b,c){this.r=a;this.buffer=b;this.Fb=c}Rh.prototype.Ub=function(){return 0===this.buffer.length?(this.Fb+=1,this.r[this.Fb]):this.buffer.pop()};Rh.prototype.Vb=function(a,b){return this.buffer.push(b)};
function Sh(a){var b=!/[^\t\n\r ]/.test(a);return r(b)?b:","===a}var Th=function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,0,e)}function b(a,b){throw Error(S.a(A,b));}a.k=1;a.f=function(a){F(a);a=G(a);return b(0,a)};a.d=b;return a}();
function Uh(a,b){for(var c=new ea(b),d=Ph(a);;){var e;if(!(e=null==d||Sh(d))){e=d;var f="#"!==e;e=f?(f="'"!==e)?(f=":"!==e)?Vh.b?Vh.b(e):Vh.call(null,e):f:f:f}if(e)return Qh(a,d),c.toString();c.append(d);d=Ph(a)}}function Wh(a){for(;;){var b=Ph(a);if("\n"===b||"\r"===b||null==b)return a}}var Xh=tg("^([-+]?)(?:(0)|([1-9][0-9]*)|0[xX]([0-9A-Fa-f]+)|0([0-7]+)|([1-9][0-9]?)[rR]([0-9A-Za-z]+))(N)?$"),Yh=tg("^([-+]?[0-9]+)/([0-9]+)$"),Zh=tg("^([-+]?[0-9]+(\\.[0-9]*)?([eE][-+]?[0-9]+)?)(M)?$"),$h=tg("^[:]?([^0-9/].*/)?([^0-9/][^/]*)$");
function ai(a,b){var c=a.exec(b);return null!=c&&c[0]===b?1===c.length?c[0]:c:null}var bi=tg("^[0-9A-Fa-f]{2}$"),ci=tg("^[0-9A-Fa-f]{4}$");function di(a,b,c,d){return r(sg(a,d))?d:Th.d(b,J(["Unexpected unicode escape \\",c,d],0))}function ei(a){return String.fromCharCode(parseInt(a,16))}
function fi(a){var b=Ph(a),c="t"===b?"\t":"r"===b?"\r":"n"===b?"\n":"\\"===b?"\\":'"'===b?'"':"b"===b?"\b":"f"===b?"\f":null;r(c)?a=c:"x"===b?(c=(new ea(Ph(a),Ph(a))).toString(),a=ei(di(bi,a,b,c))):"u"===b?(c=(new ea(Ph(a),Ph(a),Ph(a),Ph(a))).toString(),a=ei(di(ci,a,b,c))):a=/[^0-9]/.test(b)?u?Th.d(a,J(["Unexpected unicode escape \\",b],0)):null:String.fromCharCode(b);return a}
function gi(a,b){for(var c=yb(qe);;){var d;a:{d=Sh;for(var e=b,f=Ph(e);;)if(r(d.b?d.b(f):d.call(null,f)))f=Ph(e);else{d=f;break a}d=void 0}r(d)||Th.d(b,J(["EOF while reading"],0));if(a===d)return Ab(c);e=Vh.b?Vh.b(d):Vh.call(null,d);r(e)?d=e.a?e.a(b,d):e.call(null,b,d):(Qh(b,d),d=hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null));c=d===b?c:wd.a(c,d)}}function ii(a,b){return Th.d(a,J(["Reader for ",b," not implemented yet"],0))}
function ji(a,b){var c=Ph(a),d=ki.b?ki.b(c):ki.call(null,c);if(r(d))return d.a?d.a(a,b):d.call(null,a,b);d=li.a?li.a(a,c):li.call(null,a,c);return r(d)?d:Th.d(a,J(["No dispatch macro for ",c],0))}function mi(a,b){return Th.d(a,J(["Unmached delimiter ",b],0))}function ni(a){return S.a(fd,gi(")",a))}function oi(a){return gi("]",a)}
function pi(a){var b=gi("}",a),c=O(b);if("number"!==typeof c||isNaN(c)||Infinity===c||parseFloat(c)!==parseInt(c,10))throw Error("Argument must be an integer: "+A.b(c));0!==(c&1)&&Th.d(a,J(["Map literal must contain an even number of forms"],0));return S.a(Tf,b)}function qi(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c)b.append(fi(a)),c=Ph(a);else{if('"'===c)return b.toString();if(Yb)b.append(c),c=Ph(a);else return null}}}
function ri(a){for(var b=new ea,c=Ph(a);;){if(null==c)return Th.d(a,J(["EOF while reading"],0));if("\\"===c){b.append(c);var d=Ph(a);if(null==d)return Th.d(a,J(["EOF while reading"],0));var e=function(){var a=b;a.append(d);return a}(),f=Ph(a),b=e,c=f}else{if('"'===c)return b.toString();if(u)e=function(){var a=b;a.append(c);return a}(),f=Ph(a),b=e,c=f;else return null}}}
function si(a,b){var c=Uh(a,b);if(r(-1!=c.indexOf("/")))c=$b.a(ad.c(c,0,c.indexOf("/")),ad.c(c,c.indexOf("/")+1,c.length));else var d=$b.b(c),c="nil"===c?null:"true"===c?!0:"false"===c?!1:u?d:null;return c}function ti(a){var b=Uh(a,Ph(a)),c=ai($h,b),b=c[0],d=c[1],c=c[2];return void 0!==d&&":/"===d.substring(d.length-2,d.length)||":"===c[c.length-1]||-1!==b.indexOf("::",1)?Th.d(a,J(["Invalid token: ",b],0)):null!=d&&0<d.length?jd.a(d.substring(0,d.indexOf("/")),c):jd.b(b)}
function ui(a){return function(b){return Da(Da(H,hi.n?hi.n(b,!0,null,!0):hi.call(null,b,!0,null)),a)}}function vi(){return function(a){return Th.d(a,J(["Unreadable form"],0))}}
function wi(a){var b;b=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);b=b instanceof Zb?new la(null,1,[ch,b],null):"string"===typeof b?new la(null,1,[ch,b],null):b instanceof T?new af([b,!0]):u?b:null;Gc(b)||Th.d(a,J(["Metadata must be Symbol,Keyword,String or Map"],0));var c=hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return(c?c.i&262144||c.oc||(c.i?0:s(db,c)):s(db,c))?N(c,Zf.d(J([xc(c),b],0))):Th.d(a,J(["Metadata can only be applied to IWithMetas"],0))}function xi(a){return eg(gi("}",a))}
function yi(a){return tg(ri(a))}function zi(a){hi.n?hi.n(a,!0,null,!0):hi.call(null,a,!0,null);return a}function Vh(a){return'"'===a?qi:":"===a?ti:";"===a?Wh:"'"===a?ui(new Zb(null,"quote","quote",1377916282,null)):"@"===a?ui(new Zb(null,"deref","deref",1494944732,null)):"^"===a?wi:"`"===a?ii:"~"===a?ii:"("===a?ni:")"===a?mi:"["===a?oi:"]"===a?mi:"{"===a?pi:"}"===a?mi:"\\"===a?Ph:"#"===a?ji:null}function ki(a){return"{"===a?xi:"\x3c"===a?vi():'"'===a?yi:"!"===a?Wh:"_"===a?zi:null}
function hi(a,b,c){for(;;){var d=Ph(a);if(null==d)return r(b)?Th.d(a,J(["EOF while reading"],0)):c;if(!Sh(d))if(";"===d)a=Wh.a?Wh.a(a,d):Wh.call(null,a);else if(u){var e=Vh(d);if(r(e))e=e.a?e.a(a,d):e.call(null,a,d);else{var e=a,f=void 0;!(f=!/[^0-9]/.test(d))&&(f=void 0,f="+"===d||"-"===d)&&(f=Ph(e),Qh(e,f),f=!/[^0-9]/.test(f));if(f)a:{e=a;d=new ea(d);for(f=Ph(e);;){var h;h=null==f;h||(h=(h=Sh(f))?h:Vh.b?Vh.b(f):Vh.call(null,f));if(r(h)){Qh(e,f);f=d=d.toString();h=void 0;if(r(ai(Xh,f)))if(f=ai(Xh,
f),null!=f[2])h=0;else{h=r(f[3])?[f[3],10]:r(f[4])?[f[4],16]:r(f[5])?[f[5],8]:r(f[6])?[f[7],parseInt(f[6],10)]:u?[null,null]:null;var k=h[0];null==k?h=null:(h=parseInt(k,h[1]),h="-"===f[1]?-h:h)}else h=void 0,r(ai(Yh,f))?(f=ai(Yh,f),h=parseInt(f[1],10)/parseInt(f[2],10)):h=r(ai(Zh,f))?parseFloat(f):null;f=h;e=r(f)?f:Th.d(e,J(["Invalid number format [",d,"]"],0));break a}d.append(f);f=Ph(e)}e=void 0}else e=u?si(a,d):null}if(e!==a)return e}else return null}}
function Ai(a){if(Wb.a(3,O(a)))return a;if(3<O(a))return ad.c(a,0,3);if(u)for(a=new ea(a);;)if(3>a.Va.length)a=a.append("0");else return a.toString();else return null}var Bi=function(a,b){return function(c,d){return Q.a(r(d)?b:a,c)}}(new W(null,13,5,X,[null,31,28,31,30,31,30,31,31,30,31,30,31],null),new W(null,13,5,X,[null,31,29,31,30,31,30,31,31,30,31,30,31],null)),Ci=/(\d\d\d\d)(?:-(\d\d)(?:-(\d\d)(?:[T](\d\d)(?::(\d\d)(?::(\d\d)(?:[.](\d+))?)?)?)?)?)?(?:[Z]|([-+])(\d\d):(\d\d))?/;
function Di(a){a=parseInt(a,10);return sa(isNaN(a))?a:null}function Ei(a,b,c,d){a<=b&&b<=c||Th.d(null,J([""+A.b(d)+" Failed:  "+A.b(a)+"\x3c\x3d"+A.b(b)+"\x3c\x3d"+A.b(c)],0));return b}
function Fi(a){var b=sg(Ci,a);P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null),l=P.c(b,7,null),n=P.c(b,8,null),q=P.c(b,9,null),t=P.c(b,10,null);if(sa(b))return Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));a=Di(c);var b=function(){var a=Di(d);return r(a)?a:1}(),c=function(){var a=Di(e);return r(a)?a:1}(),v=function(){var a=Di(f);return r(a)?a:0}(),w=function(){var a=Di(h);return r(a)?a:0}(),y=function(){var a=Di(k);return r(a)?
a:0}(),B=function(){var a=Di(Ai(l));return r(a)?a:0}(),n=(Wb.a(n,"-")?-1:1)*(60*function(){var a=Di(q);return r(a)?a:0}()+function(){var a=Di(t);return r(a)?a:0}());return new W(null,8,5,X,[a,Ei(1,b,12,"timestamp month field must be in range 1..12"),Ei(1,c,Bi.a?Bi.a(b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)):Bi.call(null,b,0===(a%4+4)%4&&(0!==(a%100+100)%100||0===(a%400+400)%400)),"timestamp day field must be in range 1..last day in month"),Ei(0,v,23,"timestamp hour field must be in range 0..23"),
Ei(0,w,59,"timestamp minute field must be in range 0..59"),Ei(0,y,Wb.a(w,59)?60:59,"timestamp second field must be in range 0..60"),Ei(0,B,999,"timestamp millisecond field must be in range 0..999"),n],null)}
var Gi=Hg.b(new la(null,4,["inst",function(a){var b;if("string"===typeof a)if(b=Fi(a),r(b)){a=P.c(b,0,null);var c=P.c(b,1,null),d=P.c(b,2,null),e=P.c(b,3,null),f=P.c(b,4,null),h=P.c(b,5,null),k=P.c(b,6,null);b=P.c(b,7,null);b=new Date(Date.UTC(a,c-1,d,e,f,h,k)-6E4*b)}else b=Th.d(null,J(["Unrecognized date/time syntax: "+A.b(a)],0));else b=Th.d(null,J(["Instance literal expects a string for its timestamp."],0));return b},"uuid",function(a){return"string"===typeof a?new Tg(a):Th.d(null,J(["UUID literal expects a string as its representation."],
0))},"queue",function(a){return Hc(a)?Yd(Je,a):Th.d(null,J(["Queue literal expects a vector for its elements."],0))},"js",function(a){if(Hc(a)){var b=[];a=E(a);for(var c=null,d=0,e=0;;)if(e<d){var f=c.J(null,e);b.push(f);e+=1}else if(a=E(a))c=a,Ic(c)?(a=Hb(c),e=Ib(c),c=a,d=O(a),a=e):(a=F(c),b.push(a),a=I(c),c=null,d=0),e=0;else break;return b}if(Gc(a)){b={};a=E(a);c=null;for(e=d=0;;)if(e<d){var h=c.J(null,e),f=P.c(h,0,null),h=P.c(h,1,null);b[id(f)]=h;e+=1}else if(a=E(a))Ic(a)?(d=Hb(a),a=Ib(a),c=d,
d=O(d)):(d=F(a),c=P.c(d,0,null),d=P.c(d,1,null),b[id(c)]=d,a=I(a),c=null,d=0),e=0;else break;return b}return u?Th.d(null,J(["JS literal expects a vector or map containing only string or unqualified keyword keys"],0)):null}],null)),Hi=Hg.b(null);
function li(a,b){var c=si(a,b),d=Q.a(ab(Gi),""+A.b(c)),e=ab(Hi);return r(d)?d.b?d.b(hi(a,!0,null)):d.call(null,hi(a,!0,null)):r(e)?e.a?e.a(c,hi(a,!0,null)):e.call(null,c,hi(a,!0,null)):u?Th.d(a,J(["Could not find tag parser for ",""+A.b(c)," in ",Cg.d(J([Ve(ab(Gi))],0))],0)):null};p("mori.apply",S);p("mori.count",O);p("mori.distinct",function(a){return function c(a,e){return new V(null,function(){return function(a,d){for(;;){var e=a,l=P.c(e,0,null);if(e=E(e))if(Oc(d,l))l=G(e),e=d,a=l,d=e;else return M(l,c(G(e),pc.a(d,l)));else return null}}.call(null,a,e)},null,null)}(a,bg)});p("mori.empty",qc);p("mori.first",F);p("mori.rest",G);p("mori.seq",E);p("mori.conj",pc);p("mori.cons",M);
p("mori.find",function(a,b){return null!=a&&Ec(a)&&Oc(a,b)?new W(null,2,5,X,[b,Q.a(a,b)],null):null});p("mori.nth",P);p("mori.last",oc);p("mori.assoc",R);p("mori.dissoc",tc);p("mori.get_in",$d);p("mori.update_in",ae);p("mori.assoc_in",function Ii(b,c,d){var e=P.c(c,0,null);return(c=$c(c))?R.c(b,e,Ii(Q.a(b,e),c,d)):R.c(b,e,d)});p("mori.fnil",Jd);p("mori.disj",Ac);p("mori.pop",zc);p("mori.peek",yc);p("mori.hash",Tb);p("mori.get",Q);p("mori.has_key",Oc);p("mori.is_empty",Bc);p("mori.reverse",ed);
p("mori.take",Md);p("mori.drop",Nd);p("mori.take_nth",function Ji(b,c){return new V(null,function(){var d=E(c);return d?M(F(d),Ji(b,Nd(b,d))):null},null,null)});p("mori.partition",Zd);p("mori.partition_all",jg);p("mori.partition_by",function Ki(b,c){return new V(null,function(){var d=E(c);if(d){var e=F(d),f=b.b?b.b(e):b.call(null,e),e=M(e,lg(function(c,d){return function(c){return Wb.a(d,b.b?b.b(c):b.call(null,c))}}(e,f,d,d),I(d)));return M(e,Ki(b,E(Nd(O(e),d))))}return null},null,null)});
p("mori.iterate",function Li(b,c){return M(c,new V(null,function(){return Li(b,b.b?b.b(c):b.call(null,c))},null,null))});p("mori.into",Yd);p("mori.merge",Zf);p("mori.subvec",ze);p("mori.take_while",lg);p("mori.drop_while",function(a,b){return new V(null,function(c){return function(){return c(a,b)}}(function(a,b){for(;;){var e=E(b),f;f=(f=e)?a.b?a.b(F(e)):a.call(null,F(e)):f;if(r(f))f=a,e=G(e),a=f,b=e;else return e}}),null,null)});
p("mori.group_by",function(a,b){return C.c(function(b,d){var e=a.b?a.b(d):a.call(null,d);return R.c(b,e,pc.a(Q.c(b,e,qe),d))},Ye,b)});p("mori.interpose",function(a,b){return Nd(1,Qd.a(Od.b(a),b))});p("mori.interleave",Qd);p("mori.concat",td);p("mori.conj1",function(a,b){return a.G(null,b)});function Xd(a){return a instanceof Array||Fc(a)}p("mori.flatten",function(a){return Ud(function(a){return!Xd(a)},G(Wd(a)))});p("mori.lazy_seq",function(a){return new V(null,a,null,null)});p("mori.keys",Ve);
p("mori.select_keys",function(a,b){for(var c=Ye,d=E(b);;)if(d)var e=F(d),f=Q.c(a,e,ih),c=Bd.a(f,ih)?R.c(c,e,f):c,d=I(d);else return c});p("mori.vals",We);p("mori.prim_seq",mc);p("mori.map",Kd);p("mori.mapcat",Sd);p("mori.reduce",C);p("mori.reduce_kv",function(a,b,c){return null!=c?hb(c,a,b):b});p("mori.filter",Ud);p("mori.remove",Vd);p("mori.some",Ed);p("mori.every",Dd);p("mori.equals",Wb);p("mori.range",pg);p("mori.repeat",Od);p("mori.repeatedly",Pd);p("mori.sort",Sc);p("mori.sort_by",Tc);
p("mori.into_array",xa);p("mori.subseq",ng);p("mori.rmap",th);p("mori.rfilter",uh);p("mori.rremove",wh);p("mori.rtake",yh);p("mori.rtake_while",xh);p("mori.rdrop",zh);p("mori.rflatten",vh);p("mori.list",fd);p("mori.vector",xe);p("mori.array_map",Uf);p("mori.hash_map",Tf);p("mori.set",eg);p("mori.sorted_set",fg);p("mori.sorted_set_by",gg);p("mori.sorted_map",Vf);p("mori.sorted_map_by",Wf);
p("mori.queue",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return Yd.a?Yd.a(Je,a):Yd.call(null,Je,a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());p("mori.keyword",jd);p("mori.symbol",$b);p("mori.zipmap",function(a,b){for(var c=yb(Ye),d=E(a),e=E(b);;)if(d&&e)c=xd.c(c,F(d),F(e)),d=I(d),e=I(e);else return Ab(c)});
p("mori.is_list",function(a){return a?a.i&33554432||a.Ec?!0:a.i?!1:s(nb,a):s(nb,a)});p("mori.is_seq",Mc);p("mori.is_vector",Hc);p("mori.is_map",Gc);p("mori.is_set",Dc);p("mori.is_keyword",function(a){return a instanceof T});p("mori.is_symbol",function(a){return a instanceof Zb});p("mori.is_collection",Cc);p("mori.is_sequential",Fc);p("mori.is_associative",Ec);p("mori.is_counted",ic);p("mori.is_indexed",jc);p("mori.is_reduceable",function(a){return a?a.i&524288||a.Nb?!0:a.i?!1:s(fb,a):s(fb,a)});
p("mori.is_seqable",function(a){return a?a.i&8388608||a.hc?!0:a.i?!1:s(kb,a):s(kb,a)});p("mori.is_reversible",dd);p("mori.union",Dh);p("mori.intersection",Eh);p("mori.difference",Fh);p("mori.is_subset",function(a,b){return O(a)<=O(b)&&Dd(function(a){return Oc(b,a)},a)});p("mori.is_superset",function(a,b){return O(a)>=O(b)&&Dd(function(b){return Oc(a,b)},b)});p("mori.partial",Id);p("mori.comp",Hd);
p("mori.pipeline",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return C.a?C.a(function(a,b){return b.b?b.b(a):b.call(null,a)},a):C.call(null,function(a,b){return b.b?b.b(a):b.call(null,a)},a)}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.curry",function(){function a(a,d){var e=null;1<arguments.length&&(e=J(Array.prototype.slice.call(arguments,1),0));return b.call(this,a,e)}function b(a,b){return function(e){return S.a(a,M.a?M.a(e,b):M.call(null,e,b))}}a.k=1;a.f=function(a){var d=F(a);a=G(a);return b(d,a)};a.d=b;return a}());
p("mori.juxt",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(){function b(a){var c=null;0<arguments.length&&(c=J(Array.prototype.slice.call(arguments,0),0));return e.call(this,c)}function e(b){return xa.b?xa.b(Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,b)},a)):xa.call(null,Kd.a?Kd.a(function(a){return S.a(a,b)},a):Kd.call(null,function(a){return S.a(a,
b)},a))}b.k=0;b.f=function(a){a=E(a);return e(a)};b.d=e;return b}()}a.k=0;a.f=function(a){a=E(a);return b(a)};a.d=b;return a}());
p("mori.knit",function(){function a(a){var d=null;0<arguments.length&&(d=J(Array.prototype.slice.call(arguments,0),0));return b.call(this,d)}function b(a){return function(b){return xa.b?xa.b(Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b)):xa.call(null,Kd.c?Kd.c(function(a,b){return a.b?a.b(b):a.call(null,b)},a,b):Kd.call(null,function(a,b){return a.b?a.b(b):a.call(null,b)},a,b))}}a.k=0;a.f=function(a){a=E(a);return b(a)};
a.d=b;return a}());p("mori.diff",Jh);p("mori.sum",function(a,b){return a+b});p("mori.inc",function(a){return a+1});p("mori.dec",function(a){return a-1});p("mori.is_even",function(a){return 0===(a%2+2)%2});p("mori.is_odd",function(a){return 1===(a%2+2)%2});p("mori.each",function(a,b){for(var c=E(a),d=null,e=0,f=0;;)if(f<e){var h=d.J(null,f);b.b?b.b(h):b.call(null,h);f+=1}else if(c=E(c))d=c,Ic(d)?(c=Hb(d),e=Ib(d),d=c,h=O(c),c=e,e=h):(h=F(d),b.b?b.b(h):b.call(null,h),c=I(d),d=null,e=0),f=0;else return null});
p("mori.identity",Fd);p("mori.constantly",function(a){return function(){function b(b){0<arguments.length&&J(Array.prototype.slice.call(arguments,0),0);return a}b.k=0;b.f=function(b){E(b);return a};b.d=function(){return a};return b}()});p("mori.clj_to_js",Ng);
p("mori.js_to_clj",function(){function a(a,b){return Sg.d(a,J([Rg,b],0))}function b(a){return Sg.b(a)}var c=null,c=function(c,e){switch(arguments.length){case 1:return b.call(this,c);case 2:return a.call(this,c,e)}throw Error("Invalid arity: "+arguments.length);};c.b=b;c.a=a;return c}());p("mori.parse",function(a){return hi(new Rh(a,[],-1),!1,null)});
p("mori.configure",function(a,b){switch(a){case "print-length":return ia=b;case "print-level":return ja=b;default:throw Error("No matching clause: "+A.b(a));}});
p("mori.proxy",function(a){if("undefined"!==typeof Proxy)return Proxy.create(function(){return{has:function(b){return Oc(a,b)},hasOwn:function(b){return Oc(a,b)},get:function(b,c){var d=Q.c?Q.c(a,c,hh):Q.call(null,a,c,hh);return hd(d,hh)?ic(a)&&"length"===c?O.b?O.b(a):O.call(null,a):null:u?d:null},set:function(){return null},enumerate:function(){return xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a))},keys:function(){return Gc(a)?xa.b?xa.b(Ve.b?Ve.b(a):Ve.call(null,
a)):xa.call(null,Ve.b?Ve.b(a):Ve.call(null,a)):Hc(a)?xa.b?xa.b(pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):xa.call(null,pg.b?pg.b(O.b?O.b(a):O.call(null,a)):pg.call(null,O.b?O.b(a):O.call(null,a))):null}}}());throw Error("ES6 Proxy not supported!");});V.prototype.inspect=function(){return this.toString()};ac.prototype.inspect=function(){return this.toString()};kc.prototype.inspect=function(){return this.toString()};Bf.prototype.inspect=function(){return this.toString()};
vf.prototype.inspect=function(){return this.toString()};wf.prototype.inspect=function(){return this.toString()};bd.prototype.inspect=function(){return this.toString()};gd.prototype.inspect=function(){return this.toString()};cd.prototype.inspect=function(){return this.toString()};W.prototype.inspect=function(){return this.toString()};od.prototype.inspect=function(){return this.toString()};ye.prototype.inspect=function(){return this.toString()};Ae.prototype.inspect=function(){return this.toString()};
$.prototype.inspect=function(){return this.toString()};Y.prototype.inspect=function(){return this.toString()};la.prototype.inspect=function(){return this.toString()};xf.prototype.inspect=function(){return this.toString()};Qf.prototype.inspect=function(){return this.toString()};$f.prototype.inspect=function(){return this.toString()};cg.prototype.inspect=function(){return this.toString()};og.prototype.inspect=function(){return this.toString()};T.prototype.inspect=function(){return this.toString()};
Zb.prototype.inspect=function(){return this.toString()};Ie.prototype.inspect=function(){return this.toString()};He.prototype.inspect=function(){return this.toString()};p("mori._equiv",function(a,b){return a.Hc(b)});p("mori._keys",function(a){return a.keys()});p("mori._values",function(a){return a.values()});p("mori._entries",function(a){return a.entries()});p("mori._has",function(a){return a.has()});p("mori._get",function(a){return a.get()});p("mori._forEach",function(a){return a.forEach()});
p("mori._next",function(a){return a.next()});p("mori.mutable.thaw",function(a){return yb(a)});p("mori.mutable.freeze",vd);p("mori.mutable.conj1",function(a,b){return a.Ka(null,b)});p("mori.mutable.conj",wd);p("mori.mutable.assoc",xd);p("mori.mutable.dissoc",yd);p("mori.mutable.pop",function(a){return Eb(a)});p("mori.mutable.disj",zd);function Mi(a,b,c,d){return N(new W(null,2,5,X,[d,null],null),new la(null,3,[$g,c,Xg,b,Vg,a],null))}function Ni(a){return a.b?a.b(0):a.call(null,0)}function Oi(a){return Vg.b(xc(a)).call(null,Ni(a))}function Pi(a){if(r(Oi(a)))return Xg.b(xc(a)).call(null,Ni(a));throw"called children on a leaf node";}function Qi(a,b,c){return $g.b(xc(a)).call(null,b,c)}
function Ri(a){if(r(Oi(a))){var b=P.c(a,0,null),c=P.c(a,1,null),d=Pi(a),e=P.c(d,0,null),f=$c(d);return r(d)?N(new W(null,2,5,X,[e,new la(null,4,[Zg,qe,ah,r(c)?pc.a(ah.b(c),b):new W(null,1,5,X,[b],null),Ug,c,Wg,f],null)],null),xc(a)):null}return null}
function Si(a){var b=P.c(a,0,null),c=P.c(a,1,null),d=Mc(c)?S.a(Tf,c):c,c=Q.a(d,Zg),e=Q.a(d,Ug),f=Q.a(d,ah),h=Q.a(d,Wg),d=Q.a(d,bh);return r(f)?(f=yc(f),N(r(d)?new W(null,2,5,X,[Qi(a,f,td.a(c,M(b,h))),r(e)?R.c(e,bh,!0):e],null):new W(null,2,5,X,[f,e],null),xc(a))):null}function Ti(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg),f=P.c(e,0,null),h=$c(e);return r(r(c)?e:c)?N(new W(null,2,5,X,[f,R.d(c,Zg,pc.a(d,b),J([Wg,h],0))],null),xc(a)):null}
function Ui(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?e:c)?N(new W(null,2,5,X,[oc(e),R.d(c,Zg,S.n(pc,d,b,hg(e)),J([Wg,null],0))],null),xc(a)):a}function Vi(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[yc(d),R.d(c,Zg,zc(d),J([Wg,M(b,e)],0))],null),xc(a)):null}
function Wi(a,b){P.c(a,0,null);var c=P.c(a,1,null);return N(new W(null,2,5,X,[b,R.c(c,bh,!0)],null),xc(a))}var Xi=function(){function a(a,d,e){var f=null;2<arguments.length&&(f=J(Array.prototype.slice.call(arguments,2),0));return b.call(this,a,d,f)}function b(a,b,e){return Wi(a,S.c(b,Ni(a),e))}a.k=2;a.f=function(a){var d=F(a);a=I(a);var e=F(a);a=G(a);return b(d,e,a)};a.d=b;return a}();p("mori.zip.zipper",Mi);p("mori.zip.seq_zip",function(a){return Mi(Mc,Fd,function(a,c){return N(c,xc(a))},a)});p("mori.zip.vector_zip",function(a){return Mi(Hc,E,function(a,c){return N(we(c),xc(a))},a)});p("mori.zip.node",Ni);p("mori.zip.is_branch",{}.xc);p("mori.zip.children",Pi);p("mori.zip.make_node",Qi);p("mori.zip.path",function(a){return ah.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.lefts",function(a){return E(Zg.b(a.b?a.b(1):a.call(null,1)))});
p("mori.zip.rights",function(a){return Wg.b(a.b?a.b(1):a.call(null,1))});p("mori.zip.down",Ri);p("mori.zip.up",Si);p("mori.zip.root",function(a){for(;;){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return Ni(a);var b=Si(a);if(r(b))a=b;else return Ni(a)}});p("mori.zip.right",Ti);p("mori.zip.rightmost",Ui);p("mori.zip.left",Vi);
p("mori.zip.leftmost",function(a){var b=P.c(a,0,null),c=P.c(a,1,null),c=Mc(c)?S.a(Tf,c):c,d=Q.a(c,Zg),e=Q.a(c,Wg);return r(r(c)?E(d):c)?N(new W(null,2,5,X,[F(d),R.d(c,Zg,qe,J([Wg,td.d(G(d),new W(null,1,5,X,[b],null),J([e],0))],0))],null),xc(a)):a});p("mori.zip.insert_left",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Zg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Zg,pc.a(e,b),J([bh,!0],0))],null),xc(a))});
p("mori.zip.insert_right",function(a,b){var c=P.c(a,0,null),d=P.c(a,1,null),d=Mc(d)?S.a(Tf,d):d,e=Q.a(d,Wg);if(null==d)throw"Insert at top";return N(new W(null,2,5,X,[c,R.d(d,Wg,M(b,e),J([bh,!0],0))],null),xc(a))});p("mori.zip.replace",Wi);p("mori.zip.edit",Xi);p("mori.zip.insert_child",function(a,b){return Wi(a,Qi(a,Ni(a),M(b,Pi(a))))});p("mori.zip.append_child",function(a,b){return Wi(a,Qi(a,Ni(a),td.a(Pi(a),new W(null,1,5,X,[b],null))))});
p("mori.zip.next",function(a){if(Wb.a(eh,a.b?a.b(1):a.call(null,1)))return a;var b;b=Oi(a);b=r(b)?Ri(a):b;if(r(b))return b;b=Ti(a);if(r(b))return b;for(;;)if(r(Si(a))){b=Ti(Si(a));if(r(b))return b;a=Si(a)}else return new W(null,2,5,X,[Ni(a),eh],null)});p("mori.zip.prev",function(a){var b=Vi(a);if(r(b))for(a=b;;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return Si(a)});p("mori.zip.is_end",function(a){return Wb.a(eh,a.b?a.b(1):a.call(null,1))});
p("mori.zip.remove",function(a){P.c(a,0,null);var b=P.c(a,1,null),b=Mc(b)?S.a(Tf,b):b,c=Q.a(b,Zg),d=Q.a(b,Ug),e=Q.a(b,ah),f=Q.a(b,Wg);if(null==b)throw"Remove at top";if(0<O(c))for(a=N(new W(null,2,5,X,[yc(c),R.d(b,Zg,zc(c),J([bh,!0],0))],null),xc(a));;)if(b=Oi(a),b=r(b)?Ri(a):b,r(b))a=Ui(b);else return a;else return N(new W(null,2,5,X,[Qi(a,yc(e),f),r(d)?R.c(d,bh,!0):d],null),xc(a))});;return this.mori;}.call({});});

},{}],11:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * A `Sequencer` advances its underlying sequence on `advance()`, and provides that value on `value()`. The only
   * guarantee a sequencer provides is that `value()` is always non-decreasing over time (i.e., after multiple calls
   * to `advance()`, a sequencer will never be smaller than the previous call - but it may also not be bigger).
   *
   */
  var UnitSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(UnitSequencer.prototype, {
    initialize: function(opts) {
      opts           = Options.fromObject(opts);
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances its sequence by `by`, or by `1` if `by` is not provided.
     *
     * @param by {number} the amount to advance by. Defaults to `1`.
     * @async
     * @returns {Promise<undefined>}
     */
    advance: Promise.method(function(by) {
      // Wahh wahh - don't use `by || 1`, or you can't advance by 0, which is silly
      // but potentially necessary.
      by             = _.isUndefined(by) ? 1 : by;

      if (by < 0) {
        throw new Error("UnitSequencer#advance() requires positive `by` offset");
      }

      this._sequence = this._sequence + by;
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return UnitSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"underscore":61,"bluebird":62}],13:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * See `UnitSequencer` for a high-level explanation of Sequencer semantics.
   *
   * A Sequencer which advances by reading from a Clock.
   * Note that this ClockSequencer relies on the Clock protocol, which
   * only provides `Clock#getTime()`. It does not modify the clock itself.
   * This means if you're using a LogicalClock, it's still up to the clock's
   * owner to advance the clock for the sequencer to advance.
   */
  var ClockSequencer = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ClockSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._clock    = opts.getOrError("clock");
      this._sequence = opts.getOrElse("initialSequence", 0);
    },

    /**
     * Advances by setting its sequence to the backing clock's time.
     * Note that if this method is called twice within the same time unit,
     * the sequence will not actually advance, since unique time is not
     * guaranteed by our clocks.
     *
     * @async
     * @returns {Promise<>}
     */
    advance: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._clock.getTime();
        })
        .then(function(t) {
          this._sequence = t;
        });
    }),

    /**
     * Returns the current sequence. This value should always be the same
     * or greater than a value returned previously (in time).
     *
     * @returns {number} the current sequence
     */
    value: function() {
      return this._sequence;
    }
  });

  return ClockSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"bluebird":62,"underscore":61}],14:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * See `UnitSequencer` for a high-level explanation of Sequencer semantics.
   *
   * A UnitSequencer which reports its sequence summed with the sequences
   * of its internal collection of sequencers.
   *
   * This device is useful for tracking the state of data comprised from multiple
   * sources. For instance, you might have CachingDataStore(A) storing data
   * from Source(A), tracked by Sequencer(A), and CachingDataStore(B) storing
   * data from Source(B), tracked by Sequencer(B). Meanwhile, you may have
   * CachingDataStore(C), storing data from Source(A + B), and tracked by
   * Sequencer(C) = Sequencer(A + B) - a DelegatingCompositeSequencer.
   *
   * Thus, if Sequencer(A) is advanced, it may invalidate CachingDataStore(A) or
   * CachingDataStore(C) or both.
   *
   * Note this particular usage is generally only useful for Unit sequencers.
   *
   * If you'd like the above functionality, but with Sequencer(A) and
   * Sequencer(B) as ClockSequencers, and Sequencer(C) merely tracking
   * modification, you'd need to use a DelegatingForwardingSequencer for A and B,
   * forwarding them to UnitSequencer(C).
   *
   * DelegatingCompositeSequencer and DelegatingForwardingSequencer are effectivly
   * opposites of each other. DelegatingCompositeSequencer composes the `value`
   * of multiple underlying sequencers (pull), and DelegatingForwardingSequencer
   * forwards the `advance` call to multiple targets (push).
   */
  var DelegatingCompositeSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingCompositeSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._sequencers = _.clone(opts.getOrElse("sequencers", []));
    },
    addSequencer: function(seq) {
      this._sequencers.push(seq);
    },
    advance: function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments);
    },
    value: function() {
      return _
        .chain(this._sequencers)
        .invoke("value")
        .reduce(function(sum, n) {
          return sum + n;
        }, 0)
        .value() + this._delegateSequencer.value();
    }
  });

  return DelegatingCompositeSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"bluebird":62,"underscore":61}],15:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {

  /**
   * See `UnitSequencer` for a high-level explanation of Sequencer semantics.
   *
   * A Sequencer which delegates to another sequencer for both `advance` and `value`, and also forwards `advance` to
   * other `target` sequencers. It is the logical complement of a `DelegatingCompositeSequencer`, which derives its `value` from
   * its underlying `sequencers`.
   *
   *
   */
  var DelegatingForwardingSequencer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingForwardingSequencer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._delegateSequencer = opts.getOrError("delegate");
      this._forwardTargets = _.clone(opts.getOrElse("targets", []));
    },
    addTarget: function(seq) {
      this._forwardTargets.push(seq);
    },
    advance: Promise.method(function() {
      var s = this._delegateSequencer;
      return s.advance.apply(s, arguments)
      .bind(this)
      .then(function(val) {
        return Promise
          .all(_.invoke(this._forwardTargets, "advance"))
          .then(function() {
            // Return the value returned by the delegate sequencer's
            // advance call (if any). The advancement of the forward
            // targets should be transparent.
            return val;
          });
      });
    }),
    value: function() {
      var s = this._delegateSequencer;
      return s.value.apply(s, arguments);
    }
  });

  return DelegatingForwardingSequencer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../options")
);

})()
},{"../options":8,"underscore":61,"bluebird":62}],23:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options
) {
  /**
   * A Clock which allows manually manipulating the underlying time value,
   * irrespective of real time. Useful for testing.
   */
  var LogicalClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LogicalClock.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._currentTime = opts.getOrElse("initialTime", 0);
    },

    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return this._currentTime;
    }),

    /**
     * Advances internal time, either `opts.by` a certain offset, or
     * `opts.to` a particular absolute time. If successful, returns the result
     * of calling `LogicalClock#getTime()` as a convenience.
     *
     * @param opts.to {number} absolute time to set clock to. Must be larger
     *                         than the current time
     * @param opts.by {number} offset to add to current time. Must be positive.
     *                         Defaults to `1` if neither `opts.to` or `opts.by`
     *                         are specified.
     * @async
     * @returns {Promise<number>} result of `LogicalClock#getTime()`
     */
    advanceTime: Promise.method(function(opts){
      opts = Options.fromObject(opts);
      var by = opts.getOrElse("by", 1),
          to = opts.getOrElse("to", undefined);
      if (!_.isUndefined(to)) {
        if (to < this._currentTime) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time")
        }
        this._currentTime = to;
      } else {
        if (by < 0) {
          throw new Error("LogicalClock#advanceTime() requires forward movement of time");
        }
        this._currentTime = this._currentTime + by;
      }
      return this.getTime();
    })
  });

  return LogicalClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../../core/options")
);

})()
},{"../../core/options":8,"underscore":61,"bluebird":62}],24:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise
) {

  /**
   * A Clock which delegates to the system clock.
   */
  var SystemClock = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(SystemClock.prototype, {
    initialize: function() {},
    /**
     * @async
     * @returns {Promise<number>} Time in milliseconds since epoch
     * @see Clock#getTime()
     */
    getTime: Promise.method(function() {
      return Date.now();
    })
  });

  return SystemClock;
};

module.exports = mod(
  require("underscore"),
  require("bluebird")
);

})()
},{"bluebird":62,"underscore":61}],27:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * Given a raw config, ensures blobs can be fetched regardless of
   * scope union scope (i.e., does union canonicalization).
   *
   * For example, a config with scope union `"bbb+aaa"` can later be
   * fetched using either `"aaa+bbb"` or `"bbb+aaa"`. It does this
   * by uniformly ordering the union's composite scopes.
   *
   * This probably isn't a useful class on its own. Instead, defer to
   * `ScopedConfigurationResolver` or `ConfigurationMagic`.
   */
  var ScopedConfiguration = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfiguration.prototype, {
    initialize: function(rawConfig) {
      rawConfig = rawConfig || {};
      this._scopes = {};
      // Sort the scope strings
      _.each(rawConfig, function(config, scopeString) {
        var scope = scopeString.split("+").sort().join("+");
        this._scopes[scope] = config;
      }, this);
    },

    blobForScope: function(scope) {
      return _.clone(this._scopes[scope.split("+").sort().join("+")] || {});
    }
  });

  return ScopedConfiguration;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],26:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  ScopedConfiguration
) {

  /**
   * A device for resolving a set of raw configurations given a set of
   * scopes.
   *
   * This is useful for having things like region- or stage-specific (and/or both)
   * configurations.
   *
   * Given sets of raw configurations of the form:
   *
   *   {
   *     "scope-1" : {
   *       "key1" : "val1"
   *     },
   *     "scope-1+env1": {
   *       "key2" : "val-env-1"
   *     },
   *     "scope-1+env2": {
   *       "key2" : "val-env-2"
   *     }
   *   }
   *
   * `resolve(["scope-1"])` will return:
   *
   *   {
   *     "key1" : "val2"
   *   }
   *
   * `resolve(["scope-1", "env-1"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-1"
   *   }
   *
   * `resolve(["scope-1", "env-2"])` will return:
   *
   *   {
   *     "key1" : "val1",
   *     "key2" : "val-env-2"
   *   }
   *
   * Scopes unions are resolved in the following manner:
   *   1. a given scope union's parts are sorted
   *   2. scope unions as a whole are applied in sorted order
   *   3. repeat the process for a given configuration
   *
   * So, given three configs:
   *
   *  {
   *    "aaa": ... // 1
   *    "ccc": ... // 2
   *  }
   *
   *  {
   *    "aaa+ccc": ... // 3
   *    "ccc"    : ... // 4
   *  }
   *
   *  {
   *    "aaa+bbb": ... // 5
   *    "bbb"    : ... // 6
   *  }
   *
   * The resulting order will be:
   *   1, 2, 4, 3, 6, 5
   *
   * Notice 3 comes before 5 even though it's logically "after" in sorted order,
   * because configuration order overrides scope order. That is, scope unions
   * are ordered within a config, and then in config order.
   *
   */
  var ScopedConfigurationResolver = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(ScopedConfigurationResolver.prototype, {
    initialize: function() {
      this._configs = [];
    },

    /**
     * A rawConfig is a set of configuration scopes and their configuration
     * values, e.g.:
     *
     *   {
     *     "scope-1" : {
     *       "key1" : "val1"
     *     },
     *     "scope-1+env1": {
     *       "key2" : "val-env-1"
     *     },
     *     "scope-1+env2": {
     *       "key2" : "val-env-2"
     *     }
     *   }
     *
     * Note that the plus (+) sign is reserved for specifying scope unions.
     *
     * @param rawConfig {object} (required)
     *
     * @returns this
     */
    add: function(rawConfig) {
      this._configs.push(new ScopedConfiguration(rawConfig));
      return this;
    },

    /**
     * Resolves a computed final configuration given a set of scopes to apply,
     * and a set of configs loaded via `ScopedConfigurationResolver#add()`.
     *
     * @param scopes {Array<string>}
     *
     * @returns {object} the computed configuration
     */
    resolve: function(scopes) {
      scopes = powerset(_.clone(scopes).sort());
      scopes.shift(); // Get rid of the empty set.

      scopes = _.collect(scopes, function(s) {
        return s.join("+");
      });

      var relevantConfigs = _
        .chain(this._configs)
        .collect(function(c) {
          return _.collect(scopes, function(scope) {
            return c.blobForScope(scope);
          })
        }).flatten().value();

      relevantConfigs.unshift({});
      return _.extend.apply(_, relevantConfigs);
    }
  });

  var powerset = function (ary) {
      var ps = [[]];
      for (var i=0; i < ary.length; i++) {
          for (var j = 0, len = ps.length; j < len; j++) {
              ps.push(ps[j].concat(ary[i]));
          }
      }
      return ps;
  }

  return ScopedConfigurationResolver;
};

module.exports = mod(
  require("underscore"),
  require("./scoped-configuration")
);

})()
},{"./scoped-configuration":27,"underscore":61}],29:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  Options
) {

  /**
   * A Logger.
   *
   * Any appender provided to `addAppender` should have a .log method (see `ConsoleLogAppender`).
   *
   */
  var Logger = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Logger.prototype, {

    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._name         = opts.getOrElse("name", "Default");
      this._logLevel     = opts.getOrElse("logLevel", LogUtil.Level.Info);
      this._parent       = opts.getOrElseFn("refParent", function() { return Ref(null) });
      this._muted        = {};
      this._appenders = [];
    },

    mute: function(name) {
      this._muted[name] = true;
    },

    unmute: function(name) {
      delete this._muted[name];
    },

    trace: function() {
      this._log(LogUtil.Level.Trace, _.toArray(arguments));
    },

    debug: function() {
      this._log(LogUtil.Level.Debug, _.toArray(arguments));
    },

    info: function() {
      this._log(LogUtil.Level.Info, _.toArray(arguments));
    },

    warn: function() {
      this._log(LogUtil.Level.Warn, _.toArray(arguments));
    },

    error: function() {
      this._log(LogUtil.Level.Error, _.toArray(arguments));
    },

    fatal: function() {
      this._log(LogUtil.Level.Fatal, _.toArray(arguments));
    },

    isTraceEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Trace);
    },

    isDebugEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Debug);
    },

    isInfoEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Info);
    },

    isWarnEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Warn);
    },

    isErrorEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Error);
    },

    isFatalEnabled: function() {
      return this.isLogLevelEnabled(LogUtil.Level.Fatal);
    },

    isLogLevelEnabled: function(logLevel) {
      var coercedLogLevel = b(logLevel);
      return (this._logLevel & coercedLogLevel) === coercedLogLevel;
    },

    addAppender: function(appender) {
      this._appenders.push(appender);
    },

    setLogLevel: function(logLevel) {
      // Save a copy for the potential error message
      var originalLogLevel = logLevel;

      // If name is specified, e.g., "Info", convert to
      // int
      if (_.isString(logLevel)) {
        logLevel = LogUtil.Level[logLevel]
      }

      var exists = _.detect(LogUtil.Level, function(level, name) {
        return level === logLevel;
      });

      if (!exists) {
        throw new Error("Invalid logLevel: " + originalLogLevel);
      }

      this._logLevel = logLevel;
    },


    _log: function(logLevel, logArgs) {
      this._logWithMetadata([], logLevel, logArgs);
    },

    _isMuted: function(name) {
      return !!this._muted[name];
    },

    _logWithMetadata: function(descendants, logLevel, args) {
      var leaf = descendants[descendants.length - 1] || this._name;
      if (this.isLogLevelEnabled(logLevel) && !this._isMuted(leaf)) {
        _.each(this._appenders, function(appender) {
          appender.log(this._name, descendants, logLevel, LogUtil._Label[logLevel], args);
        }, this);
      }

      if (this._parent.get()) {
        this._parent.get()._logWithMetadata([this._name].concat(descendants), logLevel, args);
      }
    }
  });

  var LogUtil = function() {
    this.initialize.apply(this, arguments);
  };

  // Coerce (just use rightmost 8 bits)!; because JS is dumb, and everything is
  // actually a float with 53-bit precision
  var b = function(v) {
    return 0xFF & v;
  };

  _.extend(LogUtil, {
    Level: {
      Trace: b(parseInt("111111", 2)),
      Debug: b(parseInt("011111", 2)),
      Info:  b(parseInt("001111", 2)),
      Warn:  b(parseInt("000111", 2)),
      Error: b(parseInt("000011", 2)),
      Fatal: b(parseInt("000001", 2))
    }
  });

  _.extend(LogUtil.prototype, {
    Level: LogUtil.Level,
    initialize: function() {
      this._rootLogger = Ref(new Logger({
        name: "Root"
      }));
    },

    create: function(name, opts) {
      opts = _.clone(opts || {});

      var parent;
      if (opts.parent) {
        parent = Ref(opts.parent);
        delete(opts.parent);
      } else {
        parent = Ref.delegating(this._rootLogger);
      }

      opts.refParent = parent;

      opts.name = name;

      return new Logger(opts);
    },

    root: function() {
      return this._rootLogger.get();
    },

    resetRootLogger: function() {
      this._rootLogger.set(new Logger({
        name: "Root"
      }));
    }
  });


  LogUtil._Label = _.reduce(LogUtil.Level, function(memo, val, key) {
    memo[val] = key;
    return memo;
  }, {});

  return new LogUtil();
};

module.exports = mod(
  require("underscore"),
  require("../ref"),
  require("../options")
);

})()
},{"../options":8,"../ref":45,"underscore":61}],31:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  UUID,
  Options,
  StateGuard
) {

  /**
   * A channel is a path through which messages flow.
   *
   * Channels are meant to have a single publisher, multiple subscribers.
   *
   * This is "enforced" using a sentinel. The same sentinel provided during
   * instantiation must be used when calling `publish`, else an exception
   * is raised.
   *
   */
  var Channel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Channel.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._sentinel      = opts.getOrError("sentinel");
      this._stateGuard    = new StateGuard(["disposed"]);
      this._subscriptions = M.hash_map();
    },

    reset: function() {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });
      this._subscriptions = M.hash_map();
    },

    publish: function(sentinel, msg) {
      return this._publish.apply(this, arguments);
    },


    subscribe: function(handler) {
      return this._subscribe.apply(this, arguments);
    },


    dispose: function() {
      return this._dispose.apply(this, arguments);
    },


    isDisposed: function() {
      return this._stateGuard.applied("disposed");
    },


    _publish: function(sentinel, msg) {
      this._stateGuard.deny("disposed");

      if (this._sentinel !== sentinel) {
        throw new Error("Invalid sentinel provided; publisher must have same sentinel provided during instantiation.");
      }
      this._dispatch(msg);
      return true;
    },


    _subscribe: function(handler) {
      this._stateGuard.deny("disposed");

      var sub = new Subscription(this, handler),
          id  = sub.id();

      this._subscriptions = M.assoc(this._subscriptions, id, sub);

      return sub;
    },


    _dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      // Gnarly, as this hops back and forth between the channel and the sub, but
      // easier than splitting the dispose logic into two methods in the sub.
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispose();
      });

      this._subscriptions = M.hash_map();

      this._stateGuard.apply("disposed");
    },


    _dispatch: function(msg) {
      M.each(this._subscriptions, function(pair) {
        M.nth(pair, 1).dispatch(msg);
      });
    },


    _disposeHandle: function(id) {
      this._subscriptions = M.dissoc(this._subscriptions, id);
    }
  });

  var Subscription = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Subscription.prototype, {
    initialize: function(channel, handler) {
      this._id         = UUID.v4();
      this._channel    = channel;
      this._handler    = handler;
      this._stateGuard = new StateGuard(["disposed"]);

      _.bindAll(this, "dispose");
    },


    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._channel._disposeHandle(this._id);

      this._handler = null;
      this._channel = null;

      this._stateGuard.apply("disposed");
    },


    id: function() {
      return this._id;
    },


    dispatch: function(msg) {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._handler(msg);
    }
  });

  return Channel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../uuid"),
  require("../options"),
  require("../state-guard")
);

})()
},{"../uuid":39,"../options":8,"../state-guard":10,"underscore":61,"mori":63}],32:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  // FIXME: Delete this in favor of CompositeChannel
  var ChainedChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ChainedChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      _.bindAll(this, "_forward");
      this._chainedSubs = M.vector();

      var initiallyChainedTo = opts.getOrElse("chainTo");
      if (initiallyChainedTo) {
        this.chainTo(initiallyChainedTo);
      }
    },

    chainTo: function(otherChannel) {
      this._chainedSubs = M.conj(this._chainedSubs, otherChannel.subscribe(this._forward));
    },

    dispose: function() {
      var subs = this._chainedSubs;

      this._chainedSubs = M.vector();

      M.each(subs, function(sub) {
        sub.dispose();
      });

      return this._dispose.apply(this, arguments);
    },

    _forward: function(msg) {
      this._publish(this._sentinel, msg);
    }
  });

  return ChainedChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":8,"./channel":31,"underscore":61,"mori":63}],33:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  M,
  Options,
  Channel
) {

  /**
   * A channel which listens to other channels, and forwards their messages as through published to this channel
   *
   */
  var CompositeChannel = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(CompositeChannel.prototype, Channel.prototype, {
    initialize: function(opts) {
      Channel.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);

      this._forwarding = M.hash_map();

      var listen = opts.getOrElse("listen", []);
      if (!_.isArray(listen)) {
        listen = [listen];
      }

      _.each(listen, _.bind(function(c) {
        this.listen(c);
      }, this));
    },


    dispose: function() {
      Channel.prototype.dispose.apply(this, arguments);
      var forwarding = this._forwarding;
      this._forwarding = M.hash_map();

      M.each(forwarding, _.bind(function(pair) {
        M.nth(pair, 1).dispose();
      }, this));
    },


    listen: function(channel) {
      var sub = channel.subscribe(_.bind(function(msg) {
        this._forward(msg)
      }, this));
      this._forwarding = M.assoc(this._forwarding, channel, sub);

      return {
        dispose: _.bind(function() {
          this._forwarding = M.dissoc(this._forwarding, channel);
          sub.dispose();
        }, this)
      };
    },


    _forward: function(msg) {
      this.publish(this._sentinel, msg);
    }
  });

  return CompositeChannel;
};

module.exports = mod(
  require("underscore"),
  require("mori"),
  require("../options"),
  require("./channel")
);

})()
},{"../options":8,"./channel":31,"underscore":61,"mori":63}],36:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  StateGuard,
  Logger
) {

  /**
   * A fiber dictates how an Exchange's messages are actually sent. When someone requests a mailbox from an Exchange,
   * that exchange registers itself as an entity with that address on the mailbox's behalf. When a message for that
   * address is received by the fiber, it routes it to the exchange, which forwards it to the mailbox, and onward.
   *
   * There's a picture in `Courier` that illustrates the component layout.
   *
   * An `InMemoryFiber` only has local entities, and only performs local dispatch. A `LinkableFiber` is an
   * `InMemoryFiber` which will forward messages to its linked fibers in the event a local entity hasn't been
   * registered with the address for which a message is bound.
   */
  var InMemoryFiber = (function() {
    var Klass = function() {
      this.initialize.apply(this, arguments);
    };

    var Log = Logger.create("InMemoryLogger");

    _.extend(Klass.prototype, {
      initialize: function(opts) {
        opts = Options.fromObject(opts);

        this._entities = M.hash_map();
        this._identity = opts.getOrElse("identity", UUID.v4());

        this._stateGuard = new StateGuard(["disposed"]);

        _.bindAll(this, "_receive");
      },


      id: function() {
        return this._identity;
      },


      dispose: function() {
        if (this._stateGuard.applied("disposed")) {
          return;
        }
        this._dispose();
        this._stateGuard.apply("disposed");
      },

      _dispose: function() {

        var entities = this._entities;
        M.each(entities, function(pair) {
          M.nth(pair, 1).dispose();
        });

        this._entities = null;
      },

      registerEntity: function(opts) {
        opts = Options.fromObject(opts);

        var identity = opts.getOrError("identity"),
            entity   = new LocalEntity({
              identity: identity,
              delegate: opts.getOrError("delegate")
            });

        this._entities = M.assoc(this._entities, identity, entity);
        return true;
      },

      /**
       * Returns a promise which is fulfilled when the message is
       * sent, not received by the remote end. This to let the
       * caller know whether or not the message is stuck
       * in a buffer somewhere when calculating its timeouts.
       */
      send: Promise.method(function(opts) {
        this._stateGuard.deny("disposed");

        opts = Options.fromObject(opts);
        var from   = opts.getOrError("from"),
            to     = opts.getOrError("to"),
            body   = opts.getOrError("body"),
            msgId  = opts.getOrError("msgId"),

            mT     = opts.getOrElse("mT"),
            rMsgId = opts.getOrElse("rMsgId");


        //XXX: This is in-memory, so it's as simple
        // as invoking _receive in a future call stack
        return Promise
          .bind(this)
          .then(function() {
            _.defer(this._receive, {
              from:   from,
              to:     to,
              body:   body,
              msgId:  msgId,
              mT:     mT,
              rMsgId: rMsgId,
              oFib:   this._identity
            });
          })
          .then(function() {
            return msgId;
          });
      }),

      _receive: function(env) {
        if (this._stateGuard.applied("disposed")) {
          return;
        }

        env = Options.fromObject(env);
        var to, from, body, msgId, originFiber, mT, rMsgId;

        try {
          to          = env.getOrError("to");
          from        = env.getOrError("from");
          body        = env.getOrError("body");
          msgId       = env.getOrError("msgId");

          // Future-proofing for multi-fiber fabric.
          originFiber = env.getOrError("oFib");

          mT     = env.getOrElse("mT");
          rMsgId = env.getOrElse("rMsgId");
        } catch (e) {
          Log.error("Received malformed message", env);
        }

        var entity = M.get(this._entities, to);

        if (entity) {
          entity.dispatch({
            to:     to,
            from:   from,
            body:   body,
            msgId:  msgId,
            rMsgId: rMsgId,
            oFib:   originFiber,
            hFib:   this._identity,
            mT: mT
          });
        }
      }
    });

    return Klass;
  })();



  var LocalEntity = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LocalEntity.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._identity = opts.getOrError("identity");
      this._delegate = opts.getOrError("delegate");
      this._stateGuard = new StateGuard(["disposed"]);
    },
    dispose: function() {
      if (this._stateGuard.applied("disposed")) {
        return;
      }

      this._delegate = null;

      this._stateGuard.apply("disposed");
    },
    dispatch: function(env) {
      this._stateGuard.deny("disposed");

      this._delegate.receiveFiberMessage(env);
    }
  });

  return InMemoryFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/state-guard"),
  require("../../core/logging/logger")
);

})()
},{"../../core/options":8,"../../core/uuid":39,"../../core/state-guard":10,"../../core/logging/logger":29,"underscore":61,"bluebird":62,"mori":63}],37:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  InMemoryFiber,
  Channel,
  CompositeChannel
) {

  /**
   * LinkableFiber is a reference implementation for implementing a multi-fiber "fabric". Whereas an `InMemoryFiber`
   * only has local entities, and only performs local dispatch, a `LinkableFiber` is an `InMemoryFiber` which will
   * forward messages to its linked fibers in the event a local entity hasn't been registered with the address for
   * which a message is bound.
   *
   * For an example of how this might work in a multi-process or multi-machine environment, see the
   * `thicket-zmq-fiber` node module.
   */
  var LinkableFiber = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(LinkableFiber.prototype, InMemoryFiber.prototype, {
    initialize: function(opts) {
      InMemoryFiber.prototype.initialize.apply(this, arguments);
      opts = Options.fromObject(opts);


      this._localDispatch  = new Channel({ sentinel: this });
      this._ingressChannel = new CompositeChannel({
        sentinel: this,
        listen:   this._localDispatch
      });

      this._egressChannel  = new Channel({ sentinel: this });

      // _receive is defined and bound in InMemoryFiber ("protected" method)
      this._ingressChannel.subscribe(this._receive);
    },


    listen: function(channel) {
      this._ingressChannel.listen(channel);
    },


    egressChannel: function() {
      return this._egressChannel;
    },


    _dispose: function() {
      InMemoryFiber.prototype._dispose.apply(this, arguments);
    },

    send: Promise.method(function(opts) {
      this._stateGuard.deny("disposed");

      opts = Options.fromObject(opts);

      var from   = opts.getOrError("from"),
          to     = opts.getOrError("to"),
          body   = opts.getOrError("body"),
          msgId  = opts.getOrError("msgId"),
          mT     = opts.getOrElse("mT"),
          rMsgId = opts.getOrElse("rMsgId"),
          chan   = null;

      var msg = {
        from:   from,
        to:     to,
        body:   body,
        msgId:  msgId,
        mT:     mT,
        rMsgId: rMsgId,
        oFib:   this._identity
      };

      // Local dispatch, skip the round-trip
      if (M.get(this._entities, to)) {
        chan = this._localDispatch;
      } else {
        chan = this._egressChannel;
      }

      _.defer(_.bind(function() {
        chan.publish(this, msg);
      }, this));

      return msgId;
    })


  });

  return LinkableFiber;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("./in-memory-fiber"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel")
);

})()
},{"../../core/options":8,"./in-memory-fiber":36,"../../core/channel/channel":31,"../../core/channel/composite-channel":33,"underscore":61,"bluebird":62,"mori":63}],38:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A 'serde' is a thing that can "ser"-ialize and "de"-erialize an object. This one just does JSON, and ignores
   * any additional options.
   *
   *
   */
  var JSONSerde = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(JSONSerde.prototype, {
    initialize: function() {},

    serialize: function(payload, opts) {
      return JSON.stringify(payload);
    },

    deserialize: function(payload, opts) {
      return JSON.parse(payload);
    }
  });

  return JSONSerde;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],40:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  MethodSpec
) {

  var ClientSpec = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ClientSpec.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._methodSpecs = _.reduce(opts.getOrElse("methods", {}), function(memo, spec, name) {
        memo[name] = new MethodSpec(spec);
        return memo;
      }, {});
      this._initOptions = opts.getOrElse("initOptions", {});
    },

    methods: function() {
      return this._methodSpecs;
    },

    initOptions: function() {
      return this._initOptions;
    }
  });

  return ClientSpec;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options"),
  require("./method-spec")
);

})()
},{"../../core/options":8,"./method-spec":58,"underscore":61}],41:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  BaseClient
) {

  var ClientBuilder = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ClientBuilder.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._spec = opts.getOrError("spec");
    },

    build: function(opts) {
      var c = new BaseClient(_.extend({}, this._spec.initOptions(), opts));
      _.each(this._spec.methods(), function(spec, name) {
        c.__registerMethod(name, spec);
      });
      return c;
    }
  });

  return ClientBuilder;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options"),
  require("./base-client")
);

})()
},{"../../core/options":8,"./base-client":57,"underscore":61}],45:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Ref,
  DelegatingRef
) {

  var helper = function(val) {
    return new Ref(val);
  };

  helper.delegating = function(ref) {
    return new DelegatingRef(ref);
  };

  return helper;
};

module.exports = mod(
  require("underscore"),
  require("./ref"),
  require("./delegating-ref")
);

})()
},{"./ref":54,"./delegating-ref":53,"underscore":61}],62:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Promise = require("./promise.js")();
module.exports = Promise;
},{"./promise.js":64}],30:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  /**
   * An appender which logs to the global `console`.
   *
   */
  var ConsoleLogAppender = function() {
    this.initialize.apply(this, arguments);
  };

  var p = function(num) {
    if (("" + num).length === 1) {
      return "0" + num;
    } else {
      return num;
    }
  };

  _.extend(ConsoleLogAppender.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._console = opts.getOrElse("console", console);
      this._timeDelegate = opts.getOrElse("timeDelegate", function(){
        var d = new Date();
        return [d.getUTCFullYear(), p(d.getUTCMonth()), p(d.getUTCDay())].join("/") +
          " " + [p(d.getUTCHours()), p(d.getUTCMinutes()), p(d.getUTCSeconds())].join(":") +
          "." + d.getUTCMilliseconds();
      });
    },

    log: function(loggerName, descendants, logLevel, logLevelName, args) {
      // Use the furthest ancestor as the logged name (since it originated there)
      var furthestAncestor = descendants[descendants.length - 1];
      if (furthestAncestor) {
        loggerName = furthestAncestor;
      }
      this._log(["["+logLevelName+"]["+this._getTime()+"]["+loggerName+"]"].concat(args));
    },

    _getTime: function() {
      return this._timeDelegate();
    },

    _log: function(logItems) {
      // Why does he do this? Is he insane? Well, yes.
      //
      // But mostly, I do this because console.log isn't, in all cases,
      // something you can call .apply on. Last I checked, in IE calling
      // console.log.apply(console, []) will throw an error. So that's why the
      // big ugly switch.
      //
      // If you need more than 7 items, well, I can't help you (but you can - add another
      // switch case).
      switch(logItems.length) {
        case 0:
          this._console.log();
          break;
        case 1:
          this._console.log(logItems[0]);
          break;
        case 2:
          this._console.log(logItems[0], logItems[1]);
          break;
        case 3:
          this._console.log(logItems[0], logItems[1], logItems[2]);
          break;
        case 4:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3]);
          break;
        case 5:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4]);
          break;
        case 6:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5]);
          break;
        case 7:
          this._console.log(logItems[0], logItems[1], logItems[2], logItems[3], logItems[4], logItems[5], logItems[6]);
          break;
        default:
          var label = logItems.shift();
          this._console.log(label, logItems);
      }
    }
  });

  return ConsoleLogAppender;
};

module.exports = mod(
  require("underscore"),
  require("../../options")
);

})()
},{"../../options":8,"underscore":61}],47:[function(require,module,exports){
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger,
  ConfigurationMagic,
  AppContainer
) {
  var Log = Logger.create("Bootstrapper");

  var Bootstrapper = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Bootstrapper.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._configs = opts.getOrError("configurations");
      this._scopes = opts.getOrError("scopes");
      this._appKlass = opts.getOrError("applicationConstructor");
    },
    bootstrap: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          var config       = ConfigurationMagic.resolveConfig(this._scopes, this._configs),
              AppKlass     = this._appKlass;

          Log.info("Using resolved configuration: ", JSON.stringify(config));

          var app          = new AppKlass({configuration: config}),
              appContainer = new AppContainer({app: app});

          return appContainer;
        });
    })
  });

  return Bootstrapper;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger"),
  require("./configuration-magic"),
  require("./web-app-container")
);

},{"../core/options":8,"../core/logging/logger":29,"./configuration-magic":25,"./web-app-container":48,"underscore":61,"bluebird":62}],48:[function(require,module,exports){
(function(){/*global require: false, module: false, process: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Logger
) {

  var Log = Logger.create("AppContainer");

  var WebAppContainer = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebAppContainer.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts)
      this._app = opts.getOrError("app");
    },

    start: Promise.method(function() {
      return Promise
        .bind(this)
        .then(function() {
          return this._app.start();
        });
    }),

    stop: Promise.method(function(reason) {
      return this._app.stop().then(function() {
        if (reason) {
          Log.error("Stopping due to reason:", reason);
        }
      });
    })
  });

  return WebAppContainer;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../core/options"),
  require("../core/logging/logger")
);

})()
},{"../core/options":8,"../core/logging/logger":29,"underscore":61,"bluebird":62}],49:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var WebScheduler = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(WebScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },

    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return WebScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":61}],51:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options,
  Ref,
  SetTimeoutScheduler
) {

  var DefaultRuntime = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DefaultRuntime.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._schedulerRef = Ref(opts.getOrElseFn("scheduler", function() {
        return new SetTimeoutScheduler();
      }));
    },

    /**
     * @returns {Ref<Scheduler>}
     */
    scheduler: function() {
      return Ref.delegating(this._schedulerRef);
    },

    setScheduler: function(scheduler) {
      this._schedulerRef.set(scheduler);
    }
  });

  return DefaultRuntime;
};

module.exports = mod(
  require("underscore"),
  require("../core/options"),
  require("../core/ref"),
  require("../core/scheduler/set-timeout-scheduler")
);

})()
},{"../core/options":8,"../core/scheduler/set-timeout-scheduler":55,"../core/ref":45,"underscore":61}],60:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Options
) {

  var StoreEntry = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(StoreEntry.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      // Perfectly acceptable to pass in undefined...
      this._value = opts.getOrElse("value", undefined);
      this._lastSequence = opts.getOrError("initialSequence");

      this._ttl = opts.getOrElse("ttl");
    },

    isExpired: function(sequence, fallbackTtl) {
      var ttl = this._ttl || fallbackTtl;
      if (!ttl) {
        throw new Error("No TTL specified!");
      }
      // E.g., lastSequence = 4, ttl = 1, sequence = 5: expired
      //       lastSequence = 4, ttl = 1, sequence = 4: not expired
      //       lastSequence = 4, ttl = 2, sequence = 5: not expired
      return !(this._lastSequence + ttl > sequence);
    },

    touch: function(sequence) {
      this._lastSequence = sequence;
    },

    update: function(val, sequence, opts) {
      this._value        = val;
      this._lastSequence = sequence;

      opts = Options.fromObject(opts);
      this._ttl = opts.getOrElse("ttl");
    },

    dispose: function() {
      this._value        = null;
      this._lastSequence = null;
    },

    value: function() {
      return this._value;
    }
  });

  return StoreEntry;
};

module.exports = mod(
  require("underscore"),
  require("../../core/options")
);

})()
},{"../../core/options":8,"underscore":61}],52:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Logger,
  Options
) {

  var TEN_MINUTES_IN_MILLISECONDS = 60 * 1000 * 10;

  var Log = Logger.create("ProcessKeepAlive");

  /**
   * Keeps a (node) process "alive" by keeping at least one bit of (noop) work scheduled for execution.
   *
   * @constructor
   */
  var ProcessKeepAlive = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(ProcessKeepAlive.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._scheduler = opts.getOrError("scheduler");
      this._timeoutId = null;

      _.bindAll(this, "_cycle");
    },
    start: function() {
      Log.debug("Starting ProcessKeepAlive");
      this._cycle();
    },
    stop: function() {
      Log.debug("Stopping ProcessKeepAlive");
      if (this._timeoutId) {
        this._scheduler.get().unschedule(this._timeoutId);
        this._timeoutId = null;
      }
    },
    _cycle: function() {
      this._timeoutId = this._scheduler.get().schedule(
        this._cycle,
        TEN_MINUTES_IN_MILLISECONDS
      );
    }
  });

  return ProcessKeepAlive;
};

module.exports = mod(
  require("underscore"),
  require("../../core/logging/logger"),
  require("../../core/options")
);

})()
},{"../../core/logging/logger":29,"../../core/options":8,"underscore":61}],56:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  M,
  Options,
  UUID,
  ChainedChannel,
  Channel,
  CompositeChannel,
  StateGuard
) {


  var Mailbox = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Mailbox.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);
      this._id                    = UUID.v4();
      this._ownerIdentity         = opts.getOrError("ownerIdentity");
      this._exchange              = opts.getOrError("exchange");
      this._oneShotChannel        = new Channel({ sentinel: this });
      this._requestReplyChannel   = new Channel({ sentinel: this });
      this._ingressChannel        = new CompositeChannel({
        sentinel: this,
        listen: [this._oneShotChannel, this._requestReplyChannel]
      });
      this._stateGuard            = new StateGuard(["disposed"]);

      this._outstandingRequestIds = M.set();
    },

    id: function() {
      return this._id;
    },

    ownerIdentity: function() {
      return this._ownerIdentity;
    },

    dispose: function() {
      if (this._stateGuard.applied("disposed")){
        return;
      }

      this._oneShotChannel.dispose();
      this._requestReplyChannel.dispose();
      this._ingressChannel.dispose();

      // Attempt to cancel all outstanding requests.
      // This is an async request, so we just have to fire and
      // forge them.
      //
      // If you're disposing of a mailbox before requests
      // complete, you might have a bad time. The good
      // news is because responses are ferried back from the fiber
      // to the mailbox caller via the Promise interface rather
      // than channels, they should still get CancellationErrors
      var reqs = this._outstandingRequestIds;
      this._outstandingRequestIds = M.set();

      M.each(reqs, _.bind(function(reqId) {
        this._exchange.cancelSendAndReceive(reqId);
      }, this));

      this._oneShotChannel      = null;
      this._requestReplyChannel = null;
      this._ingressChannel      = null;

      this._stateGuard.apply("disposed");
    },

    /**
     * Returns a new ChainedChannel chained to this Mailbox's
     * privately-owned inbound Channel.
     * @returns {ChainedChannel}
     */
    ingressChannel: function() {
      return this._ingressChannel;
    },

    oneShotChannel: function() {
      return this._oneShotChannel;
    },

    requestReplyChannel: function() {
      return this._requestReplyChannel;
    },

    send: Promise.method(function(env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });
      return this._exchange.send(env);
    }),

    reply: Promise.method(function(msgId, env) {
      this._stateGuard.deny("disposed");

      env = _.extend({}, env || {}, {
        rMsgId: msgId,
        from: this._ownerIdentity
      });

      return this._exchange.reply(env);
    }),

    sendAndReceive: Promise.method(function(env, opts) {
      this._stateGuard.deny("disposed");

      var reqId = (opts || {}).reqId || UUID.v4();

      env = _.extend({}, env || {}, {
        from: this._ownerIdentity
      });

      opts = _.extend({}, opts || {}, {
        reqId: reqId
      });

      this._outstandingRequestIds = M.conj(this._outstandingRequestIds, reqId);

      return this._exchange
        .sendAndReceive(env, opts)
        .bind(this)
        .then(function(resp) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          return resp;
        })
        .caught(Promise.CancellationError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        })
        .caught(Promise.TimeoutError, function(err) {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
          throw err;
        });
    }),


    outstandingRequestCount: function() {
      return M.count(this._outstandingRequestIds);
    },


    cancelSendAndReceive: Promise.method(function(reqId) {
      return this._exchange
        .cancelSendAndReceive(reqId)
        .bind(this)
        .then(function() {
          this._outstandingRequestIds = M.disj(this._outstandingRequestIds, reqId);
        });
    }),

    _receiveOneShot: function(msg) {
      this._oneShotChannel.publish(this, msg);
    },

    _receiveRequestReply: function(msg) {
      this._requestReplyChannel.publish(this, msg);
    }
  });

  return Mailbox;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("mori"),
  require("../../core/options"),
  require("../../core/uuid"),
  require("../../core/channel/chained-channel"),
  require("../../core/channel/channel"),
  require("../../core/channel/composite-channel"),
  require("../../core/state-guard")
);

})()
},{"../../core/options":8,"../../core/uuid":39,"../../core/channel/chained-channel":32,"../../core/channel/channel":31,"../../core/channel/composite-channel":33,"../../core/state-guard":10,"bluebird":62,"underscore":61,"mori":63}],57:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _,
  Promise,
  Options,
  Lang,
  UUID,
  Courier
) {

  var BaseClient = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(BaseClient.prototype, {
    initialize: function(opts) {
      opts = Options.fromObject(opts);

      this._exchange = opts.getOrError("exchange");
      this._identity = opts.getOrElseFn("identity", function() {
        return UUID.v4();
      });
      this._serviceIdentity = opts.getOrError("serviceIdentity");
      this._mailbox         = this._exchange.mailbox(this._identity);
      this._courier         = new Courier({
        delegate: this,
        mailbox: this._mailbox
      });
    },

    __registerMethod: function(name, methodSpec) {
      var args          = methodSpec.args(),
          defaults      = methodSpec.defaults(),
          mType         = methodSpec.mType() || name,
          courierMethod = methodSpec.requestReply() ? "sendAndReceive" : "send";

      var getArgs = _.bind(function(defaults, methodArgs) {
        var finalArgs = {}, argName, argVal;
        for (var i = 0; i < args.length; i++) {
          argName = args[i];
          argVal = methodArgs[i];
          if (typeof argVal === "undefined") {
            if (defaults.hasOwnProperty(argName)) {
              finalArgs[argName] = defaults[argName];
            } else {
              throw new Error.ArgumentMissingError("argument missing: " + argName);
            }
          } else {
            finalArgs[argName] = argVal;
          }
        }
        return finalArgs;
      }, null, defaults);

      this[name] = Promise.method(_.bind(function() {
        var msg = _.extend({
          mT: mType
        }, getArgs(_.toArray(arguments)));
        return this._courier[courierMethod](this._serviceIdentity, msg);
      }, this));

    }
  });

  var Error = {
    ArgumentMissingError: Lang.makeErrorClass("ArgumentMissingError", "argument missing")
  };

  BaseClient.Error = Error;

  return BaseClient;
};

module.exports = mod(
  require("underscore"),
  require("bluebird"),
  require("../../core/options"),
  require("../../core/lang"),
  require("../../core/uuid"),
  require("../../messaging/courier")
);

})()
},{"../../core/options":8,"../../core/lang":9,"../../core/uuid":39,"../../messaging/courier":35,"underscore":61,"bluebird":62}],65:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    if (canPost) {
        var queue = [];
        window.addEventListener('message', function (ev) {
            var source = ev.source;
            if ((source === window || source === null) && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

process.binding = function (name) {
    throw new Error('process.binding is not supported');
}

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],64:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var old;
if (typeof Promise !== "undefined") old = Promise;
function noConflict(bluebird) {
    try { if (Promise === bluebird) Promise = old; }
    catch (e) {}
    return bluebird;
}
module.exports = function() {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");

var INTERNAL = function(){};
var APPLY = {};
var NEXT_FILTER = {e: null};

var cast = require("./thenables.js")(Promise, INTERNAL);
var PromiseArray = require("./promise_array.js")(Promise, INTERNAL, cast);
var CapturedTrace = require("./captured_trace.js")();
var CatchFilter = require("./catch_filter.js")(NEXT_FILTER);
var PromiseResolver = require("./promise_resolver.js");

var isArray = util.isArray;

var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var tryCatch2 = util.tryCatch2;
var tryCatchApply = util.tryCatchApply;
var RangeError = errors.RangeError;
var TypeError = errors.TypeError;
var CancellationError = errors.CancellationError;
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var originatesFromRejection = errors.originatesFromRejection;
var markAsOriginatingFromRejection = errors.markAsOriginatingFromRejection;
var canAttach = errors.canAttach;
var thrower = util.thrower;
var apiRejection = require("./errors_api_rejection")(Promise);


var makeSelfResolutionError = function Promise$_makeSelfResolutionError() {
    return new TypeError("circular promise resolution chain");
};

function Promise(resolver) {
    if (typeof resolver !== "function") {
        throw new TypeError("the promise constructor requires a resolver function");
    }
    if (this.constructor !== Promise) {
        throw new TypeError("the promise constructor cannot be invoked directly");
    }
    this._bitField = 0;
    this._fulfillmentHandler0 = void 0;
    this._rejectionHandler0 = void 0;
    this._promise0 = void 0;
    this._receiver0 = void 0;
    this._settledValue = void 0;
    this._boundTo = void 0;
    if (resolver !== INTERNAL) this._resolveFromResolver(resolver);
}

Promise.prototype.bind = function Promise$bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._follow(this);
    ret._propagateFrom(this, 2 | 1);
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.prototype.toString = function Promise$toString() {
    return "[object Promise]";
};

Promise.prototype.caught = Promise.prototype["catch"] =
function Promise$catch(fn) {
    var len = arguments.length;
    if (len > 1) {
        var catchInstances = new Array(len - 1),
            j = 0, i;
        for (i = 0; i < len - 1; ++i) {
            var item = arguments[i];
            if (typeof item === "function") {
                catchInstances[j++] = item;
            } else {
                var catchFilterTypeError =
                    new TypeError(
                        "A catch filter must be an error constructor "
                        + "or a filter function");

                this._attachExtraTrace(catchFilterTypeError);
                async.invoke(this._reject, this, catchFilterTypeError);
                return;
            }
        }
        catchInstances.length = j;
        fn = arguments[i];

        this._resetTrace();
        var catchFilter = new CatchFilter(catchInstances, fn, this);
        return this._then(void 0, catchFilter.doFilter, void 0,
            catchFilter, void 0);
    }
    return this._then(void 0, fn, void 0, void 0, void 0);
};

Promise.prototype.then =
function Promise$then(didFulfill, didReject, didProgress) {
    return this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
};


Promise.prototype.done =
function Promise$done(didFulfill, didReject, didProgress) {
    var promise = this._then(didFulfill, didReject, didProgress,
        void 0, void 0);
    promise._setIsFinal();
};

Promise.prototype.spread = function Promise$spread(didFulfill, didReject) {
    return this._then(didFulfill, didReject, void 0,
        APPLY, void 0);
};

Promise.prototype.isCancellable = function Promise$isCancellable() {
    return !this.isResolved() &&
        this._cancellable();
};

Promise.prototype.toJSON = function Promise$toJSON() {
    var ret = {
        isFulfilled: false,
        isRejected: false,
        fulfillmentValue: void 0,
        rejectionReason: void 0
    };
    if (this.isFulfilled()) {
        ret.fulfillmentValue = this._settledValue;
        ret.isFulfilled = true;
    } else if (this.isRejected()) {
        ret.rejectionReason = this._settledValue;
        ret.isRejected = true;
    }
    return ret;
};

Promise.prototype.all = function Promise$all() {
    return new PromiseArray(this).promise();
};


Promise.is = function Promise$Is(val) {
    return val instanceof Promise;
};

Promise.all = function Promise$All(promises) {
    return new PromiseArray(promises).promise();
};

Promise.prototype.error = function Promise$_error(fn) {
    return this.caught(originatesFromRejection, fn);
};

Promise.prototype._resolveFromSyncValue =
function Promise$_resolveFromSyncValue(value) {
    if (value === errorObj) {
        this._cleanValues();
        this._setRejected();
        this._settledValue = value.e;
        this._ensurePossibleRejectionHandled();
    } else {
        var maybePromise = cast(value, void 0);
        if (maybePromise instanceof Promise) {
            this._follow(maybePromise);
        } else {
            this._cleanValues();
            this._setFulfilled();
            this._settledValue = value;
        }
    }
};

Promise.method = function Promise$_Method(fn) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    return function Promise$_method() {
        var value;
        switch(arguments.length) {
        case 0: value = tryCatch1(fn, this, void 0); break;
        case 1: value = tryCatch1(fn, this, arguments[0]); break;
        case 2: value = tryCatch2(fn, this, arguments[0], arguments[1]); break;
        default:
            var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
            value = tryCatchApply(fn, args, this); break;
        }
        var ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._resolveFromSyncValue(value);
        return ret;
    };
};

Promise.attempt = Promise["try"] = function Promise$_Try(fn, args, ctx) {
    if (typeof fn !== "function") {
        return apiRejection("fn must be a function");
    }
    var value = isArray(args)
        ? tryCatchApply(fn, args, ctx)
        : tryCatch1(fn, ctx, args);

    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._resolveFromSyncValue(value);
    return ret;
};

Promise.defer = Promise.pending = function Promise$Defer() {
    var promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    return new PromiseResolver(promise);
};

Promise.bind = function Promise$Bind(thisArg) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    ret._setFulfilled();
    ret._setBoundTo(thisArg);
    return ret;
};

Promise.cast = function Promise$_Cast(obj) {
    var ret = cast(obj, void 0);
    if (!(ret instanceof Promise)) {
        var val = ret;
        ret = new Promise(INTERNAL);
        ret._setTrace(void 0);
        ret._setFulfilled();
        ret._cleanValues();
        ret._settledValue = val;
    }
    return ret;
};

Promise.resolve = Promise.fulfilled = Promise.cast;

Promise.reject = Promise.rejected = function Promise$Reject(reason) {
    var ret = new Promise(INTERNAL);
    ret._setTrace(void 0);
    markAsOriginatingFromRejection(reason);
    ret._cleanValues();
    ret._setRejected();
    ret._settledValue = reason;
    if (!canAttach(reason)) {
        var trace = new Error(reason + "");
        ret._setCarriedStackTrace(trace);
    }
    ret._ensurePossibleRejectionHandled();
    return ret;
};

Promise.onPossiblyUnhandledRejection =
function Promise$OnPossiblyUnhandledRejection(fn) {
        CapturedTrace.possiblyUnhandledRejection = typeof fn === "function"
                                                    ? fn : void 0;
};

var unhandledRejectionHandled;
Promise.onUnhandledRejectionHandled =
function Promise$onUnhandledRejectionHandled(fn) {
    unhandledRejectionHandled = typeof fn === "function" ? fn : void 0;
};

var debugging = false || !!(
    typeof process !== "undefined" &&
    typeof process.execPath === "string" &&
    typeof process.env === "object" &&
    (process.env["BLUEBIRD_DEBUG"] ||
        process.env["NODE_ENV"] === "development")
);


Promise.longStackTraces = function Promise$LongStackTraces() {
    if (async.haveItemsQueued() &&
        debugging === false
   ) {
        throw new Error("cannot enable long stack traces after promises have been created");
    }
    debugging = CapturedTrace.isSupported();
};

Promise.hasLongStackTraces = function Promise$HasLongStackTraces() {
    return debugging && CapturedTrace.isSupported();
};

Promise.prototype._then =
function Promise$_then(
    didFulfill,
    didReject,
    didProgress,
    receiver,
    internalData
) {
    var haveInternalData = internalData !== void 0;
    var ret = haveInternalData ? internalData : new Promise(INTERNAL);

    if (!haveInternalData) {
        if (debugging) {
            var haveSameContext = this._peekContext() === this._traceParent;
            ret._traceParent = haveSameContext ? this._traceParent : this;
        }
        ret._propagateFrom(this, 7);
    }

    var callbackIndex =
        this._addCallbacks(didFulfill, didReject, didProgress, ret, receiver);

    if (this.isResolved()) {
        async.invoke(this._queueSettleAt, this, callbackIndex);
    }

    return ret;
};

Promise.prototype._length = function Promise$_length() {
    return this._bitField & 262143;
};

Promise.prototype._isFollowingOrFulfilledOrRejected =
function Promise$_isFollowingOrFulfilledOrRejected() {
    return (this._bitField & 939524096) > 0;
};

Promise.prototype._isFollowing = function Promise$_isFollowing() {
    return (this._bitField & 536870912) === 536870912;
};

Promise.prototype._setLength = function Promise$_setLength(len) {
    this._bitField = (this._bitField & -262144) |
        (len & 262143);
};

Promise.prototype._setFulfilled = function Promise$_setFulfilled() {
    this._bitField = this._bitField | 268435456;
};

Promise.prototype._setRejected = function Promise$_setRejected() {
    this._bitField = this._bitField | 134217728;
};

Promise.prototype._setFollowing = function Promise$_setFollowing() {
    this._bitField = this._bitField | 536870912;
};

Promise.prototype._setIsFinal = function Promise$_setIsFinal() {
    this._bitField = this._bitField | 33554432;
};

Promise.prototype._isFinal = function Promise$_isFinal() {
    return (this._bitField & 33554432) > 0;
};

Promise.prototype._cancellable = function Promise$_cancellable() {
    return (this._bitField & 67108864) > 0;
};

Promise.prototype._setCancellable = function Promise$_setCancellable() {
    this._bitField = this._bitField | 67108864;
};

Promise.prototype._unsetCancellable = function Promise$_unsetCancellable() {
    this._bitField = this._bitField & (~67108864);
};

Promise.prototype._setRejectionIsUnhandled =
function Promise$_setRejectionIsUnhandled() {
    this._bitField = this._bitField | 2097152;
};

Promise.prototype._unsetRejectionIsUnhandled =
function Promise$_unsetRejectionIsUnhandled() {
    this._bitField = this._bitField & (~2097152);
    if (this._isUnhandledRejectionNotified()) {
        this._unsetUnhandledRejectionIsNotified();
        this._notifyUnhandledRejectionIsHandled();
    }
};

Promise.prototype._isRejectionUnhandled =
function Promise$_isRejectionUnhandled() {
    return (this._bitField & 2097152) > 0;
};

Promise.prototype._setUnhandledRejectionIsNotified =
function Promise$_setUnhandledRejectionIsNotified() {
    this._bitField = this._bitField | 524288;
};

Promise.prototype._unsetUnhandledRejectionIsNotified =
function Promise$_unsetUnhandledRejectionIsNotified() {
    this._bitField = this._bitField & (~524288);
};

Promise.prototype._isUnhandledRejectionNotified =
function Promise$_isUnhandledRejectionNotified() {
    return (this._bitField & 524288) > 0;
};

Promise.prototype._setCarriedStackTrace =
function Promise$_setCarriedStackTrace(capturedTrace) {
    this._bitField = this._bitField | 1048576;
    this._fulfillmentHandler0 = capturedTrace;
};

Promise.prototype._unsetCarriedStackTrace =
function Promise$_unsetCarriedStackTrace() {
    this._bitField = this._bitField & (~1048576);
    this._fulfillmentHandler0 = void 0;
};

Promise.prototype._isCarryingStackTrace =
function Promise$_isCarryingStackTrace() {
    return (this._bitField & 1048576) > 0;
};

Promise.prototype._getCarriedStackTrace =
function Promise$_getCarriedStackTrace() {
    return this._isCarryingStackTrace()
        ? this._fulfillmentHandler0
        : void 0;
};

Promise.prototype._receiverAt = function Promise$_receiverAt(index) {
    var ret = index === 0
        ? this._receiver0
        : this[(index << 2) + index - 5 + 4];
    if (this._isBound() && ret === void 0) {
        return this._boundTo;
    }
    return ret;
};

Promise.prototype._promiseAt = function Promise$_promiseAt(index) {
    return index === 0
        ? this._promise0
        : this[(index << 2) + index - 5 + 3];
};

Promise.prototype._fulfillmentHandlerAt =
function Promise$_fulfillmentHandlerAt(index) {
    return index === 0
        ? this._fulfillmentHandler0
        : this[(index << 2) + index - 5 + 0];
};

Promise.prototype._rejectionHandlerAt =
function Promise$_rejectionHandlerAt(index) {
    return index === 0
        ? this._rejectionHandler0
        : this[(index << 2) + index - 5 + 1];
};

Promise.prototype._addCallbacks = function Promise$_addCallbacks(
    fulfill,
    reject,
    progress,
    promise,
    receiver
) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }

    if (index === 0) {
        this._promise0 = promise;
        if (receiver !== void 0) this._receiver0 = receiver;
        if (typeof fulfill === "function" && !this._isCarryingStackTrace())
            this._fulfillmentHandler0 = fulfill;
        if (typeof reject === "function") this._rejectionHandler0 = reject;
        if (typeof progress === "function") this._progressHandler0 = progress;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promise;
        this[base + 4] = receiver;
        this[base + 0] = typeof fulfill === "function"
                                            ? fulfill : void 0;
        this[base + 1] = typeof reject === "function"
                                            ? reject : void 0;
        this[base + 2] = typeof progress === "function"
                                            ? progress : void 0;
    }
    this._setLength(index + 1);
    return index;
};

Promise.prototype._setProxyHandlers =
function Promise$_setProxyHandlers(receiver, promiseSlotValue) {
    var index = this._length();

    if (index >= 262143 - 5) {
        index = 0;
        this._setLength(0);
    }
    if (index === 0) {
        this._promise0 = promiseSlotValue;
        this._receiver0 = receiver;
    } else {
        var base = (index << 2) + index - 5;
        this[base + 3] = promiseSlotValue;
        this[base + 4] = receiver;
        this[base + 0] =
        this[base + 1] =
        this[base + 2] = void 0;
    }
    this._setLength(index + 1);
};

Promise.prototype._proxyPromiseArray =
function Promise$_proxyPromiseArray(promiseArray, index) {
    this._setProxyHandlers(promiseArray, index);
};

Promise.prototype._proxyPromise = function Promise$_proxyPromise(promise) {
    promise._setProxied();
    this._setProxyHandlers(promise, -1);
};

Promise.prototype._setBoundTo = function Promise$_setBoundTo(obj) {
    if (obj !== void 0) {
        this._bitField = this._bitField | 8388608;
        this._boundTo = obj;
    } else {
        this._bitField = this._bitField & (~8388608);
    }
};

Promise.prototype._isBound = function Promise$_isBound() {
    return (this._bitField & 8388608) === 8388608;
};

Promise.prototype._resolveFromResolver =
function Promise$_resolveFromResolver(resolver) {
    var promise = this;
    this._setTrace(void 0);
    this._pushContext();

    function Promise$_resolver(val) {
        if (promise._tryFollow(val)) {
            return;
        }
        promise._fulfill(val);
    }
    function Promise$_rejecter(val) {
        var trace = canAttach(val) ? val : new Error(val + "");
        promise._attachExtraTrace(trace);
        markAsOriginatingFromRejection(val);
        promise._reject(val, trace === val ? void 0 : trace);
    }
    var r = tryCatch2(resolver, void 0, Promise$_resolver, Promise$_rejecter);
    this._popContext();

    if (r !== void 0 && r === errorObj) {
        var e = r.e;
        var trace = canAttach(e) ? e : new Error(e + "");
        promise._reject(e, trace);
    }
};

Promise.prototype._spreadSlowCase =
function Promise$_spreadSlowCase(targetFn, promise, values, boundTo) {
    var promiseForAll = new PromiseArray(values).promise();
    var promise2 = promiseForAll._then(function() {
        return targetFn.apply(boundTo, arguments);
    }, void 0, void 0, APPLY, void 0);
    promise._follow(promise2);
};

Promise.prototype._callSpread =
function Promise$_callSpread(handler, promise, value) {
    var boundTo = this._boundTo;
    if (isArray(value)) {
        for (var i = 0, len = value.length; i < len; ++i) {
            if (cast(value[i], void 0) instanceof Promise) {
                this._spreadSlowCase(handler, promise, value, boundTo);
                return;
            }
        }
    }
    promise._pushContext();
    return tryCatchApply(handler, value, boundTo);
};

Promise.prototype._callHandler =
function Promise$_callHandler(
    handler, receiver, promise, value) {
    var x;
    if (receiver === APPLY && !this.isRejected()) {
        x = this._callSpread(handler, promise, value);
    } else {
        promise._pushContext();
        x = tryCatch1(handler, receiver, value);
    }
    promise._popContext();
    return x;
};

Promise.prototype._settlePromiseFromHandler =
function Promise$_settlePromiseFromHandler(
    handler, receiver, value, promise
) {
    if (!(promise instanceof Promise)) {
        handler.call(receiver, value, promise);
        return;
    }
    var x = this._callHandler(handler, receiver, promise, value);
    if (promise._isFollowing()) return;

    if (x === errorObj || x === promise || x === NEXT_FILTER) {
        var err = x === promise
                    ? makeSelfResolutionError()
                    : x.e;
        var trace = canAttach(err) ? err : new Error(err + "");
        if (x !== NEXT_FILTER) promise._attachExtraTrace(trace);
        promise._rejectUnchecked(err, trace);
    } else {
        var castValue = cast(x, promise);
        if (castValue instanceof Promise) {
            if (castValue.isRejected() &&
                !castValue._isCarryingStackTrace() &&
                !canAttach(castValue._settledValue)) {
                var trace = new Error(castValue._settledValue + "");
                promise._attachExtraTrace(trace);
                castValue._setCarriedStackTrace(trace);
            }
            promise._follow(castValue);
            promise._propagateFrom(castValue, 1);
        } else {
            promise._fulfillUnchecked(x);
        }
    }
};

Promise.prototype._follow =
function Promise$_follow(promise) {
    this._setFollowing();

    if (promise.isPending()) {
        this._propagateFrom(promise, 1);
        promise._proxyPromise(this);
    } else if (promise.isFulfilled()) {
        this._fulfillUnchecked(promise._settledValue);
    } else {
        this._rejectUnchecked(promise._settledValue,
            promise._getCarriedStackTrace());
    }

    if (promise._isRejectionUnhandled()) promise._unsetRejectionIsUnhandled();

    if (debugging &&
        promise._traceParent == null) {
        promise._traceParent = this;
    }
};

Promise.prototype._tryFollow =
function Promise$_tryFollow(value) {
    if (this._isFollowingOrFulfilledOrRejected() ||
        value === this) {
        return false;
    }
    var maybePromise = cast(value, void 0);
    if (!(maybePromise instanceof Promise)) {
        return false;
    }
    this._follow(maybePromise);
    return true;
};

Promise.prototype._resetTrace = function Promise$_resetTrace() {
    if (debugging) {
        this._trace = new CapturedTrace(this._peekContext() === void 0);
    }
};

Promise.prototype._setTrace = function Promise$_setTrace(parent) {
    if (debugging) {
        var context = this._peekContext();
        this._traceParent = context;
        var isTopLevel = context === void 0;
        if (parent !== void 0 &&
            parent._traceParent === context) {
            this._trace = parent._trace;
        } else {
            this._trace = new CapturedTrace(isTopLevel);
        }
    }
    return this;
};

Promise.prototype._attachExtraTrace =
function Promise$_attachExtraTrace(error) {
    if (debugging) {
        var promise = this;
        var stack = error.stack;
        stack = typeof stack === "string" ? stack.split("\n") : [];
        CapturedTrace.protectErrorMessageNewlines(stack);
        var headerLineCount = 1;
        var combinedTraces = 1;
        while(promise != null &&
            promise._trace != null) {
            stack = CapturedTrace.combine(
                stack,
                promise._trace.stack.split("\n")
            );
            promise = promise._traceParent;
            combinedTraces++;
        }

        var stackTraceLimit = Error.stackTraceLimit || 10;
        var max = (stackTraceLimit + headerLineCount) * combinedTraces;
        var len = stack.length;
        if (len > max) {
            stack.length = max;
        }

        if (len > 0)
            stack[0] = stack[0].split("\u0002\u0000\u0001").join("\n");

        if (stack.length <= headerLineCount) {
            error.stack = "(No stack trace)";
        } else {
            error.stack = stack.join("\n");
        }
    }
};

Promise.prototype._cleanValues = function Promise$_cleanValues() {
    if (this._cancellable()) {
        this._cancellationParent = void 0;
    }
};

Promise.prototype._propagateFrom =
function Promise$_propagateFrom(parent, flags) {
    if ((flags & 1) > 0 && parent._cancellable()) {
        this._setCancellable();
        this._cancellationParent = parent;
    }
    if ((flags & 4) > 0) {
        this._setBoundTo(parent._boundTo);
    }
    if ((flags & 2) > 0) {
        this._setTrace(parent);
    }
};

Promise.prototype._fulfill = function Promise$_fulfill(value) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._fulfillUnchecked(value);
};

Promise.prototype._reject =
function Promise$_reject(reason, carriedStackTrace) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._rejectUnchecked(reason, carriedStackTrace);
};

Promise.prototype._settlePromiseAt = function Promise$_settlePromiseAt(index) {
    var handler = this.isFulfilled()
        ? this._fulfillmentHandlerAt(index)
        : this._rejectionHandlerAt(index);

    var value = this._settledValue;
    var receiver = this._receiverAt(index);
    var promise = this._promiseAt(index);

    if (typeof handler === "function") {
        this._settlePromiseFromHandler(handler, receiver, value, promise);
    } else {
        var done = false;
        var isFulfilled = this.isFulfilled();
        if (receiver !== void 0) {
            if (receiver instanceof Promise &&
                receiver._isProxied()) {
                receiver._unsetProxied();

                if (isFulfilled) receiver._fulfillUnchecked(value);
                else receiver._rejectUnchecked(value,
                    this._getCarriedStackTrace());
                done = true;
            } else if (receiver instanceof PromiseArray) {
                if (isFulfilled) receiver._promiseFulfilled(value, promise);
                else receiver._promiseRejected(value, promise);
                done = true;
            }
        }

        if (!done) {
            if (isFulfilled) promise._fulfill(value);
            else promise._reject(value, this._getCarriedStackTrace());
        }
    }

    if (index >= 256) {
        this._queueGC();
    }
};

Promise.prototype._isProxied = function Promise$_isProxied() {
    return (this._bitField & 4194304) === 4194304;
};

Promise.prototype._setProxied = function Promise$_setProxied() {
    this._bitField = this._bitField | 4194304;
};

Promise.prototype._unsetProxied = function Promise$_unsetProxied() {
    this._bitField = this._bitField & (~4194304);
};

Promise.prototype._isGcQueued = function Promise$_isGcQueued() {
    return (this._bitField & -1073741824) === -1073741824;
};

Promise.prototype._setGcQueued = function Promise$_setGcQueued() {
    this._bitField = this._bitField | -1073741824;
};

Promise.prototype._unsetGcQueued = function Promise$_unsetGcQueued() {
    this._bitField = this._bitField & (~-1073741824);
};

Promise.prototype._queueGC = function Promise$_queueGC() {
    if (this._isGcQueued()) return;
    this._setGcQueued();
    async.invokeLater(this._gc, this, void 0);
};

Promise.prototype._gc = function Promise$gc() {
    var len = this._length() * 5;
    for (var i = 0; i < len; i++) {
        delete this[i];
    }
    this._setLength(0);
    this._unsetGcQueued();
};

Promise.prototype._queueSettleAt = function Promise$_queueSettleAt(index) {
    if (this._isRejectionUnhandled()) this._unsetRejectionIsUnhandled();
    async.invoke(this._settlePromiseAt, this, index);
};

Promise.prototype._fulfillUnchecked =
function Promise$_fulfillUnchecked(value) {
    if (!this.isPending()) return;
    if (value === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err, void 0);
    }
    this._cleanValues();
    this._setFulfilled();
    this._settledValue = value;
    var len = this._length();

    if (len > 0) {
        async.invoke(this._settlePromises, this, len);
    }
};

Promise.prototype._rejectUncheckedCheckError =
function Promise$_rejectUncheckedCheckError(reason) {
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._rejectUnchecked(reason, trace === reason ? void 0 : trace);
};

Promise.prototype._rejectUnchecked =
function Promise$_rejectUnchecked(reason, trace) {
    if (!this.isPending()) return;
    if (reason === this) {
        var err = makeSelfResolutionError();
        this._attachExtraTrace(err);
        return this._rejectUnchecked(err);
    }
    this._cleanValues();
    this._setRejected();
    this._settledValue = reason;

    if (this._isFinal()) {
        async.invokeLater(thrower, void 0, trace === void 0 ? reason : trace);
        return;
    }
    var len = this._length();

    if (trace !== void 0) this._setCarriedStackTrace(trace);

    if (len > 0) {
        async.invoke(this._rejectPromises, this, null);
    } else {
        this._ensurePossibleRejectionHandled();
    }
};

Promise.prototype._rejectPromises = function Promise$_rejectPromises() {
    this._settlePromises();
    this._unsetCarriedStackTrace();
};

Promise.prototype._settlePromises = function Promise$_settlePromises() {
    var len = this._length();
    for (var i = 0; i < len; i++) {
        this._settlePromiseAt(i);
    }
};

Promise.prototype._ensurePossibleRejectionHandled =
function Promise$_ensurePossibleRejectionHandled() {
    this._setRejectionIsUnhandled();
    if (CapturedTrace.possiblyUnhandledRejection !== void 0) {
        async.invokeLater(this._notifyUnhandledRejection, this, void 0);
    }
};

Promise.prototype._notifyUnhandledRejectionIsHandled =
function Promise$_notifyUnhandledRejectionIsHandled() {
    if (typeof unhandledRejectionHandled === "function") {
        async.invokeLater(unhandledRejectionHandled, void 0, this);
    }
};

Promise.prototype._notifyUnhandledRejection =
function Promise$_notifyUnhandledRejection() {
    if (this._isRejectionUnhandled()) {
        var reason = this._settledValue;
        var trace = this._getCarriedStackTrace();

        this._setUnhandledRejectionIsNotified();

        if (trace !== void 0) {
            this._unsetCarriedStackTrace();
            reason = trace;
        }
        if (typeof CapturedTrace.possiblyUnhandledRejection === "function") {
            CapturedTrace.possiblyUnhandledRejection(reason, this);
        }
    }
};

var contextStack = [];
Promise.prototype._peekContext = function Promise$_peekContext() {
    var lastIndex = contextStack.length - 1;
    if (lastIndex >= 0) {
        return contextStack[lastIndex];
    }
    return void 0;

};

Promise.prototype._pushContext = function Promise$_pushContext() {
    if (!debugging) return;
    contextStack.push(this);
};

Promise.prototype._popContext = function Promise$_popContext() {
    if (!debugging) return;
    contextStack.pop();
};

Promise.noConflict = function Promise$NoConflict() {
    return noConflict(Promise);
};

Promise.setScheduler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    async._schedule = fn;
};

if (!CapturedTrace.isSupported()) {
    Promise.longStackTraces = function(){};
    debugging = false;
}

Promise._makeSelfResolutionError = makeSelfResolutionError;
require("./finally.js")(Promise, NEXT_FILTER, cast);
require("./direct_resolve.js")(Promise);
require("./synchronous_inspection.js")(Promise);
require("./join.js")(Promise, PromiseArray, cast, INTERNAL);
Promise.RangeError = RangeError;
Promise.CancellationError = CancellationError;
Promise.TimeoutError = TimeoutError;
Promise.TypeError = TypeError;
Promise.OperationalError = OperationalError;
Promise.RejectionError = OperationalError;
Promise.AggregateError = errors.AggregateError;

util.toFastProperties(Promise);
util.toFastProperties(Promise.prototype);
Promise.Promise = Promise;
require('./timers.js')(Promise,INTERNAL,cast);
require('./race.js')(Promise,INTERNAL,cast);
require('./call_get.js')(Promise);
require('./generators.js')(Promise,apiRejection,INTERNAL,cast);
require('./map.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./nodeify.js')(Promise);
require('./promisify.js')(Promise,INTERNAL);
require('./props.js')(Promise,PromiseArray,cast);
require('./reduce.js')(Promise,PromiseArray,apiRejection,cast,INTERNAL);
require('./settle.js')(Promise,PromiseArray);
require('./some.js')(Promise,PromiseArray,apiRejection);
require('./progress.js')(Promise,PromiseArray);
require('./cancel.js')(Promise,INTERNAL);
require('./filter.js')(Promise,INTERNAL);
require('./any.js')(Promise,PromiseArray);
require('./each.js')(Promise,INTERNAL);
require('./using.js')(Promise,apiRejection,cast);

Promise.prototype = Promise.prototype;
return Promise;

};

})(require("__browserify_process"))
},{"./util.js":66,"./async.js":67,"./errors.js":68,"./thenables.js":69,"./promise_array.js":70,"./captured_trace.js":71,"./catch_filter.js":72,"./promise_resolver.js":73,"./finally.js":74,"./direct_resolve.js":75,"./synchronous_inspection.js":76,"./join.js":77,"./timers.js":78,"./race.js":79,"./call_get.js":80,"./generators.js":81,"./map.js":82,"./promisify.js":83,"./nodeify.js":84,"./props.js":85,"./reduce.js":86,"./settle.js":87,"./some.js":88,"./progress.js":89,"./cancel.js":90,"./filter.js":91,"./any.js":92,"./each.js":93,"./using.js":94,"./errors_api_rejection":95,"__browserify_process":65}],54:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A basic Ref serves as a means of indirection between references and their
   * values, allowing an outside agent to modify the underlying value.
   */
  var Ref = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(Ref.prototype, {
    initialize: function(val) {
      this._val = val;
    },

    /**
     * Return the value boxed by this Ref
     *
     * @returns {dynamic}
     */
    get: function() {
      return this._val;
    },

    /**
     * Set a new boxed value. Note this method is specific to this Ref
     * implementation, and not the Ref protocol, which only defines
     * `Ref#get()`.
     *
     * @param newVal {dynamic} the value to box
     */
    set: function(newVal) {
      if (newVal instanceof Ref) {
        this._val = newVal.get();
      } else {
        this._val = newVal;
      }
    }
  });

  return Ref;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],53:[function(require,module,exports){
(function(){/*global require: false, module: false */
"use strict";

var mod = function(
  _
) {

  /**
   * A ref whose boxed value is another ref
   */
  var DelegatingRef = function() {
    this.initialize.apply(this, arguments);
  };

  _.extend(DelegatingRef.prototype, {
    initialize: function(ref) {
      this._delegateRef = ref;
    },
    get: function() {
      return this._delegateRef.get();
    }
  });

  return DelegatingRef;
};

module.exports = mod(
  require("underscore")
);

})()
},{"underscore":61}],76:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
function PromiseInspection(promise) {
    if (promise !== void 0) {
        this._bitField = promise._bitField;
        this._settledValue = promise.isResolved()
            ? promise._settledValue
            : void 0;
    }
    else {
        this._bitField = 0;
        this._settledValue = void 0;
    }
}

PromiseInspection.prototype.isFulfilled =
Promise.prototype.isFulfilled = function Promise$isFulfilled() {
    return (this._bitField & 268435456) > 0;
};

PromiseInspection.prototype.isRejected =
Promise.prototype.isRejected = function Promise$isRejected() {
    return (this._bitField & 134217728) > 0;
};

PromiseInspection.prototype.isPending =
Promise.prototype.isPending = function Promise$isPending() {
    return (this._bitField & 402653184) === 0;
};

PromiseInspection.prototype.value =
Promise.prototype.value = function Promise$value() {
    if (!this.isFulfilled()) {
        throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.error =
PromiseInspection.prototype.reason =
Promise.prototype.reason = function Promise$reason() {
    if (!this.isRejected()) {
        throw new TypeError("cannot get rejection reason of a non-rejected promise");
    }
    return this._settledValue;
};

PromiseInspection.prototype.isResolved =
Promise.prototype.isResolved = function Promise$isResolved() {
    return (this._bitField & 402653184) > 0;
};

Promise.PromiseInspection = PromiseInspection;
};

},{}],91:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseMap = Promise.map;

Promise.prototype.filter = function Promise$filter(fn, options) {
    return PromiseMap(this, fn, options, INTERNAL);
};

Promise.filter = function Promise$Filter(promises, fn, options) {
    return PromiseMap(promises, fn, options, INTERNAL);
};
};

},{}],92:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var SomePromiseArray = Promise._SomePromiseArray;
function Promise$_Any(promises) {
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(1);
    ret.setUnwrap();
    ret.init();
    return promise;
}

Promise.any = function Promise$Any(promises) {
    return Promise$_Any(promises);
};

Promise.prototype.any = function Promise$any() {
    return Promise$_Any(this);
};

};

},{}],93:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var PromiseReduce = Promise.reduce;

Promise.prototype.each = function Promise$each(fn) {
    return PromiseReduce(this, fn, null, INTERNAL);
};

Promise.each = function Promise$Each(promises, fn) {
    return PromiseReduce(promises, fn, null, INTERNAL);
};
};

},{}],55:[function(require,module,exports){
"use strict";

var mod = function(
  _
) {

  var SetTimeoutScheduler = function() {
    this.initialize.apply(this, arguments);
  }

  _.extend(SetTimeoutScheduler.prototype, {
    initialize: function() {},

    runSoon: function(fn) {
      this.schedule(fn);
    },

    schedule: function(fn, delay) {
      delay = delay || 1;
      return setTimeout(fn, delay);
    },

    unschedule: function(id) {
      return clearTimeout(id);
    }
  });

  return SetTimeoutScheduler;
};

module.exports = mod(
  require("underscore")
);

},{"underscore":61}],66:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var es5 = require("./es5.js");
var haveGetters = (function(){
    try {
        var o = {};
        es5.defineProperty(o, "f", {
            get: function () {
                return 3;
            }
        });
        return o.f === 3;
    }
    catch (e) {
        return false;
    }

})();
var canEvaluate = typeof navigator == "undefined";
var errorObj = {e: {}};
function tryCatch1(fn, receiver, arg) {
    try { return fn.call(receiver, arg); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch2(fn, receiver, arg, arg2) {
    try { return fn.call(receiver, arg, arg2); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch3(fn, receiver, arg, arg2, arg3) {
    try { return fn.call(receiver, arg, arg2, arg3); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatch4(fn, receiver, arg, arg2, arg3, arg4) {
    try { return fn.call(receiver, arg, arg2, arg3, arg4); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

function tryCatchApply(fn, args, receiver) {
    try { return fn.apply(receiver, args); }
    catch (e) {
        errorObj.e = e;
        return errorObj;
    }
}

var inherits = function(Child, Parent) {
    var hasProp = {}.hasOwnProperty;

    function T() {
        this.constructor = Child;
        this.constructor$ = Parent;
        for (var propertyName in Parent.prototype) {
            if (hasProp.call(Parent.prototype, propertyName) &&
                propertyName.charAt(propertyName.length-1) !== "$"
           ) {
                this[propertyName + "$"] = Parent.prototype[propertyName];
            }
        }
    }
    T.prototype = Parent.prototype;
    Child.prototype = new T();
    return Child.prototype;
};

function asString(val) {
    return typeof val === "string" ? val : ("" + val);
}

function isPrimitive(val) {
    return val == null || val === true || val === false ||
        typeof val === "string" || typeof val === "number";

}

function isObject(value) {
    return !isPrimitive(value);
}

function maybeWrapAsError(maybeError) {
    if (!isPrimitive(maybeError)) return maybeError;

    return new Error(asString(maybeError));
}

function withAppended(target, appendee) {
    var len = target.length;
    var ret = new Array(len + 1);
    var i;
    for (i = 0; i < len; ++i) {
        ret[i] = target[i];
    }
    ret[i] = appendee;
    return ret;
}

function getDataPropertyOrDefault(obj, key, defaultValue) {
    if (es5.isES5) {
        var desc = Object.getOwnPropertyDescriptor(obj, key);
        if (desc != null) {
            return desc.get == null && desc.set == null
                    ? desc.value
                    : defaultValue;
        }
    } else {
        return {}.hasOwnProperty.call(obj, key) ? obj[key] : void 0;
    }
}

function notEnumerableProp(obj, name, value) {
    if (isPrimitive(obj)) return obj;
    var descriptor = {
        value: value,
        configurable: true,
        enumerable: false,
        writable: true
    };
    es5.defineProperty(obj, name, descriptor);
    return obj;
}


var wrapsPrimitiveReceiver = (function() {
    return this !== "string";
}).call("string");

function thrower(r) {
    throw r;
}

var inheritedDataKeys = (function() {
    if (es5.isES5) {
        return function(obj, opts) {
            var ret = [];
            var visitedKeys = Object.create(null);
            var getKeys = Object(opts).includeHidden
                ? Object.getOwnPropertyNames
                : Object.keys;
            while (obj != null) {
                var keys;
                try {
                    keys = getKeys(obj);
                } catch (e) {
                    return ret;
                }
                for (var i = 0; i < keys.length; ++i) {
                    var key = keys[i];
                    if (visitedKeys[key]) continue;
                    visitedKeys[key] = true;
                    var desc = Object.getOwnPropertyDescriptor(obj, key);
                    if (desc != null && desc.get == null && desc.set == null) {
                        ret.push(key);
                    }
                }
                obj = es5.getPrototypeOf(obj);
            }
            return ret;
        };
    } else {
        return function(obj) {
            var ret = [];
            /*jshint forin:false */
            for (var key in obj) {
                ret.push(key);
            }
            return ret;
        };
    }

})();

function isClass(fn) {
    try {
        if (typeof fn === "function") {
            var keys = es5.keys(fn.prototype);
            return keys.length > 0 &&
                   !(keys.length === 1 && keys[0] === "constructor");
        }
        return false;
    } catch (e) {
        return false;
    }
}

function toFastProperties(obj) {
    /*jshint -W027*/
    function f() {}
    f.prototype = obj;
    return f;
    eval(obj);
}

var rident = /^[a-z$_][a-z$_0-9]*$/i;
function isIdentifier(str) {
    return rident.test(str);
}

function filledRange(count, prefix, suffix) {
    var ret = new Array(count);
    for(var i = 0; i < count; ++i) {
        ret[i] = prefix + i + suffix;
    }
    return ret;
}

var ret = {
    isClass: isClass,
    isIdentifier: isIdentifier,
    inheritedDataKeys: inheritedDataKeys,
    getDataPropertyOrDefault: getDataPropertyOrDefault,
    thrower: thrower,
    isArray: es5.isArray,
    haveGetters: haveGetters,
    notEnumerableProp: notEnumerableProp,
    isPrimitive: isPrimitive,
    isObject: isObject,
    canEvaluate: canEvaluate,
    errorObj: errorObj,
    tryCatch1: tryCatch1,
    tryCatch2: tryCatch2,
    tryCatch3: tryCatch3,
    tryCatch4: tryCatch4,
    tryCatchApply: tryCatchApply,
    inherits: inherits,
    withAppended: withAppended,
    asString: asString,
    maybeWrapAsError: maybeWrapAsError,
    wrapsPrimitiveReceiver: wrapsPrimitiveReceiver,
    toFastProperties: toFastProperties,
    filledRange: filledRange
};

module.exports = ret;

},{"./es5.js":96}],67:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule = require("./schedule.js");
var Queue = require("./queue.js");
var errorObj = require("./util.js").errorObj;
var tryCatch1 = require("./util.js").tryCatch1;
var _process = typeof process !== "undefined" ? process : void 0;

function Async() {
    this._isTickUsed = false;
    this._schedule = schedule;
    this._length = 0;
    this._lateBuffer = new Queue(16);
    this._functionBuffer = new Queue(65536);
    var self = this;
    this.consumeFunctionBuffer = function Async$consumeFunctionBuffer() {
        self._consumeFunctionBuffer();
    };
}

Async.prototype.haveItemsQueued = function Async$haveItemsQueued() {
    return this._length > 0;
};

Async.prototype.invokeLater = function Async$invokeLater(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    this._lateBuffer.push(fn, receiver, arg);
    this._queueTick();
};

Async.prototype.invoke = function Async$invoke(fn, receiver, arg) {
    if (_process !== void 0 &&
        _process.domain != null &&
        !fn.domain) {
        fn = _process.domain.bind(fn);
    }
    var functionBuffer = this._functionBuffer;
    functionBuffer.push(fn, receiver, arg);
    this._length = functionBuffer.length();
    this._queueTick();
};

Async.prototype._consumeFunctionBuffer =
function Async$_consumeFunctionBuffer() {
    var functionBuffer = this._functionBuffer;
    while (functionBuffer.length() > 0) {
        var fn = functionBuffer.shift();
        var receiver = functionBuffer.shift();
        var arg = functionBuffer.shift();
        fn.call(receiver, arg);
    }
    this._reset();
    this._consumeLateBuffer();
};

Async.prototype._consumeLateBuffer = function Async$_consumeLateBuffer() {
    var buffer = this._lateBuffer;
    while(buffer.length() > 0) {
        var fn = buffer.shift();
        var receiver = buffer.shift();
        var arg = buffer.shift();
        var res = tryCatch1(fn, receiver, arg);
        if (res === errorObj) {
            this._queueTick();
            if (fn.domain != null) {
                fn.domain.emit("error", res.e);
            } else {
                throw res.e;
            }
        }
    }
};

Async.prototype._queueTick = function Async$_queue() {
    if (!this._isTickUsed) {
        this._schedule(this.consumeFunctionBuffer);
        this._isTickUsed = true;
    }
};

Async.prototype._reset = function Async$_reset() {
    this._isTickUsed = false;
    this._length = 0;
};

module.exports = new Async();

})(require("__browserify_process"))
},{"./schedule.js":97,"./queue.js":98,"./util.js":66,"__browserify_process":65}],68:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var Objectfreeze = require("./es5.js").freeze;
var util = require("./util.js");
var inherits = util.inherits;
var notEnumerableProp = util.notEnumerableProp;

function markAsOriginatingFromRejection(e) {
    try {
        notEnumerableProp(e, "isOperational", true);
    }
    catch(ignore) {}
}

function originatesFromRejection(e) {
    if (e == null) return false;
    return ((e instanceof OperationalError) ||
        e["isOperational"] === true);
}

function isError(obj) {
    return obj instanceof Error;
}

function canAttach(obj) {
    return isError(obj);
}

function subError(nameProperty, defaultMessage) {
    function SubError(message) {
        if (!(this instanceof SubError)) return new SubError(message);
        this.message = typeof message === "string" ? message : defaultMessage;
        this.name = nameProperty;
        if (Error.captureStackTrace) {
            Error.captureStackTrace(this, this.constructor);
        }
    }
    inherits(SubError, Error);
    return SubError;
}

var _TypeError, _RangeError;
var CancellationError = subError("CancellationError", "cancellation error");
var TimeoutError = subError("TimeoutError", "timeout error");
var AggregateError = subError("AggregateError", "aggregate error");
try {
    _TypeError = TypeError;
    _RangeError = RangeError;
} catch(e) {
    _TypeError = subError("TypeError", "type error");
    _RangeError = subError("RangeError", "range error");
}

var methods = ("join pop push shift unshift slice filter forEach some " +
    "every map indexOf lastIndexOf reduce reduceRight sort reverse").split(" ");

for (var i = 0; i < methods.length; ++i) {
    if (typeof Array.prototype[methods[i]] === "function") {
        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];
    }
}

AggregateError.prototype.length = 0;
AggregateError.prototype["isOperational"] = true;
var level = 0;
AggregateError.prototype.toString = function() {
    var indent = Array(level * 4 + 1).join(" ");
    var ret = "\n" + indent + "AggregateError of:" + "\n";
    level++;
    indent = Array(level * 4 + 1).join(" ");
    for (var i = 0; i < this.length; ++i) {
        var str = this[i] === this ? "[Circular AggregateError]" : this[i] + "";
        var lines = str.split("\n");
        for (var j = 0; j < lines.length; ++j) {
            lines[j] = indent + lines[j];
        }
        str = lines.join("\n");
        ret += str + "\n";
    }
    level--;
    return ret;
};

function OperationalError(message) {
    this.name = "OperationalError";
    this.message = message;
    this.cause = message;
    this["isOperational"] = true;

    if (message instanceof Error) {
        this.message = message.message;
        this.stack = message.stack;
    } else if (Error.captureStackTrace) {
        Error.captureStackTrace(this, this.constructor);
    }

}
inherits(OperationalError, Error);

var key = "__BluebirdErrorTypes__";
var errorTypes = Error[key];
if (!errorTypes) {
    errorTypes = Objectfreeze({
        CancellationError: CancellationError,
        TimeoutError: TimeoutError,
        OperationalError: OperationalError,
        RejectionError: OperationalError,
        AggregateError: AggregateError
    });
    notEnumerableProp(Error, key, errorTypes);
}

module.exports = {
    Error: Error,
    TypeError: _TypeError,
    RangeError: _RangeError,
    CancellationError: errorTypes.CancellationError,
    OperationalError: errorTypes.OperationalError,
    TimeoutError: errorTypes.TimeoutError,
    AggregateError: errorTypes.AggregateError,
    originatesFromRejection: originatesFromRejection,
    markAsOriginatingFromRejection: markAsOriginatingFromRejection,
    canAttach: canAttach
};

},{"./es5.js":96,"./util.js":66}],69:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var util = require("./util.js");
var canAttach = require("./errors.js").canAttach;
var errorObj = util.errorObj;
var isObject = util.isObject;

function getThen(obj) {
    try {
        return obj.then;
    }
    catch(e) {
        errorObj.e = e;
        return errorObj;
    }
}

function Promise$_Cast(obj, originalPromise) {
    if (isObject(obj)) {
        if (obj instanceof Promise) {
            return obj;
        }
        else if (isAnyBluebirdPromise(obj)) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            obj._then(
                ret._fulfillUnchecked,
                ret._rejectUncheckedCheckError,
                ret._progressUnchecked,
                ret,
                null
            );
            ret._setFollowing();
            return ret;
        }
        var then = getThen(obj);
        if (then === errorObj) {
            if (originalPromise !== void 0 && canAttach(then.e)) {
                originalPromise._attachExtraTrace(then.e);
            }
            return Promise.reject(then.e);
        } else if (typeof then === "function") {
            return Promise$_doThenable(obj, then, originalPromise);
        }
    }
    return obj;
}

var hasProp = {}.hasOwnProperty;
function isAnyBluebirdPromise(obj) {
    return hasProp.call(obj, "_promise0");
}

function Promise$_doThenable(x, then, originalPromise) {
    var resolver = Promise.defer();
    var called = false;
    try {
        then.call(
            x,
            Promise$_resolveFromThenable,
            Promise$_rejectFromThenable,
            Promise$_progressFromThenable
        );
    } catch(e) {
        if (!called) {
            called = true;
            var trace = canAttach(e) ? e : new Error(e + "");
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(trace);
            }
            resolver.promise._reject(e, trace);
        }
    }
    return resolver.promise;

    function Promise$_resolveFromThenable(y) {
        if (called) return;
        called = true;

        if (x === y) {
            var e = Promise._makeSelfResolutionError();
            if (originalPromise !== void 0) {
                originalPromise._attachExtraTrace(e);
            }
            resolver.promise._reject(e, void 0);
            return;
        }
        resolver.resolve(y);
    }

    function Promise$_rejectFromThenable(r) {
        if (called) return;
        called = true;
        var trace = canAttach(r) ? r : new Error(r + "");
        if (originalPromise !== void 0) {
            originalPromise._attachExtraTrace(trace);
        }
        resolver.promise._reject(r, trace);
    }

    function Promise$_progressFromThenable(v) {
        if (called) return;
        var promise = resolver.promise;
        if (typeof promise._progress === "function") {
            promise._progress(v);
        }
    }
}

return Promise$_Cast;
};

},{"./errors.js":68,"./util.js":66}],70:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var canAttach = require("./errors.js").canAttach;
var util = require("./util.js");
var isArray = util.isArray;

function toResolutionValue(val) {
    switch(val) {
    case -1: return void 0;
    case -2: return [];
    case -3: return {};
    }
}

function PromiseArray(values) {
    var promise = this._promise = new Promise(INTERNAL);
    var parent = void 0;
    if (values instanceof Promise) {
        parent = values;
        promise._propagateFrom(parent, 1 | 4);
    }
    promise._setTrace(parent);
    this._values = values;
    this._length = 0;
    this._totalResolved = 0;
    this._init(void 0, -2);
}
PromiseArray.prototype.length = function PromiseArray$length() {
    return this._length;
};

PromiseArray.prototype.promise = function PromiseArray$promise() {
    return this._promise;
};

PromiseArray.prototype._init =
function PromiseArray$_init(_, resolveValueIfEmpty) {
    var values = cast(this._values, void 0);
    if (values instanceof Promise) {
        this._values = values;
        values._setBoundTo(this._promise._boundTo);
        if (values.isFulfilled()) {
            values = values._settledValue;
            if (!isArray(values)) {
                var err = new Promise.TypeError("expecting an array, a promise or a thenable");
                this.__hardReject__(err);
                return;
            }
        } else if (values.isPending()) {
            values._then(
                PromiseArray$_init,
                this._reject,
                void 0,
                this,
                resolveValueIfEmpty
           );
            return;
        } else {
            values._unsetRejectionIsUnhandled();
            this._reject(values._settledValue);
            return;
        }
    } else if (!isArray(values)) {
        var err = new Promise.TypeError("expecting an array, a promise or a thenable");
        this.__hardReject__(err);
        return;
    }

    if (values.length === 0) {
        if (resolveValueIfEmpty === -5) {
            this._resolveEmptyArray();
        }
        else {
            this._resolve(toResolutionValue(resolveValueIfEmpty));
        }
        return;
    }
    var len = this.getActualLength(values.length);
    var newLen = len;
    var newValues = this.shouldCopyValues() ? new Array(len) : this._values;
    var isDirectScanNeeded = false;
    for (var i = 0; i < len; ++i) {
        var maybePromise = cast(values[i], void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                maybePromise._proxyPromiseArray(this, i);
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                isDirectScanNeeded = true;
            }
        } else {
            isDirectScanNeeded = true;
        }
        newValues[i] = maybePromise;
    }
    this._values = newValues;
    this._length = newLen;
    if (isDirectScanNeeded) {
        this._scanDirectValues(len);
    }
};

PromiseArray.prototype._settlePromiseAt =
function PromiseArray$_settlePromiseAt(index) {
    var value = this._values[index];
    if (!(value instanceof Promise)) {
        this._promiseFulfilled(value, index);
    } else if (value.isFulfilled()) {
        this._promiseFulfilled(value._settledValue, index);
    } else if (value.isRejected()) {
        this._promiseRejected(value._settledValue, index);
    }
};

PromiseArray.prototype._scanDirectValues =
function PromiseArray$_scanDirectValues(len) {
    for (var i = 0; i < len; ++i) {
        if (this._isResolved()) {
            break;
        }
        this._settlePromiseAt(i);
    }
};

PromiseArray.prototype._isResolved = function PromiseArray$_isResolved() {
    return this._values === null;
};

PromiseArray.prototype._resolve = function PromiseArray$_resolve(value) {
    this._values = null;
    this._promise._fulfill(value);
};

PromiseArray.prototype.__hardReject__ =
PromiseArray.prototype._reject = function PromiseArray$_reject(reason) {
    this._values = null;
    var trace = canAttach(reason) ? reason : new Error(reason + "");
    this._promise._attachExtraTrace(trace);
    this._promise._reject(reason, trace);
};

PromiseArray.prototype._promiseProgressed =
function PromiseArray$_promiseProgressed(progressValue, index) {
    if (this._isResolved()) return;
    this._promise._progress({
        index: index,
        value: progressValue
    });
};


PromiseArray.prototype._promiseFulfilled =
function PromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

PromiseArray.prototype._promiseRejected =
function PromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    this._totalResolved++;
    this._reject(reason);
};

PromiseArray.prototype.shouldCopyValues =
function PromiseArray$_shouldCopyValues() {
    return true;
};

PromiseArray.prototype.getActualLength =
function PromiseArray$getActualLength(len) {
    return len;
};

return PromiseArray;
};

},{"./errors.js":68,"./util.js":66}],71:[function(require,module,exports){
(function(){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function() {
var inherits = require("./util.js").inherits;
var defineProperty = require("./es5.js").defineProperty;

var rignore = new RegExp(
    "\\b(?:[a-zA-Z0-9.]+\\$_\\w+|" +
    "tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|" +
    "\\w*PromiseArray\\.\\w*PromiseArray|" +
    "setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|" +
    "process._tickCallback|nextTick|Async\\$\\w+)\\b"
);

var rtraceline = null;
var formatStack = null;

function formatNonError(obj) {
    var str;
    if (typeof obj === "function") {
        str = "[function " +
            (obj.name || "anonymous") +
            "]";
    } else {
        str = obj.toString();
        var ruselessToString = /\[object [a-zA-Z0-9$_]+\]/;
        if (ruselessToString.test(str)) {
            try {
                var newStr = JSON.stringify(obj);
                str = newStr;
            }
            catch(e) {

            }
        }
        if (str.length === 0) {
            str = "(empty array)";
        }
    }
    return ("(<" + snip(str) + ">, no stack trace)");
}

function snip(str) {
    var maxChars = 41;
    if (str.length < maxChars) {
        return str;
    }
    return str.substr(0, maxChars - 3) + "...";
}

function CapturedTrace(ignoreUntil, isTopLevel) {
    this.captureStackTrace(CapturedTrace, isTopLevel);

}
inherits(CapturedTrace, Error);

CapturedTrace.prototype.captureStackTrace =
function CapturedTrace$captureStackTrace(ignoreUntil, isTopLevel) {
    captureStackTrace(this, ignoreUntil, isTopLevel);
};

CapturedTrace.possiblyUnhandledRejection =
function CapturedTrace$PossiblyUnhandledRejection(reason) {
    if (typeof console === "object") {
        var message;
        if (typeof reason === "object" || typeof reason === "function") {
            var stack = reason.stack;
            message = "Possibly unhandled " + formatStack(stack, reason);
        } else {
            message = "Possibly unhandled " + String(reason);
        }
        if (typeof console.error === "function" ||
            typeof console.error === "object") {
            console.error(message);
        } else if (typeof console.log === "function" ||
            typeof console.log === "object") {
            console.log(message);
        }
    }
};

CapturedTrace.combine = function CapturedTrace$Combine(current, prev) {
    var curLast = current.length - 1;
    for (var i = prev.length - 1; i >= 0; --i) {
        var line = prev[i];
        if (current[curLast] === line) {
            current.pop();
            curLast--;
        } else {
            break;
        }
    }

    current.push("From previous event:");
    var lines = current.concat(prev);

    var ret = [];

    for (var i = 0, len = lines.length; i < len; ++i) {

        if ((rignore.test(lines[i]) ||
            (i > 0 && !rtraceline.test(lines[i])) &&
            lines[i] !== "From previous event:")
       ) {
            continue;
        }
        ret.push(lines[i]);
    }
    return ret;
};

CapturedTrace.protectErrorMessageNewlines = function(stack) {
    for (var i = 0; i < stack.length; ++i) {
        if (rtraceline.test(stack[i])) {
            break;
        }
    }

    if (i <= 1) return;

    var errorMessageLines = [];
    for (var j = 0; j < i; ++j) {
        errorMessageLines.push(stack.shift());
    }
    stack.unshift(errorMessageLines.join("\u0002\u0000\u0001"));
};

CapturedTrace.isSupported = function CapturedTrace$IsSupported() {
    return typeof captureStackTrace === "function";
};

var captureStackTrace = (function stackDetection() {
    if (typeof Error.stackTraceLimit === "number" &&
        typeof Error.captureStackTrace === "function") {
        rtraceline = /^\s*at\s*/;
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);


        };
        var captureStackTrace = Error.captureStackTrace;
        return function CapturedTrace$_captureStackTrace(
            receiver, ignoreUntil) {
            captureStackTrace(receiver, ignoreUntil);
        };
    }
    var err = new Error();

    if (typeof err.stack === "string" &&
        typeof "".startsWith === "function" &&
        (err.stack.startsWith("stackDetection@")) &&
        stackDetection.name === "stackDetection") {

        defineProperty(Error, "stackTraceLimit", {
            writable: true,
            enumerable: false,
            configurable: false,
            value: 25
        });
        rtraceline = /@/;
        var rline = /[@\n]/;

        formatStack = function(stack, error) {
            if (typeof stack === "string") {
                return (error.name + ". " + error.message + "\n" + stack);
            }

            if (error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return function captureStackTrace(o) {
            var stack = new Error().stack;
            var split = stack.split(rline);
            var len = split.length;
            var ret = "";
            for (var i = 0; i < len; i += 2) {
                ret += split[i];
                ret += "@";
                ret += split[i + 1];
                ret += "\n";
            }
            o.stack = ret;
        };
    } else {
        formatStack = function(stack, error) {
            if (typeof stack === "string") return stack;

            if ((typeof error === "object" ||
                typeof error === "function") &&
                error.name !== void 0 &&
                error.message !== void 0) {
                return error.name + ". " + error.message;
            }
            return formatNonError(error);
        };

        return null;
    }
})();

return CapturedTrace;
};

})()
},{"./util.js":66,"./es5.js":96}],72:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(NEXT_FILTER) {
var util = require("./util.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;
var keys = require("./es5.js").keys;
var TypeError = errors.TypeError;

function CatchFilter(instances, callback, promise) {
    this._instances = instances;
    this._callback = callback;
    this._promise = promise;
}

function CatchFilter$_safePredicate(predicate, e) {
    var safeObject = {};
    var retfilter = tryCatch1(predicate, safeObject, e);

    if (retfilter === errorObj) return retfilter;

    var safeKeys = keys(safeObject);
    if (safeKeys.length) {
        errorObj.e = new TypeError(
            "Catch filter must inherit from Error "
          + "or be a simple predicate function");
        return errorObj;
    }
    return retfilter;
}

CatchFilter.prototype.doFilter = function CatchFilter$_doFilter(e) {
    var cb = this._callback;
    var promise = this._promise;
    var boundTo = promise._boundTo;
    for (var i = 0, len = this._instances.length; i < len; ++i) {
        var item = this._instances[i];
        var itemIsErrorType = item === Error ||
            (item != null && item.prototype instanceof Error);

        if (itemIsErrorType && e instanceof item) {
            var ret = tryCatch1(cb, boundTo, e);
            if (ret === errorObj) {
                NEXT_FILTER.e = ret.e;
                return NEXT_FILTER;
            }
            return ret;
        } else if (typeof item === "function" && !itemIsErrorType) {
            var shouldHandle = CatchFilter$_safePredicate(item, e);
            if (shouldHandle === errorObj) {
                var trace = errors.canAttach(errorObj.e)
                    ? errorObj.e
                    : new Error(errorObj.e + "");
                this._promise._attachExtraTrace(trace);
                e = errorObj.e;
                break;
            } else if (shouldHandle) {
                var ret = tryCatch1(cb, boundTo, e);
                if (ret === errorObj) {
                    NEXT_FILTER.e = ret.e;
                    return NEXT_FILTER;
                }
                return ret;
            }
        }
    }
    NEXT_FILTER.e = e;
    return NEXT_FILTER;
};

return CatchFilter;
};

},{"./util.js":66,"./errors.js":68,"./es5.js":96}],73:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var maybeWrapAsError = util.maybeWrapAsError;
var errors = require("./errors.js");
var TimeoutError = errors.TimeoutError;
var OperationalError = errors.OperationalError;
var async = require("./async.js");
var haveGetters = util.haveGetters;
var es5 = require("./es5.js");

function isUntypedError(obj) {
    return obj instanceof Error &&
        es5.getPrototypeOf(obj) === Error.prototype;
}

function wrapAsOperationalError(obj) {
    var ret;
    if (isUntypedError(obj)) {
        ret = new OperationalError(obj);
    } else {
        ret = obj;
    }
    errors.markAsOriginatingFromRejection(ret);
    return ret;
}

function nodebackForPromise(promise) {
    function PromiseResolver$_callback(err, value) {
        if (promise === null) return;

        if (err) {
            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        } else if (arguments.length > 2) {
            var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
            promise._fulfill(args);
        } else {
            promise._fulfill(value);
        }

        promise = null;
    }
    return PromiseResolver$_callback;
}


var PromiseResolver;
if (!haveGetters) {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
        this.asCallback = nodebackForPromise(promise);
        this.callback = this.asCallback;
    };
}
else {
    PromiseResolver = function PromiseResolver(promise) {
        this.promise = promise;
    };
}
if (haveGetters) {
    var prop = {
        get: function() {
            return nodebackForPromise(this.promise);
        }
    };
    es5.defineProperty(PromiseResolver.prototype, "asCallback", prop);
    es5.defineProperty(PromiseResolver.prototype, "callback", prop);
}

PromiseResolver._nodebackForPromise = nodebackForPromise;

PromiseResolver.prototype.toString = function PromiseResolver$toString() {
    return "[object PromiseResolver]";
};

PromiseResolver.prototype.resolve =
PromiseResolver.prototype.fulfill = function PromiseResolver$resolve(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    if (promise._tryFollow(value)) {
        return;
    }
    async.invoke(promise._fulfill, promise, value);
};

PromiseResolver.prototype.reject = function PromiseResolver$reject(reason) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }

    var promise = this.promise;
    errors.markAsOriginatingFromRejection(reason);
    var trace = errors.canAttach(reason) ? reason : new Error(reason + "");
    promise._attachExtraTrace(trace);
    async.invoke(promise._reject, promise, reason);
    if (trace !== reason) {
        async.invoke(this._setCarriedStackTrace, this, trace);
    }
};

PromiseResolver.prototype.progress =
function PromiseResolver$progress(value) {
    if (!(this instanceof PromiseResolver)) {
        throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");
    }
    async.invoke(this.promise._progress, this.promise, value);
};

PromiseResolver.prototype.cancel = function PromiseResolver$cancel() {
    async.invoke(this.promise.cancel, this.promise, void 0);
};

PromiseResolver.prototype.timeout = function PromiseResolver$timeout() {
    this.reject(new TimeoutError("timeout"));
};

PromiseResolver.prototype.isResolved = function PromiseResolver$isResolved() {
    return this.promise.isResolved();
};

PromiseResolver.prototype.toJSON = function PromiseResolver$toJSON() {
    return this.promise.toJSON();
};

PromiseResolver.prototype._setCarriedStackTrace =
function PromiseResolver$_setCarriedStackTrace(trace) {
    if (this.promise.isRejected()) {
        this.promise._setCarriedStackTrace(trace);
    }
};

module.exports = PromiseResolver;

},{"./util.js":66,"./errors.js":68,"./async.js":67,"./es5.js":96}],74:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, NEXT_FILTER, cast) {
var util = require("./util.js");
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;
var isPrimitive = util.isPrimitive;
var thrower = util.thrower;

function returnThis() {
    return this;
}
function throwThis() {
    throw this;
}
function return$(r) {
    return function Promise$_returner() {
        return r;
    };
}
function throw$(r) {
    return function Promise$_thrower() {
        throw r;
    };
}
function promisedFinally(ret, reasonOrValue, isFulfilled) {
    var then;
    if (wrapsPrimitiveReceiver && isPrimitive(reasonOrValue)) {
        then = isFulfilled ? return$(reasonOrValue) : throw$(reasonOrValue);
    } else {
        then = isFulfilled ? returnThis : throwThis;
    }
    return ret._then(then, thrower, void 0, reasonOrValue, void 0);
}

function finallyHandler(reasonOrValue) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo)
                    : handler();

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, reasonOrValue,
                                    promise.isFulfilled());
        }
    }

    if (promise.isRejected()) {
        NEXT_FILTER.e = reasonOrValue;
        return NEXT_FILTER;
    } else {
        return reasonOrValue;
    }
}

function tapHandler(value) {
    var promise = this.promise;
    var handler = this.handler;

    var ret = promise._isBound()
                    ? handler.call(promise._boundTo, value)
                    : handler(value);

    if (ret !== void 0) {
        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            return promisedFinally(maybePromise, value, true);
        }
    }
    return value;
}

Promise.prototype._passThroughHandler =
function Promise$_passThroughHandler(handler, isFinally) {
    if (typeof handler !== "function") return this.then();

    var promiseAndHandler = {
        promise: this,
        handler: handler
    };

    return this._then(
            isFinally ? finallyHandler : tapHandler,
            isFinally ? finallyHandler : void 0, void 0,
            promiseAndHandler, void 0);
};

Promise.prototype.lastly =
Promise.prototype["finally"] = function Promise$finally(handler) {
    return this._passThroughHandler(handler, true);
};

Promise.prototype.tap = function Promise$tap(handler) {
    return this._passThroughHandler(handler, false);
};
};

},{"./util.js":66}],75:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var util = require("./util.js");
var isPrimitive = util.isPrimitive;
var wrapsPrimitiveReceiver = util.wrapsPrimitiveReceiver;

module.exports = function(Promise) {
var returner = function Promise$_returner() {
    return this;
};
var thrower = function Promise$_thrower() {
    throw this;
};

var wrapper = function Promise$_wrapper(value, action) {
    if (action === 1) {
        return function Promise$_thrower() {
            throw value;
        };
    } else if (action === 2) {
        return function Promise$_returner() {
            return value;
        };
    }
};


Promise.prototype["return"] =
Promise.prototype.thenReturn =
function Promise$thenReturn(value) {
    if (wrapsPrimitiveReceiver && isPrimitive(value)) {
        return this._then(
            wrapper(value, 2),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(returner, void 0, void 0, value, void 0);
};

Promise.prototype["throw"] =
Promise.prototype.thenThrow =
function Promise$thenThrow(reason) {
    if (wrapsPrimitiveReceiver && isPrimitive(reason)) {
        return this._then(
            wrapper(reason, 1),
            void 0,
            void 0,
            void 0,
            void 0
       );
    }
    return this._then(thrower, void 0, void 0, reason, void 0);
};
};

},{"./util.js":66}],77:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, cast, INTERNAL) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;


if (canEvaluate) {
    var thenCallback = function(i) {
        return new Function("value", "holder", "                             \n\
            'use strict';                                                    \n\
            holder.pIndex = value;                                           \n\
            holder.checkFulfillment(this);                                   \n\
            ".replace(/Index/g, i));
    };

    var caller = function(count) {
        var values = [];
        for (var i = 1; i <= count; ++i) values.push("holder.p" + i);
        return new Function("holder", "                                      \n\
            'use strict';                                                    \n\
            var callback = holder.fn;                                        \n\
            return callback(values);                                         \n\
            ".replace(/values/g, values.join(", ")));
    };
    var thenCallbacks = [];
    var callers = [void 0];
    for (var i = 1; i <= 5; ++i) {
        thenCallbacks.push(thenCallback(i));
        callers.push(caller(i));
    }

    var Holder = function(total, fn) {
        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;
        this.fn = fn;
        this.total = total;
        this.now = 0;
    };

    Holder.prototype.callers = callers;
    Holder.prototype.checkFulfillment = function(promise) {
        var now = this.now;
        now++;
        var total = this.total;
        if (now >= total) {
            var handler = this.callers[total];
            var ret = tryCatch1(handler, void 0, this);
            if (ret === errorObj) {
                promise._rejectUnchecked(ret.e);
            } else if (!promise._tryFollow(ret)) {
                promise._fulfillUnchecked(ret);
            }
        } else {
            this.now = now;
        }
    };
}




Promise.join = function Promise$Join() {
    var last = arguments.length - 1;
    var fn;
    if (last > 0 && typeof arguments[last] === "function") {
        fn = arguments[last];
        if (last < 6 && canEvaluate) {
            var ret = new Promise(INTERNAL);
            ret._setTrace(void 0);
            var holder = new Holder(last, fn);
            var reject = ret._reject;
            var callbacks = thenCallbacks;
            for (var i = 0; i < last; ++i) {
                var maybePromise = cast(arguments[i], void 0);
                if (maybePromise instanceof Promise) {
                    if (maybePromise.isPending()) {
                        maybePromise._then(callbacks[i], reject,
                                           void 0, ret, holder);
                    } else if (maybePromise.isFulfilled()) {
                        callbacks[i].call(ret,
                                          maybePromise._settledValue, holder);
                    } else {
                        ret._reject(maybePromise._settledValue);
                        maybePromise._unsetRejectionIsUnhandled();
                    }
                } else {
                    callbacks[i].call(ret, maybePromise, holder);
                }
            }
            return ret;
        }
    }
    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}
    var ret = new PromiseArray(args).promise();
    return fn !== void 0 ? ret.spread(fn) : ret;
};

};

},{"./util.js":66}],79:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL, cast) {
var apiRejection = require("./errors_api_rejection.js")(Promise);
var isArray = require("./util.js").isArray;

var raceLater = function Promise$_raceLater(promise) {
    return promise.then(function(array) {
        return Promise$_Race(array, promise);
    });
};

var hasOwn = {}.hasOwnProperty;
function Promise$_Race(promises, parent) {
    var maybePromise = cast(promises, void 0);

    if (maybePromise instanceof Promise) {
        return raceLater(maybePromise);
    } else if (!isArray(promises)) {
        return apiRejection("expecting an array, a promise or a thenable");
    }

    var ret = new Promise(INTERNAL);
    if (parent !== void 0) {
        ret._propagateFrom(parent, 7);
    } else {
        ret._setTrace(void 0);
    }
    var fulfill = ret._fulfill;
    var reject = ret._reject;
    for (var i = 0, len = promises.length; i < len; ++i) {
        var val = promises[i];

        if (val === void 0 && !(hasOwn.call(promises, i))) {
            continue;
        }

        Promise.cast(val)._then(fulfill, reject, void 0, ret, null);
    }
    return ret;
}

Promise.race = function Promise$Race(promises) {
    return Promise$_Race(promises, void 0);
};

Promise.prototype.race = function Promise$race() {
    return Promise$_Race(this, void 0);
};

};

},{"./util.js":66,"./errors_api_rejection.js":95}],80:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var cr = Object.create;
if (cr) {
    var callerCache = cr(null);
    var getterCache = cr(null);
    callerCache[" size"] = getterCache[" size"] = 0;
}

module.exports = function(Promise) {
var util = require("./util.js");
var canEvaluate = util.canEvaluate;
var isIdentifier = util.isIdentifier;

function makeMethodCaller (methodName) {
    return new Function("obj", "                                             \n\
        'use strict'                                                         \n\
        var len = this.length;                                               \n\
        switch(len) {                                                        \n\
            case 1: return obj.methodName(this[0]);                          \n\
            case 2: return obj.methodName(this[0], this[1]);                 \n\
            case 3: return obj.methodName(this[0], this[1], this[2]);        \n\
            case 0: return obj.methodName();                                 \n\
            default: return obj.methodName.apply(obj, this);                 \n\
        }                                                                    \n\
        ".replace(/methodName/g, methodName));
}

function makeGetter (propertyName) {
    return new Function("obj", "                                             \n\
        'use strict';                                                        \n\
        return obj.propertyName;                                             \n\
        ".replace("propertyName", propertyName));
}

function getCompiled(name, compiler, cache) {
    var ret = cache[name];
    if (typeof ret !== "function") {
        if (!isIdentifier(name)) {
            return null;
        }
        ret = compiler(name);
        cache[name] = ret;
        cache[" size"]++;
        if (cache[" size"] > 512) {
            var keys = Object.keys(cache);
            for (var i = 0; i < 256; ++i) delete cache[keys[i]];
            cache[" size"] = keys.length - 256;
        }
    }
    return ret;
}

function getMethodCaller(name) {
    return getCompiled(name, makeMethodCaller, callerCache);
}

function getGetter(name) {
    return getCompiled(name, makeGetter, getterCache);
}

function caller(obj) {
    return obj[this.pop()].apply(obj, this);
}
Promise.prototype.call = function Promise$call(methodName) {
    var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}
    if (canEvaluate) {
        var maybeCaller = getMethodCaller(methodName);
        if (maybeCaller !== null) {
            return this._then(maybeCaller, void 0, void 0, args, void 0);
        }
    }
    args.push(methodName);
    return this._then(caller, void 0, void 0, args, void 0);
};

function namedGetter(obj) {
    return obj[this];
}
function indexedGetter(obj) {
    return obj[this];
}
Promise.prototype.get = function Promise$get(propertyName) {
    var isIndex = (typeof propertyName === "number");
    var getter;
    if (!isIndex) {
        if (canEvaluate) {
            var maybeGetter = getGetter(propertyName);
            getter = maybeGetter !== null ? maybeGetter : namedGetter;
        } else {
            getter = namedGetter;
        }
    } else {
        getter = indexedGetter;
    }
    return this._then(getter, void 0, void 0, propertyName, void 0);
};
};

},{"./util.js":66}],81:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, apiRejection, INTERNAL, cast) {
var errors = require("./errors.js");
var TypeError = errors.TypeError;
var deprecated = require("./util.js").deprecated;
var util = require("./util.js");
var errorObj = util.errorObj;
var tryCatch1 = util.tryCatch1;
var yieldHandlers = [];

function promiseFromYieldHandler(value, yieldHandlers) {
    var _errorObj = errorObj;
    var _Promise = Promise;
    var len = yieldHandlers.length;
    for (var i = 0; i < len; ++i) {
        var result = tryCatch1(yieldHandlers[i], void 0, value);
        if (result === _errorObj) {
            return _Promise.reject(_errorObj.e);
        }
        var maybePromise = cast(result, promiseFromYieldHandler);
        if (maybePromise instanceof _Promise) return maybePromise;
    }
    return null;
}

function PromiseSpawn(generatorFunction, receiver, yieldHandler) {
    var promise = this._promise = new Promise(INTERNAL);
    promise._setTrace(void 0);
    this._generatorFunction = generatorFunction;
    this._receiver = receiver;
    this._generator = void 0;
    this._yieldHandlers = typeof yieldHandler === "function"
        ? [yieldHandler].concat(yieldHandlers)
        : yieldHandlers;
}

PromiseSpawn.prototype.promise = function PromiseSpawn$promise() {
    return this._promise;
};

PromiseSpawn.prototype._run = function PromiseSpawn$_run() {
    this._generator = this._generatorFunction.call(this._receiver);
    this._receiver =
        this._generatorFunction = void 0;
    this._next(void 0);
};

PromiseSpawn.prototype._continue = function PromiseSpawn$_continue(result) {
    if (result === errorObj) {
        this._generator = void 0;
        var trace = errors.canAttach(result.e)
            ? result.e : new Error(result.e + "");
        this._promise._attachExtraTrace(trace);
        this._promise._reject(result.e, trace);
        return;
    }

    var value = result.value;
    if (result.done === true) {
        this._generator = void 0;
        if (!this._promise._tryFollow(value)) {
            this._promise._fulfill(value);
        }
    } else {
        var maybePromise = cast(value, void 0);
        if (!(maybePromise instanceof Promise)) {
            maybePromise =
                promiseFromYieldHandler(maybePromise, this._yieldHandlers);
            if (maybePromise === null) {
                this._throw(new TypeError("A value was yielded that could not be treated as a promise"));
                return;
            }
        }
        maybePromise._then(
            this._next,
            this._throw,
            void 0,
            this,
            null
       );
    }
};

PromiseSpawn.prototype._throw = function PromiseSpawn$_throw(reason) {
    if (errors.canAttach(reason))
        this._promise._attachExtraTrace(reason);
    this._continue(
        tryCatch1(this._generator["throw"], this._generator, reason)
   );
};

PromiseSpawn.prototype._next = function PromiseSpawn$_next(value) {
    this._continue(
        tryCatch1(this._generator.next, this._generator, value)
   );
};

Promise.coroutine =
function Promise$Coroutine(generatorFunction, options) {
    if (typeof generatorFunction !== "function") {
        throw new TypeError("generatorFunction must be a function");
    }
    var yieldHandler = Object(options).yieldHandler;
    var PromiseSpawn$ = PromiseSpawn;
    return function () {
        var generator = generatorFunction.apply(this, arguments);
        var spawn = new PromiseSpawn$(void 0, void 0, yieldHandler);
        spawn._generator = generator;
        spawn._next(void 0);
        return spawn.promise();
    };
};

Promise.coroutine.addYieldHandler = function(fn) {
    if (typeof fn !== "function") throw new TypeError("fn must be a function");
    yieldHandlers.push(fn);
};

Promise.spawn = function Promise$Spawn(generatorFunction) {
    deprecated("Promise.spawn is deprecated. Use Promise.coroutine instead.");
    if (typeof generatorFunction !== "function") {
        return apiRejection("generatorFunction must be a function");
    }
    var spawn = new PromiseSpawn(generatorFunction, this);
    var ret = spawn.promise();
    spawn._run(Promise.spawn);
    return ret;
};
};

},{"./errors.js":68,"./util.js":66}],82:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
var PENDING = {};
var EMPTY_ARRAY = [];

function MappingPromiseArray(promises, fn, limit, _filter) {
    this.constructor$(promises);
    this._callback = fn;
    this._preservedValues = _filter === INTERNAL
        ? new Array(this.length())
        : null;
    this._limit = limit;
    this._inFlight = 0;
    this._queue = limit >= 1 ? [] : EMPTY_ARRAY;
    this._init$(void 0, -2);
}
util.inherits(MappingPromiseArray, PromiseArray);

MappingPromiseArray.prototype._init = function MappingPromiseArray$_init() {};

MappingPromiseArray.prototype._promiseFulfilled =
function MappingPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;

    var length = this.length();
    var preservedValues = this._preservedValues;
    var limit = this._limit;
    if (values[index] === PENDING) {
        values[index] = value;
        if (limit >= 1) {
            this._inFlight--;
            this._drainQueue();
            if (this._isResolved()) return;
        }
    } else {
        if (limit >= 1 && this._inFlight >= limit) {
            values[index] = value;
            this._queue.push(index);
            return;
        }
        if (preservedValues !== null) preservedValues[index] = value;

        var callback = this._callback;
        var receiver = this._promise._boundTo;
        var ret = tryCatch3(callback, receiver, value, index, length);
        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                if (limit >= 1) this._inFlight++;
                values[index] = PENDING;
                return maybePromise._proxyPromiseArray(this, index);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }
        values[index] = ret;
    }
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= length) {
        if (preservedValues !== null) {
            this._filter(values, preservedValues);
        } else {
            this._resolve(values);
        }

    }
};

MappingPromiseArray.prototype._drainQueue =
function MappingPromiseArray$_drainQueue() {
    var queue = this._queue;
    var limit = this._limit;
    var values = this._values;
    while (queue.length > 0 && this._inFlight < limit) {
        var index = queue.pop();
        this._promiseFulfilled(values[index], index);
    }
};

MappingPromiseArray.prototype._filter =
function MappingPromiseArray$_filter(booleans, values) {
    var len = values.length;
    var ret = new Array(len);
    var j = 0;
    for (var i = 0; i < len; ++i) {
        if (booleans[i]) ret[j++] = values[i];
    }
    ret.length = j;
    this._resolve(ret);
};

MappingPromiseArray.prototype.preservedValues =
function MappingPromiseArray$preserveValues() {
    return this._preservedValues;
};

function map(promises, fn, options, _filter) {
    var limit = typeof options === "object" && options !== null
        ? options.concurrency
        : 0;
    limit = typeof limit === "number" &&
        isFinite(limit) && limit >= 1 ? limit : 0;
    return new MappingPromiseArray(promises, fn, limit, _filter);
}

Promise.prototype.map = function Promise$map(fn, options) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");

    return map(this, fn, options, null).promise();
};

Promise.map = function Promise$Map(promises, fn, options, _filter) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    return map(promises, fn, options, _filter).promise();
};


};

},{"./util.js":66}],84:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var util = require("./util.js");
var async = require("./async.js");
var tryCatch2 = util.tryCatch2;
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

function thrower(r) {
    throw r;
}

function Promise$_spreadAdapter(val, receiver) {
    if (!util.isArray(val)) return Promise$_successAdapter(val, receiver);
    var ret = util.tryCatchApply(this, [null].concat(val), receiver);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

function Promise$_successAdapter(val, receiver) {
    var nodeback = this;
    var ret = val === void 0
        ? tryCatch1(nodeback, receiver, null)
        : tryCatch2(nodeback, receiver, null, val);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}
function Promise$_errorAdapter(reason, receiver) {
    var nodeback = this;
    var ret = tryCatch1(nodeback, receiver, reason);
    if (ret === errorObj) {
        async.invokeLater(thrower, void 0, ret.e);
    }
}

Promise.prototype.nodeify = function Promise$nodeify(nodeback, options) {
    if (typeof nodeback == "function") {
        var adapter = Promise$_successAdapter;
        if (options !== void 0 && Object(options).spread) {
            adapter = Promise$_spreadAdapter;
        }
        this._then(
            adapter,
            Promise$_errorAdapter,
            void 0,
            nodeback,
            this._boundTo
        );
    }
    return this;
};
};

},{"./util.js":66,"./async.js":67}],86:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, apiRejection, cast, INTERNAL) {
var util = require("./util.js");
var tryCatch4 = util.tryCatch4;
var tryCatch3 = util.tryCatch3;
var errorObj = util.errorObj;
function ReductionPromiseArray(promises, fn, accum, _each) {
    this.constructor$(promises);
    this._preservedValues = _each === INTERNAL ? [] : null;
    this._zerothIsAccum = (accum === void 0);
    this._gotAccum = false;
    this._reducingIndex = (this._zerothIsAccum ? 1 : 0);
    this._valuesPhase = undefined;

    var maybePromise = cast(accum, void 0);
    var rejected = false;
    var isPromise = maybePromise instanceof Promise;
    if (isPromise) {
        if (maybePromise.isPending()) {
            maybePromise._proxyPromiseArray(this, -1);
        } else if (maybePromise.isFulfilled()) {
            accum = maybePromise.value();
            this._gotAccum = true;
        } else {
            maybePromise._unsetRejectionIsUnhandled();
            this._reject(maybePromise.reason());
            rejected = true;
        }
    }
    if (!(isPromise || this._zerothIsAccum)) this._gotAccum = true;
    this._callback = fn;
    this._accum = accum;
    if (!rejected) this._init$(void 0, -5);
}
util.inherits(ReductionPromiseArray, PromiseArray);

ReductionPromiseArray.prototype._init =
function ReductionPromiseArray$_init() {};

ReductionPromiseArray.prototype._resolveEmptyArray =
function ReductionPromiseArray$_resolveEmptyArray() {
    if (this._gotAccum || this._zerothIsAccum) {
        this._resolve(this._preservedValues !== null
                        ? [] : this._accum);
    }
};

ReductionPromiseArray.prototype._promiseFulfilled =
function ReductionPromiseArray$_promiseFulfilled(value, index) {
    var values = this._values;
    if (values === null) return;
    var length = this.length();
    var preservedValues = this._preservedValues;
    var isEach = preservedValues !== null;
    var gotAccum = this._gotAccum;
    var valuesPhase = this._valuesPhase;
    var valuesPhaseIndex;
    if (!valuesPhase) {
        valuesPhase = this._valuesPhase = Array(length);
        for (valuesPhaseIndex=0; valuesPhaseIndex<length; ++valuesPhaseIndex) {
            valuesPhase[valuesPhaseIndex] = 0;
        }
    }
    valuesPhaseIndex = valuesPhase[index];

    if (index === 0 && this._zerothIsAccum) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
        valuesPhase[index] = ((valuesPhaseIndex === 0)
            ? 1 : 2);
    } else if (index === -1) {
        if (!gotAccum) {
            this._accum = value;
            this._gotAccum = gotAccum = true;
        }
    } else {
        if (valuesPhaseIndex === 0) {
            valuesPhase[index] = 1;
        }
        else {
            valuesPhase[index] = 2;
            if (gotAccum) {
                this._accum = value;
            }
        }
    }
    if (!gotAccum) return;

    var callback = this._callback;
    var receiver = this._promise._boundTo;
    var ret;

    for (var i = this._reducingIndex; i < length; ++i) {
        valuesPhaseIndex = valuesPhase[i];
        if (valuesPhaseIndex === 2) {
            this._reducingIndex = i + 1;
            continue;
        }
        if (valuesPhaseIndex !== 1) return;

        value = values[i];
        if (value instanceof Promise) {
            if (value.isFulfilled()) {
                value = value._settledValue;
            } else if (value.isPending()) {
                return;
            } else {
                value._unsetRejectionIsUnhandled();
                return this._reject(value.reason());
            }
        }

        if (isEach) {
            preservedValues.push(value);
            ret = tryCatch3(callback, receiver, value, i, length);
        }
        else {
            ret = tryCatch4(callback, receiver, this._accum, value, i, length);
        }

        if (ret === errorObj) return this._reject(ret.e);

        var maybePromise = cast(ret, void 0);
        if (maybePromise instanceof Promise) {
            if (maybePromise.isPending()) {
                valuesPhase[i] = 4;
                return maybePromise._proxyPromiseArray(this, i);
            } else if (maybePromise.isFulfilled()) {
                ret = maybePromise.value();
            } else {
                maybePromise._unsetRejectionIsUnhandled();
                return this._reject(maybePromise.reason());
            }
        }

        this._reducingIndex = i + 1;
        this._accum = ret;
    }

    if (this._reducingIndex < length) return;
    this._resolve(isEach ? preservedValues : this._accum);
};

function reduce(promises, fn, initialValue, _each) {
    if (typeof fn !== "function") return apiRejection("fn must be a function");
    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);
    return array.promise();
}

Promise.prototype.reduce = function Promise$reduce(fn, initialValue) {
    return reduce(this, fn, initialValue, null);
};

Promise.reduce = function Promise$Reduce(promises, fn, initialValue, _each) {
    return reduce(promises, fn, initialValue, _each);
};
};

},{"./util.js":66}],87:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
    function(Promise, PromiseArray) {
var PromiseInspection = Promise.PromiseInspection;
var util = require("./util.js");

function SettledPromiseArray(values) {
    this.constructor$(values);
}
util.inherits(SettledPromiseArray, PromiseArray);

SettledPromiseArray.prototype._promiseResolved =
function SettledPromiseArray$_promiseResolved(index, inspection) {
    this._values[index] = inspection;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        this._resolve(this._values);
    }
};

SettledPromiseArray.prototype._promiseFulfilled =
function SettledPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 268435456;
    ret._settledValue = value;
    this._promiseResolved(index, ret);
};
SettledPromiseArray.prototype._promiseRejected =
function SettledPromiseArray$_promiseRejected(reason, index) {
    if (this._isResolved()) return;
    var ret = new PromiseInspection();
    ret._bitField = 134217728;
    ret._settledValue = reason;
    this._promiseResolved(index, ret);
};

Promise.settle = function Promise$Settle(promises) {
    return new SettledPromiseArray(promises).promise();
};

Promise.prototype.settle = function Promise$settle() {
    return new SettledPromiseArray(this).promise();
};
};

},{"./util.js":66}],88:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports =
function(Promise, PromiseArray, apiRejection) {
var util = require("./util.js");
var RangeError = require("./errors.js").RangeError;
var AggregateError = require("./errors.js").AggregateError;
var isArray = util.isArray;


function SomePromiseArray(values) {
    this.constructor$(values);
    this._howMany = 0;
    this._unwrap = false;
    this._initialized = false;
}
util.inherits(SomePromiseArray, PromiseArray);

SomePromiseArray.prototype._init = function SomePromiseArray$_init() {
    if (!this._initialized) {
        return;
    }
    if (this._howMany === 0) {
        this._resolve([]);
        return;
    }
    this._init$(void 0, -5);
    var isArrayResolved = isArray(this._values);
    if (!this._isResolved() &&
        isArrayResolved &&
        this._howMany > this._canPossiblyFulfill()) {
        this._reject(this._getRangeError(this.length()));
    }
};

SomePromiseArray.prototype.init = function SomePromiseArray$init() {
    this._initialized = true;
    this._init();
};

SomePromiseArray.prototype.setUnwrap = function SomePromiseArray$setUnwrap() {
    this._unwrap = true;
};

SomePromiseArray.prototype.howMany = function SomePromiseArray$howMany() {
    return this._howMany;
};

SomePromiseArray.prototype.setHowMany =
function SomePromiseArray$setHowMany(count) {
    if (this._isResolved()) return;
    this._howMany = count;
};

SomePromiseArray.prototype._promiseFulfilled =
function SomePromiseArray$_promiseFulfilled(value) {
    if (this._isResolved()) return;
    this._addFulfilled(value);
    if (this._fulfilled() === this.howMany()) {
        this._values.length = this.howMany();
        if (this.howMany() === 1 && this._unwrap) {
            this._resolve(this._values[0]);
        } else {
            this._resolve(this._values);
        }
    }

};
SomePromiseArray.prototype._promiseRejected =
function SomePromiseArray$_promiseRejected(reason) {
    if (this._isResolved()) return;
    this._addRejected(reason);
    if (this.howMany() > this._canPossiblyFulfill()) {
        var e = new AggregateError();
        for (var i = this.length(); i < this._values.length; ++i) {
            e.push(this._values[i]);
        }
        this._reject(e);
    }
};

SomePromiseArray.prototype._fulfilled = function SomePromiseArray$_fulfilled() {
    return this._totalResolved;
};

SomePromiseArray.prototype._rejected = function SomePromiseArray$_rejected() {
    return this._values.length - this.length();
};

SomePromiseArray.prototype._addRejected =
function SomePromiseArray$_addRejected(reason) {
    this._values.push(reason);
};

SomePromiseArray.prototype._addFulfilled =
function SomePromiseArray$_addFulfilled(value) {
    this._values[this._totalResolved++] = value;
};

SomePromiseArray.prototype._canPossiblyFulfill =
function SomePromiseArray$_canPossiblyFulfill() {
    return this.length() - this._rejected();
};

SomePromiseArray.prototype._getRangeError =
function SomePromiseArray$_getRangeError(count) {
    var message = "Input array must contain at least " +
            this._howMany + " items but contains only " + count + " items";
    return new RangeError(message);
};

SomePromiseArray.prototype._resolveEmptyArray =
function SomePromiseArray$_resolveEmptyArray() {
    this._reject(this._getRangeError(0));
};

function Promise$_Some(promises, howMany) {
    if ((howMany | 0) !== howMany || howMany < 0) {
        return apiRejection("expecting a positive integer");
    }
    var ret = new SomePromiseArray(promises);
    var promise = ret.promise();
    if (promise.isRejected()) {
        return promise;
    }
    ret.setHowMany(howMany);
    ret.init();
    return promise;
}

Promise.some = function Promise$Some(promises, howMany) {
    return Promise$_Some(promises, howMany);
};

Promise.prototype.some = function Promise$some(howMany) {
    return Promise$_Some(this, howMany);
};

Promise._SomePromiseArray = SomePromiseArray;
};

},{"./util.js":66,"./errors.js":68}],89:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray) {
var util = require("./util.js");
var async = require("./async.js");
var errors = require("./errors.js");
var tryCatch1 = util.tryCatch1;
var errorObj = util.errorObj;

Promise.prototype.progressed = function Promise$progressed(handler) {
    return this._then(void 0, void 0, handler, void 0, void 0);
};

Promise.prototype._progress = function Promise$_progress(progressValue) {
    if (this._isFollowingOrFulfilledOrRejected()) return;
    this._progressUnchecked(progressValue);

};

Promise.prototype._progressHandlerAt =
function Promise$_progressHandlerAt(index) {
    return index === 0
        ? this._progressHandler0
        : this[(index << 2) + index - 5 + 2];
};

Promise.prototype._doProgressWith =
function Promise$_doProgressWith(progression) {
    var progressValue = progression.value;
    var handler = progression.handler;
    var promise = progression.promise;
    var receiver = progression.receiver;

    var ret = tryCatch1(handler, receiver, progressValue);
    if (ret === errorObj) {
        if (ret.e != null &&
            ret.e.name !== "StopProgressPropagation") {
            var trace = errors.canAttach(ret.e)
                ? ret.e : new Error(ret.e + "");
            promise._attachExtraTrace(trace);
            promise._progress(ret.e);
        }
    } else if (ret instanceof Promise) {
        ret._then(promise._progress, null, null, promise, void 0);
    } else {
        promise._progress(ret);
    }
};


Promise.prototype._progressUnchecked =
function Promise$_progressUnchecked(progressValue) {
    if (!this.isPending()) return;
    var len = this._length();
    var progress = this._progress;
    for (var i = 0; i < len; i++) {
        var handler = this._progressHandlerAt(i);
        var promise = this._promiseAt(i);
        if (!(promise instanceof Promise)) {
            var receiver = this._receiverAt(i);
            if (typeof handler === "function") {
                handler.call(receiver, progressValue, promise);
            } else if (receiver instanceof Promise && receiver._isProxied()) {
                receiver._progressUnchecked(progressValue);
            } else if (receiver instanceof PromiseArray) {
                receiver._promiseProgressed(progressValue, promise);
            }
            continue;
        }

        if (typeof handler === "function") {
            async.invoke(this._doProgressWith, this, {
                handler: handler,
                promise: promise,
                receiver: this._receiverAt(i),
                value: progressValue
            });
        } else {
            async.invoke(progress, promise, progressValue);
        }
    }
};
};

},{"./util.js":66,"./async.js":67,"./errors.js":68}],90:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var errors = require("./errors.js");
var canAttach = errors.canAttach;
var async = require("./async.js");
var CancellationError = errors.CancellationError;

Promise.prototype._cancel = function Promise$_cancel(reason) {
    if (!this.isCancellable()) return this;
    var parent;
    var promiseToReject = this;
    while ((parent = promiseToReject._cancellationParent) !== void 0 &&
        parent.isCancellable()) {
        promiseToReject = parent;
    }
    promiseToReject._attachExtraTrace(reason);
    promiseToReject._rejectUnchecked(reason);
};

Promise.prototype.cancel = function Promise$cancel(reason) {
    if (!this.isCancellable()) return this;
    reason = reason !== void 0
        ? (canAttach(reason) ? reason : new Error(reason + ""))
        : new CancellationError();
    async.invokeLater(this._cancel, this, reason);
    return this;
};

Promise.prototype.cancellable = function Promise$cancellable() {
    if (this._cancellable()) return this;
    this._setCancellable();
    this._cancellationParent = void 0;
    return this;
};

Promise.prototype.uncancellable = function Promise$uncancellable() {
    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 2 | 4);
    ret._follow(this);
    ret._unsetCancellable();
    return ret;
};

Promise.prototype.fork =
function Promise$fork(didFulfill, didReject, didProgress) {
    var ret = this._then(didFulfill, didReject, didProgress,
                         void 0, void 0);

    ret._setCancellable();
    ret._cancellationParent = void 0;
    return ret;
};
};

},{"./errors.js":68,"./async.js":67}],94:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function (Promise, apiRejection, cast) {
    var TypeError = require("./errors.js").TypeError;
    var inherits = require("./util.js").inherits;
    var PromiseInspection = Promise.PromiseInspection;

    function inspectionMapper(inspections) {
        var len = inspections.length;
        for (var i = 0; i < len; ++i) {
            var inspection = inspections[i];
            if (inspection.isRejected()) {
                return Promise.reject(inspection.error());
            }
            inspections[i] = inspection.value();
        }
        return inspections;
    }

    function thrower(e) {
        setTimeout(function(){throw e;}, 0);
    }

    function dispose(resources, inspection) {
        var i = 0;
        var len = resources.length;
        var ret = Promise.defer();
        function iterator() {
            if (i >= len) return ret.resolve();
            var maybePromise = cast(resources[i++], void 0);
            if (maybePromise instanceof Promise &&
                maybePromise._isDisposable()) {
                try {
                    maybePromise = cast(maybePromise._getDisposer()
                                        .tryDispose(inspection), void 0);
                } catch (e) {
                    return thrower(e);
                }
                if (maybePromise instanceof Promise) {
                    return maybePromise._then(iterator, thrower,
                                              null, null, null);
                }
            }
            iterator();
        }
        iterator();
        return ret.promise;
    }

    function disposerSuccess(value) {
        var inspection = new PromiseInspection();
        inspection._settledValue = value;
        inspection._bitField = 268435456;
        return dispose(this, inspection).thenReturn(value);
    }

    function disposerFail(reason) {
        var inspection = new PromiseInspection();
        inspection._settledValue = reason;
        inspection._bitField = 134217728;
        return dispose(this, inspection).thenThrow(reason);
    }

    function Disposer(data, promise) {
        this._data = data;
        this._promise = promise;
    }

    Disposer.prototype.data = function Disposer$data() {
        return this._data;
    };

    Disposer.prototype.promise = function Disposer$promise() {
        return this._promise;
    };

    Disposer.prototype.resource = function Disposer$resource() {
        if (this.promise().isFulfilled()) {
            return this.promise().value();
        }
        return null;
    };

    Disposer.prototype.tryDispose = function(inspection) {
        var resource = this.resource();
        var ret = resource !== null
            ? this.doDispose(resource, inspection) : null;
        this._promise._unsetDisposable();
        this._data = this._promise = null;
        return ret;
    };

    function FunctionDisposer(fn, promise) {
        this.constructor$(fn, promise);
    }
    inherits(FunctionDisposer, Disposer);

    FunctionDisposer.prototype.doDispose = function (resource, inspection) {
        var fn = this.data();
        return fn.call(resource, resource, inspection);
    };

    Promise.using = function Promise$using() {
        var len = arguments.length;
        if (len < 2) return apiRejection(
                        "you must pass at least 2 arguments to Promise.using");
        var fn = arguments[len - 1];
        if (typeof fn !== "function") return apiRejection("fn must be a function");
        len--;
        var resources = new Array(len);
        for (var i = 0; i < len; ++i) {
            var resource = arguments[i];
            if (resource instanceof Disposer) {
                var disposer = resource;
                resource = resource.promise();
                resource._setDisposable(disposer);
            }
            resources[i] = resource;
        }

        return Promise.settle(resources)
            .then(inspectionMapper)
            .spread(fn)
            ._then(disposerSuccess, disposerFail, void 0, resources, void 0);
    };

    Promise.prototype._setDisposable =
    function Promise$_setDisposable(disposer) {
        this._bitField = this._bitField | 262144;
        this._disposer = disposer;
    };

    Promise.prototype._isDisposable = function Promise$_isDisposable() {
        return (this._bitField & 262144) > 0;
    };

    Promise.prototype._getDisposer = function Promise$_getDisposer() {
        return this._disposer;
    };

    Promise.prototype._unsetDisposable = function Promise$_unsetDisposable() {
        this._bitField = this._bitField & (~262144);
        this._disposer = void 0;
    };

    Promise.prototype.disposer = function Promise$disposer(fn) {
        if (typeof fn === "function") {
            return new FunctionDisposer(fn, this);
        }
        throw new TypeError();
    };

};

},{"./errors.js":68,"./util.js":66}],78:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var _setTimeout = function(fn, ms) {
    var len = arguments.length;
    var arg0 = arguments[2];
    var arg1 = arguments[3];
    var arg2 = len >= 5 ? arguments[4] : void 0;
    setTimeout(function() {
        fn(arg0, arg1, arg2);
    }, ms);
};

module.exports = function(Promise, INTERNAL, cast) {
var util = require("./util.js");
var errors = require("./errors.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var TimeoutError = Promise.TimeoutError;

var afterTimeout = function Promise$_afterTimeout(promise, message, ms) {
    if (!promise.isPending()) return;
    if (typeof message !== "string") {
        message = "operation timed out after" + " " + ms + " ms"
    }
    var err = new TimeoutError(message);
    errors.markAsOriginatingFromRejection(err);
    promise._attachExtraTrace(err);
    promise._cancel(err);
};

var afterDelay = function Promise$_afterDelay(value, promise) {
    promise._fulfill(value);
};

var delay = Promise.delay = function Promise$Delay(value, ms) {
    if (ms === void 0) {
        ms = value;
        value = void 0;
    }
    ms = +ms;
    var maybePromise = cast(value, void 0);
    var promise = new Promise(INTERNAL);

    if (maybePromise instanceof Promise) {
        promise._propagateFrom(maybePromise, 7);
        promise._follow(maybePromise);
        return promise.then(function(value) {
            return Promise.delay(value, ms);
        });
    } else {
        promise._setTrace(void 0);
        _setTimeout(afterDelay, ms, value, promise);
    }
    return promise;
};

Promise.prototype.delay = function Promise$delay(ms) {
    return delay(this, ms);
};

Promise.prototype.timeout = function Promise$timeout(ms, message) {
    ms = +ms;

    var ret = new Promise(INTERNAL);
    ret._propagateFrom(this, 7);
    ret._follow(this);
    _setTimeout(afterTimeout, ms, ret, message, ms);
    return ret.cancellable();
};

};

},{"./util.js":66,"./errors.js":68,"./errors_api_rejection":95}],95:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise) {
var TypeError = require('./errors.js').TypeError;

function apiRejection(msg) {
    var error = new TypeError(msg);
    var ret = Promise.rejected(error);
    var parent = ret._peekContext();
    if (parent != null) {
        parent._attachExtraTrace(error);
    }
    return ret;
}

return apiRejection;
};

},{"./errors.js":68}],83:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, INTERNAL) {
var THIS = {};
var util = require("./util.js");
var nodebackForPromise = require("./promise_resolver.js")
    ._nodebackForPromise;
var withAppended = util.withAppended;
var maybeWrapAsError = util.maybeWrapAsError;
var canEvaluate = util.canEvaluate;
var TypeError = require("./errors").TypeError;
var defaultSuffix = "Async";
var defaultFilter = function(name, func) {
    return util.isIdentifier(name) &&
        name.charAt(0) !== "_" &&
        !util.isClass(func);
};
var defaultPromisified = {__isPromisified__: true};


function escapeIdentRegex(str) {
    return str.replace(/([$])/, "\\$");
}

function isPromisified(fn) {
    try {
        return fn.__isPromisified__ === true;
    }
    catch (e) {
        return false;
    }
}

function hasPromisified(obj, key, suffix) {
    var val = util.getDataPropertyOrDefault(obj, key + suffix,
                                            defaultPromisified);
    return val ? isPromisified(val) : false;
}
function checkValid(ret, suffix, suffixRegexp) {
    for (var i = 0; i < ret.length; i += 2) {
        var key = ret[i];
        if (suffixRegexp.test(key)) {
            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, "");
            for (var j = 0; j < ret.length; j += 2) {
                if (ret[j] === keyWithoutAsyncSuffix) {
                    throw new TypeError("Cannot promisify an API " +
                        "that has normal methods with '"+suffix+"'-suffix");
                }
            }
        }
    }
}

function promisifiableMethods(obj, suffix, suffixRegexp, filter) {
    var keys = util.inheritedDataKeys(obj);
    var ret = [];
    for (var i = 0; i < keys.length; ++i) {
        var key = keys[i];
        var value = obj[key];
        if (typeof value === "function" &&
            !isPromisified(value) &&
            !hasPromisified(obj, key, suffix) &&
            filter(key, value, obj)) {
            ret.push(key, value);
        }
    }
    checkValid(ret, suffix, suffixRegexp);
    return ret;
}

function switchCaseArgumentOrder(likelyArgumentCount) {
    var ret = [likelyArgumentCount];
    var min = Math.max(0, likelyArgumentCount - 1 - 5);
    for(var i = likelyArgumentCount - 1; i >= min; --i) {
        if (i === likelyArgumentCount) continue;
        ret.push(i);
    }
    for(var i = likelyArgumentCount + 1; i <= 5; ++i) {
        ret.push(i);
    }
    return ret;
}

function argumentSequence(argumentCount) {
    return util.filledRange(argumentCount, "arguments[", "]");
}

function parameterDeclaration(parameterCount) {
    return util.filledRange(parameterCount, "_arg", "");
}

function parameterCount(fn) {
    if (typeof fn.length === "number") {
        return Math.max(Math.min(fn.length, 1023 + 1), 0);
    }
    return 0;
}

function generatePropertyAccess(key) {
    if (util.isIdentifier(key)) {
        return "." + key;
    }
    else return "['" + key.replace(/(['\\])/g, "\\$1") + "']";
}

function makeNodePromisifiedEval(callback, receiver, originalName, fn, suffix) {
    var newParameterCount = Math.max(0, parameterCount(fn) - 1);
    var argumentOrder = switchCaseArgumentOrder(newParameterCount);
    var callbackName =
        (typeof originalName === "string" && util.isIdentifier(originalName)
            ? originalName + suffix
            : "promisified");

    function generateCallForArgumentCount(count) {
        var args = argumentSequence(count).join(", ");
        var comma = count > 0 ? ", " : "";
        var ret;
        if (typeof callback === "string") {
            ret = "                                                          \n\
                this.method(args, fn);                                       \n\
                break;                                                       \n\
            ".replace(".method", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            ret =  "                                                         \n\
                callback.call(this, args, fn);                               \n\
                break;                                                       \n\
            ";
        } else if (receiver !== void 0) {
            ret =  "                                                         \n\
                callback.call(receiver, args, fn);                           \n\
                break;                                                       \n\
            ";
        } else {
            ret =  "                                                         \n\
                callback(args, fn);                                          \n\
                break;                                                       \n\
            ";
        }
        return ret.replace("args", args).replace(", ", comma);
    }

    function generateArgumentSwitchCase() {
        var ret = "";
        for(var i = 0; i < argumentOrder.length; ++i) {
            ret += "case " + argumentOrder[i] +":" +
                generateCallForArgumentCount(argumentOrder[i]);
        }
        var codeForCall;
        if (typeof callback === "string") {
            codeForCall = "                                                  \n\
                this.property.apply(this, args);                             \n\
            "
                .replace(".property", generatePropertyAccess(callback));
        } else if (receiver === THIS) {
            codeForCall = "                                                  \n\
                callback.apply(this, args);                                  \n\
            ";
        } else {
            codeForCall = "                                                  \n\
                callback.apply(receiver, args);                              \n\
            ";
        }

        ret += "                                                             \n\
        default:                                                             \n\
            var args = new Array(len + 1);                                   \n\
            var i = 0;                                                       \n\
            for (var i = 0; i < len; ++i) {                                  \n\
               args[i] = arguments[i];                                       \n\
            }                                                                \n\
            args[i] = fn;                                                    \n\
            [CodeForCall]                                                    \n\
            break;                                                           \n\
        ".replace("[CodeForCall]", codeForCall);
        return ret;
    }

    return new Function("Promise",
                        "callback",
                        "receiver",
                        "withAppended",
                        "maybeWrapAsError",
                        "nodebackForPromise",
                        "INTERNAL","                                         \n\
        var ret = function FunctionName(Parameters) {                        \n\
            'use strict';                                                    \n\
            var len = arguments.length;                                      \n\
            var promise = new Promise(INTERNAL);                             \n\
            promise._setTrace(void 0);                                       \n\
            var fn = nodebackForPromise(promise);                            \n\
            try {                                                            \n\
                switch(len) {                                                \n\
                    [CodeForSwitchCase]                                      \n\
                }                                                            \n\
            } catch (e) {                                                    \n\
                var wrapped = maybeWrapAsError(e);                           \n\
                promise._attachExtraTrace(wrapped);                          \n\
                promise._reject(wrapped);                                    \n\
            }                                                                \n\
            return promise;                                                  \n\
        };                                                                   \n\
        ret.__isPromisified__ = true;                                        \n\
        return ret;                                                          \n\
        "
        .replace("FunctionName", callbackName)
        .replace("Parameters", parameterDeclaration(newParameterCount))
        .replace("[CodeForSwitchCase]", generateArgumentSwitchCase()))(
            Promise,
            callback,
            receiver,
            withAppended,
            maybeWrapAsError,
            nodebackForPromise,
            INTERNAL
        );
}

function makeNodePromisifiedClosure(callback, receiver) {
    function promisified() {
        var _receiver = receiver;
        if (receiver === THIS) _receiver = this;
        if (typeof callback === "string") {
            callback = _receiver[callback];
        }
        var promise = new Promise(INTERNAL);
        promise._setTrace(void 0);
        var fn = nodebackForPromise(promise);
        try {
            callback.apply(_receiver, withAppended(arguments, fn));
        } catch(e) {
            var wrapped = maybeWrapAsError(e);
            promise._attachExtraTrace(wrapped);
            promise._reject(wrapped);
        }
        return promise;
    }
    promisified.__isPromisified__ = true;
    return promisified;
}

var makeNodePromisified = canEvaluate
    ? makeNodePromisifiedEval
    : makeNodePromisifiedClosure;

function promisifyAll(obj, suffix, filter, promisifier) {
    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + "$");
    var methods =
        promisifiableMethods(obj, suffix, suffixRegexp, filter);

    for (var i = 0, len = methods.length; i < len; i+= 2) {
        var key = methods[i];
        var fn = methods[i+1];
        var promisifiedKey = key + suffix;
        obj[promisifiedKey] = promisifier === makeNodePromisified
                ? makeNodePromisified(key, THIS, key, fn, suffix)
                : promisifier(fn);
    }
    util.toFastProperties(obj);
    return obj;
}

function promisify(callback, receiver) {
    return makeNodePromisified(callback, receiver, void 0, callback);
}

Promise.promisify = function Promise$Promisify(fn, receiver) {
    if (typeof fn !== "function") {
        throw new TypeError("fn must be a function");
    }
    if (isPromisified(fn)) {
        return fn;
    }
    return promisify(fn, arguments.length < 2 ? THIS : receiver);
};

Promise.promisifyAll = function Promise$PromisifyAll(target, options) {
    if (typeof target !== "function" && typeof target !== "object") {
        throw new TypeError("the target of promisifyAll must be an object or a function");
    }
    options = Object(options);
    var suffix = options.suffix;
    if (typeof suffix !== "string") suffix = defaultSuffix;
    var filter = options.filter;
    if (typeof filter !== "function") filter = defaultFilter;
    var promisifier = options.promisifier;
    if (typeof promisifier !== "function") promisifier = makeNodePromisified;

    if (!util.isIdentifier(suffix)) {
        throw new RangeError("suffix must be a valid identifier");
    }

    var keys = util.inheritedDataKeys(target, {includeHidden: true});
    for (var i = 0; i < keys.length; ++i) {
        var value = target[keys[i]];
        if (keys[i] !== "constructor" &&
            util.isClass(value)) {
            promisifyAll(value.prototype, suffix, filter, promisifier);
            promisifyAll(value, suffix, filter, promisifier);
        }
    }

    return promisifyAll(target, suffix, filter, promisifier);
};
};


},{"./util.js":66,"./promise_resolver.js":73,"./errors":68}],85:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
module.exports = function(Promise, PromiseArray, cast) {
var util = require("./util.js");
var apiRejection = require("./errors_api_rejection")(Promise);
var isObject = util.isObject;
var es5 = require("./es5.js");

function PropertiesPromiseArray(obj) {
    var keys = es5.keys(obj);
    var len = keys.length;
    var values = new Array(len * 2);
    for (var i = 0; i < len; ++i) {
        var key = keys[i];
        values[i] = obj[key];
        values[i + len] = key;
    }
    this.constructor$(values);
}
util.inherits(PropertiesPromiseArray, PromiseArray);

PropertiesPromiseArray.prototype._init =
function PropertiesPromiseArray$_init() {
    this._init$(void 0, -3) ;
};

PropertiesPromiseArray.prototype._promiseFulfilled =
function PropertiesPromiseArray$_promiseFulfilled(value, index) {
    if (this._isResolved()) return;
    this._values[index] = value;
    var totalResolved = ++this._totalResolved;
    if (totalResolved >= this._length) {
        var val = {};
        var keyOffset = this.length();
        for (var i = 0, len = this.length(); i < len; ++i) {
            val[this._values[i + keyOffset]] = this._values[i];
        }
        this._resolve(val);
    }
};

PropertiesPromiseArray.prototype._promiseProgressed =
function PropertiesPromiseArray$_promiseProgressed(value, index) {
    if (this._isResolved()) return;

    this._promise._progress({
        key: this._values[index + this.length()],
        value: value
    });
};

PropertiesPromiseArray.prototype.shouldCopyValues =
function PropertiesPromiseArray$_shouldCopyValues() {
    return false;
};

PropertiesPromiseArray.prototype.getActualLength =
function PropertiesPromiseArray$getActualLength(len) {
    return len >> 1;
};

function Promise$_Props(promises) {
    var ret;
    var castValue = cast(promises, void 0);

    if (!isObject(castValue)) {
        return apiRejection("cannot await properties of a non-object");
    } else if (castValue instanceof Promise) {
        ret = castValue._then(Promise.props, void 0, void 0, void 0, void 0);
    } else {
        ret = new PropertiesPromiseArray(castValue).promise();
    }

    if (castValue instanceof Promise) {
        ret._propagateFrom(castValue, 4);
    }
    return ret;
}

Promise.prototype.props = function Promise$props() {
    return Promise$_Props(this);
};

Promise.props = function Promise$Props(promises) {
    return Promise$_Props(promises);
};
};

},{"./util.js":66,"./es5.js":96,"./errors_api_rejection":95}],98:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
function arrayCopy(src, srcIndex, dst, dstIndex, len) {
    for (var j = 0; j < len; ++j) {
        dst[j + dstIndex] = src[j + srcIndex];
    }
}

function Queue(capacity) {
    this._capacity = capacity;
    this._length = 0;
    this._front = 0;
    this._makeCapacity();
}

Queue.prototype._willBeOverCapacity =
function Queue$_willBeOverCapacity(size) {
    return this._capacity < size;
};

Queue.prototype._pushOne = function Queue$_pushOne(arg) {
    var length = this.length();
    this._checkCapacity(length + 1);
    var i = (this._front + length) & (this._capacity - 1);
    this[i] = arg;
    this._length = length + 1;
};

Queue.prototype.push = function Queue$push(fn, receiver, arg) {
    var length = this.length() + 3;
    if (this._willBeOverCapacity(length)) {
        this._pushOne(fn);
        this._pushOne(receiver);
        this._pushOne(arg);
        return;
    }
    var j = this._front + length - 3;
    this._checkCapacity(length);
    var wrapMask = this._capacity - 1;
    this[(j + 0) & wrapMask] = fn;
    this[(j + 1) & wrapMask] = receiver;
    this[(j + 2) & wrapMask] = arg;
    this._length = length;
};

Queue.prototype.shift = function Queue$shift() {
    var front = this._front,
        ret = this[front];

    this[front] = void 0;
    this._front = (front + 1) & (this._capacity - 1);
    this._length--;
    return ret;
};

Queue.prototype.length = function Queue$length() {
    return this._length;
};

Queue.prototype._makeCapacity = function Queue$_makeCapacity() {
    var len = this._capacity;
    for (var i = 0; i < len; ++i) {
        this[i] = void 0;
    }
};

Queue.prototype._checkCapacity = function Queue$_checkCapacity(size) {
    if (this._capacity < size) {
        this._resizeTo(this._capacity << 3);
    }
};

Queue.prototype._resizeTo = function Queue$_resizeTo(capacity) {
    var oldFront = this._front;
    var oldCapacity = this._capacity;
    var oldQueue = new Array(oldCapacity);
    var length = this.length();

    arrayCopy(this, 0, oldQueue, 0, oldCapacity);
    this._capacity = capacity;
    this._makeCapacity();
    this._front = 0;
    if (oldFront + length <= oldCapacity) {
        arrayCopy(oldQueue, oldFront, this, 0, length);
    } else {        var lengthBeforeWrapping =
            length - ((oldFront + length) & (oldCapacity - 1));

        arrayCopy(oldQueue, oldFront, this, 0, lengthBeforeWrapping);
        arrayCopy(oldQueue, 0, this, lengthBeforeWrapping,
                    length - lengthBeforeWrapping);
    }
};

module.exports = Queue;

},{}],97:[function(require,module,exports){
(function(process){/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
"use strict";
var schedule;
var _MutationObserver;
if (typeof process === "object" && typeof process.version === "string") {
    schedule = function Promise$_Scheduler(fn) {
        process.nextTick(fn);
    };
}
else if ((typeof MutationObserver !== "undefined" &&
         (_MutationObserver = MutationObserver)) ||
         (typeof WebKitMutationObserver !== "undefined" &&
         (_MutationObserver = WebKitMutationObserver))) {
    schedule = (function() {
        var div = document.createElement("div");
        var queuedFn = void 0;
        var observer = new _MutationObserver(
            function Promise$_Scheduler() {
                var fn = queuedFn;
                queuedFn = void 0;
                fn();
            }
       );
        observer.observe(div, {
            attributes: true
        });
        return function Promise$_Scheduler(fn) {
            queuedFn = fn;
            div.setAttribute("class", "foo");
        };

    })();
}
else if (typeof setTimeout !== "undefined") {
    schedule = function Promise$_Scheduler(fn) {
        setTimeout(fn, 0);
    };
}
else throw new Error("no async scheduler available");
module.exports = schedule;

})(require("__browserify_process"))
},{"__browserify_process":65}],96:[function(require,module,exports){
/**
 * Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
var isES5 = (function(){
    "use strict";
    return this === void 0;
})();

if (isES5) {
    module.exports = {
        freeze: Object.freeze,
        defineProperty: Object.defineProperty,
        keys: Object.keys,
        getPrototypeOf: Object.getPrototypeOf,
        isArray: Array.isArray,
        isES5: isES5
    };
} else {
    var has = {}.hasOwnProperty;
    var str = {}.toString;
    var proto = {}.constructor.prototype;

    var ObjectKeys = function ObjectKeys(o) {
        var ret = [];
        for (var key in o) {
            if (has.call(o, key)) {
                ret.push(key);
            }
        }
        return ret;
    }

    var ObjectDefineProperty = function ObjectDefineProperty(o, key, desc) {
        o[key] = desc.value;
        return o;
    }

    var ObjectFreeze = function ObjectFreeze(obj) {
        return obj;
    }

    var ObjectGetPrototypeOf = function ObjectGetPrototypeOf(obj) {
        try {
            return Object(obj).constructor.prototype;
        }
        catch (e) {
            return proto;
        }
    }

    var ArrayIsArray = function ArrayIsArray(obj) {
        try {
            return str.call(obj) === "[object Array]";
        }
        catch(e) {
            return false;
        }
    }

    module.exports = {
        isArray: ArrayIsArray,
        keys: ObjectKeys,
        defineProperty: ObjectDefineProperty,
        freeze: ObjectFreeze,
        getPrototypeOf: ObjectGetPrototypeOf,
        isES5: isES5
    };
}

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvaW5kZXguanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L25vZGUuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3dlYi5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvcnVudGltZS9pbmRleC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYnJvd3NlcmlmeTItbGlzdC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvbWV0aG9kLXNwZWMuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvY29tcG9uZW50LWxvYWRlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvdXRpbC9yZXRyeWFibGUuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvdGltZXIuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3V0aWwvcGVyaW9kaWMuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvZGlzcGF0Y2hlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9vcHRpb25zLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2NvdW50ZG93bi1sYXRjaC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9sYW5nLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3N0YXRlLWd1YXJkLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3B1Yi1zdWIuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvbGxlY3Rpb24vb2JqZWN0LWhhc2gtbWFwLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb2xsZWN0aW9uL2RvdWJseS1saW5rZWQtbGlzdC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29sbGVjdGlvbi9scnUtaGFzaC1tYXAuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3N0b3JhZ2UvY2FjaGluZy1kYXRhLXN0b3JlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2xydS1kYXRhLXN0b3JlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL2luLW1lbW9yeS1kYXRhLXN0b3JlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zdG9yYWdlL3NpZ25hbGluZy1kYXRhLXN0b3JlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlndXJhdGlvbi1tYWdpYy5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2FwcC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvbWVzc2FnaW5nL2V4Y2hhbmdlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvY291cmllci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS91dWlkLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC91dGlsL2NvbXBvbmVudC1yZWdpc3RyeS5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvc2NoZWR1bGVyL2luZGV4LmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy91bmRlcnNjb3JlL3VuZGVyc2NvcmUuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL21vcmkvbW9yaS5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXIuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1jb21wb3NpdGUtc2VxdWVuY2VyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC90aW1lL2Nsb2NrL2xvZ2ljYWwtY2xvY2suanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3RpbWUvY2xvY2svc3lzdGVtLWNsb2NrLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2xvZ2dpbmcvbG9nZ2VyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL2NoYW5uZWwvY2hhbm5lbC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZmliZXIvaW4tbWVtb3J5LWZpYmVyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvZmliZXIvbGlua2FibGUtZmliZXIuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L2NvcmUvc2VyZGUvanNvbi1zZXJkZS5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvY2xpZW50LXNwZWMuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3BsYXRmb3JtL2NsaWVudC1idWlsZGVyL2NsaWVudC1idWlsZGVyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3JlZi9pbmRleC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9ibHVlYmlyZC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L2Jvb3RzdHJhcHBlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvYXBwa2l0L3dlYi1hcHAtY29udGFpbmVyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9zY2hlZHVsZXIvd2ViLXNjaGVkdWxlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvcnVudGltZS9kZWZhdWx0LXJ1bnRpbWUuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3N0b3JhZ2UvaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5LmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9hcHBraXQvaW50ZXJuYWwvcHJvY2Vzcy1rZWVwLWFsaXZlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9tZXNzYWdpbmcvaW50ZXJuYWxzL21haWxib3guanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbGliLXdlYi90aGlja2V0L3BsYXRmb3JtL2NsaWVudC1idWlsZGVyL2Jhc2UtY2xpZW50LmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5Mi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvbWlzZS5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9yZWYvcmVmLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L2xpYi13ZWIvdGhpY2tldC9jb3JlL3JlZi9kZWxlZ2F0aW5nLXJlZi5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9zeW5jaHJvbm91c19pbnNwZWN0aW9uLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2ZpbHRlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9hbnkuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZWFjaC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9saWItd2ViL3RoaWNrZXQvY29yZS9zY2hlZHVsZXIvc2V0LXRpbWVvdXQtc2NoZWR1bGVyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3V0aWwuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vYXN5bmMuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZXJyb3JzLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3RoZW5hYmxlcy5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNlX2FycmF5LmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhcHR1cmVkX3RyYWNlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhdGNoX2ZpbHRlci5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9wcm9taXNlX3Jlc29sdmVyLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2ZpbmFsbHkuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZGlyZWN0X3Jlc29sdmUuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vam9pbi5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9yYWNlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhbGxfZ2V0LmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2dlbmVyYXRvcnMuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vbWFwLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL25vZGVpZnkuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcmVkdWNlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NldHRsZS5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi9zb21lLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3Byb2dyZXNzLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2NhbmNlbC5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi91c2luZy5qcyIsIi9Vc2Vycy9tYXNlYi9JZGVhUHJvamVjdHMvdGhpY2tldC9ub2RlX21vZHVsZXMvYmx1ZWJpcmQvanMvbWFpbi90aW1lcnMuanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vZXJyb3JzX2FwaV9yZWplY3Rpb24uanMiLCIvVXNlcnMvbWFzZWIvSWRlYVByb2plY3RzL3RoaWNrZXQvbm9kZV9tb2R1bGVzL2JsdWViaXJkL2pzL21haW4vcHJvbWlzaWZ5LmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3Byb3BzLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3F1ZXVlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL3NjaGVkdWxlLmpzIiwiL1VzZXJzL21hc2ViL0lkZWFQcm9qZWN0cy90aGlja2V0L25vZGVfbW9kdWxlcy9ibHVlYmlyZC9qcy9tYWluL2VzNS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xQQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaktBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdlFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3g0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2paQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdktBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN01BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2aENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1UUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgQ29tcG9uZW50UmVnaXN0cnksXG4gIHdlYkFsaWFzZXMsXG4gIG5vZGVBbGlhc2VzXG4pIHtcbiAgdmFyIGMgPSBuZXcgQ29tcG9uZW50UmVnaXN0cnkoKTtcblxuXG4gIGMucmVnaXN0ZXJNYW55KFtcbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3V0aWwvY29tcG9uZW50LWxvYWRlclwiKSxcbiAgICAgIGFzOiBcImNvbXBvbmVudC1sb2FkZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3V0aWwvcGVyaW9kaWNcIiksXG4gICAgICBhczogXCJwZXJpb2RpY1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vdXRpbC9yZXRyeWFibGVcIiksXG4gICAgICBhczogXCJyZXRyeWFibGVcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3V0aWwvdGltZXJcIiksXG4gICAgICBhczogXCJ0aW1lclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9kaXNwYXRjaGVyXCIpLFxuICAgICAgYXM6IFwiZGlzcGF0Y2hlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jb3VudGRvd24tbGF0Y2hcIiksXG4gICAgICBhczogXCJjb3VudGRvd24tbGF0Y2hcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvb3B0aW9uc1wiKSxcbiAgICAgIGFzOiBcIm9wdGlvbnNcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvbGFuZ1wiKSxcbiAgICAgIGFzOiBcImxhbmdcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvcmVmXCIpLFxuICAgICAgYXM6IFwicmVmXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3N0YXRlLWd1YXJkXCIpLFxuICAgICAgYXM6IFwic3RhdGUtZ3VhcmRcIlxuICAgIH0sXG5cblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9wdWItc3ViXCIpLFxuICAgICAgYXM6IFwicHViLXN1YlwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvdW5pdC1zZXF1ZW5jZXJcIiksXG4gICAgICBhczogW1widW5pdC1zZXF1ZW5jZXJcIiwgXCJzZXF1ZW5jZXJcIl1cbiAgICB9LFxuXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlclwiKSxcbiAgICAgIGFzOiBcImNsb2NrLXNlcXVlbmNlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1jb21wb3NpdGUtc2VxdWVuY2VyXCIpLFxuICAgICAgYXM6IFwiZGVsZWdhdGluZy1jb21wb3NpdGUtc2VxdWVuY2VyXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci9kZWxlZ2F0aW5nLWZvcndhcmRpbmctc2VxdWVuY2VyXCIpLFxuICAgICAgYXM6IFwiZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29sbGVjdGlvbi9kb3VibHktbGlua2VkLWxpc3RcIiksXG4gICAgICBhczogXCJkb3VibHktbGlua2VkLWxpc3RcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vb2JqZWN0LWhhc2gtbWFwXCIpLFxuICAgICAgYXM6IFtcImhhc2gtbWFwXCIsIFwib2JqZWN0LWhhc2gtbWFwXCJdXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29sbGVjdGlvbi9scnUtaGFzaC1tYXBcIiksXG4gICAgICBhczogXCJscnUtaGFzaC1tYXBcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2UvY2FjaGluZy1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwiY2FjaGluZy1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9zdG9yYWdlL2luLW1lbW9yeS1kYXRhLXN0b3JlXCIpLFxuICAgICAgYXM6IFwiaW4tbWVtb3J5LWRhdGEtc3RvcmVcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3N0b3JhZ2UvbHJ1LWRhdGEtc3RvcmVcIiksXG4gICAgICBhczogXCJscnUtZGF0YS1zdG9yZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZVwiKSxcbiAgICAgIGFzOiBcInNpZ25hbGluZy1kYXRhLXN0b3JlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi90aW1lL2Nsb2NrL2xvZ2ljYWwtY2xvY2tcIiksXG4gICAgICBhczogXCJsb2dpY2FsLWNsb2NrXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi90aW1lL2Nsb2NrL3N5c3RlbS1jbG9ja1wiKSxcbiAgICAgIGFzOiBcInN5c3RlbS1jbG9ja1wiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZ3VyYXRpb24tbWFnaWNcIiksXG4gICAgICBhczogXCJjb25maWd1cmF0aW9uLW1hZ2ljXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyXCIpLFxuICAgICAgYXM6IFwic2NvcGVkLWNvbmZpZ3VyYXRpb24tcmVzb2x2ZXJcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb25cIiksXG4gICAgICBhczogW1wic2NvcGVkLWNvbmZpZ3VyYXRpb25cIiwgXCJjb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb25cIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvYXBwXCIpLFxuICAgICAgYXM6IFwiYXBwXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9ydW50aW1lXCIpLFxuICAgICAgYXM6IFwicnVudGltZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKSxcbiAgICAgIGFzOiBcImxvZ2dlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9sb2dnaW5nL2FwcGVuZGVycy9jb25zb2xlLWxvZy1hcHBlbmRlclwiKSxcbiAgICAgIGFzOiBbXCJhcHBlbmRlcnMvY29uc29sZS1sb2dcIiwgXCJjb25zb2xlLWxvZy1hcHBlbmRlclwiXVxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICAgICAgYXM6IFwiY2hhbm5lbFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgICAgIGFzOiBcImNoYWluZWQtY2hhbm5lbFwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsXCIpLFxuICAgICAgYXM6IFwiY29tcG9zaXRlLWNoYW5uZWxcIlxuICAgIH0sXG5cbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL21lc3NhZ2luZy9leGNoYW5nZVwiKSxcbiAgICAgIGFzOiBcIm1lc3NhZ2luZy9leGNoYW5nZVwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2NvdXJpZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvY291cmllclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vbWVzc2FnaW5nL2ZpYmVyL2luLW1lbW9yeS1maWJlclwiKSxcbiAgICAgIGFzOiBcIm1lc3NhZ2luZy9maWJlcnMvaW4tbWVtb3J5XCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9tZXNzYWdpbmcvZmliZXIvbGlua2FibGUtZmliZXJcIiksXG4gICAgICBhczogXCJtZXNzYWdpbmcvZmliZXJzL2xpbmthYmxlXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3V1aWRcIiksXG4gICAgICBhczogXCJ1dWlkXCJcbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9jb3JlL3NlcmRlL2pzb24tc2VyZGVcIiksXG4gICAgICBhczogW1wic2VyZGUvanNvblwiLCBcImpzb24tc2VyZGVcIl1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlci9jbGllbnQtYnVpbGRlclwiKSxcbiAgICAgIGFzOiBcImV4cGVyaW1lbnRhbC9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlclwiXG4gICAgfSxcblxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvY2xpZW50LXNwZWNcIiksXG4gICAgICBhczogXCJleHBlcmltZW50YWwvcGxhdGZvcm0vY2xpZW50LXNwZWNcIlxuICAgIH1cbiAgXSk7XG5cbiAgYy5zZWxmUmVnaXN0ZXIoe1xuICAgIGFzOiBcImNvbXBvbmVudC1yZWdpc3RyeVwiXG4gIH0pO1xuXG4gIHdlYkFsaWFzZXMoYyk7XG4gIG5vZGVBbGlhc2VzKGMpO1xuXG4gIHJldHVybiBjO1xufTtcblxudmFyIGcgPSAodHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIiA/IHt9IDogd2luZG93KTtcbmcudGhpY2tldCA9IG1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwiLi91dGlsL2NvbXBvbmVudC1yZWdpc3RyeVwiKSxcbiAgcmVxdWlyZShcIi4vd2ViXCIpLFxuICByZXF1aXJlKFwiLi9ub2RlXCIpXG4pO1xuXG59KSgpIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjKSB7fTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYykge1xuICBjLnJlZ2lzdGVyTWFueShbXG4gICAge1xuICAgICAgbW9kdWxlOiByZXF1aXJlKFwiLi9hcHBraXQvYm9vdHN0cmFwcGVyXCIpLFxuICAgICAgYXM6IFwiYm9vdHN0cmFwcGVyXCJcbiAgICB9LFxuICAgIHtcbiAgICAgIG1vZHVsZTogcmVxdWlyZShcIi4vYXBwa2l0L3dlYi1hcHAtY29udGFpbmVyXCIpLFxuICAgICAgYXM6IFwiYXBwLWNvbnRhaW5lclwiXG4gICAgfSxcbiAgICB7XG4gICAgICBtb2R1bGU6IHJlcXVpcmUoXCIuL3NjaGVkdWxlci93ZWItc2NoZWR1bGVyXCIpLFxuICAgICAgYXM6IFwic2NoZWR1bGVyXCJcbiAgICB9XG4gIF0pO1xuXG4gIHJlcXVpcmUoXCIuL2Jyb3dzZXJpZnkyLWxpc3RcIik7XG59O1xuIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuL2RlZmF1bHQtcnVudGltZVwiKTtcblxufSkoKSIsIihmdW5jdGlvbigpe3JlcXVpcmUoXCIuL2FwcGtpdC9hcHAuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvYm9vdHN0cmFwcGVyLmpzXCIpO1xucmVxdWlyZShcIi4vYXBwa2l0L2NvbmZpZy9zY29wZWQtY29uZmlndXJhdGlvbi1yZXNvbHZlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2FwcGtpdC9jb25maWcvc2NvcGVkLWNvbmZpZ3VyYXRpb24uanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvY29uZmlndXJhdGlvbi1tYWdpYy5qc1wiKTtcbnJlcXVpcmUoXCIuL2FwcGtpdC9pbnRlcm5hbC9wcm9jZXNzLWtlZXAtYWxpdmUuanNcIik7XG5yZXF1aXJlKFwiLi9hcHBraXQvd2ViLWFwcC1jb250YWluZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb2xsZWN0aW9uL2RvdWJseS1saW5rZWQtbGlzdC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvbGxlY3Rpb24vbHJ1LWhhc2gtbWFwLmpzXCIpO1xucmVxdWlyZShcIi4vY29sbGVjdGlvbi9vYmplY3QtaGFzaC1tYXAuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY2hhaW5lZC1jaGFubmVsLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9jaGFubmVsL2NoYW5uZWwuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NoYW5uZWwvY29tcG9zaXRlLWNoYW5uZWwuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2NvdW50ZG93bi1sYXRjaC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvZGlzcGF0Y2hlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvbGFuZy5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvbG9nZ2luZy9hcHBlbmRlcnMvY29uc29sZS1sb2ctYXBwZW5kZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9vcHRpb25zLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9wdWItc3ViLmpzXCIpO1xucmVxdWlyZShcIi4vY29yZS9yZWYvZGVsZWdhdGluZy1yZWYuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3JlZi9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvcmVmL3JlZi5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2NoZWR1bGVyL3NldC10aW1lb3V0LXNjaGVkdWxlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2Nsb2NrLXNlcXVlbmNlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctY29tcG9zaXRlLXNlcXVlbmNlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VxdWVuY2VyL2RlbGVnYXRpbmctZm9yd2FyZGluZy1zZXF1ZW5jZXIuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlci5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc2VyZGUvanNvbi1zZXJkZS5qc1wiKTtcbnJlcXVpcmUoXCIuL2NvcmUvc3RhdGUtZ3VhcmQuanNcIik7XG5yZXF1aXJlKFwiLi9jb3JlL3V1aWQuanNcIik7XG5yZXF1aXJlKFwiLi9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9jb3VyaWVyLmpzXCIpO1xucmVxdWlyZShcIi4vbWVzc2FnaW5nL2V4Y2hhbmdlLmpzXCIpO1xucmVxdWlyZShcIi4vbWVzc2FnaW5nL2ZpYmVyL2luLW1lbW9yeS1maWJlci5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9maWJlci9saW5rYWJsZS1maWJlci5qc1wiKTtcbnJlcXVpcmUoXCIuL21lc3NhZ2luZy9pbnRlcm5hbHMvbWFpbGJveC5qc1wiKTtcbnJlcXVpcmUoXCIuL25vZGUuanNcIik7XG5yZXF1aXJlKFwiLi9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlci9iYXNlLWNsaWVudC5qc1wiKTtcbnJlcXVpcmUoXCIuL3BsYXRmb3JtL2NsaWVudC1idWlsZGVyL2NsaWVudC1idWlsZGVyLmpzXCIpO1xucmVxdWlyZShcIi4vcGxhdGZvcm0vY2xpZW50LWJ1aWxkZXIvY2xpZW50LXNwZWMuanNcIik7XG5yZXF1aXJlKFwiLi9wbGF0Zm9ybS9jbGllbnQtYnVpbGRlci9tZXRob2Qtc3BlYy5qc1wiKTtcbnJlcXVpcmUoXCIuL3J1bnRpbWUvZGVmYXVsdC1ydW50aW1lLmpzXCIpO1xucmVxdWlyZShcIi4vcnVudGltZS9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL3NjaGVkdWxlci9pbmRleC5qc1wiKTtcbnJlcXVpcmUoXCIuL3NjaGVkdWxlci93ZWItc2NoZWR1bGVyLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9jYWNoaW5nLWRhdGEtc3RvcmUuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL2luLW1lbW9yeS1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9pbnRlcm5hbHMvZXhwaXJpbmctZW50cnkuanNcIik7XG5yZXF1aXJlKFwiLi9zdG9yYWdlL2xydS1kYXRhLXN0b3JlLmpzXCIpO1xucmVxdWlyZShcIi4vc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZS5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svbG9naWNhbC1jbG9jay5qc1wiKTtcbnJlcXVpcmUoXCIuL3RpbWUvY2xvY2svc3lzdGVtLWNsb2NrLmpzXCIpO1xucmVxdWlyZShcIi4vdXRpbC9jb21wb25lbnQtbG9hZGVyLmpzXCIpO1xucmVxdWlyZShcIi4vdXRpbC9jb21wb25lbnQtcmVnaXN0cnkuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL3BlcmlvZGljLmpzXCIpO1xucmVxdWlyZShcIi4vdXRpbC9yZXRyeWFibGUuanNcIik7XG5yZXF1aXJlKFwiLi91dGlsL3RpbWVyLmpzXCIpO1xucmVxdWlyZShcIi4vd2ViLmpzXCIpO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIExhbmdcbikge1xuXG4gIHZhciBNZXRob2RTcGVjID0gTGFuZy5wb2pvQ2xhc3MoW1wiYXJnc1wiLCBcImRlZmF1bHRzXCIsIFwibVR5cGVcIiwgXCJyZXF1ZXN0UmVwbHlcIl0sIHtcbiAgICBkZWZhdWx0czoge1xuICAgICAgYXJnczogICAgICAgICBbXSxcbiAgICAgIGRlZmF1bHRzOiAgICAge30sXG4gICAgICByZXF1ZXN0UmVwbHk6IHRydWVcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBNZXRob2RTcGVjO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2xhbmdcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBmYWN0b3J5ID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBMaWtlIGEgYENvbXBvbmVudFJlZ2lzdHJ5YCwgYnV0IG1vZHVsZXMgYXJlIGxvYWRlZCBvbi1kZW1hbmQgcmF0aGVyIHRoYW4gZWFnZXJseSByZXF1aXJlZCBhbmQgYWxpYXNlZC4gVGhpcyBpc1xuICAgKiBkb25lIGJ5IHByb3ZpZGluZyB0aGUgdG9wLWxldmVsIGByZXF1aXJlYCBtZXRob2QgYXMgYW4gaW5pdGlhbGl6YXRpb24gcGFyYW1ldGVyLCB3aGljaCBtYWludGFpbnMgdGhlIGFwcHJvcHJpYXRlXG4gICAqIHBhdGggY29udGV4dCBmb3IgcmVzb2x2aW5nIHJlbGF0aXZlIGltcG9ydHMgbGF0ZXIuXG4gICAqXG4gICAqIE5vdGUgdGhpcyBvbmx5IHdvcmtzIGluIE5vZGUsIG5vdCBlbnZpcm9ubWVudHMgbGlrZSBCcm93c2VyaWZ5LCB3aGljaCBuZWVkIHRvIGVhZ2VybHkgcmVzb2x2ZSBhbGwgcmVxdWlyZWRcbiAgICogbW9kdWxlcyB2aWEgc3RhdGljIGFuYWx5c2lzLiBGb3IgdGhhdCwgdXNlIHRoZSBgQ29tcG9uZW50UmVnaXN0cnlgLlxuICAgKi9cbiAgdmFyIENvbXBvbmVudExvYWRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENvbXBvbmVudExvYWRlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihyZXF1aXJlRnVuKSB7XG4gICAgICB0aGlzLl9yZXF1aXJlRnVuID0gcmVxdWlyZUZ1bjtcbiAgICAgIHRoaXMuX2FsaWFzZXMgPSB7fTtcbiAgICAgIHRoaXMuX3BhdGhUcmFuc2Zvcm0gPSBmdW5jdGlvbihpZCkgeyByZXR1cm4gaWQ7fTtcbiAgICB9LFxuXG4gICAgc2V0UGF0aFRyYW5zZm9ybTogZnVuY3Rpb24ocGF0aFRyYW5zZm9ybSkge1xuICAgICAgdGhpcy5fcGF0aFRyYW5zZm9ybSA9IHBhdGhUcmFuc2Zvcm07XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgYWxpYXM6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB2YXIgYWxpYXNOYW1lICA9IG9wdHMuZ2V0T3JFcnJvcihcImFzXCIpO1xuICAgICAgdGhpcy5fYWxpYXNlc1thbGlhc05hbWVdID0gb3B0cy5nZXRPckVycm9yKFwibW9kdWxlXCIpO1xuICAgIH0sXG5cbiAgICBidWxrQWxpYXM6IGZ1bmN0aW9uKGFsaWFzZXMpIHtcbiAgICAgIF8uZWFjaChhbGlhc2VzLCBmdW5jdGlvbihhbGlhc05hbWVzLCBtb2R1bGVOYW1lKSB7XG4gICAgICAgIGlmICghXy5pc0FycmF5KGFsaWFzTmFtZXMpKSB7XG4gICAgICAgICAgYWxpYXNOYW1lcyA9IFthbGlhc05hbWVzXVxuICAgICAgICB9XG4gICAgICAgIF8uZWFjaChhbGlhc05hbWVzLCBmdW5jdGlvbihhbGlhc05hbWUpIHtcbiAgICAgICAgICB0aGlzLmFsaWFzKHttb2R1bGU6IG1vZHVsZU5hbWUsIGFzOiBhbGlhc05hbWV9KTtcbiAgICAgICAgfSwgdGhpcyk7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50OiBmdW5jdGlvbihhbGlhcykge1xuICAgICAgdmFyIG1vZCA9IHRoaXMuX2FsaWFzZXNbYWxpYXNdO1xuICAgICAgaWYgKCFtb2QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbGlhcyBwcm92aWRlZCAobm8gc3VjaCBtb2R1bGUpOiBgXCIrYWxpYXMrXCInXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVpcmVGdW4odGhpcy5fcGF0aFRyYW5zZm9ybShtb2QpKTtcbiAgICB9LFxuXG4gICAgYzogZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbXBvbmVudExvYWRlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgTGFuZyxcbiAgU3RhdGVHdWFyZCxcbiAgTG9nZ2VyXG4pIHtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIlJldHJ5YWJsZVwiKTtcblxuICB2YXIgREVGQVVMVF9CQUNLT0ZGX0NFSUxJTkcgPSA2MCAqIDEwMDAgKiAxMDsgLy8gMTAgbWludXRlc1xuXG5cbiAgLyoqXG4gICAqIEEgZGV2aWNlIHdoaWNoIHJldHJpZXMgdGhlIHByb3ZpZGVkIFByb21pc2lmaWVkIGB0YXNrYCB1bnRpbCBpdCBjb21wbGV0ZXMgd2l0aG91dCBlcnJvciwgb3IgYHJldHJpZXNgIHRpbWVzXG4gICAqIChkZWZhdWx0IGlzIGZvcmV2ZXIpLiBUaGUgcmVzdWx0cyBvZiB0aGUgYHRhc2tgIGFyZSBhY2Nlc3NpYmxlIHZpYSB0aGUgYHJlc3VsdCgpYCBwcm9taXNlLCB3aGljaCB3aWxsIGJlIGZ1bGZpbGxlZFxuICAgKiBvciByZWplY3RlZCBvbiBzdWNjZXNzIG9yIGVycm9yIChzdWNoIGFzIFJldHJ5YWJsZS5FcnJvci5NYXhSZXRyaWVzRXJyb3Igb3IgUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvcikuXG4gICAqXG4gICAqIElmIGFuIGVycm9yIG9jY3VycywgdGhlIGB0YXNrYCBpcyByZXRyaWVkIGFmdGVyIHNvbWUgdGltZSwgYXMgZGV0ZXJtaW5lZCBieSB0aGUgYGJhY2tvZmZgIGBzdHJhdGVneWAsIG9mIHdoaWNoIHR3b1xuICAgKiBhcmUgc3VwcG9ydGVkOiBgUmV0cnlhYmxlLkJhY2tvZmYuTGluZWFyYCBhbmQgYFJldHJ5YWJsZS5CYWNrb2ZmLkV4cG9uZW50aWFsYC4gVGhlIGRlZmF1bHQgc3RyYXRlZ3kgaXNcbiAgICogYFJldHJ5YWJsZS5CYWNrb2ZmLkxpbmVhcmAsIHdpdGggdGhlIHBlcmlvZCBkZXRlcm1pbmVkIGJ5OlxuICAgKlxuICAgKiBgY29lZmZpY2llbnQgKiBhdHRlbXB0TnVtICogZmFjdG9yYFxuICAgKlxuICAgKiBEZWZhdWx0IG9wdGlvbnMgZm9yIExpbmVhciBiYWNrb2ZmIGFyZTogYGZhY3RvcmAgPSAxLCBgY29lZmZpY2llbnRgID0gMjUwLlxuICAgKlxuICAgKiBGb3IgYFJldHJ5YWJsZS5CYWNrb2ZmLkV4cG9uZW50aWFsLCB0aGUgcGVyaW9kIGlzIGRldGVybWluZWQgYnk6XG4gICAqXG4gICAqIGBjb2VmZmljaWVudCAqIE1hdGgucG93KGJhc2UsIGF0dGVtcHROdW0pYFxuICAgKlxuICAgKiBEZWZhdWx0IG9wdGlvbnMgZm9yIEV4cG9uZW50aWFsIGJhY2tvZmYgYXJlOiBgY29lZmZpY2llbnQgPSAyNTBgLCBgYmFzZSA9IDJgLlxuICAgKlxuICAgKiBSZWdhcmRsZXNzIG9mIGJhY2tvZmYgc3RyYXRlZ3ksIGEgYGJhY2tvZmZDZWlsaW5nYCBjYW4gYmUgcHJvdmlkZWQuIElmIHByb3ZpZGVkLCB0aGlzIGlzIHRoZSB1cHBlciBib3VuZCBvZlxuICAgKiB0aGUgcGVyaW9kIGJldHdlZW4gdW5zdWNjZXNzZnVsIHRhc2sgcnVucy4gVGhpcyBhbGxvd3MsIGZvciBleGFtcGxlLCBhbiBleHBvbmVudGlhbCBiYWNrb2ZmIHVwIHRvIGEgY2VpbGluZyAoZS5nLixcbiAgICogZml2ZSBtaW51dGVzKSwgYWZ0ZXIgd2hpY2ggcG9pbnQgdGhlIHBlcmlvZCB3aWxsIHNpbXBseSBiZSB0aGUgY2VpbGluZyAoZS5nLiwgZml2ZSBtaW51dGVzKS5cbiAgICpcbiAgICovXG4gIHZhciBSZXRyeWFibGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChSZXRyeWFibGUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciAgPSBvcHRzLmdldE9yRXJyb3IoXCJzY2hlZHVsZXJcIik7XG4gICAgICB0aGlzLl90YXNrICAgICAgID0gb3B0cy5nZXRPckVycm9yKFwidGFza1wiKTtcbiAgICAgIC8vIElmIG5vdCBwcm92aWRlZCwgZ28gb24gZm9yZXZlci5cbiAgICAgIHRoaXMuX3JldHJpZXMgICAgPSBvcHRzLmdldE9yRWxzZShcInJldHJpZXNcIik7XG4gICAgICB0aGlzLl9jdXJyZW50VHJ5ID0gMDtcbiAgICAgIHRoaXMuX2RlZmVycmVkICAgPSBMYW5nLmRlZmVycmVkKCk7XG5cbiAgICAgIHZhciBiYWNrb2ZmID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNrb2ZmXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN0cmF0ZWd5OiBSZXRyeWFibGUuQmFja29mZi5MaW5lYXIsXG4gICAgICAgICAgZmFjdG9yOiAxLFxuICAgICAgICAgIGNvZWZmaWNpZW50OiAyNTBcbiAgICAgICAgfTtcbiAgICAgIH0pKTtcblxuICAgICAgdmFyIFN0cmF0ZWd5Q2xhc3MgPSBCYWNrb2ZmU3RyYXRlZ3lbYmFja29mZi5nZXRPckVycm9yKFwic3RyYXRlZ3lcIildO1xuXG4gICAgICB0aGlzLl9iYWNrb2ZmU3RyYXRlZ3kgPSBuZXcgU3RyYXRlZ3lDbGFzcyhiYWNrb2ZmLnRvT2JqZWN0KCkpO1xuICAgICAgdGhpcy5fYmFja29mZkNlaWxpbmcgID0gb3B0cy5nZXRPckVsc2UoXCJiYWNrb2ZmQ2VpbGluZ1wiLCBERUZBVUxUX0JBQ0tPRkZfQ0VJTElORyk7XG4gICAgICB0aGlzLl9kaXNwb3NlZEd1YXJkICAgPSBTdGF0ZUd1YXJkLnNjb3BlZChcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfYXR0ZW1wdFwiKTtcbiAgICAgIHRoaXMuX2N1cnJlbnRSdW4gPSBudWxsO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyLmdldCgpLnJ1blNvb24odGhpcy5fYXR0ZW1wdCk7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkR3VhcmQuYXBwbGllZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSdW4pIHtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1bi5jYW5jZWwobmV3IFJldHJ5YWJsZS5FcnJvci5EaXNwb3NlZEVycm9yKCkpO1xuICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fdGFzayA9IG51bGw7XG5cbiAgICAgIHRoaXMuX2Rpc3Bvc2VkR3VhcmQuYXBwbHkoKTtcbiAgICB9LFxuXG4gICAgcmVzdWx0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9kZWZlcnJlZC5wcm9taXNlO1xuICAgIH0sXG5cbiAgICBfYXR0ZW1wdDogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fZGlzcG9zZWRHdWFyZC5hcHBsaWVkKCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jdXJyZW50UnVuID0gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAuY2FuY2VsbGFibGUoKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fdGFzaygpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICBpZiAodGhpcy5fZGVmZXJyZWQucHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgdGhpcy5fZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChSZXRyeWFibGUuRXJyb3IuRGlzcG9zZWRFcnJvciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5fZGVmZXJyZWQucHJvbWlzZS5jYW5jZWwobmV3IFByb21pc2UuQ2FuY2VsbGF0aW9uRXJyb3IoKSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkR3VhcmQuYXBwbGllZCgpKSB7XG4gICAgICAgICAgICBMb2cud2FybihcIkNhdWdodCByZXRyeWFibGUgcnVuIGVycm9yLCBidXQgcmV0cnlhYmxlIGlzIGFscmVhZHkgZGlzcG9zZWRcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgTG9nLmRlYnVnKFwiUmVjZWl2ZWQgZXJyb3IgaW4gYXR0ZW1wdFwiLCB0aGlzLl9jdXJyZW50VHJ5KTtcbiAgICAgICAgICB2YXIgbmV4dFRyeSA9IHRoaXMuX2N1cnJlbnRUcnkgKyAxO1xuXG4gICAgICAgICAgaWYgKHRoaXMuX3JldHJpZXMgPj0gMCAmJiBuZXh0VHJ5ID4gdGhpcy5fcmV0cmllcykge1xuICAgICAgICAgICAgTG9nLmRlYnVnKFwiSGl0IG1heCBudW1iZXIgb2YgcmV0cmllczpcIiwgdGhpcy5fcmV0cmllcyk7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBSZXRyeWFibGUuRXJyb3IuTWF4UmV0cmllc0Vycm9yKCk7XG4gICAgICAgICAgICBlLmNhdXNlID0gZXJyO1xuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBTY2hlZHVsZSB1cyB1cCB0byB0cnkgYWdhaW47XG4gICAgICAgICAgdGhpcy5fY3VycmVudFJ1biA9IG51bGw7XG4gICAgICAgICAgdGhpcy5fY3VycmVudFRyeSA9IG5leHRUcnk7XG5cbiAgICAgICAgICB2YXIgdGltZSA9IHRoaXMuX2JhY2tvZmZTdHJhdGVneS50aW1lKHRoaXMuX2N1cnJlbnRUcnkpO1xuICAgICAgICAgIHRoaXMuX3NjaGVkdWxlci5nZXQoKS5zY2hlZHVsZSh0aGlzLl9hdHRlbXB0LCBNYXRoLm1pbih0aW1lLCB0aGlzLl9iYWNrb2ZmQ2VpbGluZykpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KFJldHJ5YWJsZS5FcnJvci5NYXhSZXRyaWVzRXJyb3IsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGlmICh0aGlzLl9kZWZlcnJlZC5wcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWZlcnJlZC5yZWplY3QoZXJyLmNhdXNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgXy5leHRlbmQoUmV0cnlhYmxlLCB7XG4gICAgQmFja29mZjoge1xuICAgICAgTGluZWFyOiAgICAgIFwibGluZWFyXCIsXG4gICAgICBFeHBvbmVudGlhbDogXCJleHBvbmVudGlhbFwiXG4gICAgfSxcbiAgICBFcnJvcjoge1xuICAgICAgRGlzcG9zZWRFcnJvcjogTGFuZy5tYWtlRXJyb3JDbGFzcyhcIkRpc3Bvc2VkRXJyb3JcIiwgXCJSZXRyeWFibGUgd2FzIGRpc3Bvc2VkXCIpLFxuICAgICAgTWF4UmV0cmllc0Vycm9yOiBMYW5nLm1ha2VFcnJvckNsYXNzKFwiTWF4UmV0cmllc0Vycm9yXCIsIFwiUmV0cnlhYmxlIHdhcyByZXRyaWVkIHRvbyBtYW55IHRpbWVzXCIpXG4gICAgfVxuICB9KVxuXG4gIHZhciBCYWNrb2ZmU3RyYXRlZ3kgPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIExpbmVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIF8uZXh0ZW5kKExpbmVhci5wcm90b3R5cGUsIHtcbiAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgICAgdGhpcy5fZmFjdG9yICAgICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwiZmFjdG9yXCIsIDEpO1xuICAgICAgICB0aGlzLl9jb2VmZmljaWVudCAgID0gb3B0cy5nZXRPckVsc2UoXCJjb2VmZmljaWVudFwiLCAyNTApO1xuICAgICAgfSxcblxuICAgICAgdGltZTogZnVuY3Rpb24oaXRlcmF0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mYWN0b3IgKiB0aGlzLl9jb2VmZmljaWVudCAqIGl0ZXJhdGlvbjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHZhciBFeHBvbmVudGlhbCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIF8uZXh0ZW5kKEV4cG9uZW50aWFsLnByb3RvdHlwZSwge1xuICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICAgIHRoaXMuX2Jhc2UgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJiYXNlXCIsIDIpO1xuICAgICAgICB0aGlzLl9jb2VmZmljaWVudCA9IG9wdHMuZ2V0T3JFbHNlKFwiY29lZmZpY2llbnRcIiwgMjUwKTtcbiAgICAgIH0sXG5cbiAgICAgIHRpbWU6IGZ1bmN0aW9uKGl0ZXJhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29lZmZpY2llbnQgKiAoTWF0aC5wb3codGhpcy5fYmFzZSwgaXRlcmF0aW9uKSk7XG4gICAgICB9XG4gICAgfSlcblxuXG4gICAgdmFyIGJhY2tvZmZzID0ge307XG5cbiAgICBiYWNrb2Zmc1tSZXRyeWFibGUuQmFja29mZi5MaW5lYXJdICAgICAgPSBMaW5lYXI7XG4gICAgYmFja29mZnNbUmV0cnlhYmxlLkJhY2tvZmYuRXhwb25lbnRpYWxdID0gRXhwb25lbnRpYWw7XG5cbiAgICByZXR1cm4gYmFja29mZnM7XG4gIH0oKSk7XG5cbiAgcmV0dXJuIFJldHJ5YWJsZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sYW5nXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgc2ltcGxlIHRpbWVyLlxuICAgKlxuICAgKiBTdGFydCBpdCwgc3RvcCBpdCwgZ2V0IHRoZSBkZWx0YS5cbiAgICpcbiAgICogT3IsIHN0YXJ0IGl0LCBhbmQgcmVwZWF0ZWRseSBjYWxsIGBsYXBgIGZvciB0aGUgdGltZSBiZXR3ZWVuIHRoZSBsYXN0IGBsYXBgIGNhbGwgYW5kIG5vdy5cbiAgICpcbiAgICovXG4gIHZhciBUaW1lciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFRpbWVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc3RhcnRUaW1lID0gbnVsbDtcbiAgICAgIHRoaXMuX2VuZFRpbWUgPSBudWxsO1xuICAgICAgdGhpcy5fbGFzdExhcCA9IG51bGw7XG4gICAgfSxcblxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fc3RhcnRUaW1lID0gdGhpcy5fbGFzdExhcCA9ICtuZXcgRGF0ZSgpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9lbmRUaW1lID0gK25ldyBEYXRlKCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgbGFwOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdGhpcy5fbGFzdExhcCkgcmV0dXJuIDA7XG5cbiAgICAgIHZhciBvbGRMYXN0TGFwID0gdGhpcy5fbGFzdExhcDtcbiAgICAgIHRoaXMuX2xhc3RMYXAgPSArbmV3IERhdGUoKTtcbiAgICAgIHJldHVybiAodGhpcy5fbGFzdExhcCAtIG9sZExhc3RMYXApO1xuICAgIH0sXG5cblxuICAgIGRlbHRhOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAodGhpcy5fZW5kVGltZSAtIHRoaXMuX3N0YXJ0VGltZSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gVGltZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZCxcbiAgQ2hhbm5lbCxcbiAgQ2hhaW5lZENoYW5uZWwsXG4gIExvZ2dlclxuKSB7XG5cbiAgLyoqXG4gICAqIFVwb24gYHN0YXJ0KClgLCBydW5zIHRoZSBwcm92aWRlZCBQcm9taXNpZmllZCBgdGFza2AgZXZlcnkgYGludGVydmFsYCBtaWxsaXNlY29uZHMgdW50aWwgYHN0b3AoKWAgaXMgY2FsbGVkLiBUaGUgcmVzdWx0c1xuICAgKiBvZiBlYWNoIGB0YXNrYCBhcmUgc2VudCBhbG9uZyB0aGUgYGVncmVzc0NoYW5uZWwoKWAsIGFzIGBtc2cucmVzdWx0YCBvciBgbXNnLmVycmAuXG4gICAqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIFBlcmlvZGljID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgdmFyIExvZyA9IExvZ2dlci5jcmVhdGUoXCJQZXJpb2RpY1wiKTtcblxuICBfLmV4dGVuZChQZXJpb2RpYy5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmID0gb3B0cy5nZXRPckVycm9yKFwic2NoZWR1bGVyXCIpO1xuICAgICAgdGhpcy5fdGFzayAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJ0YXNrXCIpO1xuICAgICAgdGhpcy5faW50ZXJ2YWwgICAgID0gb3B0cy5nZXRPckVycm9yKFwiaW50ZXJ2YWxcIik7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCIsIFwic3RhcnRlZFwiXSk7XG4gICAgICB0aGlzLl9jaGFubmVsICAgICAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuICAgICAgdGhpcy5fdGFza0lkICAgICAgID0gbnVsbDtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX3J1blRhc2tcIik7XG4gICAgfSxcblxuXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCl7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkXG4gICAgICAgIC5kZW55KFwiZGlzcG9zZWRcIiwgXCJzdGFydGVkXCIpXG4gICAgICAgIC5hcHBseShcInN0YXJ0ZWRcIik7XG5cbiAgICAgIHRoaXMuX3NjaGVkdWxlTmV4dCh0cnVlKTtcbiAgICB9LFxuXG5cbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2NhbmNlbFBlbmRpbmcoKTtcbiAgICAgIHRoaXMuX2NhbmNlbE91dHN0YW5kaW5nKCk7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLnVuYXBwbHkoXCJzdGFydGVkXCIpO1xuICAgIH0sXG5cbiAgICBlZ3Jlc3NDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBuZXcgQ2hhaW5lZENoYW5uZWwoe1xuICAgICAgICBzZW50aW5lbDogdGhpcyxcbiAgICAgICAgY2hhaW5UbzogdGhpcy5fY2hhbm5lbFxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9ydW5UYXNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZXN1bHRzID0ge1xuICAgICAgICBtVDogXCJyZXN1bHRzXCIsXG4gICAgICAgIHJlc3VsdDogbnVsbCxcbiAgICAgICAgZXJyOiBudWxsXG4gICAgICB9O1xuXG4gICAgICB0aGlzLl90YXNrSWQgPSBudWxsO1xuICAgICAgdGhpcy5fY3VycmVudFJ1biA9IFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLmNhbmNlbGxhYmxlKClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2soKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgcmVzdWx0cy5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXVnaHQoUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gTGV0IGl0IGJlLiBEb24ndCB3YW50IGl0IHRvIHRyaWNrbGUgaW50byB0aGUgcmVzdWx0cy5cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICByZXN1bHRzLmVyciA9IGVycjtcbiAgICAgICAgfSlcbiAgICAgICAgLmxhc3RseShmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLl9jdXJyZW50UnVuID0gbnVsbDtcbiAgICAgICAgICB0aGlzLl9ub3RpZnlSZXN1bHRzKHJlc3VsdHMpO1xuICAgICAgICAgIHRoaXMuX3NjaGVkdWxlTmV4dCgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG5cbiAgICBfbm90aWZ5UmVzdWx0czogZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgdGhpcy5fc2NoZWR1bGVyUmVmLmdldCgpLnJ1blNvb24oXy5iaW5kKGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSB8fCAhdGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwic3RhcnRlZFwiKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChMb2cuaXNUcmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgIExvZy50cmFjZShcIk5vdGlmeWluZyByZXN1bHRzXCIsIHJlc3VsdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY2hhbm5lbC5wdWJsaXNoKHRoaXMsIHJlc3VsdHMpO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cblxuICAgIF9zY2hlZHVsZU5leHQ6IGZ1bmN0aW9uKG5vdykge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpIHx8ICF0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJzdGFydGVkXCIpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3Rhc2tJZCA9IHRoaXMuX3NjaGVkdWxlclJlZi5nZXQoKS5zY2hlZHVsZSh0aGlzLl9ydW5UYXNrLCBub3cgPyAwIDogdGhpcy5faW50ZXJ2YWwpO1xuICAgICAgTG9nLnRyYWNlKFwiU2NoZWR1bGVkIHRhc2tcIiwgdGhpcy5fdGFza0lkKTtcbiAgICB9LFxuXG5cbiAgICBfY2FuY2VsUGVuZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cudHJhY2UoXCJjYW5jZWxQZW5kaW5nIHJlcXVlc3RlZCwgbG9va2luZyBmb3IgcGVuZGluZyB0YXNrLlwiKTtcbiAgICAgIGlmICh0aGlzLl90YXNrSWQpIHtcbiAgICAgICAgTG9nLnRyYWNlKFwiRm91bmQgcGVuZGluZyB0YXNrOyBjYW5jZWxsaW5nXCIsIHRoaXMuX3Rhc2tJZCk7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlclJlZi5nZXQoKS51bnNjaGVkdWxlKHRoaXMuX3Rhc2tJZCk7XG4gICAgICAgIHRoaXMuX3Rhc2tJZCA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9jYW5jZWxPdXRzdGFuZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICBMb2cudHJhY2UoXCJjYW5jZWxPdXRzdGFuZGluZyByZXF1ZXN0ZWQsIGxvb2tpbmcgZm9yIG91dHN0YW5kaW5nIHdvcmsuXCIpO1xuICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSdW4pIHtcbiAgICAgICAgTG9nLnRyYWNlKFwiT3V0c3RhbmRpbmcgd29yayBmb3VuZDsgY2FuY2VsbGluZ1wiKTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1bi5jYW5jZWwoKTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJ1biA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCl7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jYW5jZWxQZW5kaW5nKCk7XG4gICAgICB0aGlzLl9jYW5jZWxPdXRzdGFuZGluZygpO1xuXG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkLmFwcGx5KFwiZGlzcG9zZWRcIik7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gUGVyaW9kaWM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvY2hhbm5lbC9jaGFpbmVkLWNoYW5uZWxcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFN0YXRlR3VhcmRcbikge1xuXG4gIC8qKlxuICAgKiBBdHRlbXB0cyB0byBpbnRlbGxpZ2VudGx5IGRpc3BhdGNoIGFuIG9iamVjdCB3aXRoIGFuIG1UIGF0dHJpYnV0ZSwgdXNpbmdcbiAgICogdGhlIHJ1bGVzIHByb3ZpZGVkIGF0IGluc3RhbnRpYXRpb24uXG4gICAqXG4gICAqIEZvciBhIGdpdmVuIG1UeXBlZCBvYmplY3QsIHNlYXJjaGVzIHRoZSBwcm92aWRlZCBgZGVsZWdhdGVgIGZvciBhIG1ldGhvZFxuICAgKiBuYW1lZCBbcHJlZml4XVtjYW1lbC1jYXNlZCBtVF0sIGFuZCBpZiBwcmVzZW50LCBjYWxscyBpdC4gSWYgbm90IGZvdW5kLFxuICAgKiBsb29rcyBmb3IgW3ByZWZpeF1FbHNlLiBJZiB0aGUgbVQgYXR0cmlidXRlIGlzbid0IGZvdW5kLCBkaXNwYXRjaGVzIHRvXG4gICAqIFtwcmVmaXhdTWFsZm9ybWVkLlxuICAgKi9cbiAgdmFyIERpc3BhdGNoZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgREVGQVVMVF9DT05URVhUX0RFTEVHQVRFID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9O1xuXG4gIF8uZXh0ZW5kKERpc3BhdGNoZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpLFxuICAgICAgdGhpcy5fcHJlZml4ICAgICAgICAgID0gb3B0cy5nZXRPckVsc2UoXCJwcmVmaXhcIiwgXCJvbk1zZ1wiKTtcbiAgICAgIHRoaXMuX2Vsc2VTdWZmaXggICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwiZWxzZVN1ZmZpeFwiLCBcImVsc2VcIik7XG4gICAgICB0aGlzLl9tYWxmb3JtZWRTdWZmaXggPSBvcHRzLmdldE9yRWxzZShcIm1hbGZvcm1lZFN1ZmZpeFwiLCBcIm1hbGZvcm1lZFwiKTtcbiAgICAgIHRoaXMuX2NvbnRleHREZWxlZ2F0ZSA9IG9wdHMuZ2V0T3JFbHNlKFwiY29udGV4dERlbGVnYXRlXCIsIERFRkFVTFRfQ09OVEVYVF9ERUxFR0FURSk7XG4gICAgICB0aGlzLl9zdGF0ZUd1YXJkICAgICAgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgICB0aGlzLl9zdWJzICAgICAgICAgICAgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIHZhciBjaGFubmVscyA9IG9wdHMuZ2V0T3JFbHNlKFwibGlzdGVuXCIsIFtdKTtcblxuICAgICAgaWYgKCFfLmlzQXJyYXkoY2hhbm5lbHMpKSB7XG4gICAgICAgIGNoYW5uZWxzID0gW2NoYW5uZWxzXTtcbiAgICAgIH1cblxuICAgICAgXy5lYWNoKGNoYW5uZWxzLCBfLmJpbmQoZnVuY3Rpb24oYykge1xuICAgICAgICB0aGlzLmxpc3RlbihjKVxuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cbiAgICBsaXN0ZW46IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgc3ViID0gY2hhbm5lbC5zdWJzY3JpYmUoXy5iaW5kKGZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLmRpc3BhdGNoKG1zZyk7XG4gICAgICB9LCB0aGlzKSk7XG5cbiAgICAgIHRoaXMuX3N1YnMgPSBNLmFzc29jKHRoaXMuX3N1YnMsIHN1Yi5pZCgpLCBzdWIpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBkaXNwb3NlOiBfLmJpbmQoZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgblN1YiA9IE0uZ2V0KHRoaXMuX3N1YnMsIHN1Yi5pZCgpKTtcbiAgICAgICAgICBpZiAoblN1Yikge1xuICAgICAgICAgICAgdGhpcy5fc3VicyA9IE0uZGlzc29jKHRoaXMuX3N1YnMsIHN1Yi5pZCgpKTtcbiAgICAgICAgICAgIG5TdWIuZGlzcG9zZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcylcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKG1UeXBlZCwgY3R4KSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgaGFuZGxlciA9IHRoaXMuX2dldFZldHRlZEhhbmRsZXJOYW1lKG1UeXBlZCk7XG5cbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlW2hhbmRsZXJdKG1UeXBlZCwgdGhpcy5fY29udGV4dERlbGVnYXRlKG1UeXBlZCwgY3R4KSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIExpa2UgYGRpc3BhdGNoYCwgYnV0IGV4cGVjdHMgZGVsZWdhdGUgdG8gcmV0dXJuIGEgUHJvbWlzZTxvYmplY3Q+XG4gICAgICovXG4gICAgZGlzcGF0Y2hBc3luYzogZnVuY3Rpb24obVR5cGVkLCBjdHgpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fZ2V0VmV0dGVkSGFuZGxlck5hbWUobVR5cGVkKTtcbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZWxlZ2F0ZVtoYW5kbGVyXShtVHlwZWQsIHRoaXMuX2NvbnRleHREZWxlZ2F0ZShtVHlwZWQsIGN0eCkpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBzdWJzID0gdGhpcy5fc3VicztcbiAgICAgIHRoaXMuX3N1YnMgPSBNLmhhc2hfbWFwKCk7XG5cbiAgICAgIE0uZWFjaChzdWJzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG4gICAgX2dldEhhbmRsZXJOYW1lOiBmdW5jdGlvbihwcmVmaXgsIHN1ZmZpeCkge1xuICAgICAgcmV0dXJuIHByZWZpeCArIHN1ZmZpeC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN1ZmZpeC5zdWJzdHIoMSk7XG4gICAgfSxcblxuICAgIC8vIEZJWE1FOiBDaGVjayBmb3IgXCJyZXNlcnZlZFwiIG1UeXBlcyAoX2Vsc2VTdWZmaXgsIF9tYWxmb3JtZWRTdWZmaXgsIGV0YyksIGxvZyB3YXJuaW5nXG4gICAgX2dldFZldHRlZEhhbmRsZXJOYW1lOiBmdW5jdGlvbihtVHlwZWQpIHtcbiAgICAgIHZhciBtVCA9IG1UeXBlZC5tVCxcbiAgICAgICAgICBwcmVmaXggPSB0aGlzLl9wcmVmaXgsXG4gICAgICAgICAgcG90ZW50aWFsSGFuZGxlck5hbWUsXG4gICAgICAgICAgZmluYWxIYW5kbGVyTmFtZTtcblxuICAgICAgaWYgKCFtVCkge1xuICAgICAgICBmaW5hbEhhbmRsZXJOYW1lID0gdGhpcy5fZ2V0SGFuZGxlck5hbWUocHJlZml4LCB0aGlzLl9tYWxmb3JtZWRTdWZmaXgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcG90ZW50aWFsSGFuZGxlck5hbWUgPSB0aGlzLl9nZXRIYW5kbGVyTmFtZShwcmVmaXgsIG1UKTtcbiAgICAgICAgaWYgKF8uaXNGdW5jdGlvbih0aGlzLl9kZWxlZ2F0ZVtwb3RlbnRpYWxIYW5kbGVyTmFtZV0pKSB7XG4gICAgICAgICAgZmluYWxIYW5kbGVyTmFtZSA9IHBvdGVudGlhbEhhbmRsZXJOYW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZpbmFsSGFuZGxlck5hbWUgPSB0aGlzLl9nZXRIYW5kbGVyTmFtZShwcmVmaXgsIHRoaXMuX2Vsc2VTdWZmaXgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChfLmlzRnVuY3Rpb24odGhpcy5fZGVsZWdhdGVbZmluYWxIYW5kbGVyTmFtZV0pKSB7XG4gICAgICAgIHJldHVybiBmaW5hbEhhbmRsZXJOYW1lO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIERpc3BhdGNoZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9zdGF0ZS1ndWFyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGZhY3RvcnkgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqXG4gICAqIEhlbHBlciBmb3IgZGVhbGluZyB3aXRoIGhhc2gtc3R5bGUgZnVuY3Rpb24gYXJndW1lbnRzLCB3aGljaCBjYW4gYmUgdXNlZnVsXG4gICAqIGluIG1ldGhvZHMgd2l0aCBvcHRpb25hbC9kZWZhdWx0IHZhbHVlcy5cbiAgICpcbiAgICogVXNhZ2U6XG4gICAqXG4gICAqICAgdmFyIGZvbyA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICogICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICpcbiAgICogICAgICAgdmFyIG9uZSA9IG9wdHMuZ2V0T3JFcnJvcihcIm9uZVwiKSxcbiAgICogICAgICAgICAgIHR3byA9IG9wdHMuZ2V0T3JFbHNlKFwidHdvXCIsIDIpLFxuICAgKiAgICAgICAgICAgdGhyZWUgPSBvcHRzLmdldE9yRWxzZUZuKFwidGhyZWVcIiwgZnVuY3Rpb24oKSB7XG4gICAqICAgICAgICAgICAgIHJldHVybiAzO1xuICAgKiAgICAgICAgICAgfSk7XG4gICAqXG4gICAqICAgICBjb25zb2xlLmxvZyhvbmUsIHR3bywgdGhyZWUpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgZm9vKHsgb25lOiAxIH0pOyAvLyBsb2dzIFwiMSwgMiwgM1wiXG4gICAqICAgZm9vKCk7IC8vIHRocm93cyBFcnJvclxuICAgKiAgIGZvbyh7b25lOiAxLCB0d286IGZhbHNlLCB0aHJlZTogNH0pOyAvLyBsb2dzIFwiMSwgZmFsc2UsIDRcIlxuICAgKlxuICAgKi9cbiAgdmFyIE9wdGlvbnMgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChPcHRpb25zLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHRoaXMuX3Byb3ZpZGVkT3B0cyA9IG9wdHMgfHwge307XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIHJldHVybiB0aGUgdmFsdWUgZm9yIHRoZSByZXF1ZXN0ZWQgYGtleWAuIElmIHRoZSB2YWx1ZVxuICAgICAqIGlzIHVuZGVmaW5lZCBvciBudWxsLCBpbnN0ZWFkIHJldHVybnMgdGhlIHByb3ZpZGVkIGBmYWxsYmFja1ZhbHVlYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkgKHJlcXVpcmVkKSBhdHRyaWJ1dGUgdG8gYmUgcmVhZFxuICAgICAqIEBwYXJhbSBmYWxsYmFja1ZhbHVlICByZXR1cm5lZCBpZiBga2V5YCBhdHRyaWJ1dGUgaXMgbnVsbCBvciB1bmRlZmluZWRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHJlcXVlc3RlZCB2YWx1ZSBmb3IgYGtleWAsIG9yIGZhbGxiYWNrVmFsdWVgXG4gICAgICovXG4gICAgZ2V0T3JFbHNlOiBmdW5jdGlvbihrZXksIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byByZXR1cm4gdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGBrZXlgLiBJZiB0aGUgdmFsdWVcbiAgICAgKiBpcyB1bmRlZmluZWQgb3IgbnVsbCwgdGhyb3dzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleSAocmVxdWlyZWQpIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGVyciAgICAgICAgICAgIG1lc3NhZ2UgcHJvdmlkZWQgdG8gRXJyb3IgY29uc3RydWN0b3IgaWYgYGtleWBcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgaXMgbnVsbCBvciBub3QgZGVmaW5lZFxuICAgICAqXG4gICAgICogQHJldHVybnMgdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGtleVxuICAgICAqL1xuICAgIGdldE9yRXJyb3I6IGZ1bmN0aW9uKGtleSwgZXJyb3JNc2cpIHtcbiAgICAgIGlmICh0aGlzLl9pc1VuZGVmT3JOdWxsKGtleSkpIHtcbiAgICAgICAgZXJyb3JNc2cgPSBlcnJvck1zZyB8fCBcIk9wdGlvbiByZXF1ZXN0ZWQgYnV0IG5vdCBmb3VuZDogYFwiK2tleStcImBcIjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTXNnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3Byb3ZpZGVkT3B0c1trZXldO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byByZXR1cm4gdGhlIHZhbHVlIGZvciB0aGUgcmVxdWVzdGVkIGBrZXlgLiBJZiB0aGUgdmFsdWVcbiAgICAgKiBpcyB1bmRlZmluZWQgb3IgbnVsbCwgaW5zdGVhZCBldmFsdWF0ZXMgYGZhbGxiYWNrVmFsdWVGbmAgYW5kIHJldHVybnNcbiAgICAgKiBpdHMgdmFsdWUuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3Igc2ltdWxhdGluZyBub24tc3RyaWN0IGV2YWx1YXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IChyZXF1aXJlZCkgIGF0dHJpYnV0ZSB0byBiZSByZWFkXG4gICAgICogQHBhcmFtIGZhbGxiYWNrVmFsdWVGbiBldmFsdWF0ZWQgYW5kIHJldHVybiB2YWx1ZSByZXR1cm5lZCBpZiBga2V5YFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlIGlzIG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyByZXF1ZXN0ZWQgdmFsdWUgZm9yIGBrZXlgIG9yIHRoZSByZXR1cm4gdmFsdWUgb2YgZXZhbHVhdGVkXG4gICAgICogICAgICAgICAgYGZhbGxiYWNrVmFsdWVGbmBcbiAgICAgKi9cbiAgICBnZXRPckVsc2VGbjogZnVuY3Rpb24oa2V5LCBkZWZhdWx0VmFsdWVGbikge1xuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWVGbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9wdGlvbnMjZ2V0T3JFbHNlRm4gcmVxdWlyZXMgYSBkZWZhdWx0VmFsdWVGblwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX2lzVW5kZWZPck51bGwoa2V5KSkge1xuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlRm4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcm92aWRlZE9wdHNba2V5XTtcbiAgICAgIH1cbiAgICB9LFxuXG5cbiAgICB0b09iamVjdDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gXy5jbG9uZSh0aGlzLl9wcm92aWRlZE9wdHMpO1xuICAgIH0sXG5cbiAgICBzY29wZTogZnVuY3Rpb24ocHJlZml4KSB7XG4gICAgICByZXR1cm4gT3B0aW9ucy5mcm9tT2JqZWN0V2l0aFByZWZpeCh0aGlzLnRvT2JqZWN0KCksIHByZWZpeCk7XG4gICAgfSxcblxuICAgIF9pc1VuZGVmT3JOdWxsOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdGhpcy5fcHJvdmlkZWRPcHRzW2tleV0gPT09IFwidW5kZWZpbmVkXCIgfHwgdGhpcy5fcHJvdmlkZWRPcHRzW2tleV0gPT09IG51bGw7XG4gICAgfVxuICB9KTtcblxuICBfLmV4dGVuZChPcHRpb25zLCB7XG4gICAgZnJvbU9iamVjdDogZnVuY3Rpb24ob3B0cykge1xuICAgICAgcmV0dXJuIG5ldyBPcHRpb25zKG9wdHMpO1xuICAgIH0sXG5cblxuICAgIGZyb21PYmplY3RXaXRoUHJlZml4OiBmdW5jdGlvbihvcHRzLCBwcmVmaXgpIHtcbiAgICAgIG9wdHMgPSBfLnJlZHVjZShvcHRzLCBmdW5jdGlvbihtZW1vLCB2YWwsIGtleSkge1xuICAgICAgICB2YXIgcmVzdCwgbmV3S2V5O1xuICAgICAgICBpZiAoa2V5LmluZGV4T2YocHJlZml4KSA9PT0gMCkge1xuICAgICAgICAgIHJlc3QgPSBrZXkuc3Vic3RyKHByZWZpeC5sZW5ndGgpO1xuICAgICAgICAgIGlmIChyZXN0Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIG5ld0tleSA9IHJlc3QuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyByZXN0LnN1YnN0cigxKTtcbiAgICAgICAgICAgIG1lbW9bbmV3S2V5XSA9IHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIHJldHVybiBuZXcgT3B0aW9ucyhvcHRzKTtcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIE9wdGlvbnM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblxudmFyIG1vZCA9IGZ1bmN0aW9uIChcbiAgX1xuICApIHtcblxuICAvKipcbiAgICogQSBkZXZpY2Ugd2hpY2ggY2FsbHMgdGhlIHByb3ZpZGVkIGNvbXBsZXRpb25DYWxsYmFjayBhZnRlciBgc3RlcHNgIGNhbGxzIHRvIGBDb3VudGRvd25MYXRjaCNzdGVwKClgLlxuICAgKlxuICAgKi9cblxuICB2YXIgQ291bnRkb3duTGF0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfSxcbiAgICAgIG5vb3AgPSBmdW5jdGlvbigpIHt9O1xuXG4gIF8uZXh0ZW5kKENvdW50ZG93bkxhdGNoLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uIChzdGVwcywgY29tcGxldGlvbkNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl9zdGVwcyA9IHN0ZXBzIHx8IDA7XG4gICAgICB0aGlzLl9jb21wbGV0aW9uQ2FsbGJhY2sgPSBjb21wbGV0aW9uQ2FsbGJhY2sgfHwgbm9vcDtcbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9jb21wbGV0aW9uQ2FsbGJhY2tcIiwgXCJfdHJpZ2dlckNvbXBsZXRpb25cIik7XG4gICAgICBpZihpc05hTih0aGlzLl9zdGVwcykgfHwgdGhpcy5fc3RlcHMgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdW50ZG93bkxhdGNoOiBOdW1iZXIgb2Ygc3RlcHMgYXJlIGludmFsaWQuXCIpO1xuICAgICAgfVxuICAgICAgdGhpcy5fY3VycmVudCA9IDA7XG4gICAgICB0aGlzLl9jb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fZXJyb3IgPSBudWxsO1xuICAgICAgaWYodGhpcy5fc3RlcHMgPT09IDApIHtcbiAgICAgICAgXy5kZWZlcih0aGlzLl90cmlnZ2VyQ29tcGxldGlvbik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9LFxuICAgIHN0ZXA6IGZ1bmN0aW9uIChzdGVwcykge1xuICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlIHx8IHRoaXMuX3N0ZXBzID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2N1cnJlbnQgKz0gc3RlcHMgfHwgMTtcbiAgICAgIGlmICh0aGlzLl9jdXJyZW50ID49IHRoaXMuX3N0ZXBzKSB7XG4gICAgICAgIHRoaXMuX3RyaWdnZXJDb21wbGV0aW9uKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24gKGVycikge1xuICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlIHx8IHRoaXMuX3N0ZXBzID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2Vycm9yID0gZXJyO1xuICAgICAgdGhpcy5fdHJpZ2dlckNvbXBsZXRpb24oKTtcbiAgICB9LFxuICAgIF90cmlnZ2VyQ29tcGxldGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgIGlmICh0aGlzLl9lcnJvcikge1xuICAgICAgICBfLmRlZmVyKF8uYmluZCh0aGlzLl9jb21wbGV0aW9uQ2FsbGJhY2ssIG51bGwsIHRoaXMuX2Vycm9yKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfLmRlZmVyKHRoaXMuX2NvbXBsZXRpb25DYWxsYmFjayk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ291bnRkb3duTGF0Y2g7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBmYWN0b3J5ID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBIHV0aWxpdHkgc2luZ2xldG9uIGZvciBcImxhbmd1YWdlIGV4dGVuc2lvbnNcIi5cbiAgICovXG4gIHZhciBMYW5nID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTGFuZy5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpe31cbiAgfSk7XG5cbiAgXy5leHRlbmQoTGFuZywge1xuICAgIG5vb3A6IGZ1bmN0aW9uKCkge30sXG5cbiAgICBwYXJ0aWFsbHlBcHBseTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IF8udG9BcnJheShhcmd1bWVudHMpLFxuICAgICAgICAgIGZ1biAgPSBhcmdzLnNoaWZ0KCk7XG5cbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGZ1bi5hcHBseShudWxsLCBhcmdzLmNvbmNhdChhcmd1bWVudHMpKTtcbiAgICAgIH07XG4gICAgfSxcblxuICAgIG1ha2VFcnJvckNsYXNzOiBmdW5jdGlvbihuYW1lLCBkZWZhdWx0TWVzc2FnZSkge1xuICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIm1ha2VFcnJvckNsYXNzIHJlcXVpcmVzIGBuYW1lYFwiKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGtsYXNzID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICB0aGlzLm5hbWUgICAgPSBuYW1lO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSB0aGlzLm5hbWUgKyBcIjogXCIgKyAobWVzc2FnZSB8fCBkZWZhdWx0TWVzc2FnZSB8fCBcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIik7XG5cbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywga2xhc3MpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBrbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gICAgICBrbGFzcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBrbGFzcztcbiAgICAgIHJldHVybiBrbGFzcztcbiAgICB9LFxuXG4gICAgcG9qb0NsYXNzOiBmdW5jdGlvbihhdHRyaWJ1dGVzLCBvcHRpb25zKSB7XG4gICAgICBpZiAoIV8uaXNBcnJheShhdHRyaWJ1dGVzKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMYW5nI3Bvam9DbGFzcyByZXF1aXJlcyBhdHRyaWJ1dGVzIGFycmF5XCIpO1xuICAgICAgfVxuXG4gICAgICB2YXIgb3B0aW9ucyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRpb25zKSxcbiAgICAgICAgICAvLyBvcHRpb25hbCBzcGVjaWZpZXMga2V5cyB0aGF0IGFyZSBvcHRpb25hbCwgd2l0aCB2YWx1ZXMgdGhhdCBhcmUgZGVmYXVsdCBpZiBub3QgcHJvdmlkZWRcbiAgICAgICAgICBkZWZhdWx0cyA9IG9wdGlvbnMuZ2V0T3JFbHNlKFwiZGVmYXVsdHNcIiwge30pLFxuICAgICAgICAgIG9wdGlvbmFsQXR0cmlidXRlcyA9IF8ua2V5cyhkZWZhdWx0cyk7XG5cbiAgICAgIHZhciB0b0F0dHJpYnV0ZU5hbWUgPSBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJfXCIgKyBhdHRyO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgdG9HZXR0ZXIgPSBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgICAgICByZXR1cm4gYXR0cjtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvU2V0dGVyID0gZnVuY3Rpb24oYXR0cikge1xuICAgICAgICAgICAgcmV0dXJuIFwic2V0XCIgKyBhdHRyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgYXR0ci5zdWJzdHIoMSk7XG4gICAgICAgICAgfTtcblxuICAgICAgdmFyIGtsYXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfTtcblxuICAgICAgXy5leHRlbmQoa2xhc3MucHJvdG90eXBlLCB7XG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgICAgIF8uZWFjaChhdHRyaWJ1dGVzLCBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgICAgICBpZiAoXy5jb250YWlucyhvcHRpb25hbEF0dHJpYnV0ZXMsIGF0dHIpKSB7XG4gICAgICAgICAgICAgIHRoaXNbdG9BdHRyaWJ1dGVOYW1lKGF0dHIpXSA9IG9wdHMuZ2V0T3JFbHNlKGF0dHIsIGRlZmF1bHRzW2F0dHJdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXNbdG9BdHRyaWJ1dGVOYW1lKGF0dHIpXSA9IG9wdHMuZ2V0T3JFcnJvcihhdHRyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF8uZWFjaChhdHRyaWJ1dGVzLCBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgIGtsYXNzLnByb3RvdHlwZVt0b0dldHRlcihhdHRyKV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1t0b0F0dHJpYnV0ZU5hbWUoYXR0cildO1xuICAgICAgICB9O1xuICAgICAgICBrbGFzcy5wcm90b3R5cGVbdG9TZXR0ZXIoYXR0cildID0gZnVuY3Rpb24odikge1xuICAgICAgICAgIHRoaXNbdG9BdHRyaWJ1dGVOYW1lKGF0dHIpXSA9IHY7XG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGtsYXNzO1xuICAgIH0sXG5cbiAgICBkZWZlcnJlZDogZnVuY3Rpb24ocHJvbWlzZUNsYXNzKSB7XG4gICAgICBwcm9taXNlQ2xhc3MgPSBwcm9taXNlQ2xhc3MgfHwgUHJvbWlzZTtcbiAgICAgIHZhciByZXMgPSBudWxsLCByZWogPSBudWxsO1xuICAgICAgdmFyIHAgPSBuZXcgcHJvbWlzZUNsYXNzKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXMgPSBhcmd1bWVudHNbMF07XG4gICAgICAgIHJlaiA9IGFyZ3VtZW50c1sxXTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcm9taXNlOiBwLFxuICAgICAgICByZXNvbHZlOiByZXMsXG4gICAgICAgIHJlamVjdDogIHJlalxuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBMYW5nO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2Vcbikge1xuXG4gIC8qKlxuICAgKiBBIFN0YXRlR3VhcmQgZG9lcyB3aGF0IGl0cyBuYW1lIGltcGxpZXMuIFZhbGlkIHN0YXRlcyBhcmUgcHJvdmlkZWQgZHVyaW5nIGluc3RhbnRpYXRpb24sIGFuZCBhcmUgYXBwbGllZCwgZW5zdXJlZCxcbiAgICogZGVuaWVkLCBldGMsIHRocm91Z2ggdGhlIGNvdXJzZSBvZiB0aGUgb3duZXIncyBsaWZldGltZS5cbiAgICpcbiAgICogRm9yIGV4YW1wbGUsIGlmIHlvdSdkIGxpa2UgdG8gZW5zdXJlIHRoYXQgRm9vI2JhciByYWlzZXMgYW4gZXJyb3IgYWZ0ZXIgRm9vI2Rpc3Bvc2UgaXMgY2FsbGVkLCB5b3UgbWlnaHQgZG8gdGhlXG4gICAqIGZvbGxvd2luZzpcbiAgICpcbiAgICogICB2YXIgRm9vID0gZnVuY3Rpb24oKSB7XG4gICAqICAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICogICB9O1xuICAgKlxuICAgKiAgIF8uZXh0ZW5kKEZvby5wcm90b3R5cGUsIHtcbiAgICogICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgICB0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSA9IG5ldyBFeHBlbnNpdmVSZXNvdXJjZSgpO1xuICAgKiAgICAgICB0aGlzLl9zdGF0ZUd1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuICAgKiAgICAgfSxcbiAgICogICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgICAvLyAjZGlzcG9zZSBzaG91bGQgYmUgaWRlbXBvdGVudCwgc28gaGVyZSB3ZSBqdXN0IGNoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBhbHJlYWR5IGRpc3Bvc2VkLCBhbmQgcmV0dXJuLlxuICAgKiAgICAgICAvLyBOb3RlIHRoYXQgaWYgZGlzcG9zZSB3ZXJlIGFzeW5jLCB3ZSdkIG5lZWQgdG8gYWRkIGEgXCJkaXNwb3NpbmdcIiBzdGF0ZS5cbiAgICogICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAqICAgICAgICAgcmV0dXJuO1xuICAgKiAgICAgICB9XG4gICAqXG4gICAqICAgICAgIGlmICh0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSkge1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLmRpc3Bvc2UoKTtcbiAgICogICAgICAgICB0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSA9IG51bGw7XG4gICAqICAgICAgIH1cbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgKiAgICAgfSxcbiAgICogICAgIGJhcjogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpOyAvLyBUaHJvd3MgZXhjZXB0aW9uIGlmICNkaXNwb3NlIHdhcyBjYWxsZWRcbiAgICpcbiAgICogICAgICAgcmV0dXJuIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLnNvbWVNZXRob2QoKTtcbiAgICogICAgIH1cbiAgICogICB9KTtcbiAgICpcbiAgICogSW4gdGhpcyBjYXNlLCB3aGVyZSB3ZSBoYXZlIG9ubHkgb25lIHN0YXRlLCBpdCdzIHVzZWZ1bCB0byBzaW1wbHkgY3JlYXRlIGEgc2NvcGVkIFN0YXRlR3VhcmQsIHdoaWNoIGJlaGF2ZXNcbiAgICogaWRlbnRpY2FsbHkgdG8gYSByZWd1bGFyIG9uZSwgZXhjZXB0IGV2ZXJ5IGVuZm9yY2VtZW50L3F1ZXJ5IG1ldGhvZCBoYXMgdGhlIHNjb3BlIHByb3ZpZGVkIGR1cmluZyBpbnN0YW50aWF0aW9uXG4gICAqIGFzIGEgZmlyc3QsIGltcGxpY2l0IGFyZ3VtZW50OlxuICAgKlxuICAgKiAgIC8vIElkZW50aWNhbCB0byBwcmV2aW91cyB2ZXJzaW9uLlxuICAgKlxuICAgKiAgIHZhciBGb28gPSBmdW5jdGlvbigpIHtcbiAgICogICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgKiAgIH07XG4gICAqXG4gICAqICAgXy5leHRlbmQoRm9vLnByb3RvdHlwZSwge1xuICAgKiAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlID0gbmV3IEV4cGVuc2l2ZVJlc291cmNlKCk7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBTdGF0ZUd1YXJkLnNjb3BlZChcImRpc3Bvc2VkXCIpO1xuICAgKiAgICAgfSxcbiAgICogICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgICAvLyAjZGlzcG9zZSBzaG91bGQgYmUgaWRlbXBvdGVudCwgc28gaGVyZSB3ZSBqdXN0IGNoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBhbHJlYWR5IGRpc3Bvc2VkLCBhbmQgcmV0dXJuLlxuICAgKiAgICAgICAvLyBOb3RlIHRoYXQgaWYgZGlzcG9zZSB3ZXJlIGFzeW5jLCB3ZSdkIG5lZWQgdG8gYWRkIGEgXCJkaXNwb3NpbmdcIiBzdGF0ZS5cbiAgICogICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZCgpKSB7XG4gICAqICAgICAgICAgcmV0dXJuO1xuICAgKiAgICAgICB9XG4gICAqXG4gICAqICAgICAgIGlmICh0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSkge1xuICAgKiAgICAgICAgIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLmRpc3Bvc2UoKTtcbiAgICogICAgICAgICB0aGlzLl9leHBlbnNpdmVSZXNvdXJjZSA9IG51bGw7XG4gICAqICAgICAgIH1cbiAgICogICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseSgpO1xuICAgKiAgICAgfSxcbiAgICogICAgIGJhcjogZnVuY3Rpb24oKSB7XG4gICAqICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueSgpOyAvLyBUaHJvd3MgZXhjZXB0aW9uIGlmICNkaXNwb3NlIHdhcyBjYWxsZWRcbiAgICpcbiAgICogICAgICAgcmV0dXJuIHRoaXMuX2V4cGVuc2l2ZVJlc291cmNlLnNvbWVNZXRob2QoKTtcbiAgICogICAgIH1cbiAgICogICB9KTtcbiAgICpcbiAgICovXG4gIHZhciBTdGF0ZUd1YXJkID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoU3RhdGVHdWFyZC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihzdGF0ZXMpIHtcbiAgICAgIHRoaXMuX3ZhbGlkU3RhdGVzID0gXy5yZWR1Y2Uoc3RhdGVzLCBmdW5jdGlvbihtZW1vLCBzdGF0ZSkge1xuICAgICAgICBtZW1vW3N0YXRlXSA9IHRydWU7XG4gICAgICAgIHJldHVybiBtZW1vO1xuICAgICAgfSwge30pO1xuXG4gICAgICB0aGlzLl9hcHBsaWVkU3RhdGVzID0ge307XG4gICAgfSxcblxuICAgIHNjb3BlOiBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgdmFyIHNraXAgPSBbXCJzY29wZVwiLCBcImluaXRpYWxpemVcIl0sXG4gICAgICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgc2NvcGVkID0ge307XG5cbiAgICAgIF8uZWFjaChTdGF0ZUd1YXJkLnByb3RvdHlwZSwgZnVuY3Rpb24oZnVuLCBtZXRob2ROYW1lKSB7XG4gICAgICAgIGlmIChfLmNvbnRhaW5zKHNraXAsIG1ldGhvZE5hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc2NvcGVkW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGFyZ3MgPSBfLnRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgICBhcmdzLnVuc2hpZnQoc3RhdGUpO1xuICAgICAgICAgIHJldHVybiBmdW4uYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHNjb3BlZDtcbiAgICB9LFxuXG4gICAgYXBwbHk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgXy5lYWNoKHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV0gPSB0cnVlO1xuICAgICAgfSwgdGhpcyk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBhcHBseUFzeW5jOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcGx5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICBhcHBseUFzeW5jRm46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIHVuYXBwbHk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgXy5lYWNoKHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdKSB7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdO1xuICAgICAgICB9XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIHVuYXBwbHlBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy51bmFwcGx5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICB1bmFwcGx5QXN5bmNGbjogZnVuY3Rpb24oc3RhdGVzKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuYXBwbHlBc3luYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGRlbnk6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcblxuICAgICAgdmFyIGFwcGxpZWQgPSBfLmZpbHRlcihzdGF0ZXMsIGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHBsaWVkU3RhdGVzW3N0YXRlXTtcbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICBpZiAoYXBwbGllZC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0YXRlIGRlbmlhbCByZXF1ZXN0ZWQsIGJ1dCBhcHBsaWVkOiBcIiArIHByZXR0eShhcHBsaWVkKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBkZW55QXN5bmM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZGVueS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH0pLFxuXG4gICAgZGVueUFzeW5jRm46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZW55QXN5bmMuYXBwbHkodGhpcywgYXJncylcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBlbnN1cmU6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHN0YXRlcyA9IGFyeU9yVmFyaWFkaWNUb0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyh0aGlzLl92YWxpZFN0YXRlcywgc3RhdGVzKTtcbiAgICAgIHZhciBtaXNzaW5nID0gXy5yZWplY3Qoc3RhdGVzLCBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXBwbGllZFN0YXRlc1tzdGF0ZV07XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgaWYgKG1pc3NpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdGF0ZSBlbnN1cmFuY2UgcmVxdWVzdGVkLCBidXQgbm90IGFwcGxpZWQ6IFwiICsgcHJldHR5KG1pc3NpbmcpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBlbnN1cmVBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbnN1cmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9KSxcblxuICAgIGVuc3VyZUFzeW5jRm46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbnN1cmVBc3luYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBhcHBsaWVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzdGF0ZXMgPSBhcnlPclZhcmlhZGljVG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgY2hlY2tWYWxpZFN0YXRlc09yVGhyb3codGhpcy5fdmFsaWRTdGF0ZXMsIHN0YXRlcyk7XG5cbiAgICAgIHJldHVybiBfLmV2ZXJ5KHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGxpZWRTdGF0ZXNbc3RhdGVdO1xuICAgICAgfSwgdGhpcyk7XG4gICAgfSxcblxuICAgIGFwcGxpZWRBc3luYzogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5hcHBsaWVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSksXG5cbiAgICBhcHBsaWVkQXN5bmNGbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGxpZWRBc3luYy5hcHBseSh0aGlzLCBhcmdzKVxuICAgICAgfSwgdGhpcyk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgYXJ5T3JWYXJpYWRpY1RvQXJyYXkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIF8uY2hhaW4oYXJncykudG9BcnJheSgpLmZsYXR0ZW4oKS52YWx1ZSgpO1xuICB9O1xuXG4gIHZhciBjaGVja1ZhbGlkU3RhdGVzT3JUaHJvdyA9IGZ1bmN0aW9uKHZhbGlkU3RhdGVzTWFwLCBzdGF0ZXMpIHtcbiAgICB2YXIgaW52YWxpZFN0YXRlcyA9IF8ucmVqZWN0KHN0YXRlcywgZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgIHJldHVybiAhIXZhbGlkU3RhdGVzTWFwW3N0YXRlXTtcbiAgICB9KTtcblxuICAgIGlmIChpbnZhbGlkU3RhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgc3RhdGVzIHByb3ZpZGVkOiBcIiArIHByZXR0eShpbnZhbGlkU3RhdGVzKSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBwcmV0dHkgPSBmdW5jdGlvbihzdGF0ZXMpIHtcbiAgICByZXR1cm4gXCJbXCIrc3RhdGVzLmpvaW4oXCIsXCIpK1wiXVwiO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN0YXRlR3VhcmQsIHtcbiAgICBzY29wZWQ6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICByZXR1cm4gKG5ldyBTdGF0ZUd1YXJkKFtzY29wZV0pKS5zY29wZShzY29wZSk7XG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBTdGF0ZUd1YXJkO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgbWl4aW4gZW5hYmxpbmcgcHVic3ViIG9uIGFuIG9iamVjdC4gVG8gdXNlLCBjb3B5IHRoZSBzaW5nbGV0b24gbWV0aG9kcyBpbnRvIHRoZSBvYmplY3Qgb3Igb2JqZWN0IHByb3RvdHlwZTpcbiAgICpcbiAgICogICAgIHZhciBteU9iaiA9IF8uZXh0ZW5kKHt9LCBQdWJTdWIpO1xuICAgKiAgICAgbXlPYmoub24oJ2ZvbycsIGZ1bmN0aW9uKGV2dCkgeyBjb25zb2xlLmxvZyhldnQpIH0pOyAvLyBsb2dzIGB7ICdzb21lJzogJ2RhdGEnIH1gXG4gICAqICAgICBteU9iai5ub3RpZnkoJ2ZvbycsIHsgc29tZTogJ2RhdGEnIH0pO1xuICAgKlxuICAgKi9cbiAgdmFyIFB1YlN1YiA9IHtcbiAgICBvbjogZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB2YXIgYnVja2V0ID0gdGhpcy5fX3B1YlN1YkJ1Y2tldChldmVudE5hbWUpO1xuICAgICAgYnVja2V0LnN1YnNjcmliZShoYW5kbGVyLCBjb250ZXh0KTtcbiAgICB9LFxuICAgIG9mZjogZnVuY3Rpb24oZXZlbnROYW1lLCBoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB2YXIgYnVja2V0ID0gdGhpcy5fX3B1YlN1YkJ1Y2tldChldmVudE5hbWUpO1xuICAgICAgYnVja2V0LnVuc3Vic2NyaWJlKGhhbmRsZXIsIGNvbnRleHQpO1xuICAgIH0sXG4gICAgbm90aWZ5OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzICAgICAgPSBfLnRvQXJyYXkoYXJndW1lbnRzKSxcbiAgICAgICAgICBldmVudE5hbWUgPSBhcmdzLnNoaWZ0KCk7XG5cbiAgICAgIHZhciBidWNrZXQgPSB0aGlzLl9fcHViU3ViQnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICBidWNrZXQubm90aWZ5KGFyZ3MpO1xuICAgIH0sXG4gICAgX19wdWJTdWJCdWNrZXQ6IGZ1bmN0aW9uKGV2ZW50TmFtZSkge1xuICAgICAgdGhpcy5fX3B1YlN1YkV2ZW50cyA9IHRoaXMuX19wdWJTdWJFdmVudHMgfHwge307XG4gICAgICB0aGlzLl9fcHViU3ViRXZlbnRzW2V2ZW50TmFtZV0gPSB0aGlzLl9fcHViU3ViRXZlbnRzW2V2ZW50TmFtZV0gfHwgbmV3IEV2ZW50QnVja2V0KGV2ZW50TmFtZSk7XG4gICAgICByZXR1cm4gdGhpcy5fX3B1YlN1YkV2ZW50c1tldmVudE5hbWVdO1xuICAgIH1cbiAgfTtcblxuICB2YXIgRXZlbnRCdWNrZXQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChFdmVudEJ1Y2tldC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihldmVudE5hbWUpIHtcbiAgICAgIHRoaXMuX2V2ZW50TmFtZSA9IGV2ZW50TmFtZTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICB9LFxuICAgIHN1YnNjcmliZTogZnVuY3Rpb24oaGFuZGxlciwgY29udGV4dCkge1xuICAgICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucy5wdXNoKG5ldyBTdWJzY3JpcHRpb24oaGFuZGxlciwgY29udGV4dCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3Vic2NyaXB0aW9uIHJlcXVpcmVzIGhhbmRsZXI6IFwiICsgdGhpcy5fZXZlbnROYW1lKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbihoYW5kbGVyLCBjb250ZXh0KSB7XG4gICAgICB2YXIgc3VicztcbiAgICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICAgIHN1YnMgPSBfLmZpbHRlcih0aGlzLl9zdWJzY3JpcHRpb25zLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgICByZXR1cm4gc3ViLm1hdGNoZXMoaGFuZGxlciwgY29udGV4dCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3VicyA9IHRoaXMuX3N1YnNjcmlwdGlvbnM7XG4gICAgICB9XG5cbiAgICAgIF8uZWFjaChzdWJzLCBmdW5jdGlvbihzdWIpIHtcbiAgICAgICAgc3ViLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gXy5kaWZmZXJlbmNlKHRoaXMuX3N1YnNjcmlwdGlvbnMsIHN1YnMpO1xuICAgIH0sXG4gICAgbm90aWZ5OiBmdW5jdGlvbihhcmdzKSB7XG4gICAgICBfLmludm9rZSh0aGlzLl9zdWJzY3JpcHRpb25zLCBcIm5vdGlmeVwiLCBhcmdzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBTdWJzY3JpcHRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChTdWJzY3JpcHRpb24ucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oaGFuZGxlciwgY29udGV4dCkge1xuICAgICAgdGhpcy5faGFuZGxlciA9IGhhbmRsZXI7XG4gICAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dDtcbiAgICB9LFxuICAgIG1hdGNoZXM6IGZ1bmN0aW9uKGhhbmRsZXIsIGNvbnRleHQpIHtcbiAgICAgIGlmICh0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgIC8vIENvbXBhcmUgY29udGV4dCByZWZzIGFzIHJlZnMgaWZmIHdlIGhhdmUgYSBjb250ZXh0IG9iamVjdFxuICAgICAgICByZXR1cm4gKGhhbmRsZXIgPT09IHRoaXMuX2hhbmRsZXIgJiYgY29udGV4dCA9PT0gdGhpcy5fY29udGV4dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UsIGp1c3QgbWFrZSBzdXJlIHdlIGRvbid0IGhhdmUgYSBjb250ZXh0IChudWxsIG9yIHVuZGVmaW5lZCBhcmUgZmluZSlcbiAgICAgICAgcmV0dXJuIChoYW5kbGVyID09PSB0aGlzLl9oYW5kbGVyICYmICFjb250ZXh0KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG5vdGlmeTogZnVuY3Rpb24oYXJncykge1xuICAgICAgLy8gV2Ugc2hvdWxkbid0IGJlIGNhbGxlZCBhZnRlciBkaXNwb3NlLCBidXRcbiAgICAgIC8vIGp1c3QgaW4gY2FzZS4uLlxuICAgICAgaWYgKHRoaXMuX2hhbmRsZXIpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlci5hcHBseSh0aGlzLl9jb250ZXh0LCBhcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiV1RGXCIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9oYW5kbGVyID0gbnVsbDtcbiAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xuICAgIH1cbiAgfSlcblxuICByZXR1cm4gUHViU3ViO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBEZWxlZ2F0ZXMgc3RvcmFnZSB0byBhIEpTIG9iamVjdC5cbiAgICovXG4gIHZhciBPYmplY3RIYXNoTWFwID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cblxuICBfLmV4dGVuZChPYmplY3RIYXNoTWFwLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9zdG9yZSA9IHt9O1xuICAgICAgdGhpcy5fa2V5UHJlZml4ID0gb3B0cy5nZXRPckVsc2UoXCJrZXlQcmVmaXhcIiwgXCJvaG0tXCIpO1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbihrZXkpe1xuICAgICAgcmV0dXJuIHRoaXMuX3N0b3JlW3RoaXMuX21ha2VLZXkoa2V5KV07XG4gICAgfSxcbiAgICBwdXQ6IGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgICB0aGlzLl9zdG9yZVt0aGlzLl9tYWtlS2V5KGtleSldID0gdmFsO1xuICAgIH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciB2YWw7XG4gICAgICBrZXkgPSB0aGlzLl9tYWtlS2V5KGtleSk7XG4gICAgICBpZiAoXy5oYXModGhpcy5fc3RvcmUsIGtleSkpIHtcbiAgICAgICAgdmFsID0gdGhpcy5fc3RvcmVba2V5XTtcbiAgICAgICAgZGVsZXRlIHRoaXMuX3N0b3JlW2tleV07XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsO1xuICAgIH0sXG4gICAgZXhpc3RzOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBfLmhhcyh0aGlzLl9zdG9yZSwgdGhpcy5fbWFrZUtleShrZXkpKTtcbiAgICB9LFxuICAgIHNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIF8uc2l6ZSh0aGlzLl9zdG9yZSk7XG4gICAgfSxcbiAgICBjbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zdG9yZSA9IHt9O1xuICAgIH0sXG4gICAgX21ha2VLZXk6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2tleVByZWZpeCArIGtleTtcbiAgICB9XG4gIH0pO1xuXG5cbiAgcmV0dXJuIE9iamVjdEhhc2hNYXA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgZG91Ymx5LWxpbmtlZCBsaXN0IGltcGxlbWVudGF0aW9uLlxuICAgKlxuICAgKi9cbiAgdmFyIERvdWJseUxpbmtlZExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChEb3VibHlMaW5rZWRMaXN0LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fZnJvbnQgPSBudWxsO1xuICAgICAgdGhpcy5fYmFjayA9IG51bGw7XG4gICAgICB0aGlzLl9zaXplID0gMDtcbiAgICB9LFxuXG4gICAgZ2V0OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIHRoaXMuX2NoZWNrRWxlbWVudElkeE9yVGhyb3coaWR4KTtcbiAgICAgIHZhciBub2RlID0gdGhpcy5fd2Fsa1RvSWR4KGlkeCk7XG4gICAgICByZXR1cm4gbm9kZS52YWx1ZSgpO1xuICAgIH0sXG5cbiAgICBleGlzdHM6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb1ZhbHVlKHZhbHVlKTtcbiAgICAgIHJldHVybiAhIW5vZGU7XG4gICAgfSxcblxuICAgIHNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NpemU7XG4gICAgfSxcblxuICAgIGFkZDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLmFkZEJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG4gICAgYWRkRnJvbnQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB0aGlzLl9saW5rRnJvbnQodmFsdWUpO1xuICAgIH0sXG5cbiAgICBhZGRCYWNrOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy5fbGlua0JhY2sodmFsdWUpO1xuICAgIH0sXG5cbiAgICByZW1vdmU6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb1ZhbHVlKHZhbHVlKTtcbiAgICAgIHJldHVybiB0aGlzLl91bmxpbmsobm9kZSk7XG4gICAgfSxcblxuICAgIHJlbW92ZUZyb250OiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9mcm9udCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzdWNoIGVsZW1lbnRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fdW5saW5rRnJvbnQodGhpcy5fZnJvbnQpO1xuICAgIH0sXG5cbiAgICByZW1vdmVCYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9iYWNrID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHN1Y2ggZWxlbWVudFwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl91bmxpbmtCYWNrKHRoaXMuX2JhY2spO1xuICAgIH0sXG5cbiAgICBpbnNlcnRBdEluZGV4OiBmdW5jdGlvbihpZHgsIHZhbHVlKSB7XG4gICAgICB0aGlzLl9jaGVja0lzRWxlbWVudFBvc2l0aW9uT3JUaHJvdyhpZHgpO1xuXG4gICAgICBpZiAoaWR4ID09PSB0aGlzLl9zaXplKSB7XG4gICAgICAgIHRoaXMuYWRkQmFjayh2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbm9kZSA9IHRoaXMuX3dhbGtUb0lkeChpZHgpO1xuICAgICAgICB0aGlzLl9saW5rQmVmb3JlKHZhbHVlLCBub2RlKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVtb3ZlQXRJbmRleDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICB0aGlzLl9jaGVja0VsZW1lbnRJZHhPclRocm93KGlkeCk7XG4gICAgICBpZiAoaWR4ID09PSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91bmxpbmtGcm9udCh0aGlzLl9mcm9udCk7XG4gICAgICB9IGVsc2UgaWYgKCBpZHggPT09ICh0aGlzLl9zaXplIC0gMSkgKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91bmxpbmtCYWNrKHRoaXMuX2JhY2spO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLl93YWxrVG9JZHgoaWR4KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VubGluayhub2RlKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG5vZGUgPSB0aGlzLl9mcm9udCxcbiAgICAgICAgICBuZXh0O1xuXG4gICAgICB3aGlsZSAobm9kZSAhPT0gbnVsbCkge1xuICAgICAgICBuZXh0ID0gbm9kZS5uZXh0KCk7XG4gICAgICAgIG5vZGUuZGlzcG9zZSgpO1xuICAgICAgICBub2RlID0gbmV4dDtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2Zyb250ID0gbnVsbDtcbiAgICAgIHRoaXMuX2JhY2sgID0gbnVsbDtcbiAgICAgIHRoaXMuX3NpemUgPSAwO1xuICAgIH0sXG5cbiAgICBfbGlua0Zyb250OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG9sZEZyb250ID0gdGhpcy5fZnJvbnQsXG4gICAgICAgICAgbmV3Tm9kZSA9IG5ldyBOb2RlKHt2YWx1ZTogdmFsdWV9KTtcbiAgICAgIHRoaXMuX2Zyb250ID0gbmV3Tm9kZTtcblxuICAgICAgaWYgKG9sZEZyb250ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2JhY2sgPSBuZXdOb2RlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2xkRnJvbnQuc2V0UHJldihuZXdOb2RlKTtcbiAgICAgICAgbmV3Tm9kZS5zZXROZXh0KG9sZEZyb250KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc2l6ZSsrO1xuICAgICAgcmV0dXJuIG5ld05vZGU7XG4gICAgfSxcblxuICAgIF9saW5rQmFjazogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBvbGRCYWNrID0gdGhpcy5fYmFjayxcbiAgICAgICAgICBuZXdOb2RlID0gbmV3IE5vZGUoe3ZhbHVlOiB2YWx1ZX0pO1xuXG4gICAgICB0aGlzLl9iYWNrID0gbmV3Tm9kZTtcbiAgICAgIGlmIChvbGRCYWNrID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gbmV3Tm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9sZEJhY2suc2V0TmV4dChuZXdOb2RlKTtcbiAgICAgICAgbmV3Tm9kZS5zZXRQcmV2KG9sZEJhY2spO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zaXplKys7XG4gICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICB9LFxuXG4gICAgX2xpbmtCZWZvcmU6IGZ1bmN0aW9uKHZhbHVlLCBub2RlKSB7XG4gICAgICB2YXIgcHJlZCAgICA9IG5vZGUucHJldigpLFxuICAgICAgICAgIG5ld05vZGUgPSBuZXcgTm9kZSh7dmFsdWU6IHZhbHVlLCBwcmV2OiBwcmVkLCBuZXh0OiBub2RlfSk7XG5cbiAgICAgIG5vZGUuc2V0UHJldihuZXdOb2RlKTtcbiAgICAgIGlmIChwcmVkID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gbmV3Tm9kZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByZWQuc2V0TmV4dChuZXdOb2RlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX3NpemUrKztcbiAgICAgIHJldHVybiBuZXdOb2RlO1xuICAgIH0sXG5cbiAgICBfdW5saW5rRnJvbnQ6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciB2YWx1ZSAgICA9IG5vZGUudmFsdWUoKSxcbiAgICAgICAgICBuZXdGcm9udCA9IG5vZGUubmV4dCgpO1xuXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2Zyb250ID0gbmV3RnJvbnQ7XG4gICAgICBpZiAobmV3RnJvbnQgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fYmFjayA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdGcm9udC5zZXRQcmV2KG51bGwpO1xuICAgICAgfVxuICAgICAgdGhpcy5fc2l6ZS0tO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBfdW5saW5rQmFjazogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdmFyIHZhbHVlICAgPSBub2RlLnZhbHVlKCksXG4gICAgICAgICAgbmV3QmFjayA9IG5vZGUucHJldigpO1xuXG4gICAgICBub2RlLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2JhY2sgPSBuZXdCYWNrO1xuICAgICAgaWYgKG5ld0JhY2sgPT0gbnVsbCkge1xuICAgICAgICB0aGlzLl9mcm9udCA9IG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdCYWNrLnNldE5leHQobnVsbCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zaXplLS07XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcblxuICAgIF91bmxpbms6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciBwcmV2ICA9IG5vZGUucHJldigpLFxuICAgICAgICAgIG5leHQgID0gbm9kZS5uZXh0KCksXG4gICAgICAgICAgdmFsdWUgPSBub2RlLnZhbHVlKCk7XG5cbiAgICAgIGlmIChwcmV2ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuX2Zyb250ID0gbmV4dDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByZXYuc2V0TmV4dChuZXh0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5leHQgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5fYmFjayA9IHByZXY7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0LnNldFByZXYocHJldik7XG4gICAgICB9XG5cbiAgICAgIG5vZGUuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5fc2l6ZS0tO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBfd2Fsa1RvSWR4OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIHZhciBub2RlLCBjdXJyZW50O1xuICAgICAgaWYgKGlkeCA8IHRoaXMuX3NpemUgLyAyKSB7XG4gICAgICAgIG5vZGUgPSB0aGlzLl9mcm9udDtcbiAgICAgICAgY3VycmVudCA9IDA7XG4gICAgICAgIHdoaWxlKGN1cnJlbnQgIT09IGlkeCkge1xuICAgICAgICAgIG5vZGUgPSBub2RlLm5leHQoKTtcbiAgICAgICAgICBjdXJyZW50Kys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vZGUgPSB0aGlzLl9iYWNrO1xuICAgICAgICBjdXJyZW50ID0gdGhpcy5fc2l6ZSAtIDE7XG5cbiAgICAgICAgd2hpbGUoY3VycmVudCAhPT0gaWR4KSB7XG4gICAgICAgICAgbm9kZSA9IG5vZGUucHJldigpO1xuICAgICAgICAgIGN1cnJlbnQtLTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5vZGU7XG4gICAgfSxcblxuICAgIF93YWxrVG9WYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciBuID0gdGhpcy5fZnJvbnQ7XG4gICAgICB3aGlsZSAobiAhPT1udWxsICkge1xuICAgICAgICBpZiAobi5tYXRjaCh2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfVxuICAgICAgICBuID0gbi5uZXh0KCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2lzRWxlbWVudElkeDogZnVuY3Rpb24oaWR4KSB7XG4gICAgICByZXR1cm4gKGlkeCA+PSAwICYmIGlkeCA8IHRoaXMuX3NpemUpO1xuICAgIH0sXG5cbiAgICBfaXNFbGVtZW50UG9zaXRpb246IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgcmV0dXJuIChpZHggPj0gMCAmJiBpZHggPD0gdGhpcy5fc2l6ZSk7XG4gICAgfSxcblxuICAgIF9jaGVja0VsZW1lbnRJZHhPclRocm93OiBmdW5jdGlvbihpZHgpIHtcbiAgICAgIGlmICghdGhpcy5faXNFbGVtZW50SWR4KGlkeCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kczsgc2l6ZTogXCIgKyB0aGlzLl9zaXplICsgXCI7IGlkeDogXCIgKyBpZHgpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfY2hlY2tJc0VsZW1lbnRQb3NpdGlvbk9yVGhyb3c6IGZ1bmN0aW9uKGlkeCkge1xuICAgICAgaWYgKCF0aGlzLl9pc0VsZW1lbnRQb3NpdGlvbihpZHgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluZGV4IG91dCBvZiBib3VuZHM7IHNpemU6IFwiICsgdGhpcy5fc2l6ZSArIFwiOyBpZHg6IFwiICsgaWR4KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfSk7XG5cbiAgdmFyIE5vZGUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChOb2RlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgICAgICAgID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fbmV4dCAgPSBvcHRzLmdldE9yRWxzZShcIm5leHRcIiwgbnVsbCk7XG4gICAgICB0aGlzLl9wcmV2ICA9IG9wdHMuZ2V0T3JFbHNlKFwicHJldlwiLCBudWxsKTtcbiAgICAgIHRoaXMuX3ZhbHVlID0gb3B0cy5nZXRPckVsc2UoXCJ2YWx1ZVwiLCBudWxsKTtcbiAgICB9LFxuXG4gICAgbmV4dDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbmV4dDtcbiAgICB9LFxuXG4gICAgcHJldjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcHJldjtcbiAgICB9LFxuXG4gICAgc2V0TmV4dDogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdGhpcy5fbmV4dCA9IG5vZGU7XG4gICAgfSxcblxuICAgIHNldFByZXY6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHRoaXMuX3ByZXYgPSBub2RlO1xuICAgIH0sXG5cbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbmV4dCAgPSBudWxsO1xuICAgICAgdGhpcy5fcHJldiAgPSBudWxsO1xuICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xuICAgIH0sXG5cbiAgICBtYXRjaDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZSA9PT0gdmFsdWU7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRG91Ymx5TGlua2VkTGlzdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zLFxuICBPYmplY3RIYXNoTWFwLFxuICBEb3VibHlMaW5rZWRMaXN0XG4pIHtcblxuICAvKipcbiAgICogQW4gaW4tbWVtb3J5IGhhc2ggbWFwIHdpdGggYW4gTFJVIGV2aWN0aW9uIHBvbGljeS5cbiAgICpcbiAgICovXG4gIHZhciBMUlVIYXNoTWFwID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTFJVSGFzaE1hcC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fY2FwYWNpdHkgPSBvcHRzLmdldE9yRXJyb3IoXCJjYXBhY2l0eVwiKTtcbiAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QgPSBuZXcgRG91Ymx5TGlua2VkTGlzdCgpO1xuICAgICAgLy8gVE9ETzogUmVhbGx5IG5lZWQgYSBwcm9wZXIgSGFzaE1hcCBhdCBzb21lIHBvaW50Li4uXG4gICAgICB0aGlzLl9zdG9yZSA9IG5ldyBPYmplY3RIYXNoTWFwKCk7XG4gICAgfSxcbiAgICBnZXQ6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fc3RvcmUuZ2V0KGtleSk7XG4gICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQXMgYSBwZXJmIG9wdGltaXphdGlvbiwgd2Uga2VlcCBhIHJlZlxuICAgICAgLy8gdG8gdGhlIG5vZGUgaW4gdGhlIGVudHJ5LlxuICAgICAgdmFyIG5vZGUgPSBlbnRyeS5ub2RlKCk7XG4gICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll91bmxpbmsobm9kZSk7XG5cbiAgICAgIC8vIEdldCB0aGUgbmV3IG5vZGVcbiAgICAgIG5vZGUgPSB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll9saW5rRnJvbnQoZW50cnkua2V5KCkpO1xuXG4gICAgICAvLyBTYXZlIGl0XG4gICAgICBlbnRyeS5zZXROb2RlKG5vZGUpO1xuICAgICAgLy8gUmV0dXJuIHRoZSB2YWx1ZVxuICAgICAgcmV0dXJuIGVudHJ5LnZhbHVlKCk7XG4gICAgfSxcblxuICAgIHB1dDogZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICAgIHZhciBlbnRyeSA9IHRoaXMuX3N0b3JlLmdldChrZXkpLFxuICAgICAgICAgIG5vZGU7XG4gICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgIC8vIElmIG5vIGVudHJ5LCBtYWtlIGEgbmV3IGVudHJ5XG4gICAgICAgIGlmICh0aGlzLl9rZXlBY2Nlc3NMaXN0LnNpemUoKSA+PSB0aGlzLl9jYXBhY2l0eSkge1xuICAgICAgICAgIC8vIEhhdmUgdG8gbWFrZSByb29tIGZvciBpdFxuICAgICAgICAgIHZhciBldmljdGVkS2V5ID0gdGhpcy5fa2V5QWNjZXNzTGlzdC5yZW1vdmVCYWNrKCksXG4gICAgICAgICAgICAgIGV2aWN0ZWRFbnRyeSA9IHRoaXMuX3N0b3JlLmdldChldmljdGVkS2V5KTtcblxuICAgICAgICAgIGV2aWN0ZWRFbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgICAgdGhpcy5fc3RvcmUucmVtb3ZlKGV2aWN0ZWRLZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZSA9IHRoaXMuX2tleUFjY2Vzc0xpc3QuX2xpbmtGcm9udChrZXkpO1xuICAgICAgICBlbnRyeSA9IG5ldyBFbnRyeSh7XG4gICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgdmFsdWU6IHZhbCxcbiAgICAgICAgICBub2RlOiBub2RlXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9zdG9yZS5wdXQoa2V5LCBlbnRyeSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBcIlRvdWNoXCIgdGhlIGVudHJ5LCBzZXQgbmV3IHZhbHVlXG4gICAgICAgIG5vZGUgPSBlbnRyeS5ub2RlKCk7XG4gICAgICAgIHRoaXMuX2tleUFjY2Vzc0xpc3QuX3VubGluayhub2RlKTtcbiAgICAgICAgbm9kZSA9IHRoaXMuX2tleUFjY2Vzc0xpc3QuX2xpbmtGcm9udChlbnRyeS5rZXkoKSk7XG4gICAgICAgIC8vIFVwZGF0ZSB3aXRoIHRoZSBuZXcgbm9kZSBhbmQgdmFsdWVcbiAgICAgICAgZW50cnkuc2V0Tm9kZShub2RlKTtcbiAgICAgICAgZW50cnkuc2V0VmFsdWUodmFsKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciBlbnRyeSA9IHRoaXMuX3N0b3JlLmdldChrZXkpLFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgIG5vZGU7XG4gICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgdmFsdWUgPSBlbnRyeS52YWx1ZSgpO1xuICAgICAgICBub2RlID0gZW50cnkubm9kZSgpO1xuICAgICAgICB0aGlzLl9rZXlBY2Nlc3NMaXN0Ll91bmxpbmsobm9kZSk7XG4gICAgICAgIGVudHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgdGhpcy5fc3RvcmUucmVtb3ZlKGtleSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgZXhpc3RzOiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZS5leGlzdHMoa2V5KTtcbiAgICB9LFxuXG4gICAgc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmUuc2l6ZSgpO1xuICAgIH0sXG5cbiAgICBjbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9zdG9yZS5jbGVhcigpO1xuICAgICAgdGhpcy5fa2V5QWNjZXNzTGlzdC5jbGVhcigpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIEVudHJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRW50cnkucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIC8vIFRob3VnaCB0aGUgTm9kZSBzaG91bGQgaGF2ZSB0aGUga2V5LCBpZiB0aGUgbm9kZVxuICAgICAgLy8gaXMgdW5saW5rZWQgZnJvbSB0aGUgbGlzdCwgaXRzIGJveGVkIHZhbHVlIHdpbGwgZGlzYXBwZWFyXG4gICAgICB0aGlzLl9rZXkgICA9IG9wdHMuZ2V0T3JFcnJvcihcImtleVwiKTtcbiAgICAgIHRoaXMuX3ZhbHVlID0gb3B0cy5nZXRPckVycm9yKFwidmFsdWVcIik7XG4gICAgICB0aGlzLl9ub2RlICA9IG9wdHMuZ2V0T3JFcnJvcihcIm5vZGVcIik7XG4gICAgfSxcbiAgICBub2RlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9ub2RlO1xuICAgIH0sXG4gICAgc2V0Tm9kZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdGhpcy5fbm9kZSA9IG5vZGU7XG4gICAgfSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfSxcbiAgICBzZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7XG4gICAgfSxcbiAgICBrZXk6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2tleTtcbiAgICB9LFxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fa2V5ID0gbnVsbDtcbiAgICAgIHRoaXMuX3ZhbHVlID0gbnVsbDtcbiAgICAgIHRoaXMuX25vZGUgPSBudWxsO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIExSVUhhc2hNYXA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL29iamVjdC1oYXNoLW1hcFwiKSxcbiAgcmVxdWlyZShcIi4vZG91Ymx5LWxpbmtlZC1saXN0XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnMsXG4gIEluTWVtb3J5RGF0YVN0b3JlLFxuICBVbml0U2VxdWVuY2VyLFxuICBFbnRyeVxuKSB7XG5cbiAgLy8gQXBwcm9wcmlhdGUgZm9yIHRoZSBkZWZhdWx0IHNlcXVlbmNlciAobm9uLXRlbXBvcmFsKVxuICB2YXIgREVGQVVMVF9UVEwgPSAxO1xuXG5cbiAgLyoqXG4gICAqIEEgbG9vay1hc2lkZSBjYWNoaW5nIGRhdGEgc3RvcmUuIE5vdGU6IGl0J3MgZ2VuZXJhbGx5IG5vdCB1c2VmdWwgdG8gYWxsb3dcbiAgICogbnVsbC91bmRlZmluZWQgc3RvcmVkIHZhbHVlcy4gV2hlbiBhbiBpdGVtIGlzIGV2aWN0ZWQgZnJvbSB0aGUgY2FjaGUsIGFcbiAgICogc3Vic2VxdWVudCBgZ2V0YCBjYWxsIHdpbGwgcmV0dXJuIGB1bmRlZmluZWRgLCBzbyBpdCBjYW4gYmUgZGlmZmljdWx0IHRvXG4gICAqIGRldGVybWluZSBpZiB0aGVyZSB3YXMgYSBjYWNoZSBtaXNzIGlmIHRoZSB2YWx1ZSB5b3UncmUgc3RvcmluZyBpcywgaW4gZmFjdCxcbiAgICogYHVuZGVmaW5lZGAsIHVubGVzcyB5b3UgcHJlZml4IGV2ZXJ5IGNoZWNrIHdpdGggYGV4aXN0c2AsIHdoaWNoIGFsc28gZG9lc1xuICAgKiBjYWNoZSBldmljdGlvbiBvbiBjaGVjay5cbiAgICovXG4gIHZhciBDYWNoaW5nRGF0YVN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ2FjaGluZ0RhdGFTdG9yZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIiwgREVGQVVMVF9UVEwpO1xuXG4gICAgICAvLyBEZWZhdWx0IHNlcXVlbmNlciBpcyBhIGxpbmVhci91bml0IHNlcXVlbmNlci4gVGhlIGRlZmF1bHQgVFRMIGlzXG4gICAgICAvLyAxLiBUaGVyZWZvcmUsIGFsbCB2YWx1ZXMgd2lsbCBleHBpcmUgd2l0aCBzaW5nbGUgYWR2YW5jZSBvZiB0aGVcbiAgICAgIC8vIHNlcXVlbmNlci4gTm90ZSB0aGF0IHRoZSBkYXRhIHN0b3JlIGRvZXNuJ3QgYWR2YW5jZSB0aGVcbiAgICAgIC8vIHNlcXVlbmNlciBpdHNlbGYuIFRoZSBzdG9yZSBvd25lciBpcyByZXNwb25zaWJsZSBmb3IgZG9pbmdcbiAgICAgIC8vIHRoaXMuXG4gICAgICAvL1xuICAgICAgLy8gVGhpcyBpcyBlc3BlY2lhbGx5IGltcG9ydGFudCB0byBub3RlIGZvciB0aW1lLWJhc2VkIHNlcXVlbmNlcnMuXG4gICAgICAvLyBUaW1lIHdpbGwgbm90IGFkdmFuY2UgYXV0b21hdGljYWxseS4gVGhlIHN0b3JlIG93bmVyIGlzIHJlc3BvbnNpYmxlXG4gICAgICAvLyBmb3Igc2NoZWR1bGluZyB0aGUgc2VxdWVuY2VyIHRvIGFkdmFuY2Ugd2l0aCB0aW1lLiBUaGlzIGtlZXBzIHRoZVxuICAgICAgLy8gQ2FjaGluZ0RhdGFTdG9yZSdzIGxpZmVjeWNsZSBzaW1wbGUgd2l0aCByZXNwZWN0IHRvIHRpbWUuXG4gICAgICB0aGlzLl9zZXF1ZW5jZXIgPSBvcHRzLmdldE9yRWxzZUZuKFwic2VxdWVuY2VyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFVuaXRTZXF1ZW5jZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBCeSBkZWZhdWx0LCB3ZSBkZWxlZ2F0ZSB0byBhbiBpbi1tZW1vcnkgc3RvcmUuIEZpbmUgZm9yIHNpbXBsZVxuICAgICAgLy8gY2FzZXMsIGJ1dCBub3Qgb3B0aW1hbC5cbiAgICAgIHRoaXMuX2JhY2tpbmdTdG9yZSA9IG9wdHMuZ2V0T3JFbHNlRm4oXCJiYWNraW5nU3RvcmVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW5NZW1vcnlEYXRhU3RvcmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBVcGRhdGVzIHRoZSBsYXN0VXBkYXRlZCB0aW1lIHRvIFwibm93XCIgb24gcmVhZCAtIGtlZXBzIGVudHJpZXNcbiAgICAgIC8vIGZyb20gZXhwaXJpbmcgd2hlbiB0aGV5J3JlIGJlaW5nIGFjY2Vzc2VkLCBidXQgY2FuIGNhdXNlXG4gICAgICAvLyBzdGFsZW5lc3MgaXNzdWVzLlxuICAgICAgdGhpcy5fc2hvdWxkVG91Y2hPblJlYWQgPSBvcHRzLmdldE9yRWxzZShcInRvdWNoT25SZWFkXCIsIGZhbHNlKTtcbiAgICB9LFxuXG4gICAgc2VxdWVuY2VyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zZXF1ZW5jZXI7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBrZXkuIElmIHRoZSBvYmplY3QgaGFzXG4gICAgICogZXhwaXJlZCwgaXQgd2lsbCBiZSBldmljdGVkIGZyb20gdGhlIGNhY2hlLCBhbmQgYHVuZGVmaW5lZGAgd2lsbFxuICAgICAqIGJlIHJldHVybmVkIGluc3RlYWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5IHtzdHJpbmd9IChyZXF1aXJlZClcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3Q+fSByZXF1ZXN0ZWQgdmFsdWVcbiAgICAgKi9cbiAgICBnZXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpe1xuICAgICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWVudHJ5LmlzRXhwaXJlZCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwgdGhpcy5fdHRsKSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Nob3VsZFRvdWNoT25SZWFkKSB7XG4gICAgICAgICAgICAgIGVudHJ5LnRvdWNoKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucHV0KGtleSwgZW50cnkpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAucmV0dXJuKGVudHJ5LnZhbHVlKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmUoa2V5KVxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyAudGhlblJldHVybiBpcyBhIGxpZS5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgdGhlIHByb3ZpZGVkIGB2YWxgLCBpZGVudGlmaWVkIGJ5IGBrZXlgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYGtleWAge3N0cmluZ30gIChyZXF1aXJlZCkgaWRlbnRpZmllciBmb3IgdmFsdWUgdG8gYmUgc3RvcmVkXG4gICAgICogQHBhcmFtIGB2YWxgIHtkeW5hbWljfSAocmVxdWlyZWQpIHZhbHVlIHRvIGJlIHN0b3JlZFxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPD59XG4gICAgICovXG4gICAgcHV0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGFuIGVudHJ5LCB3ZSBzaG91bGQganVzdCB1cGRhdGVcbiAgICAgICAgICAvLyBFbHNlLCB3ZSBtYWtlIG5ldyBvbmUuXG4gICAgICAgICAgLy8gUGVzaXN0LCB0aGVuIHJldHVybiBub3RoaW5nLlxuICAgICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgZW50cnkudXBkYXRlKHZhbCwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbnRyeSA9IG5ldyBFbnRyeSh7XG4gICAgICAgICAgICAgIHZhbHVlOiB2YWwsXG4gICAgICAgICAgICAgIGluaXRpYWxTZXF1ZW5jZTogdGhpcy5fc2VxdWVuY2VyLnZhbHVlKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucHV0KGtleSwgZW50cnkpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgYGtleWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBga2V5YCB7c3RyaW5nfSAocmVxdWlyZWQpIGlkZW50aWZpZXIgZm9yIHZhbHVlIHRvIGJlIHJlbW92ZWRcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxkeW5hbWljPn0gUmVtb3ZlZCB2YWx1ZSwgaWYgcHJlc2VudCBpbiBzdG9yZS5cbiAgICAgKi9cbiAgICByZW1vdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSkge1xuICAgICAgdmFyIHZhbDtcbiAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmVcbiAgICAgICAgLnJlbW92ZShrZXkpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICB2YWwgPSBlbnRyeS52YWx1ZSgpO1xuICAgICAgICAgICAgZW50cnkuZGlzcG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgZXhpc3RzOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpe1xuICAgICAgLy8gSXQncyBub3Qgc3VmZmljaWVudCB0byBkZWxlZ2F0ZSB0aGlzIGNhbGwgdG8gdGhlIHVuZGVybHlpbmdcbiAgICAgIC8vIGJhY2tpbmcgc3RvcmUuIFdlIG5lZWQgdG8gcGVyZm9ybSBldmljdGlvbiwgYXMgYSBzdWJzZXF1ZW50IGNhbGxcbiAgICAgIC8vIHRvIGdldCB3b3VsZCBkbyB0aGUgc2FtZS4gSWYgdGhlIGBleGlzdHNgIGNoZWNrIHNheXMgaXQgZXhpc3RzLFxuICAgICAgLy8gYmV0IGl0IGRvZXNuJ3Qgd2hlbiB3ZSBgZ2V0YCwgdGhlbiBgZXhpc3RzYCBpcyBhIHdvcnRobGVzcyBvcGVyYXRpb24uXG4gICAgICAvL1xuICAgICAgLy8gTm90ZSB0aGF0IGlmIHlvdSdyZSB1c2luZyBhIENhY2hpbmdEYXRhU3RvcmUgYmFja2VkIGJ5IGFuIEluTWVtb3J5RGF0YVN0b3JlXG4gICAgICAvLyBiYWNrZWQgYnkgYW4gTFJVSGFzaE1hcCwgdGhpcyB3aWxsIGNhdXNlIHRoZSBlbnRyeSB0byBiZSBcInRvdWNoZWRcIiwgd2hlcmVhc1xuICAgICAgLy8gYSBub3JtYWwgXCJleGlzdHNcIiBjaGVjayB3b3VsZCBub3QuXG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpZiAoIWVudHJ5LmlzRXhwaXJlZCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwgdGhpcy5fdHRsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUucmVtb3ZlKGtleSlcbiAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBlbnRyeS5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgLnRoZW5SZXR1cm4oZmFsc2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgY2xlYXI6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5jbGVhcigpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBDYWNoaW5nRGF0YVN0b3JlO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWRhdGEtc3RvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci91bml0LXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWxzL2V4cGlyaW5nLWVudHJ5XCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnMsXG4gIEluTWVtb3J5RGF0YVN0b3JlLFxuICBMUlVIYXNoTWFwXG4pIHtcblxuICAvKipcbiAgICogQSBEYXRhIFN0b3JlIHdpdGggYW4gTFJVIGV2aWN0aW9uIHBvbGljeS5cbiAgICpcbiAgICovXG4gIHZhciBMUlVEYXRhU3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMUlVEYXRhU3RvcmUucHJvdG90eXBlLCBJbk1lbW9yeURhdGFTdG9yZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdmFyIG1hcCA9IG5ldyBMUlVIYXNoTWFwKHtcbiAgICAgICAgY2FwYWNpdHk6IG9wdHMuZ2V0T3JFcnJvcihcImNhcGFjaXR5XCIpXG4gICAgICB9KTtcbiAgICAgIEluTWVtb3J5RGF0YVN0b3JlLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywge1xuICAgICAgICBiYWNraW5nSGFzaE1hcDogbWFwXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBMUlVEYXRhU3RvcmU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuL2luLW1lbW9yeS1kYXRhLXN0b3JlXCIpLFxuICByZXF1aXJlKFwiLi4vY29sbGVjdGlvbi9scnUtaGFzaC1tYXBcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9ucyxcbiAgT2JqZWN0SGFzaE1hcFxuKSB7XG5cbiAgLyoqXG4gICAqIEluTWVtb3J5RGF0YVN0b3JlIGRlbGVnYXRlcyB0byBhIGJhY2tpbmcgSGFzaE1hcC4gQnkgZGVmYXVsdCwgdGhpc1xuICAgKiB3aWxsIGJlIGEgXCJwb29yIG1hbidzIEhhc2hNYXBcIiwgYS5rLmEuLCB0aGUgT2JqZWN0SGFzaE1hcC5cbiAgICovXG4gIHZhciBJbk1lbW9yeURhdGFTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEluTWVtb3J5RGF0YVN0b3JlLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9tYXAgPSBvcHRzLmdldE9yRWxzZUZuKFwiYmFja2luZ0hhc2hNYXBcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JqZWN0SGFzaE1hcCgpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGdldDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLmdldChrZXkpO1xuICAgIH0pLFxuXG4gICAgcHV0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXksIHZhbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5wdXQoa2V5LCB2YWwpO1xuICAgIH0pLFxuXG4gICAgcmVtb3ZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLl9tYXAucmVtb3ZlKGtleSk7XG4gICAgfSksXG5cbiAgICBleGlzdHM6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICByZXR1cm4gdGhpcy5fbWFwLmV4aXN0cyhrZXkpO1xuICAgIH0pLFxuXG4gICAgY2xlYXI6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21hcC5jbGVhcigpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBJbk1lbW9yeURhdGFTdG9yZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29sbGVjdGlvbi9vYmplY3QtaGFzaC1tYXBcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgQ2hhbm5lbCxcbiAgQ2hhaW5lZENoYW5uZWwsXG4gIFVuaXRTZXF1ZW5jZXIsXG4gIERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyLFxuICBJbk1lbW9yeURhdGFTdG9yZSxcbiAgRW50cnlcbikge1xuXG4gIC8qKlxuICAgKiBTZW1hbnRpY2FsbHkgc2ltaWxhciB0byBhIENhY2hpbmdEYXRhU3RvcmUsIGV4Y2VwdDpcbiAgICogICAxKSBFeHBpcnkgaXMgY2hlY2sgYm90aCBvbiBhY2Nlc3MsIGFuZCB3aGVuZXZlciBgYWR2YW5jZWAgaXNcbiAgICogICAgICBjYWxsZWQgb24gdGhlIGBzZW50cnlTZXF1ZW5jZXJgLlxuICAgKiAgIDIpIFJlY29yZHMgYXJlIG5vdCBhdXRvbWF0aWNhbGx5IHJlbW92ZWQ7IGluc3RlYWQsIGEgc2lnbmFsIGlzIHNlbnRcbiAgICogICAgICBhbG9uZyB0aGUgYHNpZ25hbENoYW5uZWxgLiBUaGUgc2lnbmFsIGRpc3BhdGNoIGlzIGRlZmVycmVkLCBzb1xuICAgKiAgICAgIGFuIGFjY2Vzcy10cmlnZ2VyZWQgZXZvY2F0aW9uIHNpZ25hbCB3b24ndCBiZSByZWNlaXZlZCB1bnRpbCBhXG4gICAqICAgICAgc3Vic2VxdWVudCB0aWNrLiBTaW5jZSBwcm9taXNlcyBhcmUgYXN5bmNocm9ub3VzLCB0aGlzIG1lYW5zXG4gICAqICAgICAgdGhlIGNhbGxlciBtYXkgcmVjZWl2ZSBhIHZhbHVlIGZyb20gdGhlIHN0b3JlLCBhbmQgbWF5IGFsc29cbiAgICogICAgICByZWNlaXZlIGFuIGV2ZW50IGZyb20gdGhlIFN0b3JlIGluZGljYXRpbmcgZXhwaXJ5IC0gaW4gbm9uLWRldGVybWluaXN0aWNcbiAgICogICAgICBvcmRlci4gSXQncyB1cCB0byB0aGUgY2FsbGVyIHRvIGNob29zZSBhIHJlc29sdXRpb24uXG4gICAqICAgICAgQWRkaXRpb25hbGx5LCB0aGVyZSBpcyBubyBndWFyYW50ZWUgdGhhdCBhIHNpbmdsZSBleHBpcnkgZXZlbnRcbiAgICogICAgICB3aWxsIGJlIHNlbnQgZm9yIGEgZ2l2ZW4ga2V5OyBpbnN0ZWFkLCB0aGUgZXZlbnQgd2lsbCBjb250aW51ZVxuICAgKiAgICAgIHRvIGJlIGRpc3BhdGNoZWQgZm9yIGFzIGxvbmcgYXMgdGhlIGtleSByZW1haW5zIGluIHRoZSBzdG9yZS5cbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgU2lnbmFsaW5nRGF0YVN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgdmFyIERFRkFVTFRfVFRMID0gMTtcblxuICBfLmV4dGVuZChTaWduYWxpbmdEYXRhU3RvcmUucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3R0bCA9IG9wdHMuZ2V0T3JFbHNlKFwidHRsXCIsIERFRkFVTFRfVFRMKTtcblxuICAgICAgdGhpcy5fc2VxdWVuY2VyID0gb3B0cy5nZXRPckVsc2VGbihcInNlcXVlbmNlclwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBVbml0U2VxdWVuY2VyKCk7XG4gICAgICB9KTtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2RvQ2hlY2tcIik7XG5cbiAgICAgIHRoaXMuX3NlbnRyeVNlcXVlbmNlciA9IG5ldyBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcih7XG4gICAgICAgIGRlbGVnYXRlOiBuZXcgVW5pdFNlcXVlbmNlcigpLFxuICAgICAgICB0YXJnZXRzOiBbe1xuICAgICAgICAgIGFkdmFuY2U6IHRoaXMuX2RvQ2hlY2tcbiAgICAgICAgfV1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9iYWNraW5nU3RvcmUgPSBvcHRzLmdldE9yRWxzZUZuKFwiYmFja2luZ1N0b3JlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5RGF0YVN0b3JlKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fc2hvdWxkVG91Y2hPblJlYWQgPSBvcHRzLmdldE9yRWxzZShcInRvdWNoT25SZWFkXCIsIGZhbHNlKTtcblxuICAgICAgdGhpcy5fc2lnbmFsQ2hhbm5lbCA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG5cbiAgICAgIHRoaXMuX2tleXMgPSBNLnNldCgpO1xuICAgIH0sXG5cbiAgICBzZXF1ZW5jZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlcjtcbiAgICB9LFxuXG4gICAgc2VudHJ5U2VxdWVuY2VyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zZW50cnlTZXF1ZW5jZXI7XG4gICAgfSxcblxuICAgIHNpZ25hbENoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBDaGFpbmVkQ2hhbm5lbCh7XG4gICAgICAgIHNlbnRpbmVsOiB0aGlzLFxuICAgICAgICBjaGFpblRvOiB0aGlzLl9zaWduYWxDaGFubmVsXG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgX2RvQ2hlY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHdvcmsgPSBNLm1hcChfLmJpbmQoZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZ2V0KGtleSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgICAgaWYgKGVudHJ5ICYmIGVudHJ5LmlzRXhwaXJlZCh0aGlzLl9zZXF1ZW5jZXIudmFsdWUoKSwgdGhpcy5fdHRsKSkge1xuICAgICAgICAgICAgICB0aGlzLl9zaWduYWxFeHBpcnlTb29uKGtleSwgdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9LCB0aGlzKSwgdGhpcy5fa2V5cyk7XG5cbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChNLmludG9fYXJyYXkod29yaykpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGBrZXlgLiBJZiB0aGUgb2JqZWN0XG4gICAgICogaGFzIGV4cGlyZWQsIGl0IHdpbGwgc3RpbGwgYmUgcmV0dXJuZWQgZnJvbSB0aGUgU3RvcmUsIGJ1dCBhbiBtVDpleHBpcmVkXG4gICAgICogbWVzc2FnZSB3aWxsIGJlIHNlbnQgYWxvbmcgdGhlIGBzaWduYWxDaGFubmVsYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkge3N0cmluZ31cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxvYmplY3Q+fSByZXF1ZXN0ZWQgdmFsdWVcbiAgICAgKi9cbiAgICBnZXQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja2luZ1N0b3JlLmdldChrZXkpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgaXNFeHBpcmVkID0gZW50cnkuaXNFeHBpcmVkKHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLCB0aGlzLl90dGwpO1xuXG4gICAgICAgICAgaWYgKGlzRXhwaXJlZCkge1xuICAgICAgICAgICAgdGhpcy5fc2lnbmFsRXhwaXJ5U29vbihrZXksIHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWlzRXhwaXJlZCAmJiB0aGlzLl9zaG91bGRUb3VjaE9uUmVhZCkge1xuICAgICAgICAgICAgZW50cnkudG91Y2godGhpcy5fc2VxdWVuY2VyLnZhbHVlKCkpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5wdXQoa2V5LCBlbnRyeSk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC50aGVuUmV0dXJuKGVudHJ5LnZhbHVlKCkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZW50cnkudmFsdWUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogU3RvcmVzIHRoZSBwcm92aWRlZCBgdmFsYCwgaWRlbnRpZmllZCBieSBga2V5YCwgd2l0aCBhIFRUTCBvcHRpb25hbGx5XG4gICAgICogc3VwcGxpZWQgYnkgYG9wdHMudHRsYCAob3ZlcnJpZGVzIHByZS1jb25maWd1cmVkIFN0b3JlIFRUTC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXkge1N0cmluZ31cbiAgICAgKiBAcGFyYW0gdmFsIHtvYmplY3R9IHZhbHVlIHRvIGJlIHN0b3JlZFxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPD59XG4gICAgICovXG4gICAgcHV0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXksIHZhbCwgb3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgIGVudHJ5LnVwZGF0ZSh2YWwsIHRoaXMuX3NlcXVlbmNlci52YWx1ZSgpLCB7XG4gICAgICAgICAgICAgIHR0bDogb3B0cy5nZXRPckVsc2UoXCJ0dGxcIilcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbnRyeSA9IG5ldyBFbnRyeSh7XG4gICAgICAgICAgICAgIHZhbHVlOiB2YWwsXG4gICAgICAgICAgICAgIGluaXRpYWxTZXF1ZW5jZTogdGhpcy5fc2VxdWVuY2VyLnZhbHVlKCksXG4gICAgICAgICAgICAgIHR0bDogb3B0cy5nZXRPckVsc2UoXCJ0dGxcIilcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5wdXQoa2V5LCBlbnRyeSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHRoaXMuX2tleXMgPSBNLmNvbmoodGhpcy5fa2V5cywga2V5KTtcbiAgICAgICAgICAgICAgcmV0dXJuOyAvLyBCZWNhdXNlIHRoZW5SZXR1cm4gZG9lc24ndCB3b3JrIHdpdGggYW4gZW1wdHkgdmFsdWUuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgYGtleWBcbiAgICAgKi9cbiAgICByZW1vdmU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGtleSl7XG4gICAgICB2YXIgdmFsO1xuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZVxuICAgICAgICAucmVtb3ZlKGtleSlcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgIHRoaXMuX2tleXMgPSBNLmRpc2oodGhpcy5fa2V5cywga2V5KTtcblxuICAgICAgICAgICAgdmFsID0gZW50cnkudmFsdWUoKTtcbiAgICAgICAgICAgIGVudHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSxcblxuXG4gICAgZXhpc3RzOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihrZXkpe1xuICAgICAgLy8gVW5saWtlIGluIHRoZSBDYWNoaW5nRGF0YVN0b3JlLCB3aGVyZSB3ZSBoYXZlIHRvIHBlcmZvcm0gZXZpY3Rpb24gcnVsZXMgYmVmb3JlXG4gICAgICAvLyByZXR1cm5pbmcgdGhlIGFuc3dlciwgaGVyZSB3ZSBjYW4ganVzdCBkZWxlZ2F0ZSBzdHJhaWdodCB0byB0aGUgYmFja2luZyBzdG9yZS5cbiAgICAgIHJldHVybiB0aGlzLl9iYWNraW5nU3RvcmUuZXhpc3RzKGtleSk7XG4gICAgfSksXG5cblxuICAgIGNsZWFyOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMuX2JhY2tpbmdTdG9yZS5jbGVhcigpO1xuICAgIH0pLFxuXG5cbiAgICBfc2lnbmFsRXhwaXJ5U29vbjogZnVuY3Rpb24oa2V5LCBzZXF1ZW5jZSkge1xuICAgICAgXy5kZWZlcihfLmJpbmQoZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5fc2lnbmFsQ2hhbm5lbC5wdWJsaXNoKHRoaXMsIHtcbiAgICAgICAgICBtVDogXCJleHBpcmVkXCIsXG4gICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgc2VxdWVuY2U6IHNlcXVlbmNlXG4gICAgICAgIH0pO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFNpZ25hbGluZ0RhdGFTdG9yZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4vaW4tbWVtb3J5LWRhdGEtc3RvcmVcIiksXG4gIHJlcXVpcmUoXCIuL2ludGVybmFscy9leHBpcmluZy1lbnRyeVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXJcbikge1xuXG4gIC8qKlxuICAgKiBBIHV0aWxpdHkgXCJjbGFzc1wiIGZvciBjb25maWd1cmF0aW9uLXJlbGF0ZWQgZnVuY3Rpb25hbGl0eS5cbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICB2YXIgQ29uZmlndXJhdGlvbk1hZ2ljID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29uZmlndXJhdGlvbk1hZ2ljLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge31cbiAgfSk7XG5cbiAgXy5leHRlbmQoQ29uZmlndXJhdGlvbk1hZ2ljLCB7XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlc29sdmVkIGNvbmZpZ3VyYXRpb24sIGdpdmVuIG11bHRpcGxlIGNvbmZpZ3VyYXRpb24gZG9jdW1lbnRzIGFuZCBhIHNldCBvZiBzY29wZXMuIFNlZVxuICAgICAqIGBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXJgLlxuICAgICAqL1xuICAgIHJlc29sdmVDb25maWc6IGZ1bmN0aW9uKHNjb3BlcywgY29uZmlnT2JqZWN0cykge1xuICAgICAgdmFyIHIgPSBuZXcgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyKCk7XG4gICAgICBfLmVhY2goY29uZmlnT2JqZWN0cywgZnVuY3Rpb24oYykge1xuICAgICAgICByLmFkZChjKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHIucmVzb2x2ZShzY29wZXMpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENvbmZpZ3VyYXRpb25NYWdpYztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4vY29uZmlnL3Njb3BlZC1jb25maWd1cmF0aW9uLXJlc29sdmVyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIExvZ2dlcixcbiAgT3B0aW9ucyxcbiAgU3RhdGVHdWFyZCxcbiAgUnVudGltZSxcbiAgUHJvY2Vzc0tlZXBBbGl2ZVxuKSB7XG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiQXBwXCIpO1xuXG4gIHZhciBBcHAgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChBcHAucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2d1YXJkID0gbmV3IFN0YXRlR3VhcmQoW1wic3RhcnRpbmdcIiwgXCJzdGFydGVkXCIsIFwic3RvcHBpbmdcIiwgXCJzdG9wcGVkXCJdKTtcbiAgICAgIHRoaXMuX3Jhd0NvbmZpZyA9IG9wdHMuZ2V0T3JFcnJvcihcImNvbmZpZ3VyYXRpb25cIik7XG4gICAgICB0aGlzLl9jb25maWcgPSBPcHRpb25zLmZyb21PYmplY3QodGhpcy5fcmF3Q29uZmlnKTtcblxuICAgICAgLy8gVGhlIGRlZmF1bHQgUnVudGltZSBoYXMgc2Vuc2libGUgZGVmYXVsdHMuXG4gICAgICB0aGlzLl9ydW50aW1lID0gb3B0cy5nZXRPckVsc2VGbihcInJ1bnRpbWVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBuZXcgUnVudGltZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2tlZXBBbGl2ZSA9IG5ldyBQcm9jZXNzS2VlcEFsaXZlKHtcbiAgICAgICAgc2NoZWR1bGVyOiB0aGlzLl9ydW50aW1lLnNjaGVkdWxlcigpXG4gICAgICB9KTtcblxuICAgICAgdmFyIHVwICAgPSBvcHRzLmdldE9yRWxzZShcInVwXCIpLFxuICAgICAgICAgIGRvd24gPSBvcHRzLmdldE9yRWxzZShcImRvd25cIik7XG5cbiAgICAgIGlmICh1cCkge1xuICAgICAgICB0aGlzLnVwID0gUHJvbWlzZS5tZXRob2QoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB1cC5jYWxsKHRoaXMsIHRoaXMuX2NvbmZpZyk7XG4gICAgICAgIH0sIHRoaXMpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGRvd24pIHtcbiAgICAgICAgdGhpcy5kb3duID0gUHJvbWlzZS5tZXRob2QoXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBkb3duLmNhbGwodGhpcywgdGhpcy5fY29uZmlnKTtcbiAgICAgICAgfSwgdGhpcykpO1xuICAgICAgfVxuXG4gICAgfSxcblxuICAgIHN0YXJ0OiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIlN0YXJ0aW5nIEFwcFwiKTtcbiAgICAgIHRoaXMuX2d1YXJkXG4gICAgICAgIC5kZW55KFwic3RhcnRpbmdcIilcbiAgICAgICAgLmFwcGx5KFwic3RhcnRpbmdcIik7XG5cbiAgICAgIHRoaXMuX2tlZXBBbGl2ZS5zdGFydCgpO1xuICAgICAgTG9nLmRlYnVnKFwiQ2FsbGluZyBBcHAjdXAoKVwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMudXAoKVxuICAgICAgICAudGhlbih0aGlzLl9ndWFyZC5hcHBseUFzeW5jRm4oXCJzdGFydGVkXCIpKTtcbiAgICB9KSxcblxuICAgIHN0b3A6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgTG9nLmRlYnVnKFwiU3RvcHBpbmcgQXBwXCIpO1xuICAgICAgdGhpcy5fZ3VhcmRcbiAgICAgICAgLmRlbnkoXCJzdG9wcGluZ1wiKVxuICAgICAgICAuYXBwbHkoXCJzdG9wcGluZ1wiKTtcblxuICAgICAgdGhpcy5fa2VlcEFsaXZlLnN0b3AoKTtcbiAgICAgIExvZy5kZWJ1ZyhcIkNhbGxpbmcgQXBwI2Rvd24oKVwiKTtcblxuICAgICAgcmV0dXJuIHRoaXMuZG93bigpXG4gICAgICAgIC50aGVuKHRoaXMuX2d1YXJkLmFwcGx5QXN5bmNGbihcInN0b3BwZWRcIikpO1xuICAgIH0pLFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcmVxdWVzdGVkIGNvbmZpZ3VyYXRpb24gdmFsdWUsIG9yIHRocm93cyBhbiBlcnJvci5cbiAgICAgKiBAcGFyYW0ga2V5IHRoZSBjb25maWd1cmF0aW9uIGtleSByZXF1ZXN0IGZyb20gdGhlIENvbmZpZ3VyYXRpb24uXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKi9cbiAgICBjb25maWc6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZy5nZXRPckVycm9yKGtleSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFRPRE86IERvYy4gU3ViY2xhc3Mgc2hvdWxkIG92ZXJyaWRlLlxuICAgICAqL1xuICAgIHVwOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHt9KSxcblxuICAgIC8qKlxuICAgICAqIFRPRE86IERvYy4gU3ViY2xhc3Mgc2hvdWxkIG92ZXJyaWRlLlxuICAgICAqL1xuICAgIGRvd246IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge30pXG4gIH0pO1xuXG4gIHJldHVybiBBcHA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3N0YXRlLWd1YXJkXCIpLFxuICByZXF1aXJlKFwiLi4vcnVudGltZVwiKSxcbiAgcmVxdWlyZShcIi4vaW50ZXJuYWwvcHJvY2Vzcy1rZWVwLWFsaXZlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIExvZ2dlcixcbiAgT3B0aW9ucyxcbiAgVVVJRCxcbiAgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIsXG4gIFVuaXRTZXF1ZW5jZXIsXG4gIEluTWVtb3J5RmliZXIsXG4gIE1haWxib3gsXG4gIERpc3BhdGNoZXIsXG4gIFNpZ25hbGluZ0RhdGFTdG9yZSxcbiAgUGVyaW9kaWMsXG4gIENsb2NrU2VxdWVuY2VyLFxuICBTeXN0ZW1DbG9jayxcbiAgUnVudGltZVxuICApIHtcblxuICAvKipcbiAgICogQW4gYEV4Y2hhbmdlYCB2ZW5kcyBtYWlsYm94ZXMuIE1lc3NhZ2VzIHNlbnQgZnJvbSBhIG1haWxib3ggYXJlIG1hbmFnZWQgYnkgdGhlIEV4Y2hhbmdlIHdoaWNoIHZlbmRlZCB0aGUgbWFpbGJveC5cbiAgICogVGhlIEV4Y2hhbmdlIGhhbmRsZXMgdGhlIHdvcmsgb2Y6XG4gICAqXG4gICAqICAgMS4gV3JhcHBpbmcgdGhlIG1lc3NhZ2UgaW4gdGhlIGFwcHJvcHJpYXRlIG1lc3NhZ2UgZW52ZWxvcGUgZm9yIHRoZSB2ZXJiIHVzZWQgKGBzZW5kYCwgYHNlbmRBbmRSZWNlaXZlYCxcbiAgICogICAgICBgcmVwbHlgKVxuICAgKiAgIDIuIFBhaXJpbmcgYSBnaXZlbiBgcmVwbHlgIHdpdGggdGhlIG9yaWdpbmF0aW5nIGBzZW5kQW5kUmVjZWl2ZWAgY2FsbCwgYW5kIGZ1bGZpbGxpbmcgdGhlIGFzc29jaWF0ZWQgcmVzdWx0XG4gICAqICAgICAgcHJvbWlzZS5cbiAgICogICAzLiBIYW5kbGluZyBtZXNzYWdlIHRpbWVvdXRzIGZvciBgc2VuZEFuZFJlY2VpdmVgIGNhbGxzLiBXaGVuIGEgbWVzc2FnZSB0aW1lcyBvdXQsIHRoZSBwcm9taXNlIGFzc29jaWF0ZWQgd2l0aFxuICAgKiAgICAgIHRoZSByZXN1bHQgaXMgY2FuY2VsZWQuXG4gICAqXG4gICAqIFRoZSBhY3R1YWwgd29yayBvZiBzZW5kaW5nIG1lc3NhZ2VzIGlzIGhhbmRsZWQgYnkgYW4gRXhjaGFuZ2UncyB1bmRlcmx5aW5nIGBGaWJlcmAuIFRoZSBkZWZhdWx0IGZpYmVyIGlzXG4gICAqIGFuIGBJbk1lbW9yeUZpYmVyYCwgd2hpY2ggcGVyZm9ybXMgb25seSBsb2NhbCBkaXNwYXRjaC5cbiAgICpcbiAgICogR2VuZXJhbGx5IHNwZWFraW5nLCBtYWlsYm94ZXMgc2hhcmluZyBhbiB1bmRlcmx5aW5nIGZpYmVyIChlaXRoZXIgYnkgYm90aCBiZWluZyBzcGF3bmVkIGZyb20gdGhlIHNhbWUgbWFpbGJveCxcbiAgICogb3IgYmVpbmcgc3Bhd25lZCBieSBleGNoYW5nZXMgc2hhcmluZyB0aGUgc2FtZSBmaWJlcikgY2FuIHNlbmQgbWVzc2FnZXMgdG8gZWFjaCBvdGhlciwgcHJvdmlkZWQgdGhleSBrbm93XG4gICAqIGVhY2ggb3RoZXIncyBhZGRyZXNzZXMuXG4gICAqXG4gICAqL1xuICB2YXIgRXhjaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgTVNHX1NFTkQgICAgICAgICAgICAgPSBFeGNoYW5nZS5NU0dfU0VORCAgICAgICAgICAgICA9IFwic2VuZFwiLFxuICAgICAgTVNHX1NFTkRfQU5EX1JFQ0VJVkUgPSBFeGNoYW5nZS5NU0dfU0VORF9BTkRfUkVDRUlWRSA9IFwic2VuZEFuZFJlY2VpdmVcIixcbiAgICAgIE1TR19SRVBMWSAgICAgICAgICAgID0gRXhjaGFuZ2UuTVNHX1JFUExZICAgICAgICAgICAgPSBcInJlcGx5XCI7XG5cbiAgLy8gNy41IHNlY29uZHMgaXMgcmVhc29uYWJsZSwgeWVzP1xuICB2YXIgREVGQVVMVF9SRVBMWV9USU1FT1VUID0gNzUwMDtcblxuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkV4Y2hhbmdlXCIpO1xuXG5cbiAgXy5leHRlbmQoRXhjaGFuZ2UucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5faWRlbnRpdHkgPSBvcHRzLmdldE9yRWxzZShcImlkZW50aXR5XCIsIFVVSUQudjQoKSk7XG5cbiAgICAgIHRoaXMuX3J1bnRpbWUgPSBvcHRzLmdldE9yRWxzZUZuKFwicnVudGltZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSdW50aW1lKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fbWFpbGJveEZpYmVyRGVsZWdhdGUgPSB7XG4gICAgICAgIHJlY2VpdmVGaWJlck1lc3NhZ2U6IHRoaXMuX3JlY2VpdmVNYWlsYm94RmliZXJNZXNzYWdlLmJpbmQodGhpcylcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX21haWxib3hlcyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgdGhpcy5fZmliZXIgICAgID0gb3B0cy5nZXRPckVsc2VGbihcImZpYmVyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5RmliZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9maWJlci5yZWdpc3RlckVudGl0eSh7XG4gICAgICAgIGlkZW50aXR5OiB0aGlzLl9pZGVudGl0eSxcbiAgICAgICAgZGVsZWdhdGU6IHRoaXNcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9tYWlsYm94RGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMsXG4gICAgICAgIHByZWZpeDogXCJfb25NYnhcIlxuICAgICAgfSk7XG5cbiAgICAgIHZhciB1c2VkRGVmYXVsdENsb2NrID0gZmFsc2U7XG5cbiAgICAgIC8vIEZvciByZXF1ZXN0ZXItcHJvdmlkZWQgcmVxdWVzdElkIHRvIG1lc3NhZ2VJZCBtYXBwaW5nLlxuICAgICAgLy8gVXNlZCBmb3IgY2FuY2VsbGluZyBvdXRzdGFuZGluZyBzZW5kQW5kUmVjZWl2ZSByZXF1ZXN0cy5cbiAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5oYXNoX21hcCgpO1xuXG4gICAgICAvLyBEYXRhIHN0b3JlIGZvciBwZW5kaW5nIHJlcXVlc3RzXG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzID0gbmV3IFNpZ25hbGluZ0RhdGFTdG9yZSh7XG4gICAgICAgIHR0bDogb3B0cy5nZXRPckVsc2UoXCJyZXBseVRpbWVvdXRcIiwgREVGQVVMVF9SRVBMWV9USU1FT1VUKSxcbiAgICAgICAgc2VxdWVuY2VyOiBuZXcgQ2xvY2tTZXF1ZW5jZXIoe1xuICAgICAgICAgIGNsb2NrOiBvcHRzLmdldE9yRWxzZUZuKFwiY2xvY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB1c2VkRGVmYXVsdENsb2NrID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3lzdGVtQ2xvY2soKTtcbiAgICAgICAgICB9KSxcbiAgICAgICAgICAvLyBIYXggLSBTaW5jZSB3ZSB3YW50IHRpbWUgdG8gYmUgYXN5bmMsIGJ1dCBwcm92aWRlIGEgZGVmYXVsdCBzeXN0ZW0gY2xvY2tcbiAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGdldCB0aGUgaW5pdGlhbCBjbG9jayBzZXF1ZW5jZSBzeW5jLCBieSBieXBhc3NpbmcgdGhlIGNsb2NrIGNhbGwuXG4gICAgICAgICAgLy8gSWYgeW91IHByb3ZpZGUgYW4gYXN5bmMgY2xvY2ssIHlvdSBzaG91bGQgZWl0aGVyIHByb3ZpZGUgYW4gaW5pdGlhbCB0aW1lLCBvclxuICAgICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBmaXJzdCBnZXRUaW1lIGhhcyByZXNvbHZlZCBiZWZvcmUgaW5zdGFudGlhdGluZyB0aGUgZXhjaGFuZ2UuXG4gICAgICAgICAgLy8gT1IsIGluIHRoZSBmdXR1cmUsIHdlIGhhdmUgdG8gYWRkIGEgc3RhcnQoKS9zdG9wKCkgdG8gRXhjaGFuZ2UuXG4gICAgICAgICAgaW5pdGlhbFNlcXVlbmNlOiBvcHRzLmdldE9yRWxzZShcImluaXRpYWxTZXF1ZW5jZVwiLCAodXNlZERlZmF1bHRDbG9jayA/ICtuZXcgRGF0ZSgpIDogdW5kZWZpbmVkKSlcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICAvLyBEaXNwYXRjaGVzIHN0b3JlIHNpZ25hbHMgKGUuZy4sIGV4cGlyeSlcbiAgICAgIHRoaXMuX2V4cGlyeURpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih7XG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLFxuICAgICAgICBwcmVmaXg6IFwiX29uU3RvcmVTaWduYWxcIixcbiAgICAgICAgbGlzdGVuOiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnNpZ25hbENoYW5uZWwoKVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX2NvbXBvc2l0ZVNlcSA9IG5ldyBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcih7XG4gICAgICAgIGRlbGVnYXRlOiBuZXcgVW5pdFNlcXVlbmNlcigpLFxuICAgICAgICB0YXJnZXRzOiBbdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0cy5zZXF1ZW5jZXIoKSwgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0cy5zZW50cnlTZXF1ZW5jZXIoKV1cbiAgICAgIH0pXG5cbiAgICAgIC8vIFRoaXMgZ3V5IHRyaWdnZXJzIHBlcmlvZGljIGV4cGlyeSBjaGVja3MgaW4gdGhlIHN0b3JlXG4gICAgICB0aGlzLl9jaGVja0V4cGlyeSA9IG5ldyBQZXJpb2RpYyh7XG4gICAgICAgIHNjaGVkdWxlcjogdGhpcy5fcnVudGltZS5zY2hlZHVsZXIoKSxcbiAgICAgICAgdGFzazogXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9jb21wb3NpdGVTZXEuYWR2YW5jZSgpO1xuICAgICAgICB9LCB0aGlzKSxcbiAgICAgICAgaW50ZXJ2YWw6IG9wdHMuZ2V0T3JFbHNlKFwiZXhwaXJ5SW50ZXJ2YWxcIiwgMTAwMClcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9jaGVja0V4cGlyeS5zdGFydCgpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgLy8gVE9ETzogQ2FuY2VsIG91dHN0YW5kaW5nIHJlcXVlc3RzXG5cbiAgICAgIHRoaXMuX2V4cGlyeURpc3BhdGNoZXIuZGlzcG9zZSgpO1xuXG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLmNsZWFyKCk7XG5cbiAgICAgIC8vIFRPRE86IERpc3Bvc2UgYWxsIHRoZSB0aGluZ3NcbiAgICAgIHRoaXMuX2NoZWNrRXhwaXJ5LmRpc3Bvc2UoKTtcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiBCdWlsZHMgYSBNYWlsYm94IGZvciB0aGUgcHJvdmlkZWQgYHJlcXVlc3RlcklkZW50aXR5YC4gVGhlXG4gICAgICogYFJlcXVlc3RlcklkZW50aXR5YCBtdXN0IG5ldmVyIGhhdmUgYmVlbiB1c2VkIGZvciByZXF1ZXN0aW5nXG4gICAgICogYSBtYWlsYm94IHByZXZpb3VzbHkuXG4gICAgICpcbiAgICAgKiBXZSBhdHRlbXB0IHRvIHZhbGlkYXRlIHVuaXF1ZSBtYWlsYm94IG5hbWVzLCBidXQgYmVjYXVzZSBtYWlsYm94IG5hbWVzXG4gICAgICogYXJlIGdsb2JhbCBhbmQgdGhlcmUgaXMgbm8gY2hlY2tpbmcgYmV0d2VlbiBmaWJlcnMsIGl0J3Mgb25seSBhIGJlc3QtZWZmb3J0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlcXVlc3RlcklkZW50aXR5XG4gICAgICogQHJldHVybnMge01haWxib3h9XG4gICAgICovXG4gICAgbWFpbGJveDogZnVuY3Rpb24ocmVxdWVzdGVySWRlbnRpdHkpIHtcbiAgICAgIHRoaXMuX2Fzc2VydFVuaXF1ZU93bmVyKHJlcXVlc3RlcklkZW50aXR5KTtcblxuICAgICAgdmFyIG1haWxib3ggPSBuZXcgTWFpbGJveCh7XG4gICAgICAgIGV4Y2hhbmdlOiAgICAgIHRoaXMsXG4gICAgICAgIG93bmVySWRlbnRpdHk6IHJlcXVlc3RlcklkZW50aXR5XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fbWFpbGJveGVzID0gTS5hc3NvYyh0aGlzLl9tYWlsYm94ZXMsIHJlcXVlc3RlcklkZW50aXR5LCBtYWlsYm94KTtcblxuICAgICAgdGhpcy5fZmliZXIucmVnaXN0ZXJFbnRpdHkoe1xuICAgICAgICBpZGVudGl0eTogcmVxdWVzdGVySWRlbnRpdHksXG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLl9tYWlsYm94RmliZXJEZWxlZ2F0ZVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBtYWlsYm94O1xuICAgIH0sXG5cblxuICAgIHNlbmQ6IGZ1bmN0aW9uKGVudikge1xuICAgICAgZW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudik7XG5cbiAgICAgIHJldHVybiB0aGlzLl9maWJlci5zZW5kKHtcbiAgICAgICAgZnJvbTogIGVudi5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgdG86ICAgIGVudi5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgIGJvZHk6ICBlbnYuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgIG1UOiAgICBNU0dfU0VORCxcbiAgICAgICAgbXNnSWQ6IFVVSUQudjQoKVxuICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgcmVwbHk6IGZ1bmN0aW9uKGVudikge1xuICAgICAgZW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudik7XG4gICAgICByZXR1cm4gdGhpcy5fZmliZXIuc2VuZCh7XG4gICAgICAgIGZyb206ICAgZW52LmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICB0bzogICAgIGVudi5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgIGJvZHk6ICAgZW52LmdldE9yRXJyb3IoXCJib2R5XCIpLFxuICAgICAgICBtVDogICAgIE1TR19SRVBMWSxcbiAgICAgICAgbXNnSWQ6ICBVVUlELnY0KCksXG4gICAgICAgIHJNc2dJZDogZW52LmdldE9yRXJyb3IoXCJyTXNnSWRcIilcbiAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIHNlbmRBbmRSZWNlaXZlOiBmdW5jdGlvbihlbnYsIG9wdHMpIHtcbiAgICAgIGVudiAgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KTtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHZhciBtc2dJZCA9IFVVSUQudjQoKSxcbiAgICAgICAgICByZXFJZCAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInJlcUlkXCIpLFxuICAgICAgICAgIGRlZmVycmVkID0gZGVmZXIoKSxcbiAgICAgICAgICBmaWJFbnYgICA9IHtcbiAgICAgICAgICAgIGZyb206ICBlbnYuZ2V0T3JFcnJvcihcImZyb21cIiksXG4gICAgICAgICAgICB0bzogICAgZW52LmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgICAgIGJvZHk6ICBlbnYuZ2V0T3JFcnJvcihcImJvZHlcIiksXG4gICAgICAgICAgICBtVDogICAgTVNHX1NFTkRfQU5EX1JFQ0VJVkUsXG4gICAgICAgICAgICBtc2dJZDogbXNnSWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcSAgICAgID0ge1xuICAgICAgICAgICAgcmVxSWQ6ICAgIHJlcUlkLFxuICAgICAgICAgICAgZGVmZXJyZWQ6IGRlZmVycmVkLFxuICAgICAgICAgICAgZmliRW52OiAgIGZpYkVudlxuICAgICAgICAgIH07XG5cbiAgICAgIHRoaXMuX3JlcVRvTXNnID0gTS5hc3NvYyh0aGlzLl9yZXFUb01zZywgcmVxSWQsIG1zZ0lkKTtcblxuICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgLl9vdXRzdGFuZGluZ1JlcXVlc3RzXG4gICAgICAgIC5wdXQobXNnSWQsIHJlcSwge3R0bDogb3B0cy5nZXRPckVsc2UoXCJyZXBseVRpbWVvdXRcIil9KVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZmliZXIuc2VuZChmaWJFbnYpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gcmVxLmRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjYW5jZWxTZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVxSWQpIHtcbiAgICAgIHZhciBtc2dJZCA9IE0uZ2V0KHRoaXMuX3JlcVRvTXNnLCByZXFJZCk7XG5cbiAgICAgIGlmIChtc2dJZCkge1xuICAgICAgICBMb2cuZGVidWcoXCJDYW5jZWxpbmcgcmVxdWVzdFwiLCByZXFJZCwgXCJ3aXRoIG1zZ0lkXCIsIG1zZ0lkKTtcbiAgICAgICAgdGhpcy5fcmVxVG9Nc2cgPSBNLmRpc3NvYyh0aGlzLl9yZXFUb01zZywgcmVxSWQpO1xuXG4gICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnJlbW92ZShtc2dJZCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXEpIHtcbiAgICAgICAgICAgIGlmIChyZXEpIHtcbiAgICAgICAgICAgICAgcmVxLmRlZmVycmVkLnJlamVjdChuZXcgUHJvbWlzZS5DYW5jZWxsYXRpb25FcnJvcigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgTG9nLndhcm4oXCJUcmllZCB0byBjYW5jZWwgcmVxdWVzdCwgYnV0IG5vIG91c3RhbmRpbmcgcmVxdWVzdCB3aXRoIHRoYXQgSUQgZm91bmQ7XCIsIHJlcUlkKTtcbiAgICAgIH1cbiAgICB9KSxcblxuXG4gICAgX2Fzc2VydFVuaXF1ZU93bmVyOiBmdW5jdGlvbihpZGVudGl0eSkge1xuICAgICAgaWYgKE0uZ2V0KHRoaXMuX21haWxib3hlcywgaWRlbnRpdHkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1haWxib3ggcmVnaXN0cmF0aW9uIHJlcXVpcmVzIGEgdW5pcXVlIGlkZW50aXR5XCIpO1xuICAgICAgfVxuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEZpYmVyIGRlbGVnYXRlIHByb3RvY29sIG1ldGhvZCBmb3IgYSBtZXNzYWdlIGJvdW5kIGZvciBhIE1haWxib3ggb3duZWQgYnlcbiAgICAgKiB0aGlzIGV4Y2hhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGVudlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlY2VpdmVNYWlsYm94RmliZXJNZXNzYWdlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHRoaXMuX21haWxib3hEaXNwYXRjaGVyLmRpc3BhdGNoKGVudik7XG4gICAgfSxcblxuXG4gICAgX29uTWJ4U2VuZDogZnVuY3Rpb24oZW52KSB7XG4gICAgICB2YXIgb0VudiAgICAgPSBPcHRpb25zLmZyb21PYmplY3QoZW52KSxcbiAgICAgICAgICBpZGVudGl0eSA9IG9FbnYuZ2V0T3JFbHNlKFwidG9cIiksXG4gICAgICAgICAgYm9keSAgICAgPSBvRW52LmdldE9yRWxzZShcImJvZHlcIik7XG5cbiAgICAgIGlmICghKGlkZW50aXR5IHx8IGJvZHkpKSB7XG4gICAgICAgIExvZy5pbmZvKFwiRXhjaGFuZ2UgcmVjZWl2ZWQgYSBtZXNzYWdlIHdpdGggbWlzc2luZyBlbnZlbG9wZSBpbmZvcm1hdGlvblwiLCBlbnYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBtYm94ID0gTS5nZXQodGhpcy5fbWFpbGJveGVzLCBpZGVudGl0eSk7XG4gICAgICBpZiAobWJveCkge1xuICAgICAgICBtYm94Ll9yZWNlaXZlT25lU2hvdChlbnYpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBUT0RPOiBTaG91bGQgdGhpcyBnbyBhbG9uZyB0aGUgbWFpbGJveCBpbmdyZXNzIGNoYW5uZWw/XG4gICAgLy8gT3Igc2hvdWxkIGl0IGJlIGNiLWJhc2VkP1xuICAgIF9vbk1ieFNlbmRBbmRSZWNlaXZlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgIHZhciBvRW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudiksXG4gICAgICAgICAgaWRlbnRpdHkgPSBvRW52LmdldE9yRWxzZShcInRvXCIpLFxuICAgICAgICAgIGJvZHkgPSBvRW52LmdldE9yRWxzZShcImJvZHlcIik7XG5cbiAgICAgIGlmICghKGlkZW50aXR5IHx8IGJvZHkpKSB7XG4gICAgICAgIExvZy5pbmZvKFwiRXhjaGFuZ2UgcmVjZWl2ZWQgYSBtZXNzYWdlIHdpdGggbWlzc2luZyBlbnZlbG9wZSBpbmZvcm1hdGlvblwiLCBlbnYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBtYm94ID0gTS5nZXQodGhpcy5fbWFpbGJveGVzLCBpZGVudGl0eSk7XG4gICAgICBpZiAobWJveCkge1xuICAgICAgICBtYm94Ll9yZWNlaXZlUmVxdWVzdFJlcGx5KGVudik7XG4gICAgICB9XG4gICAgfSxcblxuXG4gICAgX29uTWJ4UmVwbHk6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdmFyIG9FbnYgICAgID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudiksXG4gICAgICAgICAgck1zZ0lkICAgPSBvRW52LmdldE9yRWxzZShcInJNc2dJZFwiKTtcblxuXG5cbiAgICAgIC8vIERvbid0IGRpc3BhdGNoIHZldHRlZCByZXBsaWVzLiBKdXN0IGZ1bGZpbGwgdGhlIHByb21pc2VcbiAgICAgIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0cy5yZW1vdmUock1zZ0lkKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVxdWVzdCkge1xuICAgICAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXFUb01zZyA9IE0uZGlzc29jKHRoaXMuX3JlcVRvTXNnLCByZXF1ZXN0LnJlcUlkKTtcbiAgICAgICAgICAgIHJlcXVlc3QuZGVmZXJyZWQucmVzb2x2ZShlbnYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogRmlyZWQgd2hlbiBhIHJlcXVlc3QgaW4gdGhlIG91dHN0YW5kaW5nIHJlcXVlc3RzIHN0b3JlIGlzIHBhc3QgZHVlLlxuICAgICAqL1xuICAgIF9vblN0b3JlU2lnbmFsRXhwaXJlZDogZnVuY3Rpb24oc2lnKSB7XG4gICAgICBMb2cuZGVidWcoXCJFeHBpcmVkIGVudHJ5IGluIHN0b3JlXCIsIHNpZyk7XG4gICAgICBQcm9taXNlXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RzLnJlbW92ZShzaWcua2V5KTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVxdWVzdCkge1xuICAgICAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZXFUb01zZyA9IE0uZGlzc29jKHRoaXMuX3JlcVRvTXNnLCByZXF1ZXN0LnJlcUlkKTtcbiAgICAgICAgICAgIHJlcXVlc3QuZGVmZXJyZWQucmVqZWN0KG5ldyBQcm9taXNlLlRpbWVvdXRFcnJvcigpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cblxuICAgIC8qKlxuICAgICAqIEZpYmVyIGRlbGVnYXRlIHByb3RvY29sIG1ldGhvZCBmb3IgYSBtZXNzYWdlIGJvdW5kIGZvciB0aGlzIEV4Y2hhbmdlIGRpcmVjdGx5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGVudlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcmVjZWl2ZUZpYmVyTWVzc2FnZTogZnVuY3Rpb24oZW52KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG4gICAgfVxuICB9KTtcblxuXG4gIHZhciBkZWZlciA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHJlcywgcmVqO1xuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24oKSB7XG4gICAgICByZXMgPSBhcmd1bWVudHNbMF07XG4gICAgICByZWogPSBhcmd1bWVudHNbMV07XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcHJvbWlzZTogcCxcbiAgICAgIHJlc29sdmU6IHJlcyxcbiAgICAgIHJlamVjdDogcmVqXG4gICAgfTtcbiAgfTtcblxuICByZXR1cm4gRXhjaGFuZ2U7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zZXF1ZW5jZXIvZGVsZWdhdGluZy1mb3J3YXJkaW5nLXNlcXVlbmNlclwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc2VxdWVuY2VyL3VuaXQtc2VxdWVuY2VyXCIpLFxuICByZXF1aXJlKFwiLi9maWJlci9pbi1tZW1vcnktZmliZXJcIiksXG4gIHJlcXVpcmUoXCIuL2ludGVybmFscy9tYWlsYm94XCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9kaXNwYXRjaGVyXCIpLFxuICByZXF1aXJlKFwiLi4vc3RvcmFnZS9zaWduYWxpbmctZGF0YS1zdG9yZVwiKSxcbiAgcmVxdWlyZShcIi4uL3V0aWwvcGVyaW9kaWNcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL3NlcXVlbmNlci9jbG9jay1zZXF1ZW5jZXJcIiksXG4gIHJlcXVpcmUoXCIuLi90aW1lL2Nsb2NrL3N5c3RlbS1jbG9ja1wiKSxcbiAgcmVxdWlyZShcIi4uL3J1bnRpbWVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgVVVJRCxcbiAgU3RhdGVHdWFyZCxcbiAgTG9nZ2VyLFxuICBEaXNwYXRjaGVyXG4pIHtcblxuICAvKipcbiAgICogQSBDb3VyaWVyIG1ha2VzIGl0IGVhc3kgZm9yIGEgbWFpYm94IG93bmVyIHRvIGRlYWwgd2l0aCBzZW5kaW5nIGFuZCByZWNlaXZpbmcgbWVzc2FnZXMuIEl0IGhhcyBhIHNsaWdodGx5IG1vcmVcbiAgICogbmF0dXJhbCBpbnRlcmZhY2UgZm9yIHNlbmRpbmcgbWVzc2FnZXMgKGBzZW5kKHRvLCBtc2cpYCwgYHNlbmRBbmRSZWNlaXZlKHRvLCBtc2csIG9wdHMpYCksIGFuZCBhdXRvbWF0aWNhbGx5XG4gICAqIGRpc3BhdGNoZXMgaW5jb21pbmcgbWVzc2FnZXMgdG8gZGVsZWdhdGUgbWV0aG9kcy5cbiAgICpcbiAgICogQ29tbW9uIHVzYWdlIGlzIGZvciBhIG1haWxib3ggb3duZXIgKGxldCdzIGNhbGwgaXQgXCJvd25lciBBXCIpIHRvIGNyZWF0ZSBhIG5ldyBDb3VyaWVyIChcImNvdXJpZXIgQVwiKSwgc2V0dGluZyB0aGVcbiAgICogYGRlbGVnYXRlYCB0byBpdHNlbGYsIGFuZCB0aGUgYG1haWxib3hgIHRvIHRoZSBtYWlsYm94IChcIm1haWxib3ggQVwiKSBpdCBvd25zLiBXaGVuIGEgcmVtb3RlIG1haWxib3gnc1xuICAgKiAoXCJtYWlsYm94IEJcIikgY291cmllciAoXCJjb3VyaWVyIEJcIikgcGVyZm9ybXMgYSBgY291cmllci5zZW5kKFwiQVwiLCB7IG1UOiBcImZvb1wiIH0pYCwgaXQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5XG4gICAqIGRpc3BhdGNoZWQgdG8gXCJvd25lciBBXCIncyBgb25Nc2dGb29gIG1ldGhvZCwgaWYgcHJlc2VudC5cbiAgICpcbiAgICogSWYgXCJjb3VyaWVyIEJcIiBwZXJmb3JtcyBhIGBjb3VyaWVyLnNlbmRBbmRSZWNlaXZlKFwiQVwiLCB7IG1UOiBcImJhclwiIH0pYCwgaXQgd2lsbCBnZXQgc2V0IHRvIFwib3duZXIgQVwiJ3NcbiAgICogYG9uUmVxQmFyYCBtZXRob2QsIGFuZCB0aGUgcmVzdWx0aW5nIHByb21pc2UncyBmdWxmaWxsZWQgdmFsdWUgd2lsbCBiZSBkaXNwYXRjaGVkIGJhY2sgdG8gXCJjb3VyaWVyIEJcIiBhcyB0aGVcbiAgICogZnVsZmlsbGVkIHJlc3VsdCBvZiB0aGUgb3JpZ2luYXRpbmcgYHNlbmRBbmRSZWNlaXZlYC5cbiAgICpcbiAgICogQSBgc2VuZGAgb3IgYHNlbmRBbmRSZWNlaXZlYCBjYWxsIGluaXRpYXRlZCBvbiBDb3VyaWVyQiB3aWxsIHJlc3VsdCBpbiBhIG1ldGhvZCBjYWxsIG9uIERlbGVnYXRlQSwgYW5kIHZpY2UgdmVyc2EuXG4gICAqXG4gICAqICBEZWxlZ2F0ZUEgPC0+IENvdXJpZXJBIDwtPiBNYWlsYm94QSA8LT4gRXhjaGFuZ2VBXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBeXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGaWJlclxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXhjaGFuZ2VCIDwtPiBNYWlsYm94QiA8LT4gQ291cmllckIgPC0+IERlbGVnYXRlQlxuICAgKlxuICAgKlxuICAgKlxuICAgKi9cbiAgdmFyIENvdXJpZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICB2YXIgTVNHX1JFUExZID0gQ291cmllci5NU0dfUkVQTFkgPSBcImNSZXBseVwiO1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiQ291cmllclwiKTtcblxuICBfLmV4dGVuZChDb3VyaWVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX2lkICAgICAgICAgPSBVVUlELnY0KCk7XG4gICAgICB0aGlzLl9kZWxlZ2F0ZSAgID0gb3B0cy5nZXRPckVycm9yKFwiZGVsZWdhdGVcIik7XG4gICAgICB0aGlzLl9tYWlsYm94ICAgID0gb3B0cy5nZXRPckVycm9yKFwibWFpbGJveFwiKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcIl9vbk9uZVNob3RNZXNzYWdlXCIsIFwiX29uUmVxdWVzdFJlcGx5TWVzc2FnZVwiLCBcIl9kZWZhdWx0Q29udGV4dERlbGVnYXRlXCIpO1xuXG4gICAgICB0aGlzLl9jb250ZXh0RGVsZWdhdGUgPSBvcHRzLmdldE9yRWxzZShcImNvbnRleHREZWxlZ2F0ZVwiLCB0aGlzLl9kZWZhdWx0Q29udGV4dERlbGVnYXRlKTtcblxuICAgICAgdGhpcy5fb25lU2hvdERpc3BhdGNoZXIgPSBuZXcgRGlzcGF0Y2hlcih7XG4gICAgICAgIGRlbGVnYXRlOiB0aGlzLl9kZWxlZ2F0ZSxcbiAgICAgICAgcHJlZml4OiBvcHRzLmdldE9yRWxzZShcIm9uZVNob3RQcmVmaXhcIiwgXCJvbk1zZ1wiKSxcbiAgICAgICAgY29udGV4dERlbGVnYXRlOiB0aGlzLl9jb250ZXh0RGVsZWdhdGVcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlEaXNwYXRjaGVyID0gbmV3IERpc3BhdGNoZXIoe1xuICAgICAgICBkZWxlZ2F0ZTogdGhpcy5fZGVsZWdhdGUsXG4gICAgICAgIHByZWZpeDogb3B0cy5nZXRPckVsc2UoXCJyZXF1ZXN0UmVwbHlQcmVmaXhcIiwgXCJvblJlcVwiKSxcbiAgICAgICAgY29udGV4dERlbGVnYXRlOiB0aGlzLl9jb250ZXh0RGVsZWdhdGVcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zdWJzID0gTS52ZWN0b3IoXG4gICAgICAgIHRoaXMuX21haWxib3gub25lU2hvdENoYW5uZWwoKS5zdWJzY3JpYmUodGhpcy5fb25PbmVTaG90TWVzc2FnZSksXG4gICAgICAgIHRoaXMuX21haWxib3gucmVxdWVzdFJlcGx5Q2hhbm5lbCgpLnN1YnNjcmliZSh0aGlzLl9vblJlcXVlc3RSZXBseU1lc3NhZ2UpXG4gICAgICApO1xuICAgIH0sXG5cblxuICAgIGlkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pZDtcbiAgICB9LFxuXG4gICAgc2VuZDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24odG8sIG1zZykge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIHJldHVybiB0aGlzLl9tYWlsYm94LnNlbmQoe1xuICAgICAgICB0bzogdG8sXG4gICAgICAgIGJvZHk6IG1zZ1xuICAgICAgfSk7XG4gICAgfSksXG5cbiAgICBzZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24odG8sIG1zZywgb3B0cykge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIHJldHVybiB0aGlzLl9tYWlsYm94XG4gICAgICAgIC5zZW5kQW5kUmVjZWl2ZSh7XG4gICAgICAgICAgdG86IHRvLFxuICAgICAgICAgIGJvZHk6IG1zZ1xuICAgICAgICB9LCBvcHRzKVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcblxuICAgICAgICAgIGlmIChyZXMuYm9keSAmJiByZXMuYm9keS5tVCA9PT0gTVNHX1JFUExZICYmIHJlcy5ib2R5LmJvZHkpIHtcbiAgICAgICAgICAgIC8vIFVud3JhcCB0aGUgcmVtb3RlIG1lc3NhZ2VcbiAgICAgICAgICAgIGlmIChyZXMuYm9keS5ib2R5LmVycikge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLmJvZHkuYm9keS5lcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcy5ib2R5LmJvZHkucmVzO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTb21lb25lIGlzIG1pc2JlaGF2aW5nXG4gICAgICAgICAgICBMb2cud2FybihcIlJlY2VpdmVkIHNlbmRBbmRSZWNlaXZlIHJlcGx5LCBidXQgaXQgaXNuJ3QgQ291cmllci1jb21wYXRpYmxlXCIsIHRoaXMuX21haWxib3gub3duZXJJZGVudGl0eSgpLCByZXMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSksXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cblxuICAgICAgTS5lYWNoKHRoaXMuX3N1YnMsIGZ1bmN0aW9uKHN1Yikge1xuICAgICAgICBzdWIuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3N1YnMgICAgID0gbnVsbDtcbiAgICAgIHRoaXMuX21haWxib3ggID0gbnVsbDtcbiAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG5cbiAgICBfZGVmYXVsdENvbnRleHREZWxlZ2F0ZTogZnVuY3Rpb24obVR5cGVkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtYWlsYm94OiB0aGlzLl9tYWlsYm94XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBfb25PbmVTaG90TWVzc2FnZTogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLl9vbmVTaG90RGlzcGF0Y2hlci5kaXNwYXRjaChtc2cuYm9keSwgbXNnKTtcbiAgICB9LFxuXG5cbiAgICBfb25SZXF1ZXN0UmVwbHlNZXNzYWdlOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseURpc3BhdGNoZXJcbiAgICAgICAgLmRpc3BhdGNoQXN5bmMobXNnLmJvZHksIG1zZylcbiAgICAgICAgLmJpbmQoe1xuICAgICAgICAgIG1ib3g6IHRoaXMuX21haWxib3gsXG4gICAgICAgICAgZXJyOiBudWxsLFxuICAgICAgICAgIHJlc3VsdDogbnVsbFxuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgIHRoaXMucmVzdWx0ID0gcmVzdWx0O1xuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIHRoaXMuZXJyID0gZXJyLm1lc3NhZ2U7XG4gICAgICAgIH0pXG4gICAgICAgIC5sYXN0bHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5tYm94LnJlcGx5KG1zZy5tc2dJZCwge1xuICAgICAgICAgICAgdG86IG1zZy5mcm9tLFxuICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICBtVDogTVNHX1JFUExZLFxuICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgZXJyOiB0aGlzLmVycixcbiAgICAgICAgICAgICAgICByZXM6IHRoaXMucmVzdWx0XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ291cmllcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwibW9yaVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvc3RhdGUtZ3VhcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9kaXNwYXRjaGVyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIFV0aWxpdHkgZm9yIGdlbmVyYXRpbmcgVjQgVVVJRHMuIEV4cG9ydHMgYSBzaW5nbGV0b24uXG4gKi9cblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICB2YXIgVVVJRCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFVVSUQucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcbiAgICAvLyBTZWU6IGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVW5pdmVyc2FsbHlfdW5pcXVlX2lkZW50aWZpZXIjVmVyc2lvbl80Xy4yOHJhbmRvbS4yOVxuICAgIHY0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwO1xuICAgICAgICAvLyAweDMgICAgICAgPSAwYjAwMDExXG4gICAgICAgIC8vIDB4OCAgICAgICA9IDBiMDEwMDBcbiAgICAgICAgLy8gMHgzIHwgMHg4ID0gMGIwMTAxMVxuICAgICAgICAvLyByICYgMHgzICAgPSAoMGIwMDAwMCB8IDBiMDAwMDEgfCAwYjAwMDEwIHwgMGIwMDAxMSlcbiAgICAgICAgdmFyIHYgPSAoYyA9PSAneCcgPyByIDogKHIgJiAweDMgfCAweDgpKTtcbiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gbmV3IFVVSUQoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogQSByZWdpc3RyeSBmb3IgbW9kdWxlcy4gQWxsb3dzIGFuIE5QTSBwYWNrYWdlIHRvIGV4cG9zZSBpbnRlcm5hbCBtb2R1bGVzIHdpdGhvdXQgbmVlZGluZyB0byBrbm93IHRoZSBleHBsaWNpdFxuICAgKiBmaWxlIHBhdGgsIHdoaWNoIG1heSBjaGFuZ2UgZnJvbSByZWxlYXNlIHRvIHJlbGVhc2UuIEVhY2ggbW9kdWxlIG1heSBoYXZlIG9uZSBvciBtb3JlIGFsaWFzZXMgd2hpY2ggY2FuIGJlXG4gICAqIHVzZWQgdG8gcmVxdWVzdCBpdCBsYXRlci5cbiAgICpcbiAgICovXG4gIHZhciBDb21wb25lbnRSZWdpc3RyeSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENvbXBvbmVudFJlZ2lzdHJ5LnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbW9kdWxlcyA9IHt9O1xuICAgIH0sXG5cblxuICAgIHJlZ2lzdGVyOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdmFyIGFsaWFzZXMgICA9IG9wdHMuZ2V0T3JFcnJvcihcImFzXCIpLFxuICAgICAgICAgIG1vZE9iamVjdCA9IG9wdHMuZ2V0T3JFcnJvcihcIm1vZHVsZVwiKTtcblxuICAgICAgaWYgKCFfLmlzQXJyYXkoYWxpYXNlcykpIHtcbiAgICAgICAgYWxpYXNlcyA9IFsgYWxpYXNlcyBdO1xuICAgICAgfVxuXG4gICAgICBfLmVhY2goYWxpYXNlcywgXy5iaW5kKGZ1bmN0aW9uKGFsaWFzKSB7XG4gICAgICAgIHRoaXMuX21vZHVsZXNbYWxpYXNdID0gbW9kT2JqZWN0O1xuICAgICAgfSwgdGhpcykpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgc2VsZlJlZ2lzdGVyOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICByZXR1cm4gdGhpcy5yZWdpc3Rlcih7XG4gICAgICAgIGFzOiBvcHRzLmdldE9yRXJyb3IoXCJhc1wiKSxcbiAgICAgICAgbW9kdWxlOiBDb21wb25lbnRSZWdpc3RyeVxuICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgcmVnaXN0ZXJNYW55OiBmdW5jdGlvbihhbGlhc2VzQXJ5KSB7XG4gICAgICBfLmVhY2goYWxpYXNlc0FyeSwgXy5iaW5kKGZ1bmN0aW9uKGFsaWFzKSB7XG4gICAgICAgIHRoaXMucmVnaXN0ZXIoYWxpYXMpO1xuICAgICAgfSwgdGhpcykpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudDogZnVuY3Rpb24oYWxpYXMpIHtcbiAgICAgIHZhciBtID0gdGhpcy5fbW9kdWxlc1thbGlhc107XG4gICAgICBpZiAoIW0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbGlhcyBwcm92aWRlZCAobm8gc3VjaCBtb2R1bGUpOiBgXCIrYWxpYXMrXCInXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG07XG4gICAgfVxuXG4gIH0pO1xuXG4gIENvbXBvbmVudFJlZ2lzdHJ5LnByb3RvdHlwZS5jID0gQ29tcG9uZW50UmVnaXN0cnkucHJvdG90eXBlLmNvbXBvbmVudDtcblxuICByZXR1cm4gQ29tcG9uZW50UmVnaXN0cnk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi9jb3JlL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCJcInVzZSBzdHJpY3RcIjtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi93ZWItc2NoZWR1bGVyXCIpO1xuIiwiKGZ1bmN0aW9uKCl7Ly8gICAgIFVuZGVyc2NvcmUuanMgMS43LjBcbi8vICAgICBodHRwOi8vdW5kZXJzY29yZWpzLm9yZ1xuLy8gICAgIChjKSAyMDA5LTIwMTQgSmVyZW15IEFzaGtlbmFzLCBEb2N1bWVudENsb3VkIGFuZCBJbnZlc3RpZ2F0aXZlIFJlcG9ydGVycyAmIEVkaXRvcnNcbi8vICAgICBVbmRlcnNjb3JlIG1heSBiZSBmcmVlbHkgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuXG4oZnVuY3Rpb24oKSB7XG5cbiAgLy8gQmFzZWxpbmUgc2V0dXBcbiAgLy8gLS0tLS0tLS0tLS0tLS1cblxuICAvLyBFc3RhYmxpc2ggdGhlIHJvb3Qgb2JqZWN0LCBgd2luZG93YCBpbiB0aGUgYnJvd3Nlciwgb3IgYGV4cG9ydHNgIG9uIHRoZSBzZXJ2ZXIuXG4gIHZhciByb290ID0gdGhpcztcblxuICAvLyBTYXZlIHRoZSBwcmV2aW91cyB2YWx1ZSBvZiB0aGUgYF9gIHZhcmlhYmxlLlxuICB2YXIgcHJldmlvdXNVbmRlcnNjb3JlID0gcm9vdC5fO1xuXG4gIC8vIFNhdmUgYnl0ZXMgaW4gdGhlIG1pbmlmaWVkIChidXQgbm90IGd6aXBwZWQpIHZlcnNpb246XG4gIHZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlLCBPYmpQcm90byA9IE9iamVjdC5wcm90b3R5cGUsIEZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZTtcblxuICAvLyBDcmVhdGUgcXVpY2sgcmVmZXJlbmNlIHZhcmlhYmxlcyBmb3Igc3BlZWQgYWNjZXNzIHRvIGNvcmUgcHJvdG90eXBlcy5cbiAgdmFyXG4gICAgcHVzaCAgICAgICAgICAgICA9IEFycmF5UHJvdG8ucHVzaCxcbiAgICBzbGljZSAgICAgICAgICAgID0gQXJyYXlQcm90by5zbGljZSxcbiAgICBjb25jYXQgICAgICAgICAgID0gQXJyYXlQcm90by5jb25jYXQsXG4gICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLFxuICAgIGhhc093blByb3BlcnR5ICAgPSBPYmpQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuICAvLyBBbGwgKipFQ01BU2NyaXB0IDUqKiBuYXRpdmUgZnVuY3Rpb24gaW1wbGVtZW50YXRpb25zIHRoYXQgd2UgaG9wZSB0byB1c2VcbiAgLy8gYXJlIGRlY2xhcmVkIGhlcmUuXG4gIHZhclxuICAgIG5hdGl2ZUlzQXJyYXkgICAgICA9IEFycmF5LmlzQXJyYXksXG4gICAgbmF0aXZlS2V5cyAgICAgICAgID0gT2JqZWN0LmtleXMsXG4gICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQ7XG5cbiAgLy8gQ3JlYXRlIGEgc2FmZSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciB1c2UgYmVsb3cuXG4gIHZhciBfID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIF8pIHJldHVybiBvYmo7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIF8pKSByZXR1cm4gbmV3IF8ob2JqKTtcbiAgICB0aGlzLl93cmFwcGVkID0gb2JqO1xuICB9O1xuXG4gIC8vIEV4cG9ydCB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yICoqTm9kZS5qcyoqLCB3aXRoXG4gIC8vIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvciB0aGUgb2xkIGByZXF1aXJlKClgIEFQSS4gSWYgd2UncmUgaW5cbiAgLy8gdGhlIGJyb3dzZXIsIGFkZCBgX2AgYXMgYSBnbG9iYWwgb2JqZWN0LlxuICBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBfO1xuICAgIH1cbiAgICBleHBvcnRzLl8gPSBfO1xuICB9IGVsc2Uge1xuICAgIHJvb3QuXyA9IF87XG4gIH1cblxuICAvLyBDdXJyZW50IHZlcnNpb24uXG4gIF8uVkVSU0lPTiA9ICcxLjcuMCc7XG5cbiAgLy8gSW50ZXJuYWwgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIGVmZmljaWVudCAoZm9yIGN1cnJlbnQgZW5naW5lcykgdmVyc2lvblxuICAvLyBvZiB0aGUgcGFzc2VkLWluIGNhbGxiYWNrLCB0byBiZSByZXBlYXRlZGx5IGFwcGxpZWQgaW4gb3RoZXIgVW5kZXJzY29yZVxuICAvLyBmdW5jdGlvbnMuXG4gIHZhciBjcmVhdGVDYWxsYmFjayA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQsIGFyZ0NvdW50KSB7XG4gICAgaWYgKGNvbnRleHQgPT09IHZvaWQgMCkgcmV0dXJuIGZ1bmM7XG4gICAgc3dpdGNoIChhcmdDb3VudCA9PSBudWxsID8gMyA6IGFyZ0NvdW50KSB7XG4gICAgICBjYXNlIDE6IHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIHZhbHVlKTtcbiAgICAgIH07XG4gICAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbih2YWx1ZSwgb3RoZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSwgb3RoZXIpO1xuICAgICAgfTtcbiAgICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICB9O1xuICAgICAgY2FzZSA0OiByZXR1cm4gZnVuY3Rpb24oYWNjdW11bGF0b3IsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEEgbW9zdGx5LWludGVybmFsIGZ1bmN0aW9uIHRvIGdlbmVyYXRlIGNhbGxiYWNrcyB0aGF0IGNhbiBiZSBhcHBsaWVkXG4gIC8vIHRvIGVhY2ggZWxlbWVudCBpbiBhIGNvbGxlY3Rpb24sIHJldHVybmluZyB0aGUgZGVzaXJlZCByZXN1bHQg4oCUIGVpdGhlclxuICAvLyBpZGVudGl0eSwgYW4gYXJiaXRyYXJ5IGNhbGxiYWNrLCBhIHByb3BlcnR5IG1hdGNoZXIsIG9yIGEgcHJvcGVydHkgYWNjZXNzb3IuXG4gIF8uaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIF8uaWRlbnRpdHk7XG4gICAgaWYgKF8uaXNGdW5jdGlvbih2YWx1ZSkpIHJldHVybiBjcmVhdGVDYWxsYmFjayh2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpO1xuICAgIGlmIChfLmlzT2JqZWN0KHZhbHVlKSkgcmV0dXJuIF8ubWF0Y2hlcyh2YWx1ZSk7XG4gICAgcmV0dXJuIF8ucHJvcGVydHkodmFsdWUpO1xuICB9O1xuXG4gIC8vIENvbGxlY3Rpb24gRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gVGhlIGNvcm5lcnN0b25lLCBhbiBgZWFjaGAgaW1wbGVtZW50YXRpb24sIGFrYSBgZm9yRWFjaGAuXG4gIC8vIEhhbmRsZXMgcmF3IG9iamVjdHMgaW4gYWRkaXRpb24gdG8gYXJyYXktbGlrZXMuIFRyZWF0cyBhbGxcbiAgLy8gc3BhcnNlIGFycmF5LWxpa2VzIGFzIGlmIHRoZXkgd2VyZSBkZW5zZS5cbiAgXy5lYWNoID0gXy5mb3JFYWNoID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIG9iajtcbiAgICBpdGVyYXRlZSA9IGNyZWF0ZUNhbGxiYWNrKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICB2YXIgaSwgbGVuZ3RoID0gb2JqLmxlbmd0aDtcbiAgICBpZiAobGVuZ3RoID09PSArbGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaXRlcmF0ZWUob2JqW2ldLCBpLCBvYmopO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBpdGVyYXRlZShvYmpba2V5c1tpXV0sIGtleXNbaV0sIG9iaik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIHRoZSBpdGVyYXRlZSB0byBlYWNoIGVsZW1lbnQuXG4gIF8ubWFwID0gXy5jb2xsZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIFtdO1xuICAgIGl0ZXJhdGVlID0gXy5pdGVyYXRlZShpdGVyYXRlZSwgY29udGV4dCk7XG4gICAgdmFyIGtleXMgPSBvYmoubGVuZ3RoICE9PSArb2JqLmxlbmd0aCAmJiBfLmtleXMob2JqKSxcbiAgICAgICAgbGVuZ3RoID0gKGtleXMgfHwgb2JqKS5sZW5ndGgsXG4gICAgICAgIHJlc3VsdHMgPSBBcnJheShsZW5ndGgpLFxuICAgICAgICBjdXJyZW50S2V5O1xuICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDtcbiAgICAgIHJlc3VsdHNbaW5kZXhdID0gaXRlcmF0ZWUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICB2YXIgcmVkdWNlRXJyb3IgPSAnUmVkdWNlIG9mIGVtcHR5IGFycmF5IHdpdGggbm8gaW5pdGlhbCB2YWx1ZSc7XG5cbiAgLy8gKipSZWR1Y2UqKiBidWlsZHMgdXAgYSBzaW5nbGUgcmVzdWx0IGZyb20gYSBsaXN0IG9mIHZhbHVlcywgYWthIGBpbmplY3RgLFxuICAvLyBvciBgZm9sZGxgLlxuICBfLnJlZHVjZSA9IF8uZm9sZGwgPSBfLmluamVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGNvbnRleHQpIHtcbiAgICBpZiAob2JqID09IG51bGwpIG9iaiA9IFtdO1xuICAgIGl0ZXJhdGVlID0gY3JlYXRlQ2FsbGJhY2soaXRlcmF0ZWUsIGNvbnRleHQsIDQpO1xuICAgIHZhciBrZXlzID0gb2JqLmxlbmd0aCAhPT0gK29iai5sZW5ndGggJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLFxuICAgICAgICBpbmRleCA9IDAsIGN1cnJlbnRLZXk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAzKSB7XG4gICAgICBpZiAoIWxlbmd0aCkgdGhyb3cgbmV3IFR5cGVFcnJvcihyZWR1Y2VFcnJvcik7XG4gICAgICBtZW1vID0gb2JqW2tleXMgPyBrZXlzW2luZGV4KytdIDogaW5kZXgrK107XG4gICAgfVxuICAgIGZvciAoOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4O1xuICAgICAgbWVtbyA9IGl0ZXJhdGVlKG1lbW8sIG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKTtcbiAgICB9XG4gICAgcmV0dXJuIG1lbW87XG4gIH07XG5cbiAgLy8gVGhlIHJpZ2h0LWFzc29jaWF0aXZlIHZlcnNpb24gb2YgcmVkdWNlLCBhbHNvIGtub3duIGFzIGBmb2xkcmAuXG4gIF8ucmVkdWNlUmlnaHQgPSBfLmZvbGRyID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgbWVtbywgY29udGV4dCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgb2JqID0gW107XG4gICAgaXRlcmF0ZWUgPSBjcmVhdGVDYWxsYmFjayhpdGVyYXRlZSwgY29udGV4dCwgNCk7XG4gICAgdmFyIGtleXMgPSBvYmoubGVuZ3RoICE9PSArIG9iai5sZW5ndGggJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGluZGV4ID0gKGtleXMgfHwgb2JqKS5sZW5ndGgsXG4gICAgICAgIGN1cnJlbnRLZXk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAzKSB7XG4gICAgICBpZiAoIWluZGV4KSB0aHJvdyBuZXcgVHlwZUVycm9yKHJlZHVjZUVycm9yKTtcbiAgICAgIG1lbW8gPSBvYmpba2V5cyA/IGtleXNbLS1pbmRleF0gOiAtLWluZGV4XTtcbiAgICB9XG4gICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDtcbiAgICAgIG1lbW8gPSBpdGVyYXRlZShtZW1vLCBvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaik7XG4gICAgfVxuICAgIHJldHVybiBtZW1vO1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC5cbiAgXy5maW5kID0gXy5kZXRlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciByZXN1bHQ7XG4gICAgcHJlZGljYXRlID0gXy5pdGVyYXRlZShwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIF8uc29tZShvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSwgaW5kZXgsIGxpc3QpKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFJldHVybiBhbGwgdGhlIGVsZW1lbnRzIHRoYXQgcGFzcyBhIHRydXRoIHRlc3QuXG4gIC8vIEFsaWFzZWQgYXMgYHNlbGVjdGAuXG4gIF8uZmlsdGVyID0gXy5zZWxlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0cztcbiAgICBwcmVkaWNhdGUgPSBfLml0ZXJhdGVlKHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBpbmRleCwgbGlzdCkpIHJlc3VsdHMucHVzaCh2YWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgZm9yIHdoaWNoIGEgdHJ1dGggdGVzdCBmYWlscy5cbiAgXy5yZWplY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIHJldHVybiBfLmZpbHRlcihvYmosIF8ubmVnYXRlKF8uaXRlcmF0ZWUocHJlZGljYXRlKSksIGNvbnRleHQpO1xuICB9O1xuXG4gIC8vIERldGVybWluZSB3aGV0aGVyIGFsbCBvZiB0aGUgZWxlbWVudHMgbWF0Y2ggYSB0cnV0aCB0ZXN0LlxuICAvLyBBbGlhc2VkIGFzIGBhbGxgLlxuICBfLmV2ZXJ5ID0gXy5hbGwgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHRydWU7XG4gICAgcHJlZGljYXRlID0gXy5pdGVyYXRlZShwcmVkaWNhdGUsIGNvbnRleHQpO1xuICAgIHZhciBrZXlzID0gb2JqLmxlbmd0aCAhPT0gK29iai5sZW5ndGggJiYgXy5rZXlzKG9iaiksXG4gICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLFxuICAgICAgICBpbmRleCwgY3VycmVudEtleTtcbiAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDtcbiAgICAgIGlmICghcHJlZGljYXRlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgaWYgYXQgbGVhc3Qgb25lIGVsZW1lbnQgaW4gdGhlIG9iamVjdCBtYXRjaGVzIGEgdHJ1dGggdGVzdC5cbiAgLy8gQWxpYXNlZCBhcyBgYW55YC5cbiAgXy5zb21lID0gXy5hbnkgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIHByZWRpY2F0ZSA9IF8uaXRlcmF0ZWUocHJlZGljYXRlLCBjb250ZXh0KTtcbiAgICB2YXIga2V5cyA9IG9iai5sZW5ndGggIT09ICtvYmoubGVuZ3RoICYmIF8ua2V5cyhvYmopLFxuICAgICAgICBsZW5ndGggPSAoa2V5cyB8fCBvYmopLmxlbmd0aCxcbiAgICAgICAgaW5kZXgsIGN1cnJlbnRLZXk7XG4gICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICBjdXJyZW50S2V5ID0ga2V5cyA/IGtleXNbaW5kZXhdIDogaW5kZXg7XG4gICAgICBpZiAocHJlZGljYXRlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvLyBEZXRlcm1pbmUgaWYgdGhlIGFycmF5IG9yIG9iamVjdCBjb250YWlucyBhIGdpdmVuIHZhbHVlICh1c2luZyBgPT09YCkuXG4gIC8vIEFsaWFzZWQgYXMgYGluY2x1ZGVgLlxuICBfLmNvbnRhaW5zID0gXy5pbmNsdWRlID0gZnVuY3Rpb24ob2JqLCB0YXJnZXQpIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBpZiAob2JqLmxlbmd0aCAhPT0gK29iai5sZW5ndGgpIG9iaiA9IF8udmFsdWVzKG9iaik7XG4gICAgcmV0dXJuIF8uaW5kZXhPZihvYmosIHRhcmdldCkgPj0gMDtcbiAgfTtcblxuICAvLyBJbnZva2UgYSBtZXRob2QgKHdpdGggYXJndW1lbnRzKSBvbiBldmVyeSBpdGVtIGluIGEgY29sbGVjdGlvbi5cbiAgXy5pbnZva2UgPSBmdW5jdGlvbihvYmosIG1ldGhvZCkge1xuICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgIHZhciBpc0Z1bmMgPSBfLmlzRnVuY3Rpb24obWV0aG9kKTtcbiAgICByZXR1cm4gXy5tYXAob2JqLCBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIChpc0Z1bmMgPyBtZXRob2QgOiB2YWx1ZVttZXRob2RdKS5hcHBseSh2YWx1ZSwgYXJncyk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgbWFwYDogZmV0Y2hpbmcgYSBwcm9wZXJ0eS5cbiAgXy5wbHVjayA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7XG4gICAgcmV0dXJuIF8ubWFwKG9iaiwgXy5wcm9wZXJ0eShrZXkpKTtcbiAgfTtcblxuICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBmaWx0ZXJgOiBzZWxlY3Rpbmcgb25seSBvYmplY3RzXG4gIC8vIGNvbnRhaW5pbmcgc3BlY2lmaWMgYGtleTp2YWx1ZWAgcGFpcnMuXG4gIF8ud2hlcmUgPSBmdW5jdGlvbihvYmosIGF0dHJzKSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKG9iaiwgXy5tYXRjaGVzKGF0dHJzKSk7XG4gIH07XG5cbiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgZmluZGA6IGdldHRpbmcgdGhlIGZpcnN0IG9iamVjdFxuICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLmZpbmRXaGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHtcbiAgICByZXR1cm4gXy5maW5kKG9iaiwgXy5tYXRjaGVzKGF0dHJzKSk7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBtYXhpbXVtIGVsZW1lbnQgKG9yIGVsZW1lbnQtYmFzZWQgY29tcHV0YXRpb24pLlxuICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHksXG4gICAgICAgIHZhbHVlLCBjb21wdXRlZDtcbiAgICBpZiAoaXRlcmF0ZWUgPT0gbnVsbCAmJiBvYmogIT0gbnVsbCkge1xuICAgICAgb2JqID0gb2JqLmxlbmd0aCA9PT0gK29iai5sZW5ndGggPyBvYmogOiBfLnZhbHVlcyhvYmopO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IG9iai5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICB2YWx1ZSA9IG9ialtpXTtcbiAgICAgICAgaWYgKHZhbHVlID4gcmVzdWx0KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaXRlcmF0ZWUgPSBfLml0ZXJhdGVlKGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkge1xuICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCk7XG4gICAgICAgIGlmIChjb21wdXRlZCA+IGxhc3RDb21wdXRlZCB8fCBjb21wdXRlZCA9PT0gLUluZmluaXR5ICYmIHJlc3VsdCA9PT0gLUluZmluaXR5KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFJldHVybiB0aGUgbWluaW11bSBlbGVtZW50IChvciBlbGVtZW50LWJhc2VkIGNvbXB1dGF0aW9uKS5cbiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdCA9IEluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSBJbmZpbml0eSxcbiAgICAgICAgdmFsdWUsIGNvbXB1dGVkO1xuICAgIGlmIChpdGVyYXRlZSA9PSBudWxsICYmIG9iaiAhPSBudWxsKSB7XG4gICAgICBvYmogPSBvYmoubGVuZ3RoID09PSArb2JqLmxlbmd0aCA/IG9iaiA6IF8udmFsdWVzKG9iaik7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhbHVlID0gb2JqW2ldO1xuICAgICAgICBpZiAodmFsdWUgPCByZXN1bHQpIHtcbiAgICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpdGVyYXRlZSA9IF8uaXRlcmF0ZWUoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KTtcbiAgICAgICAgaWYgKGNvbXB1dGVkIDwgbGFzdENvbXB1dGVkIHx8IGNvbXB1dGVkID09PSBJbmZpbml0eSAmJiByZXN1bHQgPT09IEluZmluaXR5KSB7XG4gICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgICAgbGFzdENvbXB1dGVkID0gY29tcHV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFNodWZmbGUgYSBjb2xsZWN0aW9uLCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlXG4gIC8vIFtGaXNoZXItWWF0ZXMgc2h1ZmZsZV0oaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXLigJNZYXRlc19zaHVmZmxlKS5cbiAgXy5zaHVmZmxlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHNldCA9IG9iaiAmJiBvYmoubGVuZ3RoID09PSArb2JqLmxlbmd0aCA/IG9iaiA6IF8udmFsdWVzKG9iaik7XG4gICAgdmFyIGxlbmd0aCA9IHNldC5sZW5ndGg7XG4gICAgdmFyIHNodWZmbGVkID0gQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpbmRleCA9IDAsIHJhbmQ7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICByYW5kID0gXy5yYW5kb20oMCwgaW5kZXgpO1xuICAgICAgaWYgKHJhbmQgIT09IGluZGV4KSBzaHVmZmxlZFtpbmRleF0gPSBzaHVmZmxlZFtyYW5kXTtcbiAgICAgIHNodWZmbGVkW3JhbmRdID0gc2V0W2luZGV4XTtcbiAgICB9XG4gICAgcmV0dXJuIHNodWZmbGVkO1xuICB9O1xuXG4gIC8vIFNhbXBsZSAqKm4qKiByYW5kb20gdmFsdWVzIGZyb20gYSBjb2xsZWN0aW9uLlxuICAvLyBJZiAqKm4qKiBpcyBub3Qgc3BlY2lmaWVkLCByZXR1cm5zIGEgc2luZ2xlIHJhbmRvbSBlbGVtZW50LlxuICAvLyBUaGUgaW50ZXJuYWwgYGd1YXJkYCBhcmd1bWVudCBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBtYXBgLlxuICBfLnNhbXBsZSA9IGZ1bmN0aW9uKG9iaiwgbiwgZ3VhcmQpIHtcbiAgICBpZiAobiA9PSBudWxsIHx8IGd1YXJkKSB7XG4gICAgICBpZiAob2JqLmxlbmd0aCAhPT0gK29iai5sZW5ndGgpIG9iaiA9IF8udmFsdWVzKG9iaik7XG4gICAgICByZXR1cm4gb2JqW18ucmFuZG9tKG9iai5sZW5ndGggLSAxKV07XG4gICAgfVxuICAgIHJldHVybiBfLnNodWZmbGUob2JqKS5zbGljZSgwLCBNYXRoLm1heCgwLCBuKSk7XG4gIH07XG5cbiAgLy8gU29ydCB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uIHByb2R1Y2VkIGJ5IGFuIGl0ZXJhdGVlLlxuICBfLnNvcnRCeSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICBpdGVyYXRlZSA9IF8uaXRlcmF0ZWUoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgIHJldHVybiBfLnBsdWNrKF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgY3JpdGVyaWE6IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdClcbiAgICAgIH07XG4gICAgfSkuc29ydChmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICAgICAgdmFyIGEgPSBsZWZ0LmNyaXRlcmlhO1xuICAgICAgdmFyIGIgPSByaWdodC5jcml0ZXJpYTtcbiAgICAgIGlmIChhICE9PSBiKSB7XG4gICAgICAgIGlmIChhID4gYiB8fCBhID09PSB2b2lkIDApIHJldHVybiAxO1xuICAgICAgICBpZiAoYSA8IGIgfHwgYiA9PT0gdm9pZCAwKSByZXR1cm4gLTE7XG4gICAgICB9XG4gICAgICByZXR1cm4gbGVmdC5pbmRleCAtIHJpZ2h0LmluZGV4O1xuICAgIH0pLCAndmFsdWUnKTtcbiAgfTtcblxuICAvLyBBbiBpbnRlcm5hbCBmdW5jdGlvbiB1c2VkIGZvciBhZ2dyZWdhdGUgXCJncm91cCBieVwiIG9wZXJhdGlvbnMuXG4gIHZhciBncm91cCA9IGZ1bmN0aW9uKGJlaGF2aW9yKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgIGl0ZXJhdGVlID0gXy5pdGVyYXRlZShpdGVyYXRlZSwgY29udGV4dCk7XG4gICAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGtleSA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgb2JqKTtcbiAgICAgICAgYmVoYXZpb3IocmVzdWx0LCB2YWx1ZSwga2V5KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIEdyb3VwcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLiBQYXNzIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGVcbiAgLy8gdG8gZ3JvdXAgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBjcml0ZXJpb24uXG4gIF8uZ3JvdXBCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldLnB1c2godmFsdWUpOyBlbHNlIHJlc3VsdFtrZXldID0gW3ZhbHVlXTtcbiAgfSk7XG5cbiAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvclxuICAvLyB3aGVuIHlvdSBrbm93IHRoYXQgeW91ciBpbmRleCB2YWx1ZXMgd2lsbCBiZSB1bmlxdWUuXG4gIF8uaW5kZXhCeSA9IGdyb3VwKGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH0pO1xuXG4gIC8vIENvdW50cyBpbnN0YW5jZXMgb2YgYW4gb2JqZWN0IHRoYXQgZ3JvdXAgYnkgYSBjZXJ0YWluIGNyaXRlcmlvbi4gUGFzc1xuICAvLyBlaXRoZXIgYSBzdHJpbmcgYXR0cmlidXRlIHRvIGNvdW50IGJ5LCBvciBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGVcbiAgLy8gY3JpdGVyaW9uLlxuICBfLmNvdW50QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICBpZiAoXy5oYXMocmVzdWx0LCBrZXkpKSByZXN1bHRba2V5XSsrOyBlbHNlIHJlc3VsdFtrZXldID0gMTtcbiAgfSk7XG5cbiAgLy8gVXNlIGEgY29tcGFyYXRvciBmdW5jdGlvbiB0byBmaWd1cmUgb3V0IHRoZSBzbWFsbGVzdCBpbmRleCBhdCB3aGljaFxuICAvLyBhbiBvYmplY3Qgc2hvdWxkIGJlIGluc2VydGVkIHNvIGFzIHRvIG1haW50YWluIG9yZGVyLiBVc2VzIGJpbmFyeSBzZWFyY2guXG4gIF8uc29ydGVkSW5kZXggPSBmdW5jdGlvbihhcnJheSwgb2JqLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIGl0ZXJhdGVlID0gXy5pdGVyYXRlZShpdGVyYXRlZSwgY29udGV4dCwgMSk7XG4gICAgdmFyIHZhbHVlID0gaXRlcmF0ZWUob2JqKTtcbiAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGFycmF5Lmxlbmd0aDtcbiAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgdmFyIG1pZCA9IGxvdyArIGhpZ2ggPj4+IDE7XG4gICAgICBpZiAoaXRlcmF0ZWUoYXJyYXlbbWlkXSkgPCB2YWx1ZSkgbG93ID0gbWlkICsgMTsgZWxzZSBoaWdoID0gbWlkO1xuICAgIH1cbiAgICByZXR1cm4gbG93O1xuICB9O1xuXG4gIC8vIFNhZmVseSBjcmVhdGUgYSByZWFsLCBsaXZlIGFycmF5IGZyb20gYW55dGhpbmcgaXRlcmFibGUuXG4gIF8udG9BcnJheSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghb2JqKSByZXR1cm4gW107XG4gICAgaWYgKF8uaXNBcnJheShvYmopKSByZXR1cm4gc2xpY2UuY2FsbChvYmopO1xuICAgIGlmIChvYmoubGVuZ3RoID09PSArb2JqLmxlbmd0aCkgcmV0dXJuIF8ubWFwKG9iaiwgXy5pZGVudGl0eSk7XG4gICAgcmV0dXJuIF8udmFsdWVzKG9iaik7XG4gIH07XG5cbiAgLy8gUmV0dXJuIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYW4gb2JqZWN0LlxuICBfLnNpemUgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiAwO1xuICAgIHJldHVybiBvYmoubGVuZ3RoID09PSArb2JqLmxlbmd0aCA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7XG4gIH07XG5cbiAgLy8gU3BsaXQgYSBjb2xsZWN0aW9uIGludG8gdHdvIGFycmF5czogb25lIHdob3NlIGVsZW1lbnRzIGFsbCBzYXRpc2Z5IHRoZSBnaXZlblxuICAvLyBwcmVkaWNhdGUsIGFuZCBvbmUgd2hvc2UgZWxlbWVudHMgYWxsIGRvIG5vdCBzYXRpc2Z5IHRoZSBwcmVkaWNhdGUuXG4gIF8ucGFydGl0aW9uID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHtcbiAgICBwcmVkaWNhdGUgPSBfLml0ZXJhdGVlKHByZWRpY2F0ZSwgY29udGV4dCk7XG4gICAgdmFyIHBhc3MgPSBbXSwgZmFpbCA9IFtdO1xuICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iaikge1xuICAgICAgKHByZWRpY2F0ZSh2YWx1ZSwga2V5LCBvYmopID8gcGFzcyA6IGZhaWwpLnB1c2godmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiBbcGFzcywgZmFpbF07XG4gIH07XG5cbiAgLy8gQXJyYXkgRnVuY3Rpb25zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIEdldCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheS4gUGFzc2luZyAqKm4qKiB3aWxsIHJldHVybiB0aGUgZmlyc3QgTlxuICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LiBBbGlhc2VkIGFzIGBoZWFkYCBhbmQgYHRha2VgLiBUaGUgKipndWFyZCoqIGNoZWNrXG4gIC8vIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC5cbiAgXy5maXJzdCA9IF8uaGVhZCA9IF8udGFrZSA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIGlmIChuID09IG51bGwgfHwgZ3VhcmQpIHJldHVybiBhcnJheVswXTtcbiAgICBpZiAobiA8IDApIHJldHVybiBbXTtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgMCwgbik7XG4gIH07XG5cbiAgLy8gUmV0dXJucyBldmVyeXRoaW5nIGJ1dCB0aGUgbGFzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEVzcGVjaWFsbHkgdXNlZnVsIG9uXG4gIC8vIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIGFsbCB0aGUgdmFsdWVzIGluXG4gIC8vIHRoZSBhcnJheSwgZXhjbHVkaW5nIHRoZSBsYXN0IE4uIFRoZSAqKmd1YXJkKiogY2hlY2sgYWxsb3dzIGl0IHRvIHdvcmsgd2l0aFxuICAvLyBgXy5tYXBgLlxuICBfLmluaXRpYWwgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgMCwgTWF0aC5tYXgoMCwgYXJyYXkubGVuZ3RoIC0gKG4gPT0gbnVsbCB8fCBndWFyZCA/IDEgOiBuKSkpO1xuICB9O1xuXG4gIC8vIEdldCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBsYXN0IE5cbiAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuXG4gIF8ubGFzdCA9IGZ1bmN0aW9uKGFycmF5LCBuLCBndWFyZCkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIGlmIChuID09IG51bGwgfHwgZ3VhcmQpIHJldHVybiBhcnJheVthcnJheS5sZW5ndGggLSAxXTtcbiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgTWF0aC5tYXgoYXJyYXkubGVuZ3RoIC0gbiwgMCkpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGZpcnN0IGVudHJ5IG9mIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgdGFpbGAgYW5kIGBkcm9wYC5cbiAgLy8gRXNwZWNpYWxseSB1c2VmdWwgb24gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgYW4gKipuKiogd2lsbCByZXR1cm5cbiAgLy8gdGhlIHJlc3QgTiB2YWx1ZXMgaW4gdGhlIGFycmF5LiBUaGUgKipndWFyZCoqXG4gIC8vIGNoZWNrIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC5cbiAgXy5yZXN0ID0gXy50YWlsID0gXy5kcm9wID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIG4gPT0gbnVsbCB8fCBndWFyZCA/IDEgOiBuKTtcbiAgfTtcblxuICAvLyBUcmltIG91dCBhbGwgZmFsc3kgdmFsdWVzIGZyb20gYW4gYXJyYXkuXG4gIF8uY29tcGFjdCA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBfLmlkZW50aXR5KTtcbiAgfTtcblxuICAvLyBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiBhIHJlY3Vyc2l2ZSBgZmxhdHRlbmAgZnVuY3Rpb24uXG4gIHZhciBmbGF0dGVuID0gZnVuY3Rpb24oaW5wdXQsIHNoYWxsb3csIHN0cmljdCwgb3V0cHV0KSB7XG4gICAgaWYgKHNoYWxsb3cgJiYgXy5ldmVyeShpbnB1dCwgXy5pc0FycmF5KSkge1xuICAgICAgcmV0dXJuIGNvbmNhdC5hcHBseShvdXRwdXQsIGlucHV0KTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGlucHV0Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdmFsdWUgPSBpbnB1dFtpXTtcbiAgICAgIGlmICghXy5pc0FycmF5KHZhbHVlKSAmJiAhXy5pc0FyZ3VtZW50cyh2YWx1ZSkpIHtcbiAgICAgICAgaWYgKCFzdHJpY3QpIG91dHB1dC5wdXNoKHZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAoc2hhbGxvdykge1xuICAgICAgICBwdXNoLmFwcGx5KG91dHB1dCwgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmxhdHRlbih2YWx1ZSwgc2hhbGxvdywgc3RyaWN0LCBvdXRwdXQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9O1xuXG4gIC8vIEZsYXR0ZW4gb3V0IGFuIGFycmF5LCBlaXRoZXIgcmVjdXJzaXZlbHkgKGJ5IGRlZmF1bHQpLCBvciBqdXN0IG9uZSBsZXZlbC5cbiAgXy5mbGF0dGVuID0gZnVuY3Rpb24oYXJyYXksIHNoYWxsb3cpIHtcbiAgICByZXR1cm4gZmxhdHRlbihhcnJheSwgc2hhbGxvdywgZmFsc2UsIFtdKTtcbiAgfTtcblxuICAvLyBSZXR1cm4gYSB2ZXJzaW9uIG9mIHRoZSBhcnJheSB0aGF0IGRvZXMgbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCB2YWx1ZShzKS5cbiAgXy53aXRob3V0ID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICByZXR1cm4gXy5kaWZmZXJlbmNlKGFycmF5LCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICB9O1xuXG4gIC8vIFByb2R1Y2UgYSBkdXBsaWNhdGUtZnJlZSB2ZXJzaW9uIG9mIHRoZSBhcnJheS4gSWYgdGhlIGFycmF5IGhhcyBhbHJlYWR5XG4gIC8vIGJlZW4gc29ydGVkLCB5b3UgaGF2ZSB0aGUgb3B0aW9uIG9mIHVzaW5nIGEgZmFzdGVyIGFsZ29yaXRobS5cbiAgLy8gQWxpYXNlZCBhcyBgdW5pcXVlYC5cbiAgXy51bmlxID0gXy51bmlxdWUgPSBmdW5jdGlvbihhcnJheSwgaXNTb3J0ZWQsIGl0ZXJhdGVlLCBjb250ZXh0KSB7XG4gICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiBbXTtcbiAgICBpZiAoIV8uaXNCb29sZWFuKGlzU29ydGVkKSkge1xuICAgICAgY29udGV4dCA9IGl0ZXJhdGVlO1xuICAgICAgaXRlcmF0ZWUgPSBpc1NvcnRlZDtcbiAgICAgIGlzU29ydGVkID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChpdGVyYXRlZSAhPSBudWxsKSBpdGVyYXRlZSA9IF8uaXRlcmF0ZWUoaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgc2VlbiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBhcnJheS5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaV07XG4gICAgICBpZiAoaXNTb3J0ZWQpIHtcbiAgICAgICAgaWYgKCFpIHx8IHNlZW4gIT09IHZhbHVlKSByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIHNlZW4gPSB2YWx1ZTtcbiAgICAgIH0gZWxzZSBpZiAoaXRlcmF0ZWUpIHtcbiAgICAgICAgdmFyIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUsIGksIGFycmF5KTtcbiAgICAgICAgaWYgKF8uaW5kZXhPZihzZWVuLCBjb21wdXRlZCkgPCAwKSB7XG4gICAgICAgICAgc2Vlbi5wdXNoKGNvbXB1dGVkKTtcbiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoXy5pbmRleE9mKHJlc3VsdCwgdmFsdWUpIDwgMCkge1xuICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSB1bmlvbjogZWFjaCBkaXN0aW5jdCBlbGVtZW50IGZyb20gYWxsIG9mXG4gIC8vIHRoZSBwYXNzZWQtaW4gYXJyYXlzLlxuICBfLnVuaW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF8udW5pcShmbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgdHJ1ZSwgW10pKTtcbiAgfTtcblxuICAvLyBQcm9kdWNlIGFuIGFycmF5IHRoYXQgY29udGFpbnMgZXZlcnkgaXRlbSBzaGFyZWQgYmV0d2VlbiBhbGwgdGhlXG4gIC8vIHBhc3NlZC1pbiBhcnJheXMuXG4gIF8uaW50ZXJzZWN0aW9uID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIFtdO1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgYXJnc0xlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IGFycmF5W2ldO1xuICAgICAgaWYgKF8uY29udGFpbnMocmVzdWx0LCBpdGVtKSkgY29udGludWU7XG4gICAgICBmb3IgKHZhciBqID0gMTsgaiA8IGFyZ3NMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAoIV8uY29udGFpbnMoYXJndW1lbnRzW2pdLCBpdGVtKSkgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAoaiA9PT0gYXJnc0xlbmd0aCkgcmVzdWx0LnB1c2goaXRlbSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gVGFrZSB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIG9uZSBhcnJheSBhbmQgYSBudW1iZXIgb2Ygb3RoZXIgYXJyYXlzLlxuICAvLyBPbmx5IHRoZSBlbGVtZW50cyBwcmVzZW50IGluIGp1c3QgdGhlIGZpcnN0IGFycmF5IHdpbGwgcmVtYWluLlxuICBfLmRpZmZlcmVuY2UgPSBmdW5jdGlvbihhcnJheSkge1xuICAgIHZhciByZXN0ID0gZmxhdHRlbihzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIHRydWUsIHRydWUsIFtdKTtcbiAgICByZXR1cm4gXy5maWx0ZXIoYXJyYXksIGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAgIHJldHVybiAhXy5jb250YWlucyhyZXN0LCB2YWx1ZSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gWmlwIHRvZ2V0aGVyIG11bHRpcGxlIGxpc3RzIGludG8gYSBzaW5nbGUgYXJyYXkgLS0gZWxlbWVudHMgdGhhdCBzaGFyZVxuICAvLyBhbiBpbmRleCBnbyB0b2dldGhlci5cbiAgXy56aXAgPSBmdW5jdGlvbihhcnJheSkge1xuICAgIGlmIChhcnJheSA9PSBudWxsKSByZXR1cm4gW107XG4gICAgdmFyIGxlbmd0aCA9IF8ubWF4KGFyZ3VtZW50cywgJ2xlbmd0aCcpLmxlbmd0aDtcbiAgICB2YXIgcmVzdWx0cyA9IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0c1tpXSA9IF8ucGx1Y2soYXJndW1lbnRzLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLy8gQ29udmVydHMgbGlzdHMgaW50byBvYmplY3RzLiBQYXNzIGVpdGhlciBhIHNpbmdsZSBhcnJheSBvZiBgW2tleSwgdmFsdWVdYFxuICAvLyBwYWlycywgb3IgdHdvIHBhcmFsbGVsIGFycmF5cyBvZiB0aGUgc2FtZSBsZW5ndGggLS0gb25lIG9mIGtleXMsIGFuZCBvbmUgb2ZcbiAgLy8gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWVzLlxuICBfLm9iamVjdCA9IGZ1bmN0aW9uKGxpc3QsIHZhbHVlcykge1xuICAgIGlmIChsaXN0ID09IG51bGwpIHJldHVybiB7fTtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh2YWx1ZXMpIHtcbiAgICAgICAgcmVzdWx0W2xpc3RbaV1dID0gdmFsdWVzW2ldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0W2xpc3RbaV1bMF1dID0gbGlzdFtpXVsxXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAvLyBSZXR1cm4gdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGl0ZW0gaW4gYW4gYXJyYXksXG4gIC8vIG9yIC0xIGlmIHRoZSBpdGVtIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGUgYXJyYXkuXG4gIC8vIElmIHRoZSBhcnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0cnVlYFxuICAvLyBmb3IgKippc1NvcnRlZCoqIHRvIHVzZSBiaW5hcnkgc2VhcmNoLlxuICBfLmluZGV4T2YgPSBmdW5jdGlvbihhcnJheSwgaXRlbSwgaXNTb3J0ZWQpIHtcbiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xO1xuICAgIHZhciBpID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgIGlmIChpc1NvcnRlZCkge1xuICAgICAgaWYgKHR5cGVvZiBpc1NvcnRlZCA9PSAnbnVtYmVyJykge1xuICAgICAgICBpID0gaXNTb3J0ZWQgPCAwID8gTWF0aC5tYXgoMCwgbGVuZ3RoICsgaXNTb3J0ZWQpIDogaXNTb3J0ZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpID0gXy5zb3J0ZWRJbmRleChhcnJheSwgaXRlbSk7XG4gICAgICAgIHJldHVybiBhcnJheVtpXSA9PT0gaXRlbSA/IGkgOiAtMTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICg7IGkgPCBsZW5ndGg7IGkrKykgaWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTtcbiAgICByZXR1cm4gLTE7XG4gIH07XG5cbiAgXy5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uKGFycmF5LCBpdGVtLCBmcm9tKSB7XG4gICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiAtMTtcbiAgICB2YXIgaWR4ID0gYXJyYXkubGVuZ3RoO1xuICAgIGlmICh0eXBlb2YgZnJvbSA9PSAnbnVtYmVyJykge1xuICAgICAgaWR4ID0gZnJvbSA8IDAgPyBpZHggKyBmcm9tICsgMSA6IE1hdGgubWluKGlkeCwgZnJvbSArIDEpO1xuICAgIH1cbiAgICB3aGlsZSAoLS1pZHggPj0gMCkgaWYgKGFycmF5W2lkeF0gPT09IGl0ZW0pIHJldHVybiBpZHg7XG4gICAgcmV0dXJuIC0xO1xuICB9O1xuXG4gIC8vIEdlbmVyYXRlIGFuIGludGVnZXIgQXJyYXkgY29udGFpbmluZyBhbiBhcml0aG1ldGljIHByb2dyZXNzaW9uLiBBIHBvcnQgb2ZcbiAgLy8gdGhlIG5hdGl2ZSBQeXRob24gYHJhbmdlKClgIGZ1bmN0aW9uLiBTZWVcbiAgLy8gW3RoZSBQeXRob24gZG9jdW1lbnRhdGlvbl0oaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI3JhbmdlKS5cbiAgXy5yYW5nZSA9IGZ1bmN0aW9uKHN0YXJ0LCBzdG9wLCBzdGVwKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPD0gMSkge1xuICAgICAgc3RvcCA9IHN0YXJ0IHx8IDA7XG4gICAgICBzdGFydCA9IDA7XG4gICAgfVxuICAgIHN0ZXAgPSBzdGVwIHx8IDE7XG5cbiAgICB2YXIgbGVuZ3RoID0gTWF0aC5tYXgoTWF0aC5jZWlsKChzdG9wIC0gc3RhcnQpIC8gc3RlcCksIDApO1xuICAgIHZhciByYW5nZSA9IEFycmF5KGxlbmd0aCk7XG5cbiAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrLCBzdGFydCArPSBzdGVwKSB7XG4gICAgICByYW5nZVtpZHhdID0gc3RhcnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJhbmdlO1xuICB9O1xuXG4gIC8vIEZ1bmN0aW9uIChhaGVtKSBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gUmV1c2FibGUgY29uc3RydWN0b3IgZnVuY3Rpb24gZm9yIHByb3RvdHlwZSBzZXR0aW5nLlxuICB2YXIgQ3RvciA9IGZ1bmN0aW9uKCl7fTtcblxuICAvLyBDcmVhdGUgYSBmdW5jdGlvbiBib3VuZCB0byBhIGdpdmVuIG9iamVjdCAoYXNzaWduaW5nIGB0aGlzYCwgYW5kIGFyZ3VtZW50cyxcbiAgLy8gb3B0aW9uYWxseSkuIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBGdW5jdGlvbi5iaW5kYCBpZlxuICAvLyBhdmFpbGFibGUuXG4gIF8uYmluZCA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQpIHtcbiAgICB2YXIgYXJncywgYm91bmQ7XG4gICAgaWYgKG5hdGl2ZUJpbmQgJiYgZnVuYy5iaW5kID09PSBuYXRpdmVCaW5kKSByZXR1cm4gbmF0aXZlQmluZC5hcHBseShmdW5jLCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuICAgIGlmICghXy5pc0Z1bmN0aW9uKGZ1bmMpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdCaW5kIG11c3QgYmUgY2FsbGVkIG9uIGEgZnVuY3Rpb24nKTtcbiAgICBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgIGJvdW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgYm91bmQpKSByZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTtcbiAgICAgIEN0b3IucHJvdG90eXBlID0gZnVuYy5wcm90b3R5cGU7XG4gICAgICB2YXIgc2VsZiA9IG5ldyBDdG9yO1xuICAgICAgQ3Rvci5wcm90b3R5cGUgPSBudWxsO1xuICAgICAgdmFyIHJlc3VsdCA9IGZ1bmMuYXBwbHkoc2VsZiwgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XG4gICAgICBpZiAoXy5pc09iamVjdChyZXN1bHQpKSByZXR1cm4gcmVzdWx0O1xuICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfTtcbiAgICByZXR1cm4gYm91bmQ7XG4gIH07XG5cbiAgLy8gUGFydGlhbGx5IGFwcGx5IGEgZnVuY3Rpb24gYnkgY3JlYXRpbmcgYSB2ZXJzaW9uIHRoYXQgaGFzIGhhZCBzb21lIG9mIGl0c1xuICAvLyBhcmd1bWVudHMgcHJlLWZpbGxlZCwgd2l0aG91dCBjaGFuZ2luZyBpdHMgZHluYW1pYyBgdGhpc2AgY29udGV4dC4gXyBhY3RzXG4gIC8vIGFzIGEgcGxhY2Vob2xkZXIsIGFsbG93aW5nIGFueSBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMgdG8gYmUgcHJlLWZpbGxlZC5cbiAgXy5wYXJ0aWFsID0gZnVuY3Rpb24oZnVuYykge1xuICAgIHZhciBib3VuZEFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBvc2l0aW9uID0gMDtcbiAgICAgIHZhciBhcmdzID0gYm91bmRBcmdzLnNsaWNlKCk7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gYXJncy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYXJnc1tpXSA9PT0gXykgYXJnc1tpXSA9IGFyZ3VtZW50c1twb3NpdGlvbisrXTtcbiAgICAgIH1cbiAgICAgIHdoaWxlIChwb3NpdGlvbiA8IGFyZ3VtZW50cy5sZW5ndGgpIGFyZ3MucHVzaChhcmd1bWVudHNbcG9zaXRpb24rK10pO1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfTtcbiAgfTtcblxuICAvLyBCaW5kIGEgbnVtYmVyIG9mIGFuIG9iamVjdCdzIG1ldGhvZHMgdG8gdGhhdCBvYmplY3QuIFJlbWFpbmluZyBhcmd1bWVudHNcbiAgLy8gYXJlIHRoZSBtZXRob2QgbmFtZXMgdG8gYmUgYm91bmQuIFVzZWZ1bCBmb3IgZW5zdXJpbmcgdGhhdCBhbGwgY2FsbGJhY2tzXG4gIC8vIGRlZmluZWQgb24gYW4gb2JqZWN0IGJlbG9uZyB0byBpdC5cbiAgXy5iaW5kQWxsID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGksIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsIGtleTtcbiAgICBpZiAobGVuZ3RoIDw9IDEpIHRocm93IG5ldyBFcnJvcignYmluZEFsbCBtdXN0IGJlIHBhc3NlZCBmdW5jdGlvbiBuYW1lcycpO1xuICAgIGZvciAoaSA9IDE7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0gYXJndW1lbnRzW2ldO1xuICAgICAgb2JqW2tleV0gPSBfLmJpbmQob2JqW2tleV0sIG9iaik7XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG5cbiAgLy8gTWVtb2l6ZSBhbiBleHBlbnNpdmUgZnVuY3Rpb24gYnkgc3RvcmluZyBpdHMgcmVzdWx0cy5cbiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7XG4gICAgdmFyIG1lbW9pemUgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciBjYWNoZSA9IG1lbW9pemUuY2FjaGU7XG4gICAgICB2YXIgYWRkcmVzcyA9IGhhc2hlciA/IGhhc2hlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIDoga2V5O1xuICAgICAgaWYgKCFfLmhhcyhjYWNoZSwgYWRkcmVzcykpIGNhY2hlW2FkZHJlc3NdID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgcmV0dXJuIGNhY2hlW2FkZHJlc3NdO1xuICAgIH07XG4gICAgbWVtb2l6ZS5jYWNoZSA9IHt9O1xuICAgIHJldHVybiBtZW1vaXplO1xuICB9O1xuXG4gIC8vIERlbGF5cyBhIGZ1bmN0aW9uIGZvciB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcywgYW5kIHRoZW4gY2FsbHNcbiAgLy8gaXQgd2l0aCB0aGUgYXJndW1lbnRzIHN1cHBsaWVkLlxuICBfLmRlbGF5ID0gZnVuY3Rpb24oZnVuYywgd2FpdCkge1xuICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xuICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gZnVuYy5hcHBseShudWxsLCBhcmdzKTtcbiAgICB9LCB3YWl0KTtcbiAgfTtcblxuICAvLyBEZWZlcnMgYSBmdW5jdGlvbiwgc2NoZWR1bGluZyBpdCB0byBydW4gYWZ0ZXIgdGhlIGN1cnJlbnQgY2FsbCBzdGFjayBoYXNcbiAgLy8gY2xlYXJlZC5cbiAgXy5kZWZlciA9IGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICByZXR1cm4gXy5kZWxheS5hcHBseShfLCBbZnVuYywgMV0uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSkpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgd2hlbiBpbnZva2VkLCB3aWxsIG9ubHkgYmUgdHJpZ2dlcmVkIGF0IG1vc3Qgb25jZVxuICAvLyBkdXJpbmcgYSBnaXZlbiB3aW5kb3cgb2YgdGltZS4gTm9ybWFsbHksIHRoZSB0aHJvdHRsZWQgZnVuY3Rpb24gd2lsbCBydW5cbiAgLy8gYXMgbXVjaCBhcyBpdCBjYW4sIHdpdGhvdXQgZXZlciBnb2luZyBtb3JlIHRoYW4gb25jZSBwZXIgYHdhaXRgIGR1cmF0aW9uO1xuICAvLyBidXQgaWYgeW91J2QgbGlrZSB0byBkaXNhYmxlIHRoZSBleGVjdXRpb24gb24gdGhlIGxlYWRpbmcgZWRnZSwgcGFzc1xuICAvLyBge2xlYWRpbmc6IGZhbHNlfWAuIFRvIGRpc2FibGUgZXhlY3V0aW9uIG9uIHRoZSB0cmFpbGluZyBlZGdlLCBkaXR0by5cbiAgXy50aHJvdHRsZSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQsIG9wdGlvbnMpIHtcbiAgICB2YXIgY29udGV4dCwgYXJncywgcmVzdWx0O1xuICAgIHZhciB0aW1lb3V0ID0gbnVsbDtcbiAgICB2YXIgcHJldmlvdXMgPSAwO1xuICAgIGlmICghb3B0aW9ucykgb3B0aW9ucyA9IHt9O1xuICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcHJldmlvdXMgPSBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlID8gMCA6IF8ubm93KCk7XG4gICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBub3cgPSBfLm5vdygpO1xuICAgICAgaWYgKCFwcmV2aW91cyAmJiBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlKSBwcmV2aW91cyA9IG5vdztcbiAgICAgIHZhciByZW1haW5pbmcgPSB3YWl0IC0gKG5vdyAtIHByZXZpb3VzKTtcbiAgICAgIGNvbnRleHQgPSB0aGlzO1xuICAgICAgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIGlmIChyZW1haW5pbmcgPD0gMCB8fCByZW1haW5pbmcgPiB3YWl0KSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIHByZXZpb3VzID0gbm93O1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgIH0gZWxzZSBpZiAoIXRpbWVvdXQgJiYgb3B0aW9ucy50cmFpbGluZyAhPT0gZmFsc2UpIHtcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHJlbWFpbmluZyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdFxuICAvLyBiZSB0cmlnZ2VyZWQuIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBhZnRlciBpdCBzdG9wcyBiZWluZyBjYWxsZWQgZm9yXG4gIC8vIE4gbWlsbGlzZWNvbmRzLiBJZiBgaW1tZWRpYXRlYCBpcyBwYXNzZWQsIHRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZVxuICAvLyBsZWFkaW5nIGVkZ2UsIGluc3RlYWQgb2YgdGhlIHRyYWlsaW5nLlxuICBfLmRlYm91bmNlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgaW1tZWRpYXRlKSB7XG4gICAgdmFyIHRpbWVvdXQsIGFyZ3MsIGNvbnRleHQsIHRpbWVzdGFtcCwgcmVzdWx0O1xuXG4gICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbGFzdCA9IF8ubm93KCkgLSB0aW1lc3RhbXA7XG5cbiAgICAgIGlmIChsYXN0IDwgd2FpdCAmJiBsYXN0ID4gMCkge1xuICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCAtIGxhc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICAgIGlmICghaW1tZWRpYXRlKSB7XG4gICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICBjb250ZXh0ID0gdGhpcztcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICB0aW1lc3RhbXAgPSBfLm5vdygpO1xuICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICBpZiAoIXRpbWVvdXQpIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbiAgICAgIGlmIChjYWxsTm93KSB7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgdGhlIGZpcnN0IGZ1bmN0aW9uIHBhc3NlZCBhcyBhbiBhcmd1bWVudCB0byB0aGUgc2Vjb25kLFxuICAvLyBhbGxvd2luZyB5b3UgdG8gYWRqdXN0IGFyZ3VtZW50cywgcnVuIGNvZGUgYmVmb3JlIGFuZCBhZnRlciwgYW5kXG4gIC8vIGNvbmRpdGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uXG4gIF8ud3JhcCA9IGZ1bmN0aW9uKGZ1bmMsIHdyYXBwZXIpIHtcbiAgICByZXR1cm4gXy5wYXJ0aWFsKHdyYXBwZXIsIGZ1bmMpO1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBuZWdhdGVkIHZlcnNpb24gb2YgdGhlIHBhc3NlZC1pbiBwcmVkaWNhdGUuXG4gIF8ubmVnYXRlID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICFwcmVkaWNhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGlzIHRoZSBjb21wb3NpdGlvbiBvZiBhIGxpc3Qgb2YgZnVuY3Rpb25zLCBlYWNoXG4gIC8vIGNvbnN1bWluZyB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmdW5jdGlvbiB0aGF0IGZvbGxvd3MuXG4gIF8uY29tcG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgIHZhciBzdGFydCA9IGFyZ3MubGVuZ3RoIC0gMTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaSA9IHN0YXJ0O1xuICAgICAgdmFyIHJlc3VsdCA9IGFyZ3Nbc3RhcnRdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB3aGlsZSAoaS0tKSByZXN1bHQgPSBhcmdzW2ldLmNhbGwodGhpcywgcmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfTtcblxuICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgYWZ0ZXIgYmVpbmcgY2FsbGVkIE4gdGltZXMuXG4gIF8uYWZ0ZXIgPSBmdW5jdGlvbih0aW1lcywgZnVuYykge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICgtLXRpbWVzIDwgMSkge1xuICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGJlIGV4ZWN1dGVkIGJlZm9yZSBiZWluZyBjYWxsZWQgTiB0aW1lcy5cbiAgXy5iZWZvcmUgPSBmdW5jdGlvbih0aW1lcywgZnVuYykge1xuICAgIHZhciBtZW1vO1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICgtLXRpbWVzID4gMCkge1xuICAgICAgICBtZW1vID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVuYyA9IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVtbztcbiAgICB9O1xuICB9O1xuXG4gIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgYXQgbW9zdCBvbmUgdGltZSwgbm8gbWF0dGVyIGhvd1xuICAvLyBvZnRlbiB5b3UgY2FsbCBpdC4gVXNlZnVsIGZvciBsYXp5IGluaXRpYWxpemF0aW9uLlxuICBfLm9uY2UgPSBfLnBhcnRpYWwoXy5iZWZvcmUsIDIpO1xuXG4gIC8vIE9iamVjdCBGdW5jdGlvbnNcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIFJldHJpZXZlIHRoZSBuYW1lcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLlxuICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgT2JqZWN0LmtleXNgXG4gIF8ua2V5cyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghXy5pc09iamVjdChvYmopKSByZXR1cm4gW107XG4gICAgaWYgKG5hdGl2ZUtleXMpIHJldHVybiBuYXRpdmVLZXlzKG9iaik7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSBpZiAoXy5oYXMob2JqLCBrZXkpKSBrZXlzLnB1c2goa2V5KTtcbiAgICByZXR1cm4ga2V5cztcbiAgfTtcblxuICAvLyBSZXRyaWV2ZSB0aGUgdmFsdWVzIG9mIGFuIG9iamVjdCdzIHByb3BlcnRpZXMuXG4gIF8udmFsdWVzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTtcbiAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbHVlcyA9IEFycmF5KGxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFsdWVzW2ldID0gb2JqW2tleXNbaV1dO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWVzO1xuICB9O1xuXG4gIC8vIENvbnZlcnQgYW4gb2JqZWN0IGludG8gYSBsaXN0IG9mIGBba2V5LCB2YWx1ZV1gIHBhaXJzLlxuICBfLnBhaXJzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTtcbiAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHBhaXJzID0gQXJyYXkobGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBwYWlyc1tpXSA9IFtrZXlzW2ldLCBvYmpba2V5c1tpXV1dO1xuICAgIH1cbiAgICByZXR1cm4gcGFpcnM7XG4gIH07XG5cbiAgLy8gSW52ZXJ0IHRoZSBrZXlzIGFuZCB2YWx1ZXMgb2YgYW4gb2JqZWN0LiBUaGUgdmFsdWVzIG11c3QgYmUgc2VyaWFsaXphYmxlLlxuICBfLmludmVydCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbb2JqW2tleXNbaV1dXSA9IGtleXNbaV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgc29ydGVkIGxpc3Qgb2YgdGhlIGZ1bmN0aW9uIG5hbWVzIGF2YWlsYWJsZSBvbiB0aGUgb2JqZWN0LlxuICAvLyBBbGlhc2VkIGFzIGBtZXRob2RzYFxuICBfLmZ1bmN0aW9ucyA9IF8ubWV0aG9kcyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBuYW1lcyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChfLmlzRnVuY3Rpb24ob2JqW2tleV0pKSBuYW1lcy5wdXNoKGtleSk7XG4gICAgfVxuICAgIHJldHVybiBuYW1lcy5zb3J0KCk7XG4gIH07XG5cbiAgLy8gRXh0ZW5kIGEgZ2l2ZW4gb2JqZWN0IHdpdGggYWxsIHRoZSBwcm9wZXJ0aWVzIGluIHBhc3NlZC1pbiBvYmplY3QocykuXG4gIF8uZXh0ZW5kID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKCFfLmlzT2JqZWN0KG9iaikpIHJldHVybiBvYmo7XG4gICAgdmFyIHNvdXJjZSwgcHJvcDtcbiAgICBmb3IgKHZhciBpID0gMSwgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICBmb3IgKHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwgcHJvcCkpIHtcbiAgICAgICAgICAgIG9ialtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xuICB9O1xuXG4gIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCBvbmx5IGNvbnRhaW5pbmcgdGhlIHdoaXRlbGlzdGVkIHByb3BlcnRpZXMuXG4gIF8ucGljayA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICB2YXIgcmVzdWx0ID0ge30sIGtleTtcbiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHQ7XG4gICAgaWYgKF8uaXNGdW5jdGlvbihpdGVyYXRlZSkpIHtcbiAgICAgIGl0ZXJhdGVlID0gY3JlYXRlQ2FsbGJhY2soaXRlcmF0ZWUsIGNvbnRleHQpO1xuICAgICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICBpZiAoaXRlcmF0ZWUodmFsdWUsIGtleSwgb2JqKSkgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGtleXMgPSBjb25jYXQuYXBwbHkoW10sIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XG4gICAgICBvYmogPSBuZXcgT2JqZWN0KG9iaik7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBrZXkgPSBrZXlzW2ldO1xuICAgICAgICBpZiAoa2V5IGluIG9iaikgcmVzdWx0W2tleV0gPSBvYmpba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICAgLy8gUmV0dXJuIGEgY29weSBvZiB0aGUgb2JqZWN0IHdpdGhvdXQgdGhlIGJsYWNrbGlzdGVkIHByb3BlcnRpZXMuXG4gIF8ub21pdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHtcbiAgICBpZiAoXy5pc0Z1bmN0aW9uKGl0ZXJhdGVlKSkge1xuICAgICAgaXRlcmF0ZWUgPSBfLm5lZ2F0ZShpdGVyYXRlZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBrZXlzID0gXy5tYXAoY29uY2F0LmFwcGx5KFtdLCBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpLCBTdHJpbmcpO1xuICAgICAgaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIHJldHVybiAhXy5jb250YWlucyhrZXlzLCBrZXkpO1xuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIF8ucGljayhvYmosIGl0ZXJhdGVlLCBjb250ZXh0KTtcbiAgfTtcblxuICAvLyBGaWxsIGluIGEgZ2l2ZW4gb2JqZWN0IHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzLlxuICBfLmRlZmF1bHRzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgaWYgKCFfLmlzT2JqZWN0KG9iaikpIHJldHVybiBvYmo7XG4gICAgZm9yICh2YXIgaSA9IDEsIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChvYmpbcHJvcF0gPT09IHZvaWQgMCkgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xuICB9O1xuXG4gIC8vIENyZWF0ZSBhIChzaGFsbG93LWNsb25lZCkgZHVwbGljYXRlIG9mIGFuIG9iamVjdC5cbiAgXy5jbG9uZSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmICghXy5pc09iamVjdChvYmopKSByZXR1cm4gb2JqO1xuICAgIHJldHVybiBfLmlzQXJyYXkob2JqKSA/IG9iai5zbGljZSgpIDogXy5leHRlbmQoe30sIG9iaik7XG4gIH07XG5cbiAgLy8gSW52b2tlcyBpbnRlcmNlcHRvciB3aXRoIHRoZSBvYmosIGFuZCB0aGVuIHJldHVybnMgb2JqLlxuICAvLyBUaGUgcHJpbWFyeSBwdXJwb3NlIG9mIHRoaXMgbWV0aG9kIGlzIHRvIFwidGFwIGludG9cIiBhIG1ldGhvZCBjaGFpbiwgaW5cbiAgLy8gb3JkZXIgdG8gcGVyZm9ybSBvcGVyYXRpb25zIG9uIGludGVybWVkaWF0ZSByZXN1bHRzIHdpdGhpbiB0aGUgY2hhaW4uXG4gIF8udGFwID0gZnVuY3Rpb24ob2JqLCBpbnRlcmNlcHRvcikge1xuICAgIGludGVyY2VwdG9yKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcblxuICAvLyBJbnRlcm5hbCByZWN1cnNpdmUgY29tcGFyaXNvbiBmdW5jdGlvbiBmb3IgYGlzRXF1YWxgLlxuICB2YXIgZXEgPSBmdW5jdGlvbihhLCBiLCBhU3RhY2ssIGJTdGFjaykge1xuICAgIC8vIElkZW50aWNhbCBvYmplY3RzIGFyZSBlcXVhbC4gYDAgPT09IC0wYCwgYnV0IHRoZXkgYXJlbid0IGlkZW50aWNhbC5cbiAgICAvLyBTZWUgdGhlIFtIYXJtb255IGBlZ2FsYCBwcm9wb3NhbF0oaHR0cDovL3dpa2kuZWNtYXNjcmlwdC5vcmcvZG9rdS5waHA/aWQ9aGFybW9ueTplZ2FsKS5cbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT09IDEgLyBiO1xuICAgIC8vIEEgc3RyaWN0IGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5IGJlY2F1c2UgYG51bGwgPT0gdW5kZWZpbmVkYC5cbiAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7XG4gICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuXG4gICAgaWYgKGEgaW5zdGFuY2VvZiBfKSBhID0gYS5fd3JhcHBlZDtcbiAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkO1xuICAgIC8vIENvbXBhcmUgYFtbQ2xhc3NdXWAgbmFtZXMuXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSk7XG4gICAgaWYgKGNsYXNzTmFtZSAhPT0gdG9TdHJpbmcuY2FsbChiKSkgcmV0dXJuIGZhbHNlO1xuICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICAvLyBTdHJpbmdzLCBudW1iZXJzLCByZWd1bGFyIGV4cHJlc3Npb25zLCBkYXRlcywgYW5kIGJvb2xlYW5zIGFyZSBjb21wYXJlZCBieSB2YWx1ZS5cbiAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6XG4gICAgICAvLyBSZWdFeHBzIGFyZSBjb2VyY2VkIHRvIHN0cmluZ3MgZm9yIGNvbXBhcmlzb24gKE5vdGU6ICcnICsgL2EvaSA9PT0gJy9hL2knKVxuICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGBcIjVcImAgaXNcbiAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZyhcIjVcIilgLlxuICAgICAgICByZXR1cm4gJycgKyBhID09PSAnJyArIGI7XG4gICAgICBjYXNlICdbb2JqZWN0IE51bWJlcl0nOlxuICAgICAgICAvLyBgTmFOYHMgYXJlIGVxdWl2YWxlbnQsIGJ1dCBub24tcmVmbGV4aXZlLlxuICAgICAgICAvLyBPYmplY3QoTmFOKSBpcyBlcXVpdmFsZW50IHRvIE5hTlxuICAgICAgICBpZiAoK2EgIT09ICthKSByZXR1cm4gK2IgIT09ICtiO1xuICAgICAgICAvLyBBbiBgZWdhbGAgY29tcGFyaXNvbiBpcyBwZXJmb3JtZWQgZm9yIG90aGVyIG51bWVyaWMgdmFsdWVzLlxuICAgICAgICByZXR1cm4gK2EgPT09IDAgPyAxIC8gK2EgPT09IDEgLyBiIDogK2EgPT09ICtiO1xuICAgICAgY2FzZSAnW29iamVjdCBEYXRlXSc6XG4gICAgICBjYXNlICdbb2JqZWN0IEJvb2xlYW5dJzpcbiAgICAgICAgLy8gQ29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1lcmljIHByaW1pdGl2ZSB2YWx1ZXMuIERhdGVzIGFyZSBjb21wYXJlZCBieSB0aGVpclxuICAgICAgICAvLyBtaWxsaXNlY29uZCByZXByZXNlbnRhdGlvbnMuIE5vdGUgdGhhdCBpbnZhbGlkIGRhdGVzIHdpdGggbWlsbGlzZWNvbmQgcmVwcmVzZW50YXRpb25zXG4gICAgICAgIC8vIG9mIGBOYU5gIGFyZSBub3QgZXF1aXZhbGVudC5cbiAgICAgICAgcmV0dXJuICthID09PSArYjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhICE9ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gQXNzdW1lIGVxdWFsaXR5IGZvciBjeWNsaWMgc3RydWN0dXJlcy4gVGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpY1xuICAgIC8vIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMSBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gLlxuICAgIHZhciBsZW5ndGggPSBhU3RhY2subGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgLy8gTGluZWFyIHNlYXJjaC4gUGVyZm9ybWFuY2UgaXMgaW52ZXJzZWx5IHByb3BvcnRpb25hbCB0byB0aGUgbnVtYmVyIG9mXG4gICAgICAvLyB1bmlxdWUgbmVzdGVkIHN0cnVjdHVyZXMuXG4gICAgICBpZiAoYVN0YWNrW2xlbmd0aF0gPT09IGEpIHJldHVybiBiU3RhY2tbbGVuZ3RoXSA9PT0gYjtcbiAgICB9XG4gICAgLy8gT2JqZWN0cyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVpdmFsZW50LCBidXQgYE9iamVjdGBzXG4gICAgLy8gZnJvbSBkaWZmZXJlbnQgZnJhbWVzIGFyZS5cbiAgICB2YXIgYUN0b3IgPSBhLmNvbnN0cnVjdG9yLCBiQ3RvciA9IGIuY29uc3RydWN0b3I7XG4gICAgaWYgKFxuICAgICAgYUN0b3IgIT09IGJDdG9yICYmXG4gICAgICAvLyBIYW5kbGUgT2JqZWN0LmNyZWF0ZSh4KSBjYXNlc1xuICAgICAgJ2NvbnN0cnVjdG9yJyBpbiBhICYmICdjb25zdHJ1Y3RvcicgaW4gYiAmJlxuICAgICAgIShfLmlzRnVuY3Rpb24oYUN0b3IpICYmIGFDdG9yIGluc3RhbmNlb2YgYUN0b3IgJiZcbiAgICAgICAgXy5pc0Z1bmN0aW9uKGJDdG9yKSAmJiBiQ3RvciBpbnN0YW5jZW9mIGJDdG9yKVxuICAgICkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnB1c2goYSk7XG4gICAgYlN0YWNrLnB1c2goYik7XG4gICAgdmFyIHNpemUsIHJlc3VsdDtcbiAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cy5cbiAgICBpZiAoY2xhc3NOYW1lID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAvLyBDb21wYXJlIGFycmF5IGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeS5cbiAgICAgIHNpemUgPSBhLmxlbmd0aDtcbiAgICAgIHJlc3VsdCA9IHNpemUgPT09IGIubGVuZ3RoO1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBEZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzLlxuICAgICAgICB3aGlsZSAoc2l6ZS0tKSB7XG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gZXEoYVtzaXplXSwgYltzaXplXSwgYVN0YWNrLCBiU3RhY2spKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVlcCBjb21wYXJlIG9iamVjdHMuXG4gICAgICB2YXIga2V5cyA9IF8ua2V5cyhhKSwga2V5O1xuICAgICAgc2l6ZSA9IGtleXMubGVuZ3RoO1xuICAgICAgLy8gRW5zdXJlIHRoYXQgYm90aCBvYmplY3RzIGNvbnRhaW4gdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXMgYmVmb3JlIGNvbXBhcmluZyBkZWVwIGVxdWFsaXR5LlxuICAgICAgcmVzdWx0ID0gXy5rZXlzKGIpLmxlbmd0aCA9PT0gc2l6ZTtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgd2hpbGUgKHNpemUtLSkge1xuICAgICAgICAgIC8vIERlZXAgY29tcGFyZSBlYWNoIG1lbWJlclxuICAgICAgICAgIGtleSA9IGtleXNbc2l6ZV07XG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gXy5oYXMoYiwga2V5KSAmJiBlcShhW2tleV0sIGJba2V5XSwgYVN0YWNrLCBiU3RhY2spKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBvYmplY3QgZnJvbSB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgYVN0YWNrLnBvcCgpO1xuICAgIGJTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIC8vIFBlcmZvcm0gYSBkZWVwIGNvbXBhcmlzb24gdG8gY2hlY2sgaWYgdHdvIG9iamVjdHMgYXJlIGVxdWFsLlxuICBfLmlzRXF1YWwgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIGVxKGEsIGIsIFtdLCBbXSk7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiBhcnJheSwgc3RyaW5nLCBvciBvYmplY3QgZW1wdHk/XG4gIC8vIEFuIFwiZW1wdHlcIiBvYmplY3QgaGFzIG5vIGVudW1lcmFibGUgb3duLXByb3BlcnRpZXMuXG4gIF8uaXNFbXB0eSA9IGZ1bmN0aW9uKG9iaikge1xuICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHRydWU7XG4gICAgaWYgKF8uaXNBcnJheShvYmopIHx8IF8uaXNTdHJpbmcob2JqKSB8fCBfLmlzQXJndW1lbnRzKG9iaikpIHJldHVybiBvYmoubGVuZ3RoID09PSAwO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChfLmhhcyhvYmosIGtleSkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgRE9NIGVsZW1lbnQ/XG4gIF8uaXNFbGVtZW50ID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuICEhKG9iaiAmJiBvYmoubm9kZVR5cGUgPT09IDEpO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYW4gYXJyYXk/XG4gIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5XG4gIF8uaXNBcnJheSA9IG5hdGl2ZUlzQXJyYXkgfHwgZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcblxuICAvLyBJcyBhIGdpdmVuIHZhcmlhYmxlIGFuIG9iamVjdD9cbiAgXy5pc09iamVjdCA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciB0eXBlID0gdHlwZW9mIG9iajtcbiAgICByZXR1cm4gdHlwZSA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlID09PSAnb2JqZWN0JyAmJiAhIW9iajtcbiAgfTtcblxuICAvLyBBZGQgc29tZSBpc1R5cGUgbWV0aG9kczogaXNBcmd1bWVudHMsIGlzRnVuY3Rpb24sIGlzU3RyaW5nLCBpc051bWJlciwgaXNEYXRlLCBpc1JlZ0V4cC5cbiAgXy5lYWNoKFsnQXJndW1lbnRzJywgJ0Z1bmN0aW9uJywgJ1N0cmluZycsICdOdW1iZXInLCAnRGF0ZScsICdSZWdFeHAnXSwgZnVuY3Rpb24obmFtZSkge1xuICAgIF9bJ2lzJyArIG5hbWVdID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCAnICsgbmFtZSArICddJztcbiAgICB9O1xuICB9KTtcblxuICAvLyBEZWZpbmUgYSBmYWxsYmFjayB2ZXJzaW9uIG9mIHRoZSBtZXRob2QgaW4gYnJvd3NlcnMgKGFoZW0sIElFKSwgd2hlcmVcbiAgLy8gdGhlcmUgaXNuJ3QgYW55IGluc3BlY3RhYmxlIFwiQXJndW1lbnRzXCIgdHlwZS5cbiAgaWYgKCFfLmlzQXJndW1lbnRzKGFyZ3VtZW50cykpIHtcbiAgICBfLmlzQXJndW1lbnRzID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICByZXR1cm4gXy5oYXMob2JqLCAnY2FsbGVlJyk7XG4gICAgfTtcbiAgfVxuXG4gIC8vIE9wdGltaXplIGBpc0Z1bmN0aW9uYCBpZiBhcHByb3ByaWF0ZS4gV29yayBhcm91bmQgYW4gSUUgMTEgYnVnLlxuICBpZiAodHlwZW9mIC8uLyAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTtcbiAgICB9O1xuICB9XG5cbiAgLy8gSXMgYSBnaXZlbiBvYmplY3QgYSBmaW5pdGUgbnVtYmVyP1xuICBfLmlzRmluaXRlID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlKG9iaikgJiYgIWlzTmFOKHBhcnNlRmxvYXQob2JqKSk7XG4gIH07XG5cbiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyAoTmFOIGlzIHRoZSBvbmx5IG51bWJlciB3aGljaCBkb2VzIG5vdCBlcXVhbCBpdHNlbGYpLlxuICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIF8uaXNOdW1iZXIob2JqKSAmJiBvYmogIT09ICtvYmo7XG4gIH07XG5cbiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/XG4gIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdHJ1ZSB8fCBvYmogPT09IGZhbHNlIHx8IHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQm9vbGVhbl0nO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFsdWUgZXF1YWwgdG8gbnVsbD9cbiAgXy5pc051bGwgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBudWxsO1xuICB9O1xuXG4gIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkP1xuICBfLmlzVW5kZWZpbmVkID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgcmV0dXJuIG9iaiA9PT0gdm9pZCAwO1xuICB9O1xuXG4gIC8vIFNob3J0Y3V0IGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gcHJvcGVydHkgZGlyZWN0bHlcbiAgLy8gb24gaXRzZWxmIChpbiBvdGhlciB3b3Jkcywgbm90IG9uIGEgcHJvdG90eXBlKS5cbiAgXy5oYXMgPSBmdW5jdGlvbihvYmosIGtleSkge1xuICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbiAgfTtcblxuICAvLyBVdGlsaXR5IEZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIFJ1biBVbmRlcnNjb3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2YXJpYWJsZSB0byBpdHNcbiAgLy8gcHJldmlvdXMgb3duZXIuIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LlxuICBfLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHtcbiAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLy8gS2VlcCB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gYXJvdW5kIGZvciBkZWZhdWx0IGl0ZXJhdGVlcy5cbiAgXy5pZGVudGl0eSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9O1xuXG4gIF8uY29uc3RhbnQgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9O1xuICB9O1xuXG4gIF8ubm9vcCA9IGZ1bmN0aW9uKCl7fTtcblxuICBfLnByb3BlcnR5ID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUmV0dXJucyBhIHByZWRpY2F0ZSBmb3IgY2hlY2tpbmcgd2hldGhlciBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gc2V0IG9mIGBrZXk6dmFsdWVgIHBhaXJzLlxuICBfLm1hdGNoZXMgPSBmdW5jdGlvbihhdHRycykge1xuICAgIHZhciBwYWlycyA9IF8ucGFpcnMoYXR0cnMpLCBsZW5ndGggPSBwYWlycy5sZW5ndGg7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikge1xuICAgICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gIWxlbmd0aDtcbiAgICAgIG9iaiA9IG5ldyBPYmplY3Qob2JqKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpXSwga2V5ID0gcGFpclswXTtcbiAgICAgICAgaWYgKHBhaXJbMV0gIT09IG9ialtrZXldIHx8ICEoa2V5IGluIG9iaikpIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gIH07XG5cbiAgLy8gUnVuIGEgZnVuY3Rpb24gKipuKiogdGltZXMuXG4gIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRlZSwgY29udGV4dCkge1xuICAgIHZhciBhY2N1bSA9IEFycmF5KE1hdGgubWF4KDAsIG4pKTtcbiAgICBpdGVyYXRlZSA9IGNyZWF0ZUNhbGxiYWNrKGl0ZXJhdGVlLCBjb250ZXh0LCAxKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykgYWNjdW1baV0gPSBpdGVyYXRlZShpKTtcbiAgICByZXR1cm4gYWNjdW07XG4gIH07XG5cbiAgLy8gUmV0dXJuIGEgcmFuZG9tIGludGVnZXIgYmV0d2VlbiBtaW4gYW5kIG1heCAoaW5jbHVzaXZlKS5cbiAgXy5yYW5kb20gPSBmdW5jdGlvbihtaW4sIG1heCkge1xuICAgIGlmIChtYXggPT0gbnVsbCkge1xuICAgICAgbWF4ID0gbWluO1xuICAgICAgbWluID0gMDtcbiAgICB9XG4gICAgcmV0dXJuIG1pbiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSk7XG4gIH07XG5cbiAgLy8gQSAocG9zc2libHkgZmFzdGVyKSB3YXkgdG8gZ2V0IHRoZSBjdXJyZW50IHRpbWVzdGFtcCBhcyBhbiBpbnRlZ2VyLlxuICBfLm5vdyA9IERhdGUubm93IHx8IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgfTtcblxuICAgLy8gTGlzdCBvZiBIVE1MIGVudGl0aWVzIGZvciBlc2NhcGluZy5cbiAgdmFyIGVzY2FwZU1hcCA9IHtcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0OycsXG4gICAgJ1wiJzogJyZxdW90OycsXG4gICAgXCInXCI6ICcmI3gyNzsnLFxuICAgICdgJzogJyYjeDYwOydcbiAgfTtcbiAgdmFyIHVuZXNjYXBlTWFwID0gXy5pbnZlcnQoZXNjYXBlTWFwKTtcblxuICAvLyBGdW5jdGlvbnMgZm9yIGVzY2FwaW5nIGFuZCB1bmVzY2FwaW5nIHN0cmluZ3MgdG8vZnJvbSBIVE1MIGludGVycG9sYXRpb24uXG4gIHZhciBjcmVhdGVFc2NhcGVyID0gZnVuY3Rpb24obWFwKSB7XG4gICAgdmFyIGVzY2FwZXIgPSBmdW5jdGlvbihtYXRjaCkge1xuICAgICAgcmV0dXJuIG1hcFttYXRjaF07XG4gICAgfTtcbiAgICAvLyBSZWdleGVzIGZvciBpZGVudGlmeWluZyBhIGtleSB0aGF0IG5lZWRzIHRvIGJlIGVzY2FwZWRcbiAgICB2YXIgc291cmNlID0gJyg/OicgKyBfLmtleXMobWFwKS5qb2luKCd8JykgKyAnKSc7XG4gICAgdmFyIHRlc3RSZWdleHAgPSBSZWdFeHAoc291cmNlKTtcbiAgICB2YXIgcmVwbGFjZVJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UsICdnJyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykge1xuICAgICAgc3RyaW5nID0gc3RyaW5nID09IG51bGwgPyAnJyA6ICcnICsgc3RyaW5nO1xuICAgICAgcmV0dXJuIHRlc3RSZWdleHAudGVzdChzdHJpbmcpID8gc3RyaW5nLnJlcGxhY2UocmVwbGFjZVJlZ2V4cCwgZXNjYXBlcikgOiBzdHJpbmc7XG4gICAgfTtcbiAgfTtcbiAgXy5lc2NhcGUgPSBjcmVhdGVFc2NhcGVyKGVzY2FwZU1hcCk7XG4gIF8udW5lc2NhcGUgPSBjcmVhdGVFc2NhcGVyKHVuZXNjYXBlTWFwKTtcblxuICAvLyBJZiB0aGUgdmFsdWUgb2YgdGhlIG5hbWVkIGBwcm9wZXJ0eWAgaXMgYSBmdW5jdGlvbiB0aGVuIGludm9rZSBpdCB3aXRoIHRoZVxuICAvLyBgb2JqZWN0YCBhcyBjb250ZXh0OyBvdGhlcndpc2UsIHJldHVybiBpdC5cbiAgXy5yZXN1bHQgPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgaWYgKG9iamVjdCA9PSBudWxsKSByZXR1cm4gdm9pZCAwO1xuICAgIHZhciB2YWx1ZSA9IG9iamVjdFtwcm9wZXJ0eV07XG4gICAgcmV0dXJuIF8uaXNGdW5jdGlvbih2YWx1ZSkgPyBvYmplY3RbcHJvcGVydHldKCkgOiB2YWx1ZTtcbiAgfTtcblxuICAvLyBHZW5lcmF0ZSBhIHVuaXF1ZSBpbnRlZ2VyIGlkICh1bmlxdWUgd2l0aGluIHRoZSBlbnRpcmUgY2xpZW50IHNlc3Npb24pLlxuICAvLyBVc2VmdWwgZm9yIHRlbXBvcmFyeSBET00gaWRzLlxuICB2YXIgaWRDb3VudGVyID0gMDtcbiAgXy51bmlxdWVJZCA9IGZ1bmN0aW9uKHByZWZpeCkge1xuICAgIHZhciBpZCA9ICsraWRDb3VudGVyICsgJyc7XG4gICAgcmV0dXJuIHByZWZpeCA/IHByZWZpeCArIGlkIDogaWQ7XG4gIH07XG5cbiAgLy8gQnkgZGVmYXVsdCwgVW5kZXJzY29yZSB1c2VzIEVSQi1zdHlsZSB0ZW1wbGF0ZSBkZWxpbWl0ZXJzLCBjaGFuZ2UgdGhlXG4gIC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRpdmUgZGVsaW1pdGVycy5cbiAgXy50ZW1wbGF0ZVNldHRpbmdzID0ge1xuICAgIGV2YWx1YXRlICAgIDogLzwlKFtcXHNcXFNdKz8pJT4vZyxcbiAgICBpbnRlcnBvbGF0ZSA6IC88JT0oW1xcc1xcU10rPyklPi9nLFxuICAgIGVzY2FwZSAgICAgIDogLzwlLShbXFxzXFxTXSs/KSU+L2dcbiAgfTtcblxuICAvLyBXaGVuIGN1c3RvbWl6aW5nIGB0ZW1wbGF0ZVNldHRpbmdzYCwgaWYgeW91IGRvbid0IHdhbnQgdG8gZGVmaW5lIGFuXG4gIC8vIGludGVycG9sYXRpb24sIGV2YWx1YXRpb24gb3IgZXNjYXBpbmcgcmVnZXgsIHdlIG5lZWQgb25lIHRoYXQgaXNcbiAgLy8gZ3VhcmFudGVlZCBub3QgdG8gbWF0Y2guXG4gIHZhciBub01hdGNoID0gLyguKV4vO1xuXG4gIC8vIENlcnRhaW4gY2hhcmFjdGVycyBuZWVkIHRvIGJlIGVzY2FwZWQgc28gdGhhdCB0aGV5IGNhbiBiZSBwdXQgaW50byBhXG4gIC8vIHN0cmluZyBsaXRlcmFsLlxuICB2YXIgZXNjYXBlcyA9IHtcbiAgICBcIidcIjogICAgICBcIidcIixcbiAgICAnXFxcXCc6ICAgICAnXFxcXCcsXG4gICAgJ1xccic6ICAgICAncicsXG4gICAgJ1xcbic6ICAgICAnbicsXG4gICAgJ1xcdTIwMjgnOiAndTIwMjgnLFxuICAgICdcXHUyMDI5JzogJ3UyMDI5J1xuICB9O1xuXG4gIHZhciBlc2NhcGVyID0gL1xcXFx8J3xcXHJ8XFxufFxcdTIwMjh8XFx1MjAyOS9nO1xuXG4gIHZhciBlc2NhcGVDaGFyID0gZnVuY3Rpb24obWF0Y2gpIHtcbiAgICByZXR1cm4gJ1xcXFwnICsgZXNjYXBlc1ttYXRjaF07XG4gIH07XG5cbiAgLy8gSmF2YVNjcmlwdCBtaWNyby10ZW1wbGF0aW5nLCBzaW1pbGFyIHRvIEpvaG4gUmVzaWcncyBpbXBsZW1lbnRhdGlvbi5cbiAgLy8gVW5kZXJzY29yZSB0ZW1wbGF0aW5nIGhhbmRsZXMgYXJiaXRyYXJ5IGRlbGltaXRlcnMsIHByZXNlcnZlcyB3aGl0ZXNwYWNlLFxuICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS5cbiAgLy8gTkI6IGBvbGRTZXR0aW5nc2Agb25seSBleGlzdHMgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LlxuICBfLnRlbXBsYXRlID0gZnVuY3Rpb24odGV4dCwgc2V0dGluZ3MsIG9sZFNldHRpbmdzKSB7XG4gICAgaWYgKCFzZXR0aW5ncyAmJiBvbGRTZXR0aW5ncykgc2V0dGluZ3MgPSBvbGRTZXR0aW5ncztcbiAgICBzZXR0aW5ncyA9IF8uZGVmYXVsdHMoe30sIHNldHRpbmdzLCBfLnRlbXBsYXRlU2V0dGluZ3MpO1xuXG4gICAgLy8gQ29tYmluZSBkZWxpbWl0ZXJzIGludG8gb25lIHJlZ3VsYXIgZXhwcmVzc2lvbiB2aWEgYWx0ZXJuYXRpb24uXG4gICAgdmFyIG1hdGNoZXIgPSBSZWdFeHAoW1xuICAgICAgKHNldHRpbmdzLmVzY2FwZSB8fCBub01hdGNoKS5zb3VyY2UsXG4gICAgICAoc2V0dGluZ3MuaW50ZXJwb2xhdGUgfHwgbm9NYXRjaCkuc291cmNlLFxuICAgICAgKHNldHRpbmdzLmV2YWx1YXRlIHx8IG5vTWF0Y2gpLnNvdXJjZVxuICAgIF0uam9pbignfCcpICsgJ3wkJywgJ2cnKTtcblxuICAgIC8vIENvbXBpbGUgdGhlIHRlbXBsYXRlIHNvdXJjZSwgZXNjYXBpbmcgc3RyaW5nIGxpdGVyYWxzIGFwcHJvcHJpYXRlbHkuXG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgc291cmNlID0gXCJfX3ArPSdcIjtcbiAgICB0ZXh0LnJlcGxhY2UobWF0Y2hlciwgZnVuY3Rpb24obWF0Y2gsIGVzY2FwZSwgaW50ZXJwb2xhdGUsIGV2YWx1YXRlLCBvZmZzZXQpIHtcbiAgICAgIHNvdXJjZSArPSB0ZXh0LnNsaWNlKGluZGV4LCBvZmZzZXQpLnJlcGxhY2UoZXNjYXBlciwgZXNjYXBlQ2hhcik7XG4gICAgICBpbmRleCA9IG9mZnNldCArIG1hdGNoLmxlbmd0aDtcblxuICAgICAgaWYgKGVzY2FwZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInK1xcbigoX190PShcIiArIGVzY2FwZSArIFwiKSk9PW51bGw/Jyc6Xy5lc2NhcGUoX190KSkrXFxuJ1wiO1xuICAgICAgfSBlbHNlIGlmIChpbnRlcnBvbGF0ZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInK1xcbigoX190PShcIiArIGludGVycG9sYXRlICsgXCIpKT09bnVsbD8nJzpfX3QpK1xcbidcIjtcbiAgICAgIH0gZWxzZSBpZiAoZXZhbHVhdGUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJztcXG5cIiArIGV2YWx1YXRlICsgXCJcXG5fX3ArPSdcIjtcbiAgICAgIH1cblxuICAgICAgLy8gQWRvYmUgVk1zIG5lZWQgdGhlIG1hdGNoIHJldHVybmVkIHRvIHByb2R1Y2UgdGhlIGNvcnJlY3Qgb2ZmZXN0LlxuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0pO1xuICAgIHNvdXJjZSArPSBcIic7XFxuXCI7XG5cbiAgICAvLyBJZiBhIHZhcmlhYmxlIGlzIG5vdCBzcGVjaWZpZWQsIHBsYWNlIGRhdGEgdmFsdWVzIGluIGxvY2FsIHNjb3BlLlxuICAgIGlmICghc2V0dGluZ3MudmFyaWFibGUpIHNvdXJjZSA9ICd3aXRoKG9ianx8e30pe1xcbicgKyBzb3VyY2UgKyAnfVxcbic7XG5cbiAgICBzb3VyY2UgPSBcInZhciBfX3QsX19wPScnLF9faj1BcnJheS5wcm90b3R5cGUuam9pbixcIiArXG4gICAgICBcInByaW50PWZ1bmN0aW9uKCl7X19wKz1fX2ouY2FsbChhcmd1bWVudHMsJycpO307XFxuXCIgK1xuICAgICAgc291cmNlICsgJ3JldHVybiBfX3A7XFxuJztcblxuICAgIHRyeSB7XG4gICAgICB2YXIgcmVuZGVyID0gbmV3IEZ1bmN0aW9uKHNldHRpbmdzLnZhcmlhYmxlIHx8ICdvYmonLCAnXycsIHNvdXJjZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZS5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aHJvdyBlO1xuICAgIH1cblxuICAgIHZhciB0ZW1wbGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHJldHVybiByZW5kZXIuY2FsbCh0aGlzLCBkYXRhLCBfKTtcbiAgICB9O1xuXG4gICAgLy8gUHJvdmlkZSB0aGUgY29tcGlsZWQgc291cmNlIGFzIGEgY29udmVuaWVuY2UgZm9yIHByZWNvbXBpbGF0aW9uLlxuICAgIHZhciBhcmd1bWVudCA9IHNldHRpbmdzLnZhcmlhYmxlIHx8ICdvYmonO1xuICAgIHRlbXBsYXRlLnNvdXJjZSA9ICdmdW5jdGlvbignICsgYXJndW1lbnQgKyAnKXtcXG4nICsgc291cmNlICsgJ30nO1xuXG4gICAgcmV0dXJuIHRlbXBsYXRlO1xuICB9O1xuXG4gIC8vIEFkZCBhIFwiY2hhaW5cIiBmdW5jdGlvbi4gU3RhcnQgY2hhaW5pbmcgYSB3cmFwcGVkIFVuZGVyc2NvcmUgb2JqZWN0LlxuICBfLmNoYWluID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIGluc3RhbmNlID0gXyhvYmopO1xuICAgIGluc3RhbmNlLl9jaGFpbiA9IHRydWU7XG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9O1xuXG4gIC8vIE9PUFxuICAvLyAtLS0tLS0tLS0tLS0tLS1cbiAgLy8gSWYgVW5kZXJzY29yZSBpcyBjYWxsZWQgYXMgYSBmdW5jdGlvbiwgaXQgcmV0dXJucyBhIHdyYXBwZWQgb2JqZWN0IHRoYXRcbiAgLy8gY2FuIGJlIHVzZWQgT08tc3R5bGUuIFRoaXMgd3JhcHBlciBob2xkcyBhbHRlcmVkIHZlcnNpb25zIG9mIGFsbCB0aGVcbiAgLy8gdW5kZXJzY29yZSBmdW5jdGlvbnMuIFdyYXBwZWQgb2JqZWN0cyBtYXkgYmUgY2hhaW5lZC5cblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udGludWUgY2hhaW5pbmcgaW50ZXJtZWRpYXRlIHJlc3VsdHMuXG4gIHZhciByZXN1bHQgPSBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gdGhpcy5fY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajtcbiAgfTtcblxuICAvLyBBZGQgeW91ciBvd24gY3VzdG9tIGZ1bmN0aW9ucyB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuXG4gIF8ubWl4aW4gPSBmdW5jdGlvbihvYmopIHtcbiAgICBfLmVhY2goXy5mdW5jdGlvbnMob2JqKSwgZnVuY3Rpb24obmFtZSkge1xuICAgICAgdmFyIGZ1bmMgPSBfW25hbWVdID0gb2JqW25hbWVdO1xuICAgICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbdGhpcy5fd3JhcHBlZF07XG4gICAgICAgIHB1c2guYXBwbHkoYXJncywgYXJndW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIGZ1bmMuYXBwbHkoXywgYXJncykpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBBZGQgYWxsIG9mIHRoZSBVbmRlcnNjb3JlIGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlciBvYmplY3QuXG4gIF8ubWl4aW4oXyk7XG5cbiAgLy8gQWRkIGFsbCBtdXRhdG9yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci5cbiAgXy5lYWNoKFsncG9wJywgJ3B1c2gnLCAncmV2ZXJzZScsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTtcbiAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG9iaiA9IHRoaXMuX3dyYXBwZWQ7XG4gICAgICBtZXRob2QuYXBwbHkob2JqLCBhcmd1bWVudHMpO1xuICAgICAgaWYgKChuYW1lID09PSAnc2hpZnQnIHx8IG5hbWUgPT09ICdzcGxpY2UnKSAmJiBvYmoubGVuZ3RoID09PSAwKSBkZWxldGUgb2JqWzBdO1xuICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIG9iaik7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuXG4gIF8uZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgbWV0aG9kID0gQXJyYXlQcm90b1tuYW1lXTtcbiAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlc3VsdC5jYWxsKHRoaXMsIG1ldGhvZC5hcHBseSh0aGlzLl93cmFwcGVkLCBhcmd1bWVudHMpKTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBFeHRyYWN0cyB0aGUgcmVzdWx0IGZyb20gYSB3cmFwcGVkIGFuZCBjaGFpbmVkIG9iamVjdC5cbiAgXy5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5fd3JhcHBlZDtcbiAgfTtcblxuICAvLyBBTUQgcmVnaXN0cmF0aW9uIGhhcHBlbnMgYXQgdGhlIGVuZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIEFNRCBsb2FkZXJzXG4gIC8vIHRoYXQgbWF5IG5vdCBlbmZvcmNlIG5leHQtdHVybiBzZW1hbnRpY3Mgb24gbW9kdWxlcy4gRXZlbiB0aG91Z2ggZ2VuZXJhbFxuICAvLyBwcmFjdGljZSBmb3IgQU1EIHJlZ2lzdHJhdGlvbiBpcyB0byBiZSBhbm9ueW1vdXMsIHVuZGVyc2NvcmUgcmVnaXN0ZXJzXG4gIC8vIGFzIGEgbmFtZWQgbW9kdWxlIGJlY2F1c2UsIGxpa2UgalF1ZXJ5LCBpdCBpcyBhIGJhc2UgbGlicmFyeSB0aGF0IGlzXG4gIC8vIHBvcHVsYXIgZW5vdWdoIHRvIGJlIGJ1bmRsZWQgaW4gYSB0aGlyZCBwYXJ0eSBsaWIsIGJ1dCBub3QgYmUgcGFydCBvZlxuICAvLyBhbiBBTUQgbG9hZCByZXF1ZXN0LiBUaG9zZSBjYXNlcyBjb3VsZCBnZW5lcmF0ZSBhbiBlcnJvciB3aGVuIGFuXG4gIC8vIGFub255bW91cyBkZWZpbmUoKSBpcyBjYWxsZWQgb3V0c2lkZSBvZiBhIGxvYWRlciByZXF1ZXN0LlxuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKCd1bmRlcnNjb3JlJywgW10sIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIF87XG4gICAgfSk7XG4gIH1cbn0uY2FsbCh0aGlzKSk7XG5cbn0pKCkiLCIoZnVuY3Rpb24oZGVmaW5pdGlvbil7aWYodHlwZW9mIGV4cG9ydHM9PT1cIm9iamVjdFwiKXttb2R1bGUuZXhwb3J0cz1kZWZpbml0aW9uKCk7fWVsc2UgaWYodHlwZW9mIGRlZmluZT09PVwiZnVuY3Rpb25cIiYmZGVmaW5lLmFtZCl7ZGVmaW5lKGRlZmluaXRpb24pO31lbHNle21vcmk9ZGVmaW5pdGlvbigpO319KShmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe1xudmFyIGcsYWE9dGhpcztcbmZ1bmN0aW9uIG0oYSl7dmFyIGI9dHlwZW9mIGE7aWYoXCJvYmplY3RcIj09YilpZihhKXtpZihhIGluc3RhbmNlb2YgQXJyYXkpcmV0dXJuXCJhcnJheVwiO2lmKGEgaW5zdGFuY2VvZiBPYmplY3QpcmV0dXJuIGI7dmFyIGM9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpO2lmKFwiW29iamVjdCBXaW5kb3ddXCI9PWMpcmV0dXJuXCJvYmplY3RcIjtpZihcIltvYmplY3QgQXJyYXldXCI9PWN8fFwibnVtYmVyXCI9PXR5cGVvZiBhLmxlbmd0aCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEuc3BsaWNlJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5wcm9wZXJ0eUlzRW51bWVyYWJsZSYmIWEucHJvcGVydHlJc0VudW1lcmFibGUoXCJzcGxpY2VcIikpcmV0dXJuXCJhcnJheVwiO2lmKFwiW29iamVjdCBGdW5jdGlvbl1cIj09Y3x8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEuY2FsbCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEucHJvcGVydHlJc0VudW1lcmFibGUmJiFhLnByb3BlcnR5SXNFbnVtZXJhYmxlKFwiY2FsbFwiKSlyZXR1cm5cImZ1bmN0aW9uXCJ9ZWxzZSByZXR1cm5cIm51bGxcIjtlbHNlIGlmKFwiZnVuY3Rpb25cIj09XG5iJiZcInVuZGVmaW5lZFwiPT10eXBlb2YgYS5jYWxsKXJldHVyblwib2JqZWN0XCI7cmV0dXJuIGJ9dmFyIGJhPVwiY2xvc3VyZV91aWRfXCIrKDFFOSpNYXRoLnJhbmRvbSgpPj4+MCksY2E9MDtmdW5jdGlvbiBwKGEsYil7dmFyIGM9YS5zcGxpdChcIi5cIiksZD1hYTtjWzBdaW4gZHx8IWQuZXhlY1NjcmlwdHx8ZC5leGVjU2NyaXB0KFwidmFyIFwiK2NbMF0pO2Zvcih2YXIgZTtjLmxlbmd0aCYmKGU9Yy5zaGlmdCgpKTspYy5sZW5ndGh8fHZvaWQgMD09PWI/ZD1kW2VdP2RbZV06ZFtlXT17fTpkW2VdPWJ9O2Z1bmN0aW9uIGRhKGEsYil7Zm9yKHZhciBjIGluIGEpYi5jYWxsKHZvaWQgMCxhW2NdLGMsYSl9O2Z1bmN0aW9uIGVhKGEsYil7bnVsbCE9YSYmdGhpcy5hcHBlbmQuYXBwbHkodGhpcyxhcmd1bWVudHMpfWVhLnByb3RvdHlwZS5WYT1cIlwiO2VhLnByb3RvdHlwZS5hcHBlbmQ9ZnVuY3Rpb24oYSxiLGMpe3RoaXMuVmErPWE7aWYobnVsbCE9Yilmb3IodmFyIGQ9MTtkPGFyZ3VtZW50cy5sZW5ndGg7ZCsrKXRoaXMuVmErPWFyZ3VtZW50c1tkXTtyZXR1cm4gdGhpc307ZWEucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuVmF9O2Z1bmN0aW9uIGZhKGEsYil7YS5zb3J0KGJ8fGdhKX1mdW5jdGlvbiBoYShhLGIpe2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWFbY109e2luZGV4OmMsdmFsdWU6YVtjXX07dmFyIGQ9Ynx8Z2E7ZmEoYSxmdW5jdGlvbihhLGIpe3JldHVybiBkKGEudmFsdWUsYi52YWx1ZSl8fGEuaW5kZXgtYi5pbmRleH0pO2ZvcihjPTA7YzxhLmxlbmd0aDtjKyspYVtjXT1hW2NdLnZhbHVlfWZ1bmN0aW9uIGdhKGEsYil7cmV0dXJuIGE+Yj8xOmE8Yj8tMTowfTt2YXIgaWE9bnVsbCxqYT1udWxsO2Z1bmN0aW9uIGthKCl7cmV0dXJuIG5ldyBsYShudWxsLDUsW21hLCEwLG9hLCEwLHBhLCExLHFhLCExLHJhLGlhXSxudWxsKX1mdW5jdGlvbiByKGEpe3JldHVybiBudWxsIT1hJiYhMSE9PWF9ZnVuY3Rpb24gc2EoYSl7cmV0dXJuIHIoYSk/ITE6ITB9ZnVuY3Rpb24gcyhhLGIpe3JldHVybiBhW20obnVsbD09Yj9udWxsOmIpXT8hMDphLl8/ITA6dT8hMTpudWxsfWZ1bmN0aW9uIHRhKGEpe3JldHVybiBudWxsPT1hP251bGw6YS5jb25zdHJ1Y3Rvcn1mdW5jdGlvbiB4KGEsYil7dmFyIGM9dGEoYiksYz1yKHIoYyk/Yy5EYjpjKT9jLkJiOm0oYik7cmV0dXJuIEVycm9yKFtcIk5vIHByb3RvY29sIG1ldGhvZCBcIixhLFwiIGRlZmluZWQgZm9yIHR5cGUgXCIsYyxcIjogXCIsYl0uam9pbihcIlwiKSl9ZnVuY3Rpb24gdWEoYSl7dmFyIGI9YS5CYjtyZXR1cm4gcihiKT9iOlwiXCIrQS5iKGEpfVxuZnVuY3Rpb24gdmEoYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9QXJyYXkoYiksZD0wOzspaWYoZDxiKWNbZF09YVtkXSxkKz0xO2Vsc2UgYnJlYWs7cmV0dXJuIGN9ZnVuY3Rpb24gd2EoYSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyl9XG52YXIgeGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIEMuYz9DLmMoZnVuY3Rpb24oYSxiKXthLnB1c2goYik7cmV0dXJuIGF9LFtdLGIpOkMuY2FsbChudWxsLGZ1bmN0aW9uKGEsYil7YS5wdXNoKGIpO3JldHVybiBhfSxbXSxiKX1mdW5jdGlvbiBiKGEpe3JldHVybiBjLmEobnVsbCxhKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLDAsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHlhPXt9LHphPXt9O1xuZnVuY3Rpb24gQWEoYSl7aWYoYT9hLkw6YSlyZXR1cm4gYS5MKGEpO3ZhciBiO2I9QWFbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1BYS5fLCFiKSl0aHJvdyB4KFwiSUNvdW50ZWQuLWNvdW50XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIEJhKGEpe2lmKGE/YS5JOmEpcmV0dXJuIGEuSShhKTt2YXIgYjtiPUJhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9QmEuXywhYikpdGhyb3cgeChcIklFbXB0eWFibGVDb2xsZWN0aW9uLi1lbXB0eVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgQ2E9e307ZnVuY3Rpb24gRGEoYSxiKXtpZihhP2EuRzphKXJldHVybiBhLkcoYSxiKTt2YXIgYztjPURhW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9RGEuXywhYykpdGhyb3cgeChcIklDb2xsZWN0aW9uLi1jb25qXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG52YXIgRWE9e30sRD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKGE/YS5hYTphKXJldHVybiBhLmFhKGEsYixjKTt2YXIgaDtoPURbbShudWxsPT1hP251bGw6YSldO2lmKCFoJiYoaD1ELl8sIWgpKXRocm93IHgoXCJJSW5kZXhlZC4tbnRoXCIsYSk7cmV0dXJuIGguY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBiKGEsYil7aWYoYT9hLko6YSlyZXR1cm4gYS5KKGEsYik7dmFyIGM7Yz1EW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9RC5fLCFjKSl0aHJvdyB4KFwiSUluZGV4ZWQuLW50aFwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksXG5GYT17fTtmdW5jdGlvbiBIYShhKXtpZihhP2EuUTphKXJldHVybiBhLlEoYSk7dmFyIGI7Yj1IYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUhhLl8sIWIpKXRocm93IHgoXCJJU2VxLi1maXJzdFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBJYShhKXtpZihhP2EuUzphKXJldHVybiBhLlMoYSk7dmFyIGI7Yj1JYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUlhLl8sIWIpKXRocm93IHgoXCJJU2VxLi1yZXN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxudmFyIEphPXt9LEthPXt9LExhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7aWYoYT9hLkM6YSlyZXR1cm4gYS5DKGEsYixjKTt2YXIgaDtoPUxhW20obnVsbD09YT9udWxsOmEpXTtpZighaCYmKGg9TGEuXywhaCkpdGhyb3cgeChcIklMb29rdXAuLWxvb2t1cFwiLGEpO3JldHVybiBoLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gYihhLGIpe2lmKGE/YS51OmEpcmV0dXJuIGEudShhLGIpO3ZhciBjO2M9TGFbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1MYS5fLCFjKSl0aHJvdyB4KFwiSUxvb2t1cC4tbG9va3VwXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9XG5hO3JldHVybiBjfSgpLE1hPXt9O2Z1bmN0aW9uIE5hKGEsYil7aWYoYT9hLmtiOmEpcmV0dXJuIGEua2IoYSxiKTt2YXIgYztjPU5hW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9TmEuXywhYykpdGhyb3cgeChcIklBc3NvY2lhdGl2ZS4tY29udGFpbnMta2V5P1wiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIE9hKGEsYixjKXtpZihhP2EudWE6YSlyZXR1cm4gYS51YShhLGIsYyk7dmFyIGQ7ZD1PYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWQmJihkPU9hLl8sIWQpKXRocm93IHgoXCJJQXNzb2NpYXRpdmUuLWFzc29jXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX12YXIgUGE9e307ZnVuY3Rpb24gUWEoYSxiKXtpZihhP2EubmI6YSlyZXR1cm4gYS5uYihhLGIpO3ZhciBjO2M9UWFbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1RYS5fLCFjKSl0aHJvdyB4KFwiSU1hcC4tZGlzc29jXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9dmFyIFNhPXt9O1xuZnVuY3Rpb24gVGEoYSl7aWYoYT9hLiRhOmEpcmV0dXJuIGEuJGEoYSk7dmFyIGI7Yj1UYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPVRhLl8sIWIpKXRocm93IHgoXCJJTWFwRW50cnkuLWtleVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBVYShhKXtpZihhP2EuYWI6YSlyZXR1cm4gYS5hYihhKTt2YXIgYjtiPVVhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9VWEuXywhYikpdGhyb3cgeChcIklNYXBFbnRyeS4tdmFsXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBWYT17fTtmdW5jdGlvbiBXYShhLGIpe2lmKGE/YS52YjphKXJldHVybiBhLnZiKGEsYik7dmFyIGM7Yz1XYVttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPVdhLl8sIWMpKXRocm93IHgoXCJJU2V0Li1kaXNqb2luXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG5mdW5jdGlvbiBYYShhKXtpZihhP2EuSWE6YSlyZXR1cm4gYS5JYShhKTt2YXIgYjtiPVhhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9WGEuXywhYikpdGhyb3cgeChcIklTdGFjay4tcGVla1wiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBZYShhKXtpZihhP2EuSmE6YSlyZXR1cm4gYS5KYShhKTt2YXIgYjtiPVlhW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9WWEuXywhYikpdGhyb3cgeChcIklTdGFjay4tcG9wXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBaYT17fTtmdW5jdGlvbiAkYShhLGIsYyl7aWYoYT9hLlBhOmEpcmV0dXJuIGEuUGEoYSxiLGMpO3ZhciBkO2Q9JGFbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD0kYS5fLCFkKSl0aHJvdyB4KFwiSVZlY3Rvci4tYXNzb2MtblwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9XG5mdW5jdGlvbiBhYihhKXtpZihhP2EudWI6YSlyZXR1cm4gYS51YihhKTt2YXIgYjtiPWFiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9YWIuXywhYikpdGhyb3cgeChcIklEZXJlZi4tZGVyZWZcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIGJiPXt9O2Z1bmN0aW9uIGNiKGEpe2lmKGE/YS5EOmEpcmV0dXJuIGEuRChhKTt2YXIgYjtiPWNiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9Y2IuXywhYikpdGhyb3cgeChcIklNZXRhLi1tZXRhXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfXZhciBkYj17fTtmdW5jdGlvbiBlYihhLGIpe2lmKGE/YS5GOmEpcmV0dXJuIGEuRihhLGIpO3ZhciBjO2M9ZWJbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1lYi5fLCFjKSl0aHJvdyB4KFwiSVdpdGhNZXRhLi13aXRoLW1ldGFcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1cbnZhciBmYj17fSxnYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe2lmKGE/YS5NOmEpcmV0dXJuIGEuTShhLGIsYyk7dmFyIGg7aD1nYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWgmJihoPWdiLl8sIWgpKXRocm93IHgoXCJJUmVkdWNlLi1yZWR1Y2VcIixhKTtyZXR1cm4gaC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIGIoYSxiKXtpZihhP2EuTjphKXJldHVybiBhLk4oYSxiKTt2YXIgYztjPWdiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9Z2IuXywhYykpdGhyb3cgeChcIklSZWR1Y2UuLXJlZHVjZVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBoYihhLGIsYyl7aWYoYT9hLlphOmEpcmV0dXJuIGEuWmEoYSxiLGMpO3ZhciBkO2Q9aGJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1oYi5fLCFkKSl0aHJvdyB4KFwiSUtWUmVkdWNlLi1rdi1yZWR1Y2VcIixhKTtyZXR1cm4gZC5jYWxsKG51bGwsYSxiLGMpfWZ1bmN0aW9uIGliKGEsYil7aWYoYT9hLnY6YSlyZXR1cm4gYS52KGEsYik7dmFyIGM7Yz1pYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPWliLl8sIWMpKXRocm93IHgoXCJJRXF1aXYuLWVxdWl2XCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gamIoYSl7aWYoYT9hLkI6YSlyZXR1cm4gYS5CKGEpO3ZhciBiO2I9amJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1qYi5fLCFiKSl0aHJvdyB4KFwiSUhhc2guLWhhc2hcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9dmFyIGtiPXt9O1xuZnVuY3Rpb24gbGIoYSl7aWYoYT9hLkg6YSlyZXR1cm4gYS5IKGEpO3ZhciBiO2I9bGJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1sYi5fLCFiKSl0aHJvdyB4KFwiSVNlcWFibGUuLXNlcVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX12YXIgbWI9e30sbmI9e30sb2I9e307ZnVuY3Rpb24gcGIoYSl7aWYoYT9hLlhhOmEpcmV0dXJuIGEuWGEoYSk7dmFyIGI7Yj1wYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPXBiLl8sIWIpKXRocm93IHgoXCJJUmV2ZXJzaWJsZS4tcnNlcVwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBxYihhLGIpe2lmKGE/YS55YjphKXJldHVybiBhLnliKGEsYik7dmFyIGM7Yz1xYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPXFiLl8sIWMpKXRocm93IHgoXCJJU29ydGVkLi1zb3J0ZWQtc2VxXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG5mdW5jdGlvbiByYihhLGIsYyl7aWYoYT9hLnpiOmEpcmV0dXJuIGEuemIoYSxiLGMpO3ZhciBkO2Q9cmJbbShudWxsPT1hP251bGw6YSldO2lmKCFkJiYoZD1yYi5fLCFkKSl0aHJvdyB4KFwiSVNvcnRlZC4tc29ydGVkLXNlcS1mcm9tXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBzYihhLGIpe2lmKGE/YS54YjphKXJldHVybiBhLnhiKGEsYik7dmFyIGM7Yz1zYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPXNiLl8sIWMpKXRocm93IHgoXCJJU29ydGVkLi1lbnRyeS1rZXlcIixhKTtyZXR1cm4gYy5jYWxsKG51bGwsYSxiKX1mdW5jdGlvbiB0YihhKXtpZihhP2Eud2I6YSlyZXR1cm4gYS53YihhKTt2YXIgYjtiPXRiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9dGIuXywhYikpdGhyb3cgeChcIklTb3J0ZWQuLWNvbXBhcmF0b3JcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG5mdW5jdGlvbiB1YihhLGIpe2lmKGE/YS5TYjphKXJldHVybiBhLlNiKDAsYik7dmFyIGM7Yz11YlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPXViLl8sIWMpKXRocm93IHgoXCJJV3JpdGVyLi13cml0ZVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfXZhciB2Yj17fTtmdW5jdGlvbiB3YihhLGIsYyl7aWYoYT9hLnc6YSlyZXR1cm4gYS53KGEsYixjKTt2YXIgZDtkPXdiW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9d2IuXywhZCkpdGhyb3cgeChcIklQcmludFdpdGhXcml0ZXIuLXByLXdyaXRlclwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24geGIoYSxiLGMpe2lmKGE/YS5SYjphKXJldHVybiBhLlJiKDAsYixjKTt2YXIgZDtkPXhiW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9eGIuXywhZCkpdGhyb3cgeChcIklXYXRjaGFibGUuLW5vdGlmeS13YXRjaGVzXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1cbmZ1bmN0aW9uIHliKGEpe2lmKGE/YS5XYTphKXJldHVybiBhLldhKGEpO3ZhciBiO2I9eWJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj15Yi5fLCFiKSl0aHJvdyB4KFwiSUVkaXRhYmxlQ29sbGVjdGlvbi4tYXMtdHJhbnNpZW50XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIHpiKGEsYil7aWYoYT9hLkthOmEpcmV0dXJuIGEuS2EoYSxiKTt2YXIgYztjPXpiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9emIuXywhYykpdGhyb3cgeChcIklUcmFuc2llbnRDb2xsZWN0aW9uLi1jb25qIVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIEFiKGEpe2lmKGE/YS5PYTphKXJldHVybiBhLk9hKGEpO3ZhciBiO2I9QWJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1BYi5fLCFiKSl0aHJvdyB4KFwiSVRyYW5zaWVudENvbGxlY3Rpb24uLXBlcnNpc3RlbnQhXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfVxuZnVuY3Rpb24gQmIoYSxiLGMpe2lmKGE/YS5jYjphKXJldHVybiBhLmNiKGEsYixjKTt2YXIgZDtkPUJiW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9QmIuXywhZCkpdGhyb3cgeChcIklUcmFuc2llbnRBc3NvY2lhdGl2ZS4tYXNzb2MhXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1mdW5jdGlvbiBDYihhLGIpe2lmKGE/YS5BYjphKXJldHVybiBhLkFiKGEsYik7dmFyIGM7Yz1DYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPUNiLl8sIWMpKXRocm93IHgoXCJJVHJhbnNpZW50TWFwLi1kaXNzb2MhXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gRGIoYSxiLGMpe2lmKGE/YS5QYjphKXJldHVybiBhLlBiKDAsYixjKTt2YXIgZDtkPURiW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9RGIuXywhZCkpdGhyb3cgeChcIklUcmFuc2llbnRWZWN0b3IuLWFzc29jLW4hXCIsYSk7cmV0dXJuIGQuY2FsbChudWxsLGEsYixjKX1cbmZ1bmN0aW9uIEViKGEpe2lmKGE/YS5RYjphKXJldHVybiBhLlFiKCk7dmFyIGI7Yj1FYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUViLl8sIWIpKXRocm93IHgoXCJJVHJhbnNpZW50VmVjdG9yLi1wb3AhXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIEZiKGEsYil7aWYoYT9hLk9iOmEpcmV0dXJuIGEuT2IoMCxiKTt2YXIgYztjPUZiW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9RmIuXywhYykpdGhyb3cgeChcIklUcmFuc2llbnRTZXQuLWRpc2pvaW4hXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9ZnVuY3Rpb24gR2IoYSl7aWYoYT9hLktiOmEpcmV0dXJuIGEuS2IoKTt2YXIgYjtiPUdiW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9R2IuXywhYikpdGhyb3cgeChcIklDaHVuay4tZHJvcC1maXJzdFwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIEhiKGEpe2lmKGE/YS5zYjphKXJldHVybiBhLnNiKGEpO3ZhciBiO2I9SGJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1IYi5fLCFiKSl0aHJvdyB4KFwiSUNodW5rZWRTZXEuLWNodW5rZWQtZmlyc3RcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9ZnVuY3Rpb24gSWIoYSl7aWYoYT9hLnRiOmEpcmV0dXJuIGEudGIoYSk7dmFyIGI7Yj1JYlttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUliLl8sIWIpKXRocm93IHgoXCJJQ2h1bmtlZFNlcS4tY2h1bmtlZC1yZXN0XCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIEpiKGEpe2lmKGE/YS5yYjphKXJldHVybiBhLnJiKGEpO3ZhciBiO2I9SmJbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1KYi5fLCFiKSl0aHJvdyB4KFwiSUNodW5rZWROZXh0Li1jaHVua2VkLW5leHRcIixhKTtyZXR1cm4gYi5jYWxsKG51bGwsYSl9XG5mdW5jdGlvbiBLYihhKXt0aGlzLnZjPWE7dGhpcy5xPTA7dGhpcy5pPTEwNzM3NDE4MjR9S2IucHJvdG90eXBlLlNiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMudmMuYXBwZW5kKGIpfTtmdW5jdGlvbiBMYihhKXt2YXIgYj1uZXcgZWE7YS53KG51bGwsbmV3IEtiKGIpLGthKCkpO3JldHVyblwiXCIrQS5iKGIpfXZhciBNYj1cInVuZGVmaW5lZFwiIT09dHlwZW9mIE1hdGguaW11bCYmMCE9PShNYXRoLmltdWwuYT9NYXRoLmltdWwuYSg0Mjk0OTY3Mjk1LDUpOk1hdGguaW11bC5jYWxsKG51bGwsNDI5NDk2NzI5NSw1KSk/ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTWF0aC5pbXVsKGEsYil9OmZ1bmN0aW9uKGEsYil7dmFyIGM9YSY2NTUzNSxkPWImNjU1MzU7cmV0dXJuIGMqZCsoKGE+Pj4xNiY2NTUzNSkqZCtjKihiPj4+MTYmNjU1MzUpPDwxNj4+PjApfDB9O2Z1bmN0aW9uIE5iKGEpe2E9TWIoYSwzNDMyOTE4MzUzKTtyZXR1cm4gTWIoYTw8MTV8YT4+Pi0xNSw0NjE4NDU5MDcpfVxuZnVuY3Rpb24gT2IoYSxiKXt2YXIgYz1hXmI7cmV0dXJuIE1iKGM8PDEzfGM+Pj4tMTMsNSkrMzg2NDI5MjE5Nn1mdW5jdGlvbiBQYihhLGIpe3ZhciBjPWFeYixjPU1iKGNeYz4+PjE2LDIyNDY4MjI1MDcpLGM9TWIoY15jPj4+MTMsMzI2NjQ4OTkwOSk7cmV0dXJuIGNeYz4+PjE2fXZhciBRYj17fSxSYj0wO2Z1bmN0aW9uIFNiKGEpezI1NTxSYiYmKFFiPXt9LFJiPTApO3ZhciBiPVFiW2FdO2lmKFwibnVtYmVyXCIhPT10eXBlb2YgYil7YTppZihudWxsIT1hKWlmKGI9YS5sZW5ndGgsMDxiKXtmb3IodmFyIGM9MCxkPTA7OylpZihjPGIpdmFyIGU9YysxLGQ9TWIoMzEsZCkrYS5jaGFyQ29kZUF0KGMpLGM9ZTtlbHNle2I9ZDticmVhayBhfWI9dm9pZCAwfWVsc2UgYj0wO2Vsc2UgYj0wO1FiW2FdPWI7UmIrPTF9cmV0dXJuIGE9Yn1cbmZ1bmN0aW9uIFRiKGEpe2EmJihhLmkmNDE5NDMwNHx8YS5EYyk/YT1hLkIobnVsbCk6XCJudW1iZXJcIj09PXR5cGVvZiBhP2E9TWF0aC5mbG9vcihhKSUyMTQ3NDgzNjQ3OiEwPT09YT9hPTE6ITE9PT1hP2E9MDpcInN0cmluZ1wiPT09dHlwZW9mIGE/KGE9U2IoYSksMCE9PWEmJihhPU5iKGEpLGE9T2IoMCxhKSxhPVBiKGEsNCkpKTphPW51bGw9PWE/MDp1P2piKGEpOm51bGw7cmV0dXJuIGF9XG5mdW5jdGlvbiBVYihhKXt2YXIgYjtiPWEubmFtZTt2YXIgYzthOntjPTE7Zm9yKHZhciBkPTA7OylpZihjPGIubGVuZ3RoKXt2YXIgZT1jKzIsZD1PYihkLE5iKGIuY2hhckNvZGVBdChjLTEpfGIuY2hhckNvZGVBdChjKTw8MTYpKTtjPWV9ZWxzZXtjPWQ7YnJlYWsgYX1jPXZvaWQgMH1jPTE9PT0oYi5sZW5ndGgmMSk/Y15OYihiLmNoYXJDb2RlQXQoYi5sZW5ndGgtMSkpOmM7Yj1QYihjLE1iKDIsYi5sZW5ndGgpKTthPVNiKGEuZmEpO3JldHVybiBiXmErMjY1NDQzNTc2OSsoYjw8NikrKGI+PjIpfVxuZnVuY3Rpb24gVmIoYSxiKXtpZihyKFdiLmE/V2IuYShhLGIpOldiLmNhbGwobnVsbCxhLGIpKSlyZXR1cm4gMDt2YXIgYz1zYShhLmZhKTtpZihyKGM/Yi5mYTpjKSlyZXR1cm4tMTtpZihyKGEuZmEpKXtpZihzYShiLmZhKSlyZXR1cm4gMTtjPVhiLmE/WGIuYShhLmZhLGIuZmEpOlhiLmNhbGwobnVsbCxhLmZhLGIuZmEpO3JldHVybiAwPT09Yz9YYi5hP1hiLmEoYS5uYW1lLGIubmFtZSk6WGIuY2FsbChudWxsLGEubmFtZSxiLm5hbWUpOmN9cmV0dXJuIFliP1hiLmE/WGIuYShhLm5hbWUsYi5uYW1lKTpYYi5jYWxsKG51bGwsYS5uYW1lLGIubmFtZSk6bnVsbH1mdW5jdGlvbiBaYihhLGIsYyxkLGUpe3RoaXMuZmE9YTt0aGlzLm5hbWU9Yjt0aGlzLk5hPWM7dGhpcy5VYT1kO3RoaXMuVz1lO3RoaXMuaT0yMTU0MTY4MzIxO3RoaXMucT00MDk2fWc9WmIucHJvdG90eXBlO2cudz1mdW5jdGlvbihhLGIpe3JldHVybiB1YihiLHRoaXMuTmEpfTtcbmcuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVWE7cmV0dXJuIG51bGwhPWE/YTp0aGlzLlVhPWE9VWIodGhpcyl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgWmIodGhpcy5mYSx0aGlzLm5hbWUsdGhpcy5OYSx0aGlzLlVhLGIpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfTtnLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBMYS5jKGMsdGhpcyxudWxsKTtjYXNlIDM6cmV0dXJuIExhLmMoYyx0aGlzLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiBMYS5jKGEsdGhpcyxudWxsKX07XG5nLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyhhLHRoaXMsYil9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBiIGluc3RhbmNlb2YgWmI/dGhpcy5OYT09PWIuTmE6ITF9O2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5OYX07dmFyICRiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3ZhciBjPW51bGwhPWE/XCJcIitBLmIoYSkrXCIvXCIrQS5iKGIpOmI7cmV0dXJuIG5ldyBaYihhLGIsYyxudWxsLG51bGwpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBaYj9hOmMuYShudWxsLGEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiBFKGEpe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7aWYoYSYmKGEuaSY4Mzg4NjA4fHxhLmhjKSlyZXR1cm4gYS5IKG51bGwpO2lmKGEgaW5zdGFuY2VvZiBBcnJheXx8XCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiAwPT09YS5sZW5ndGg/bnVsbDpuZXcgYWMoYSwwKTtpZihzKGtiLGEpKXJldHVybiBsYihhKTtpZih1KXRocm93IEVycm9yKFwiXCIrQS5iKGEpK1wiIGlzIG5vdCBJU2VxYWJsZVwiKTtyZXR1cm4gbnVsbH1mdW5jdGlvbiBGKGEpe2lmKG51bGw9PWEpcmV0dXJuIG51bGw7aWYoYSYmKGEuaSY2NHx8YS5iYikpcmV0dXJuIGEuUShudWxsKTthPUUoYSk7cmV0dXJuIG51bGw9PWE/bnVsbDpIYShhKX1mdW5jdGlvbiBHKGEpe3JldHVybiBudWxsIT1hP2EmJihhLmkmNjR8fGEuYmIpP2EuUyhudWxsKTooYT1FKGEpKT9JYShhKTpIOkh9ZnVuY3Rpb24gSShhKXtyZXR1cm4gbnVsbD09YT9udWxsOmEmJihhLmkmMTI4fHxhLm9iKT9hLlUobnVsbCk6RShHKGEpKX1cbnZhciBXYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbnVsbD09YT9udWxsPT1iOmE9PT1ifHxpYihhLGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtmb3IoOzspaWYoYi5hKGEsZCkpaWYoSShlKSlhPWQsZD1GKGUpLGU9SShlKTtlbHNlIHJldHVybiBiLmEoZCxGKGUpKTtlbHNlIHJldHVybiExfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuITA7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLFxuZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKCl7cmV0dXJuITB9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gYmMoYSxiKXt2YXIgYz1OYihhKSxjPU9iKDAsYyk7cmV0dXJuIFBiKGMsYil9ZnVuY3Rpb24gY2MoYSl7dmFyIGI9MCxjPTE7Zm9yKGE9RShhKTs7KWlmKG51bGwhPWEpYis9MSxjPU1iKDMxLGMpK1RiKEYoYSkpfDAsYT1JKGEpO2Vsc2UgcmV0dXJuIGJjKGMsYil9ZnVuY3Rpb24gZGMoYSl7dmFyIGI9MCxjPTA7Zm9yKGE9RShhKTs7KWlmKG51bGwhPWEpYis9MSxjPWMrVGIoRihhKSl8MCxhPUkoYSk7ZWxzZSByZXR1cm4gYmMoYyxiKX16YVtcIm51bGxcIl09ITA7QWFbXCJudWxsXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIDB9O1xuRGF0ZS5wcm90b3R5cGUudj1mdW5jdGlvbihhLGIpe3JldHVybiBiIGluc3RhbmNlb2YgRGF0ZSYmdGhpcy50b1N0cmluZygpPT09Yi50b1N0cmluZygpfTtpYi5udW1iZXI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWJ9O2JiW1wiZnVuY3Rpb25cIl09ITA7Y2JbXCJmdW5jdGlvblwiXT1mdW5jdGlvbigpe3JldHVybiBudWxsfTt5YVtcImZ1bmN0aW9uXCJdPSEwO2piLl89ZnVuY3Rpb24oYSl7cmV0dXJuIGFbYmFdfHwoYVtiYV09KytjYSl9O2Z1bmN0aW9uIGVjKGEpe3RoaXMubD1hO3RoaXMucT0wO3RoaXMuaT0zMjc2OH1lYy5wcm90b3R5cGUudWI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtmdW5jdGlvbiBmYyhhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIGVjfVxudmFyIGdjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkKXtmb3IodmFyIGw9QWEoYSk7OylpZihkPGwpe2M9Yi5hP2IuYShjLEQuYShhLGQpKTpiLmNhbGwobnVsbCxjLEQuYShhLGQpKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtkKz0xfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gYihhLGIsYyl7Zm9yKHZhciBkPUFhKGEpLGw9MDs7KWlmKGw8ZCl7Yz1iLmE/Yi5hKGMsRC5hKGEsbCkpOmIuY2FsbChudWxsLGMsRC5hKGEsbCkpO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2wrPTF9ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBjKGEsYil7dmFyIGM9QWEoYSk7aWYoMD09PWMpcmV0dXJuIGIubz9iLm8oKTpiLmNhbGwobnVsbCk7Zm9yKHZhciBkPUQuYShhLDApLGw9MTs7KWlmKGw8Yyl7ZD1iLmE/Yi5hKGQsRC5hKGEsbCkpOmIuY2FsbChudWxsLGQsRC5hKGEsbCkpO2lmKGZjKGQpKXJldHVybiBLLmI/Sy5iKGQpOksuY2FsbChudWxsLFxuZCk7bCs9MX1lbHNlIHJldHVybiBkfXZhciBkPW51bGwsZD1mdW5jdGlvbihkLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGYpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxmLGgpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxmLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYT1jO2QuYz1iO2Qubj1hO3JldHVybiBkfSgpLGhjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkKXtmb3IodmFyIGw9YS5sZW5ndGg7OylpZihkPGwpe2M9Yi5hP2IuYShjLGFbZF0pOmIuY2FsbChudWxsLGMsYVtkXSk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7ZCs9MX1lbHNlIHJldHVybiBjfWZ1bmN0aW9uIGIoYSxiLGMpe2Zvcih2YXIgZD1hLmxlbmd0aCxsPTA7OylpZihsPGQpe2M9Yi5hP2IuYShjLGFbbF0pOmIuY2FsbChudWxsLGMsXG5hW2xdKTtpZihmYyhjKSlyZXR1cm4gSy5iP0suYihjKTpLLmNhbGwobnVsbCxjKTtsKz0xfWVsc2UgcmV0dXJuIGN9ZnVuY3Rpb24gYyhhLGIpe3ZhciBjPWEubGVuZ3RoO2lmKDA9PT1hLmxlbmd0aClyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtmb3IodmFyIGQ9YVswXSxsPTE7OylpZihsPGMpe2Q9Yi5hP2IuYShkLGFbbF0pOmIuY2FsbChudWxsLGQsYVtsXSk7aWYoZmMoZCkpcmV0dXJuIEsuYj9LLmIoZCk6Sy5jYWxsKG51bGwsZCk7bCs9MX1lbHNlIHJldHVybiBkfXZhciBkPW51bGwsZD1mdW5jdGlvbihkLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGYpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxmLGgpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxmLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYT1jO2QuYz1iO2Qubj1hO3JldHVybiBkfSgpO1xuZnVuY3Rpb24gaWMoYSl7cmV0dXJuIGE/YS5pJjJ8fGEuWWI/ITA6YS5pPyExOnMoemEsYSk6cyh6YSxhKX1mdW5jdGlvbiBqYyhhKXtyZXR1cm4gYT9hLmkmMTZ8fGEuTGI/ITA6YS5pPyExOnMoRWEsYSk6cyhFYSxhKX1mdW5jdGlvbiBhYyhhLGIpe3RoaXMuZT1hO3RoaXMucD1iO3RoaXMuaT0xNjYxOTk1NTA7dGhpcy5xPTgxOTJ9Zz1hYy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5KPWZ1bmN0aW9uKGEsYil7dmFyIGM9Yit0aGlzLnA7cmV0dXJuIGM8dGhpcy5lLmxlbmd0aD90aGlzLmVbY106bnVsbH07Zy5hYT1mdW5jdGlvbihhLGIsYyl7YT1iK3RoaXMucDtyZXR1cm4gYTx0aGlzLmUubGVuZ3RoP3RoaXMuZVthXTpjfTtnLlU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wKzE8dGhpcy5lLmxlbmd0aD9uZXcgYWModGhpcy5lLHRoaXMucCsxKTpudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lLmxlbmd0aC10aGlzLnB9O1xuZy5YYT1mdW5jdGlvbigpe3ZhciBhPUFhKHRoaXMpO3JldHVybiAwPGE/bmV3IGtjKHRoaXMsYS0xLG51bGwpOm51bGx9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjLmE/bGMuYSh0aGlzLGIpOmxjLmNhbGwobnVsbCx0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gSH07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGhjLm4odGhpcy5lLGIsdGhpcy5lW3RoaXMucF0sdGhpcy5wKzEpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBoYy5uKHRoaXMuZSxiLGMsdGhpcy5wKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZVt0aGlzLnBdfTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wKzE8dGhpcy5lLmxlbmd0aD9uZXcgYWModGhpcy5lLHRoaXMucCsxKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307XG5nLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTS5hP00uYShiLHRoaXMpOk0uY2FsbChudWxsLGIsdGhpcyl9O1xudmFyIG1jPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBiPGEubGVuZ3RoP25ldyBhYyhhLGIpOm51bGx9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYy5hKGEsMCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxKPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBtYy5hKGEsYil9ZnVuY3Rpb24gYihhKXtyZXR1cm4gbWMuYShhLDApfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK1xuYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBrYyhhLGIsYyl7dGhpcy5qYj1hO3RoaXMucD1iO3RoaXMuaj1jO3RoaXMuaT0zMjM3NDk5MDt0aGlzLnE9ODE5Mn1nPWtjLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLnA/bmV3IGtjKHRoaXMuamIsdGhpcy5wLTEsbnVsbCk6bnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucCsxfTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gY2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYy5hP2xjLmEodGhpcyxiKTpsYy5jYWxsKG51bGwsdGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4uYT9OLmEoSCx0aGlzLmopOk4uY2FsbChudWxsLEgsdGhpcy5qKX07XG5nLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYT9uYy5hKGIsdGhpcyk6bmMuY2FsbChudWxsLGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmM/bmMuYyhiLGMsdGhpcyk6bmMuY2FsbChudWxsLGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIEQuYSh0aGlzLmpiLHRoaXMucCl9O2cuUz1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMucD9uZXcga2ModGhpcy5qYix0aGlzLnAtMSxudWxsKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBrYyh0aGlzLmpiLHRoaXMucCxiKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0uYT9NLmEoYix0aGlzKTpNLmNhbGwobnVsbCxiLHRoaXMpfTtmdW5jdGlvbiBvYyhhKXtmb3IoOzspe3ZhciBiPUkoYSk7aWYobnVsbCE9YilhPWI7ZWxzZSByZXR1cm4gRihhKX19aWIuXz1mdW5jdGlvbihhLGIpe3JldHVybiBhPT09Yn07XG52YXIgcGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG51bGwhPWE/RGEoYSxiKTpEYShILGIpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtmb3IoOzspaWYocihlKSlhPWIuYShhLGQpLGQ9RihlKSxlPUkoZSk7ZWxzZSByZXR1cm4gYi5hKGEsZCl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK1xuYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gcWMoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDpCYShhKX1mdW5jdGlvbiBPKGEpe2lmKG51bGwhPWEpaWYoYSYmKGEuaSYyfHxhLlliKSlhPWEuTChudWxsKTtlbHNlIGlmKGEgaW5zdGFuY2VvZiBBcnJheSlhPWEubGVuZ3RoO2Vsc2UgaWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKWE9YS5sZW5ndGg7ZWxzZSBpZihzKHphLGEpKWE9QWEoYSk7ZWxzZSBpZih1KWE6e2E9RShhKTtmb3IodmFyIGI9MDs7KXtpZihpYyhhKSl7YT1iK0FhKGEpO2JyZWFrIGF9YT1JKGEpO2IrPTF9YT12b2lkIDB9ZWxzZSBhPW51bGw7ZWxzZSBhPTA7cmV0dXJuIGF9XG52YXIgcmM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtmb3IoOzspe2lmKG51bGw9PWEpcmV0dXJuIGM7aWYoMD09PWIpcmV0dXJuIEUoYSk/RihhKTpjO2lmKGpjKGEpKXJldHVybiBELmMoYSxiLGMpO2lmKEUoYSkpYT1JKGEpLGItPTE7ZWxzZSByZXR1cm4gdT9jOm51bGx9fWZ1bmN0aW9uIGIoYSxiKXtmb3IoOzspe2lmKG51bGw9PWEpdGhyb3cgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO2lmKDA9PT1iKXtpZihFKGEpKXJldHVybiBGKGEpO3Rocm93IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kc1wiKTt9aWYoamMoYSkpcmV0dXJuIEQuYShhLGIpO2lmKEUoYSkpe3ZhciBjPUkoYSksaD1iLTE7YT1jO2I9aH1lbHNle2lmKHUpdGhyb3cgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO3JldHVybiBudWxsfX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsXG5jLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpLFA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtpZihcIm51bWJlclwiIT09dHlwZW9mIGIpdGhyb3cgRXJyb3IoXCJpbmRleCBhcmd1bWVudCB0byBudGggbXVzdCBiZSBhIG51bWJlci5cIik7aWYobnVsbD09YSlyZXR1cm4gYztpZihhJiYoYS5pJjE2fHxhLkxiKSlyZXR1cm4gYS5hYShudWxsLGIsYyk7aWYoYSBpbnN0YW5jZW9mIEFycmF5fHxcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIGI8YS5sZW5ndGg/YVtiXTpjO2lmKHMoRWEsYSkpcmV0dXJuIEQuYShhLGIpO2lmKGE/YS5pJjY0fHxhLmJifHwoYS5pPzA6cyhGYSxhKSk6cyhGYSxhKSlyZXR1cm4gcmMuYyhhLGIsYyk7aWYodSl0aHJvdyBFcnJvcihcIm50aCBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgdHlwZSBcIitBLmIodWEodGEoYSkpKSk7cmV0dXJuIG51bGx9ZnVuY3Rpb24gYihhLFxuYil7aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBiKXRocm93IEVycm9yKFwiaW5kZXggYXJndW1lbnQgdG8gbnRoIG11c3QgYmUgYSBudW1iZXJcIik7aWYobnVsbD09YSlyZXR1cm4gYTtpZihhJiYoYS5pJjE2fHxhLkxiKSlyZXR1cm4gYS5KKG51bGwsYik7aWYoYSBpbnN0YW5jZW9mIEFycmF5fHxcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIGI8YS5sZW5ndGg/YVtiXTpudWxsO2lmKHMoRWEsYSkpcmV0dXJuIEQuYShhLGIpO2lmKGE/YS5pJjY0fHxhLmJifHwoYS5pPzA6cyhGYSxhKSk6cyhGYSxhKSlyZXR1cm4gcmMuYShhLGIpO2lmKHUpdGhyb3cgRXJyb3IoXCJudGggbm90IHN1cHBvcnRlZCBvbiB0aGlzIHR5cGUgXCIrQS5iKHVhKHRhKGEpKSkpO3JldHVybiBudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK1xuYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxRPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIG51bGwhPWE/YSYmKGEuaSYyNTZ8fGEuTWIpP2EuQyhudWxsLGIsYyk6YSBpbnN0YW5jZW9mIEFycmF5P2I8YS5sZW5ndGg/YVtiXTpjOlwic3RyaW5nXCI9PT10eXBlb2YgYT9iPGEubGVuZ3RoP2FbYl06YzpzKEthLGEpP0xhLmMoYSxiLGMpOnU/YzpudWxsOmN9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBudWxsPT1hP251bGw6YSYmKGEuaSYyNTZ8fGEuTWIpP2EudShudWxsLGIpOmEgaW5zdGFuY2VvZiBBcnJheT9iPGEubGVuZ3RoP2FbYl06bnVsbDpcInN0cmluZ1wiPT09dHlwZW9mIGE/YjxhLmxlbmd0aD9hW2JdOm51bGw6cyhLYSxhKT9MYS5hKGEsYik6bnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxcbmMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksUj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBudWxsIT1hP09hKGEsYixjKTpzYy5hP3NjLmEoW2JdLFtjXSk6c2MuY2FsbChudWxsLFtiXSxbY10pfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGssbCl7dmFyIG49bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihuPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGssbil9ZnVuY3Rpb24gYyhhLGQsZSxsKXtmb3IoOzspaWYoYT1iLmMoYSxkLGUpLHIobCkpZD1GKGwpLGU9RihJKGwpKSxsPUkoSShsKSk7ZWxzZSByZXR1cm4gYX1hLms9MzthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGw9RihhKTthPUcoYSk7cmV0dXJuIGMoYixcbmQsbCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZixoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxiLGUsZik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxmLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTM7Yi5mPWMuZjtiLmM9YTtiLmQ9Yy5kO3JldHVybiBifSgpLHRjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBudWxsPT1hP251bGw6UWEoYSxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsbCl9ZnVuY3Rpb24gYyhhLGQsZSl7Zm9yKDs7KXtpZihudWxsPT1hKXJldHVybiBudWxsO2E9Yi5hKGEsZCk7XG5pZihyKGUpKWQ9RihlKSxlPUkoZSk7ZWxzZSByZXR1cm4gYX19YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIHVjKGEpe3ZhciBiPVwiZnVuY3Rpb25cIj09bShhKTtyZXR1cm4gYj9iOmE/cihyKG51bGwpP251bGw6YS5YYik/ITA6YS5DYj8hMTpzKHlhLGEpOnMoeWEsYSl9XG5mdW5jdGlvbiB2YyhhLGIpe3RoaXMuaD1hO3RoaXMuaj1iO3RoaXMucT0wO3RoaXMuaT0zOTMyMTd9Zz12Yy5wcm90b3R5cGU7XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLFJhLHdjKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnZhciB6PWEsej10aGlzO3JldHVybiB6Lmgubz96LmgubygpOnouaC5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gej1hLHo9dGhpcyx6LmguYj96LmguYihjKTp6LmguY2FsbChudWxsLGMpO2Nhc2UgMzpyZXR1cm4gej1hLHo9dGhpcyx6LmguYT96LmguYShjLGQpOnouaC5jYWxsKG51bGwsYyxkKTtjYXNlIDQ6cmV0dXJuIHo9YSx6PXRoaXMsei5oLmM/ei5oLmMoYyxkLGUpOnouaC5jYWxsKG51bGwsYyxkLGUpO2Nhc2UgNTpyZXR1cm4gej1hLHo9dGhpcyx6Lmgubj96LmgubihjLGQsZSxmKTp6LmguY2FsbChudWxsLGMsZCxlLGYpO2Nhc2UgNjpyZXR1cm4gej1hLHo9dGhpcyx6Lmgucz96LmgucyhjLGQsZSxmLGgpOnouaC5jYWxsKG51bGwsYyxkLGUsZixcbmgpO2Nhc2UgNzpyZXR1cm4gej1hLHo9dGhpcyx6LmguWD96LmguWChjLGQsZSxmLGgsayk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayk7Y2FzZSA4OnJldHVybiB6PWEsej10aGlzLHouaC5nYT96LmguZ2EoYyxkLGUsZixoLGssbCk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsKTtjYXNlIDk6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkdhP3ouaC5HYShjLGQsZSxmLGgsayxsLG4pOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuKTtjYXNlIDEwOnJldHVybiB6PWEsej10aGlzLHouaC5IYT96LmguSGEoYyxkLGUsZixoLGssbCxuLHEpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEpO2Nhc2UgMTE6cmV0dXJuIHo9YSx6PXRoaXMsei5oLnZhP3ouaC52YShjLGQsZSxmLGgsayxsLG4scSx0KTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQpO2Nhc2UgMTI6cmV0dXJuIHo9YSx6PXRoaXMsei5oLndhP3ouaC53YShjLGQsZSxmLGgsayxsLG4scSx0LHYpOlxuei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYpO2Nhc2UgMTM6cmV0dXJuIHo9YSx6PXRoaXMsei5oLnhhP3ouaC54YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk7Y2FzZSAxNDpyZXR1cm4gej1hLHo9dGhpcyx6LmgueWE/ei5oLnlhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk7Y2FzZSAxNTpyZXR1cm4gej1hLHo9dGhpcyx6LmguemE/ei5oLnphKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpO2Nhc2UgMTY6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkFhP3ouaC5BYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk7Y2FzZSAxNzpyZXR1cm4gej1hLHo9dGhpcyxcbnouaC5CYT96LmguQmEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTtjYXNlIDE4OnJldHVybiB6PWEsej10aGlzLHouaC5DYT96LmguQ2EoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTp6LmguY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWik7Y2FzZSAxOTpyZXR1cm4gej1hLHo9dGhpcyx6LmguRGE/ei5oLkRhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk6ei5oLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEpO2Nhc2UgMjA6cmV0dXJuIHo9YSx6PXRoaXMsei5oLkVhP3ouaC5FYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhKTtjYXNlIDIxOnJldHVybiB6PVxuYSx6PXRoaXMsei5oLkZhP3ouaC5GYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EsUmEpOnouaC5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLFJhKTtjYXNlIDIyOnJldHVybiB6PWEsej10aGlzLFMuYmM/Uy5iYyh6LmgsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLFJhLHdjKTpTLmNhbGwobnVsbCx6LmgsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLFJhLHdjKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cubz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmgubz90aGlzLmgubygpOnRoaXMuaC5jYWxsKG51bGwpfTtcbmcuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5oLmI/dGhpcy5oLmIoYSk6dGhpcy5oLmNhbGwobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuaC5hP3RoaXMuaC5hKGEsYik6dGhpcy5oLmNhbGwobnVsbCxhLGIpfTtnLmM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB0aGlzLmguYz90aGlzLmguYyhhLGIsYyk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyl9O2cubj1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5oLm4/dGhpcy5oLm4oYSxiLGMsZCk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkKX07Zy5zPWZ1bmN0aW9uKGEsYixjLGQsZSl7cmV0dXJuIHRoaXMuaC5zP3RoaXMuaC5zKGEsYixjLGQsZSk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUpfTtnLlg9ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3JldHVybiB0aGlzLmguWD90aGlzLmguWChhLGIsYyxkLGUsZik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZil9O1xuZy5nYT1mdW5jdGlvbihhLGIsYyxkLGUsZixoKXtyZXR1cm4gdGhpcy5oLmdhP3RoaXMuaC5nYShhLGIsYyxkLGUsZixoKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgpfTtnLkdhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayl7cmV0dXJuIHRoaXMuaC5HYT90aGlzLmguR2EoYSxiLGMsZCxlLGYsaCxrKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayl9O2cuSGE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwpe3JldHVybiB0aGlzLmguSGE/dGhpcy5oLkhhKGEsYixjLGQsZSxmLGgsayxsKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsKX07Zy52YT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuKXtyZXR1cm4gdGhpcy5oLnZhP3RoaXMuaC52YShhLGIsYyxkLGUsZixoLGssbCxuKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4pfTtcbmcud2E9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxKXtyZXR1cm4gdGhpcy5oLndhP3RoaXMuaC53YShhLGIsYyxkLGUsZixoLGssbCxuLHEpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxKX07Zy54YT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCl7cmV0dXJuIHRoaXMuaC54YT90aGlzLmgueGEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQpfTtnLnlhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYpe3JldHVybiB0aGlzLmgueWE/dGhpcy5oLnlhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYpOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdil9O1xuZy56YT1mdW5jdGlvbihhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpe3JldHVybiB0aGlzLmguemE/dGhpcy5oLnphKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpfTtnLkFhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KXtyZXR1cm4gdGhpcy5oLkFhP3RoaXMuaC5BYShhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSl9O2cuQmE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQil7cmV0dXJuIHRoaXMuaC5CYT90aGlzLmguQmEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQik6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKX07XG5nLkNhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCl7cmV0dXJuIHRoaXMuaC5DYT90aGlzLmguQ2EoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCl9O2cuRGE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpe3JldHVybiB0aGlzLmguRGE/dGhpcy5oLkRhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTp0aGlzLmguY2FsbChudWxsLGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKX07XG5nLkVhPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFope3JldHVybiB0aGlzLmguRWE/dGhpcy5oLkVhKGEsYixjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopOnRoaXMuaC5jYWxsKG51bGwsYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWil9O2cuRmE9ZnVuY3Rpb24oYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSl7cmV0dXJuIHRoaXMuaC5GYT90aGlzLmguRmEoYSxiLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk6dGhpcy5oLmNhbGwobnVsbCxhLGIsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKX07Zy5YYj0hMDtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHZjKHRoaXMuaCxiKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07XG5mdW5jdGlvbiBOKGEsYil7cmV0dXJuIHVjKGEpJiYhKGE/YS5pJjI2MjE0NHx8YS5vY3x8KGEuaT8wOnMoZGIsYSkpOnMoZGIsYSkpP25ldyB2YyhhLGIpOm51bGw9PWE/bnVsbDplYihhLGIpfWZ1bmN0aW9uIHhjKGEpe3ZhciBiPW51bGwhPWE7cmV0dXJuKGI/YT9hLmkmMTMxMDcyfHxhLmVjfHwoYS5pPzA6cyhiYixhKSk6cyhiYixhKTpiKT9jYihhKTpudWxsfWZ1bmN0aW9uIHljKGEpe3JldHVybiBudWxsPT1hP251bGw6WGEoYSl9ZnVuY3Rpb24gemMoYSl7cmV0dXJuIG51bGw9PWE/bnVsbDpZYShhKX1cbnZhciBBYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbnVsbD09YT9udWxsOldhKGEsYil9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2Zvcig7Oyl7aWYobnVsbD09YSlyZXR1cm4gbnVsbDthPWIuYShhLGQpO2lmKHIoZSkpZD1GKGUpLGU9SShlKTtlbHNlIHJldHVybiBhfX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixcbmUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBCYyhhKXtyZXR1cm4gbnVsbD09YXx8c2EoRShhKSl9ZnVuY3Rpb24gQ2MoYSl7cmV0dXJuIG51bGw9PWE/ITE6YT9hLmkmOHx8YS5BYz8hMDphLmk/ITE6cyhDYSxhKTpzKENhLGEpfWZ1bmN0aW9uIERjKGEpe3JldHVybiBudWxsPT1hPyExOmE/YS5pJjQwOTZ8fGEuamM/ITA6YS5pPyExOnMoVmEsYSk6cyhWYSxhKX1mdW5jdGlvbiBFYyhhKXtyZXR1cm4gYT9hLmkmNTEyfHxhLnljPyEwOmEuaT8hMTpzKE1hLGEpOnMoTWEsYSl9ZnVuY3Rpb24gRmMoYSl7cmV0dXJuIGE/YS5pJjE2Nzc3MjE2fHxhLmljPyEwOmEuaT8hMTpzKG1iLGEpOnMobWIsYSl9XG5mdW5jdGlvbiBHYyhhKXtyZXR1cm4gbnVsbD09YT8hMTphP2EuaSYxMDI0fHxhLmNjPyEwOmEuaT8hMTpzKFBhLGEpOnMoUGEsYSl9ZnVuY3Rpb24gSGMoYSl7cmV0dXJuIGE/YS5pJjE2Mzg0fHxhLkdjPyEwOmEuaT8hMTpzKFphLGEpOnMoWmEsYSl9ZnVuY3Rpb24gSWMoYSl7cmV0dXJuIGE/YS5xJjUxMnx8YS56Yz8hMDohMTohMX1mdW5jdGlvbiBKYyhhKXt2YXIgYj1bXTtkYShhLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiLGUpe3JldHVybiBhLnB1c2goZSl9fShiKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gS2MoYSxiLGMsZCxlKXtmb3IoOzAhPT1lOyljW2RdPWFbYl0sZCs9MSxlLT0xLGIrPTF9dmFyIExjPXt9O2Z1bmN0aW9uIE1jKGEpe3JldHVybiBudWxsPT1hPyExOmE/YS5pJjY0fHxhLmJiPyEwOmEuaT8hMTpzKEZhLGEpOnMoRmEsYSl9ZnVuY3Rpb24gTmMoYSl7cmV0dXJuIHIoYSk/ITA6ITF9XG5mdW5jdGlvbiBPYyhhLGIpe3JldHVybiBRLmMoYSxiLExjKT09PUxjPyExOiEwfWZ1bmN0aW9uIFhiKGEsYil7aWYoYT09PWIpcmV0dXJuIDA7aWYobnVsbD09YSlyZXR1cm4tMTtpZihudWxsPT1iKXJldHVybiAxO2lmKHRhKGEpPT09dGEoYikpcmV0dXJuIGEmJihhLnEmMjA0OHx8YS5sYik/YS5tYihudWxsLGIpOmdhKGEsYik7aWYodSl0aHJvdyBFcnJvcihcImNvbXBhcmUgb24gbm9uLW5pbCBvYmplY3RzIG9mIGRpZmZlcmVudCB0eXBlc1wiKTtyZXR1cm4gbnVsbH1cbnZhciBQYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCl7Zm9yKDs7KXt2YXIgaz1YYihQLmEoYSxoKSxQLmEoYixoKSk7aWYoMD09PWsmJmgrMTxjKWgrPTE7ZWxzZSByZXR1cm4ga319ZnVuY3Rpb24gYihhLGIpe3ZhciBmPU8oYSksaD1PKGIpO3JldHVybiBmPGg/LTE6Zj5oPzE6dT9jLm4oYSxiLGYsMCk6bnVsbH12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLm49YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIFFjKGEpe3JldHVybiBXYi5hKGEsWGIpP1hiOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9YS5hP2EuYShiLGMpOmEuY2FsbChudWxsLGIsYyk7cmV0dXJuXCJudW1iZXJcIj09PXR5cGVvZiBkP2Q6cihkKT8tMTpyKGEuYT9hLmEoYyxiKTphLmNhbGwobnVsbCxjLGIpKT8xOjB9fVxudmFyIFNjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe2lmKEUoYikpe3ZhciBjPVJjLmI/UmMuYihiKTpSYy5jYWxsKG51bGwsYik7aGEoYyxRYyhhKSk7cmV0dXJuIEUoYyl9cmV0dXJuIEh9ZnVuY3Rpb24gYihhKXtyZXR1cm4gYy5hKFhiLGEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksVGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gU2MuYShmdW5jdGlvbihjLGYpe3JldHVybiBRYyhiKS5jYWxsKG51bGwsYS5iP2EuYihjKTphLmNhbGwobnVsbCxjKSxhLmI/YS5iKGYpOmEuY2FsbChudWxsLGYpKX0sYyl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBjLmMoYSxYYixiKX1cbnZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksbmM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtmb3IoYz1FKGMpOzspaWYoYyl7Yj1hLmE/YS5hKGIsRihjKSk6YS5jYWxsKG51bGwsYixGKGMpKTtpZihmYyhiKSlyZXR1cm4gSy5iP0suYihiKTpLLmNhbGwobnVsbCxiKTtjPUkoYyl9ZWxzZSByZXR1cm4gYn1mdW5jdGlvbiBiKGEsYil7dmFyIGM9RShiKTtyZXR1cm4gYz9DLmM/Qy5jKGEsRihjKSxJKGMpKTpDLmNhbGwobnVsbCxhLEYoYyksSShjKSk6YS5vP2EubygpOmEuY2FsbChudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLFxuYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5hPWI7Yy5jPWE7cmV0dXJuIGN9KCksQz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBjJiYoYy5pJjUyNDI4OHx8Yy5OYik/Yy5NKG51bGwsYSxiKTpjIGluc3RhbmNlb2YgQXJyYXk/aGMuYyhjLGEsYik6XCJzdHJpbmdcIj09PXR5cGVvZiBjP2hjLmMoYyxhLGIpOnMoZmIsYyk/Z2IuYyhjLGEsYik6dT9uYy5jKGEsYixjKTpudWxsfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gYiYmKGIuaSY1MjQyODh8fGIuTmIpP2IuTihudWxsLGEpOmIgaW5zdGFuY2VvZiBBcnJheT9oYy5hKGIsYSk6XCJzdHJpbmdcIj09PXR5cGVvZiBiP2hjLmEoYixhKTpzKGZiLGIpP2diLmEoYixhKTp1P25jLmEoYSxiKTpudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsXG5jLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxVYz1mdW5jdGlvbigpe3ZhciBhPW51bGwsYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxmLGgpe3ZhciBrPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixrKX1mdW5jdGlvbiBiKGEsYyxkKXtmb3IoOzspaWYoYT5jKWlmKEkoZCkpYT1jLGM9RihkKSxkPUkoZCk7ZWxzZSByZXR1cm4gYz5GKGQpO2Vsc2UgcmV0dXJuITF9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4hMDtcbmNhc2UgMjpyZXR1cm4gYT5kO2RlZmF1bHQ6cmV0dXJuIGIuZChhLGQsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MjthLmY9Yi5mO2EuYj1mdW5jdGlvbigpe3JldHVybiEwfTthLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT5ifTthLmQ9Yi5kO3JldHVybiBhfSgpLFZjPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGYsaCl7dmFyIGs9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGspfWZ1bmN0aW9uIGIoYSxjLGQpe2Zvcig7OylpZihhPj1jKWlmKEkoZCkpYT1jLGM9RihkKSxkPUkoZCk7ZWxzZSByZXR1cm4gYz49RihkKTtlbHNlIHJldHVybiExfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO1xuYT1HKGEpO3JldHVybiBiKGMsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4hMDtjYXNlIDI6cmV0dXJuIGE+PWQ7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsZCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0yO2EuZj1iLmY7YS5iPWZ1bmN0aW9uKCl7cmV0dXJuITB9O2EuYT1mdW5jdGlvbihhLGIpe3JldHVybiBhPj1ifTthLmQ9Yi5kO3JldHVybiBhfSgpO2Z1bmN0aW9uIFdjKGEpe3JldHVybiBhLTF9XG52YXIgWGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIGE+Yj9hOmJ9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe3JldHVybiBDLmMoYixhPmQ/YTpkLGUpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7XG59O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIFljKGEpe2E9KGEtYSUyKS8yO3JldHVybiAwPD1hP01hdGguZmxvb3IuYj9NYXRoLmZsb29yLmIoYSk6TWF0aC5mbG9vci5jYWxsKG51bGwsYSk6TWF0aC5jZWlsLmI/TWF0aC5jZWlsLmIoYSk6TWF0aC5jZWlsLmNhbGwobnVsbCxhKX1mdW5jdGlvbiBaYyhhKXthLT1hPj4xJjE0MzE2NTU3NjU7YT0oYSY4NTg5OTM0NTkpKyhhPj4yJjg1ODk5MzQ1OSk7cmV0dXJuIDE2ODQzMDA5KihhKyhhPj40KSYyNTI2NDUxMzUpPj4yNH1mdW5jdGlvbiAkYyhhKXt2YXIgYj0xO2ZvcihhPUUoYSk7OylpZihhJiYwPGIpYi09MSxhPUkoYSk7ZWxzZSByZXR1cm4gYX1cbnZhciBBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gbnVsbD09YT9cIlwiOmEudG9TdHJpbmcoKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsZCl7dmFyIGs9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixrKX1mdW5jdGlvbiBjKGEsZCl7Zm9yKHZhciBlPW5ldyBlYShiLmIoYSkpLGw9ZDs7KWlmKHIobCkpZT1lLmFwcGVuZChiLmIoRihsKSkpLGw9SShsKTtlbHNlIHJldHVybiBlLnRvU3RyaW5nKCl9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVyblwiXCI7Y2FzZSAxOnJldHVybiBhLmNhbGwodGhpcyxiKTtkZWZhdWx0OnJldHVybiBjLmQoYixKKGFyZ3VtZW50cyxcbjEpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTE7Yi5mPWMuZjtiLm89ZnVuY3Rpb24oKXtyZXR1cm5cIlwifTtiLmI9YTtiLmQ9Yy5kO3JldHVybiBifSgpLGFkPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbCxhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBhLnN1YnN0cmluZyhjKTtjYXNlIDM6cmV0dXJuIGEuc3Vic3RyaW5nKGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2EuYT1mdW5jdGlvbihhLGMpe3JldHVybiBhLnN1YnN0cmluZyhjKX07YS5jPWZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gYS5zdWJzdHJpbmcoYyxkKX07cmV0dXJuIGF9KCk7XG5mdW5jdGlvbiBsYyhhLGIpe3JldHVybiBOYyhGYyhiKT9mdW5jdGlvbigpe2Zvcih2YXIgYz1FKGEpLGQ9RShiKTs7KXtpZihudWxsPT1jKXJldHVybiBudWxsPT1kO2lmKG51bGw9PWQpcmV0dXJuITE7aWYoV2IuYShGKGMpLEYoZCkpKWM9SShjKSxkPUkoZCk7ZWxzZSByZXR1cm4gdT8hMTpudWxsfX0oKTpudWxsKX1mdW5jdGlvbiBiZChhLGIsYyxkLGUpe3RoaXMuaj1hO3RoaXMuZmlyc3Q9Yjt0aGlzLnRhPWM7dGhpcy5jb3VudD1kO3RoaXMubT1lO3RoaXMuaT02NTkzNzY0Njt0aGlzLnE9ODE5Mn1nPWJkLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtyZXR1cm4gMT09PXRoaXMuY291bnQ/bnVsbDp0aGlzLnRhfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb3VudH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpcnN0fTtnLkphPWZ1bmN0aW9uKCl7cmV0dXJuIElhKHRoaXMpfTtcbmcuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIEh9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maXJzdH07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIDE9PT10aGlzLmNvdW50P0g6dGhpcy50YX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgYmQoYix0aGlzLmZpcnN0LHRoaXMudGEsdGhpcy5jb3VudCx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGJkKHRoaXMuaixiLHRoaXMsdGhpcy5jb3VudCsxLG51bGwpfTtcbmZ1bmN0aW9uIGNkKGEpe3RoaXMuaj1hO3RoaXMuaT02NTkzNzYxNDt0aGlzLnE9ODE5Mn1nPWNkLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLlU9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIDB9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5KYT1mdW5jdGlvbigpe3Rocm93IEVycm9yKFwiQ2FuJ3QgcG9wIGVtcHR5IGxpc3RcIik7fTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gMH07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuUz1mdW5jdGlvbigpe3JldHVybiBIfTtcbmcuSD1mdW5jdGlvbigpe3JldHVybiBudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGNkKGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGJkKHRoaXMuaixiLG51bGwsMSxudWxsKX07dmFyIEg9bmV3IGNkKG51bGwpO2Z1bmN0aW9uIGRkKGEpe3JldHVybiBhP2EuaSYxMzQyMTc3Mjh8fGEuRmM/ITA6YS5pPyExOnMob2IsYSk6cyhvYixhKX1mdW5jdGlvbiBlZChhKXtyZXR1cm4gZGQoYSk/cGIoYSk6Qy5jKHBjLEgsYSl9XG52YXIgZmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7dmFyIGI7aWYoYSBpbnN0YW5jZW9mIGFjJiYwPT09YS5wKWI9YS5lO2Vsc2UgYTp7Zm9yKGI9W107OylpZihudWxsIT1hKWIucHVzaChhLlEobnVsbCkpLGE9YS5VKG51bGwpO2Vsc2UgYnJlYWsgYTtiPXZvaWQgMH1hPWIubGVuZ3RoO2Zvcih2YXIgZT1IOzspaWYoMDxhKXt2YXIgZj1hLTEsZT1lLkcobnVsbCxiW2EtMV0pO2E9Zn1lbHNlIHJldHVybiBlfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uIGdkKGEsYixjLGQpe3RoaXMuaj1hO3RoaXMuZmlyc3Q9Yjt0aGlzLnRhPWM7dGhpcy5tPWQ7dGhpcy5pPTY1OTI5NDUyO3RoaXMucT04MTkyfVxuZz1nZC5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMudGE/bnVsbDpFKHRoaXMudGEpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmZpcnN0fTtnLlM9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy50YT9IOnRoaXMudGF9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgZ2QoYix0aGlzLmZpcnN0LHRoaXMudGEsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBnZChudWxsLGIsdGhpcyx0aGlzLm0pfTtmdW5jdGlvbiBNKGEsYil7dmFyIGM9bnVsbD09YjtyZXR1cm4oYz9jOmImJihiLmkmNjR8fGIuYmIpKT9uZXcgZ2QobnVsbCxhLGIsbnVsbCk6bmV3IGdkKG51bGwsYSxFKGIpLG51bGwpfWZ1bmN0aW9uIFQoYSxiLGMsZCl7dGhpcy5mYT1hO3RoaXMubmFtZT1iO3RoaXMuc2E9Yzt0aGlzLlVhPWQ7dGhpcy5pPTIxNTM3NzUxMDU7dGhpcy5xPTQwOTZ9Zz1ULnByb3RvdHlwZTtnLnc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdWIoYixcIjpcIitBLmIodGhpcy5zYSkpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlVhO3JldHVybiBudWxsIT1hP2E6dGhpcy5VYT1hPVViKHRoaXMpKzI2NTQ0MzU3Njl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gUS5hKGMsdGhpcyk7Y2FzZSAzOnJldHVybiBRLmMoYyx0aGlzLGQpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKTtnLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiBRLmEoYSx0aGlzKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFEuYyhhLHRoaXMsYil9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBiIGluc3RhbmNlb2YgVD90aGlzLnNhPT09Yi5zYTohMX07Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiOlwiK0EuYih0aGlzLnNhKX07XG5mdW5jdGlvbiBoZChhLGIpe3JldHVybiBhPT09Yj8hMDphIGluc3RhbmNlb2YgVCYmYiBpbnN0YW5jZW9mIFQ/YS5zYT09PWIuc2E6ITF9XG52YXIgamQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIG5ldyBUKGEsYixcIlwiK0EuYihyKGEpP1wiXCIrQS5iKGEpK1wiL1wiOm51bGwpK0EuYihiKSxudWxsKX1mdW5jdGlvbiBiKGEpe2lmKGEgaW5zdGFuY2VvZiBUKXJldHVybiBhO2lmKGEgaW5zdGFuY2VvZiBaYil7dmFyIGI7aWYoYSYmKGEucSY0MDk2fHxhLmZjKSliPWEuZmE7ZWxzZSB0aHJvdyBFcnJvcihcIkRvZXNuJ3Qgc3VwcG9ydCBuYW1lc3BhY2U6IFwiK0EuYihhKSk7cmV0dXJuIG5ldyBUKGIsaWQuYj9pZC5iKGEpOmlkLmNhbGwobnVsbCxhKSxhLk5hLG51bGwpfXJldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYT8oYj1hLnNwbGl0KFwiL1wiKSwyPT09Yi5sZW5ndGg/bmV3IFQoYlswXSxiWzFdLGEsbnVsbCk6bmV3IFQobnVsbCxiWzBdLGEsbnVsbCkpOm51bGx9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxcbmMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIFYoYSxiLGMsZCl7dGhpcy5qPWE7dGhpcy5ZYT1iO3RoaXMucj1jO3RoaXMubT1kO3RoaXMucT0wO3RoaXMuaT0zMjM3NDk4OH1nPVYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2Z1bmN0aW9uIGtkKGEpe251bGwhPWEuWWEmJihhLnI9YS5ZYS5vP2EuWWEubygpOmEuWWEuY2FsbChudWxsKSxhLllhPW51bGwpO3JldHVybiBhLnJ9Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5VPWZ1bmN0aW9uKCl7bGIodGhpcyk7cmV0dXJuIG51bGw9PXRoaXMucj9udWxsOkkodGhpcy5yKX07Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9Y2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtcbmcuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe2xiKHRoaXMpO3JldHVybiBudWxsPT10aGlzLnI/bnVsbDpGKHRoaXMucil9O2cuUz1mdW5jdGlvbigpe2xiKHRoaXMpO3JldHVybiBudWxsIT10aGlzLnI/Ryh0aGlzLnIpOkh9O2cuSD1mdW5jdGlvbigpe2tkKHRoaXMpO2lmKG51bGw9PXRoaXMucilyZXR1cm4gbnVsbDtmb3IodmFyIGE9dGhpcy5yOzspaWYoYSBpbnN0YW5jZW9mIFYpYT1rZChhKTtlbHNlIHJldHVybiB0aGlzLnI9YSxFKHRoaXMucil9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVihiLHRoaXMuWWEsdGhpcy5yLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xuZnVuY3Rpb24gbGQoYSxiKXt0aGlzLnFiPWE7dGhpcy5lbmQ9Yjt0aGlzLnE9MDt0aGlzLmk9Mn1sZC5wcm90b3R5cGUuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVuZH07bGQucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhKXt0aGlzLnFiW3RoaXMuZW5kXT1hO3JldHVybiB0aGlzLmVuZCs9MX07bGQucHJvdG90eXBlLmRhPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IG1kKHRoaXMucWIsMCx0aGlzLmVuZCk7dGhpcy5xYj1udWxsO3JldHVybiBhfTtmdW5jdGlvbiBtZChhLGIsYyl7dGhpcy5lPWE7dGhpcy5PPWI7dGhpcy5lbmQ9Yzt0aGlzLnE9MDt0aGlzLmk9NTI0MzA2fWc9bWQucHJvdG90eXBlO2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBoYy5uKHRoaXMuZSxiLHRoaXMuZVt0aGlzLk9dLHRoaXMuTysxKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gaGMubih0aGlzLmUsYixjLHRoaXMuTyl9O1xuZy5LYj1mdW5jdGlvbigpe2lmKHRoaXMuTz09PXRoaXMuZW5kKXRocm93IEVycm9yKFwiLWRyb3AtZmlyc3Qgb2YgZW1wdHkgY2h1bmtcIik7cmV0dXJuIG5ldyBtZCh0aGlzLmUsdGhpcy5PKzEsdGhpcy5lbmQpfTtnLko9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5lW3RoaXMuTytiXX07Zy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA8PWImJmI8dGhpcy5lbmQtdGhpcy5PP3RoaXMuZVt0aGlzLk8rYl06Y307Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kLXRoaXMuT307XG52YXIgbmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gbmV3IG1kKGEsYixjKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIG5ldyBtZChhLGIsYS5sZW5ndGgpfWZ1bmN0aW9uIGMoYSl7cmV0dXJuIG5ldyBtZChhLDAsYS5sZW5ndGgpfXZhciBkPW51bGwsZD1mdW5jdGlvbihkLGYsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYy5jYWxsKHRoaXMsZCk7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxkLGYpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsZCxmLGgpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmI9YztkLmE9YjtkLmM9YTtyZXR1cm4gZH0oKTtmdW5jdGlvbiBvZChhLGIsYyxkKXt0aGlzLmRhPWE7dGhpcy5vYT1iO3RoaXMuaj1jO3RoaXMubT1kO3RoaXMuaT0zMTg1MDczMjt0aGlzLnE9MTUzNn1nPW9kLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtcbmcuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuVT1mdW5jdGlvbigpe2lmKDE8QWEodGhpcy5kYSkpcmV0dXJuIG5ldyBvZChHYih0aGlzLmRhKSx0aGlzLm9hLHRoaXMuaixudWxsKTt2YXIgYT1sYih0aGlzLm9hKTtyZXR1cm4gbnVsbD09YT9udWxsOmF9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRC5hKHRoaXMuZGEsMCl9O2cuUz1mdW5jdGlvbigpe3JldHVybiAxPEFhKHRoaXMuZGEpP25ldyBvZChHYih0aGlzLmRhKSx0aGlzLm9hLHRoaXMuaixudWxsKTpudWxsPT10aGlzLm9hP0g6dGhpcy5vYX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuc2I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYX07XG5nLnRiPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMub2E/SDp0aGlzLm9hfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IG9kKHRoaXMuZGEsdGhpcy5vYSxiLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2cucmI9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09dGhpcy5vYT9udWxsOnRoaXMub2F9O2Z1bmN0aW9uIHBkKGEsYil7cmV0dXJuIDA9PT1BYShhKT9iOm5ldyBvZChhLGIsbnVsbCxudWxsKX1mdW5jdGlvbiBSYyhhKXtmb3IodmFyIGI9W107OylpZihFKGEpKWIucHVzaChGKGEpKSxhPUkoYSk7ZWxzZSByZXR1cm4gYn1mdW5jdGlvbiBxZChhLGIpe2lmKGljKGEpKXJldHVybiBPKGEpO2Zvcih2YXIgYz1hLGQ9YixlPTA7OylpZigwPGQmJkUoYykpYz1JKGMpLGQtPTEsZSs9MTtlbHNlIHJldHVybiBlfVxudmFyIHNkPWZ1bmN0aW9uIHJkKGIpe3JldHVybiBudWxsPT1iP251bGw6bnVsbD09SShiKT9FKEYoYikpOnU/TShGKGIpLHJkKEkoYikpKTpudWxsfSx0ZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBjPUUoYSk7cmV0dXJuIGM/SWMoYyk/cGQoSGIoYyksZC5hKEliKGMpLGIpKTpNKEYoYyksZC5hKEcoYyksYikpOmJ9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBhfSxudWxsLG51bGwpfWZ1bmN0aW9uIGMoKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBudWxsfSxudWxsLG51bGwpfXZhciBkPW51bGwsZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUpe3ZhciBmPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoZj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsXG5kLGYpfWZ1bmN0aW9uIGIoYSxjLGUpe3JldHVybiBmdW5jdGlvbiB0KGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgYz1FKGEpO3JldHVybiBjP0ljKGMpP3BkKEhiKGMpLHQoSWIoYyksYikpOk0oRihjKSx0KEcoYyksYikpOnIoYik/dChGKGIpLEkoYikpOm51bGx9LG51bGwsbnVsbCl9KGQuYShhLGMpLGUpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsYSl9O2EuZD1iO3JldHVybiBhfSgpLGQ9ZnVuY3Rpb24oZCxoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGMuY2FsbCh0aGlzKTtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGQpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsZCxoKTtkZWZhdWx0OnJldHVybiBlLmQoZCxoLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPVxuMjtkLmY9ZS5mO2Qubz1jO2QuYj1iO2QuYT1hO2QuZD1lLmQ7cmV0dXJuIGR9KCksdWQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe3JldHVybiBNKGEsTShiLE0oYyxkKSkpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBNKGEsTShiLGMpKX12YXIgYz1udWxsLGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLG4scSl7dmFyIHQ9bnVsbDs0PGFyZ3VtZW50cy5sZW5ndGgmJih0PUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsbix0KX1mdW5jdGlvbiBiKGEsYyxkLGUsZil7cmV0dXJuIE0oYSxNKGMsTShkLE0oZSxzZChmKSkpKSl9YS5rPTQ7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBxPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLHEsYSl9O2EuZD1iO3JldHVybiBhfSgpLGM9ZnVuY3Rpb24oYyxmLFxuaCxrLGwpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIEUoYyk7Y2FzZSAyOnJldHVybiBNKGMsZik7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxjLGYsaCk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxjLGYsaCxrKTtkZWZhdWx0OnJldHVybiBkLmQoYyxmLGgsayxKKGFyZ3VtZW50cyw0KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Muaz00O2MuZj1kLmY7Yy5iPWZ1bmN0aW9uKGEpe3JldHVybiBFKGEpfTtjLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShhLGIpfTtjLmM9YjtjLm49YTtjLmQ9ZC5kO3JldHVybiBjfSgpO2Z1bmN0aW9uIHZkKGEpe3JldHVybiBBYihhKX1cbnZhciB3ZD1mdW5jdGlvbigpe3ZhciBhPW51bGwsYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxmLGgpe3ZhciBrPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixrKX1mdW5jdGlvbiBiKGEsYyxkKXtmb3IoOzspaWYoYT16YihhLGMpLHIoZCkpYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBhfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGgsYSl9O2EuZD1iO3JldHVybiBhfSgpLGE9ZnVuY3Rpb24oYSxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHpiKGEsZCk7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsZCxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Euaz0yO2EuZj1iLmY7YS5hPVxuZnVuY3Rpb24oYSxiKXtyZXR1cm4gemIoYSxiKX07YS5kPWIuZDtyZXR1cm4gYX0oKSx4ZD1mdW5jdGlvbigpe3ZhciBhPW51bGwsYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxmLGgsayl7dmFyIGw9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxmLGgsbCl9ZnVuY3Rpb24gYihhLGMsZCxrKXtmb3IoOzspaWYoYT1CYihhLGMsZCkscihrKSljPUYoayksZD1GKEkoaykpLGs9SShJKGspKTtlbHNlIHJldHVybiBhfWEuaz0zO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9SShhKTt2YXIgaz1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGgsayxhKX07YS5kPWI7cmV0dXJuIGF9KCksYT1mdW5jdGlvbihhLGQsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAzOnJldHVybiBCYihhLGQsZSk7ZGVmYXVsdDpyZXR1cm4gYi5kKGEsXG5kLGUsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTthLms9MzthLmY9Yi5mO2EuYz1mdW5jdGlvbihhLGIsZSl7cmV0dXJuIEJiKGEsYixlKX07YS5kPWIuZDtyZXR1cm4gYX0oKSx5ZD1mdW5jdGlvbigpe3ZhciBhPW51bGwsYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxmLGgpe3ZhciBrPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixrKX1mdW5jdGlvbiBiKGEsYyxkKXtmb3IoOzspaWYoYT1DYihhLGMpLHIoZCkpYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBhfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGgsYSl9O2EuZD1iO3JldHVybiBhfSgpLGE9ZnVuY3Rpb24oYSxkLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIENiKGEsXG5kKTtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQ2IoYSxiKX07YS5kPWIuZDtyZXR1cm4gYX0oKSx6ZD1mdW5jdGlvbigpe3ZhciBhPW51bGwsYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxmLGgpe3ZhciBrPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoaz1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZixrKX1mdW5jdGlvbiBiKGEsYyxkKXtmb3IoOzspaWYoYT1GYihhLGMpLHIoZCkpYz1GKGQpLGQ9SShkKTtlbHNlIHJldHVybiBhfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGgsYSl9O2EuZD1iO3JldHVybiBhfSgpLGE9ZnVuY3Rpb24oYSxkLFxuZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gRmIoYSxkKTtkZWZhdWx0OnJldHVybiBiLmQoYSxkLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307YS5rPTI7YS5mPWIuZjthLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRmIoYSxiKX07YS5kPWIuZDtyZXR1cm4gYX0oKTtcbmZ1bmN0aW9uIEFkKGEsYixjKXt2YXIgZD1FKGMpO2lmKDA9PT1iKXJldHVybiBhLm8/YS5vKCk6YS5jYWxsKG51bGwpO2M9SGEoZCk7dmFyIGU9SWEoZCk7aWYoMT09PWIpcmV0dXJuIGEuYj9hLmIoYyk6YS5iP2EuYihjKTphLmNhbGwobnVsbCxjKTt2YXIgZD1IYShlKSxmPUlhKGUpO2lmKDI9PT1iKXJldHVybiBhLmE/YS5hKGMsZCk6YS5hP2EuYShjLGQpOmEuY2FsbChudWxsLGMsZCk7dmFyIGU9SGEoZiksaD1JYShmKTtpZigzPT09YilyZXR1cm4gYS5jP2EuYyhjLGQsZSk6YS5jP2EuYyhjLGQsZSk6YS5jYWxsKG51bGwsYyxkLGUpO3ZhciBmPUhhKGgpLGs9SWEoaCk7aWYoND09PWIpcmV0dXJuIGEubj9hLm4oYyxkLGUsZik6YS5uP2EubihjLGQsZSxmKTphLmNhbGwobnVsbCxjLGQsZSxmKTt2YXIgaD1IYShrKSxsPUlhKGspO2lmKDU9PT1iKXJldHVybiBhLnM/YS5zKGMsZCxlLGYsaCk6YS5zP2EucyhjLGQsZSxmLGgpOmEuY2FsbChudWxsLGMsZCxlLGYsaCk7dmFyIGs9SGEobCksXG5uPUlhKGwpO2lmKDY9PT1iKXJldHVybiBhLlg/YS5YKGMsZCxlLGYsaCxrKTphLlg/YS5YKGMsZCxlLGYsaCxrKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayk7dmFyIGw9SGEobikscT1JYShuKTtpZig3PT09YilyZXR1cm4gYS5nYT9hLmdhKGMsZCxlLGYsaCxrLGwpOmEuZ2E/YS5nYShjLGQsZSxmLGgsayxsKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsKTt2YXIgbj1IYShxKSx0PUlhKHEpO2lmKDg9PT1iKXJldHVybiBhLkdhP2EuR2EoYyxkLGUsZixoLGssbCxuKTphLkdhP2EuR2EoYyxkLGUsZixoLGssbCxuKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4pO3ZhciBxPUhhKHQpLHY9SWEodCk7aWYoOT09PWIpcmV0dXJuIGEuSGE/YS5IYShjLGQsZSxmLGgsayxsLG4scSk6YS5IYT9hLkhhKGMsZCxlLGYsaCxrLGwsbixxKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSk7dmFyIHQ9SGEodiksdz1JYSh2KTtpZigxMD09PWIpcmV0dXJuIGEudmE/YS52YShjLGQsZSxcbmYsaCxrLGwsbixxLHQpOmEudmE/YS52YShjLGQsZSxmLGgsayxsLG4scSx0KTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0KTt2YXIgdj1IYSh3KSx5PUlhKHcpO2lmKDExPT09YilyZXR1cm4gYS53YT9hLndhKGMsZCxlLGYsaCxrLGwsbixxLHQsdik6YS53YT9hLndhKGMsZCxlLGYsaCxrLGwsbixxLHQsdik6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2KTt2YXIgdz1IYSh5KSxCPUlhKHkpO2lmKDEyPT09YilyZXR1cm4gYS54YT9hLnhhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTphLnhhP2EueGEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcpOmEuY2FsbChudWxsLGMsZCxlLGYsaCxrLGwsbixxLHQsdix3KTt2YXIgeT1IYShCKSxMPUlhKEIpO2lmKDEzPT09YilyZXR1cm4gYS55YT9hLnlhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHkpOmEueWE/YS55YShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5KTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSxcbnQsdix3LHkpO3ZhciBCPUhhKEwpLFU9SWEoTCk7aWYoMTQ9PT1iKXJldHVybiBhLnphP2EuemEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTphLnphP2EuemEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIpO3ZhciBMPUhhKFUpLFo9SWEoVSk7aWYoMTU9PT1iKXJldHVybiBhLkFhP2EuQWEoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpOmEuQWE/YS5BYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwpO3ZhciBVPUhhKFopLG5hPUlhKFopO2lmKDE2PT09YilyZXR1cm4gYS5CYT9hLkJhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUpOmEuQmE/YS5CYShjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVKTt2YXIgWj1cbkhhKG5hKSxHYT1JYShuYSk7aWYoMTc9PT1iKXJldHVybiBhLkNhP2EuQ2EoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTphLkNhP2EuQ2EoYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaKTphLmNhbGwobnVsbCxjLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFopO3ZhciBuYT1IYShHYSksUmE9SWEoR2EpO2lmKDE4PT09YilyZXR1cm4gYS5EYT9hLkRhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk6YS5EYT9hLkRhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hKTtHYT1IYShSYSk7UmE9SWEoUmEpO2lmKDE5PT09YilyZXR1cm4gYS5FYT9hLkVhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk6YS5FYT9hLkVhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSk6YS5jYWxsKG51bGwsXG5jLGQsZSxmLGgsayxsLG4scSx0LHYsdyx5LEIsTCxVLFosbmEsR2EpO3ZhciB3Yz1IYShSYSk7SWEoUmEpO2lmKDIwPT09YilyZXR1cm4gYS5GYT9hLkZhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSx3Yyk6YS5GYT9hLkZhKGMsZCxlLGYsaCxrLGwsbixxLHQsdix3LHksQixMLFUsWixuYSxHYSx3Yyk6YS5jYWxsKG51bGwsYyxkLGUsZixoLGssbCxuLHEsdCx2LHcseSxCLEwsVSxaLG5hLEdhLHdjKTt0aHJvdyBFcnJvcihcIk9ubHkgdXAgdG8gMjAgYXJndW1lbnRzIHN1cHBvcnRlZCBvbiBmdW5jdGlvbnNcIik7fVxudmFyIFM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQsZSl7Yj11ZC5uKGIsYyxkLGUpO2M9YS5rO3JldHVybiBhLmY/KGQ9cWQoYixjKzEpLGQ8PWM/QWQoYSxkLGIpOmEuZihiKSk6YS5hcHBseShhLFJjKGIpKX1mdW5jdGlvbiBiKGEsYixjLGQpe2I9dWQuYyhiLGMsZCk7Yz1hLms7cmV0dXJuIGEuZj8oZD1xZChiLGMrMSksZDw9Yz9BZChhLGQsYik6YS5mKGIpKTphLmFwcGx5KGEsUmMoYikpfWZ1bmN0aW9uIGMoYSxiLGMpe2I9dWQuYShiLGMpO2M9YS5rO2lmKGEuZil7dmFyIGQ9cWQoYixjKzEpO3JldHVybiBkPD1jP0FkKGEsZCxiKTphLmYoYil9cmV0dXJuIGEuYXBwbHkoYSxSYyhiKSl9ZnVuY3Rpb24gZChhLGIpe3ZhciBjPWEuaztpZihhLmYpe3ZhciBkPXFkKGIsYysxKTtyZXR1cm4gZDw9Yz9BZChhLGQsYik6YS5mKGIpfXJldHVybiBhLmFwcGx5KGEsUmMoYikpfXZhciBlPW51bGwsZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsZixoLHcpe3ZhciB5PW51bGw7XG41PGFyZ3VtZW50cy5sZW5ndGgmJih5PUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDUpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsZixoLHkpfWZ1bmN0aW9uIGIoYSxjLGQsZSxmLGgpe2M9TShjLE0oZCxNKGUsTShmLHNkKGgpKSkpKTtkPWEuaztyZXR1cm4gYS5mPyhlPXFkKGMsZCsxKSxlPD1kP0FkKGEsZSxjKTphLmYoYykpOmEuYXBwbHkoYSxSYyhjKSl9YS5rPTU7YS5mPWZ1bmN0aW9uKGEpe3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1JKGEpO3ZhciBmPUYoYSk7YT1JKGEpO3ZhciBoPUYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsaCxhKX07YS5kPWI7cmV0dXJuIGF9KCksZT1mdW5jdGlvbihlLGssbCxuLHEsdCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gZC5jYWxsKHRoaXMsZSxrKTtjYXNlIDM6cmV0dXJuIGMuY2FsbCh0aGlzLGUsayxsKTtjYXNlIDQ6cmV0dXJuIGIuY2FsbCh0aGlzLFxuZSxrLGwsbik7Y2FzZSA1OnJldHVybiBhLmNhbGwodGhpcyxlLGssbCxuLHEpO2RlZmF1bHQ6cmV0dXJuIGYuZChlLGssbCxuLHEsSihhcmd1bWVudHMsNSkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtlLms9NTtlLmY9Zi5mO2UuYT1kO2UuYz1jO2Uubj1iO2Uucz1hO2UuZD1mLmQ7cmV0dXJuIGV9KCksQmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIVdiLmEoYSxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsbCl9ZnVuY3Rpb24gYihhLGMsZCl7cmV0dXJuIHNhKFMubihXYixhLGMsZCkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLFxuZCxhKX07YS5kPWI7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4hMTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7Yi5iPWZ1bmN0aW9uKCl7cmV0dXJuITF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCk7ZnVuY3Rpb24gQ2QoYSl7cmV0dXJuIEUoYSk/YTpudWxsfWZ1bmN0aW9uIERkKGEsYil7Zm9yKDs7KXtpZihudWxsPT1FKGIpKXJldHVybiEwO2lmKHIoYS5iP2EuYihGKGIpKTphLmNhbGwobnVsbCxGKGIpKSkpe3ZhciBjPWEsZD1JKGIpO2E9YztiPWR9ZWxzZSByZXR1cm4gdT8hMTpudWxsfX1cbmZ1bmN0aW9uIEVkKGEsYil7Zm9yKDs7KWlmKEUoYikpe3ZhciBjPWEuYj9hLmIoRihiKSk6YS5jYWxsKG51bGwsRihiKSk7aWYocihjKSlyZXR1cm4gYzt2YXIgYz1hLGQ9SShiKTthPWM7Yj1kfWVsc2UgcmV0dXJuIG51bGx9ZnVuY3Rpb24gRmQoYSl7cmV0dXJuIGF9XG5mdW5jdGlvbiBHZChhKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBjLmNhbGwodGhpcyxhLGQsbCl9ZnVuY3Rpb24gYyhiLGQsZSl7cmV0dXJuIHNhKFMubihhLGIsZCxlKSl9Yi5rPTI7Yi5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07Yi5kPWM7cmV0dXJuIGJ9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gc2EoYS5vP2EubygpOmEuY2FsbChudWxsKSk7Y2FzZSAxOnZhciBoPWI7cmV0dXJuIHNhKGEuYj9hLmIoaCk6YS5jYWxsKG51bGwsaCkpO2Nhc2UgMjp2YXIgaD1iLGs9ZTtyZXR1cm4gc2EoYS5hP2EuYShoLGspOmEuY2FsbChudWxsLFxuaCxrKSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsZSxKKGFyZ3VtZW50cywyKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0yO2IuZj1jLmY7cmV0dXJuIGJ9KCl9XG52YXIgSGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZD1udWxsLGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBkKGEsYixjLGUpe3ZhciBmPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYoZj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGsuY2FsbCh0aGlzLGEsYixjLGYpfWZ1bmN0aW9uIGsoZCxsLG4scSl7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYihTLnMoYyxkLGwsbixxKSk6Yi5jYWxsKG51bGwsUy5zKGMsZCxsLG4scSkpKTphLmNhbGwobnVsbCxiLmI/Yi5iKFMucyhjLGQsbCxuLHEpKTpiLmNhbGwobnVsbCxTLnMoYyxkLGwsbixxKSkpfWQuaz0zO2QuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gayhiLGMsZCxhKX07ZC5kPWs7cmV0dXJuIGR9KCksZD1mdW5jdGlvbihkLGssdCx2KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBhLmI/XG5hLmIoYi5iP2IuYihjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKTpiLmNhbGwobnVsbCxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKSk6YS5jYWxsKG51bGwsYi5iP2IuYihjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKTpiLmNhbGwobnVsbCxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKSk7Y2FzZSAxOnZhciB3PWQ7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYihjLmI/Yy5iKHcpOmMuY2FsbChudWxsLHcpKTpiLmNhbGwobnVsbCxjLmI/Yy5iKHcpOmMuY2FsbChudWxsLHcpKSk6YS5jYWxsKG51bGwsYi5iP2IuYihjLmI/Yy5iKHcpOmMuY2FsbChudWxsLHcpKTpiLmNhbGwobnVsbCxjLmI/Yy5iKHcpOmMuY2FsbChudWxsLHcpKSk7Y2FzZSAyOnZhciB3PWQseT1rO3JldHVybiBhLmI/YS5iKGIuYj9iLmIoYy5hP2MuYSh3LHkpOmMuY2FsbChudWxsLHcseSkpOmIuY2FsbChudWxsLGMuYT9jLmEodyx5KTpjLmNhbGwobnVsbCx3LHkpKSk6YS5jYWxsKG51bGwsYi5iP2IuYihjLmE/Yy5hKHcseSk6Yy5jYWxsKG51bGwsXG53LHkpKTpiLmNhbGwobnVsbCxjLmE/Yy5hKHcseSk6Yy5jYWxsKG51bGwsdyx5KSkpO2Nhc2UgMzp2YXIgdz1kLHk9ayxCPXQ7cmV0dXJuIGEuYj9hLmIoYi5iP2IuYihjLmM/Yy5jKHcseSxCKTpjLmNhbGwobnVsbCx3LHksQikpOmIuY2FsbChudWxsLGMuYz9jLmModyx5LEIpOmMuY2FsbChudWxsLHcseSxCKSkpOmEuY2FsbChudWxsLGIuYj9iLmIoYy5jP2MuYyh3LHksQik6Yy5jYWxsKG51bGwsdyx5LEIpKTpiLmNhbGwobnVsbCxjLmM/Yy5jKHcseSxCKTpjLmNhbGwobnVsbCx3LHksQikpKTtkZWZhdWx0OnJldHVybiBsLmQoZCxrLHQsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9MztkLmY9bC5mO3JldHVybiBkfSgpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsLGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBjKGEsYixlLGYpe3ZhciBoPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiZcbihoPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gZC5jYWxsKHRoaXMsYSxiLGUsaCl9ZnVuY3Rpb24gZChjLGgsayxsKXtyZXR1cm4gYS5iP2EuYihTLnMoYixjLGgsayxsKSk6YS5jYWxsKG51bGwsUy5zKGIsYyxoLGssbCkpfWMuaz0zO2MuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9RyhhKTtyZXR1cm4gZChiLGMsZSxhKX07Yy5kPWQ7cmV0dXJuIGN9KCksYz1mdW5jdGlvbihjLGgscSx0KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBhLmI/YS5iKGIubz9iLm8oKTpiLmNhbGwobnVsbCkpOmEuY2FsbChudWxsLGIubz9iLm8oKTpiLmNhbGwobnVsbCkpO2Nhc2UgMTp2YXIgdj1jO3JldHVybiBhLmI/YS5iKGIuYj9iLmIodik6Yi5jYWxsKG51bGwsdikpOmEuY2FsbChudWxsLGIuYj9iLmIodik6Yi5jYWxsKG51bGwsdikpO2Nhc2UgMjp2YXIgdj1cbmMsdz1oO3JldHVybiBhLmI/YS5iKGIuYT9iLmEodix3KTpiLmNhbGwobnVsbCx2LHcpKTphLmNhbGwobnVsbCxiLmE/Yi5hKHYsdyk6Yi5jYWxsKG51bGwsdix3KSk7Y2FzZSAzOnZhciB2PWMsdz1oLHk9cTtyZXR1cm4gYS5iP2EuYihiLmM/Yi5jKHYsdyx5KTpiLmNhbGwobnVsbCx2LHcseSkpOmEuY2FsbChudWxsLGIuYz9iLmModix3LHkpOmIuY2FsbChudWxsLHYsdyx5KSk7ZGVmYXVsdDpyZXR1cm4gZC5kKGMsaCxxLEooYXJndW1lbnRzLDMpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5rPTM7Yy5mPWQuZjtyZXR1cm4gY30oKX12YXIgYz1udWxsLGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLG4pe3ZhciBxPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYocT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywzKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLHEpfWZ1bmN0aW9uIGIoYSxjLGQsXG5lKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBjLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBjKGIpe2I9Uy5hKEYoYSksYik7Zm9yKHZhciBkPUkoYSk7OylpZihkKWI9RihkKS5jYWxsKG51bGwsYiksZD1JKGQpO2Vsc2UgcmV0dXJuIGJ9Yi5rPTA7Yi5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYyhhKX07Yi5kPWM7cmV0dXJuIGJ9KCl9KGVkKHVkLm4oYSxjLGQsZSkpKX1hLms9MzthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsYSl9O2EuZD1iO3JldHVybiBhfSgpLGM9ZnVuY3Rpb24oYyxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gRmQ7XG5jYXNlIDE6cmV0dXJuIGM7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGYpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxmLGgpO2RlZmF1bHQ6cmV0dXJuIGQuZChjLGYsaCxKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Muaz0zO2MuZj1kLmY7Yy5vPWZ1bmN0aW9uKCl7cmV0dXJuIEZkfTtjLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2MuYT1iO2MuYz1hO2MuZD1kLmQ7cmV0dXJuIGN9KCksSWQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGUoYSl7dmFyIGI9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihiPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gcS5jYWxsKHRoaXMsYil9ZnVuY3Rpb24gcShlKXtyZXR1cm4gUy5zKGEsYixjLGQsZSl9ZS5rPTA7ZS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtcbnJldHVybiBxKGEpfTtlLmQ9cTtyZXR1cm4gZX0oKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oKXtmdW5jdGlvbiBkKGEpe3ZhciBiPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoYj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGUuY2FsbCh0aGlzLGIpfWZ1bmN0aW9uIGUoZCl7cmV0dXJuIFMubihhLGIsYyxkKX1kLms9MDtkLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBlKGEpfTtkLmQ9ZTtyZXR1cm4gZH0oKX1mdW5jdGlvbiBjKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYyhhKXt2YXIgYj1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGI9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBkLmNhbGwodGhpcyxiKX1mdW5jdGlvbiBkKGMpe3JldHVybiBTLmMoYSxiLGMpfWMuaz0wO2MuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGQoYSl9O1xuYy5kPWQ7cmV0dXJuIGN9KCl9dmFyIGQ9bnVsbCxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmLHQpe3ZhciB2PW51bGw7NDxhcmd1bWVudHMubGVuZ3RoJiYodj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyw0KSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGMsZCxlLGYsdil9ZnVuY3Rpb24gYihhLGMsZCxlLGYpe3JldHVybiBmdW5jdGlvbigpe2Z1bmN0aW9uIGIoYSl7dmFyIGM9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihjPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gaC5jYWxsKHRoaXMsYyl9ZnVuY3Rpb24gaChiKXtyZXR1cm4gUy5zKGEsYyxkLGUsdGQuYShmLGIpKX1iLms9MDtiLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBoKGEpfTtiLmQ9aDtyZXR1cm4gYn0oKX1hLms9NDthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTtcbmE9SShhKTt2YXIgZj1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxmLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxkPWZ1bmN0aW9uKGQsaCxrLGwsbil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gZDtjYXNlIDI6cmV0dXJuIGMuY2FsbCh0aGlzLGQsaCk7Y2FzZSAzOnJldHVybiBiLmNhbGwodGhpcyxkLGgsayk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxkLGgsayxsKTtkZWZhdWx0OnJldHVybiBlLmQoZCxoLGssbCxKKGFyZ3VtZW50cyw0KSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Quaz00O2QuZj1lLmY7ZC5iPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtkLmE9YztkLmM9YjtkLm49YTtkLmQ9ZS5kO3JldHVybiBkfSgpLEpkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgbD1udWxsLG49ZnVuY3Rpb24oKXtmdW5jdGlvbiBsKGEsYixjLGQpe3ZhciBlPW51bGw7XG4zPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gbi5jYWxsKHRoaXMsYSxiLGMsZSl9ZnVuY3Rpb24gbihsLHEsdCxCKXtyZXR1cm4gUy5zKGEsbnVsbD09bD9iOmwsbnVsbD09cT9jOnEsbnVsbD09dD9kOnQsQil9bC5rPTM7bC5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBjPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBuKGIsYyxkLGEpfTtsLmQ9bjtyZXR1cm4gbH0oKSxsPWZ1bmN0aW9uKGwsdCx2LHcpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6dmFyIHk9bCxCPXQ7cmV0dXJuIGEuYT9hLmEobnVsbD09eT9iOnksbnVsbD09Qj9jOkIpOmEuY2FsbChudWxsLG51bGw9PXk/Yjp5LG51bGw9PUI/YzpCKTtjYXNlIDM6dmFyIHk9bCxCPXQsTD12O3JldHVybiBhLmM/YS5jKG51bGw9PXk/Yjp5LG51bGw9PUI/YzpCLG51bGw9PUw/ZDpMKTphLmNhbGwobnVsbCxcbm51bGw9PXk/Yjp5LG51bGw9PUI/YzpCLG51bGw9PUw/ZDpMKTtkZWZhdWx0OnJldHVybiBuLmQobCx0LHYsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtsLms9MztsLmY9bi5mO3JldHVybiBsfSgpfWZ1bmN0aW9uIGIoYSxiLGMpe3JldHVybiBmdW5jdGlvbigpe3ZhciBkPW51bGwsbD1mdW5jdGlvbigpe2Z1bmN0aW9uIGQoYSxiLGMsZSl7dmFyIGY9bnVsbDszPGFyZ3VtZW50cy5sZW5ndGgmJihmPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDMpLDApKTtyZXR1cm4gay5jYWxsKHRoaXMsYSxiLGMsZil9ZnVuY3Rpb24gayhkLGwsbixxKXtyZXR1cm4gUy5zKGEsbnVsbD09ZD9iOmQsbnVsbD09bD9jOmwsbixxKX1kLms9MztkLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGsoYixjLGQsYSl9O2QuZD1cbms7cmV0dXJuIGR9KCksZD1mdW5jdGlvbihkLGssdCx2KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnZhciB3PWQseT1rO3JldHVybiBhLmE/YS5hKG51bGw9PXc/Yjp3LG51bGw9PXk/Yzp5KTphLmNhbGwobnVsbCxudWxsPT13P2I6dyxudWxsPT15P2M6eSk7Y2FzZSAzOnZhciB3PWQseT1rLEI9dDtyZXR1cm4gYS5jP2EuYyhudWxsPT13P2I6dyxudWxsPT15P2M6eSxCKTphLmNhbGwobnVsbCxudWxsPT13P2I6dyxudWxsPT15P2M6eSxCKTtkZWZhdWx0OnJldHVybiBsLmQoZCxrLHQsSihhcmd1bWVudHMsMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLms9MztkLmY9bC5mO3JldHVybiBkfSgpfWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsLGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBjKGEsYixlLGYpe3ZhciBoPW51bGw7Mzxhcmd1bWVudHMubGVuZ3RoJiYoaD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyxcbjMpLDApKTtyZXR1cm4gZC5jYWxsKHRoaXMsYSxiLGUsaCl9ZnVuY3Rpb24gZChjLGgsayxsKXtyZXR1cm4gUy5zKGEsbnVsbD09Yz9iOmMsaCxrLGwpfWMuaz0zO2MuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9RyhhKTtyZXR1cm4gZChiLGMsZSxhKX07Yy5kPWQ7cmV0dXJuIGN9KCksYz1mdW5jdGlvbihjLGgscSx0KXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnZhciB2PWM7cmV0dXJuIGEuYj9hLmIobnVsbD09dj9iOnYpOmEuY2FsbChudWxsLG51bGw9PXY/Yjp2KTtjYXNlIDI6dmFyIHY9Yyx3PWg7cmV0dXJuIGEuYT9hLmEobnVsbD09dj9iOnYsdyk6YS5jYWxsKG51bGwsbnVsbD09dj9iOnYsdyk7Y2FzZSAzOnZhciB2PWMsdz1oLHk9cTtyZXR1cm4gYS5jP2EuYyhudWxsPT12P2I6dix3LHkpOmEuY2FsbChudWxsLG51bGw9PXY/Yjp2LHcseSk7ZGVmYXVsdDpyZXR1cm4gZC5kKGMsaCxxLEooYXJndW1lbnRzLFxuMykpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLms9MztjLmY9ZC5mO3JldHVybiBjfSgpfXZhciBkPW51bGwsZD1mdW5jdGlvbihkLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGYpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxmLGgpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsZCxmLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2QuYT1jO2QuYz1iO2Qubj1hO3JldHVybiBkfSgpLEtkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxlKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBuPUUoYikscT1FKGMpLHQ9RShlKTtyZXR1cm4gbiYmcSYmdD9NKGEuYz9hLmMoRihuKSxGKHEpLEYodCkpOmEuY2FsbChudWxsLEYobiksRihxKSxGKHQpKSxkLm4oYSxHKG4pLEcocSksRyh0KSkpOm51bGx9LFxubnVsbCxudWxsKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBlPUUoYiksbj1FKGMpO3JldHVybiBlJiZuP00oYS5hP2EuYShGKGUpLEYobikpOmEuY2FsbChudWxsLEYoZSksRihuKSksZC5jKGEsRyhlKSxHKG4pKSk6bnVsbH0sbnVsbCxudWxsKX1mdW5jdGlvbiBjKGEsYil7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgYz1FKGIpO2lmKGMpe2lmKEljKGMpKXtmb3IodmFyIGU9SGIoYyksbj1PKGUpLHE9bmV3IGxkKEFycmF5KG4pLDApLHQ9MDs7KWlmKHQ8bil7dmFyIHY9YS5iP2EuYihELmEoZSx0KSk6YS5jYWxsKG51bGwsRC5hKGUsdCkpO3EuYWRkKHYpO3QrPTF9ZWxzZSBicmVhaztyZXR1cm4gcGQocS5kYSgpLGQuYShhLEliKGMpKSl9cmV0dXJuIE0oYS5iP2EuYihGKGMpKTphLmNhbGwobnVsbCxGKGMpKSxkLmEoYSxHKGMpKSl9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9dmFyIGQ9bnVsbCxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLFxuZCxlLGYsdCl7dmFyIHY9bnVsbDs0PGFyZ3VtZW50cy5sZW5ndGgmJih2PUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsZix2KX1mdW5jdGlvbiBiKGEsYyxlLGYsaCl7dmFyIHY9ZnVuY3Rpb24geShhKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBiPWQuYShFLGEpO3JldHVybiBEZChGZCxiKT9NKGQuYShGLGIpLHkoZC5hKEcsYikpKTpudWxsfSxudWxsLG51bGwpfTtyZXR1cm4gZC5hKGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBTLmEoYSxiKX19KHYpLHYocGMuZChoLGYsSihbZSxjXSwwKSkpKX1hLms9NDthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGU9RihhKTthPUkoYSk7dmFyIGY9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGUsZixhKX07YS5kPWI7cmV0dXJuIGF9KCksZD1mdW5jdGlvbihkLGgsayxsLFxubil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxoKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsaCxrKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsaCxrLGwpO2RlZmF1bHQ6cmV0dXJuIGUuZChkLGgsayxsLEooYXJndW1lbnRzLDQpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPTQ7ZC5mPWUuZjtkLmE9YztkLmM9YjtkLm49YTtkLmQ9ZS5kO3JldHVybiBkfSgpLE1kPWZ1bmN0aW9uIExkKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtpZigwPGIpe3ZhciBkPUUoYyk7cmV0dXJuIGQ/TShGKGQpLExkKGItMSxHKGQpKSk6bnVsbH1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX07XG5mdW5jdGlvbiBOZChhLGIpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKGMpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBjKGEsYil9fShmdW5jdGlvbihhLGIpe2Zvcig7Oyl7dmFyIGU9RShiKTtpZigwPGEmJmUpe3ZhciBmPWEtMSxlPUcoZSk7YT1mO2I9ZX1lbHNlIHJldHVybiBlfX0pLG51bGwsbnVsbCl9XG52YXIgT2Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIE1kKGEsYy5iKGIpKX1mdW5jdGlvbiBiKGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIE0oYSxjLmIoYSkpfSxudWxsLG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCksUGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIE1kKGEsYy5iKGIpKX1mdW5jdGlvbiBiKGEpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7cmV0dXJuIE0oYS5vP2EubygpOmEuY2FsbChudWxsKSxjLmIoYSkpfSxudWxsLG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLFxuYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxRZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBmPUUoYSksaD1FKGMpO3JldHVybiBmJiZoP00oRihmKSxNKEYoaCksYi5hKEcoZiksRyhoKSkpKTpudWxsfSxudWxsLG51bGwpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBjPUtkLmEoRSxwYy5kKGUsZCxKKFthXSwwKSkpO3JldHVybiBEZChGZCxjKT90ZC5hKEtkLmEoRixcbmMpLFMuYShiLEtkLmEoRyxjKSkpOm51bGx9LG51bGwsbnVsbCl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBiPUYoYSk7YT1JKGEpO3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBjKGIsZCxhKX07YS5kPWM7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmE9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIFJkKGEpe3JldHVybiBmdW5jdGlvbiBjKGEsZSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZj1FKGEpO3JldHVybiBmP00oRihmKSxjKEcoZiksZSkpOkUoZSk/YyhGKGUpLEcoZSkpOm51bGx9LG51bGwsbnVsbCl9KG51bGwsYSl9XG52YXIgU2Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIFJkKEtkLmEoYSxiKSl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGwpfWZ1bmN0aW9uIGIoYSxjLGQpe3JldHVybiBSZChTLm4oS2QsYSxjLGQpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtcbmIuaz0yO2IuZj1jLmY7Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxVZD1mdW5jdGlvbiBUZChiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGQ9RShjKTtpZihkKXtpZihJYyhkKSl7Zm9yKHZhciBlPUhiKGQpLGY9TyhlKSxoPW5ldyBsZChBcnJheShmKSwwKSxrPTA7OylpZihrPGYpe2lmKHIoYi5iP2IuYihELmEoZSxrKSk6Yi5jYWxsKG51bGwsRC5hKGUsaykpKSl7dmFyIGw9RC5hKGUsayk7aC5hZGQobCl9ays9MX1lbHNlIGJyZWFrO3JldHVybiBwZChoLmRhKCksVGQoYixJYihkKSkpfWU9RihkKTtkPUcoZCk7cmV0dXJuIHIoYi5iP2IuYihlKTpiLmNhbGwobnVsbCxlKSk/TShlLFRkKGIsZCkpOlRkKGIsZCl9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9O2Z1bmN0aW9uIFZkKGEsYil7cmV0dXJuIFVkKEdkKGEpLGIpfVxuZnVuY3Rpb24gV2QoYSl7dmFyIGI9WGQ7cmV0dXJuIGZ1bmN0aW9uIGQoYSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gTShhLHIoYi5iP2IuYihhKTpiLmNhbGwobnVsbCxhKSk/U2QuYShkLEUuYj9FLmIoYSk6RS5jYWxsKG51bGwsYSkpOm51bGwpfSxudWxsLG51bGwpfShhKX1mdW5jdGlvbiBZZChhLGIpe3JldHVybiBudWxsIT1hP2EmJihhLnEmNHx8YS5CYyk/dmQoQy5jKHpiLHliKGEpLGIpKTpDLmMoRGEsYSxiKTpDLmMocGMsSCxiKX1cbnZhciBaZD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsayl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgbD1FKGspO2lmKGwpe3ZhciBuPU1kKGEsbCk7cmV0dXJuIGE9PT1PKG4pP00obixkLm4oYSxiLGMsTmQoYixsKSkpOkRhKEgsTWQoYSx0ZC5hKG4sYykpKX1yZXR1cm4gbnVsbH0sbnVsbCxudWxsKX1mdW5jdGlvbiBiKGEsYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBrPUUoYyk7aWYoayl7dmFyIGw9TWQoYSxrKTtyZXR1cm4gYT09PU8obCk/TShsLGQuYyhhLGIsTmQoYixrKSkpOm51bGx9cmV0dXJuIG51bGx9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYyhhLGIpe3JldHVybiBkLmMoYSxhLGIpfXZhciBkPW51bGwsZD1mdW5jdGlvbihkLGYsaCxrKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBjLmNhbGwodGhpcyxkLGYpO2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsZCxmLGgpO2Nhc2UgNDpyZXR1cm4gYS5jYWxsKHRoaXMsXG5kLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5hPWM7ZC5jPWI7ZC5uPWE7cmV0dXJuIGR9KCksJGQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXt2YXIgaD1MYztmb3IoYj1FKGIpOzspaWYoYil7dmFyIGs9YTtpZihrP2suaSYyNTZ8fGsuTWJ8fChrLmk/MDpzKEthLGspKTpzKEthLGspKXthPVEuYyhhLEYoYiksaCk7aWYoaD09PWEpcmV0dXJuIGM7Yj1JKGIpfWVsc2UgcmV0dXJuIGN9ZWxzZSByZXR1cm4gYX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGIsbnVsbCl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxhZT1cbmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkLGYsdCl7dmFyIHY9UC5jKGIsMCxudWxsKTtyZXR1cm4oYj0kYyhiKSk/Ui5jKGEsdixlLlgoUS5hKGEsdiksYixjLGQsZix0KSk6Ui5jKGEsdixjLm4/Yy5uKFEuYShhLHYpLGQsZix0KTpjLmNhbGwobnVsbCxRLmEoYSx2KSxkLGYsdCkpfWZ1bmN0aW9uIGIoYSxiLGMsZCxmKXt2YXIgdD1QLmMoYiwwLG51bGwpO3JldHVybihiPSRjKGIpKT9SLmMoYSx0LGUucyhRLmEoYSx0KSxiLGMsZCxmKSk6Ui5jKGEsdCxjLmM/Yy5jKFEuYShhLHQpLGQsZik6Yy5jYWxsKG51bGwsUS5hKGEsdCksZCxmKSl9ZnVuY3Rpb24gYyhhLGIsYyxkKXt2YXIgZj1QLmMoYiwwLG51bGwpO3JldHVybihiPSRjKGIpKT9SLmMoYSxmLGUubihRLmEoYSxmKSxiLGMsZCkpOlIuYyhhLGYsYy5hP2MuYShRLmEoYSxmKSxkKTpjLmNhbGwobnVsbCxRLmEoYSxmKSxkKSl9ZnVuY3Rpb24gZChhLGIsYyl7dmFyIGQ9UC5jKGIsMCxudWxsKTtyZXR1cm4oYj0kYyhiKSk/XG5SLmMoYSxkLGUuYyhRLmEoYSxkKSxiLGMpKTpSLmMoYSxkLGMuYj9jLmIoUS5hKGEsZCkpOmMuY2FsbChudWxsLFEuYShhLGQpKSl9dmFyIGU9bnVsbCxmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShjLGQsZSxmLGgsdyx5KXt2YXIgQj1udWxsOzY8YXJndW1lbnRzLmxlbmd0aCYmKEI9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsNiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsZSxmLGgsdyxCKX1mdW5jdGlvbiBiKGEsYyxkLGYsaCxrLHkpe3ZhciBCPVAuYyhjLDAsbnVsbCk7cmV0dXJuKGM9JGMoYykpP1IuYyhhLEIsUy5kKGUsUS5hKGEsQiksYyxkLGYsSihbaCxrLHldLDApKSk6Ui5jKGEsQixTLmQoZCxRLmEoYSxCKSxmLGgsayxKKFt5XSwwKSkpfWEuaz02O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9SShhKTt2YXIgZj1GKGEpO2E9SShhKTt2YXIgaD1GKGEpO2E9SShhKTt2YXIgeT1cbkYoYSk7YT1HKGEpO3JldHVybiBiKGMsZCxlLGYsaCx5LGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxlPWZ1bmN0aW9uKGUsayxsLG4scSx0LHYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIGQuY2FsbCh0aGlzLGUsayxsKTtjYXNlIDQ6cmV0dXJuIGMuY2FsbCh0aGlzLGUsayxsLG4pO2Nhc2UgNTpyZXR1cm4gYi5jYWxsKHRoaXMsZSxrLGwsbixxKTtjYXNlIDY6cmV0dXJuIGEuY2FsbCh0aGlzLGUsayxsLG4scSx0KTtkZWZhdWx0OnJldHVybiBmLmQoZSxrLGwsbixxLHQsSihhcmd1bWVudHMsNikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtlLms9NjtlLmY9Zi5mO2UuYz1kO2Uubj1jO2Uucz1iO2UuWD1hO2UuZD1mLmQ7cmV0dXJuIGV9KCk7ZnVuY3Rpb24gYmUoYSxiKXt0aGlzLnQ9YTt0aGlzLmU9Yn1cbmZ1bmN0aW9uIGNlKGEpe3JldHVybiBuZXcgYmUoYSxbbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXSl9ZnVuY3Rpb24gZGUoYSl7cmV0dXJuIG5ldyBiZShhLnQsdmEoYS5lKSl9ZnVuY3Rpb24gZWUoYSl7YT1hLmc7cmV0dXJuIDMyPmE/MDphLTE+Pj41PDw1fWZ1bmN0aW9uIGZlKGEsYixjKXtmb3IoOzspe2lmKDA9PT1iKXJldHVybiBjO3ZhciBkPWNlKGEpO2QuZVswXT1jO2M9ZDtiLT01fX12YXIgaGU9ZnVuY3Rpb24gZ2UoYixjLGQsZSl7dmFyIGY9ZGUoZCksaD1iLmctMT4+PmMmMzE7NT09PWM/Zi5lW2hdPWU6KGQ9ZC5lW2hdLGI9bnVsbCE9ZD9nZShiLGMtNSxkLGUpOmZlKG51bGwsYy01LGUpLGYuZVtoXT1iKTtyZXR1cm4gZn07XG5mdW5jdGlvbiBpZShhLGIpe3Rocm93IEVycm9yKFwiTm8gaXRlbSBcIitBLmIoYSkrXCIgaW4gdmVjdG9yIG9mIGxlbmd0aCBcIitBLmIoYikpO31mdW5jdGlvbiBqZShhKXt2YXIgYj1hLnJvb3Q7Zm9yKGE9YS5zaGlmdDs7KWlmKDA8YSlhLT01LGI9Yi5lWzBdO2Vsc2UgcmV0dXJuIGIuZX1mdW5jdGlvbiBrZShhLGIpe2lmKGI+PWVlKGEpKXJldHVybiBhLlI7Zm9yKHZhciBjPWEucm9vdCxkPWEuc2hpZnQ7OylpZigwPGQpdmFyIGU9ZC01LGM9Yy5lW2I+Pj5kJjMxXSxkPWU7ZWxzZSByZXR1cm4gYy5lfWZ1bmN0aW9uIGxlKGEsYil7cmV0dXJuIDA8PWImJmI8YS5nP2tlKGEsYik6aWUoYixhLmcpfVxudmFyIG5lPWZ1bmN0aW9uIG1lKGIsYyxkLGUsZil7dmFyIGg9ZGUoZCk7aWYoMD09PWMpaC5lW2UmMzFdPWY7ZWxzZXt2YXIgaz1lPj4+YyYzMTtiPW1lKGIsYy01LGQuZVtrXSxlLGYpO2guZVtrXT1ifXJldHVybiBofSxwZT1mdW5jdGlvbiBvZShiLGMsZCl7dmFyIGU9Yi5nLTI+Pj5jJjMxO2lmKDU8Yyl7Yj1vZShiLGMtNSxkLmVbZV0pO2lmKG51bGw9PWImJjA9PT1lKXJldHVybiBudWxsO2Q9ZGUoZCk7ZC5lW2VdPWI7cmV0dXJuIGR9cmV0dXJuIDA9PT1lP251bGw6dT8oZD1kZShkKSxkLmVbZV09bnVsbCxkKTpudWxsfTtmdW5jdGlvbiBXKGEsYixjLGQsZSxmKXt0aGlzLmo9YTt0aGlzLmc9Yjt0aGlzLnNoaWZ0PWM7dGhpcy5yb290PWQ7dGhpcy5SPWU7dGhpcy5tPWY7dGhpcy5pPTE2NzY2ODUxMTt0aGlzLnE9ODE5Nn1nPVcucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O1xuZy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVyblwibnVtYmVyXCI9PT10eXBlb2YgYj9ELmModGhpcyxiLGMpOmN9O2cuWmE9ZnVuY3Rpb24oYSxiLGMpe2E9WzAsY107Zm9yKGM9MDs7KWlmKGM8dGhpcy5nKXt2YXIgZD1rZSh0aGlzLGMpLGU9ZC5sZW5ndGg7YTp7Zm9yKHZhciBmPTAsaD1hWzFdOzspaWYoZjxlKXtoPWIuYz9iLmMoaCxmK2MsZFtmXSk6Yi5jYWxsKG51bGwsaCxmK2MsZFtmXSk7aWYoZmMoaCkpe2Q9aDticmVhayBhfWYrPTF9ZWxzZXthWzBdPWU7ZD1hWzFdPWg7YnJlYWsgYX1kPXZvaWQgMH1pZihmYyhkKSlyZXR1cm4gSy5iP0suYihkKTpLLmNhbGwobnVsbCxkKTtjKz1hWzBdfWVsc2UgcmV0dXJuIGFbMV19O2cuSj1mdW5jdGlvbihhLGIpe3JldHVybiBsZSh0aGlzLGIpW2ImMzFdfTtcbmcuYWE9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAwPD1iJiZiPHRoaXMuZz9rZSh0aGlzLGIpW2ImMzFdOmN9O2cuUGE9ZnVuY3Rpb24oYSxiLGMpe2lmKDA8PWImJmI8dGhpcy5nKXJldHVybiBlZSh0aGlzKTw9Yj8oYT12YSh0aGlzLlIpLGFbYiYzMV09YyxuZXcgVyh0aGlzLmosdGhpcy5nLHRoaXMuc2hpZnQsdGhpcy5yb290LGEsbnVsbCkpOm5ldyBXKHRoaXMuaix0aGlzLmcsdGhpcy5zaGlmdCxuZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290LGIsYyksdGhpcy5SLG51bGwpO2lmKGI9PT10aGlzLmcpcmV0dXJuIERhKHRoaXMsYyk7aWYodSl0aHJvdyBFcnJvcihcIkluZGV4IFwiK0EuYihiKStcIiBvdXQgb2YgYm91bmRzICBbMCxcIitBLmIodGhpcy5nKStcIl1cIik7cmV0dXJuIG51bGx9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmd9O2cuJGE9ZnVuY3Rpb24oKXtyZXR1cm4gRC5hKHRoaXMsMCl9O1xuZy5hYj1mdW5jdGlvbigpe3JldHVybiBELmEodGhpcywxKX07Zy5JYT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuZz9ELmEodGhpcyx0aGlzLmctMSk6bnVsbH07Zy5KYT1mdW5jdGlvbigpe2lmKDA9PT10aGlzLmcpdGhyb3cgRXJyb3IoXCJDYW4ndCBwb3AgZW1wdHkgdmVjdG9yXCIpO2lmKDE9PT10aGlzLmcpcmV0dXJuIGViKHFlLHRoaXMuaik7aWYoMTx0aGlzLmctZWUodGhpcykpcmV0dXJuIG5ldyBXKHRoaXMuaix0aGlzLmctMSx0aGlzLnNoaWZ0LHRoaXMucm9vdCx0aGlzLlIuc2xpY2UoMCwtMSksbnVsbCk7aWYodSl7dmFyIGE9a2UodGhpcyx0aGlzLmctMiksYj1wZSh0aGlzLHRoaXMuc2hpZnQsdGhpcy5yb290KSxiPW51bGw9PWI/WDpiLGM9dGhpcy5nLTE7cmV0dXJuIDU8dGhpcy5zaGlmdCYmbnVsbD09Yi5lWzFdP25ldyBXKHRoaXMuaixjLHRoaXMuc2hpZnQtNSxiLmVbMF0sYSxudWxsKTpuZXcgVyh0aGlzLmosYyx0aGlzLnNoaWZ0LGIsYSxudWxsKX1yZXR1cm4gbnVsbH07XG5nLlhhPWZ1bmN0aW9uKCl7cmV0dXJuIDA8dGhpcy5nP25ldyBrYyh0aGlzLHRoaXMuZy0xLG51bGwpOm51bGx9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5XYT1mdW5jdGlvbigpe3JldHVybiBuZXcgcmUodGhpcy5nLHRoaXMuc2hpZnQsc2UuYj9zZS5iKHRoaXMucm9vdCk6c2UuY2FsbChudWxsLHRoaXMucm9vdCksdGUuYj90ZS5iKHRoaXMuUik6dGUuY2FsbChudWxsLHRoaXMuUikpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihxZSx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnYy5jKHRoaXMsYixjKX07XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXtpZihcIm51bWJlclwiPT09dHlwZW9mIGIpcmV0dXJuICRhKHRoaXMsYixjKTt0aHJvdyBFcnJvcihcIlZlY3RvcidzIGtleSBmb3IgYXNzb2MgbXVzdCBiZSBhIG51bWJlci5cIik7fTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuZz9udWxsOjMyPj10aGlzLmc/bmV3IGFjKHRoaXMuUiwwKTp1P3VlLm4/dWUubih0aGlzLGplKHRoaXMpLDAsMCk6dWUuY2FsbChudWxsLHRoaXMsamUodGhpcyksMCwwKTpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFcoYix0aGlzLmcsdGhpcy5zaGlmdCx0aGlzLnJvb3QsdGhpcy5SLHRoaXMubSl9O1xuZy5HPWZ1bmN0aW9uKGEsYil7aWYoMzI+dGhpcy5nLWVlKHRoaXMpKXtmb3IodmFyIGM9dGhpcy5SLmxlbmd0aCxkPUFycmF5KGMrMSksZT0wOzspaWYoZTxjKWRbZV09dGhpcy5SW2VdLGUrPTE7ZWxzZSBicmVhaztkW2NdPWI7cmV0dXJuIG5ldyBXKHRoaXMuaix0aGlzLmcrMSx0aGlzLnNoaWZ0LHRoaXMucm9vdCxkLG51bGwpfWM9KGQ9dGhpcy5nPj4+NT4xPDx0aGlzLnNoaWZ0KT90aGlzLnNoaWZ0KzU6dGhpcy5zaGlmdDtkPyhkPWNlKG51bGwpLGQuZVswXT10aGlzLnJvb3QsZT1mZShudWxsLHRoaXMuc2hpZnQsbmV3IGJlKG51bGwsdGhpcy5SKSksZC5lWzFdPWUpOmQ9aGUodGhpcyx0aGlzLnNoaWZ0LHRoaXMucm9vdCxuZXcgYmUobnVsbCx0aGlzLlIpKTtyZXR1cm4gbmV3IFcodGhpcy5qLHRoaXMuZysxLGMsZCxbYl0sbnVsbCl9O1xuZy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy5KKG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLmFhKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5KKG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmFhKG51bGwsYSxiKX07XG52YXIgWD1uZXcgYmUobnVsbCxbbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXSkscWU9bmV3IFcobnVsbCwwLDUsWCxbXSwwKTtmdW5jdGlvbiB2ZShhLGIpe3ZhciBjPWEubGVuZ3RoLGQ9Yj9hOnZhKGEpO2lmKDMyPmMpcmV0dXJuIG5ldyBXKG51bGwsYyw1LFgsZCxudWxsKTtmb3IodmFyIGU9MzIsZj0obmV3IFcobnVsbCwzMiw1LFgsZC5zbGljZSgwLDMyKSxudWxsKSkuV2EobnVsbCk7OylpZihlPGMpdmFyIGg9ZSsxLGY9d2QuYShmLGRbZV0pLGU9aDtlbHNlIHJldHVybiBBYihmKX1mdW5jdGlvbiB3ZShhKXtyZXR1cm4gQWIoQy5jKHpiLHliKHFlKSxhKSl9XG52YXIgeGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGEgaW5zdGFuY2VvZiBhYyYmMD09PWEucD92ZS5hP3ZlLmEoYS5lLCEwKTp2ZS5jYWxsKG51bGwsYS5lLCEwKTp3ZShhKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtmdW5jdGlvbiB5ZShhLGIsYyxkLGUsZil7dGhpcy5QPWE7dGhpcy5lYT1iO3RoaXMucD1jO3RoaXMuTz1kO3RoaXMuaj1lO3RoaXMubT1mO3RoaXMuaT0zMjI0Mzk0ODt0aGlzLnE9MTUzNn1nPXllLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtcbmcuVT1mdW5jdGlvbigpe2lmKHRoaXMuTysxPHRoaXMuZWEubGVuZ3RoKXt2YXIgYT11ZS5uP3VlLm4odGhpcy5QLHRoaXMuZWEsdGhpcy5wLHRoaXMuTysxKTp1ZS5jYWxsKG51bGwsdGhpcy5QLHRoaXMuZWEsdGhpcy5wLHRoaXMuTysxKTtyZXR1cm4gbnVsbD09YT9udWxsOmF9cmV0dXJuIEpiKHRoaXMpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKHFlLHRoaXMuail9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBnYy5hKHplLmM/emUuYyh0aGlzLlAsdGhpcy5wK3RoaXMuTyxPKHRoaXMuUCkpOnplLmNhbGwobnVsbCx0aGlzLlAsdGhpcy5wK3RoaXMuTyxPKHRoaXMuUCkpLGIpfTtcbmcuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGdjLmMoemUuYz96ZS5jKHRoaXMuUCx0aGlzLnArdGhpcy5PLE8odGhpcy5QKSk6emUuY2FsbChudWxsLHRoaXMuUCx0aGlzLnArdGhpcy5PLE8odGhpcy5QKSksYixjKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWFbdGhpcy5PXX07Zy5TPWZ1bmN0aW9uKCl7aWYodGhpcy5PKzE8dGhpcy5lYS5sZW5ndGgpe3ZhciBhPXVlLm4/dWUubih0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PKzEpOnVlLmNhbGwobnVsbCx0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PKzEpO3JldHVybiBudWxsPT1hP0g6YX1yZXR1cm4gSWIodGhpcyl9O2cuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtnLnNiPWZ1bmN0aW9uKCl7cmV0dXJuIG5kLmEodGhpcy5lYSx0aGlzLk8pfTtcbmcudGI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnArdGhpcy5lYS5sZW5ndGg7cmV0dXJuIGE8QWEodGhpcy5QKT91ZS5uP3VlLm4odGhpcy5QLGtlKHRoaXMuUCxhKSxhLDApOnVlLmNhbGwobnVsbCx0aGlzLlAsa2UodGhpcy5QLGEpLGEsMCk6SH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHVlLnM/dWUucyh0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PLGIpOnVlLmNhbGwobnVsbCx0aGlzLlAsdGhpcy5lYSx0aGlzLnAsdGhpcy5PLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtnLnJiPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5wK3RoaXMuZWEubGVuZ3RoO3JldHVybiBhPEFhKHRoaXMuUCk/dWUubj91ZS5uKHRoaXMuUCxrZSh0aGlzLlAsYSksYSwwKTp1ZS5jYWxsKG51bGwsdGhpcy5QLGtlKHRoaXMuUCxhKSxhLDApOm51bGx9O1xudmFyIHVlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkLGwpe3JldHVybiBuZXcgeWUoYSxiLGMsZCxsLG51bGwpfWZ1bmN0aW9uIGIoYSxiLGMsZCl7cmV0dXJuIG5ldyB5ZShhLGIsYyxkLG51bGwsbnVsbCl9ZnVuY3Rpb24gYyhhLGIsYyl7cmV0dXJuIG5ldyB5ZShhLGxlKGEsYiksYixjLG51bGwsbnVsbCl9dmFyIGQ9bnVsbCxkPWZ1bmN0aW9uKGQsZixoLGssbCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gYy5jYWxsKHRoaXMsZCxmLGgpO2Nhc2UgNDpyZXR1cm4gYi5jYWxsKHRoaXMsZCxmLGgsayk7Y2FzZSA1OnJldHVybiBhLmNhbGwodGhpcyxkLGYsaCxrLGwpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtkLmM9YztkLm49YjtkLnM9YTtyZXR1cm4gZH0oKTtcbmZ1bmN0aW9uIEFlKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5jYT1iO3RoaXMuc3RhcnQ9Yzt0aGlzLmVuZD1kO3RoaXMubT1lO3RoaXMuaT0xNjY2MTc4ODc7dGhpcy5xPTgxOTJ9Zz1BZS5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVyblwibnVtYmVyXCI9PT10eXBlb2YgYj9ELmModGhpcyxiLGMpOmN9O2cuSj1mdW5jdGlvbihhLGIpe3JldHVybiAwPmJ8fHRoaXMuZW5kPD10aGlzLnN0YXJ0K2I/aWUoYix0aGlzLmVuZC10aGlzLnN0YXJ0KTpELmEodGhpcy5jYSx0aGlzLnN0YXJ0K2IpfTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMD5ifHx0aGlzLmVuZDw9dGhpcy5zdGFydCtiP2M6RC5jKHRoaXMuY2EsdGhpcy5zdGFydCtiLGMpfTtcbmcuUGE9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMsZT1kLnN0YXJ0K2I7cmV0dXJuIEJlLnM/QmUucyhkLmosUi5jKGQuY2EsZSxjKSxkLnN0YXJ0LGZ1bmN0aW9uKCl7dmFyIGE9ZC5lbmQsYj1lKzE7cmV0dXJuIGE+Yj9hOmJ9KCksbnVsbCk6QmUuY2FsbChudWxsLGQuaixSLmMoZC5jYSxlLGMpLGQuc3RhcnQsZnVuY3Rpb24oKXt2YXIgYT1kLmVuZCxiPWUrMTtyZXR1cm4gYT5iP2E6Yn0oKSxudWxsKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZW5kLXRoaXMuc3RhcnR9O2cuSWE9ZnVuY3Rpb24oKXtyZXR1cm4gRC5hKHRoaXMuY2EsdGhpcy5lbmQtMSl9O1xuZy5KYT1mdW5jdGlvbigpe2lmKHRoaXMuc3RhcnQ9PT10aGlzLmVuZCl0aHJvdyBFcnJvcihcIkNhbid0IHBvcCBlbXB0eSB2ZWN0b3JcIik7cmV0dXJuIEJlLnM/QmUucyh0aGlzLmosdGhpcy5jYSx0aGlzLnN0YXJ0LHRoaXMuZW5kLTEsbnVsbCk6QmUuY2FsbChudWxsLHRoaXMuaix0aGlzLmNhLHRoaXMuc3RhcnQsdGhpcy5lbmQtMSxudWxsKX07Zy5YYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXJ0IT09dGhpcy5lbmQ/bmV3IGtjKHRoaXMsdGhpcy5lbmQtdGhpcy5zdGFydC0xLG51bGwpOm51bGx9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4ocWUsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEodGhpcyxiKX07XG5nLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnYy5jKHRoaXMsYixjKX07Zy51YT1mdW5jdGlvbihhLGIsYyl7aWYoXCJudW1iZXJcIj09PXR5cGVvZiBiKXJldHVybiAkYSh0aGlzLGIsYyk7dGhyb3cgRXJyb3IoXCJTdWJ2ZWMncyBrZXkgZm9yIGFzc29jIG11c3QgYmUgYSBudW1iZXIuXCIpO307Zy5IPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcztyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uIGQoZSl7cmV0dXJuIGU9PT1hLmVuZD9udWxsOk0oRC5hKGEuY2EsZSksbmV3IFYobnVsbCxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBkKGUrMSl9fShiKSxudWxsLG51bGwpKX19KHRoaXMpKGEuc3RhcnQpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQmUucz9CZS5zKGIsdGhpcy5jYSx0aGlzLnN0YXJ0LHRoaXMuZW5kLHRoaXMubSk6QmUuY2FsbChudWxsLGIsdGhpcy5jYSx0aGlzLnN0YXJ0LHRoaXMuZW5kLHRoaXMubSl9O1xuZy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEJlLnM/QmUucyh0aGlzLmosJGEodGhpcy5jYSx0aGlzLmVuZCxiKSx0aGlzLnN0YXJ0LHRoaXMuZW5kKzEsbnVsbCk6QmUuY2FsbChudWxsLHRoaXMuaiwkYSh0aGlzLmNhLHRoaXMuZW5kLGIpLHRoaXMuc3RhcnQsdGhpcy5lbmQrMSxudWxsKX07Zy5jYWxsPWZ1bmN0aW9uKCl7dmFyIGE9bnVsbDtyZXR1cm4gYT1mdW5jdGlvbihhLGMsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gdGhpcy5KKG51bGwsYyk7Y2FzZSAzOnJldHVybiB0aGlzLmFhKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5KKG51bGwsYSl9O1xuZy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuYWEobnVsbCxhLGIpfTtmdW5jdGlvbiBCZShhLGIsYyxkLGUpe2Zvcig7OylpZihiIGluc3RhbmNlb2YgQWUpYz1iLnN0YXJ0K2MsZD1iLnN0YXJ0K2QsYj1iLmNhO2Vsc2V7dmFyIGY9TyhiKTtpZigwPmN8fDA+ZHx8Yz5mfHxkPmYpdGhyb3cgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO3JldHVybiBuZXcgQWUoYSxiLGMsZCxlKX19XG52YXIgemU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtyZXR1cm4gQmUobnVsbCxhLGIsYyxudWxsKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGIsTyhhKSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKTtmdW5jdGlvbiBDZShhLGIpe3JldHVybiBhPT09Yi50P2I6bmV3IGJlKGEsdmEoYi5lKSl9ZnVuY3Rpb24gc2UoYSl7cmV0dXJuIG5ldyBiZSh7fSx2YShhLmUpKX1cbmZ1bmN0aW9uIHRlKGEpe3ZhciBiPVtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGxdO0tjKGEsMCxiLDAsYS5sZW5ndGgpO3JldHVybiBifVxudmFyIEVlPWZ1bmN0aW9uIERlKGIsYyxkLGUpe2Q9Q2UoYi5yb290LnQsZCk7dmFyIGY9Yi5nLTE+Pj5jJjMxO2lmKDU9PT1jKWI9ZTtlbHNle3ZhciBoPWQuZVtmXTtiPW51bGwhPWg/RGUoYixjLTUsaCxlKTpmZShiLnJvb3QudCxjLTUsZSl9ZC5lW2ZdPWI7cmV0dXJuIGR9LEdlPWZ1bmN0aW9uIEZlKGIsYyxkKXtkPUNlKGIucm9vdC50LGQpO3ZhciBlPWIuZy0yPj4+YyYzMTtpZig1PGMpe2I9RmUoYixjLTUsZC5lW2VdKTtpZihudWxsPT1iJiYwPT09ZSlyZXR1cm4gbnVsbDtkLmVbZV09YjtyZXR1cm4gZH1yZXR1cm4gMD09PWU/bnVsbDp1PyhkLmVbZV09bnVsbCxkKTpudWxsfTtmdW5jdGlvbiByZShhLGIsYyxkKXt0aGlzLmc9YTt0aGlzLnNoaWZ0PWI7dGhpcy5yb290PWM7dGhpcy5SPWQ7dGhpcy5pPTI3NTt0aGlzLnE9ODh9Zz1yZS5wcm90b3R5cGU7XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVyblwibnVtYmVyXCI9PT10eXBlb2YgYj9ELmModGhpcyxiLGMpOmN9O1xuZy5KPWZ1bmN0aW9uKGEsYil7aWYodGhpcy5yb290LnQpcmV0dXJuIGxlKHRoaXMsYilbYiYzMV07dGhyb3cgRXJyb3IoXCJudGggYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLmFhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMDw9YiYmYjx0aGlzLmc/RC5hKHRoaXMsYik6Y307Zy5MPWZ1bmN0aW9uKCl7aWYodGhpcy5yb290LnQpcmV0dXJuIHRoaXMuZzt0aHJvdyBFcnJvcihcImNvdW50IGFmdGVyIHBlcnNpc3RlbnQhXCIpO307XG5nLlBiPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzO2lmKGQucm9vdC50KXtpZigwPD1iJiZiPGQuZylyZXR1cm4gZWUodGhpcyk8PWI/ZC5SW2ImMzFdPWM6KGE9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24gZihhLGspe3ZhciBsPUNlKGQucm9vdC50LGspO2lmKDA9PT1hKWwuZVtiJjMxXT1jO2Vsc2V7dmFyIG49Yj4+PmEmMzEscT1mKGEtNSxsLmVbbl0pO2wuZVtuXT1xfXJldHVybiBsfX0odGhpcykuY2FsbChudWxsLGQuc2hpZnQsZC5yb290KSxkLnJvb3Q9YSksdGhpcztpZihiPT09ZC5nKXJldHVybiB6Yih0aGlzLGMpO2lmKHUpdGhyb3cgRXJyb3IoXCJJbmRleCBcIitBLmIoYikrXCIgb3V0IG9mIGJvdW5kcyBmb3IgVHJhbnNpZW50VmVjdG9yIG9mIGxlbmd0aFwiK0EuYihkLmcpKTtyZXR1cm4gbnVsbH10aHJvdyBFcnJvcihcImFzc29jISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O1xuZy5RYj1mdW5jdGlvbigpe2lmKHRoaXMucm9vdC50KXtpZigwPT09dGhpcy5nKXRocm93IEVycm9yKFwiQ2FuJ3QgcG9wIGVtcHR5IHZlY3RvclwiKTtpZigxPT09dGhpcy5nKXJldHVybiB0aGlzLmc9MCx0aGlzO2lmKDA8KHRoaXMuZy0xJjMxKSlyZXR1cm4gdGhpcy5nLT0xLHRoaXM7aWYodSl7dmFyIGE7YTppZihhPXRoaXMuZy0yLGE+PWVlKHRoaXMpKWE9dGhpcy5SO2Vsc2V7Zm9yKHZhciBiPXRoaXMucm9vdCxjPWIsZD10aGlzLnNoaWZ0OzspaWYoMDxkKWM9Q2UoYi50LGMuZVthPj4+ZCYzMV0pLGQtPTU7ZWxzZXthPWMuZTticmVhayBhfWE9dm9pZCAwfWI9R2UodGhpcyx0aGlzLnNoaWZ0LHRoaXMucm9vdCk7Yj1udWxsIT1iP2I6bmV3IGJlKHRoaXMucm9vdC50LFtudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxcbm51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF0pOzU8dGhpcy5zaGlmdCYmbnVsbD09Yi5lWzFdPyh0aGlzLnJvb3Q9Q2UodGhpcy5yb290LnQsYi5lWzBdKSx0aGlzLnNoaWZ0LT01KTp0aGlzLnJvb3Q9Yjt0aGlzLmctPTE7dGhpcy5SPWE7cmV0dXJuIHRoaXN9cmV0dXJuIG51bGx9dGhyb3cgRXJyb3IoXCJwb3AhIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5jYj1mdW5jdGlvbihhLGIsYyl7aWYoXCJudW1iZXJcIj09PXR5cGVvZiBiKXJldHVybiBEYih0aGlzLGIsYyk7dGhyb3cgRXJyb3IoXCJUcmFuc2llbnRWZWN0b3IncyBrZXkgZm9yIGFzc29jISBtdXN0IGJlIGEgbnVtYmVyLlwiKTt9O1xuZy5LYT1mdW5jdGlvbihhLGIpe2lmKHRoaXMucm9vdC50KXtpZigzMj50aGlzLmctZWUodGhpcykpdGhpcy5SW3RoaXMuZyYzMV09YjtlbHNle3ZhciBjPW5ldyBiZSh0aGlzLnJvb3QudCx0aGlzLlIpLGQ9W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF07ZFswXT1iO3RoaXMuUj1kO2lmKHRoaXMuZz4+PjU+MTw8dGhpcy5zaGlmdCl7dmFyIGQ9W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF0sZT10aGlzLnNoaWZ0K1xuNTtkWzBdPXRoaXMucm9vdDtkWzFdPWZlKHRoaXMucm9vdC50LHRoaXMuc2hpZnQsYyk7dGhpcy5yb290PW5ldyBiZSh0aGlzLnJvb3QudCxkKTt0aGlzLnNoaWZ0PWV9ZWxzZSB0aGlzLnJvb3Q9RWUodGhpcyx0aGlzLnNoaWZ0LHRoaXMucm9vdCxjKX10aGlzLmcrPTE7cmV0dXJuIHRoaXN9dGhyb3cgRXJyb3IoXCJjb25qISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2cuT2E9ZnVuY3Rpb24oKXtpZih0aGlzLnJvb3QudCl7dGhpcy5yb290LnQ9bnVsbDt2YXIgYT10aGlzLmctZWUodGhpcyksYj1BcnJheShhKTtLYyh0aGlzLlIsMCxiLDAsYSk7cmV0dXJuIG5ldyBXKG51bGwsdGhpcy5nLHRoaXMuc2hpZnQsdGhpcy5yb290LGIsbnVsbCl9dGhyb3cgRXJyb3IoXCJwZXJzaXN0ZW50ISBjYWxsZWQgdHdpY2VcIik7fTtmdW5jdGlvbiBIZShhLGIsYyxkKXt0aGlzLmo9YTt0aGlzLmJhPWI7dGhpcy5wYT1jO3RoaXMubT1kO3RoaXMucT0wO3RoaXMuaT0zMTg1MDU3Mn1nPUhlLnByb3RvdHlwZTtcbmcudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRih0aGlzLmJhKX07Zy5TPWZ1bmN0aW9uKCl7dmFyIGE9SSh0aGlzLmJhKTtyZXR1cm4gYT9uZXcgSGUodGhpcy5qLGEsdGhpcy5wYSxudWxsKTpudWxsPT10aGlzLnBhP0JhKHRoaXMpOm5ldyBIZSh0aGlzLmosdGhpcy5wYSxudWxsLG51bGwpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBIZShiLHRoaXMuYmEsdGhpcy5wYSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtcbmZ1bmN0aW9uIEllKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5jb3VudD1iO3RoaXMuYmE9Yzt0aGlzLnBhPWQ7dGhpcy5tPWU7dGhpcy5pPTMxODU4NzY2O3RoaXMucT04MTkyfWc9SWUucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvdW50fTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIEYodGhpcy5iYSl9O2cuSmE9ZnVuY3Rpb24oKXtpZihyKHRoaXMuYmEpKXt2YXIgYT1JKHRoaXMuYmEpO3JldHVybiBhP25ldyBJZSh0aGlzLmosdGhpcy5jb3VudC0xLGEsdGhpcy5wYSxudWxsKTpuZXcgSWUodGhpcy5qLHRoaXMuY291bnQtMSxFKHRoaXMucGEpLHFlLG51bGwpfXJldHVybiB0aGlzfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07XG5nLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIEplfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gRih0aGlzLmJhKX07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIEcoRSh0aGlzKSl9O2cuSD1mdW5jdGlvbigpe3ZhciBhPUUodGhpcy5wYSksYj10aGlzLmJhO3JldHVybiByKHIoYik/YjphKT9uZXcgSGUobnVsbCx0aGlzLmJhLEUoYSksbnVsbCk6bnVsbH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBJZShiLHRoaXMuY291bnQsdGhpcy5iYSx0aGlzLnBhLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3ZhciBjO3IodGhpcy5iYSk/KGM9dGhpcy5wYSxjPW5ldyBJZSh0aGlzLmosdGhpcy5jb3VudCsxLHRoaXMuYmEscGMuYShyKGMpP2M6cWUsYiksbnVsbCkpOmM9bmV3IEllKHRoaXMuaix0aGlzLmNvdW50KzEscGMuYSh0aGlzLmJhLGIpLHFlLG51bGwpO3JldHVybiBjfTt2YXIgSmU9bmV3IEllKG51bGwsMCxudWxsLHFlLDApO1xuZnVuY3Rpb24gS2UoKXt0aGlzLnE9MDt0aGlzLmk9MjA5NzE1Mn1LZS5wcm90b3R5cGUudj1mdW5jdGlvbigpe3JldHVybiExfTt2YXIgTGU9bmV3IEtlO2Z1bmN0aW9uIE1lKGEsYil7cmV0dXJuIE5jKEdjKGIpP08oYSk9PT1PKGIpP0RkKEZkLEtkLmEoZnVuY3Rpb24oYSl7cmV0dXJuIFdiLmEoUS5jKGIsRihhKSxMZSksRihJKGEpKSl9LGEpKTpudWxsOm51bGwpfWZ1bmN0aW9uIE5lKGEpe3RoaXMucj1hfU5lLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5yKXt2YXIgYT1GKHRoaXMucik7dGhpcy5yPUkodGhpcy5yKTtyZXR1cm57ZG9uZTohMSx2YWx1ZTphfX1yZXR1cm57ZG9uZTohMCx2YWx1ZTpudWxsfX07ZnVuY3Rpb24gT2UoYSl7cmV0dXJuIG5ldyBOZShFKGEpKX1mdW5jdGlvbiBQZShhKXt0aGlzLnI9YX1cblBlLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5yKXt2YXIgYT1GKHRoaXMuciksYj1QLmMoYSwwLG51bGwpLGE9UC5jKGEsMSxudWxsKTt0aGlzLnI9SSh0aGlzLnIpO3JldHVybntkb25lOiExLHZhbHVlOltiLGFdfX1yZXR1cm57ZG9uZTohMCx2YWx1ZTpudWxsfX07ZnVuY3Rpb24gUWUoYSl7cmV0dXJuIG5ldyBQZShFKGEpKX1mdW5jdGlvbiBSZShhKXt0aGlzLnI9YX1SZS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe2lmKG51bGwhPXRoaXMucil7dmFyIGE9Rih0aGlzLnIpO3RoaXMucj1JKHRoaXMucik7cmV0dXJue2RvbmU6ITEsdmFsdWU6W2EsYV19fXJldHVybntkb25lOiEwLHZhbHVlOm51bGx9fTtmdW5jdGlvbiBTZShhKXtyZXR1cm4gbmV3IFJlKEUoYSkpfVxuZnVuY3Rpb24gVGUoYSxiKXt2YXIgYz1hLmU7aWYoYiBpbnN0YW5jZW9mIFQpYTp7Zm9yKHZhciBkPWMubGVuZ3RoLGU9Yi5zYSxmPTA7Oyl7aWYoZDw9Zil7Yz0tMTticmVhayBhfXZhciBoPWNbZl07aWYoaCBpbnN0YW5jZW9mIFQmJmU9PT1oLnNhKXtjPWY7YnJlYWsgYX1pZih1KWYrPTI7ZWxzZXtjPW51bGw7YnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBpZihcInN0cmluZ1wiPT10eXBlb2YgYnx8XCJudW1iZXJcIj09PXR5cGVvZiBiKWE6e2Q9Yy5sZW5ndGg7Zm9yKGU9MDs7KXtpZihkPD1lKXtjPS0xO2JyZWFrIGF9aWYoYj09PWNbZV0pe2M9ZTticmVhayBhfWlmKHUpZSs9MjtlbHNle2M9bnVsbDticmVhayBhfX1jPXZvaWQgMH1lbHNlIGlmKGIgaW5zdGFuY2VvZiBaYilhOntkPWMubGVuZ3RoO2U9Yi5OYTtmb3IoZj0wOzspe2lmKGQ8PWYpe2M9LTE7YnJlYWsgYX1oPWNbZl07aWYoaCBpbnN0YW5jZW9mIFpiJiZlPT09aC5OYSl7Yz1mO2JyZWFrIGF9aWYodSlmKz0yO2Vsc2V7Yz1udWxsO1xuYnJlYWsgYX19Yz12b2lkIDB9ZWxzZSBpZihudWxsPT1iKWE6e2Q9Yy5sZW5ndGg7Zm9yKGU9MDs7KXtpZihkPD1lKXtjPS0xO2JyZWFrIGF9aWYobnVsbD09Y1tlXSl7Yz1lO2JyZWFrIGF9aWYodSllKz0yO2Vsc2V7Yz1udWxsO2JyZWFrIGF9fWM9dm9pZCAwfWVsc2UgaWYodSlhOntkPWMubGVuZ3RoO2ZvcihlPTA7Oyl7aWYoZDw9ZSl7Yz0tMTticmVhayBhfWlmKFdiLmEoYixjW2VdKSl7Yz1lO2JyZWFrIGF9aWYodSllKz0yO2Vsc2V7Yz1udWxsO2JyZWFrIGF9fWM9dm9pZCAwfWVsc2UgYz1udWxsO3JldHVybiBjfWZ1bmN0aW9uIFVlKGEsYixjKXt0aGlzLmU9YTt0aGlzLnA9Yjt0aGlzLlc9Yzt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ5OTB9Zz1VZS5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuV307XG5nLlU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wPHRoaXMuZS5sZW5ndGgtMj9uZXcgVWUodGhpcy5lLHRoaXMucCsyLHRoaXMuVyk6bnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuZS5sZW5ndGgtdGhpcy5wKS8yfTtnLkI9ZnVuY3Rpb24oKXtyZXR1cm4gY2ModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuVyl9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFcobnVsbCwyLDUsWCxbdGhpcy5lW3RoaXMucF0sdGhpcy5lW3RoaXMucCsxXV0sbnVsbCl9O2cuUz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnA8dGhpcy5lLmxlbmd0aC0yP25ldyBVZSh0aGlzLmUsdGhpcy5wKzIsdGhpcy5XKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307XG5nLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFVlKHRoaXMuZSx0aGlzLnAsYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2Z1bmN0aW9uIGxhKGEsYixjLGQpe3RoaXMuaj1hO3RoaXMuZz1iO3RoaXMuZT1jO3RoaXMubT1kO3RoaXMuaT0xNjY0Nzk1MTt0aGlzLnE9ODE5Nn1nPWxhLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLmtleXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoVmUuYj9WZS5iKHRoaXMpOlZlLmNhbGwobnVsbCx0aGlzKSl9O2cuZW50cmllcz1mdW5jdGlvbigpe3JldHVybiBRZShFKHRoaXMpKX07Zy52YWx1ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gT2UoV2UuYj9XZS5iKHRoaXMpOldlLmNhbGwobnVsbCx0aGlzKSl9O2cuaGFzPWZ1bmN0aW9uKGEpe3JldHVybiBPYyh0aGlzLGEpfTtnLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O1xuZy5mb3JFYWNoPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1FKHRoaXMpLGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKSxoPVAuYyhmLDAsbnVsbCksZj1QLmMoZiwxLG51bGwpO2EuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpO2UrPTF9ZWxzZSBpZihiPUUoYikpSWMoYik/KGM9SGIoYiksYj1JYihiKSxoPWMsZD1PKGMpLGM9aCk6KGM9RihiKSxoPVAuYyhjLDAsbnVsbCksZj1QLmMoYywxLG51bGwpLGEuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpLGI9SShiKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSByZXR1cm4gbnVsbH07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe2E9VGUodGhpcyxiKTtyZXR1cm4tMT09PWE/Yzp0aGlzLmVbYSsxXX07XG5nLlphPWZ1bmN0aW9uKGEsYixjKXthPXRoaXMuZS5sZW5ndGg7Zm9yKHZhciBkPTA7OylpZihkPGEpe2M9Yi5jP2IuYyhjLHRoaXMuZVtkXSx0aGlzLmVbZCsxXSk6Yi5jYWxsKG51bGwsYyx0aGlzLmVbZF0sdGhpcy5lW2QrMV0pO2lmKGZjKGMpKXJldHVybiBLLmI/Sy5iKGMpOksuY2FsbChudWxsLGMpO2QrPTJ9ZWxzZSByZXR1cm4gY307Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307Zy5CPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5tO3JldHVybiBudWxsIT1hP2E6dGhpcy5tPWE9ZGModGhpcyl9O2cudj1mdW5jdGlvbihhLGIpe3JldHVybiBNZSh0aGlzLGIpfTtnLldhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBYZSh7fSx0aGlzLmUubGVuZ3RoLHZhKHRoaXMuZSkpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gZWIoWWUsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07XG5nLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5uYj1mdW5jdGlvbihhLGIpe2lmKDA8PVRlKHRoaXMsYikpe3ZhciBjPXRoaXMuZS5sZW5ndGgsZD1jLTI7aWYoMD09PWQpcmV0dXJuIEJhKHRoaXMpO2Zvcih2YXIgZD1BcnJheShkKSxlPTAsZj0wOzspe2lmKGU+PWMpcmV0dXJuIG5ldyBsYSh0aGlzLmosdGhpcy5nLTEsZCxudWxsKTtpZihXYi5hKGIsdGhpcy5lW2VdKSllKz0yO2Vsc2UgaWYodSlkW2ZdPXRoaXMuZVtlXSxkW2YrMV09dGhpcy5lW2UrMV0sZis9MixlKz0yO2Vsc2UgcmV0dXJuIG51bGx9fWVsc2UgcmV0dXJuIHRoaXN9O1xuZy51YT1mdW5jdGlvbihhLGIsYyl7YT1UZSh0aGlzLGIpO2lmKC0xPT09YSl7aWYodGhpcy5nPFplKXthPXRoaXMuZTtmb3IodmFyIGQ9YS5sZW5ndGgsZT1BcnJheShkKzIpLGY9MDs7KWlmKGY8ZCllW2ZdPWFbZl0sZis9MTtlbHNlIGJyZWFrO2VbZF09YjtlW2QrMV09YztyZXR1cm4gbmV3IGxhKHRoaXMuaix0aGlzLmcrMSxlLG51bGwpfXJldHVybiBlYihPYShZZCgkZSx0aGlzKSxiLGMpLHRoaXMuail9cmV0dXJuIGM9PT10aGlzLmVbYSsxXT90aGlzOnU/KGI9dmEodGhpcy5lKSxiW2ErMV09YyxuZXcgbGEodGhpcy5qLHRoaXMuZyxiLG51bGwpKTpudWxsfTtnLmtiPWZ1bmN0aW9uKGEsYil7cmV0dXJuLTEhPT1UZSh0aGlzLGIpfTtnLkg9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmU7cmV0dXJuIDA8PWEubGVuZ3RoLTI/bmV3IFVlKGEsMCxudWxsKTpudWxsfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGxhKGIsdGhpcy5nLHRoaXMuZSx0aGlzLm0pfTtcbmcuRz1mdW5jdGlvbihhLGIpe2lmKEhjKGIpKXJldHVybiBPYSh0aGlzLEQuYShiLDApLEQuYShiLDEpKTtmb3IodmFyIGM9dGhpcyxkPUUoYik7Oyl7aWYobnVsbD09ZClyZXR1cm4gYzt2YXIgZT1GKGQpO2lmKEhjKGUpKWM9T2EoYyxELmEoZSwwKSxELmEoZSwxKSksZD1JKGQpO2Vsc2UgdGhyb3cgRXJyb3IoXCJjb25qIG9uIGEgbWFwIHRha2VzIG1hcCBlbnRyaWVzIG9yIHNlcWFibGVzIG9mIG1hcCBlbnRyaWVzXCIpO319O2cuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O1xuZy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O3ZhciBZZT1uZXcgbGEobnVsbCwwLFtdLG51bGwpLFplPTg7ZnVuY3Rpb24gYWYoYSl7Zm9yKHZhciBiPWEubGVuZ3RoLGM9MCxkPXliKFllKTs7KWlmKGM8Yil2YXIgZT1jKzIsZD1CYihkLGFbY10sYVtjKzFdKSxjPWU7ZWxzZSByZXR1cm4gQWIoZCl9ZnVuY3Rpb24gWGUoYSxiLGMpe3RoaXMuUmE9YTt0aGlzLmphPWI7dGhpcy5lPWM7dGhpcy5xPTU2O3RoaXMuaT0yNTh9Zz1YZS5wcm90b3R5cGU7XG5nLkFiPWZ1bmN0aW9uKGEsYil7aWYocih0aGlzLlJhKSl7dmFyIGM9VGUodGhpcyxiKTswPD1jJiYodGhpcy5lW2NdPXRoaXMuZVt0aGlzLmphLTJdLHRoaXMuZVtjKzFdPXRoaXMuZVt0aGlzLmphLTFdLGM9dGhpcy5lLGMucG9wKCksYy5wb3AoKSx0aGlzLmphLT0yKTtyZXR1cm4gdGhpc310aHJvdyBFcnJvcihcImRpc3NvYyEgYWZ0ZXIgcGVyc2lzdGVudCFcIik7fTtnLmNiPWZ1bmN0aW9uKGEsYixjKXtpZihyKHRoaXMuUmEpKXthPVRlKHRoaXMsYik7aWYoLTE9PT1hKXJldHVybiB0aGlzLmphKzI8PTIqWmU/KHRoaXMuamErPTIsdGhpcy5lLnB1c2goYiksdGhpcy5lLnB1c2goYyksdGhpcyk6eGQuYyhiZi5hP2JmLmEodGhpcy5qYSx0aGlzLmUpOmJmLmNhbGwobnVsbCx0aGlzLmphLHRoaXMuZSksYixjKTtjIT09dGhpcy5lW2ErMV0mJih0aGlzLmVbYSsxXT1jKTtyZXR1cm4gdGhpc310aHJvdyBFcnJvcihcImFzc29jISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O1xuZy5LYT1mdW5jdGlvbihhLGIpe2lmKHIodGhpcy5SYSkpe2lmKGI/Yi5pJjIwNDh8fGIuZGN8fChiLmk/MDpzKFNhLGIpKTpzKFNhLGIpKXJldHVybiBCYih0aGlzLGNmLmI/Y2YuYihiKTpjZi5jYWxsKG51bGwsYiksZGYuYj9kZi5iKGIpOmRmLmNhbGwobnVsbCxiKSk7Zm9yKHZhciBjPUUoYiksZD10aGlzOzspe3ZhciBlPUYoYyk7aWYocihlKSljPUkoYyksZD1CYihkLGNmLmI/Y2YuYihlKTpjZi5jYWxsKG51bGwsZSksZGYuYj9kZi5iKGUpOmRmLmNhbGwobnVsbCxlKSk7ZWxzZSByZXR1cm4gZH19ZWxzZSB0aHJvdyBFcnJvcihcImNvbmohIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5PYT1mdW5jdGlvbigpe2lmKHIodGhpcy5SYSkpcmV0dXJuIHRoaXMuUmE9ITEsbmV3IGxhKG51bGwsWWModGhpcy5qYSksdGhpcy5lLG51bGwpO3Rocm93IEVycm9yKFwicGVyc2lzdGVudCEgY2FsbGVkIHR3aWNlXCIpO307Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtcbmcuQz1mdW5jdGlvbihhLGIsYyl7aWYocih0aGlzLlJhKSlyZXR1cm4gYT1UZSh0aGlzLGIpLC0xPT09YT9jOnRoaXMuZVthKzFdO3Rocm93IEVycm9yKFwibG9va3VwIGFmdGVyIHBlcnNpc3RlbnQhXCIpO307Zy5MPWZ1bmN0aW9uKCl7aWYocih0aGlzLlJhKSlyZXR1cm4gWWModGhpcy5qYSk7dGhyb3cgRXJyb3IoXCJjb3VudCBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O2Z1bmN0aW9uIGJmKGEsYil7Zm9yKHZhciBjPXliKCRlKSxkPTA7OylpZihkPGEpYz14ZC5jKGMsYltkXSxiW2QrMV0pLGQrPTI7ZWxzZSByZXR1cm4gY31mdW5jdGlvbiBlZigpe3RoaXMubD0hMX1mdW5jdGlvbiBmZihhLGIpe3JldHVybiBhPT09Yj8hMDpoZChhLGIpPyEwOnU/V2IuYShhLGIpOm51bGx9XG52YXIgZ2Y9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGgsayl7YT12YShhKTthW2JdPWM7YVtoXT1rO3JldHVybiBhfWZ1bmN0aW9uIGIoYSxiLGMpe2E9dmEoYSk7YVtiXT1jO3JldHVybiBhfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSxmKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmLGgsayl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYz1iO2Mucz1hO3JldHVybiBjfSgpO2Z1bmN0aW9uIGhmKGEsYil7dmFyIGM9QXJyYXkoYS5sZW5ndGgtMik7S2MoYSwwLGMsMCwyKmIpO0tjKGEsMiooYisxKSxjLDIqYixjLmxlbmd0aC0yKmIpO3JldHVybiBjfVxudmFyIGpmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoLGssbCl7YT1hLkxhKGIpO2EuZVtjXT1oO2EuZVtrXT1sO3JldHVybiBhfWZ1bmN0aW9uIGIoYSxiLGMsaCl7YT1hLkxhKGIpO2EuZVtjXT1oO3JldHVybiBhfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZixoLGssbCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgNDpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlLGYsaCk7Y2FzZSA2OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoLGssbCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Mubj1iO2MuWD1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24ga2YoYSxiLGMpe2Zvcih2YXIgZD1hLmxlbmd0aCxlPTA7OylpZihlPGQpe3ZhciBmPWFbZV07bnVsbCE9Zj9jPWIuYz9iLmMoYyxmLGFbZSsxXSk6Yi5jYWxsKG51bGwsYyxmLGFbZSsxXSk6KGY9YVtlKzFdLGM9bnVsbCE9Zj9mLlRhKGIsYyk6Yyk7aWYoZmMoYykpcmV0dXJuIEsuYj9LLmIoYyk6Sy5jYWxsKG51bGwsYyk7ZSs9Mn1lbHNlIHJldHVybiBjfWZ1bmN0aW9uIGxmKGEsYixjKXt0aGlzLnQ9YTt0aGlzLkE9Yjt0aGlzLmU9Y31nPWxmLnByb3RvdHlwZTtnLkxhPWZ1bmN0aW9uKGEpe2lmKGE9PT10aGlzLnQpcmV0dXJuIHRoaXM7dmFyIGI9WmModGhpcy5BKSxjPUFycmF5KDA+Yj80OjIqKGIrMSkpO0tjKHRoaXMuZSwwLGMsMCwyKmIpO3JldHVybiBuZXcgbGYoYSx0aGlzLkEsYyl9O1xuZy5nYj1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPTE8PChjPj4+YiYzMSk7aWYoMD09PSh0aGlzLkEmZikpcmV0dXJuIHRoaXM7dmFyIGg9WmModGhpcy5BJmYtMSksaz10aGlzLmVbMipoXSxsPXRoaXMuZVsyKmgrMV07cmV0dXJuIG51bGw9PWs/KGI9bC5nYihhLGIrNSxjLGQsZSksYj09PWw/dGhpczpudWxsIT1iP2pmLm4odGhpcyxhLDIqaCsxLGIpOnRoaXMuQT09PWY/bnVsbDp1P21mKHRoaXMsYSxmLGgpOm51bGwpOmZmKGQsayk/KGVbMF09ITAsbWYodGhpcyxhLGYsaCkpOnU/dGhpczpudWxsfTtmdW5jdGlvbiBtZihhLGIsYyxkKXtpZihhLkE9PT1jKXJldHVybiBudWxsO2E9YS5MYShiKTtiPWEuZTt2YXIgZT1iLmxlbmd0aDthLkFePWM7S2MoYiwyKihkKzEpLGIsMipkLGUtMiooZCsxKSk7YltlLTJdPW51bGw7YltlLTFdPW51bGw7cmV0dXJuIGF9Zy5lYj1mdW5jdGlvbigpe3JldHVybiBuZi5iP25mLmIodGhpcy5lKTpuZi5jYWxsKG51bGwsdGhpcy5lKX07XG5nLlRhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGtmKHRoaXMuZSxhLGIpfTtnLk1hPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPTE8PChiPj4+YSYzMSk7aWYoMD09PSh0aGlzLkEmZSkpcmV0dXJuIGQ7dmFyIGY9WmModGhpcy5BJmUtMSksZT10aGlzLmVbMipmXSxmPXRoaXMuZVsyKmYrMV07cmV0dXJuIG51bGw9PWU/Zi5NYShhKzUsYixjLGQpOmZmKGMsZSk/Zjp1P2Q6bnVsbH07XG5nLmlhPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgaD0xPDwoYz4+PmImMzEpLGs9WmModGhpcy5BJmgtMSk7aWYoMD09PSh0aGlzLkEmaCkpe3ZhciBsPVpjKHRoaXMuQSk7aWYoMipsPHRoaXMuZS5sZW5ndGgpe2E9dGhpcy5MYShhKTtiPWEuZTtmLmw9ITA7YTpmb3IoYz0yKihsLWspLGY9MiprKyhjLTEpLGw9MiooaysxKSsoYy0xKTs7KXtpZigwPT09YylicmVhayBhO2JbbF09YltmXTtsLT0xO2MtPTE7Zi09MX1iWzIqa109ZDtiWzIqaysxXT1lO2EuQXw9aDtyZXR1cm4gYX1pZigxNjw9bCl7az1bbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsXTtrW2M+Pj5iJjMxXT1vZi5pYShhLGIrNSxjLGQsZSxmKTtmb3IoZT1kPTA7OylpZigzMj5kKTAhPT1cbih0aGlzLkE+Pj5kJjEpJiYoa1tkXT1udWxsIT10aGlzLmVbZV0/b2YuaWEoYSxiKzUsVGIodGhpcy5lW2VdKSx0aGlzLmVbZV0sdGhpcy5lW2UrMV0sZik6dGhpcy5lW2UrMV0sZSs9MiksZCs9MTtlbHNlIGJyZWFrO3JldHVybiBuZXcgcGYoYSxsKzEsayl9cmV0dXJuIHU/KGI9QXJyYXkoMioobCs0KSksS2ModGhpcy5lLDAsYiwwLDIqayksYlsyKmtdPWQsYlsyKmsrMV09ZSxLYyh0aGlzLmUsMiprLGIsMiooaysxKSwyKihsLWspKSxmLmw9ITAsYT10aGlzLkxhKGEpLGEuZT1iLGEuQXw9aCxhKTpudWxsfWw9dGhpcy5lWzIqa107aD10aGlzLmVbMiprKzFdO3JldHVybiBudWxsPT1sPyhsPWguaWEoYSxiKzUsYyxkLGUsZiksbD09PWg/dGhpczpqZi5uKHRoaXMsYSwyKmsrMSxsKSk6ZmYoZCxsKT9lPT09aD90aGlzOmpmLm4odGhpcyxhLDIqaysxLGUpOnU/KGYubD0hMCxqZi5YKHRoaXMsYSwyKmssbnVsbCwyKmsrMSxxZi5nYT9xZi5nYShhLGIrNSxsLGgsYyxkLGUpOnFmLmNhbGwobnVsbCxcbmEsYis1LGwsaCxjLGQsZSkpKTpudWxsfTtcbmcuaGE9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj0xPDwoYj4+PmEmMzEpLGg9WmModGhpcy5BJmYtMSk7aWYoMD09PSh0aGlzLkEmZikpe3ZhciBrPVpjKHRoaXMuQSk7aWYoMTY8PWspe2g9W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLG51bGwsbnVsbF07aFtiPj4+YSYzMV09b2YuaGEoYSs1LGIsYyxkLGUpO2ZvcihkPWM9MDs7KWlmKDMyPmMpMCE9PSh0aGlzLkE+Pj5jJjEpJiYoaFtjXT1udWxsIT10aGlzLmVbZF0/b2YuaGEoYSs1LFRiKHRoaXMuZVtkXSksdGhpcy5lW2RdLHRoaXMuZVtkKzFdLGUpOnRoaXMuZVtkKzFdLGQrPTIpLGMrPTE7ZWxzZSBicmVhaztyZXR1cm4gbmV3IHBmKG51bGwsaysxLGgpfWE9QXJyYXkoMiooaysxKSk7S2ModGhpcy5lLFxuMCxhLDAsMipoKTthWzIqaF09YzthWzIqaCsxXT1kO0tjKHRoaXMuZSwyKmgsYSwyKihoKzEpLDIqKGstaCkpO2UubD0hMDtyZXR1cm4gbmV3IGxmKG51bGwsdGhpcy5BfGYsYSl9az10aGlzLmVbMipoXTtmPXRoaXMuZVsyKmgrMV07cmV0dXJuIG51bGw9PWs/KGs9Zi5oYShhKzUsYixjLGQsZSksaz09PWY/dGhpczpuZXcgbGYobnVsbCx0aGlzLkEsZ2YuYyh0aGlzLmUsMipoKzEsaykpKTpmZihjLGspP2Q9PT1mP3RoaXM6bmV3IGxmKG51bGwsdGhpcy5BLGdmLmModGhpcy5lLDIqaCsxLGQpKTp1PyhlLmw9ITAsbmV3IGxmKG51bGwsdGhpcy5BLGdmLnModGhpcy5lLDIqaCxudWxsLDIqaCsxLHFmLlg/cWYuWChhKzUsayxmLGIsYyxkKTpxZi5jYWxsKG51bGwsYSs1LGssZixiLGMsZCkpKSk6bnVsbH07XG5nLmZiPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0xPDwoYj4+PmEmMzEpO2lmKDA9PT0odGhpcy5BJmQpKXJldHVybiB0aGlzO3ZhciBlPVpjKHRoaXMuQSZkLTEpLGY9dGhpcy5lWzIqZV0saD10aGlzLmVbMiplKzFdO3JldHVybiBudWxsPT1mPyhhPWguZmIoYSs1LGIsYyksYT09PWg/dGhpczpudWxsIT1hP25ldyBsZihudWxsLHRoaXMuQSxnZi5jKHRoaXMuZSwyKmUrMSxhKSk6dGhpcy5BPT09ZD9udWxsOnU/bmV3IGxmKG51bGwsdGhpcy5BXmQsaGYodGhpcy5lLGUpKTpudWxsKTpmZihjLGYpP25ldyBsZihudWxsLHRoaXMuQV5kLGhmKHRoaXMuZSxlKSk6dT90aGlzOm51bGx9O3ZhciBvZj1uZXcgbGYobnVsbCwwLFtdKTtcbmZ1bmN0aW9uIHJmKGEsYixjKXt2YXIgZD1hLmU7YT0yKihhLmctMSk7Zm9yKHZhciBlPUFycmF5KGEpLGY9MCxoPTEsaz0wOzspaWYoZjxhKWYhPT1jJiZudWxsIT1kW2ZdJiYoZVtoXT1kW2ZdLGgrPTIsa3w9MTw8ZiksZis9MTtlbHNlIHJldHVybiBuZXcgbGYoYixrLGUpfWZ1bmN0aW9uIHBmKGEsYixjKXt0aGlzLnQ9YTt0aGlzLmc9Yjt0aGlzLmU9Y31nPXBmLnByb3RvdHlwZTtnLkxhPWZ1bmN0aW9uKGEpe3JldHVybiBhPT09dGhpcy50P3RoaXM6bmV3IHBmKGEsdGhpcy5nLHZhKHRoaXMuZSkpfTtcbmcuZ2I9ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1jPj4+YiYzMSxoPXRoaXMuZVtmXTtpZihudWxsPT1oKXJldHVybiB0aGlzO2I9aC5nYihhLGIrNSxjLGQsZSk7aWYoYj09PWgpcmV0dXJuIHRoaXM7aWYobnVsbD09Yil7aWYoOD49dGhpcy5nKXJldHVybiByZih0aGlzLGEsZik7YT1qZi5uKHRoaXMsYSxmLGIpO2EuZy09MTtyZXR1cm4gYX1yZXR1cm4gdT9qZi5uKHRoaXMsYSxmLGIpOm51bGx9O2cuZWI9ZnVuY3Rpb24oKXtyZXR1cm4gc2YuYj9zZi5iKHRoaXMuZSk6c2YuY2FsbChudWxsLHRoaXMuZSl9O2cuVGE9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9dGhpcy5lLmxlbmd0aCxkPTAsZT1iOzspaWYoZDxjKXt2YXIgZj10aGlzLmVbZF07aWYobnVsbCE9ZiYmKGU9Zi5UYShhLGUpLGZjKGUpKSlyZXR1cm4gSy5iP0suYihlKTpLLmNhbGwobnVsbCxlKTtkKz0xfWVsc2UgcmV0dXJuIGV9O1xuZy5NYT1mdW5jdGlvbihhLGIsYyxkKXt2YXIgZT10aGlzLmVbYj4+PmEmMzFdO3JldHVybiBudWxsIT1lP2UuTWEoYSs1LGIsYyxkKTpkfTtnLmlhPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXt2YXIgaD1jPj4+YiYzMSxrPXRoaXMuZVtoXTtpZihudWxsPT1rKXJldHVybiBhPWpmLm4odGhpcyxhLGgsb2YuaWEoYSxiKzUsYyxkLGUsZikpLGEuZys9MSxhO2I9ay5pYShhLGIrNSxjLGQsZSxmKTtyZXR1cm4gYj09PWs/dGhpczpqZi5uKHRoaXMsYSxoLGIpfTtnLmhhPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9Yj4+PmEmMzEsaD10aGlzLmVbZl07aWYobnVsbD09aClyZXR1cm4gbmV3IHBmKG51bGwsdGhpcy5nKzEsZ2YuYyh0aGlzLmUsZixvZi5oYShhKzUsYixjLGQsZSkpKTthPWguaGEoYSs1LGIsYyxkLGUpO3JldHVybiBhPT09aD90aGlzOm5ldyBwZihudWxsLHRoaXMuZyxnZi5jKHRoaXMuZSxmLGEpKX07XG5nLmZiPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iPj4+YSYzMSxlPXRoaXMuZVtkXTtyZXR1cm4gbnVsbCE9ZT8oYT1lLmZiKGErNSxiLGMpLGE9PT1lP3RoaXM6bnVsbD09YT84Pj10aGlzLmc/cmYodGhpcyxudWxsLGQpOm5ldyBwZihudWxsLHRoaXMuZy0xLGdmLmModGhpcy5lLGQsYSkpOnU/bmV3IHBmKG51bGwsdGhpcy5nLGdmLmModGhpcy5lLGQsYSkpOm51bGwpOnRoaXN9O2Z1bmN0aW9uIHRmKGEsYixjKXtiKj0yO2Zvcih2YXIgZD0wOzspaWYoZDxiKXtpZihmZihjLGFbZF0pKXJldHVybiBkO2QrPTJ9ZWxzZSByZXR1cm4tMX1mdW5jdGlvbiB1ZihhLGIsYyxkKXt0aGlzLnQ9YTt0aGlzLnJhPWI7dGhpcy5nPWM7dGhpcy5lPWR9Zz11Zi5wcm90b3R5cGU7XG5nLkxhPWZ1bmN0aW9uKGEpe2lmKGE9PT10aGlzLnQpcmV0dXJuIHRoaXM7dmFyIGI9QXJyYXkoMioodGhpcy5nKzEpKTtLYyh0aGlzLmUsMCxiLDAsMip0aGlzLmcpO3JldHVybiBuZXcgdWYoYSx0aGlzLnJhLHRoaXMuZyxiKX07Zy5nYj1mdW5jdGlvbihhLGIsYyxkLGUpe2I9dGYodGhpcy5lLHRoaXMuZyxkKTtpZigtMT09PWIpcmV0dXJuIHRoaXM7ZVswXT0hMDtpZigxPT09dGhpcy5nKXJldHVybiBudWxsO2E9dGhpcy5MYShhKTtlPWEuZTtlW2JdPWVbMip0aGlzLmctMl07ZVtiKzFdPWVbMip0aGlzLmctMV07ZVsyKnRoaXMuZy0xXT1udWxsO2VbMip0aGlzLmctMl09bnVsbDthLmctPTE7cmV0dXJuIGF9O2cuZWI9ZnVuY3Rpb24oKXtyZXR1cm4gbmYuYj9uZi5iKHRoaXMuZSk6bmYuY2FsbChudWxsLHRoaXMuZSl9O2cuVGE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4ga2YodGhpcy5lLGEsYil9O1xuZy5NYT1mdW5jdGlvbihhLGIsYyxkKXthPXRmKHRoaXMuZSx0aGlzLmcsYyk7cmV0dXJuIDA+YT9kOmZmKGMsdGhpcy5lW2FdKT90aGlzLmVbYSsxXTp1P2Q6bnVsbH07XG5nLmlhPWZ1bmN0aW9uKGEsYixjLGQsZSxmKXtpZihjPT09dGhpcy5yYSl7Yj10Zih0aGlzLmUsdGhpcy5nLGQpO2lmKC0xPT09Yil7aWYodGhpcy5lLmxlbmd0aD4yKnRoaXMuZylyZXR1cm4gYT1qZi5YKHRoaXMsYSwyKnRoaXMuZyxkLDIqdGhpcy5nKzEsZSksZi5sPSEwLGEuZys9MSxhO2M9dGhpcy5lLmxlbmd0aDtiPUFycmF5KGMrMik7S2ModGhpcy5lLDAsYiwwLGMpO2JbY109ZDtiW2MrMV09ZTtmLmw9ITA7Zj10aGlzLmcrMTthPT09dGhpcy50Pyh0aGlzLmU9Yix0aGlzLmc9ZixhPXRoaXMpOmE9bmV3IHVmKHRoaXMudCx0aGlzLnJhLGYsYik7cmV0dXJuIGF9cmV0dXJuIHRoaXMuZVtiKzFdPT09ZT90aGlzOmpmLm4odGhpcyxhLGIrMSxlKX1yZXR1cm4obmV3IGxmKGEsMTw8KHRoaXMucmE+Pj5iJjMxKSxbbnVsbCx0aGlzLG51bGwsbnVsbF0pKS5pYShhLGIsYyxkLGUsZil9O1xuZy5oYT1mdW5jdGlvbihhLGIsYyxkLGUpe3JldHVybiBiPT09dGhpcy5yYT8oYT10Zih0aGlzLmUsdGhpcy5nLGMpLC0xPT09YT8oYT0yKnRoaXMuZyxiPUFycmF5KGErMiksS2ModGhpcy5lLDAsYiwwLGEpLGJbYV09YyxiW2ErMV09ZCxlLmw9ITAsbmV3IHVmKG51bGwsdGhpcy5yYSx0aGlzLmcrMSxiKSk6V2IuYSh0aGlzLmVbYV0sZCk/dGhpczpuZXcgdWYobnVsbCx0aGlzLnJhLHRoaXMuZyxnZi5jKHRoaXMuZSxhKzEsZCkpKToobmV3IGxmKG51bGwsMTw8KHRoaXMucmE+Pj5hJjMxKSxbbnVsbCx0aGlzXSkpLmhhKGEsYixjLGQsZSl9O2cuZmI9ZnVuY3Rpb24oYSxiLGMpe2E9dGYodGhpcy5lLHRoaXMuZyxjKTtyZXR1cm4tMT09PWE/dGhpczoxPT09dGhpcy5nP251bGw6dT9uZXcgdWYobnVsbCx0aGlzLnJhLHRoaXMuZy0xLGhmKHRoaXMuZSxZYyhhKSkpOm51bGx9O1xudmFyIHFmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoLGssbCxuKXt2YXIgcT1UYihjKTtpZihxPT09aylyZXR1cm4gbmV3IHVmKG51bGwscSwyLFtjLGgsbCxuXSk7dmFyIHQ9bmV3IGVmO3JldHVybiBvZi5pYShhLGIscSxjLGgsdCkuaWEoYSxiLGssbCxuLHQpfWZ1bmN0aW9uIGIoYSxiLGMsaCxrLGwpe3ZhciBuPVRiKGIpO2lmKG49PT1oKXJldHVybiBuZXcgdWYobnVsbCxuLDIsW2IsYyxrLGxdKTt2YXIgcT1uZXcgZWY7cmV0dXJuIG9mLmhhKGEsbixiLGMscSkuaGEoYSxoLGssbCxxKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCxrLGwsbil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgNjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlLGYsaCxrLGwpO2Nhc2UgNzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCxrLGwsbil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuWD1iO2MuZ2E9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIHZmKGEsYixjLGQsZSl7dGhpcy5qPWE7dGhpcy5rYT1iO3RoaXMucD1jO3RoaXMucj1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjM3NDg2MH1nPXZmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiBudWxsPT10aGlzLnI/bmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rYVt0aGlzLnBdLHRoaXMua2FbdGhpcy5wKzFdXSxudWxsKTpGKHRoaXMucil9O1xuZy5TPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PXRoaXMucj9uZi5jP25mLmModGhpcy5rYSx0aGlzLnArMixudWxsKTpuZi5jYWxsKG51bGwsdGhpcy5rYSx0aGlzLnArMixudWxsKTpuZi5jP25mLmModGhpcy5rYSx0aGlzLnAsSSh0aGlzLnIpKTpuZi5jYWxsKG51bGwsdGhpcy5rYSx0aGlzLnAsSSh0aGlzLnIpKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgdmYoYix0aGlzLmthLHRoaXMucCx0aGlzLnIsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07XG52YXIgbmY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjKXtpZihudWxsPT1jKWZvcihjPWEubGVuZ3RoOzspaWYoYjxjKXtpZihudWxsIT1hW2JdKXJldHVybiBuZXcgdmYobnVsbCxhLGIsbnVsbCxudWxsKTt2YXIgaD1hW2IrMV07aWYocihoKSYmKGg9aC5lYigpLHIoaCkpKXJldHVybiBuZXcgdmYobnVsbCxhLGIrMixoLG51bGwpO2IrPTJ9ZWxzZSByZXR1cm4gbnVsbDtlbHNlIHJldHVybiBuZXcgdmYobnVsbCxhLGIsYyxudWxsKX1mdW5jdGlvbiBiKGEpe3JldHVybiBjLmMoYSwwLG51bGwpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYz1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gd2YoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLmthPWI7dGhpcy5wPWM7dGhpcy5yPWQ7dGhpcy5tPWU7dGhpcy5xPTA7dGhpcy5pPTMyMzc0ODYwfWc9d2YucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIE4oSCx0aGlzLmopfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmMuYShiLHRoaXMpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuYy5jKGIsYyx0aGlzKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIEYodGhpcy5yKX07XG5nLlM9ZnVuY3Rpb24oKXtyZXR1cm4gc2Yubj9zZi5uKG51bGwsdGhpcy5rYSx0aGlzLnAsSSh0aGlzLnIpKTpzZi5jYWxsKG51bGwsbnVsbCx0aGlzLmthLHRoaXMucCxJKHRoaXMucikpfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyB3ZihiLHRoaXMua2EsdGhpcy5wLHRoaXMucix0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtcbnZhciBzZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiLGMsaCl7aWYobnVsbD09aClmb3IoaD1iLmxlbmd0aDs7KWlmKGM8aCl7dmFyIGs9YltjXTtpZihyKGspJiYoaz1rLmViKCkscihrKSkpcmV0dXJuIG5ldyB3ZihhLGIsYysxLGssbnVsbCk7Yys9MX1lbHNlIHJldHVybiBudWxsO2Vsc2UgcmV0dXJuIG5ldyB3ZihhLGIsYyxoLG51bGwpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGMubihudWxsLGEsMCxudWxsKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSA0OnJldHVybiBhLmNhbGwodGhpcyxjLGUsZixoKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5uPWE7cmV0dXJuIGN9KCk7XG5mdW5jdGlvbiB4ZihhLGIsYyxkLGUsZil7dGhpcy5qPWE7dGhpcy5nPWI7dGhpcy5yb290PWM7dGhpcy5UPWQ7dGhpcy5ZPWU7dGhpcy5tPWY7dGhpcy5pPTE2MTIzNjYzO3RoaXMucT04MTk2fWc9eGYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cua2V5cz1mdW5jdGlvbigpe3JldHVybiBPZShWZS5iP1ZlLmIodGhpcyk6VmUuY2FsbChudWxsLHRoaXMpKX07Zy5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIFFlKEUodGhpcykpfTtnLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiBPZShXZS5iP1dlLmIodGhpcyk6V2UuY2FsbChudWxsLHRoaXMpKX07Zy5oYXM9ZnVuY3Rpb24oYSl7cmV0dXJuIE9jKHRoaXMsYSl9O2cuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07XG5nLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/dGhpcy5UP3RoaXMuWTpjOm51bGw9PXRoaXMucm9vdD9jOnU/dGhpcy5yb290Lk1hKDAsVGIoYiksYixjKTpudWxsfTtcbmcuWmE9ZnVuY3Rpb24oYSxiLGMpe2E9dGhpcy5UP2IuYz9iLmMoYyxudWxsLHRoaXMuWSk6Yi5jYWxsKG51bGwsYyxudWxsLHRoaXMuWSk6YztyZXR1cm4gZmMoYSk/Sy5iP0suYihhKTpLLmNhbGwobnVsbCxhKTpudWxsIT10aGlzLnJvb3Q/dGhpcy5yb290LlRhKGIsYSk6dT9hOm51bGx9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O2cuTD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmd9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTWUodGhpcyxiKX07Zy5XYT1mdW5jdGlvbigpe3JldHVybiBuZXcgeWYoe30sdGhpcy5yb290LHRoaXMuZyx0aGlzLlQsdGhpcy5ZKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIGViKCRlLHRoaXMuail9O1xuZy5uYj1mdW5jdGlvbihhLGIpe2lmKG51bGw9PWIpcmV0dXJuIHRoaXMuVD9uZXcgeGYodGhpcy5qLHRoaXMuZy0xLHRoaXMucm9vdCwhMSxudWxsLG51bGwpOnRoaXM7aWYobnVsbD09dGhpcy5yb290KXJldHVybiB0aGlzO2lmKHUpe3ZhciBjPXRoaXMucm9vdC5mYigwLFRiKGIpLGIpO3JldHVybiBjPT09dGhpcy5yb290P3RoaXM6bmV3IHhmKHRoaXMuaix0aGlzLmctMSxjLHRoaXMuVCx0aGlzLlksbnVsbCl9cmV0dXJuIG51bGx9O1xuZy51YT1mdW5jdGlvbihhLGIsYyl7aWYobnVsbD09YilyZXR1cm4gdGhpcy5UJiZjPT09dGhpcy5ZP3RoaXM6bmV3IHhmKHRoaXMuaix0aGlzLlQ/dGhpcy5nOnRoaXMuZysxLHRoaXMucm9vdCwhMCxjLG51bGwpO2E9bmV3IGVmO2I9KG51bGw9PXRoaXMucm9vdD9vZjp0aGlzLnJvb3QpLmhhKDAsVGIoYiksYixjLGEpO3JldHVybiBiPT09dGhpcy5yb290P3RoaXM6bmV3IHhmKHRoaXMuaixhLmw/dGhpcy5nKzE6dGhpcy5nLGIsdGhpcy5ULHRoaXMuWSxudWxsKX07Zy5rYj1mdW5jdGlvbihhLGIpe3JldHVybiBudWxsPT1iP3RoaXMuVDpudWxsPT10aGlzLnJvb3Q/ITE6dT90aGlzLnJvb3QuTWEoMCxUYihiKSxiLExjKSE9PUxjOm51bGx9O2cuSD1mdW5jdGlvbigpe2lmKDA8dGhpcy5nKXt2YXIgYT1udWxsIT10aGlzLnJvb3Q/dGhpcy5yb290LmViKCk6bnVsbDtyZXR1cm4gdGhpcy5UP00obmV3IFcobnVsbCwyLDUsWCxbbnVsbCx0aGlzLlldLG51bGwpLGEpOmF9cmV0dXJuIG51bGx9O1xuZy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyB4ZihiLHRoaXMuZyx0aGlzLnJvb3QsdGhpcy5ULHRoaXMuWSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtpZihIYyhiKSlyZXR1cm4gT2EodGhpcyxELmEoYiwwKSxELmEoYiwxKSk7Zm9yKHZhciBjPXRoaXMsZD1FKGIpOzspe2lmKG51bGw9PWQpcmV0dXJuIGM7dmFyIGU9RihkKTtpZihIYyhlKSljPU9hKGMsRC5hKGUsMCksRC5hKGUsMSkpLGQ9SShkKTtlbHNlIHRocm93IEVycm9yKFwiY29uaiBvbiBhIG1hcCB0YWtlcyBtYXAgZW50cmllcyBvciBzZXFhYmxlcyBvZiBtYXAgZW50cmllc1wiKTt9fTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTt2YXIgJGU9bmV3IHhmKG51bGwsMCxudWxsLCExLG51bGwsMCk7ZnVuY3Rpb24gc2MoYSxiKXtmb3IodmFyIGM9YS5sZW5ndGgsZD0wLGU9eWIoJGUpOzspaWYoZDxjKXZhciBmPWQrMSxlPWUuY2IobnVsbCxhW2RdLGJbZF0pLGQ9ZjtlbHNlIHJldHVybiBBYihlKX1cbmZ1bmN0aW9uIHlmKGEsYixjLGQsZSl7dGhpcy50PWE7dGhpcy5yb290PWI7dGhpcy5jb3VudD1jO3RoaXMuVD1kO3RoaXMuWT1lO3RoaXMucT01Njt0aGlzLmk9MjU4fWc9eWYucHJvdG90eXBlO2cuQWI9ZnVuY3Rpb24oYSxiKXtpZih0aGlzLnQpaWYobnVsbD09Yil0aGlzLlQmJih0aGlzLlQ9ITEsdGhpcy5ZPW51bGwsdGhpcy5jb3VudC09MSk7ZWxzZXtpZihudWxsIT10aGlzLnJvb3Qpe3ZhciBjPW5ldyBlZixkPXRoaXMucm9vdC5nYih0aGlzLnQsMCxUYihiKSxiLGMpO2QhPT10aGlzLnJvb3QmJih0aGlzLnJvb3Q9ZCk7cihjWzBdKSYmKHRoaXMuY291bnQtPTEpfX1lbHNlIHRocm93IEVycm9yKFwiZGlzc29jISBhZnRlciBwZXJzaXN0ZW50IVwiKTtyZXR1cm4gdGhpc307Zy5jYj1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHpmKHRoaXMsYixjKX07XG5nLkthPWZ1bmN0aW9uKGEsYil7dmFyIGM7YTp7aWYodGhpcy50KXtpZihiP2IuaSYyMDQ4fHxiLmRjfHwoYi5pPzA6cyhTYSxiKSk6cyhTYSxiKSl7Yz16Zih0aGlzLGNmLmI/Y2YuYihiKTpjZi5jYWxsKG51bGwsYiksZGYuYj9kZi5iKGIpOmRmLmNhbGwobnVsbCxiKSk7YnJlYWsgYX1jPUUoYik7Zm9yKHZhciBkPXRoaXM7Oyl7dmFyIGU9RihjKTtpZihyKGUpKWM9SShjKSxkPXpmKGQsY2YuYj9jZi5iKGUpOmNmLmNhbGwobnVsbCxlKSxkZi5iP2RmLmIoZSk6ZGYuY2FsbChudWxsLGUpKTtlbHNle2M9ZDticmVhayBhfX19ZWxzZSB0aHJvdyBFcnJvcihcImNvbmohIGFmdGVyIHBlcnNpc3RlbnRcIik7Yz12b2lkIDB9cmV0dXJuIGN9O1xuZy5PYT1mdW5jdGlvbigpe3ZhciBhO2lmKHRoaXMudCl0aGlzLnQ9bnVsbCxhPW5ldyB4ZihudWxsLHRoaXMuY291bnQsdGhpcy5yb290LHRoaXMuVCx0aGlzLlksbnVsbCk7ZWxzZSB0aHJvdyBFcnJvcihcInBlcnNpc3RlbnQhIGNhbGxlZCB0d2ljZVwiKTtyZXR1cm4gYX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGw9PWI/dGhpcy5UP3RoaXMuWTpudWxsOm51bGw9PXRoaXMucm9vdD9udWxsOnRoaXMucm9vdC5NYSgwLFRiKGIpLGIpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsPT1iP3RoaXMuVD90aGlzLlk6YzpudWxsPT10aGlzLnJvb3Q/Yzp0aGlzLnJvb3QuTWEoMCxUYihiKSxiLGMpfTtnLkw9ZnVuY3Rpb24oKXtpZih0aGlzLnQpcmV0dXJuIHRoaXMuY291bnQ7dGhyb3cgRXJyb3IoXCJjb3VudCBhZnRlciBwZXJzaXN0ZW50IVwiKTt9O1xuZnVuY3Rpb24gemYoYSxiLGMpe2lmKGEudCl7aWYobnVsbD09YilhLlkhPT1jJiYoYS5ZPWMpLGEuVHx8KGEuY291bnQrPTEsYS5UPSEwKTtlbHNle3ZhciBkPW5ldyBlZjtiPShudWxsPT1hLnJvb3Q/b2Y6YS5yb290KS5pYShhLnQsMCxUYihiKSxiLGMsZCk7YiE9PWEucm9vdCYmKGEucm9vdD1iKTtkLmwmJihhLmNvdW50Kz0xKX1yZXR1cm4gYX10aHJvdyBFcnJvcihcImFzc29jISBhZnRlciBwZXJzaXN0ZW50IVwiKTt9ZnVuY3Rpb24gQWYoYSxiLGMpe2Zvcih2YXIgZD1iOzspaWYobnVsbCE9YSliPWM/YS5sZWZ0OmEucmlnaHQsZD1wYy5hKGQsYSksYT1iO2Vsc2UgcmV0dXJuIGR9ZnVuY3Rpb24gQmYoYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLnN0YWNrPWI7dGhpcy5pYj1jO3RoaXMuZz1kO3RoaXMubT1lO3RoaXMucT0wO3RoaXMuaT0zMjM3NDg2Mn1nPUJmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtcbmcuTD1mdW5jdGlvbigpe3JldHVybiAwPnRoaXMuZz9PKEkodGhpcykpKzE6dGhpcy5nfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB5Yyh0aGlzLnN0YWNrKX07Zy5TPWZ1bmN0aW9uKCl7dmFyIGE9Rih0aGlzLnN0YWNrKSxhPUFmKHRoaXMuaWI/YS5yaWdodDphLmxlZnQsSSh0aGlzLnN0YWNrKSx0aGlzLmliKTtyZXR1cm4gbnVsbCE9YT9uZXcgQmYobnVsbCxhLHRoaXMuaWIsdGhpcy5nLTEsbnVsbCk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O1xuZy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBCZihiLHRoaXMuc3RhY2ssdGhpcy5pYix0aGlzLmcsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIE0oYix0aGlzKX07ZnVuY3Rpb24gQ2YoYSxiLGMpe3JldHVybiBuZXcgQmYobnVsbCxBZihhLG51bGwsYiksYixjLG51bGwpfWZ1bmN0aW9uIERmKGEsYixjLGQpe3JldHVybiBjIGluc3RhbmNlb2YgWT9jLmxlZnQgaW5zdGFuY2VvZiBZP25ldyBZKGMua2V5LGMubCxjLmxlZnQucWEoKSxuZXcgJChhLGIsYy5yaWdodCxkLG51bGwpLG51bGwpOmMucmlnaHQgaW5zdGFuY2VvZiBZP25ldyBZKGMucmlnaHQua2V5LGMucmlnaHQubCxuZXcgJChjLmtleSxjLmwsYy5sZWZ0LGMucmlnaHQubGVmdCxudWxsKSxuZXcgJChhLGIsYy5yaWdodC5yaWdodCxkLG51bGwpLG51bGwpOnU/bmV3ICQoYSxiLGMsZCxudWxsKTpudWxsOm5ldyAkKGEsYixjLGQsbnVsbCl9XG5mdW5jdGlvbiBFZihhLGIsYyxkKXtyZXR1cm4gZCBpbnN0YW5jZW9mIFk/ZC5yaWdodCBpbnN0YW5jZW9mIFk/bmV3IFkoZC5rZXksZC5sLG5ldyAkKGEsYixjLGQubGVmdCxudWxsKSxkLnJpZ2h0LnFhKCksbnVsbCk6ZC5sZWZ0IGluc3RhbmNlb2YgWT9uZXcgWShkLmxlZnQua2V5LGQubGVmdC5sLG5ldyAkKGEsYixjLGQubGVmdC5sZWZ0LG51bGwpLG5ldyAkKGQua2V5LGQubCxkLmxlZnQucmlnaHQsZC5yaWdodCxudWxsKSxudWxsKTp1P25ldyAkKGEsYixjLGQsbnVsbCk6bnVsbDpuZXcgJChhLGIsYyxkLG51bGwpfVxuZnVuY3Rpb24gRmYoYSxiLGMsZCl7aWYoYyBpbnN0YW5jZW9mIFkpcmV0dXJuIG5ldyBZKGEsYixjLnFhKCksZCxudWxsKTtpZihkIGluc3RhbmNlb2YgJClyZXR1cm4gRWYoYSxiLGMsZC5oYigpKTtpZihkIGluc3RhbmNlb2YgWSYmZC5sZWZ0IGluc3RhbmNlb2YgJClyZXR1cm4gbmV3IFkoZC5sZWZ0LmtleSxkLmxlZnQubCxuZXcgJChhLGIsYyxkLmxlZnQubGVmdCxudWxsKSxFZihkLmtleSxkLmwsZC5sZWZ0LnJpZ2h0LGQucmlnaHQuaGIoKSksbnVsbCk7aWYodSl0aHJvdyBFcnJvcihcInJlZC1ibGFjayB0cmVlIGludmFyaWFudCB2aW9sYXRpb25cIik7cmV0dXJuIG51bGx9XG52YXIgSGY9ZnVuY3Rpb24gR2YoYixjLGQpe2Q9bnVsbCE9Yi5sZWZ0P0dmKGIubGVmdCxjLGQpOmQ7aWYoZmMoZCkpcmV0dXJuIEsuYj9LLmIoZCk6Sy5jYWxsKG51bGwsZCk7ZD1jLmM/Yy5jKGQsYi5rZXksYi5sKTpjLmNhbGwobnVsbCxkLGIua2V5LGIubCk7aWYoZmMoZCkpcmV0dXJuIEsuYj9LLmIoZCk6Sy5jYWxsKG51bGwsZCk7Yj1udWxsIT1iLnJpZ2h0P0dmKGIucmlnaHQsYyxkKTpkO3JldHVybiBmYyhiKT9LLmI/Sy5iKGIpOksuY2FsbChudWxsLGIpOmJ9O2Z1bmN0aW9uICQoYSxiLGMsZCxlKXt0aGlzLmtleT1hO3RoaXMubD1iO3RoaXMubGVmdD1jO3RoaXMucmlnaHQ9ZDt0aGlzLm09ZTt0aGlzLnE9MDt0aGlzLmk9MzI0MDIyMDd9Zz0kLnByb3RvdHlwZTtnLkhiPWZ1bmN0aW9uKGEpe3JldHVybiBhLkpiKHRoaXMpfTtnLmhiPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBZKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQsdGhpcy5yaWdodCxudWxsKX07Zy5xYT1mdW5jdGlvbigpe3JldHVybiB0aGlzfTtcbmcuR2I9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuSWIodGhpcyl9O2cucmVwbGFjZT1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gbmV3ICQoYSxiLGMsZCxudWxsKX07Zy5JYj1mdW5jdGlvbihhKXtyZXR1cm4gbmV3ICQoYS5rZXksYS5sLHRoaXMsYS5yaWdodCxudWxsKX07Zy5KYj1mdW5jdGlvbihhKXtyZXR1cm4gbmV3ICQoYS5rZXksYS5sLGEubGVmdCx0aGlzLG51bGwpfTtnLlRhPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEhmKHRoaXMsYSxiKX07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIEQuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIEQuYyh0aGlzLGIsYyl9O2cuSj1mdW5jdGlvbihhLGIpe3JldHVybiAwPT09Yj90aGlzLmtleToxPT09Yj90aGlzLmw6bnVsbH07Zy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA9PT1iP3RoaXMua2V5OjE9PT1iP3RoaXMubDp1P2M6bnVsbH07XG5nLlBhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4obmV3IFcobnVsbCwyLDUsWCxbdGhpcy5rZXksdGhpcy5sXSxudWxsKSkuUGEobnVsbCxiLGMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIDJ9O2cuJGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5rZXl9O2cuYWI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sfTtnLklhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubH07Zy5KYT1mdW5jdGlvbigpe3JldHVybiBuZXcgVyhudWxsLDEsNSxYLFt0aGlzLmtleV0sbnVsbCl9O2cuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWNjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIHFlfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnYy5jKHRoaXMsYixjKX07XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gUi5jKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCksYixjKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIERhKERhKEgsdGhpcy5sKSx0aGlzLmtleSl9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBOKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCksYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVyhudWxsLDMsNSxYLFt0aGlzLmtleSx0aGlzLmwsYl0sbnVsbCl9O2cuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7XG5nLmFwcGx5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuY2FsbC5hcHBseSh0aGlzLFt0aGlzXS5jb25jYXQodmEoYikpKX07Zy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O2Z1bmN0aW9uIFkoYSxiLGMsZCxlKXt0aGlzLmtleT1hO3RoaXMubD1iO3RoaXMubGVmdD1jO3RoaXMucmlnaHQ9ZDt0aGlzLm09ZTt0aGlzLnE9MDt0aGlzLmk9MzI0MDIyMDd9Zz1ZLnByb3RvdHlwZTtnLkhiPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgWSh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LGEsbnVsbCl9O2cuaGI9ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcihcInJlZC1ibGFjayB0cmVlIGludmFyaWFudCB2aW9sYXRpb25cIik7fTtnLnFhPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyAkKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQsdGhpcy5yaWdodCxudWxsKX07XG5nLkdiPWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgWSh0aGlzLmtleSx0aGlzLmwsYSx0aGlzLnJpZ2h0LG51bGwpfTtnLnJlcGxhY2U9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIG5ldyBZKGEsYixjLGQsbnVsbCl9O2cuSWI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMubGVmdCBpbnN0YW5jZW9mIFk/bmV3IFkodGhpcy5rZXksdGhpcy5sLHRoaXMubGVmdC5xYSgpLG5ldyAkKGEua2V5LGEubCx0aGlzLnJpZ2h0LGEucmlnaHQsbnVsbCksbnVsbCk6dGhpcy5yaWdodCBpbnN0YW5jZW9mIFk/bmV3IFkodGhpcy5yaWdodC5rZXksdGhpcy5yaWdodC5sLG5ldyAkKHRoaXMua2V5LHRoaXMubCx0aGlzLmxlZnQsdGhpcy5yaWdodC5sZWZ0LG51bGwpLG5ldyAkKGEua2V5LGEubCx0aGlzLnJpZ2h0LnJpZ2h0LGEucmlnaHQsbnVsbCksbnVsbCk6dT9uZXcgJChhLmtleSxhLmwsdGhpcyxhLnJpZ2h0LG51bGwpOm51bGx9O1xuZy5KYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5yaWdodCBpbnN0YW5jZW9mIFk/bmV3IFkodGhpcy5rZXksdGhpcy5sLG5ldyAkKGEua2V5LGEubCxhLmxlZnQsdGhpcy5sZWZ0LG51bGwpLHRoaXMucmlnaHQucWEoKSxudWxsKTp0aGlzLmxlZnQgaW5zdGFuY2VvZiBZP25ldyBZKHRoaXMubGVmdC5rZXksdGhpcy5sZWZ0LmwsbmV3ICQoYS5rZXksYS5sLGEubGVmdCx0aGlzLmxlZnQubGVmdCxudWxsKSxuZXcgJCh0aGlzLmtleSx0aGlzLmwsdGhpcy5sZWZ0LnJpZ2h0LHRoaXMucmlnaHQsbnVsbCksbnVsbCk6dT9uZXcgJChhLmtleSxhLmwsYS5sZWZ0LHRoaXMsbnVsbCk6bnVsbH07Zy5UYT1mdW5jdGlvbihhLGIpe3JldHVybiBIZih0aGlzLGEsYil9O2cudT1mdW5jdGlvbihhLGIpe3JldHVybiBELmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBELmModGhpcyxiLGMpfTtcbmcuSj1mdW5jdGlvbihhLGIpe3JldHVybiAwPT09Yj90aGlzLmtleToxPT09Yj90aGlzLmw6bnVsbH07Zy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIDA9PT1iP3RoaXMua2V5OjE9PT1iP3RoaXMubDp1P2M6bnVsbH07Zy5QYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuKG5ldyBXKG51bGwsMiw1LFgsW3RoaXMua2V5LHRoaXMubF0sbnVsbCkpLlBhKG51bGwsYixjKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O2cuTD1mdW5jdGlvbigpe3JldHVybiAyfTtnLiRhPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMua2V5fTtnLmFiPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubH07Zy5JYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmx9O2cuSmE9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFcobnVsbCwxLDUsWCxbdGhpcy5rZXldLG51bGwpfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07XG5nLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbGModGhpcyxiKX07Zy5JPWZ1bmN0aW9uKCl7cmV0dXJuIHFlfTtnLk49ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2MuYSh0aGlzLGIpfTtnLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnYy5jKHRoaXMsYixjKX07Zy51YT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIFIuYyhuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpLGIsYyl9O2cuSD1mdW5jdGlvbigpe3JldHVybiBEYShEYShILHRoaXMubCksdGhpcy5rZXkpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFt0aGlzLmtleSx0aGlzLmxdLG51bGwpLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IFcobnVsbCwzLDUsWCxbdGhpcy5rZXksdGhpcy5sLGJdLG51bGwpfTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTtcbnZhciBKZj1mdW5jdGlvbiBJZihiLGMsZCxlLGYpe2lmKG51bGw9PWMpcmV0dXJuIG5ldyBZKGQsZSxudWxsLG51bGwsbnVsbCk7dmFyIGg9Yi5hP2IuYShkLGMua2V5KTpiLmNhbGwobnVsbCxkLGMua2V5KTtyZXR1cm4gMD09PWg/KGZbMF09YyxudWxsKTowPmg/KGI9SWYoYixjLmxlZnQsZCxlLGYpLG51bGwhPWI/Yy5HYihiKTpudWxsKTp1PyhiPUlmKGIsYy5yaWdodCxkLGUsZiksbnVsbCE9Yj9jLkhiKGIpOm51bGwpOm51bGx9LExmPWZ1bmN0aW9uIEtmKGIsYyl7aWYobnVsbD09YilyZXR1cm4gYztpZihudWxsPT1jKXJldHVybiBiO2lmKGIgaW5zdGFuY2VvZiBZKXtpZihjIGluc3RhbmNlb2YgWSl7dmFyIGQ9S2YoYi5yaWdodCxjLmxlZnQpO3JldHVybiBkIGluc3RhbmNlb2YgWT9uZXcgWShkLmtleSxkLmwsbmV3IFkoYi5rZXksYi5sLGIubGVmdCxkLmxlZnQsbnVsbCksbmV3IFkoYy5rZXksYy5sLGQucmlnaHQsYy5yaWdodCxudWxsKSxudWxsKTpuZXcgWShiLmtleSxiLmwsXG5iLmxlZnQsbmV3IFkoYy5rZXksYy5sLGQsYy5yaWdodCxudWxsKSxudWxsKX1yZXR1cm4gbmV3IFkoYi5rZXksYi5sLGIubGVmdCxLZihiLnJpZ2h0LGMpLG51bGwpfXJldHVybiBjIGluc3RhbmNlb2YgWT9uZXcgWShjLmtleSxjLmwsS2YoYixjLmxlZnQpLGMucmlnaHQsbnVsbCk6dT8oZD1LZihiLnJpZ2h0LGMubGVmdCksZCBpbnN0YW5jZW9mIFk/bmV3IFkoZC5rZXksZC5sLG5ldyAkKGIua2V5LGIubCxiLmxlZnQsZC5sZWZ0LG51bGwpLG5ldyAkKGMua2V5LGMubCxkLnJpZ2h0LGMucmlnaHQsbnVsbCksbnVsbCk6RmYoYi5rZXksYi5sLGIubGVmdCxuZXcgJChjLmtleSxjLmwsZCxjLnJpZ2h0LG51bGwpKSk6bnVsbH0sTmY9ZnVuY3Rpb24gTWYoYixjLGQsZSl7aWYobnVsbCE9Yyl7dmFyIGY9Yi5hP2IuYShkLGMua2V5KTpiLmNhbGwobnVsbCxkLGMua2V5KTtpZigwPT09ZilyZXR1cm4gZVswXT1jLExmKGMubGVmdCxjLnJpZ2h0KTtpZigwPmYpcmV0dXJuIGI9TWYoYixjLmxlZnQsXG5kLGUpLG51bGwhPWJ8fG51bGwhPWVbMF0/Yy5sZWZ0IGluc3RhbmNlb2YgJD9GZihjLmtleSxjLmwsYixjLnJpZ2h0KTpuZXcgWShjLmtleSxjLmwsYixjLnJpZ2h0LG51bGwpOm51bGw7aWYodSl7Yj1NZihiLGMucmlnaHQsZCxlKTtpZihudWxsIT1ifHxudWxsIT1lWzBdKWlmKGMucmlnaHQgaW5zdGFuY2VvZiAkKWlmKGU9Yy5rZXksZD1jLmwsYz1jLmxlZnQsYiBpbnN0YW5jZW9mIFkpYz1uZXcgWShlLGQsYyxiLnFhKCksbnVsbCk7ZWxzZSBpZihjIGluc3RhbmNlb2YgJCljPURmKGUsZCxjLmhiKCksYik7ZWxzZSBpZihjIGluc3RhbmNlb2YgWSYmYy5yaWdodCBpbnN0YW5jZW9mICQpYz1uZXcgWShjLnJpZ2h0LmtleSxjLnJpZ2h0LmwsRGYoYy5rZXksYy5sLGMubGVmdC5oYigpLGMucmlnaHQubGVmdCksbmV3ICQoZSxkLGMucmlnaHQucmlnaHQsYixudWxsKSxudWxsKTtlbHNle2lmKHUpdGhyb3cgRXJyb3IoXCJyZWQtYmxhY2sgdHJlZSBpbnZhcmlhbnQgdmlvbGF0aW9uXCIpO1xuYz1udWxsfWVsc2UgYz1uZXcgWShjLmtleSxjLmwsYy5sZWZ0LGIsbnVsbCk7ZWxzZSBjPW51bGw7cmV0dXJuIGN9fXJldHVybiBudWxsfSxQZj1mdW5jdGlvbiBPZihiLGMsZCxlKXt2YXIgZj1jLmtleSxoPWIuYT9iLmEoZCxmKTpiLmNhbGwobnVsbCxkLGYpO3JldHVybiAwPT09aD9jLnJlcGxhY2UoZixlLGMubGVmdCxjLnJpZ2h0KTowPmg/Yy5yZXBsYWNlKGYsYy5sLE9mKGIsYy5sZWZ0LGQsZSksYy5yaWdodCk6dT9jLnJlcGxhY2UoZixjLmwsYy5sZWZ0LE9mKGIsYy5yaWdodCxkLGUpKTpudWxsfTtmdW5jdGlvbiBRZihhLGIsYyxkLGUpe3RoaXMuWj1hO3RoaXMubWE9Yjt0aGlzLmc9Yzt0aGlzLmo9ZDt0aGlzLm09ZTt0aGlzLmk9NDE4Nzc2ODQ3O3RoaXMucT04MTkyfWc9UWYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cua2V5cz1mdW5jdGlvbigpe3JldHVybiBPZShWZS5iP1ZlLmIodGhpcyk6VmUuY2FsbChudWxsLHRoaXMpKX07XG5nLmVudHJpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gUWUoRSh0aGlzKSl9O2cudmFsdWVzPWZ1bmN0aW9uKCl7cmV0dXJuIE9lKFdlLmI/V2UuYih0aGlzKTpXZS5jYWxsKG51bGwsdGhpcykpfTtnLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07Zy5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmZvckVhY2g9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPUUodGhpcyksYz1udWxsLGQ9MCxlPTA7OylpZihlPGQpe3ZhciBmPWMuSihudWxsLGUpLGg9UC5jKGYsMCxudWxsKSxmPVAuYyhmLDEsbnVsbCk7YS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCk7ZSs9MX1lbHNlIGlmKGI9RShiKSlJYyhiKT8oYz1IYihiKSxiPUliKGIpLGg9YyxkPU8oYyksYz1oKTooYz1GKGIpLGg9UC5jKGMsMCxudWxsKSxmPVAuYyhjLDEsbnVsbCksYS5hP2EuYShmLGgpOmEuY2FsbChudWxsLGYsaCksYj1JKGIpLGM9bnVsbCxkPTApLGU9MDtlbHNlIHJldHVybiBudWxsfTtcbmZ1bmN0aW9uIFJmKGEsYil7Zm9yKHZhciBjPWEubWE7OylpZihudWxsIT1jKXt2YXIgZD1hLlouYT9hLlouYShiLGMua2V5KTphLlouY2FsbChudWxsLGIsYy5rZXkpO2lmKDA9PT1kKXJldHVybiBjO2lmKDA+ZCljPWMubGVmdDtlbHNlIGlmKHUpYz1jLnJpZ2h0O2Vsc2UgcmV0dXJuIG51bGx9ZWxzZSByZXR1cm4gbnVsbH1nLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7YT1SZih0aGlzLGIpO3JldHVybiBudWxsIT1hP2EubDpjfTtnLlphPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbnVsbCE9dGhpcy5tYT9IZih0aGlzLm1hLGIsYyk6Y307Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307Zy5YYT1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuZz9DZih0aGlzLm1hLCExLHRoaXMuZyk6bnVsbH07XG5nLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1kYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIE1lKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKFNmLHRoaXMuail9O2cubmI9ZnVuY3Rpb24oYSxiKXt2YXIgYz1bbnVsbF0sZD1OZih0aGlzLlosdGhpcy5tYSxiLGMpO3JldHVybiBudWxsPT1kP251bGw9PVAuYShjLDApP3RoaXM6bmV3IFFmKHRoaXMuWixudWxsLDAsdGhpcy5qLG51bGwpOm5ldyBRZih0aGlzLlosZC5xYSgpLHRoaXMuZy0xLHRoaXMuaixudWxsKX07XG5nLnVhPWZ1bmN0aW9uKGEsYixjKXthPVtudWxsXTt2YXIgZD1KZih0aGlzLlosdGhpcy5tYSxiLGMsYSk7cmV0dXJuIG51bGw9PWQ/KGE9UC5hKGEsMCksV2IuYShjLGEubCk/dGhpczpuZXcgUWYodGhpcy5aLFBmKHRoaXMuWix0aGlzLm1hLGIsYyksdGhpcy5nLHRoaXMuaixudWxsKSk6bmV3IFFmKHRoaXMuWixkLnFhKCksdGhpcy5nKzEsdGhpcy5qLG51bGwpfTtnLmtiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGwhPVJmKHRoaXMsYil9O2cuSD1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuZz9DZih0aGlzLm1hLCEwLHRoaXMuZyk6bnVsbH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBRZih0aGlzLlosdGhpcy5tYSx0aGlzLmcsYix0aGlzLm0pfTtcbmcuRz1mdW5jdGlvbihhLGIpe2lmKEhjKGIpKXJldHVybiBPYSh0aGlzLEQuYShiLDApLEQuYShiLDEpKTtmb3IodmFyIGM9dGhpcyxkPUUoYik7Oyl7aWYobnVsbD09ZClyZXR1cm4gYzt2YXIgZT1GKGQpO2lmKEhjKGUpKWM9T2EoYyxELmEoZSwwKSxELmEoZSwxKSksZD1JKGQpO2Vsc2UgdGhyb3cgRXJyb3IoXCJjb25qIG9uIGEgbWFwIHRha2VzIG1hcCBlbnRyaWVzIG9yIHNlcWFibGVzIG9mIG1hcCBlbnRyaWVzXCIpO319O2cuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O1xuZy5iPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnUobnVsbCxhKX07Zy5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuQyhudWxsLGEsYil9O2cueWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gMDx0aGlzLmc/Q2YodGhpcy5tYSxiLHRoaXMuZyk6bnVsbH07Zy56Yj1mdW5jdGlvbihhLGIsYyl7aWYoMDx0aGlzLmcpe2E9bnVsbDtmb3IodmFyIGQ9dGhpcy5tYTs7KWlmKG51bGwhPWQpe3ZhciBlPXRoaXMuWi5hP3RoaXMuWi5hKGIsZC5rZXkpOnRoaXMuWi5jYWxsKG51bGwsYixkLmtleSk7aWYoMD09PWUpcmV0dXJuIG5ldyBCZihudWxsLHBjLmEoYSxkKSxjLC0xLG51bGwpO2lmKHIoYykpMD5lPyhhPXBjLmEoYSxkKSxkPWQubGVmdCk6ZD1kLnJpZ2h0O2Vsc2UgaWYodSkwPGU/KGE9cGMuYShhLGQpLGQ9ZC5yaWdodCk6ZD1kLmxlZnQ7ZWxzZSByZXR1cm4gbnVsbH1lbHNlIHJldHVybiBudWxsPT1hP251bGw6bmV3IEJmKG51bGwsYSxjLC0xLG51bGwpfWVsc2UgcmV0dXJuIG51bGx9O1xuZy54Yj1mdW5jdGlvbihhLGIpe3JldHVybiBjZi5iP2NmLmIoYik6Y2YuY2FsbChudWxsLGIpfTtnLndiPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuWn07XG52YXIgU2Y9bmV3IFFmKFhiLG51bGwsMCxudWxsLDApLFRmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe2E9RShhKTtmb3IodmFyIGI9eWIoJGUpOzspaWYoYSl7dmFyIGU9SShJKGEpKSxiPXhkLmMoYixGKGEpLEYoSShhKSkpO2E9ZX1lbHNlIHJldHVybiBBYihiKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxVZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gbmV3IGxhKG51bGwsWWMoTyhhKSksUy5hKHdhLFxuYSksbnVsbCl9YS5rPTA7YS5mPWZ1bmN0aW9uKGEpe2E9RShhKTtyZXR1cm4gYihhKX07YS5kPWI7cmV0dXJuIGF9KCksVmY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7YT1FKGEpO2Zvcih2YXIgYj1TZjs7KWlmKGEpe3ZhciBlPUkoSShhKSksYj1SLmMoYixGKGEpLEYoSShhKSkpO2E9ZX1lbHNlIHJldHVybiBifWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpLFdmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQpe3ZhciBlPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoZT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGEsZSl9ZnVuY3Rpb24gYihhLFxuYil7Zm9yKHZhciBlPUUoYiksZj1uZXcgUWYoUWMoYSksbnVsbCwwLG51bGwsMCk7OylpZihlKXZhciBoPUkoSShlKSksZj1SLmMoZixGKGUpLEYoSShlKSkpLGU9aDtlbHNlIHJldHVybiBmfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtmdW5jdGlvbiBYZihhLGIpe3RoaXMuVj1hO3RoaXMuVz1iO3RoaXMucT0wO3RoaXMuaT0zMjM3NDk4OH1nPVhmLnByb3RvdHlwZTtnLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIExiKHRoaXMpfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfTtnLlU9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlYsYT0oYT9hLmkmMTI4fHxhLm9ifHwoYS5pPzA6cyhKYSxhKSk6cyhKYSxhKSk/dGhpcy5WLlUobnVsbCk6SSh0aGlzLlYpO3JldHVybiBudWxsPT1hP251bGw6bmV3IFhmKGEsdGhpcy5XKX07Zy5CPWZ1bmN0aW9uKCl7cmV0dXJuIGNjKHRoaXMpfTtcbmcudj1mdW5jdGlvbihhLGIpe3JldHVybiBsYyh0aGlzLGIpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihILHRoaXMuVyl9O2cuTj1mdW5jdGlvbihhLGIpe3JldHVybiBuYy5hKGIsdGhpcyl9O2cuTT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIG5jLmMoYixjLHRoaXMpfTtnLlE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5WLlEobnVsbCkuJGEobnVsbCl9O2cuUz1mdW5jdGlvbigpe3ZhciBhPXRoaXMuVixhPShhP2EuaSYxMjh8fGEub2J8fChhLmk/MDpzKEphLGEpKTpzKEphLGEpKT90aGlzLlYuVShudWxsKTpJKHRoaXMuVik7cmV0dXJuIG51bGwhPWE/bmV3IFhmKGEsdGhpcy5XKTpIfTtnLkg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc307Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBYZih0aGlzLlYsYil9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O2Z1bmN0aW9uIFZlKGEpe3JldHVybihhPUUoYSkpP25ldyBYZihhLG51bGwpOm51bGx9XG5mdW5jdGlvbiBjZihhKXtyZXR1cm4gVGEoYSl9ZnVuY3Rpb24gWWYoYSxiKXt0aGlzLlY9YTt0aGlzLlc9Yjt0aGlzLnE9MDt0aGlzLmk9MzIzNzQ5ODh9Zz1ZZi5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuV307Zy5VPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5WLGE9KGE/YS5pJjEyOHx8YS5vYnx8KGEuaT8wOnMoSmEsYSkpOnMoSmEsYSkpP3RoaXMuVi5VKG51bGwpOkkodGhpcy5WKTtyZXR1cm4gbnVsbD09YT9udWxsOm5ldyBZZihhLHRoaXMuVyl9O2cuQj1mdW5jdGlvbigpe3JldHVybiBjYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5XKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5jLmEoYix0aGlzKX07Zy5NPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbmMuYyhiLGMsdGhpcyl9O2cuUT1mdW5jdGlvbigpe3JldHVybiB0aGlzLlYuUShudWxsKS5hYihudWxsKX07XG5nLlM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLlYsYT0oYT9hLmkmMTI4fHxhLm9ifHwoYS5pPzA6cyhKYSxhKSk6cyhKYSxhKSk/dGhpcy5WLlUobnVsbCk6SSh0aGlzLlYpO3JldHVybiBudWxsIT1hP25ldyBZZihhLHRoaXMuVyk6SH07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9O2cuRj1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgWWYodGhpcy5WLGIpfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTShiLHRoaXMpfTtmdW5jdGlvbiBXZShhKXtyZXR1cm4oYT1FKGEpKT9uZXcgWWYoYSxudWxsKTpudWxsfWZ1bmN0aW9uIGRmKGEpe3JldHVybiBVYShhKX1cbnZhciBaZj1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gcihFZChGZCxhKSk/Qy5hKGZ1bmN0aW9uKGEsYil7cmV0dXJuIHBjLmEocihhKT9hOlllLGIpfSxhKTpudWxsfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpO2Z1bmN0aW9uICRmKGEsYixjKXt0aGlzLmo9YTt0aGlzLlNhPWI7dGhpcy5tPWM7dGhpcy5pPTE1MDc3NjQ3O3RoaXMucT04MTk2fWc9JGYucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cua2V5cz1mdW5jdGlvbigpe3JldHVybiBPZShFKHRoaXMpKX07Zy5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIFNlKEUodGhpcykpfTtnLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiBPZShFKHRoaXMpKX07XG5nLmhhcz1mdW5jdGlvbihhKXtyZXR1cm4gT2ModGhpcyxhKX07Zy5mb3JFYWNoPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1FKHRoaXMpLGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKSxoPVAuYyhmLDAsbnVsbCksZj1QLmMoZiwxLG51bGwpO2EuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpO2UrPTF9ZWxzZSBpZihiPUUoYikpSWMoYik/KGM9SGIoYiksYj1JYihiKSxoPWMsZD1PKGMpLGM9aCk6KGM9RihiKSxoPVAuYyhjLDAsbnVsbCksZj1QLmMoYywxLG51bGwpLGEuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpLGI9SShiKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSByZXR1cm4gbnVsbH07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBOYSh0aGlzLlNhLGIpP2I6Y307Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07Zy5MPWZ1bmN0aW9uKCl7cmV0dXJuIEFhKHRoaXMuU2EpfTtcbmcuQj1mdW5jdGlvbigpe3ZhciBhPXRoaXMubTtyZXR1cm4gbnVsbCE9YT9hOnRoaXMubT1hPWRjKHRoaXMpfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gRGMoYikmJk8odGhpcyk9PT1PKGIpJiZEZChmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9fSh0aGlzKSxiKX07Zy5XYT1mdW5jdGlvbigpe3JldHVybiBuZXcgYWcoeWIodGhpcy5TYSkpfTtnLkk9ZnVuY3Rpb24oKXtyZXR1cm4gTihiZyx0aGlzLmopfTtnLnZiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyAkZih0aGlzLmosUWEodGhpcy5TYSxiKSxudWxsKX07Zy5IPWZ1bmN0aW9uKCl7cmV0dXJuIFZlKHRoaXMuU2EpfTtnLkY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3ICRmKGIsdGhpcy5TYSx0aGlzLm0pfTtnLkc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3ICRmKHRoaXMuaixSLmModGhpcy5TYSxiLG51bGwpLG51bGwpfTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIHRoaXMudShudWxsLGMpO2Nhc2UgMzpyZXR1cm4gdGhpcy5DKG51bGwsYyxkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy51KG51bGwsYSl9O2cuYT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLkMobnVsbCxhLGIpfTt2YXIgYmc9bmV3ICRmKG51bGwsWWUsMCk7ZnVuY3Rpb24gYWcoYSl7dGhpcy5sYT1hO3RoaXMuaT0yNTk7dGhpcy5xPTEzNn1nPWFnLnByb3RvdHlwZTtcbmcuY2FsbD1mdW5jdGlvbigpe3ZhciBhPW51bGw7cmV0dXJuIGE9ZnVuY3Rpb24oYSxjLGQpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIExhLmModGhpcy5sYSxjLExjKT09PUxjP251bGw6YztjYXNlIDM6cmV0dXJuIExhLmModGhpcy5sYSxjLExjKT09PUxjP2Q6Y310aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCk7Zy5hcHBseT1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmNhbGwuYXBwbHkodGhpcyxbdGhpc10uY29uY2F0KHZhKGIpKSl9O2cuYj1mdW5jdGlvbihhKXtyZXR1cm4gTGEuYyh0aGlzLmxhLGEsTGMpPT09TGM/bnVsbDphfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLmxhLGEsTGMpPT09TGM/YjphfTtnLnU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gTGEuYyh0aGlzLGIsbnVsbCl9O2cuQz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIExhLmModGhpcy5sYSxiLExjKT09PUxjP2M6Yn07XG5nLkw9ZnVuY3Rpb24oKXtyZXR1cm4gTyh0aGlzLmxhKX07Zy5PYj1mdW5jdGlvbihhLGIpe3RoaXMubGE9eWQuYSh0aGlzLmxhLGIpO3JldHVybiB0aGlzfTtnLkthPWZ1bmN0aW9uKGEsYil7dGhpcy5sYT14ZC5jKHRoaXMubGEsYixudWxsKTtyZXR1cm4gdGhpc307Zy5PYT1mdW5jdGlvbigpe3JldHVybiBuZXcgJGYobnVsbCxBYih0aGlzLmxhKSxudWxsKX07ZnVuY3Rpb24gY2coYSxiLGMpe3RoaXMuaj1hO3RoaXMubmE9Yjt0aGlzLm09Yzt0aGlzLmk9NDE3NzMwODMxO3RoaXMucT04MTkyfWc9Y2cucHJvdG90eXBlO2cudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTGIodGhpcyl9O2cua2V5cz1mdW5jdGlvbigpe3JldHVybiBPZShFKHRoaXMpKX07Zy5lbnRyaWVzPWZ1bmN0aW9uKCl7cmV0dXJuIFNlKEUodGhpcykpfTtnLnZhbHVlcz1mdW5jdGlvbigpe3JldHVybiBPZShFKHRoaXMpKX07Zy5oYXM9ZnVuY3Rpb24oYSl7cmV0dXJuIE9jKHRoaXMsYSl9O1xuZy5mb3JFYWNoPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1FKHRoaXMpLGM9bnVsbCxkPTAsZT0wOzspaWYoZTxkKXt2YXIgZj1jLkoobnVsbCxlKSxoPVAuYyhmLDAsbnVsbCksZj1QLmMoZiwxLG51bGwpO2EuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpO2UrPTF9ZWxzZSBpZihiPUUoYikpSWMoYik/KGM9SGIoYiksYj1JYihiKSxoPWMsZD1PKGMpLGM9aCk6KGM9RihiKSxoPVAuYyhjLDAsbnVsbCksZj1QLmMoYywxLG51bGwpLGEuYT9hLmEoZixoKTphLmNhbGwobnVsbCxmLGgpLGI9SShiKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSByZXR1cm4gbnVsbH07Zy51PWZ1bmN0aW9uKGEsYil7cmV0dXJuIExhLmModGhpcyxiLG51bGwpfTtnLkM9ZnVuY3Rpb24oYSxiLGMpe2E9UmYodGhpcy5uYSxiKTtyZXR1cm4gbnVsbCE9YT9hLmtleTpjfTtnLkQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5qfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gTyh0aGlzLm5hKX07XG5nLlhhPWZ1bmN0aW9uKCl7cmV0dXJuIDA8Tyh0aGlzLm5hKT9LZC5hKGNmLHBiKHRoaXMubmEpKTpudWxsfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1kYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIERjKGIpJiZPKHRoaXMpPT09TyhiKSYmRGQoZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBPYyhhLGIpfX0odGhpcyksYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKGRnLHRoaXMuail9O2cudmI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IGNnKHRoaXMuaix0Yy5hKHRoaXMubmEsYiksbnVsbCl9O2cuSD1mdW5jdGlvbigpe3JldHVybiBWZSh0aGlzLm5hKX07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBjZyhiLHRoaXMubmEsdGhpcy5tKX07Zy5HPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBjZyh0aGlzLmosUi5jKHRoaXMubmEsYixudWxsKSxudWxsKX07XG5nLmNhbGw9ZnVuY3Rpb24oKXt2YXIgYT1udWxsO3JldHVybiBhPWZ1bmN0aW9uKGEsYyxkKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiB0aGlzLnUobnVsbCxjKTtjYXNlIDM6cmV0dXJuIHRoaXMuQyhudWxsLGMsZCl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpO2cuYXBwbHk9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5jYWxsLmFwcGx5KHRoaXMsW3RoaXNdLmNvbmNhdCh2YShiKSkpfTtnLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudShudWxsLGEpfTtnLmE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5DKG51bGwsYSxiKX07Zy55Yj1mdW5jdGlvbihhLGIpe3JldHVybiBLZC5hKGNmLHFiKHRoaXMubmEsYikpfTtnLnpiPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gS2QuYShjZixyYih0aGlzLm5hLGIsYykpfTtnLnhiPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGJ9O2cud2I9ZnVuY3Rpb24oKXtyZXR1cm4gdGIodGhpcy5uYSl9O1xudmFyIGRnPW5ldyBjZyhudWxsLFNmLDApO2Z1bmN0aW9uIGVnKGEpe2E9RShhKTtpZihudWxsPT1hKXJldHVybiBiZztpZihhIGluc3RhbmNlb2YgYWMmJjA9PT1hLnApe2E9YS5lO2E6e2Zvcih2YXIgYj0wLGM9eWIoYmcpOzspaWYoYjxhLmxlbmd0aCl2YXIgZD1iKzEsYz1jLkthKG51bGwsYVtiXSksYj1kO2Vsc2V7YT1jO2JyZWFrIGF9YT12b2lkIDB9cmV0dXJuIGEuT2EobnVsbCl9aWYodSlmb3IoZD15YihiZyk7OylpZihudWxsIT1hKWI9YS5VKG51bGwpLGQ9ZC5LYShudWxsLGEuUShudWxsKSksYT1iO2Vsc2UgcmV0dXJuIGQuT2EobnVsbCk7ZWxzZSByZXR1cm4gbnVsbH1cbnZhciBmZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gQy5jKERhLGRnLGEpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpLGdnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQpe3ZhciBlPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoZT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGEsZSl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBDLmMoRGEsbmV3IGNnKG51bGwsV2YoYSksMCksYil9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsYSl9O2EuZD1iO3JldHVybiBhfSgpO1xuZnVuY3Rpb24gaGcoYSl7Zm9yKHZhciBiPXFlOzspaWYoSShhKSliPXBjLmEoYixGKGEpKSxhPUkoYSk7ZWxzZSByZXR1cm4gRShiKX1mdW5jdGlvbiBpZChhKXtpZihhJiYoYS5xJjQwOTZ8fGEuZmMpKXJldHVybiBhLm5hbWU7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiBhO3Rocm93IEVycm9yKFwiRG9lc24ndCBzdXBwb3J0IG5hbWU6IFwiK0EuYihhKSk7fVxudmFyIGlnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuKGEuYj9hLmIoYik6YS5jYWxsKG51bGwsYikpPihhLmI/YS5iKGMpOmEuY2FsbChudWxsLGMpKT9iOmN9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayxsKXt2YXIgbj1udWxsOzM8YXJndW1lbnRzLmxlbmd0aCYmKG49SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMyksMCkpO3JldHVybiBjLmNhbGwodGhpcyxiLGQsayxuKX1mdW5jdGlvbiBjKGEsZCxlLGwpe3JldHVybiBDLmMoZnVuY3Rpb24oYyxkKXtyZXR1cm4gYi5jKGEsYyxkKX0sYi5jKGEsZCxlKSxsKX1hLms9MzthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUkoYSk7dmFyIGw9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGwsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gZTtcbmNhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYixlLGYpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsZixKKGFyZ3VtZW50cywzKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0zO2IuZj1jLmY7Yi5hPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGJ9O2IuYz1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksamc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixmKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBoPUUoZik7cmV0dXJuIGg/TShNZChhLGgpLGMuYyhhLGIsTmQoYixoKSkpOm51bGx9LG51bGwsbnVsbCl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBjLmMoYSxhLGIpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUsZil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSxmKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO1xufTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKSxsZz1mdW5jdGlvbiBrZyhiLGMpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKCl7dmFyIGQ9RShjKTtyZXR1cm4gZD9yKGIuYj9iLmIoRihkKSk6Yi5jYWxsKG51bGwsRihkKSkpP00oRihkKSxrZyhiLEcoZCkpKTpudWxsOm51bGx9LG51bGwsbnVsbCl9O2Z1bmN0aW9uIG1nKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZCl7dmFyIGU9dGIoYSk7cmV0dXJuIGIuYT9iLmEoZS5hP2UuYShzYihhLGQpLGMpOmUuY2FsbChudWxsLHNiKGEsZCksYyksMCk6Yi5jYWxsKG51bGwsZS5hP2UuYShzYihhLGQpLGMpOmUuY2FsbChudWxsLHNiKGEsZCksYyksMCl9fVxudmFyIG5nPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxoLGspe3ZhciBsPXJiKGEsYywhMCk7aWYocihsKSl7dmFyIG49UC5jKGwsMCxudWxsKTtyZXR1cm4gbGcobWcoYSxoLGspLHIobWcoYSxiLGMpLmNhbGwobnVsbCxuKSk/bDpJKGwpKX1yZXR1cm4gbnVsbH1mdW5jdGlvbiBiKGEsYixjKXt2YXIgaD1tZyhhLGIsYyksazthOntrPVtVYyxWY107dmFyIGw9ay5sZW5ndGg7aWYobDw9WmUpZm9yKHZhciBuPTAscT15YihZZSk7OylpZihuPGwpdmFyIHQ9bisxLHE9QmIocSxrW25dLG51bGwpLG49dDtlbHNle2s9bmV3ICRmKG51bGwsQWIocSksbnVsbCk7YnJlYWsgYX1lbHNlIGZvcihuPTAscT15YihiZyk7OylpZihuPGwpdD1uKzEscT16YihxLGtbbl0pLG49dDtlbHNle2s9QWIocSk7YnJlYWsgYX1rPXZvaWQgMH1yZXR1cm4gcihrLmNhbGwobnVsbCxiKSk/KGE9cmIoYSxjLCEwKSxyKGEpPyhiPVAuYyhhLDAsbnVsbCkscihoLmI/aC5iKGIpOmguY2FsbChudWxsLGIpKT9hOlxuSShhKSk6bnVsbCk6bGcoaCxxYihhLCEwKSl9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmLGgsayl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMzpyZXR1cm4gYi5jYWxsKHRoaXMsYyxlLGYpO2Nhc2UgNTpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5jPWI7Yy5zPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gb2coYSxiLGMsZCxlKXt0aGlzLmo9YTt0aGlzLnN0YXJ0PWI7dGhpcy5lbmQ9Yzt0aGlzLnN0ZXA9ZDt0aGlzLm09ZTt0aGlzLmk9MzIzNzUwMDY7dGhpcy5xPTgxOTJ9Zz1vZy5wcm90b3R5cGU7Zy50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBMYih0aGlzKX07XG5nLko9ZnVuY3Rpb24oYSxiKXtpZihiPEFhKHRoaXMpKXJldHVybiB0aGlzLnN0YXJ0K2IqdGhpcy5zdGVwO2lmKHRoaXMuc3RhcnQ+dGhpcy5lbmQmJjA9PT10aGlzLnN0ZXApcmV0dXJuIHRoaXMuc3RhcnQ7dGhyb3cgRXJyb3IoXCJJbmRleCBvdXQgb2YgYm91bmRzXCIpO307Zy5hYT1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGI8QWEodGhpcyk/dGhpcy5zdGFydCtiKnRoaXMuc3RlcDp0aGlzLnN0YXJ0PnRoaXMuZW5kJiYwPT09dGhpcy5zdGVwP3RoaXMuc3RhcnQ6Y307Zy5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07XG5nLlU9ZnVuY3Rpb24oKXtyZXR1cm4gMDx0aGlzLnN0ZXA/dGhpcy5zdGFydCt0aGlzLnN0ZXA8dGhpcy5lbmQ/bmV3IG9nKHRoaXMuaix0aGlzLnN0YXJ0K3RoaXMuc3RlcCx0aGlzLmVuZCx0aGlzLnN0ZXAsbnVsbCk6bnVsbDp0aGlzLnN0YXJ0K3RoaXMuc3RlcD50aGlzLmVuZD9uZXcgb2codGhpcy5qLHRoaXMuc3RhcnQrdGhpcy5zdGVwLHRoaXMuZW5kLHRoaXMuc3RlcCxudWxsKTpudWxsfTtnLkw9ZnVuY3Rpb24oKXtyZXR1cm4gc2EobGIodGhpcykpPzA6TWF0aC5jZWlsKCh0aGlzLmVuZC10aGlzLnN0YXJ0KS90aGlzLnN0ZXApfTtnLkI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm07cmV0dXJuIG51bGwhPWE/YTp0aGlzLm09YT1jYyh0aGlzKX07Zy52PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGxjKHRoaXMsYil9O2cuST1mdW5jdGlvbigpe3JldHVybiBOKEgsdGhpcy5qKX07Zy5OPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGdjLmEodGhpcyxiKX07XG5nLk09ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBnYy5jKHRoaXMsYixjKX07Zy5RPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PWxiKHRoaXMpP251bGw6dGhpcy5zdGFydH07Zy5TPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPWxiKHRoaXMpP25ldyBvZyh0aGlzLmosdGhpcy5zdGFydCt0aGlzLnN0ZXAsdGhpcy5lbmQsdGhpcy5zdGVwLG51bGwpOkh9O2cuSD1mdW5jdGlvbigpe3JldHVybiAwPHRoaXMuc3RlcD90aGlzLnN0YXJ0PHRoaXMuZW5kP3RoaXM6bnVsbDp0aGlzLnN0YXJ0PnRoaXMuZW5kP3RoaXM6bnVsbH07Zy5GPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBvZyhiLHRoaXMuc3RhcnQsdGhpcy5lbmQsdGhpcy5zdGVwLHRoaXMubSl9O2cuRz1mdW5jdGlvbihhLGIpe3JldHVybiBNKGIsdGhpcyl9O1xudmFyIHBnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIG5ldyBvZyhudWxsLGEsYixjLG51bGwpfWZ1bmN0aW9uIGIoYSxiKXtyZXR1cm4gZS5jKGEsYiwxKX1mdW5jdGlvbiBjKGEpe3JldHVybiBlLmMoMCxhLDEpfWZ1bmN0aW9uIGQoKXtyZXR1cm4gZS5jKDAsTnVtYmVyLk1BWF9WQUxVRSwxKX12YXIgZT1udWxsLGU9ZnVuY3Rpb24oZSxoLGspe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGQuY2FsbCh0aGlzKTtjYXNlIDE6cmV0dXJuIGMuY2FsbCh0aGlzLGUpO2Nhc2UgMjpyZXR1cm4gYi5jYWxsKHRoaXMsZSxoKTtjYXNlIDM6cmV0dXJuIGEuY2FsbCh0aGlzLGUsaCxrKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZS5vPWQ7ZS5iPWM7ZS5hPWI7ZS5jPWE7cmV0dXJuIGV9KCkscWc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7Zm9yKDs7KWlmKEUoYikmJjA8YSl7dmFyIGM9YS0xLGg9XG5JKGIpO2E9YztiPWh9ZWxzZSByZXR1cm4gbnVsbH1mdW5jdGlvbiBiKGEpe2Zvcig7OylpZihFKGEpKWE9SShhKTtlbHNlIHJldHVybiBudWxsfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCkscmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cWcuYShhLGIpO3JldHVybiBifWZ1bmN0aW9uIGIoYSl7cWcuYihhKTtyZXR1cm4gYX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTtcbn07Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCk7ZnVuY3Rpb24gc2coYSxiKXtpZihcInN0cmluZ1wiPT09dHlwZW9mIGIpe3ZhciBjPWEuZXhlYyhiKTtyZXR1cm4gV2IuYShGKGMpLGIpPzE9PT1PKGMpP0YoYyk6d2UoYyk6bnVsbH10aHJvdyBuZXcgVHlwZUVycm9yKFwicmUtbWF0Y2hlcyBtdXN0IG1hdGNoIGFnYWluc3QgYSBzdHJpbmcuXCIpO31mdW5jdGlvbiB0ZyhhKXt2YXIgYjtiPS9eKD86XFwoXFw/KFtpZG1zdXhdKilcXCkpPyguKikvO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlhPWIuZXhlYyhhKSxiPW51bGw9PWE/bnVsbDoxPT09TyhhKT9GKGEpOndlKGEpO2Vsc2UgdGhyb3cgbmV3IFR5cGVFcnJvcihcInJlLWZpbmQgbXVzdCBtYXRjaCBhZ2FpbnN0IGEgc3RyaW5nLlwiKTtQLmMoYiwwLG51bGwpO2E9UC5jKGIsMSxudWxsKTtiPVAuYyhiLDIsbnVsbCk7cmV0dXJuIG5ldyBSZWdFeHAoYixhKX1cbmZ1bmN0aW9uIHVnKGEsYixjLGQsZSxmLGgpe3ZhciBrPWphO3RyeXtqYT1udWxsPT1qYT9udWxsOmphLTE7aWYobnVsbCE9amEmJjA+amEpcmV0dXJuIHViKGEsXCIjXCIpO3ViKGEsYyk7RShoKSYmKGIuYz9iLmMoRihoKSxhLGYpOmIuY2FsbChudWxsLEYoaCksYSxmKSk7Zm9yKHZhciBsPUkoaCksbj1yYS5iKGYpLTE7OylpZighbHx8bnVsbCE9biYmMD09PW4pe0UobCkmJjA9PT1uJiYodWIoYSxkKSx1YihhLFwiLi4uXCIpKTticmVha31lbHNle3ViKGEsZCk7Yi5jP2IuYyhGKGwpLGEsZik6Yi5jYWxsKG51bGwsRihsKSxhLGYpO3ZhciBxPUkobCk7Yz1uLTE7bD1xO249Y31yZXR1cm4gdWIoYSxlKX1maW5hbGx5e2phPWt9fVxudmFyIHZnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQpe3ZhciBlPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoZT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGEsZSl9ZnVuY3Rpb24gYihhLGIpe2Zvcih2YXIgZT1FKGIpLGY9bnVsbCxoPTAsaz0wOzspaWYoazxoKXt2YXIgbD1mLkoobnVsbCxrKTt1YihhLGwpO2srPTF9ZWxzZSBpZihlPUUoZSkpZj1lLEljKGYpPyhlPUhiKGYpLGg9SWIoZiksZj1lLGw9TyhlKSxlPWgsaD1sKToobD1GKGYpLHViKGEsbCksZT1JKGYpLGY9bnVsbCxoPTApLGs9MDtlbHNlIHJldHVybiBudWxsfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSx3Zz17J1wiJzonXFxcXFwiJyxcIlxcXFxcIjpcIlxcXFxcXFxcXCIsXCJcXGJcIjpcIlxcXFxiXCIsXCJcXGZcIjpcIlxcXFxmXCIsXCJcXG5cIjpcIlxcXFxuXCIsXCJcXHJcIjpcIlxcXFxyXCIsXCJcXHRcIjpcIlxcXFx0XCJ9O1xuZnVuY3Rpb24geGcoYSl7cmV0dXJuJ1wiJytBLmIoYS5yZXBsYWNlKFJlZ0V4cCgnW1xcXFxcXFxcXCJcXGJcXGZcXG5cXHJcXHRdJyxcImdcIiksZnVuY3Rpb24oYSl7cmV0dXJuIHdnW2FdfSkpKydcIid9XG52YXIgQWc9ZnVuY3Rpb24geWcoYixjLGQpe2lmKG51bGw9PWIpcmV0dXJuIHViKGMsXCJuaWxcIik7aWYodm9pZCAwPT09YilyZXR1cm4gdWIoYyxcIiNcXHgzY3VuZGVmaW5lZFxceDNlXCIpO2lmKHUpe3IoZnVuY3Rpb24oKXt2YXIgYz1RLmEoZCxwYSk7cmV0dXJuIHIoYyk/KGM9Yj9iLmkmMTMxMDcyfHxiLmVjPyEwOmIuaT8hMTpzKGJiLGIpOnMoYmIsYikpP3hjKGIpOmM6Y30oKSkmJih1YihjLFwiXlwiKSx5Zyh4YyhiKSxjLGQpLHViKGMsXCIgXCIpKTtpZihudWxsPT1iKXJldHVybiB1YihjLFwibmlsXCIpO2lmKGIuRGIpcmV0dXJuIGIuVGIoYixjLGQpO2lmKGImJihiLmkmMjE0NzQ4MzY0OHx8Yi5LKSlyZXR1cm4gYi53KG51bGwsYyxkKTtpZih0YShiKT09PUJvb2xlYW58fFwibnVtYmVyXCI9PT10eXBlb2YgYilyZXR1cm4gdWIoYyxcIlwiK0EuYihiKSk7aWYobnVsbCE9YiYmYi5jb25zdHJ1Y3Rvcj09PU9iamVjdClyZXR1cm4gdWIoYyxcIiNqcyBcIiksemcubj96Zy5uKEtkLmEoZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBXKG51bGwsXG4yLDUsWCxbamQuYihjKSxiW2NdXSxudWxsKX0sSmMoYikpLHlnLGMsZCk6emcuY2FsbChudWxsLEtkLmEoZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBXKG51bGwsMiw1LFgsW2pkLmIoYyksYltjXV0sbnVsbCl9LEpjKGIpKSx5ZyxjLGQpO2lmKGIgaW5zdGFuY2VvZiBBcnJheSlyZXR1cm4gdWcoYyx5ZyxcIiNqcyBbXCIsXCIgXCIsXCJdXCIsZCxiKTtpZihcInN0cmluZ1wiPT10eXBlb2YgYilyZXR1cm4gcihvYS5iKGQpKT91YihjLHhnKGIpKTp1YihjLGIpO2lmKHVjKGIpKXJldHVybiB2Zy5kKGMsSihbXCIjXFx4M2NcIixcIlwiK0EuYihiKSxcIlxceDNlXCJdLDApKTtpZihiIGluc3RhbmNlb2YgRGF0ZSl7dmFyIGU9ZnVuY3Rpb24oYixjKXtmb3IodmFyIGQ9XCJcIitBLmIoYik7OylpZihPKGQpPGMpZD1cIjBcIitBLmIoZCk7ZWxzZSByZXR1cm4gZH07cmV0dXJuIHZnLmQoYyxKKFsnI2luc3QgXCInLFwiXCIrQS5iKGIuZ2V0VVRDRnVsbFllYXIoKSksXCItXCIsZShiLmdldFVUQ01vbnRoKCkrMSwyKSxcIi1cIixlKGIuZ2V0VVRDRGF0ZSgpLFxuMiksXCJUXCIsZShiLmdldFVUQ0hvdXJzKCksMiksXCI6XCIsZShiLmdldFVUQ01pbnV0ZXMoKSwyKSxcIjpcIixlKGIuZ2V0VVRDU2Vjb25kcygpLDIpLFwiLlwiLGUoYi5nZXRVVENNaWxsaXNlY29uZHMoKSwzKSxcIi1cIiwnMDA6MDBcIiddLDApKX1yZXR1cm4gYiBpbnN0YW5jZW9mIFJlZ0V4cD92Zy5kKGMsSihbJyNcIicsYi5zb3VyY2UsJ1wiJ10sMCkpOihiP2IuaSYyMTQ3NDgzNjQ4fHxiLkt8fChiLmk/MDpzKHZiLGIpKTpzKHZiLGIpKT93YihiLGMsZCk6dT92Zy5kKGMsSihbXCIjXFx4M2NcIixcIlwiK0EuYihiKSxcIlxceDNlXCJdLDApKTpudWxsfXJldHVybiBudWxsfTtcbmZ1bmN0aW9uIEJnKGEsYil7dmFyIGM9bmV3IGVhO2E6e3ZhciBkPW5ldyBLYihjKTtBZyhGKGEpLGQsYik7Zm9yKHZhciBlPUUoSShhKSksZj1udWxsLGg9MCxrPTA7OylpZihrPGgpe3ZhciBsPWYuSihudWxsLGspO3ViKGQsXCIgXCIpO0FnKGwsZCxiKTtrKz0xfWVsc2UgaWYoZT1FKGUpKWY9ZSxJYyhmKT8oZT1IYihmKSxoPUliKGYpLGY9ZSxsPU8oZSksZT1oLGg9bCk6KGw9RihmKSx1YihkLFwiIFwiKSxBZyhsLGQsYiksZT1JKGYpLGY9bnVsbCxoPTApLGs9MDtlbHNlIGJyZWFrIGF9cmV0dXJuIGN9XG52YXIgQ2c9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7dmFyIGI9a2EoKTtyZXR1cm4gQmMoYSk/XCJcIjpcIlwiK0EuYihCZyhhLGIpKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKTtmdW5jdGlvbiB6ZyhhLGIsYyxkKXtyZXR1cm4gdWcoYyxmdW5jdGlvbihhLGMsZCl7Yi5jP2IuYyhUYShhKSxjLGQpOmIuY2FsbChudWxsLFRhKGEpLGMsZCk7dWIoYyxcIiBcIik7cmV0dXJuIGIuYz9iLmMoVWEoYSksYyxkKTpiLmNhbGwobnVsbCxVYShhKSxjLGQpfSxcIntcIixcIiwgXCIsXCJ9XCIsZCxFKGEpKX1hYy5wcm90b3R5cGUuSz0hMDtcbmFjLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtWLnByb3RvdHlwZS5LPSEwO1YucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O0JmLnByb3RvdHlwZS5LPSEwO0JmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTt2Zi5wcm90b3R5cGUuSz0hMDt2Zi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07JC5wcm90b3R5cGUuSz0hMDskLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIltcIixcIiBcIixcIl1cIixjLHRoaXMpfTtVZS5wcm90b3R5cGUuSz0hMDtVZS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07XG5jZy5wcm90b3R5cGUuSz0hMDtjZy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIje1wiLFwiIFwiLFwifVwiLGMsdGhpcyl9O3llLnByb3RvdHlwZS5LPSEwO3llLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtnZC5wcm90b3R5cGUuSz0hMDtnZC5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07a2MucHJvdG90eXBlLks9ITA7a2MucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O3hmLnByb3RvdHlwZS5LPSEwO3hmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gemcodGhpcyxBZyxiLGMpfTt3Zi5wcm90b3R5cGUuSz0hMDt3Zi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07XG5BZS5wcm90b3R5cGUuSz0hMDtBZS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCJbXCIsXCIgXCIsXCJdXCIsYyx0aGlzKX07UWYucHJvdG90eXBlLks9ITA7UWYucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB6Zyh0aGlzLEFnLGIsYyl9OyRmLnByb3RvdHlwZS5LPSEwOyRmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIiN7XCIsXCIgXCIsXCJ9XCIsYyx0aGlzKX07b2QucHJvdG90eXBlLks9ITA7b2QucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1lmLnByb3RvdHlwZS5LPSEwO1lmLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIihcIixcIiBcIixcIilcIixjLHRoaXMpfTtZLnByb3RvdHlwZS5LPSEwO1kucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiW1wiLFwiIFwiLFwiXVwiLGMsdGhpcyl9O1xuVy5wcm90b3R5cGUuSz0hMDtXLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdWcoYixBZyxcIltcIixcIiBcIixcIl1cIixjLHRoaXMpfTtIZS5wcm90b3R5cGUuSz0hMDtIZS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07Y2QucHJvdG90eXBlLks9ITA7Y2QucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdWIoYixcIigpXCIpfTtJZS5wcm90b3R5cGUuSz0hMDtJZS5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIjcXVldWUgW1wiLFwiIFwiLFwiXVwiLGMsRSh0aGlzKSl9O2xhLnByb3RvdHlwZS5LPSEwO2xhLnByb3RvdHlwZS53PWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gemcodGhpcyxBZyxiLGMpfTtvZy5wcm90b3R5cGUuSz0hMDtvZy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07XG5YZi5wcm90b3R5cGUuSz0hMDtYZi5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHVnKGIsQWcsXCIoXCIsXCIgXCIsXCIpXCIsYyx0aGlzKX07YmQucHJvdG90eXBlLks9ITA7YmQucHJvdG90eXBlLnc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB1ZyhiLEFnLFwiKFwiLFwiIFwiLFwiKVwiLGMsdGhpcyl9O1cucHJvdG90eXBlLmxiPSEwO1cucHJvdG90eXBlLm1iPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFBjLmEodGhpcyxiKX07QWUucHJvdG90eXBlLmxiPSEwO0FlLnByb3RvdHlwZS5tYj1mdW5jdGlvbihhLGIpe3JldHVybiBQYy5hKHRoaXMsYil9O1QucHJvdG90eXBlLmxiPSEwO1QucHJvdG90eXBlLm1iPWZ1bmN0aW9uKGEsYil7cmV0dXJuIFZiKHRoaXMsYil9O1piLnByb3RvdHlwZS5sYj0hMDtaYi5wcm90b3R5cGUubWI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gVmIodGhpcyxiKX07XG5mdW5jdGlvbiBEZyhhLGIpe2lmKGE/YS5nYzphKXJldHVybiBhLmdjKGEsYik7dmFyIGM7Yz1EZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWMmJihjPURnLl8sIWMpKXRocm93IHgoXCJJUmVzZXQuLXJlc2V0IVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfVxudmFyIEVnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyxkLGUpe2lmKGE/YS5uYzphKXJldHVybiBhLm5jKGEsYixjLGQsZSk7dmFyIHE7cT1FZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIXEmJihxPUVnLl8sIXEpKXRocm93IHgoXCJJU3dhcC4tc3dhcCFcIixhKTtyZXR1cm4gcS5jYWxsKG51bGwsYSxiLGMsZCxlKX1mdW5jdGlvbiBiKGEsYixjLGQpe2lmKGE/YS5tYzphKXJldHVybiBhLm1jKGEsYixjLGQpO3ZhciBlO2U9RWdbbShudWxsPT1hP251bGw6YSldO2lmKCFlJiYoZT1FZy5fLCFlKSl0aHJvdyB4KFwiSVN3YXAuLXN3YXAhXCIsYSk7cmV0dXJuIGUuY2FsbChudWxsLGEsYixjLGQpfWZ1bmN0aW9uIGMoYSxiLGMpe2lmKGE/YS5sYzphKXJldHVybiBhLmxjKGEsYixjKTt2YXIgZDtkPUVnW20obnVsbD09YT9udWxsOmEpXTtpZighZCYmKGQ9RWcuXywhZCkpdGhyb3cgeChcIklTd2FwLi1zd2FwIVwiLGEpO3JldHVybiBkLmNhbGwobnVsbCxhLGIsYyl9ZnVuY3Rpb24gZChhLGIpe2lmKGE/XG5hLmtjOmEpcmV0dXJuIGEua2MoYSxiKTt2YXIgYztjPUVnW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9RWcuXywhYykpdGhyb3cgeChcIklTd2FwLi1zd2FwIVwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfXZhciBlPW51bGwsZT1mdW5jdGlvbihlLGgsayxsLG4pe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGQuY2FsbCh0aGlzLGUsaCk7Y2FzZSAzOnJldHVybiBjLmNhbGwodGhpcyxlLGgsayk7Y2FzZSA0OnJldHVybiBiLmNhbGwodGhpcyxlLGgsayxsKTtjYXNlIDU6cmV0dXJuIGEuY2FsbCh0aGlzLGUsaCxrLGwsbil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2UuYT1kO2UuYz1jO2Uubj1iO2Uucz1hO3JldHVybiBlfSgpO2Z1bmN0aW9uIEZnKGEsYixjLGQpe3RoaXMuc3RhdGU9YTt0aGlzLmo9Yjt0aGlzLndjPWM7dGhpcy5XYj1kO3RoaXMuaT0yMTUzOTM4OTQ0O3RoaXMucT0xNjM4Nn1nPUZnLnByb3RvdHlwZTtcbmcuQj1mdW5jdGlvbigpe3JldHVybiB0aGlzW2JhXXx8KHRoaXNbYmFdPSsrY2EpfTtnLlJiPWZ1bmN0aW9uKGEsYixjKXthPUUodGhpcy5XYik7Zm9yKHZhciBkPW51bGwsZT0wLGY9MDs7KWlmKGY8ZSl7dmFyIGg9ZC5KKG51bGwsZiksaz1QLmMoaCwwLG51bGwpLGg9UC5jKGgsMSxudWxsKTtoLm4/aC5uKGssdGhpcyxiLGMpOmguY2FsbChudWxsLGssdGhpcyxiLGMpO2YrPTF9ZWxzZSBpZihhPUUoYSkpSWMoYSk/KGQ9SGIoYSksYT1JYihhKSxrPWQsZT1PKGQpLGQ9ayk6KGQ9RihhKSxrPVAuYyhkLDAsbnVsbCksaD1QLmMoZCwxLG51bGwpLGgubj9oLm4oayx0aGlzLGIsYyk6aC5jYWxsKG51bGwsayx0aGlzLGIsYyksYT1JKGEpLGQ9bnVsbCxlPTApLGY9MDtlbHNlIHJldHVybiBudWxsfTtnLnc9ZnVuY3Rpb24oYSxiLGMpe3ViKGIsXCIjXFx4M2NBdG9tOiBcIik7QWcodGhpcy5zdGF0ZSxiLGMpO3JldHVybiB1YihiLFwiXFx4M2VcIil9O2cuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmp9O1xuZy51Yj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlfTtnLnY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcz09PWJ9O1xudmFyIEhnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXtyZXR1cm4gbmV3IEZnKGEsbnVsbCxudWxsLG51bGwpfXZhciBiPW51bGwsYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkKXt2YXIgaz1udWxsOzE8YXJndW1lbnRzLmxlbmd0aCYmKGs9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGspfWZ1bmN0aW9uIGIoYSxjKXt2YXIgZD1NYyhjKT9TLmEoVGYsYyk6YyxlPVEuYShkLEdnKSxkPVEuYShkLHBhKTtyZXR1cm4gbmV3IEZnKGEsZCxlLG51bGwpfWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYS5jYWxsKHRoaXMsYik7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsSihhcmd1bWVudHMsMSkpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrXG5hcmd1bWVudHMubGVuZ3RoKTt9O2Iuaz0xO2IuZj1jLmY7Yi5iPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKTtmdW5jdGlvbiBJZyhhLGIpe2lmKGEgaW5zdGFuY2VvZiBGZyl7dmFyIGM9YS53YztpZihudWxsIT1jJiYhcihjLmI/Yy5iKGIpOmMuY2FsbChudWxsLGIpKSl0aHJvdyBFcnJvcihcIkFzc2VydCBmYWlsZWQ6IFZhbGlkYXRvciByZWplY3RlZCByZWZlcmVuY2Ugc3RhdGVcXG5cIitBLmIoQ2cuZChKKFtmZChuZXcgWmIobnVsbCxcInZhbGlkYXRlXCIsXCJ2YWxpZGF0ZVwiLDE0MzkyMzA3MDAsbnVsbCksbmV3IFpiKG51bGwsXCJuZXctdmFsdWVcIixcIm5ldy12YWx1ZVwiLC0xNTY3Mzk3NDAxLG51bGwpKV0sMCkpKSk7Yz1hLnN0YXRlO2Euc3RhdGU9YjtudWxsIT1hLldiJiZ4YihhLGMsYik7cmV0dXJuIGJ9cmV0dXJuIERnKGEsYil9ZnVuY3Rpb24gSyhhKXtyZXR1cm4gYWIoYSl9XG52YXIgSmc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe3JldHVybiBhIGluc3RhbmNlb2YgRmc/SWcoYSxiLmM/Yi5jKGEuc3RhdGUsYyxkKTpiLmNhbGwobnVsbCxhLnN0YXRlLGMsZCkpOkVnLm4oYSxiLGMsZCl9ZnVuY3Rpb24gYihhLGIsYyl7cmV0dXJuIGEgaW5zdGFuY2VvZiBGZz9JZyhhLGIuYT9iLmEoYS5zdGF0ZSxjKTpiLmNhbGwobnVsbCxhLnN0YXRlLGMpKTpFZy5jKGEsYixjKX1mdW5jdGlvbiBjKGEsYil7cmV0dXJuIGEgaW5zdGFuY2VvZiBGZz9JZyhhLGIuYj9iLmIoYS5zdGF0ZSk6Yi5jYWxsKG51bGwsYS5zdGF0ZSkpOkVnLmEoYSxiKX12YXIgZD1udWxsLGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxlLGYsdCl7dmFyIHY9bnVsbDs0PGFyZ3VtZW50cy5sZW5ndGgmJih2PUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDQpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxkLGUsZix2KX1mdW5jdGlvbiBiKGEsYyxkLGUsZil7cmV0dXJuIGEgaW5zdGFuY2VvZlxuRmc/SWcoYSxTLnMoYyxhLnN0YXRlLGQsZSxmKSk6RWcucyhhLGMsZCxlLGYpfWEuaz00O2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9SShhKTt2YXIgZT1GKGEpO2E9SShhKTt2YXIgZj1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsZSxmLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSxkPWZ1bmN0aW9uKGQsaCxrLGwsbil7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMjpyZXR1cm4gYy5jYWxsKHRoaXMsZCxoKTtjYXNlIDM6cmV0dXJuIGIuY2FsbCh0aGlzLGQsaCxrKTtjYXNlIDQ6cmV0dXJuIGEuY2FsbCh0aGlzLGQsaCxrLGwpO2RlZmF1bHQ6cmV0dXJuIGUuZChkLGgsayxsLEooYXJndW1lbnRzLDQpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307ZC5rPTQ7ZC5mPWUuZjtkLmE9YztkLmM9YjtkLm49YTtkLmQ9ZS5kO3JldHVybiBkfSgpLEtnPXt9O1xuZnVuY3Rpb24gTGcoYSl7aWYoYT9hLmFjOmEpcmV0dXJuIGEuYWMoYSk7dmFyIGI7Yj1MZ1ttKG51bGw9PWE/bnVsbDphKV07aWYoIWImJihiPUxnLl8sIWIpKXRocm93IHgoXCJJRW5jb2RlSlMuLWNsai1cXHgzZWpzXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIE1nKGEpe3JldHVybihhP3IocihudWxsKT9udWxsOmEuJGIpfHwoYS5DYj8wOnMoS2csYSkpOnMoS2csYSkpP0xnKGEpOlwic3RyaW5nXCI9PT10eXBlb2YgYXx8XCJudW1iZXJcIj09PXR5cGVvZiBhfHxhIGluc3RhbmNlb2YgVHx8YSBpbnN0YW5jZW9mIFpiP05nLmI/TmcuYihhKTpOZy5jYWxsKG51bGwsYSk6Q2cuZChKKFthXSwwKSl9XG52YXIgTmc9ZnVuY3Rpb24gT2coYil7aWYobnVsbD09YilyZXR1cm4gbnVsbDtpZihiP3IocihudWxsKT9udWxsOmIuJGIpfHwoYi5DYj8wOnMoS2csYikpOnMoS2csYikpcmV0dXJuIExnKGIpO2lmKGIgaW5zdGFuY2VvZiBUKXJldHVybiBpZChiKTtpZihiIGluc3RhbmNlb2YgWmIpcmV0dXJuXCJcIitBLmIoYik7aWYoR2MoYikpe3ZhciBjPXt9O2I9RShiKTtmb3IodmFyIGQ9bnVsbCxlPTAsZj0wOzspaWYoZjxlKXt2YXIgaD1kLkoobnVsbCxmKSxrPVAuYyhoLDAsbnVsbCksaD1QLmMoaCwxLG51bGwpO2NbTWcoayldPU9nKGgpO2YrPTF9ZWxzZSBpZihiPUUoYikpSWMoYik/KGU9SGIoYiksYj1JYihiKSxkPWUsZT1PKGUpKTooZT1GKGIpLGQ9UC5jKGUsMCxudWxsKSxlPVAuYyhlLDEsbnVsbCksY1tNZyhkKV09T2coZSksYj1JKGIpLGQ9bnVsbCxlPTApLGY9MDtlbHNlIGJyZWFrO3JldHVybiBjfWlmKENjKGIpKXtjPVtdO2I9RShLZC5hKE9nLGIpKTtkPW51bGw7Zm9yKGY9ZT0wOzspaWYoZjxcbmUpaz1kLkoobnVsbCxmKSxjLnB1c2goayksZis9MTtlbHNlIGlmKGI9RShiKSlkPWIsSWMoZCk/KGI9SGIoZCksZj1JYihkKSxkPWIsZT1PKGIpLGI9Zik6KGI9RihkKSxjLnB1c2goYiksYj1JKGQpLGQ9bnVsbCxlPTApLGY9MDtlbHNlIGJyZWFrO3JldHVybiBjfXJldHVybiB1P2I6bnVsbH0sUGc9e307ZnVuY3Rpb24gUWcoYSxiKXtpZihhP2EuWmI6YSlyZXR1cm4gYS5aYihhLGIpO3ZhciBjO2M9UWdbbShudWxsPT1hP251bGw6YSldO2lmKCFjJiYoYz1RZy5fLCFjKSl0aHJvdyB4KFwiSUVuY29kZUNsb2p1cmUuLWpzLVxceDNlY2xqXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9XG52YXIgU2c9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3JldHVybiBiLmQoYSxKKFtuZXcgbGEobnVsbCwxLFtSZywhMV0sbnVsbCldLDApKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCl7dmFyIGs9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihrPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYyxrKX1mdW5jdGlvbiBiKGEsYyl7aWYoYT9yKHIobnVsbCk/bnVsbDphLkNjKXx8KGEuQ2I/MDpzKFBnLGEpKTpzKFBnLGEpKXJldHVybiBRZyhhLFMuYShVZixjKSk7aWYoRShjKSl7dmFyIGQ9TWMoYyk/Uy5hKFRmLGMpOmMsZT1RLmEoZCxSZyk7cmV0dXJuIGZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbiB5KGUpe3JldHVybiBNYyhlKT9yZy5iKEtkLmEoeSxlKSk6Q2MoZSk/WWQocWMoZSksS2QuYSh5LGUpKTplIGluc3RhbmNlb2YgQXJyYXk/d2UoS2QuYSh5LGUpKTp0YShlKT09PVxuT2JqZWN0P1lkKFllLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBmdW5jdGlvbiBSYShmKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gZnVuY3Rpb24oKXtmb3IoOzspe3ZhciBhPUUoZik7aWYoYSl7aWYoSWMoYSkpe3ZhciBiPUhiKGEpLGM9TyhiKSxoPW5ldyBsZChBcnJheShjKSwwKTthOntmb3IodmFyIGs9MDs7KWlmKGs8Yyl7dmFyIGw9RC5hKGIsayksbD1uZXcgVyhudWxsLDIsNSxYLFtkLmI/ZC5iKGwpOmQuY2FsbChudWxsLGwpLHkoZVtsXSldLG51bGwpO2guYWRkKGwpO2srPTF9ZWxzZXtiPSEwO2JyZWFrIGF9Yj12b2lkIDB9cmV0dXJuIGI/cGQoaC5kYSgpLFJhKEliKGEpKSk6cGQoaC5kYSgpLG51bGwpfWg9RihhKTtyZXR1cm4gTShuZXcgVyhudWxsLDIsNSxYLFtkLmI/ZC5iKGgpOmQuY2FsbChudWxsLGgpLHkoZVtoXSldLG51bGwpLFJhKEcoYSkpKX1yZXR1cm4gbnVsbH19fShhLGIsYyxkKSxudWxsLFxubnVsbCl9fShhLGIsYyxkKShKYyhlKSl9KCkpOnU/ZTpudWxsfX0oYyxkLGUscihlKT9qZDpBKShhKX1yZXR1cm4gbnVsbH1hLms9MTthLmY9ZnVuY3Rpb24oYSl7dmFyIGM9RihhKTthPUcoYSk7cmV0dXJuIGIoYyxhKX07YS5kPWI7cmV0dXJuIGF9KCksYj1mdW5jdGlvbihiLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGEuY2FsbCh0aGlzLGIpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLEooYXJndW1lbnRzLDEpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTE7Yi5mPWMuZjtiLmI9YTtiLmQ9Yy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIFRnKGEpe3RoaXMucGI9YTt0aGlzLnE9MDt0aGlzLmk9MjE1Mzc3NTEwNH1cblRnLnByb3RvdHlwZS5CPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPUNnLmQoSihbdGhpc10sMCkpLGI9MCxjPTA7YzxhLmxlbmd0aDsrK2MpYj0zMSpiK2EuY2hhckNvZGVBdChjKSxiJT00Mjk0OTY3Mjk2O3JldHVybiBifTtUZy5wcm90b3R5cGUudz1mdW5jdGlvbihhLGIpe3JldHVybiB1YihiLCcjdXVpZCBcIicrQS5iKHRoaXMucGIpKydcIicpfTtUZy5wcm90b3R5cGUudj1mdW5jdGlvbihhLGIpe3JldHVybiBiIGluc3RhbmNlb2YgVGcmJnRoaXMucGI9PT1iLnBifTtUZy5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYn07dmFyIFVnPW5ldyBUKG51bGwsXCJwcGF0aFwiLFwicHBhdGhcIiksVmc9bmV3IFQoXCJ6aXBcIixcImJyYW5jaD9cIixcInppcC9icmFuY2g/XCIpLFdnPW5ldyBUKG51bGwsXCJyXCIsXCJyXCIpLFhnPW5ldyBUKFwiemlwXCIsXCJjaGlsZHJlblwiLFwiemlwL2NoaWxkcmVuXCIpLHBhPW5ldyBUKG51bGwsXCJtZXRhXCIsXCJtZXRhXCIpLHFhPW5ldyBUKG51bGwsXCJkdXBcIixcImR1cFwiKSx1PW5ldyBUKG51bGwsXCJlbHNlXCIsXCJlbHNlXCIpLEdnPW5ldyBUKG51bGwsXCJ2YWxpZGF0b3JcIixcInZhbGlkYXRvclwiKSxZYj1uZXcgVChudWxsLFwiZGVmYXVsdFwiLFwiZGVmYXVsdFwiKSxZZz1uZXcgVChudWxsLFwic2VxdWVudGlhbFwiLFwic2VxdWVudGlhbFwiKSxtYT1uZXcgVChudWxsLFwiZmx1c2gtb24tbmV3bGluZVwiLFwiZmx1c2gtb24tbmV3bGluZVwiKSxaZz1uZXcgVChudWxsLFwibFwiLFwibFwiKSwkZz1uZXcgVChcInppcFwiLFwibWFrZS1ub2RlXCIsXCJ6aXAvbWFrZS1ub2RlXCIpLG9hPW5ldyBUKG51bGwsXCJyZWFkYWJseVwiLFwicmVhZGFibHlcIikscmE9bmV3IFQobnVsbCxcblwicHJpbnQtbGVuZ3RoXCIsXCJwcmludC1sZW5ndGhcIiksYWg9bmV3IFQobnVsbCxcInBub2Rlc1wiLFwicG5vZGVzXCIpLGJoPW5ldyBUKG51bGwsXCJjaGFuZ2VkP1wiLFwiY2hhbmdlZD9cIiksY2g9bmV3IFQobnVsbCxcInRhZ1wiLFwidGFnXCIpLGRoPW5ldyBUKG51bGwsXCJzZXRcIixcInNldFwiKSxlaD1uZXcgVChudWxsLFwiZW5kXCIsXCJlbmRcIiksZmg9bmV3IFQobnVsbCxcImF0b21cIixcImF0b21cIiksUmc9bmV3IFQobnVsbCxcImtleXdvcmRpemUta2V5c1wiLFwia2V5d29yZGl6ZS1rZXlzXCIpLGdoPW5ldyBUKG51bGwsXCJtYXBcIixcIm1hcFwiKSxoaD1uZXcgVChcIm1vcmlcIixcIm5vdC1mb3VuZFwiLFwibW9yaS9ub3QtZm91bmRcIiksaWg9bmV3IFQoXCJjbGpzLmNvcmVcIixcIm5vdC1mb3VuZFwiLFwiY2xqcy5jb3JlL25vdC1mb3VuZFwiKTt2YXIgamgsa2g7ZnVuY3Rpb24gbGgoYSl7cmV0dXJuIGEubz9hLm8oKTphLmNhbGwobnVsbCl9ZnVuY3Rpb24gbWgoYSl7cmV0dXJuIGEubz9hLm8oKTphLmNhbGwobnVsbCl9dmFyIG5oPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIEdjKGMpP2hiKGMsYSxiKTpudWxsPT1jP2I6YyBpbnN0YW5jZW9mIEFycmF5P2hjLmMoYyxhLGIpOnU/Z2IuYyhjLGEsYik6bnVsbH1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGMuYyhhLGEubz9hLm8oKTphLmNhbGwobnVsbCksYil9dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAyOnJldHVybiBiLmNhbGwodGhpcyxjLGUpO2Nhc2UgMzpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlLGYpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmE9YjtjLmM9YTtyZXR1cm4gY30oKTtcbmZ1bmN0aW9uIG9oKGEsYixjLGQpe2lmKGE/YS5FYjphKXJldHVybiBhLkViKGEsYixjLGQpO3ZhciBlO2U9b2hbbShudWxsPT1hP251bGw6YSldO2lmKCFlJiYoZT1vaC5fLCFlKSl0aHJvdyB4KFwiQ29sbEZvbGQuY29sbC1mb2xkXCIsYSk7cmV0dXJuIGUuY2FsbChudWxsLGEsYixjLGQpfVxudmFyIHFoPWZ1bmN0aW9uIHBoKGIsYyl7XCJ1bmRlZmluZWRcIj09PXR5cGVvZiBqaCYmKGpoPWZ1bmN0aW9uKGIsYyxmLGgpe3RoaXMuJD1iO3RoaXMuUWE9Yzt0aGlzLnVjPWY7dGhpcy5zYz1oO3RoaXMucT0wO3RoaXMuaT05MTc1MDR9LGpoLkRiPSEwLGpoLkJiPVwiY2xvanVyZS5jb3JlLnJlZHVjZXJzL3Q2MzIyXCIsamguVGI9ZnVuY3Rpb24oYixjKXtyZXR1cm4gdWIoYyxcImNsb2p1cmUuY29yZS5yZWR1Y2Vycy90NjMyMlwiKX0samgucHJvdG90eXBlLk49ZnVuY3Rpb24oYixjKXtyZXR1cm4gZ2IuYyh0aGlzLGMsYy5vP2MubygpOmMuY2FsbChudWxsKSl9LGpoLnByb3RvdHlwZS5NPWZ1bmN0aW9uKGIsYyxmKXtyZXR1cm4gZ2IuYyh0aGlzLlFhLHRoaXMuJC5iP3RoaXMuJC5iKGMpOnRoaXMuJC5jYWxsKG51bGwsYyksZil9LGpoLnByb3RvdHlwZS5EPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2N9LGpoLnByb3RvdHlwZS5GPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIG5ldyBqaCh0aGlzLiQsXG50aGlzLlFhLHRoaXMudWMsYyl9KTtyZXR1cm4gbmV3IGpoKGMsYixwaCxudWxsKX0sc2g9ZnVuY3Rpb24gcmgoYixjKXtcInVuZGVmaW5lZFwiPT09dHlwZW9mIGtoJiYoa2g9ZnVuY3Rpb24oYixjLGYsaCl7dGhpcy4kPWI7dGhpcy5RYT1jO3RoaXMucmM9Zjt0aGlzLnRjPWg7dGhpcy5xPTA7dGhpcy5pPTkxNzUwNH0sa2guRGI9ITAsa2guQmI9XCJjbG9qdXJlLmNvcmUucmVkdWNlcnMvdDYzMjhcIixraC5UYj1mdW5jdGlvbihiLGMpe3JldHVybiB1YihjLFwiY2xvanVyZS5jb3JlLnJlZHVjZXJzL3Q2MzI4XCIpfSxraC5wcm90b3R5cGUuRWI9ZnVuY3Rpb24oYixjLGYsaCl7cmV0dXJuIG9oKHRoaXMuUWEsYyxmLHRoaXMuJC5iP3RoaXMuJC5iKGgpOnRoaXMuJC5jYWxsKG51bGwsaCkpfSxraC5wcm90b3R5cGUuTj1mdW5jdGlvbihiLGMpe3JldHVybiBnYi5jKHRoaXMuUWEsdGhpcy4kLmI/dGhpcy4kLmIoYyk6dGhpcy4kLmNhbGwobnVsbCxjKSxjLm8/Yy5vKCk6Yy5jYWxsKG51bGwpKX0sXG5raC5wcm90b3R5cGUuTT1mdW5jdGlvbihiLGMsZil7cmV0dXJuIGdiLmModGhpcy5RYSx0aGlzLiQuYj90aGlzLiQuYihjKTp0aGlzLiQuY2FsbChudWxsLGMpLGYpfSxraC5wcm90b3R5cGUuRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRjfSxraC5wcm90b3R5cGUuRj1mdW5jdGlvbihiLGMpe3JldHVybiBuZXcga2godGhpcy4kLHRoaXMuUWEsdGhpcy5yYyxjKX0pO3JldHVybiBuZXcga2goYyxiLHJoLG51bGwpfSx0aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gc2goYixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1udWxsO3JldHVybiBjPWZ1bmN0aW9uKGMsZSxoKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gYi5hP2IuYShjLGEuYj9hLmIoZSk6YS5jYWxsKG51bGwsZSkpOmIuY2FsbChudWxsLGMsYS5iP2EuYihlKTphLmNhbGwobnVsbCxlKSk7Y2FzZSAzOnJldHVybiBiLmE/XG5iLmEoYyxhLmE/YS5hKGUsaCk6YS5jYWxsKG51bGwsZSxoKSk6Yi5jYWxsKG51bGwsYyxhLmE/YS5hKGUsaCk6YS5jYWxsKG51bGwsZSxoKSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9fSgpfSl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGMuYShhLGIpfX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiLmNhbGwodGhpcyxjKTtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGMsZSl9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYj1iO2MuYT1hO3JldHVybiBjfSgpLHVoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybiBzaChiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBjPW51bGw7cmV0dXJuIGM9ZnVuY3Rpb24oYyxlLGgpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGIubz9cbmIubygpOmIuY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIHIoYS5iP2EuYihlKTphLmNhbGwobnVsbCxlKSk/Yi5hP2IuYShjLGUpOmIuY2FsbChudWxsLGMsZSk6YztjYXNlIDM6cmV0dXJuIHIoYS5hP2EuYShlLGgpOmEuY2FsbChudWxsLGUsaCkpP2IuYz9iLmMoYyxlLGgpOmIuY2FsbChudWxsLGMsZSxoKTpjfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx2aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIHNoKGEsXG5mdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYj1udWxsO3JldHVybiBiPWZ1bmN0aW9uKGIsZCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYS5vP2EubygpOmEuY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIEZjKGQpP2MuYihkKS5NKG51bGwsYSxiKTphLmE/YS5hKGIsZCk6YS5jYWxsKG51bGwsYixkKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO319KCl9KX1mdW5jdGlvbiBiKCl7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBjLmIoYSl9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLmNhbGwodGhpcyk7Y2FzZSAxOnJldHVybiBhLmNhbGwodGhpcyxjKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5vPWI7Yy5iPWE7cmV0dXJuIGN9KCksd2g9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsXG5iKXtyZXR1cm4gdWguYShHZChhKSxiKX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCkseGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIHFoKGIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbDtyZXR1cm4gYz1mdW5jdGlvbihjLGUsaCl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIHIoYS5iP2EuYihlKTphLmNhbGwobnVsbCxlKSk/Yi5hP2IuYShjLGUpOmIuY2FsbChudWxsLGMsZSk6XG5uZXcgZWMoYyk7Y2FzZSAzOnJldHVybiByKGEuYT9hLmEoZSxoKTphLmNhbGwobnVsbCxlLGgpKT9iLmM/Yi5jKGMsZSxoKTpiLmNhbGwobnVsbCxjLGUsaCk6bmV3IGVjKGMpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0pfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBjLmEoYSxiKX19dmFyIGM9bnVsbCxjPWZ1bmN0aW9uKGMsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTpyZXR1cm4gYi5jYWxsKHRoaXMsYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx5aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gcWgoYixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbDtyZXR1cm4gYz1cbmZ1bmN0aW9uKGMsZCxlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBiLm8/Yi5vKCk6Yi5jYWxsKG51bGwpO2Nhc2UgMjpyZXR1cm4gSmcuYShhLFdjKSwwPmFiKGEpP25ldyBlYyhjKTpiLmE/Yi5hKGMsZCk6Yi5jYWxsKG51bGwsYyxkKTtjYXNlIDM6cmV0dXJuIEpnLmEoYSxXYyksMD5hYihhKT9uZXcgZWMoYyk6Yi5jP2IuYyhjLGQsZSk6Yi5jYWxsKG51bGwsYyxkLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0oSGcuYihhKSl9KX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO1xufTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSx6aD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gcWgoYixmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9bnVsbDtyZXR1cm4gYz1mdW5jdGlvbihjLGQsZSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gYi5vP2IubygpOmIuY2FsbChudWxsKTtjYXNlIDI6cmV0dXJuIEpnLmEoYSxXYyksMD5hYihhKT9iLmE/Yi5hKGMsZCk6Yi5jYWxsKG51bGwsYyxkKTpjO2Nhc2UgMzpyZXR1cm4gSmcuYShhLFdjKSwwPmFiKGEpP2IuYz9iLmMoYyxkLGUpOmIuY2FsbChudWxsLGMsZCxlKTpjfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fX0oKX0oSGcuYihhKSl9KX1mdW5jdGlvbiBiKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYy5hKGEsYil9fXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLFxuYyk7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxjLGUpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtjLmI9YjtjLmE9YTtyZXR1cm4gY30oKSxCaD1mdW5jdGlvbiBBaChiLGMsZCxlKXtpZihCYyhiKSlyZXR1cm4gZC5vP2QubygpOmQuY2FsbChudWxsKTtpZihPKGIpPD1jKXJldHVybiBuaC5jKGUsZC5vP2QubygpOmQuY2FsbChudWxsKSxiKTtpZih1KXt2YXIgZj1ZYyhPKGIpKSxoPXplLmMoYiwwLGYpO2I9emUuYyhiLGYsTyhiKSk7cmV0dXJuIGxoKGZ1bmN0aW9uKGIsYyxlLGYpe3JldHVybiBmdW5jdGlvbigpe3ZhciBiPWYoYyksaDtoPWYoZSk7cmV0dXJuIGQuYT9kLmEoYi5vP2IubygpOmIuY2FsbChudWxsKSxtaChoKSk6ZC5jYWxsKG51bGwsYi5vP2IubygpOmIuY2FsbChudWxsKSxtaChoKSl9fShmLGgsYixmdW5jdGlvbihiLGYsaCl7cmV0dXJuIGZ1bmN0aW9uKHEpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBBaChxLFxuYyxkLGUpfX0oYixmLGgpfX0oZixoLGIpKSl9cmV0dXJuIG51bGx9O1cucHJvdG90eXBlLkViPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBCaCh0aGlzLGIsYyxkKX07b2gub2JqZWN0PWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiBuaC5jKGQsYy5vP2MubygpOmMuY2FsbChudWxsKSxhKX07b2hbXCJudWxsXCJdPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYy5vP2MubygpOmMuY2FsbChudWxsKX07ZnVuY3Rpb24gQ2goYSxiKXt2YXIgYz1TLmMoaWcsYSxiKTtyZXR1cm4gTShjLFZkKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYT09PWJ9fShjKSxiKSl9XG52YXIgRGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIE8oYSk8TyhiKT9DLmMocGMsYixhKTpDLmMocGMsYSxiKX12YXIgYj1udWxsLGM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGMsZCxrKXt2YXIgbD1udWxsOzI8YXJndW1lbnRzLmxlbmd0aCYmKGw9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMiksMCkpO3JldHVybiBiLmNhbGwodGhpcyxjLGQsbCl9ZnVuY3Rpb24gYihhLGMsZCl7YT1DaChPLHBjLmQoZCxjLEooW2FdLDApKSk7cmV0dXJuIEMuYyhZZCxGKGEpLEcoYSkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYz1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihjLGQsYSl9O2EuZD1iO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cmV0dXJuIGJnO2Nhc2UgMTpyZXR1cm4gYjtjYXNlIDI6cmV0dXJuIGEuY2FsbCh0aGlzLGIsZSk7ZGVmYXVsdDpyZXR1cm4gYy5kKGIsXG5lLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLm89ZnVuY3Rpb24oKXtyZXR1cm4gYmd9O2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPWMuZDtyZXR1cm4gYn0oKSxFaD1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtmb3IoOzspaWYoTyhiKTxPKGEpKXt2YXIgYz1hO2E9YjtiPWN9ZWxzZSByZXR1cm4gQy5jKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGZ1bmN0aW9uKGEsYyl7cmV0dXJuIE9jKGIsYyk/YTpBYy5hKGEsYyl9fShhLGIpLGEsYSl9dmFyIGI9bnVsbCxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShiLGQsayl7dmFyIGw9bnVsbDsyPGFyZ3VtZW50cy5sZW5ndGgmJihsPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpLDApKTtyZXR1cm4gYy5jYWxsKHRoaXMsYixkLGwpfWZ1bmN0aW9uIGMoYSxkLGUpe2E9Q2goZnVuY3Rpb24oYSl7cmV0dXJuLU8oYSl9LFxucGMuZChlLGQsSihbYV0sMCkpKTtyZXR1cm4gQy5jKGIsRihhKSxHKGEpKX1hLms9MjthLmY9ZnVuY3Rpb24oYSl7dmFyIGI9RihhKTthPUkoYSk7dmFyIGQ9RihhKTthPUcoYSk7cmV0dXJuIGMoYixkLGEpfTthLmQ9YztyZXR1cm4gYX0oKSxiPWZ1bmN0aW9uKGIsZSxmKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBiO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYixlKTtkZWZhdWx0OnJldHVybiBjLmQoYixlLEooYXJndW1lbnRzLDIpKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yi5rPTI7Yi5mPWMuZjtiLmI9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2IuYT1hO2IuZD1jLmQ7cmV0dXJuIGJ9KCksRmg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYil7cmV0dXJuIE8oYSk8TyhiKT9DLmMoZnVuY3Rpb24oYSxjKXtyZXR1cm4gT2MoYixjKT9BYy5hKGEsYyk6YX0sYSxhKTpDLmMoQWMsYSxiKX12YXIgYj1udWxsLFxuYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixkLGspe3ZhciBsPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYobD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGMuY2FsbCh0aGlzLGIsZCxsKX1mdW5jdGlvbiBjKGEsZCxlKXtyZXR1cm4gQy5jKGIsYSxwYy5hKGUsZCkpfWEuaz0yO2EuZj1mdW5jdGlvbihhKXt2YXIgYj1GKGEpO2E9SShhKTt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYyhiLGQsYSl9O2EuZD1jO3JldHVybiBhfSgpLGI9ZnVuY3Rpb24oYixlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGI7Y2FzZSAyOnJldHVybiBhLmNhbGwodGhpcyxiLGUpO2RlZmF1bHQ6cmV0dXJuIGMuZChiLGUsSihhcmd1bWVudHMsMikpfXRocm93IEVycm9yKFwiSW52YWxpZCBhcml0eTogXCIrYXJndW1lbnRzLmxlbmd0aCk7fTtiLms9MjtiLmY9Yy5mO2IuYj1mdW5jdGlvbihhKXtyZXR1cm4gYX07Yi5hPWE7Yi5kPVxuYy5kO3JldHVybiBifSgpO2Z1bmN0aW9uIEdoKGEsYil7cmV0dXJuIFdiLmEoYSxiKT9uZXcgVyhudWxsLDMsNSxYLFtudWxsLG51bGwsYV0sbnVsbCk6bmV3IFcobnVsbCwzLDUsWCxbYSxiLG51bGxdLG51bGwpfWZ1bmN0aW9uIEhoKGEpe3JldHVybiBFKGEpP0MuYyhmdW5jdGlvbihhLGMpe3ZhciBkPVAuYyhjLDAsbnVsbCksZT1QLmMoYywxLG51bGwpO3JldHVybiBSLmMoYSxkLGUpfSx3ZShPZC5hKFMuYShYYyxWZShhKSksbnVsbCkpLGEpOm51bGx9XG5mdW5jdGlvbiBJaChhLGIsYyl7dmFyIGQ9US5hKGEsYyksZT1RLmEoYixjKSxmPUpoLmE/SmguYShkLGUpOkpoLmNhbGwobnVsbCxkLGUpLGg9UC5jKGYsMCxudWxsKSxrPVAuYyhmLDEsbnVsbCksZj1QLmMoZiwyLG51bGwpO2E9T2MoYSxjKTtiPU9jKGIsYyk7ZD1hJiZiJiYobnVsbCE9Znx8bnVsbD09ZCYmbnVsbD09ZSk7cmV0dXJuIG5ldyBXKG51bGwsMyw1LFgsWyFhfHxudWxsPT1oJiZkP251bGw6bmV3IGFmKFtjLGhdKSwhYnx8bnVsbD09ayYmZD9udWxsOm5ldyBhZihbYyxrXSksZD9uZXcgYWYoW2MsZl0pOm51bGxdLG51bGwpfVxudmFyIEtoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIsYyl7cmV0dXJuIEMuYyhmdW5jdGlvbihhLGIpe3JldHVybiByZy5iKEtkLmMoWmYsYSxiKSl9LG5ldyBXKG51bGwsMyw1LFgsW251bGwsbnVsbCxudWxsXSxudWxsKSxLZC5hKElkLmMoSWgsYSxiKSxjKSl9ZnVuY3Rpb24gYihhLGIpe3JldHVybiBjLmMoYSxiLERoLmEoVmUoYSksVmUoYikpKX12YXIgYz1udWxsLGM9ZnVuY3Rpb24oYyxlLGYpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6cmV0dXJuIGIuY2FsbCh0aGlzLGMsZSk7Y2FzZSAzOnJldHVybiBhLmNhbGwodGhpcyxjLGUsZil9dGhyb3cgRXJyb3IoXCJJbnZhbGlkIGFyaXR5OiBcIithcmd1bWVudHMubGVuZ3RoKTt9O2MuYT1iO2MuYz1hO3JldHVybiBjfSgpO1xuZnVuY3Rpb24gTGgoYSxiKXtyZXR1cm4gd2UoS2QuYShIaCxLaC5jKEhjKGEpP2E6d2UoYSksSGMoYik/Yjp3ZShiKSxwZy5iKGZ1bmN0aW9uKCl7dmFyIGM9TyhhKSxkPU8oYik7cmV0dXJuIGM+ZD9jOmR9KCkpKSkpfWZ1bmN0aW9uIE1oKGEsYil7cmV0dXJuIG5ldyBXKG51bGwsMyw1LFgsW0NkKEZoLmEoYSxiKSksQ2QoRmguYShiLGEpKSxDZChFaC5hKGEsYikpXSxudWxsKX1mdW5jdGlvbiBOaChhKXtpZihhP2EucWM6YSlyZXR1cm4gYS5xYyhhKTt2YXIgYjtiPU5oW20obnVsbD09YT9udWxsOmEpXTtpZighYiYmKGI9TmguXywhYikpdGhyb3cgeChcIkVxdWFsaXR5UGFydGl0aW9uLmVxdWFsaXR5LXBhcnRpdGlvblwiLGEpO3JldHVybiBiLmNhbGwobnVsbCxhKX1cbmZ1bmN0aW9uIE9oKGEsYil7aWYoYT9hLnBjOmEpcmV0dXJuIGEucGMoYSxiKTt2YXIgYztjPU9oW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9T2guXywhYykpdGhyb3cgeChcIkRpZmYuZGlmZi1zaW1pbGFyXCIsYSk7cmV0dXJuIGMuY2FsbChudWxsLGEsYil9TmguXz1mdW5jdGlvbihhKXtyZXR1cm4oYT9hLmkmMTAyNHx8YS5jY3x8KGEuaT8wOnMoUGEsYSkpOnMoUGEsYSkpP2doOihhP2EuaSY0MDk2fHxhLmpjfHwoYS5pPzA6cyhWYSxhKSk6cyhWYSxhKSk/ZGg6KGE/YS5pJjE2Nzc3MjE2fHxhLmljfHwoYS5pPzA6cyhtYixhKSk6cyhtYixhKSk/WWc6WWI/Zmg6bnVsbH07TmhbXCJib29sZWFuXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIGZofTtOaFtcImZ1bmN0aW9uXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIGZofTtOaC5hcnJheT1mdW5jdGlvbigpe3JldHVybiBZZ307TmgubnVtYmVyPWZ1bmN0aW9uKCl7cmV0dXJuIGZofTtOaC5zdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gZmh9O1xuTmhbXCJudWxsXCJdPWZ1bmN0aW9uKCl7cmV0dXJuIGZofTtPaC5fPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7c3dpdGNoKE5oKGEpaW5zdGFuY2VvZiBUP05oKGEpLnNhOm51bGwpe2Nhc2UgXCJtYXBcIjpyZXR1cm4gS2g7Y2FzZSBcInNlcXVlbnRpYWxcIjpyZXR1cm4gTGg7Y2FzZSBcInNldFwiOnJldHVybiBNaDtjYXNlIFwiYXRvbVwiOnJldHVybiBHaDtkZWZhdWx0OnRocm93IEVycm9yKFwiTm8gbWF0Y2hpbmcgY2xhdXNlOiBcIitBLmIoTmgoYSkpKTt9fSgpLmNhbGwobnVsbCxhLGIpfTtPaFtcImJvb2xlYW5cIl09ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07T2hbXCJmdW5jdGlvblwiXT1mdW5jdGlvbihhLGIpe3JldHVybiBHaChhLGIpfTtPaC5hcnJheT1mdW5jdGlvbihhLGIpe3JldHVybiBMaChhLGIpfTtPaC5udW1iZXI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gR2goYSxiKX07T2guc3RyaW5nPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEdoKGEsYil9O1xuT2hbXCJudWxsXCJdPWZ1bmN0aW9uKGEsYil7cmV0dXJuIEdoKGEsYil9O2Z1bmN0aW9uIEpoKGEsYil7cmV0dXJuIFdiLmEoYSxiKT9uZXcgVyhudWxsLDMsNSxYLFtudWxsLG51bGwsYV0sbnVsbCk6V2IuYShOaChhKSxOaChiKSk/T2goYSxiKTpHaChhLGIpfTtmdW5jdGlvbiBQaChhKXtpZihhP2EuVWI6YSlyZXR1cm4gYS5VYigpO3ZhciBiO2I9UGhbbShudWxsPT1hP251bGw6YSldO2lmKCFiJiYoYj1QaC5fLCFiKSl0aHJvdyB4KFwiUHVzaGJhY2tSZWFkZXIucmVhZC1jaGFyXCIsYSk7cmV0dXJuIGIuY2FsbChudWxsLGEpfWZ1bmN0aW9uIFFoKGEsYil7aWYoYT9hLlZiOmEpcmV0dXJuIGEuVmIoMCxiKTt2YXIgYztjPVFoW20obnVsbD09YT9udWxsOmEpXTtpZighYyYmKGM9UWguXywhYykpdGhyb3cgeChcIlB1c2hiYWNrUmVhZGVyLnVucmVhZFwiLGEpO3JldHVybiBjLmNhbGwobnVsbCxhLGIpfWZ1bmN0aW9uIFJoKGEsYixjKXt0aGlzLnI9YTt0aGlzLmJ1ZmZlcj1iO3RoaXMuRmI9Y31SaC5wcm90b3R5cGUuVWI9ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuYnVmZmVyLmxlbmd0aD8odGhpcy5GYis9MSx0aGlzLnJbdGhpcy5GYl0pOnRoaXMuYnVmZmVyLnBvcCgpfTtSaC5wcm90b3R5cGUuVmI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5idWZmZXIucHVzaChiKX07XG5mdW5jdGlvbiBTaChhKXt2YXIgYj0hL1teXFx0XFxuXFxyIF0vLnRlc3QoYSk7cmV0dXJuIHIoYik/YjpcIixcIj09PWF9dmFyIFRoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGQpe3ZhciBlPW51bGw7MTxhcmd1bWVudHMubGVuZ3RoJiYoZT1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLDAsZSl9ZnVuY3Rpb24gYihhLGIpe3Rocm93IEVycm9yKFMuYShBLGIpKTt9YS5rPTE7YS5mPWZ1bmN0aW9uKGEpe0YoYSk7YT1HKGEpO3JldHVybiBiKDAsYSl9O2EuZD1iO3JldHVybiBhfSgpO1xuZnVuY3Rpb24gVWgoYSxiKXtmb3IodmFyIGM9bmV3IGVhKGIpLGQ9UGgoYSk7Oyl7dmFyIGU7aWYoIShlPW51bGw9PWR8fFNoKGQpKSl7ZT1kO3ZhciBmPVwiI1wiIT09ZTtlPWY/KGY9XCInXCIhPT1lKT8oZj1cIjpcIiE9PWUpP1ZoLmI/VmguYihlKTpWaC5jYWxsKG51bGwsZSk6ZjpmOmZ9aWYoZSlyZXR1cm4gUWgoYSxkKSxjLnRvU3RyaW5nKCk7Yy5hcHBlbmQoZCk7ZD1QaChhKX19ZnVuY3Rpb24gV2goYSl7Zm9yKDs7KXt2YXIgYj1QaChhKTtpZihcIlxcblwiPT09Ynx8XCJcXHJcIj09PWJ8fG51bGw9PWIpcmV0dXJuIGF9fXZhciBYaD10ZyhcIl4oWy0rXT8pKD86KDApfChbMS05XVswLTldKil8MFt4WF0oWzAtOUEtRmEtZl0rKXwwKFswLTddKyl8KFsxLTldWzAtOV0/KVtyUl0oWzAtOUEtWmEtel0rKSkoTik/JFwiKSxZaD10ZyhcIl4oWy0rXT9bMC05XSspLyhbMC05XSspJFwiKSxaaD10ZyhcIl4oWy0rXT9bMC05XSsoXFxcXC5bMC05XSopPyhbZUVdWy0rXT9bMC05XSspPykoTSk/JFwiKSwkaD10ZyhcIl5bOl0/KFteMC05L10uKi8pPyhbXjAtOS9dW14vXSopJFwiKTtcbmZ1bmN0aW9uIGFpKGEsYil7dmFyIGM9YS5leGVjKGIpO3JldHVybiBudWxsIT1jJiZjWzBdPT09Yj8xPT09Yy5sZW5ndGg/Y1swXTpjOm51bGx9dmFyIGJpPXRnKFwiXlswLTlBLUZhLWZdezJ9JFwiKSxjaT10ZyhcIl5bMC05QS1GYS1mXXs0fSRcIik7ZnVuY3Rpb24gZGkoYSxiLGMsZCl7cmV0dXJuIHIoc2coYSxkKSk/ZDpUaC5kKGIsSihbXCJVbmV4cGVjdGVkIHVuaWNvZGUgZXNjYXBlIFxcXFxcIixjLGRdLDApKX1mdW5jdGlvbiBlaShhKXtyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChhLDE2KSl9XG5mdW5jdGlvbiBmaShhKXt2YXIgYj1QaChhKSxjPVwidFwiPT09Yj9cIlxcdFwiOlwiclwiPT09Yj9cIlxcclwiOlwiblwiPT09Yj9cIlxcblwiOlwiXFxcXFwiPT09Yj9cIlxcXFxcIjonXCInPT09Yj8nXCInOlwiYlwiPT09Yj9cIlxcYlwiOlwiZlwiPT09Yj9cIlxcZlwiOm51bGw7cihjKT9hPWM6XCJ4XCI9PT1iPyhjPShuZXcgZWEoUGgoYSksUGgoYSkpKS50b1N0cmluZygpLGE9ZWkoZGkoYmksYSxiLGMpKSk6XCJ1XCI9PT1iPyhjPShuZXcgZWEoUGgoYSksUGgoYSksUGgoYSksUGgoYSkpKS50b1N0cmluZygpLGE9ZWkoZGkoY2ksYSxiLGMpKSk6YT0vW14wLTldLy50ZXN0KGIpP3U/VGguZChhLEooW1wiVW5leHBlY3RlZCB1bmljb2RlIGVzY2FwZSBcXFxcXCIsYl0sMCkpOm51bGw6U3RyaW5nLmZyb21DaGFyQ29kZShiKTtyZXR1cm4gYX1cbmZ1bmN0aW9uIGdpKGEsYil7Zm9yKHZhciBjPXliKHFlKTs7KXt2YXIgZDthOntkPVNoO2Zvcih2YXIgZT1iLGY9UGgoZSk7OylpZihyKGQuYj9kLmIoZik6ZC5jYWxsKG51bGwsZikpKWY9UGgoZSk7ZWxzZXtkPWY7YnJlYWsgYX1kPXZvaWQgMH1yKGQpfHxUaC5kKGIsSihbXCJFT0Ygd2hpbGUgcmVhZGluZ1wiXSwwKSk7aWYoYT09PWQpcmV0dXJuIEFiKGMpO2U9VmguYj9WaC5iKGQpOlZoLmNhbGwobnVsbCxkKTtyKGUpP2Q9ZS5hP2UuYShiLGQpOmUuY2FsbChudWxsLGIsZCk6KFFoKGIsZCksZD1oaS5uP2hpLm4oYiwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYiwhMCxudWxsKSk7Yz1kPT09Yj9jOndkLmEoYyxkKX19ZnVuY3Rpb24gaWkoYSxiKXtyZXR1cm4gVGguZChhLEooW1wiUmVhZGVyIGZvciBcIixiLFwiIG5vdCBpbXBsZW1lbnRlZCB5ZXRcIl0sMCkpfVxuZnVuY3Rpb24gamkoYSxiKXt2YXIgYz1QaChhKSxkPWtpLmI/a2kuYihjKTpraS5jYWxsKG51bGwsYyk7aWYocihkKSlyZXR1cm4gZC5hP2QuYShhLGIpOmQuY2FsbChudWxsLGEsYik7ZD1saS5hP2xpLmEoYSxjKTpsaS5jYWxsKG51bGwsYSxjKTtyZXR1cm4gcihkKT9kOlRoLmQoYSxKKFtcIk5vIGRpc3BhdGNoIG1hY3JvIGZvciBcIixjXSwwKSl9ZnVuY3Rpb24gbWkoYSxiKXtyZXR1cm4gVGguZChhLEooW1wiVW5tYWNoZWQgZGVsaW1pdGVyIFwiLGJdLDApKX1mdW5jdGlvbiBuaShhKXtyZXR1cm4gUy5hKGZkLGdpKFwiKVwiLGEpKX1mdW5jdGlvbiBvaShhKXtyZXR1cm4gZ2koXCJdXCIsYSl9XG5mdW5jdGlvbiBwaShhKXt2YXIgYj1naShcIn1cIixhKSxjPU8oYik7aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBjfHxpc05hTihjKXx8SW5maW5pdHk9PT1jfHxwYXJzZUZsb2F0KGMpIT09cGFyc2VJbnQoYywxMCkpdGhyb3cgRXJyb3IoXCJBcmd1bWVudCBtdXN0IGJlIGFuIGludGVnZXI6IFwiK0EuYihjKSk7MCE9PShjJjEpJiZUaC5kKGEsSihbXCJNYXAgbGl0ZXJhbCBtdXN0IGNvbnRhaW4gYW4gZXZlbiBudW1iZXIgb2YgZm9ybXNcIl0sMCkpO3JldHVybiBTLmEoVGYsYil9ZnVuY3Rpb24gcWkoYSl7Zm9yKHZhciBiPW5ldyBlYSxjPVBoKGEpOzspe2lmKG51bGw9PWMpcmV0dXJuIFRoLmQoYSxKKFtcIkVPRiB3aGlsZSByZWFkaW5nXCJdLDApKTtpZihcIlxcXFxcIj09PWMpYi5hcHBlbmQoZmkoYSkpLGM9UGgoYSk7ZWxzZXtpZignXCInPT09YylyZXR1cm4gYi50b1N0cmluZygpO2lmKFliKWIuYXBwZW5kKGMpLGM9UGgoYSk7ZWxzZSByZXR1cm4gbnVsbH19fVxuZnVuY3Rpb24gcmkoYSl7Zm9yKHZhciBiPW5ldyBlYSxjPVBoKGEpOzspe2lmKG51bGw9PWMpcmV0dXJuIFRoLmQoYSxKKFtcIkVPRiB3aGlsZSByZWFkaW5nXCJdLDApKTtpZihcIlxcXFxcIj09PWMpe2IuYXBwZW5kKGMpO3ZhciBkPVBoKGEpO2lmKG51bGw9PWQpcmV0dXJuIFRoLmQoYSxKKFtcIkVPRiB3aGlsZSByZWFkaW5nXCJdLDApKTt2YXIgZT1mdW5jdGlvbigpe3ZhciBhPWI7YS5hcHBlbmQoZCk7cmV0dXJuIGF9KCksZj1QaChhKSxiPWUsYz1mfWVsc2V7aWYoJ1wiJz09PWMpcmV0dXJuIGIudG9TdHJpbmcoKTtpZih1KWU9ZnVuY3Rpb24oKXt2YXIgYT1iO2EuYXBwZW5kKGMpO3JldHVybiBhfSgpLGY9UGgoYSksYj1lLGM9ZjtlbHNlIHJldHVybiBudWxsfX19XG5mdW5jdGlvbiBzaShhLGIpe3ZhciBjPVVoKGEsYik7aWYocigtMSE9Yy5pbmRleE9mKFwiL1wiKSkpYz0kYi5hKGFkLmMoYywwLGMuaW5kZXhPZihcIi9cIikpLGFkLmMoYyxjLmluZGV4T2YoXCIvXCIpKzEsYy5sZW5ndGgpKTtlbHNlIHZhciBkPSRiLmIoYyksYz1cIm5pbFwiPT09Yz9udWxsOlwidHJ1ZVwiPT09Yz8hMDpcImZhbHNlXCI9PT1jPyExOnU/ZDpudWxsO3JldHVybiBjfWZ1bmN0aW9uIHRpKGEpe3ZhciBiPVVoKGEsUGgoYSkpLGM9YWkoJGgsYiksYj1jWzBdLGQ9Y1sxXSxjPWNbMl07cmV0dXJuIHZvaWQgMCE9PWQmJlwiOi9cIj09PWQuc3Vic3RyaW5nKGQubGVuZ3RoLTIsZC5sZW5ndGgpfHxcIjpcIj09PWNbYy5sZW5ndGgtMV18fC0xIT09Yi5pbmRleE9mKFwiOjpcIiwxKT9UaC5kKGEsSihbXCJJbnZhbGlkIHRva2VuOiBcIixiXSwwKSk6bnVsbCE9ZCYmMDxkLmxlbmd0aD9qZC5hKGQuc3Vic3RyaW5nKDAsZC5pbmRleE9mKFwiL1wiKSksYyk6amQuYihiKX1cbmZ1bmN0aW9uIHVpKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gRGEoRGEoSCxoaS5uP2hpLm4oYiwhMCxudWxsLCEwKTpoaS5jYWxsKG51bGwsYiwhMCxudWxsKSksYSl9fWZ1bmN0aW9uIHZpKCl7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBUaC5kKGEsSihbXCJVbnJlYWRhYmxlIGZvcm1cIl0sMCkpfX1cbmZ1bmN0aW9uIHdpKGEpe3ZhciBiO2I9aGkubj9oaS5uKGEsITAsbnVsbCwhMCk6aGkuY2FsbChudWxsLGEsITAsbnVsbCk7Yj1iIGluc3RhbmNlb2YgWmI/bmV3IGxhKG51bGwsMSxbY2gsYl0sbnVsbCk6XCJzdHJpbmdcIj09PXR5cGVvZiBiP25ldyBsYShudWxsLDEsW2NoLGJdLG51bGwpOmIgaW5zdGFuY2VvZiBUP25ldyBhZihbYiwhMF0pOnU/YjpudWxsO0djKGIpfHxUaC5kKGEsSihbXCJNZXRhZGF0YSBtdXN0IGJlIFN5bWJvbCxLZXl3b3JkLFN0cmluZyBvciBNYXBcIl0sMCkpO3ZhciBjPWhpLm4/aGkubihhLCEwLG51bGwsITApOmhpLmNhbGwobnVsbCxhLCEwLG51bGwpO3JldHVybihjP2MuaSYyNjIxNDR8fGMub2N8fChjLmk/MDpzKGRiLGMpKTpzKGRiLGMpKT9OKGMsWmYuZChKKFt4YyhjKSxiXSwwKSkpOlRoLmQoYSxKKFtcIk1ldGFkYXRhIGNhbiBvbmx5IGJlIGFwcGxpZWQgdG8gSVdpdGhNZXRhc1wiXSwwKSl9ZnVuY3Rpb24geGkoYSl7cmV0dXJuIGVnKGdpKFwifVwiLGEpKX1cbmZ1bmN0aW9uIHlpKGEpe3JldHVybiB0ZyhyaShhKSl9ZnVuY3Rpb24gemkoYSl7aGkubj9oaS5uKGEsITAsbnVsbCwhMCk6aGkuY2FsbChudWxsLGEsITAsbnVsbCk7cmV0dXJuIGF9ZnVuY3Rpb24gVmgoYSl7cmV0dXJuJ1wiJz09PWE/cWk6XCI6XCI9PT1hP3RpOlwiO1wiPT09YT9XaDpcIidcIj09PWE/dWkobmV3IFpiKG51bGwsXCJxdW90ZVwiLFwicXVvdGVcIiwxMzc3OTE2MjgyLG51bGwpKTpcIkBcIj09PWE/dWkobmV3IFpiKG51bGwsXCJkZXJlZlwiLFwiZGVyZWZcIiwxNDk0OTQ0NzMyLG51bGwpKTpcIl5cIj09PWE/d2k6XCJgXCI9PT1hP2lpOlwiflwiPT09YT9paTpcIihcIj09PWE/bmk6XCIpXCI9PT1hP21pOlwiW1wiPT09YT9vaTpcIl1cIj09PWE/bWk6XCJ7XCI9PT1hP3BpOlwifVwiPT09YT9taTpcIlxcXFxcIj09PWE/UGg6XCIjXCI9PT1hP2ppOm51bGx9ZnVuY3Rpb24ga2koYSl7cmV0dXJuXCJ7XCI9PT1hP3hpOlwiXFx4M2NcIj09PWE/dmkoKTonXCInPT09YT95aTpcIiFcIj09PWE/V2g6XCJfXCI9PT1hP3ppOm51bGx9XG5mdW5jdGlvbiBoaShhLGIsYyl7Zm9yKDs7KXt2YXIgZD1QaChhKTtpZihudWxsPT1kKXJldHVybiByKGIpP1RoLmQoYSxKKFtcIkVPRiB3aGlsZSByZWFkaW5nXCJdLDApKTpjO2lmKCFTaChkKSlpZihcIjtcIj09PWQpYT1XaC5hP1doLmEoYSxkKTpXaC5jYWxsKG51bGwsYSk7ZWxzZSBpZih1KXt2YXIgZT1WaChkKTtpZihyKGUpKWU9ZS5hP2UuYShhLGQpOmUuY2FsbChudWxsLGEsZCk7ZWxzZXt2YXIgZT1hLGY9dm9pZCAwOyEoZj0hL1teMC05XS8udGVzdChkKSkmJihmPXZvaWQgMCxmPVwiK1wiPT09ZHx8XCItXCI9PT1kKSYmKGY9UGgoZSksUWgoZSxmKSxmPSEvW14wLTldLy50ZXN0KGYpKTtpZihmKWE6e2U9YTtkPW5ldyBlYShkKTtmb3IoZj1QaChlKTs7KXt2YXIgaDtoPW51bGw9PWY7aHx8KGg9KGg9U2goZikpP2g6VmguYj9WaC5iKGYpOlZoLmNhbGwobnVsbCxmKSk7aWYocihoKSl7UWgoZSxmKTtmPWQ9ZC50b1N0cmluZygpO2g9dm9pZCAwO2lmKHIoYWkoWGgsZikpKWlmKGY9YWkoWGgsXG5mKSxudWxsIT1mWzJdKWg9MDtlbHNle2g9cihmWzNdKT9bZlszXSwxMF06cihmWzRdKT9bZls0XSwxNl06cihmWzVdKT9bZls1XSw4XTpyKGZbNl0pP1tmWzddLHBhcnNlSW50KGZbNl0sMTApXTp1P1tudWxsLG51bGxdOm51bGw7dmFyIGs9aFswXTtudWxsPT1rP2g9bnVsbDooaD1wYXJzZUludChrLGhbMV0pLGg9XCItXCI9PT1mWzFdPy1oOmgpfWVsc2UgaD12b2lkIDAscihhaShZaCxmKSk/KGY9YWkoWWgsZiksaD1wYXJzZUludChmWzFdLDEwKS9wYXJzZUludChmWzJdLDEwKSk6aD1yKGFpKFpoLGYpKT9wYXJzZUZsb2F0KGYpOm51bGw7Zj1oO2U9cihmKT9mOlRoLmQoZSxKKFtcIkludmFsaWQgbnVtYmVyIGZvcm1hdCBbXCIsZCxcIl1cIl0sMCkpO2JyZWFrIGF9ZC5hcHBlbmQoZik7Zj1QaChlKX1lPXZvaWQgMH1lbHNlIGU9dT9zaShhLGQpOm51bGx9aWYoZSE9PWEpcmV0dXJuIGV9ZWxzZSByZXR1cm4gbnVsbH19XG5mdW5jdGlvbiBBaShhKXtpZihXYi5hKDMsTyhhKSkpcmV0dXJuIGE7aWYoMzxPKGEpKXJldHVybiBhZC5jKGEsMCwzKTtpZih1KWZvcihhPW5ldyBlYShhKTs7KWlmKDM+YS5WYS5sZW5ndGgpYT1hLmFwcGVuZChcIjBcIik7ZWxzZSByZXR1cm4gYS50b1N0cmluZygpO2Vsc2UgcmV0dXJuIG51bGx9dmFyIEJpPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuIFEuYShyKGQpP2I6YSxjKX19KG5ldyBXKG51bGwsMTMsNSxYLFtudWxsLDMxLDI4LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXSxudWxsKSxuZXcgVyhudWxsLDEzLDUsWCxbbnVsbCwzMSwyOSwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMV0sbnVsbCkpLENpPS8oXFxkXFxkXFxkXFxkKSg/Oi0oXFxkXFxkKSg/Oi0oXFxkXFxkKSg/OltUXShcXGRcXGQpKD86OihcXGRcXGQpKD86OihcXGRcXGQpKD86Wy5dKFxcZCspKT8pPyk/KT8pPyk/KD86W1pdfChbLStdKShcXGRcXGQpOihcXGRcXGQpKT8vO1xuZnVuY3Rpb24gRGkoYSl7YT1wYXJzZUludChhLDEwKTtyZXR1cm4gc2EoaXNOYU4oYSkpP2E6bnVsbH1mdW5jdGlvbiBFaShhLGIsYyxkKXthPD1iJiZiPD1jfHxUaC5kKG51bGwsSihbXCJcIitBLmIoZCkrXCIgRmFpbGVkOiAgXCIrQS5iKGEpK1wiXFx4M2NcXHgzZFwiK0EuYihiKStcIlxceDNjXFx4M2RcIitBLmIoYyldLDApKTtyZXR1cm4gYn1cbmZ1bmN0aW9uIEZpKGEpe3ZhciBiPXNnKENpLGEpO1AuYyhiLDAsbnVsbCk7dmFyIGM9UC5jKGIsMSxudWxsKSxkPVAuYyhiLDIsbnVsbCksZT1QLmMoYiwzLG51bGwpLGY9UC5jKGIsNCxudWxsKSxoPVAuYyhiLDUsbnVsbCksaz1QLmMoYiw2LG51bGwpLGw9UC5jKGIsNyxudWxsKSxuPVAuYyhiLDgsbnVsbCkscT1QLmMoYiw5LG51bGwpLHQ9UC5jKGIsMTAsbnVsbCk7aWYoc2EoYikpcmV0dXJuIFRoLmQobnVsbCxKKFtcIlVucmVjb2duaXplZCBkYXRlL3RpbWUgc3ludGF4OiBcIitBLmIoYSldLDApKTthPURpKGMpO3ZhciBiPWZ1bmN0aW9uKCl7dmFyIGE9RGkoZCk7cmV0dXJuIHIoYSk/YToxfSgpLGM9ZnVuY3Rpb24oKXt2YXIgYT1EaShlKTtyZXR1cm4gcihhKT9hOjF9KCksdj1mdW5jdGlvbigpe3ZhciBhPURpKGYpO3JldHVybiByKGEpP2E6MH0oKSx3PWZ1bmN0aW9uKCl7dmFyIGE9RGkoaCk7cmV0dXJuIHIoYSk/YTowfSgpLHk9ZnVuY3Rpb24oKXt2YXIgYT1EaShrKTtyZXR1cm4gcihhKT9cbmE6MH0oKSxCPWZ1bmN0aW9uKCl7dmFyIGE9RGkoQWkobCkpO3JldHVybiByKGEpP2E6MH0oKSxuPShXYi5hKG4sXCItXCIpPy0xOjEpKig2MCpmdW5jdGlvbigpe3ZhciBhPURpKHEpO3JldHVybiByKGEpP2E6MH0oKStmdW5jdGlvbigpe3ZhciBhPURpKHQpO3JldHVybiByKGEpP2E6MH0oKSk7cmV0dXJuIG5ldyBXKG51bGwsOCw1LFgsW2EsRWkoMSxiLDEyLFwidGltZXN0YW1wIG1vbnRoIGZpZWxkIG11c3QgYmUgaW4gcmFuZ2UgMS4uMTJcIiksRWkoMSxjLEJpLmE/QmkuYShiLDA9PT0oYSU0KzQpJTQmJigwIT09KGElMTAwKzEwMCklMTAwfHwwPT09KGElNDAwKzQwMCklNDAwKSk6QmkuY2FsbChudWxsLGIsMD09PShhJTQrNCklNCYmKDAhPT0oYSUxMDArMTAwKSUxMDB8fDA9PT0oYSU0MDArNDAwKSU0MDApKSxcInRpbWVzdGFtcCBkYXkgZmllbGQgbXVzdCBiZSBpbiByYW5nZSAxLi5sYXN0IGRheSBpbiBtb250aFwiKSxFaSgwLHYsMjMsXCJ0aW1lc3RhbXAgaG91ciBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDAuLjIzXCIpLFxuRWkoMCx3LDU5LFwidGltZXN0YW1wIG1pbnV0ZSBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDAuLjU5XCIpLEVpKDAseSxXYi5hKHcsNTkpPzYwOjU5LFwidGltZXN0YW1wIHNlY29uZCBmaWVsZCBtdXN0IGJlIGluIHJhbmdlIDAuLjYwXCIpLEVpKDAsQiw5OTksXCJ0aW1lc3RhbXAgbWlsbGlzZWNvbmQgZmllbGQgbXVzdCBiZSBpbiByYW5nZSAwLi45OTlcIiksbl0sbnVsbCl9XG52YXIgR2k9SGcuYihuZXcgbGEobnVsbCw0LFtcImluc3RcIixmdW5jdGlvbihhKXt2YXIgYjtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpaWYoYj1GaShhKSxyKGIpKXthPVAuYyhiLDAsbnVsbCk7dmFyIGM9UC5jKGIsMSxudWxsKSxkPVAuYyhiLDIsbnVsbCksZT1QLmMoYiwzLG51bGwpLGY9UC5jKGIsNCxudWxsKSxoPVAuYyhiLDUsbnVsbCksaz1QLmMoYiw2LG51bGwpO2I9UC5jKGIsNyxudWxsKTtiPW5ldyBEYXRlKERhdGUuVVRDKGEsYy0xLGQsZSxmLGgsayktNkU0KmIpfWVsc2UgYj1UaC5kKG51bGwsSihbXCJVbnJlY29nbml6ZWQgZGF0ZS90aW1lIHN5bnRheDogXCIrQS5iKGEpXSwwKSk7ZWxzZSBiPVRoLmQobnVsbCxKKFtcIkluc3RhbmNlIGxpdGVyYWwgZXhwZWN0cyBhIHN0cmluZyBmb3IgaXRzIHRpbWVzdGFtcC5cIl0sMCkpO3JldHVybiBifSxcInV1aWRcIixmdW5jdGlvbihhKXtyZXR1cm5cInN0cmluZ1wiPT09dHlwZW9mIGE/bmV3IFRnKGEpOlRoLmQobnVsbCxKKFtcIlVVSUQgbGl0ZXJhbCBleHBlY3RzIGEgc3RyaW5nIGFzIGl0cyByZXByZXNlbnRhdGlvbi5cIl0sXG4wKSl9LFwicXVldWVcIixmdW5jdGlvbihhKXtyZXR1cm4gSGMoYSk/WWQoSmUsYSk6VGguZChudWxsLEooW1wiUXVldWUgbGl0ZXJhbCBleHBlY3RzIGEgdmVjdG9yIGZvciBpdHMgZWxlbWVudHMuXCJdLDApKX0sXCJqc1wiLGZ1bmN0aW9uKGEpe2lmKEhjKGEpKXt2YXIgYj1bXTthPUUoYSk7Zm9yKHZhciBjPW51bGwsZD0wLGU9MDs7KWlmKGU8ZCl7dmFyIGY9Yy5KKG51bGwsZSk7Yi5wdXNoKGYpO2UrPTF9ZWxzZSBpZihhPUUoYSkpYz1hLEljKGMpPyhhPUhiKGMpLGU9SWIoYyksYz1hLGQ9TyhhKSxhPWUpOihhPUYoYyksYi5wdXNoKGEpLGE9SShjKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSBicmVhaztyZXR1cm4gYn1pZihHYyhhKSl7Yj17fTthPUUoYSk7Yz1udWxsO2ZvcihlPWQ9MDs7KWlmKGU8ZCl7dmFyIGg9Yy5KKG51bGwsZSksZj1QLmMoaCwwLG51bGwpLGg9UC5jKGgsMSxudWxsKTtiW2lkKGYpXT1oO2UrPTF9ZWxzZSBpZihhPUUoYSkpSWMoYSk/KGQ9SGIoYSksYT1JYihhKSxjPWQsXG5kPU8oZCkpOihkPUYoYSksYz1QLmMoZCwwLG51bGwpLGQ9UC5jKGQsMSxudWxsKSxiW2lkKGMpXT1kLGE9SShhKSxjPW51bGwsZD0wKSxlPTA7ZWxzZSBicmVhaztyZXR1cm4gYn1yZXR1cm4gdT9UaC5kKG51bGwsSihbXCJKUyBsaXRlcmFsIGV4cGVjdHMgYSB2ZWN0b3Igb3IgbWFwIGNvbnRhaW5pbmcgb25seSBzdHJpbmcgb3IgdW5xdWFsaWZpZWQga2V5d29yZCBrZXlzXCJdLDApKTpudWxsfV0sbnVsbCkpLEhpPUhnLmIobnVsbCk7XG5mdW5jdGlvbiBsaShhLGIpe3ZhciBjPXNpKGEsYiksZD1RLmEoYWIoR2kpLFwiXCIrQS5iKGMpKSxlPWFiKEhpKTtyZXR1cm4gcihkKT9kLmI/ZC5iKGhpKGEsITAsbnVsbCkpOmQuY2FsbChudWxsLGhpKGEsITAsbnVsbCkpOnIoZSk/ZS5hP2UuYShjLGhpKGEsITAsbnVsbCkpOmUuY2FsbChudWxsLGMsaGkoYSwhMCxudWxsKSk6dT9UaC5kKGEsSihbXCJDb3VsZCBub3QgZmluZCB0YWcgcGFyc2VyIGZvciBcIixcIlwiK0EuYihjKSxcIiBpbiBcIixDZy5kKEooW1ZlKGFiKEdpKSldLDApKV0sMCkpOm51bGx9O3AoXCJtb3JpLmFwcGx5XCIsUyk7cChcIm1vcmkuY291bnRcIixPKTtwKFwibW9yaS5kaXN0aW5jdFwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbiBjKGEsZSl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYSxkKXtmb3IoOzspe3ZhciBlPWEsbD1QLmMoZSwwLG51bGwpO2lmKGU9RShlKSlpZihPYyhkLGwpKWw9RyhlKSxlPWQsYT1sLGQ9ZTtlbHNlIHJldHVybiBNKGwsYyhHKGUpLHBjLmEoZCxsKSkpO2Vsc2UgcmV0dXJuIG51bGx9fS5jYWxsKG51bGwsYSxlKX0sbnVsbCxudWxsKX0oYSxiZyl9KTtwKFwibW9yaS5lbXB0eVwiLHFjKTtwKFwibW9yaS5maXJzdFwiLEYpO3AoXCJtb3JpLnJlc3RcIixHKTtwKFwibW9yaS5zZXFcIixFKTtwKFwibW9yaS5jb25qXCIscGMpO3AoXCJtb3JpLmNvbnNcIixNKTtcbnAoXCJtb3JpLmZpbmRcIixmdW5jdGlvbihhLGIpe3JldHVybiBudWxsIT1hJiZFYyhhKSYmT2MoYSxiKT9uZXcgVyhudWxsLDIsNSxYLFtiLFEuYShhLGIpXSxudWxsKTpudWxsfSk7cChcIm1vcmkubnRoXCIsUCk7cChcIm1vcmkubGFzdFwiLG9jKTtwKFwibW9yaS5hc3NvY1wiLFIpO3AoXCJtb3JpLmRpc3NvY1wiLHRjKTtwKFwibW9yaS5nZXRfaW5cIiwkZCk7cChcIm1vcmkudXBkYXRlX2luXCIsYWUpO3AoXCJtb3JpLmFzc29jX2luXCIsZnVuY3Rpb24gSWkoYixjLGQpe3ZhciBlPVAuYyhjLDAsbnVsbCk7cmV0dXJuKGM9JGMoYykpP1IuYyhiLGUsSWkoUS5hKGIsZSksYyxkKSk6Ui5jKGIsZSxkKX0pO3AoXCJtb3JpLmZuaWxcIixKZCk7cChcIm1vcmkuZGlzalwiLEFjKTtwKFwibW9yaS5wb3BcIix6Yyk7cChcIm1vcmkucGVla1wiLHljKTtwKFwibW9yaS5oYXNoXCIsVGIpO3AoXCJtb3JpLmdldFwiLFEpO3AoXCJtb3JpLmhhc19rZXlcIixPYyk7cChcIm1vcmkuaXNfZW1wdHlcIixCYyk7cChcIm1vcmkucmV2ZXJzZVwiLGVkKTtcbnAoXCJtb3JpLnRha2VcIixNZCk7cChcIm1vcmkuZHJvcFwiLE5kKTtwKFwibW9yaS50YWtlX250aFwiLGZ1bmN0aW9uIEppKGIsYyl7cmV0dXJuIG5ldyBWKG51bGwsZnVuY3Rpb24oKXt2YXIgZD1FKGMpO3JldHVybiBkP00oRihkKSxKaShiLE5kKGIsZCkpKTpudWxsfSxudWxsLG51bGwpfSk7cChcIm1vcmkucGFydGl0aW9uXCIsWmQpO3AoXCJtb3JpLnBhcnRpdGlvbl9hbGxcIixqZyk7cChcIm1vcmkucGFydGl0aW9uX2J5XCIsZnVuY3Rpb24gS2koYixjKXtyZXR1cm4gbmV3IFYobnVsbCxmdW5jdGlvbigpe3ZhciBkPUUoYyk7aWYoZCl7dmFyIGU9RihkKSxmPWIuYj9iLmIoZSk6Yi5jYWxsKG51bGwsZSksZT1NKGUsbGcoZnVuY3Rpb24oYyxkKXtyZXR1cm4gZnVuY3Rpb24oYyl7cmV0dXJuIFdiLmEoZCxiLmI/Yi5iKGMpOmIuY2FsbChudWxsLGMpKX19KGUsZixkLGQpLEkoZCkpKTtyZXR1cm4gTShlLEtpKGIsRShOZChPKGUpLGQpKSkpfXJldHVybiBudWxsfSxudWxsLG51bGwpfSk7XG5wKFwibW9yaS5pdGVyYXRlXCIsZnVuY3Rpb24gTGkoYixjKXtyZXR1cm4gTShjLG5ldyBWKG51bGwsZnVuY3Rpb24oKXtyZXR1cm4gTGkoYixiLmI/Yi5iKGMpOmIuY2FsbChudWxsLGMpKX0sbnVsbCxudWxsKSl9KTtwKFwibW9yaS5pbnRvXCIsWWQpO3AoXCJtb3JpLm1lcmdlXCIsWmYpO3AoXCJtb3JpLnN1YnZlY1wiLHplKTtwKFwibW9yaS50YWtlX3doaWxlXCIsbGcpO3AoXCJtb3JpLmRyb3Bfd2hpbGVcIixmdW5jdGlvbihhLGIpe3JldHVybiBuZXcgVihudWxsLGZ1bmN0aW9uKGMpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBjKGEsYil9fShmdW5jdGlvbihhLGIpe2Zvcig7Oyl7dmFyIGU9RShiKSxmO2Y9KGY9ZSk/YS5iP2EuYihGKGUpKTphLmNhbGwobnVsbCxGKGUpKTpmO2lmKHIoZikpZj1hLGU9RyhlKSxhPWYsYj1lO2Vsc2UgcmV0dXJuIGV9fSksbnVsbCxudWxsKX0pO1xucChcIm1vcmkuZ3JvdXBfYnlcIixmdW5jdGlvbihhLGIpe3JldHVybiBDLmMoZnVuY3Rpb24oYixkKXt2YXIgZT1hLmI/YS5iKGQpOmEuY2FsbChudWxsLGQpO3JldHVybiBSLmMoYixlLHBjLmEoUS5jKGIsZSxxZSksZCkpfSxZZSxiKX0pO3AoXCJtb3JpLmludGVycG9zZVwiLGZ1bmN0aW9uKGEsYil7cmV0dXJuIE5kKDEsUWQuYShPZC5iKGEpLGIpKX0pO3AoXCJtb3JpLmludGVybGVhdmVcIixRZCk7cChcIm1vcmkuY29uY2F0XCIsdGQpO3AoXCJtb3JpLmNvbmoxXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5HKG51bGwsYil9KTtmdW5jdGlvbiBYZChhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIEFycmF5fHxGYyhhKX1wKFwibW9yaS5mbGF0dGVuXCIsZnVuY3Rpb24oYSl7cmV0dXJuIFVkKGZ1bmN0aW9uKGEpe3JldHVybiFYZChhKX0sRyhXZChhKSkpfSk7cChcIm1vcmkubGF6eV9zZXFcIixmdW5jdGlvbihhKXtyZXR1cm4gbmV3IFYobnVsbCxhLG51bGwsbnVsbCl9KTtwKFwibW9yaS5rZXlzXCIsVmUpO1xucChcIm1vcmkuc2VsZWN0X2tleXNcIixmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1ZZSxkPUUoYik7OylpZihkKXZhciBlPUYoZCksZj1RLmMoYSxlLGloKSxjPUJkLmEoZixpaCk/Ui5jKGMsZSxmKTpjLGQ9SShkKTtlbHNlIHJldHVybiBjfSk7cChcIm1vcmkudmFsc1wiLFdlKTtwKFwibW9yaS5wcmltX3NlcVwiLG1jKTtwKFwibW9yaS5tYXBcIixLZCk7cChcIm1vcmkubWFwY2F0XCIsU2QpO3AoXCJtb3JpLnJlZHVjZVwiLEMpO3AoXCJtb3JpLnJlZHVjZV9rdlwiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbnVsbCE9Yz9oYihjLGEsYik6Yn0pO3AoXCJtb3JpLmZpbHRlclwiLFVkKTtwKFwibW9yaS5yZW1vdmVcIixWZCk7cChcIm1vcmkuc29tZVwiLEVkKTtwKFwibW9yaS5ldmVyeVwiLERkKTtwKFwibW9yaS5lcXVhbHNcIixXYik7cChcIm1vcmkucmFuZ2VcIixwZyk7cChcIm1vcmkucmVwZWF0XCIsT2QpO3AoXCJtb3JpLnJlcGVhdGVkbHlcIixQZCk7cChcIm1vcmkuc29ydFwiLFNjKTtwKFwibW9yaS5zb3J0X2J5XCIsVGMpO1xucChcIm1vcmkuaW50b19hcnJheVwiLHhhKTtwKFwibW9yaS5zdWJzZXFcIixuZyk7cChcIm1vcmkucm1hcFwiLHRoKTtwKFwibW9yaS5yZmlsdGVyXCIsdWgpO3AoXCJtb3JpLnJyZW1vdmVcIix3aCk7cChcIm1vcmkucnRha2VcIix5aCk7cChcIm1vcmkucnRha2Vfd2hpbGVcIix4aCk7cChcIm1vcmkucmRyb3BcIix6aCk7cChcIm1vcmkucmZsYXR0ZW5cIix2aCk7cChcIm1vcmkubGlzdFwiLGZkKTtwKFwibW9yaS52ZWN0b3JcIix4ZSk7cChcIm1vcmkuYXJyYXlfbWFwXCIsVWYpO3AoXCJtb3JpLmhhc2hfbWFwXCIsVGYpO3AoXCJtb3JpLnNldFwiLGVnKTtwKFwibW9yaS5zb3J0ZWRfc2V0XCIsZmcpO3AoXCJtb3JpLnNvcnRlZF9zZXRfYnlcIixnZyk7cChcIm1vcmkuc29ydGVkX21hcFwiLFZmKTtwKFwibW9yaS5zb3J0ZWRfbWFwX2J5XCIsV2YpO1xucChcIm1vcmkucXVldWVcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dmFyIGQ9bnVsbDswPGFyZ3VtZW50cy5sZW5ndGgmJihkPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsZCl9ZnVuY3Rpb24gYihhKXtyZXR1cm4gWWQuYT9ZZC5hKEplLGEpOllkLmNhbGwobnVsbCxKZSxhKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSk7cChcIm1vcmkua2V5d29yZFwiLGpkKTtwKFwibW9yaS5zeW1ib2xcIiwkYik7cChcIm1vcmkuemlwbWFwXCIsZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9eWIoWWUpLGQ9RShhKSxlPUUoYik7OylpZihkJiZlKWM9eGQuYyhjLEYoZCksRihlKSksZD1JKGQpLGU9SShlKTtlbHNlIHJldHVybiBBYihjKX0pO1xucChcIm1vcmkuaXNfbGlzdFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhP2EuaSYzMzU1NDQzMnx8YS5FYz8hMDphLmk/ITE6cyhuYixhKTpzKG5iLGEpfSk7cChcIm1vcmkuaXNfc2VxXCIsTWMpO3AoXCJtb3JpLmlzX3ZlY3RvclwiLEhjKTtwKFwibW9yaS5pc19tYXBcIixHYyk7cChcIm1vcmkuaXNfc2V0XCIsRGMpO3AoXCJtb3JpLmlzX2tleXdvcmRcIixmdW5jdGlvbihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIFR9KTtwKFwibW9yaS5pc19zeW1ib2xcIixmdW5jdGlvbihhKXtyZXR1cm4gYSBpbnN0YW5jZW9mIFpifSk7cChcIm1vcmkuaXNfY29sbGVjdGlvblwiLENjKTtwKFwibW9yaS5pc19zZXF1ZW50aWFsXCIsRmMpO3AoXCJtb3JpLmlzX2Fzc29jaWF0aXZlXCIsRWMpO3AoXCJtb3JpLmlzX2NvdW50ZWRcIixpYyk7cChcIm1vcmkuaXNfaW5kZXhlZFwiLGpjKTtwKFwibW9yaS5pc19yZWR1Y2VhYmxlXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YS5pJjUyNDI4OHx8YS5OYj8hMDphLmk/ITE6cyhmYixhKTpzKGZiLGEpfSk7XG5wKFwibW9yaS5pc19zZXFhYmxlXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YS5pJjgzODg2MDh8fGEuaGM/ITA6YS5pPyExOnMoa2IsYSk6cyhrYixhKX0pO3AoXCJtb3JpLmlzX3JldmVyc2libGVcIixkZCk7cChcIm1vcmkudW5pb25cIixEaCk7cChcIm1vcmkuaW50ZXJzZWN0aW9uXCIsRWgpO3AoXCJtb3JpLmRpZmZlcmVuY2VcIixGaCk7cChcIm1vcmkuaXNfc3Vic2V0XCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gTyhhKTw9TyhiKSYmRGQoZnVuY3Rpb24oYSl7cmV0dXJuIE9jKGIsYSl9LGEpfSk7cChcIm1vcmkuaXNfc3VwZXJzZXRcIixmdW5jdGlvbihhLGIpe3JldHVybiBPKGEpPj1PKGIpJiZEZChmdW5jdGlvbihiKXtyZXR1cm4gT2MoYSxiKX0sYil9KTtwKFwibW9yaS5wYXJ0aWFsXCIsSWQpO3AoXCJtb3JpLmNvbXBcIixIZCk7XG5wKFwibW9yaS5waXBlbGluZVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhKXt2YXIgZD1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGQ9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBiLmNhbGwodGhpcyxkKX1mdW5jdGlvbiBiKGEpe3JldHVybiBDLmE/Qy5hKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIuYj9iLmIoYSk6Yi5jYWxsKG51bGwsYSl9LGEpOkMuY2FsbChudWxsLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIuYj9iLmIoYSk6Yi5jYWxsKG51bGwsYSl9LGEpfWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O2EuZD1iO3JldHVybiBhfSgpKTtcbnAoXCJtb3JpLmN1cnJ5XCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsZCl7dmFyIGU9bnVsbDsxPGFyZ3VtZW50cy5sZW5ndGgmJihlPUooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLDApKTtyZXR1cm4gYi5jYWxsKHRoaXMsYSxlKX1mdW5jdGlvbiBiKGEsYil7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBTLmEoYSxNLmE/TS5hKGUsYik6TS5jYWxsKG51bGwsZSxiKSl9fWEuaz0xO2EuZj1mdW5jdGlvbihhKXt2YXIgZD1GKGEpO2E9RyhhKTtyZXR1cm4gYihkLGEpfTthLmQ9YjtyZXR1cm4gYX0oKSk7XG5wKFwibW9yaS5qdXh0XCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhKXt2YXIgYz1udWxsOzA8YXJndW1lbnRzLmxlbmd0aCYmKGM9SihBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCksMCkpO3JldHVybiBlLmNhbGwodGhpcyxjKX1mdW5jdGlvbiBlKGIpe3JldHVybiB4YS5iP3hhLmIoS2QuYT9LZC5hKGZ1bmN0aW9uKGEpe3JldHVybiBTLmEoYSxiKX0sYSk6S2QuY2FsbChudWxsLGZ1bmN0aW9uKGEpe3JldHVybiBTLmEoYSxiKX0sYSkpOnhhLmNhbGwobnVsbCxLZC5hP0tkLmEoZnVuY3Rpb24oYSl7cmV0dXJuIFMuYShhLGIpfSxhKTpLZC5jYWxsKG51bGwsZnVuY3Rpb24oYSl7cmV0dXJuIFMuYShhLFxuYil9LGEpKX1iLms9MDtiLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBlKGEpfTtiLmQ9ZTtyZXR1cm4gYn0oKX1hLms9MDthLmY9ZnVuY3Rpb24oYSl7YT1FKGEpO3JldHVybiBiKGEpfTthLmQ9YjtyZXR1cm4gYX0oKSk7XG5wKFwibW9yaS5rbml0XCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEpe3ZhciBkPW51bGw7MDxhcmd1bWVudHMubGVuZ3RoJiYoZD1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGQpfWZ1bmN0aW9uIGIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiB4YS5iP3hhLmIoS2QuYz9LZC5jKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYj9hLmIoYik6YS5jYWxsKG51bGwsYil9LGEsYik6S2QuY2FsbChudWxsLGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuYj9hLmIoYik6YS5jYWxsKG51bGwsYil9LGEsYikpOnhhLmNhbGwobnVsbCxLZC5jP0tkLmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKX0sYSxiKTpLZC5jYWxsKG51bGwsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5iP2EuYihiKTphLmNhbGwobnVsbCxiKX0sYSxiKSl9fWEuaz0wO2EuZj1mdW5jdGlvbihhKXthPUUoYSk7cmV0dXJuIGIoYSl9O1xuYS5kPWI7cmV0dXJuIGF9KCkpO3AoXCJtb3JpLmRpZmZcIixKaCk7cChcIm1vcmkuc3VtXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYStifSk7cChcIm1vcmkuaW5jXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGErMX0pO3AoXCJtb3JpLmRlY1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLTF9KTtwKFwibW9yaS5pc19ldmVuXCIsZnVuY3Rpb24oYSl7cmV0dXJuIDA9PT0oYSUyKzIpJTJ9KTtwKFwibW9yaS5pc19vZGRcIixmdW5jdGlvbihhKXtyZXR1cm4gMT09PShhJTIrMiklMn0pO3AoXCJtb3JpLmVhY2hcIixmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz1FKGEpLGQ9bnVsbCxlPTAsZj0wOzspaWYoZjxlKXt2YXIgaD1kLkoobnVsbCxmKTtiLmI/Yi5iKGgpOmIuY2FsbChudWxsLGgpO2YrPTF9ZWxzZSBpZihjPUUoYykpZD1jLEljKGQpPyhjPUhiKGQpLGU9SWIoZCksZD1jLGg9TyhjKSxjPWUsZT1oKTooaD1GKGQpLGIuYj9iLmIoaCk6Yi5jYWxsKG51bGwsaCksYz1JKGQpLGQ9bnVsbCxlPTApLGY9MDtlbHNlIHJldHVybiBudWxsfSk7XG5wKFwibW9yaS5pZGVudGl0eVwiLEZkKTtwKFwibW9yaS5jb25zdGFudGx5XCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihiKXswPGFyZ3VtZW50cy5sZW5ndGgmJkooQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApLDApO3JldHVybiBhfWIuaz0wO2IuZj1mdW5jdGlvbihiKXtFKGIpO3JldHVybiBhfTtiLmQ9ZnVuY3Rpb24oKXtyZXR1cm4gYX07cmV0dXJuIGJ9KCl9KTtwKFwibW9yaS5jbGpfdG9fanNcIixOZyk7XG5wKFwibW9yaS5qc190b19jbGpcIixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxiKXtyZXR1cm4gU2cuZChhLEooW1JnLGJdLDApKX1mdW5jdGlvbiBiKGEpe3JldHVybiBTZy5iKGEpfXZhciBjPW51bGwsYz1mdW5jdGlvbihjLGUpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGIuY2FsbCh0aGlzLGMpO2Nhc2UgMjpyZXR1cm4gYS5jYWxsKHRoaXMsYyxlKX10aHJvdyBFcnJvcihcIkludmFsaWQgYXJpdHk6IFwiK2FyZ3VtZW50cy5sZW5ndGgpO307Yy5iPWI7Yy5hPWE7cmV0dXJuIGN9KCkpO3AoXCJtb3JpLnBhcnNlXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGhpKG5ldyBSaChhLFtdLC0xKSwhMSxudWxsKX0pO1xucChcIm1vcmkuY29uZmlndXJlXCIsZnVuY3Rpb24oYSxiKXtzd2l0Y2goYSl7Y2FzZSBcInByaW50LWxlbmd0aFwiOnJldHVybiBpYT1iO2Nhc2UgXCJwcmludC1sZXZlbFwiOnJldHVybiBqYT1iO2RlZmF1bHQ6dGhyb3cgRXJyb3IoXCJObyBtYXRjaGluZyBjbGF1c2U6IFwiK0EuYihhKSk7fX0pO1xucChcIm1vcmkucHJveHlcIixmdW5jdGlvbihhKXtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIFByb3h5KXJldHVybiBQcm94eS5jcmVhdGUoZnVuY3Rpb24oKXtyZXR1cm57aGFzOmZ1bmN0aW9uKGIpe3JldHVybiBPYyhhLGIpfSxoYXNPd246ZnVuY3Rpb24oYil7cmV0dXJuIE9jKGEsYil9LGdldDpmdW5jdGlvbihiLGMpe3ZhciBkPVEuYz9RLmMoYSxjLGhoKTpRLmNhbGwobnVsbCxhLGMsaGgpO3JldHVybiBoZChkLGhoKT9pYyhhKSYmXCJsZW5ndGhcIj09PWM/Ty5iP08uYihhKTpPLmNhbGwobnVsbCxhKTpudWxsOnU/ZDpudWxsfSxzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZW51bWVyYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHhhLmI/eGEuYihWZS5iP1ZlLmIoYSk6VmUuY2FsbChudWxsLGEpKTp4YS5jYWxsKG51bGwsVmUuYj9WZS5iKGEpOlZlLmNhbGwobnVsbCxhKSl9LGtleXM6ZnVuY3Rpb24oKXtyZXR1cm4gR2MoYSk/eGEuYj94YS5iKFZlLmI/VmUuYihhKTpWZS5jYWxsKG51bGwsXG5hKSk6eGEuY2FsbChudWxsLFZlLmI/VmUuYihhKTpWZS5jYWxsKG51bGwsYSkpOkhjKGEpP3hhLmI/eGEuYihwZy5iP3BnLmIoTy5iP08uYihhKTpPLmNhbGwobnVsbCxhKSk6cGcuY2FsbChudWxsLE8uYj9PLmIoYSk6Ty5jYWxsKG51bGwsYSkpKTp4YS5jYWxsKG51bGwscGcuYj9wZy5iKE8uYj9PLmIoYSk6Ty5jYWxsKG51bGwsYSkpOnBnLmNhbGwobnVsbCxPLmI/Ty5iKGEpOk8uY2FsbChudWxsLGEpKSk6bnVsbH19fSgpKTt0aHJvdyBFcnJvcihcIkVTNiBQcm94eSBub3Qgc3VwcG9ydGVkIVwiKTt9KTtWLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07YWMucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtrYy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O0JmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07XG52Zi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O3dmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07YmQucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtnZC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2NkLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07Vy5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O29kLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07eWUucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtBZS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1xuJC5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O1kucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtsYS5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O3hmLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07UWYucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTskZi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O2NnLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07b2cucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtULnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07XG5aYi5wcm90b3R5cGUuaW5zcGVjdD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRvU3RyaW5nKCl9O0llLnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9TdHJpbmcoKX07SGUucHJvdG90eXBlLmluc3BlY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1N0cmluZygpfTtwKFwibW9yaS5fZXF1aXZcIixmdW5jdGlvbihhLGIpe3JldHVybiBhLkhjKGIpfSk7cChcIm1vcmkuX2tleXNcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5rZXlzKCl9KTtwKFwibW9yaS5fdmFsdWVzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEudmFsdWVzKCl9KTtwKFwibW9yaS5fZW50cmllc1wiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmVudHJpZXMoKX0pO3AoXCJtb3JpLl9oYXNcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5oYXMoKX0pO3AoXCJtb3JpLl9nZXRcIixmdW5jdGlvbihhKXtyZXR1cm4gYS5nZXQoKX0pO3AoXCJtb3JpLl9mb3JFYWNoXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuZm9yRWFjaCgpfSk7XG5wKFwibW9yaS5fbmV4dFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLm5leHQoKX0pO3AoXCJtb3JpLm11dGFibGUudGhhd1wiLGZ1bmN0aW9uKGEpe3JldHVybiB5YihhKX0pO3AoXCJtb3JpLm11dGFibGUuZnJlZXplXCIsdmQpO3AoXCJtb3JpLm11dGFibGUuY29uajFcIixmdW5jdGlvbihhLGIpe3JldHVybiBhLkthKG51bGwsYil9KTtwKFwibW9yaS5tdXRhYmxlLmNvbmpcIix3ZCk7cChcIm1vcmkubXV0YWJsZS5hc3NvY1wiLHhkKTtwKFwibW9yaS5tdXRhYmxlLmRpc3NvY1wiLHlkKTtwKFwibW9yaS5tdXRhYmxlLnBvcFwiLGZ1bmN0aW9uKGEpe3JldHVybiBFYihhKX0pO3AoXCJtb3JpLm11dGFibGUuZGlzalwiLHpkKTtmdW5jdGlvbiBNaShhLGIsYyxkKXtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFtkLG51bGxdLG51bGwpLG5ldyBsYShudWxsLDMsWyRnLGMsWGcsYixWZyxhXSxudWxsKSl9ZnVuY3Rpb24gTmkoYSl7cmV0dXJuIGEuYj9hLmIoMCk6YS5jYWxsKG51bGwsMCl9ZnVuY3Rpb24gT2koYSl7cmV0dXJuIFZnLmIoeGMoYSkpLmNhbGwobnVsbCxOaShhKSl9ZnVuY3Rpb24gUGkoYSl7aWYocihPaShhKSkpcmV0dXJuIFhnLmIoeGMoYSkpLmNhbGwobnVsbCxOaShhKSk7dGhyb3dcImNhbGxlZCBjaGlsZHJlbiBvbiBhIGxlYWYgbm9kZVwiO31mdW5jdGlvbiBRaShhLGIsYyl7cmV0dXJuICRnLmIoeGMoYSkpLmNhbGwobnVsbCxiLGMpfVxuZnVuY3Rpb24gUmkoYSl7aWYocihPaShhKSkpe3ZhciBiPVAuYyhhLDAsbnVsbCksYz1QLmMoYSwxLG51bGwpLGQ9UGkoYSksZT1QLmMoZCwwLG51bGwpLGY9JGMoZCk7cmV0dXJuIHIoZCk/TihuZXcgVyhudWxsLDIsNSxYLFtlLG5ldyBsYShudWxsLDQsW1pnLHFlLGFoLHIoYyk/cGMuYShhaC5iKGMpLGIpOm5ldyBXKG51bGwsMSw1LFgsW2JdLG51bGwpLFVnLGMsV2csZl0sbnVsbCldLG51bGwpLHhjKGEpKTpudWxsfXJldHVybiBudWxsfVxuZnVuY3Rpb24gU2koYSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksZD1NYyhjKT9TLmEoVGYsYyk6YyxjPVEuYShkLFpnKSxlPVEuYShkLFVnKSxmPVEuYShkLGFoKSxoPVEuYShkLFdnKSxkPVEuYShkLGJoKTtyZXR1cm4gcihmKT8oZj15YyhmKSxOKHIoZCk/bmV3IFcobnVsbCwyLDUsWCxbUWkoYSxmLHRkLmEoYyxNKGIsaCkpKSxyKGUpP1IuYyhlLGJoLCEwKTplXSxudWxsKTpuZXcgVyhudWxsLDIsNSxYLFtmLGVdLG51bGwpLHhjKGEpKSk6bnVsbH1mdW5jdGlvbiBUaShhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxjPU1jKGMpP1MuYShUZixjKTpjLGQ9US5hKGMsWmcpLGU9US5hKGMsV2cpLGY9UC5jKGUsMCxudWxsKSxoPSRjKGUpO3JldHVybiByKHIoYyk/ZTpjKT9OKG5ldyBXKG51bGwsMiw1LFgsW2YsUi5kKGMsWmcscGMuYShkLGIpLEooW1dnLGhdLDApKV0sbnVsbCkseGMoYSkpOm51bGx9XG5mdW5jdGlvbiBVaShhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxjPU1jKGMpP1MuYShUZixjKTpjLGQ9US5hKGMsWmcpLGU9US5hKGMsV2cpO3JldHVybiByKHIoYyk/ZTpjKT9OKG5ldyBXKG51bGwsMiw1LFgsW29jKGUpLFIuZChjLFpnLFMubihwYyxkLGIsaGcoZSkpLEooW1dnLG51bGxdLDApKV0sbnVsbCkseGMoYSkpOmF9ZnVuY3Rpb24gVmkoYSl7dmFyIGI9UC5jKGEsMCxudWxsKSxjPVAuYyhhLDEsbnVsbCksYz1NYyhjKT9TLmEoVGYsYyk6YyxkPVEuYShjLFpnKSxlPVEuYShjLFdnKTtyZXR1cm4gcihyKGMpP0UoZCk6Yyk/TihuZXcgVyhudWxsLDIsNSxYLFt5YyhkKSxSLmQoYyxaZyx6YyhkKSxKKFtXZyxNKGIsZSldLDApKV0sbnVsbCkseGMoYSkpOm51bGx9XG5mdW5jdGlvbiBXaShhLGIpe1AuYyhhLDAsbnVsbCk7dmFyIGM9UC5jKGEsMSxudWxsKTtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFtiLFIuYyhjLGJoLCEwKV0sbnVsbCkseGMoYSkpfXZhciBYaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSxkLGUpe3ZhciBmPW51bGw7Mjxhcmd1bWVudHMubGVuZ3RoJiYoZj1KKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKSwwKSk7cmV0dXJuIGIuY2FsbCh0aGlzLGEsZCxmKX1mdW5jdGlvbiBiKGEsYixlKXtyZXR1cm4gV2koYSxTLmMoYixOaShhKSxlKSl9YS5rPTI7YS5mPWZ1bmN0aW9uKGEpe3ZhciBkPUYoYSk7YT1JKGEpO3ZhciBlPUYoYSk7YT1HKGEpO3JldHVybiBiKGQsZSxhKX07YS5kPWI7cmV0dXJuIGF9KCk7cChcIm1vcmkuemlwLnppcHBlclwiLE1pKTtwKFwibW9yaS56aXAuc2VxX3ppcFwiLGZ1bmN0aW9uKGEpe3JldHVybiBNaShNYyxGZCxmdW5jdGlvbihhLGMpe3JldHVybiBOKGMseGMoYSkpfSxhKX0pO3AoXCJtb3JpLnppcC52ZWN0b3JfemlwXCIsZnVuY3Rpb24oYSl7cmV0dXJuIE1pKEhjLEUsZnVuY3Rpb24oYSxjKXtyZXR1cm4gTih3ZShjKSx4YyhhKSl9LGEpfSk7cChcIm1vcmkuemlwLm5vZGVcIixOaSk7cChcIm1vcmkuemlwLmlzX2JyYW5jaFwiLHt9LnhjKTtwKFwibW9yaS56aXAuY2hpbGRyZW5cIixQaSk7cChcIm1vcmkuemlwLm1ha2Vfbm9kZVwiLFFpKTtwKFwibW9yaS56aXAucGF0aFwiLGZ1bmN0aW9uKGEpe3JldHVybiBhaC5iKGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpfSk7cChcIm1vcmkuemlwLmxlZnRzXCIsZnVuY3Rpb24oYSl7cmV0dXJuIEUoWmcuYihhLmI/YS5iKDEpOmEuY2FsbChudWxsLDEpKSl9KTtcbnAoXCJtb3JpLnppcC5yaWdodHNcIixmdW5jdGlvbihhKXtyZXR1cm4gV2cuYihhLmI/YS5iKDEpOmEuY2FsbChudWxsLDEpKX0pO3AoXCJtb3JpLnppcC5kb3duXCIsUmkpO3AoXCJtb3JpLnppcC51cFwiLFNpKTtwKFwibW9yaS56aXAucm9vdFwiLGZ1bmN0aW9uKGEpe2Zvcig7Oyl7aWYoV2IuYShlaCxhLmI/YS5iKDEpOmEuY2FsbChudWxsLDEpKSlyZXR1cm4gTmkoYSk7dmFyIGI9U2koYSk7aWYocihiKSlhPWI7ZWxzZSByZXR1cm4gTmkoYSl9fSk7cChcIm1vcmkuemlwLnJpZ2h0XCIsVGkpO3AoXCJtb3JpLnppcC5yaWdodG1vc3RcIixVaSk7cChcIm1vcmkuemlwLmxlZnRcIixWaSk7XG5wKFwibW9yaS56aXAubGVmdG1vc3RcIixmdW5jdGlvbihhKXt2YXIgYj1QLmMoYSwwLG51bGwpLGM9UC5jKGEsMSxudWxsKSxjPU1jKGMpP1MuYShUZixjKTpjLGQ9US5hKGMsWmcpLGU9US5hKGMsV2cpO3JldHVybiByKHIoYyk/RShkKTpjKT9OKG5ldyBXKG51bGwsMiw1LFgsW0YoZCksUi5kKGMsWmcscWUsSihbV2csdGQuZChHKGQpLG5ldyBXKG51bGwsMSw1LFgsW2JdLG51bGwpLEooW2VdLDApKV0sMCkpXSxudWxsKSx4YyhhKSk6YX0pO3AoXCJtb3JpLnppcC5pbnNlcnRfbGVmdFwiLGZ1bmN0aW9uKGEsYil7dmFyIGM9UC5jKGEsMCxudWxsKSxkPVAuYyhhLDEsbnVsbCksZD1NYyhkKT9TLmEoVGYsZCk6ZCxlPVEuYShkLFpnKTtpZihudWxsPT1kKXRocm93XCJJbnNlcnQgYXQgdG9wXCI7cmV0dXJuIE4obmV3IFcobnVsbCwyLDUsWCxbYyxSLmQoZCxaZyxwYy5hKGUsYiksSihbYmgsITBdLDApKV0sbnVsbCkseGMoYSkpfSk7XG5wKFwibW9yaS56aXAuaW5zZXJ0X3JpZ2h0XCIsZnVuY3Rpb24oYSxiKXt2YXIgYz1QLmMoYSwwLG51bGwpLGQ9UC5jKGEsMSxudWxsKSxkPU1jKGQpP1MuYShUZixkKTpkLGU9US5hKGQsV2cpO2lmKG51bGw9PWQpdGhyb3dcIkluc2VydCBhdCB0b3BcIjtyZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFtjLFIuZChkLFdnLE0oYixlKSxKKFtiaCwhMF0sMCkpXSxudWxsKSx4YyhhKSl9KTtwKFwibW9yaS56aXAucmVwbGFjZVwiLFdpKTtwKFwibW9yaS56aXAuZWRpdFwiLFhpKTtwKFwibW9yaS56aXAuaW5zZXJ0X2NoaWxkXCIsZnVuY3Rpb24oYSxiKXtyZXR1cm4gV2koYSxRaShhLE5pKGEpLE0oYixQaShhKSkpKX0pO3AoXCJtb3JpLnppcC5hcHBlbmRfY2hpbGRcIixmdW5jdGlvbihhLGIpe3JldHVybiBXaShhLFFpKGEsTmkoYSksdGQuYShQaShhKSxuZXcgVyhudWxsLDEsNSxYLFtiXSxudWxsKSkpKX0pO1xucChcIm1vcmkuemlwLm5leHRcIixmdW5jdGlvbihhKXtpZihXYi5hKGVoLGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpKXJldHVybiBhO3ZhciBiO2I9T2koYSk7Yj1yKGIpP1JpKGEpOmI7aWYocihiKSlyZXR1cm4gYjtiPVRpKGEpO2lmKHIoYikpcmV0dXJuIGI7Zm9yKDs7KWlmKHIoU2koYSkpKXtiPVRpKFNpKGEpKTtpZihyKGIpKXJldHVybiBiO2E9U2koYSl9ZWxzZSByZXR1cm4gbmV3IFcobnVsbCwyLDUsWCxbTmkoYSksZWhdLG51bGwpfSk7cChcIm1vcmkuemlwLnByZXZcIixmdW5jdGlvbihhKXt2YXIgYj1WaShhKTtpZihyKGIpKWZvcihhPWI7OylpZihiPU9pKGEpLGI9cihiKT9SaShhKTpiLHIoYikpYT1VaShiKTtlbHNlIHJldHVybiBhO2Vsc2UgcmV0dXJuIFNpKGEpfSk7cChcIm1vcmkuemlwLmlzX2VuZFwiLGZ1bmN0aW9uKGEpe3JldHVybiBXYi5hKGVoLGEuYj9hLmIoMSk6YS5jYWxsKG51bGwsMSkpfSk7XG5wKFwibW9yaS56aXAucmVtb3ZlXCIsZnVuY3Rpb24oYSl7UC5jKGEsMCxudWxsKTt2YXIgYj1QLmMoYSwxLG51bGwpLGI9TWMoYik/Uy5hKFRmLGIpOmIsYz1RLmEoYixaZyksZD1RLmEoYixVZyksZT1RLmEoYixhaCksZj1RLmEoYixXZyk7aWYobnVsbD09Yil0aHJvd1wiUmVtb3ZlIGF0IHRvcFwiO2lmKDA8TyhjKSlmb3IoYT1OKG5ldyBXKG51bGwsMiw1LFgsW3ljKGMpLFIuZChiLFpnLHpjKGMpLEooW2JoLCEwXSwwKSldLG51bGwpLHhjKGEpKTs7KWlmKGI9T2koYSksYj1yKGIpP1JpKGEpOmIscihiKSlhPVVpKGIpO2Vsc2UgcmV0dXJuIGE7ZWxzZSByZXR1cm4gTihuZXcgVyhudWxsLDIsNSxYLFtRaShhLHljKGUpLGYpLHIoZCk/Ui5jKGQsYmgsITApOmRdLG51bGwpLHhjKGEpKX0pOztyZXR1cm4gdGhpcy5tb3JpO30uY2FsbCh7fSk7fSk7XG4iLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgYFNlcXVlbmNlcmAgYWR2YW5jZXMgaXRzIHVuZGVybHlpbmcgc2VxdWVuY2Ugb24gYGFkdmFuY2UoKWAsIGFuZCBwcm92aWRlcyB0aGF0IHZhbHVlIG9uIGB2YWx1ZSgpYC4gVGhlIG9ubHlcbiAgICogZ3VhcmFudGVlIGEgc2VxdWVuY2VyIHByb3ZpZGVzIGlzIHRoYXQgYHZhbHVlKClgIGlzIGFsd2F5cyBub24tZGVjcmVhc2luZyBvdmVyIHRpbWUgKGkuZS4sIGFmdGVyIG11bHRpcGxlIGNhbGxzXG4gICAqIHRvIGBhZHZhbmNlKClgLCBhIHNlcXVlbmNlciB3aWxsIG5ldmVyIGJlIHNtYWxsZXIgdGhhbiB0aGUgcHJldmlvdXMgY2FsbCAtIGJ1dCBpdCBtYXkgYWxzbyBub3QgYmUgYmlnZ2VyKS5cbiAgICpcbiAgICovXG4gIHZhciBVbml0U2VxdWVuY2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoVW5pdFNlcXVlbmNlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzICAgICAgICAgICA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX3NlcXVlbmNlID0gb3B0cy5nZXRPckVsc2UoXCJpbml0aWFsU2VxdWVuY2VcIiwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEFkdmFuY2VzIGl0cyBzZXF1ZW5jZSBieSBgYnlgLCBvciBieSBgMWAgaWYgYGJ5YCBpcyBub3QgcHJvdmlkZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYnkge251bWJlcn0gdGhlIGFtb3VudCB0byBhZHZhbmNlIGJ5LiBEZWZhdWx0cyB0byBgMWAuXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dW5kZWZpbmVkPn1cbiAgICAgKi9cbiAgICBhZHZhbmNlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihieSkge1xuICAgICAgLy8gV2FoaCB3YWhoIC0gZG9uJ3QgdXNlIGBieSB8fCAxYCwgb3IgeW91IGNhbid0IGFkdmFuY2UgYnkgMCwgd2hpY2ggaXMgc2lsbHlcbiAgICAgIC8vIGJ1dCBwb3RlbnRpYWxseSBuZWNlc3NhcnkuXG4gICAgICBieSAgICAgICAgICAgICA9IF8uaXNVbmRlZmluZWQoYnkpID8gMSA6IGJ5O1xuXG4gICAgICBpZiAoYnkgPCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaXRTZXF1ZW5jZXIjYWR2YW5jZSgpIHJlcXVpcmVzIHBvc2l0aXZlIGBieWAgb2Zmc2V0XCIpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zZXF1ZW5jZSA9IHRoaXMuX3NlcXVlbmNlICsgYnk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHNlcXVlbmNlLiBUaGlzIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgdGhlIHNhbWVcbiAgICAgKiBvciBncmVhdGVyIHRoYW4gYSB2YWx1ZSByZXR1cm5lZCBwcmV2aW91c2x5IChpbiB0aW1lKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBjdXJyZW50IHNlcXVlbmNlXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFVuaXRTZXF1ZW5jZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL29wdGlvbnNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIFNlZSBgVW5pdFNlcXVlbmNlcmAgZm9yIGEgaGlnaC1sZXZlbCBleHBsYW5hdGlvbiBvZiBTZXF1ZW5jZXIgc2VtYW50aWNzLlxuICAgKlxuICAgKiBBIFNlcXVlbmNlciB3aGljaCBhZHZhbmNlcyBieSByZWFkaW5nIGZyb20gYSBDbG9jay5cbiAgICogTm90ZSB0aGF0IHRoaXMgQ2xvY2tTZXF1ZW5jZXIgcmVsaWVzIG9uIHRoZSBDbG9jayBwcm90b2NvbCwgd2hpY2hcbiAgICogb25seSBwcm92aWRlcyBgQ2xvY2sjZ2V0VGltZSgpYC4gSXQgZG9lcyBub3QgbW9kaWZ5IHRoZSBjbG9jayBpdHNlbGYuXG4gICAqIFRoaXMgbWVhbnMgaWYgeW91J3JlIHVzaW5nIGEgTG9naWNhbENsb2NrLCBpdCdzIHN0aWxsIHVwIHRvIHRoZSBjbG9jaydzXG4gICAqIG93bmVyIHRvIGFkdmFuY2UgdGhlIGNsb2NrIGZvciB0aGUgc2VxdWVuY2VyIHRvIGFkdmFuY2UuXG4gICAqL1xuICB2YXIgQ2xvY2tTZXF1ZW5jZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIF8uZXh0ZW5kKENsb2NrU2VxdWVuY2VyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX2Nsb2NrICAgID0gb3B0cy5nZXRPckVycm9yKFwiY2xvY2tcIik7XG4gICAgICB0aGlzLl9zZXF1ZW5jZSA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFNlcXVlbmNlXCIsIDApO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBZHZhbmNlcyBieSBzZXR0aW5nIGl0cyBzZXF1ZW5jZSB0byB0aGUgYmFja2luZyBjbG9jaydzIHRpbWUuXG4gICAgICogTm90ZSB0aGF0IGlmIHRoaXMgbWV0aG9kIGlzIGNhbGxlZCB0d2ljZSB3aXRoaW4gdGhlIHNhbWUgdGltZSB1bml0LFxuICAgICAqIHRoZSBzZXF1ZW5jZSB3aWxsIG5vdCBhY3R1YWxseSBhZHZhbmNlLCBzaW5jZSB1bmlxdWUgdGltZSBpcyBub3RcbiAgICAgKiBndWFyYW50ZWVkIGJ5IG91ciBjbG9ja3MuXG4gICAgICpcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTw+fVxuICAgICAqL1xuICAgIGFkdmFuY2U6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb2NrLmdldFRpbWUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24odCkge1xuICAgICAgICAgIHRoaXMuX3NlcXVlbmNlID0gdDtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHNlcXVlbmNlLiBUaGlzIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgdGhlIHNhbWVcbiAgICAgKiBvciBncmVhdGVyIHRoYW4gYSB2YWx1ZSByZXR1cm5lZCBwcmV2aW91c2x5IChpbiB0aW1lKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBjdXJyZW50IHNlcXVlbmNlXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlcXVlbmNlO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIENsb2NrU2VxdWVuY2VyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBTZWUgYFVuaXRTZXF1ZW5jZXJgIGZvciBhIGhpZ2gtbGV2ZWwgZXhwbGFuYXRpb24gb2YgU2VxdWVuY2VyIHNlbWFudGljcy5cbiAgICpcbiAgICogQSBVbml0U2VxdWVuY2VyIHdoaWNoIHJlcG9ydHMgaXRzIHNlcXVlbmNlIHN1bW1lZCB3aXRoIHRoZSBzZXF1ZW5jZXNcbiAgICogb2YgaXRzIGludGVybmFsIGNvbGxlY3Rpb24gb2Ygc2VxdWVuY2Vycy5cbiAgICpcbiAgICogVGhpcyBkZXZpY2UgaXMgdXNlZnVsIGZvciB0cmFja2luZyB0aGUgc3RhdGUgb2YgZGF0YSBjb21wcmlzZWQgZnJvbSBtdWx0aXBsZVxuICAgKiBzb3VyY2VzLiBGb3IgaW5zdGFuY2UsIHlvdSBtaWdodCBoYXZlIENhY2hpbmdEYXRhU3RvcmUoQSkgc3RvcmluZyBkYXRhXG4gICAqIGZyb20gU291cmNlKEEpLCB0cmFja2VkIGJ5IFNlcXVlbmNlcihBKSwgYW5kIENhY2hpbmdEYXRhU3RvcmUoQikgc3RvcmluZ1xuICAgKiBkYXRhIGZyb20gU291cmNlKEIpLCB0cmFja2VkIGJ5IFNlcXVlbmNlcihCKS4gTWVhbndoaWxlLCB5b3UgbWF5IGhhdmVcbiAgICogQ2FjaGluZ0RhdGFTdG9yZShDKSwgc3RvcmluZyBkYXRhIGZyb20gU291cmNlKEEgKyBCKSwgYW5kIHRyYWNrZWQgYnlcbiAgICogU2VxdWVuY2VyKEMpID0gU2VxdWVuY2VyKEEgKyBCKSAtIGEgRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlci5cbiAgICpcbiAgICogVGh1cywgaWYgU2VxdWVuY2VyKEEpIGlzIGFkdmFuY2VkLCBpdCBtYXkgaW52YWxpZGF0ZSBDYWNoaW5nRGF0YVN0b3JlKEEpIG9yXG4gICAqIENhY2hpbmdEYXRhU3RvcmUoQykgb3IgYm90aC5cbiAgICpcbiAgICogTm90ZSB0aGlzIHBhcnRpY3VsYXIgdXNhZ2UgaXMgZ2VuZXJhbGx5IG9ubHkgdXNlZnVsIGZvciBVbml0IHNlcXVlbmNlcnMuXG4gICAqXG4gICAqIElmIHlvdSdkIGxpa2UgdGhlIGFib3ZlIGZ1bmN0aW9uYWxpdHksIGJ1dCB3aXRoIFNlcXVlbmNlcihBKSBhbmRcbiAgICogU2VxdWVuY2VyKEIpIGFzIENsb2NrU2VxdWVuY2VycywgYW5kIFNlcXVlbmNlcihDKSBtZXJlbHkgdHJhY2tpbmdcbiAgICogbW9kaWZpY2F0aW9uLCB5b3UnZCBuZWVkIHRvIHVzZSBhIERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyIGZvciBBIGFuZCBCLFxuICAgKiBmb3J3YXJkaW5nIHRoZW0gdG8gVW5pdFNlcXVlbmNlcihDKS5cbiAgICpcbiAgICogRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlciBhbmQgRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIgYXJlIGVmZmVjdGl2bHlcbiAgICogb3Bwb3NpdGVzIG9mIGVhY2ggb3RoZXIuIERlbGVnYXRpbmdDb21wb3NpdGVTZXF1ZW5jZXIgY29tcG9zZXMgdGhlIGB2YWx1ZWBcbiAgICogb2YgbXVsdGlwbGUgdW5kZXJseWluZyBzZXF1ZW5jZXJzIChwdWxsKSwgYW5kIERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyXG4gICAqIGZvcndhcmRzIHRoZSBgYWR2YW5jZWAgY2FsbCB0byBtdWx0aXBsZSB0YXJnZXRzIChwdXNoKS5cbiAgICovXG4gIHZhciBEZWxlZ2F0aW5nQ29tcG9zaXRlU2VxdWVuY2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlci5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fZGVsZWdhdGVTZXF1ZW5jZXIgPSBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKTtcbiAgICAgIHRoaXMuX3NlcXVlbmNlcnMgPSBfLmNsb25lKG9wdHMuZ2V0T3JFbHNlKFwic2VxdWVuY2Vyc1wiLCBbXSkpO1xuICAgIH0sXG4gICAgYWRkU2VxdWVuY2VyOiBmdW5jdGlvbihzZXEpIHtcbiAgICAgIHRoaXMuX3NlcXVlbmNlcnMucHVzaChzZXEpO1xuICAgIH0sXG4gICAgYWR2YW5jZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcyA9IHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyO1xuICAgICAgcmV0dXJuIHMuYWR2YW5jZS5hcHBseShzLCBhcmd1bWVudHMpO1xuICAgIH0sXG4gICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIF9cbiAgICAgICAgLmNoYWluKHRoaXMuX3NlcXVlbmNlcnMpXG4gICAgICAgIC5pbnZva2UoXCJ2YWx1ZVwiKVxuICAgICAgICAucmVkdWNlKGZ1bmN0aW9uKHN1bSwgbikge1xuICAgICAgICAgIHJldHVybiBzdW0gKyBuO1xuICAgICAgICB9LCAwKVxuICAgICAgICAudmFsdWUoKSArIHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyLnZhbHVlKCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gRGVsZWdhdGluZ0NvbXBvc2l0ZVNlcXVlbmNlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcblxuICAvKipcbiAgICogU2VlIGBVbml0U2VxdWVuY2VyYCBmb3IgYSBoaWdoLWxldmVsIGV4cGxhbmF0aW9uIG9mIFNlcXVlbmNlciBzZW1hbnRpY3MuXG4gICAqXG4gICAqIEEgU2VxdWVuY2VyIHdoaWNoIGRlbGVnYXRlcyB0byBhbm90aGVyIHNlcXVlbmNlciBmb3IgYm90aCBgYWR2YW5jZWAgYW5kIGB2YWx1ZWAsIGFuZCBhbHNvIGZvcndhcmRzIGBhZHZhbmNlYCB0b1xuICAgKiBvdGhlciBgdGFyZ2V0YCBzZXF1ZW5jZXJzLiBJdCBpcyB0aGUgbG9naWNhbCBjb21wbGVtZW50IG9mIGEgYERlbGVnYXRpbmdDb21wb3NpdGVTZXF1ZW5jZXJgLCB3aGljaCBkZXJpdmVzIGl0cyBgdmFsdWVgIGZyb21cbiAgICogaXRzIHVuZGVybHlpbmcgYHNlcXVlbmNlcnNgLlxuICAgKlxuICAgKlxuICAgKi9cbiAgdmFyIERlbGVnYXRpbmdGb3J3YXJkaW5nU2VxdWVuY2VyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRGVsZWdhdGluZ0ZvcndhcmRpbmdTZXF1ZW5jZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyID0gb3B0cy5nZXRPckVycm9yKFwiZGVsZWdhdGVcIik7XG4gICAgICB0aGlzLl9mb3J3YXJkVGFyZ2V0cyA9IF8uY2xvbmUob3B0cy5nZXRPckVsc2UoXCJ0YXJnZXRzXCIsIFtdKSk7XG4gICAgfSxcbiAgICBhZGRUYXJnZXQ6IGZ1bmN0aW9uKHNlcSkge1xuICAgICAgdGhpcy5fZm9yd2FyZFRhcmdldHMucHVzaChzZXEpO1xuICAgIH0sXG4gICAgYWR2YW5jZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcyA9IHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyO1xuICAgICAgcmV0dXJuIHMuYWR2YW5jZS5hcHBseShzLCBhcmd1bWVudHMpXG4gICAgICAuYmluZCh0aGlzKVxuICAgICAgLnRoZW4oZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlXG4gICAgICAgICAgLmFsbChfLmludm9rZSh0aGlzLl9mb3J3YXJkVGFyZ2V0cywgXCJhZHZhbmNlXCIpKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSB2YWx1ZSByZXR1cm5lZCBieSB0aGUgZGVsZWdhdGUgc2VxdWVuY2VyJ3NcbiAgICAgICAgICAgIC8vIGFkdmFuY2UgY2FsbCAoaWYgYW55KS4gVGhlIGFkdmFuY2VtZW50IG9mIHRoZSBmb3J3YXJkXG4gICAgICAgICAgICAvLyB0YXJnZXRzIHNob3VsZCBiZSB0cmFuc3BhcmVudC5cbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcyA9IHRoaXMuX2RlbGVnYXRlU2VxdWVuY2VyO1xuICAgICAgcmV0dXJuIHMudmFsdWUuYXBwbHkocywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWxlZ2F0aW5nRm9yd2FyZGluZ1NlcXVlbmNlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zXG4pIHtcbiAgLyoqXG4gICAqIEEgQ2xvY2sgd2hpY2ggYWxsb3dzIG1hbnVhbGx5IG1hbmlwdWxhdGluZyB0aGUgdW5kZXJseWluZyB0aW1lIHZhbHVlLFxuICAgKiBpcnJlc3BlY3RpdmUgb2YgcmVhbCB0aW1lLiBVc2VmdWwgZm9yIHRlc3RpbmcuXG4gICAqL1xuICB2YXIgTG9naWNhbENsb2NrID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTG9naWNhbENsb2NrLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jdXJyZW50VGltZSA9IG9wdHMuZ2V0T3JFbHNlKFwiaW5pdGlhbFRpbWVcIiwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBhc3luY1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPG51bWJlcj59IFRpbWUgaW4gbWlsbGlzZWNvbmRzIHNpbmNlIGVwb2NoXG4gICAgICogQHNlZSBDbG9jayNnZXRUaW1lKClcbiAgICAgKi9cbiAgICBnZXRUaW1lOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50VGltZTtcbiAgICB9KSxcblxuICAgIC8qKlxuICAgICAqIEFkdmFuY2VzIGludGVybmFsIHRpbWUsIGVpdGhlciBgb3B0cy5ieWAgYSBjZXJ0YWluIG9mZnNldCwgb3JcbiAgICAgKiBgb3B0cy50b2AgYSBwYXJ0aWN1bGFyIGFic29sdXRlIHRpbWUuIElmIHN1Y2Nlc3NmdWwsIHJldHVybnMgdGhlIHJlc3VsdFxuICAgICAqIG9mIGNhbGxpbmcgYExvZ2ljYWxDbG9jayNnZXRUaW1lKClgIGFzIGEgY29udmVuaWVuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0cy50byB7bnVtYmVyfSBhYnNvbHV0ZSB0aW1lIHRvIHNldCBjbG9jayB0by4gTXVzdCBiZSBsYXJnZXJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICB0aGFuIHRoZSBjdXJyZW50IHRpbWVcbiAgICAgKiBAcGFyYW0gb3B0cy5ieSB7bnVtYmVyfSBvZmZzZXQgdG8gYWRkIHRvIGN1cnJlbnQgdGltZS4gTXVzdCBiZSBwb3NpdGl2ZS5cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICBEZWZhdWx0cyB0byBgMWAgaWYgbmVpdGhlciBgb3B0cy50b2Agb3IgYG9wdHMuYnlgXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgYXJlIHNwZWNpZmllZC5cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxudW1iZXI+fSByZXN1bHQgb2YgYExvZ2ljYWxDbG9jayNnZXRUaW1lKClgXG4gICAgICovXG4gICAgYWR2YW5jZVRpbWU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKG9wdHMpe1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcbiAgICAgIHZhciBieSA9IG9wdHMuZ2V0T3JFbHNlKFwiYnlcIiwgMSksXG4gICAgICAgICAgdG8gPSBvcHRzLmdldE9yRWxzZShcInRvXCIsIHVuZGVmaW5lZCk7XG4gICAgICBpZiAoIV8uaXNVbmRlZmluZWQodG8pKSB7XG4gICAgICAgIGlmICh0byA8IHRoaXMuX2N1cnJlbnRUaW1lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTG9naWNhbENsb2NrI2FkdmFuY2VUaW1lKCkgcmVxdWlyZXMgZm9yd2FyZCBtb3ZlbWVudCBvZiB0aW1lXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgPSB0bztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChieSA8IDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJMb2dpY2FsQ2xvY2sjYWR2YW5jZVRpbWUoKSByZXF1aXJlcyBmb3J3YXJkIG1vdmVtZW50IG9mIHRpbWVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudFRpbWUgPSB0aGlzLl9jdXJyZW50VGltZSArIGJ5O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuZ2V0VGltZSgpO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBMb2dpY2FsQ2xvY2s7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlXG4pIHtcblxuICAvKipcbiAgICogQSBDbG9jayB3aGljaCBkZWxlZ2F0ZXMgdG8gdGhlIHN5c3RlbSBjbG9jay5cbiAgICovXG4gIHZhciBTeXN0ZW1DbG9jayA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN5c3RlbUNsb2NrLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge30sXG4gICAgLyoqXG4gICAgICogQGFzeW5jXG4gICAgICogQHJldHVybnMge1Byb21pc2U8bnVtYmVyPn0gVGltZSBpbiBtaWxsaXNlY29uZHMgc2luY2UgZXBvY2hcbiAgICAgKiBAc2VlIENsb2NrI2dldFRpbWUoKVxuICAgICAqL1xuICAgIGdldFRpbWU6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGUubm93KCk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIFN5c3RlbUNsb2NrO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgX1xuKSB7XG5cbiAgLyoqXG4gICAqIEdpdmVuIGEgcmF3IGNvbmZpZywgZW5zdXJlcyBibG9icyBjYW4gYmUgZmV0Y2hlZCByZWdhcmRsZXNzIG9mXG4gICAqIHNjb3BlIHVuaW9uIHNjb3BlIChpLmUuLCBkb2VzIHVuaW9uIGNhbm9uaWNhbGl6YXRpb24pLlxuICAgKlxuICAgKiBGb3IgZXhhbXBsZSwgYSBjb25maWcgd2l0aCBzY29wZSB1bmlvbiBgXCJiYmIrYWFhXCJgIGNhbiBsYXRlciBiZVxuICAgKiBmZXRjaGVkIHVzaW5nIGVpdGhlciBgXCJhYWErYmJiXCJgIG9yIGBcImJiYithYWFcImAuIEl0IGRvZXMgdGhpc1xuICAgKiBieSB1bmlmb3JtbHkgb3JkZXJpbmcgdGhlIHVuaW9uJ3MgY29tcG9zaXRlIHNjb3Blcy5cbiAgICpcbiAgICogVGhpcyBwcm9iYWJseSBpc24ndCBhIHVzZWZ1bCBjbGFzcyBvbiBpdHMgb3duLiBJbnN0ZWFkLCBkZWZlciB0b1xuICAgKiBgU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyYCBvciBgQ29uZmlndXJhdGlvbk1hZ2ljYC5cbiAgICovXG4gIHZhciBTY29wZWRDb25maWd1cmF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChTY29wZWRDb25maWd1cmF0aW9uLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHJhd0NvbmZpZykge1xuICAgICAgcmF3Q29uZmlnID0gcmF3Q29uZmlnIHx8IHt9O1xuICAgICAgdGhpcy5fc2NvcGVzID0ge307XG4gICAgICAvLyBTb3J0IHRoZSBzY29wZSBzdHJpbmdzXG4gICAgICBfLmVhY2gocmF3Q29uZmlnLCBmdW5jdGlvbihjb25maWcsIHNjb3BlU3RyaW5nKSB7XG4gICAgICAgIHZhciBzY29wZSA9IHNjb3BlU3RyaW5nLnNwbGl0KFwiK1wiKS5zb3J0KCkuam9pbihcIitcIik7XG4gICAgICAgIHRoaXMuX3Njb3Blc1tzY29wZV0gPSBjb25maWc7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgYmxvYkZvclNjb3BlOiBmdW5jdGlvbihzY29wZSkge1xuICAgICAgcmV0dXJuIF8uY2xvbmUodGhpcy5fc2NvcGVzW3Njb3BlLnNwbGl0KFwiK1wiKS5zb3J0KCkuam9pbihcIitcIildIHx8IHt9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTY29wZWRDb25maWd1cmF0aW9uO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFNjb3BlZENvbmZpZ3VyYXRpb25cbikge1xuXG4gIC8qKlxuICAgKiBBIGRldmljZSBmb3IgcmVzb2x2aW5nIGEgc2V0IG9mIHJhdyBjb25maWd1cmF0aW9ucyBnaXZlbiBhIHNldCBvZlxuICAgKiBzY29wZXMuXG4gICAqXG4gICAqIFRoaXMgaXMgdXNlZnVsIGZvciBoYXZpbmcgdGhpbmdzIGxpa2UgcmVnaW9uLSBvciBzdGFnZS1zcGVjaWZpYyAoYW5kL29yIGJvdGgpXG4gICAqIGNvbmZpZ3VyYXRpb25zLlxuICAgKlxuICAgKiBHaXZlbiBzZXRzIG9mIHJhdyBjb25maWd1cmF0aW9ucyBvZiB0aGUgZm9ybTpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcInNjb3BlLTFcIiA6IHtcbiAgICogICAgICAgXCJrZXkxXCIgOiBcInZhbDFcIlxuICAgKiAgICAgfSxcbiAgICogICAgIFwic2NvcGUtMStlbnYxXCI6IHtcbiAgICogICAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMVwiXG4gICAqICAgICB9LFxuICAgKiAgICAgXCJzY29wZS0xK2VudjJcIjoge1xuICAgKiAgICAgICBcImtleTJcIiA6IFwidmFsLWVudi0yXCJcbiAgICogICAgIH1cbiAgICogICB9XG4gICAqXG4gICAqIGByZXNvbHZlKFtcInNjb3BlLTFcIl0pYCB3aWxsIHJldHVybjpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcImtleTFcIiA6IFwidmFsMlwiXG4gICAqICAgfVxuICAgKlxuICAgKiBgcmVzb2x2ZShbXCJzY29wZS0xXCIsIFwiZW52LTFcIl0pYCB3aWxsIHJldHVybjpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcImtleTFcIiA6IFwidmFsMVwiLFxuICAgKiAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMVwiXG4gICAqICAgfVxuICAgKlxuICAgKiBgcmVzb2x2ZShbXCJzY29wZS0xXCIsIFwiZW52LTJcIl0pYCB3aWxsIHJldHVybjpcbiAgICpcbiAgICogICB7XG4gICAqICAgICBcImtleTFcIiA6IFwidmFsMVwiLFxuICAgKiAgICAgXCJrZXkyXCIgOiBcInZhbC1lbnYtMlwiXG4gICAqICAgfVxuICAgKlxuICAgKiBTY29wZXMgdW5pb25zIGFyZSByZXNvbHZlZCBpbiB0aGUgZm9sbG93aW5nIG1hbm5lcjpcbiAgICogICAxLiBhIGdpdmVuIHNjb3BlIHVuaW9uJ3MgcGFydHMgYXJlIHNvcnRlZFxuICAgKiAgIDIuIHNjb3BlIHVuaW9ucyBhcyBhIHdob2xlIGFyZSBhcHBsaWVkIGluIHNvcnRlZCBvcmRlclxuICAgKiAgIDMuIHJlcGVhdCB0aGUgcHJvY2VzcyBmb3IgYSBnaXZlbiBjb25maWd1cmF0aW9uXG4gICAqXG4gICAqIFNvLCBnaXZlbiB0aHJlZSBjb25maWdzOlxuICAgKlxuICAgKiAge1xuICAgKiAgICBcImFhYVwiOiAuLi4gLy8gMVxuICAgKiAgICBcImNjY1wiOiAuLi4gLy8gMlxuICAgKiAgfVxuICAgKlxuICAgKiAge1xuICAgKiAgICBcImFhYStjY2NcIjogLi4uIC8vIDNcbiAgICogICAgXCJjY2NcIiAgICA6IC4uLiAvLyA0XG4gICAqICB9XG4gICAqXG4gICAqICB7XG4gICAqICAgIFwiYWFhK2JiYlwiOiAuLi4gLy8gNVxuICAgKiAgICBcImJiYlwiICAgIDogLi4uIC8vIDZcbiAgICogIH1cbiAgICpcbiAgICogVGhlIHJlc3VsdGluZyBvcmRlciB3aWxsIGJlOlxuICAgKiAgIDEsIDIsIDQsIDMsIDYsIDVcbiAgICpcbiAgICogTm90aWNlIDMgY29tZXMgYmVmb3JlIDUgZXZlbiB0aG91Z2ggaXQncyBsb2dpY2FsbHkgXCJhZnRlclwiIGluIHNvcnRlZCBvcmRlcixcbiAgICogYmVjYXVzZSBjb25maWd1cmF0aW9uIG9yZGVyIG92ZXJyaWRlcyBzY29wZSBvcmRlci4gVGhhdCBpcywgc2NvcGUgdW5pb25zXG4gICAqIGFyZSBvcmRlcmVkIHdpdGhpbiBhIGNvbmZpZywgYW5kIHRoZW4gaW4gY29uZmlnIG9yZGVyLlxuICAgKlxuICAgKi9cbiAgdmFyIFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgXy5leHRlbmQoU2NvcGVkQ29uZmlndXJhdGlvblJlc29sdmVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fY29uZmlncyA9IFtdO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBBIHJhd0NvbmZpZyBpcyBhIHNldCBvZiBjb25maWd1cmF0aW9uIHNjb3BlcyBhbmQgdGhlaXIgY29uZmlndXJhdGlvblxuICAgICAqIHZhbHVlcywgZS5nLjpcbiAgICAgKlxuICAgICAqICAge1xuICAgICAqICAgICBcInNjb3BlLTFcIiA6IHtcbiAgICAgKiAgICAgICBcImtleTFcIiA6IFwidmFsMVwiXG4gICAgICogICAgIH0sXG4gICAgICogICAgIFwic2NvcGUtMStlbnYxXCI6IHtcbiAgICAgKiAgICAgICBcImtleTJcIiA6IFwidmFsLWVudi0xXCJcbiAgICAgKiAgICAgfSxcbiAgICAgKiAgICAgXCJzY29wZS0xK2VudjJcIjoge1xuICAgICAqICAgICAgIFwia2V5MlwiIDogXCJ2YWwtZW52LTJcIlxuICAgICAqICAgICB9XG4gICAgICogICB9XG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgdGhlIHBsdXMgKCspIHNpZ24gaXMgcmVzZXJ2ZWQgZm9yIHNwZWNpZnlpbmcgc2NvcGUgdW5pb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJhd0NvbmZpZyB7b2JqZWN0fSAocmVxdWlyZWQpXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB0aGlzXG4gICAgICovXG4gICAgYWRkOiBmdW5jdGlvbihyYXdDb25maWcpIHtcbiAgICAgIHRoaXMuX2NvbmZpZ3MucHVzaChuZXcgU2NvcGVkQ29uZmlndXJhdGlvbihyYXdDb25maWcpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXNvbHZlcyBhIGNvbXB1dGVkIGZpbmFsIGNvbmZpZ3VyYXRpb24gZ2l2ZW4gYSBzZXQgb2Ygc2NvcGVzIHRvIGFwcGx5LFxuICAgICAqIGFuZCBhIHNldCBvZiBjb25maWdzIGxvYWRlZCB2aWEgYFNjb3BlZENvbmZpZ3VyYXRpb25SZXNvbHZlciNhZGQoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2NvcGVzIHtBcnJheTxzdHJpbmc+fVxuICAgICAqXG4gICAgICogQHJldHVybnMge29iamVjdH0gdGhlIGNvbXB1dGVkIGNvbmZpZ3VyYXRpb25cbiAgICAgKi9cbiAgICByZXNvbHZlOiBmdW5jdGlvbihzY29wZXMpIHtcbiAgICAgIHNjb3BlcyA9IHBvd2Vyc2V0KF8uY2xvbmUoc2NvcGVzKS5zb3J0KCkpO1xuICAgICAgc2NvcGVzLnNoaWZ0KCk7IC8vIEdldCByaWQgb2YgdGhlIGVtcHR5IHNldC5cblxuICAgICAgc2NvcGVzID0gXy5jb2xsZWN0KHNjb3BlcywgZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy5qb2luKFwiK1wiKTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgcmVsZXZhbnRDb25maWdzID0gX1xuICAgICAgICAuY2hhaW4odGhpcy5fY29uZmlncylcbiAgICAgICAgLmNvbGxlY3QoZnVuY3Rpb24oYykge1xuICAgICAgICAgIHJldHVybiBfLmNvbGxlY3Qoc2NvcGVzLCBmdW5jdGlvbihzY29wZSkge1xuICAgICAgICAgICAgcmV0dXJuIGMuYmxvYkZvclNjb3BlKHNjb3BlKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9KS5mbGF0dGVuKCkudmFsdWUoKTtcblxuICAgICAgcmVsZXZhbnRDb25maWdzLnVuc2hpZnQoe30pO1xuICAgICAgcmV0dXJuIF8uZXh0ZW5kLmFwcGx5KF8sIHJlbGV2YW50Q29uZmlncyk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgcG93ZXJzZXQgPSBmdW5jdGlvbiAoYXJ5KSB7XG4gICAgICB2YXIgcHMgPSBbW11dO1xuICAgICAgZm9yICh2YXIgaT0wOyBpIDwgYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGxlbiA9IHBzLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgICAgICAgIHBzLnB1c2gocHNbal0uY29uY2F0KGFyeVtpXSkpO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBwcztcbiAgfVxuXG4gIHJldHVybiBTY29wZWRDb25maWd1cmF0aW9uUmVzb2x2ZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuL3Njb3BlZC1jb25maWd1cmF0aW9uXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFJlZixcbiAgT3B0aW9uc1xuKSB7XG5cbiAgLyoqXG4gICAqIEEgTG9nZ2VyLlxuICAgKlxuICAgKiBBbnkgYXBwZW5kZXIgcHJvdmlkZWQgdG8gYGFkZEFwcGVuZGVyYCBzaG91bGQgaGF2ZSBhIC5sb2cgbWV0aG9kIChzZWUgYENvbnNvbGVMb2dBcHBlbmRlcmApLlxuICAgKlxuICAgKi9cbiAgdmFyIExvZ2dlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKExvZ2dlci5wcm90b3R5cGUsIHtcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9uYW1lICAgICAgICAgPSBvcHRzLmdldE9yRWxzZShcIm5hbWVcIiwgXCJEZWZhdWx0XCIpO1xuICAgICAgdGhpcy5fbG9nTGV2ZWwgICAgID0gb3B0cy5nZXRPckVsc2UoXCJsb2dMZXZlbFwiLCBMb2dVdGlsLkxldmVsLkluZm8pO1xuICAgICAgdGhpcy5fcGFyZW50ICAgICAgID0gb3B0cy5nZXRPckVsc2VGbihcInJlZlBhcmVudFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIFJlZihudWxsKSB9KTtcbiAgICAgIHRoaXMuX211dGVkICAgICAgICA9IHt9O1xuICAgICAgdGhpcy5fYXBwZW5kZXJzID0gW107XG4gICAgfSxcblxuICAgIG11dGU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHRoaXMuX211dGVkW25hbWVdID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgdW5tdXRlOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICBkZWxldGUgdGhpcy5fbXV0ZWRbbmFtZV07XG4gICAgfSxcblxuICAgIHRyYWNlOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLlRyYWNlLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGRlYnVnOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLkRlYnVnLCBfLnRvQXJyYXkoYXJndW1lbnRzKSk7XG4gICAgfSxcblxuICAgIGluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuSW5mbywgXy50b0FycmF5KGFyZ3VtZW50cykpO1xuICAgIH0sXG5cbiAgICB3YXJuOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2xvZyhMb2dVdGlsLkxldmVsLldhcm4sIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgZXJyb3I6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuRXJyb3IsIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgZmF0YWw6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fbG9nKExvZ1V0aWwuTGV2ZWwuRmF0YWwsIF8udG9BcnJheShhcmd1bWVudHMpKTtcbiAgICB9LFxuXG4gICAgaXNUcmFjZUVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5UcmFjZSk7XG4gICAgfSxcblxuICAgIGlzRGVidWdFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuRGVidWcpO1xuICAgIH0sXG5cbiAgICBpc0luZm9FbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuSW5mbyk7XG4gICAgfSxcblxuICAgIGlzV2FybkVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5XYXJuKTtcbiAgICB9LFxuXG4gICAgaXNFcnJvckVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNMb2dMZXZlbEVuYWJsZWQoTG9nVXRpbC5MZXZlbC5FcnJvcik7XG4gICAgfSxcblxuICAgIGlzRmF0YWxFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKExvZ1V0aWwuTGV2ZWwuRmF0YWwpO1xuICAgIH0sXG5cbiAgICBpc0xvZ0xldmVsRW5hYmxlZDogZnVuY3Rpb24obG9nTGV2ZWwpIHtcbiAgICAgIHZhciBjb2VyY2VkTG9nTGV2ZWwgPSBiKGxvZ0xldmVsKTtcbiAgICAgIHJldHVybiAodGhpcy5fbG9nTGV2ZWwgJiBjb2VyY2VkTG9nTGV2ZWwpID09PSBjb2VyY2VkTG9nTGV2ZWw7XG4gICAgfSxcblxuICAgIGFkZEFwcGVuZGVyOiBmdW5jdGlvbihhcHBlbmRlcikge1xuICAgICAgdGhpcy5fYXBwZW5kZXJzLnB1c2goYXBwZW5kZXIpO1xuICAgIH0sXG5cbiAgICBzZXRMb2dMZXZlbDogZnVuY3Rpb24obG9nTGV2ZWwpIHtcbiAgICAgIC8vIFNhdmUgYSBjb3B5IGZvciB0aGUgcG90ZW50aWFsIGVycm9yIG1lc3NhZ2VcbiAgICAgIHZhciBvcmlnaW5hbExvZ0xldmVsID0gbG9nTGV2ZWw7XG5cbiAgICAgIC8vIElmIG5hbWUgaXMgc3BlY2lmaWVkLCBlLmcuLCBcIkluZm9cIiwgY29udmVydCB0b1xuICAgICAgLy8gaW50XG4gICAgICBpZiAoXy5pc1N0cmluZyhsb2dMZXZlbCkpIHtcbiAgICAgICAgbG9nTGV2ZWwgPSBMb2dVdGlsLkxldmVsW2xvZ0xldmVsXVxuICAgICAgfVxuXG4gICAgICB2YXIgZXhpc3RzID0gXy5kZXRlY3QoTG9nVXRpbC5MZXZlbCwgZnVuY3Rpb24obGV2ZWwsIG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGxldmVsID09PSBsb2dMZXZlbDtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGxvZ0xldmVsOiBcIiArIG9yaWdpbmFsTG9nTGV2ZWwpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgIH0sXG5cblxuICAgIF9sb2c6IGZ1bmN0aW9uKGxvZ0xldmVsLCBsb2dBcmdzKSB7XG4gICAgICB0aGlzLl9sb2dXaXRoTWV0YWRhdGEoW10sIGxvZ0xldmVsLCBsb2dBcmdzKTtcbiAgICB9LFxuXG4gICAgX2lzTXV0ZWQ6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuX211dGVkW25hbWVdO1xuICAgIH0sXG5cbiAgICBfbG9nV2l0aE1ldGFkYXRhOiBmdW5jdGlvbihkZXNjZW5kYW50cywgbG9nTGV2ZWwsIGFyZ3MpIHtcbiAgICAgIHZhciBsZWFmID0gZGVzY2VuZGFudHNbZGVzY2VuZGFudHMubGVuZ3RoIC0gMV0gfHwgdGhpcy5fbmFtZTtcbiAgICAgIGlmICh0aGlzLmlzTG9nTGV2ZWxFbmFibGVkKGxvZ0xldmVsKSAmJiAhdGhpcy5faXNNdXRlZChsZWFmKSkge1xuICAgICAgICBfLmVhY2godGhpcy5fYXBwZW5kZXJzLCBmdW5jdGlvbihhcHBlbmRlcikge1xuICAgICAgICAgIGFwcGVuZGVyLmxvZyh0aGlzLl9uYW1lLCBkZXNjZW5kYW50cywgbG9nTGV2ZWwsIExvZ1V0aWwuX0xhYmVsW2xvZ0xldmVsXSwgYXJncyk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fcGFyZW50LmdldCgpKSB7XG4gICAgICAgIHRoaXMuX3BhcmVudC5nZXQoKS5fbG9nV2l0aE1ldGFkYXRhKFt0aGlzLl9uYW1lXS5jb25jYXQoZGVzY2VuZGFudHMpLCBsb2dMZXZlbCwgYXJncyk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICB2YXIgTG9nVXRpbCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIC8vIENvZXJjZSAoanVzdCB1c2UgcmlnaHRtb3N0IDggYml0cykhOyBiZWNhdXNlIEpTIGlzIGR1bWIsIGFuZCBldmVyeXRoaW5nIGlzXG4gIC8vIGFjdHVhbGx5IGEgZmxvYXQgd2l0aCA1My1iaXQgcHJlY2lzaW9uXG4gIHZhciBiID0gZnVuY3Rpb24odikge1xuICAgIHJldHVybiAweEZGICYgdjtcbiAgfTtcblxuICBfLmV4dGVuZChMb2dVdGlsLCB7XG4gICAgTGV2ZWw6IHtcbiAgICAgIFRyYWNlOiBiKHBhcnNlSW50KFwiMTExMTExXCIsIDIpKSxcbiAgICAgIERlYnVnOiBiKHBhcnNlSW50KFwiMDExMTExXCIsIDIpKSxcbiAgICAgIEluZm86ICBiKHBhcnNlSW50KFwiMDAxMTExXCIsIDIpKSxcbiAgICAgIFdhcm46ICBiKHBhcnNlSW50KFwiMDAwMTExXCIsIDIpKSxcbiAgICAgIEVycm9yOiBiKHBhcnNlSW50KFwiMDAwMDExXCIsIDIpKSxcbiAgICAgIEZhdGFsOiBiKHBhcnNlSW50KFwiMDAwMDAxXCIsIDIpKVxuICAgIH1cbiAgfSk7XG5cbiAgXy5leHRlbmQoTG9nVXRpbC5wcm90b3R5cGUsIHtcbiAgICBMZXZlbDogTG9nVXRpbC5MZXZlbCxcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX3Jvb3RMb2dnZXIgPSBSZWYobmV3IExvZ2dlcih7XG4gICAgICAgIG5hbWU6IFwiUm9vdFwiXG4gICAgICB9KSk7XG4gICAgfSxcblxuICAgIGNyZWF0ZTogZnVuY3Rpb24obmFtZSwgb3B0cykge1xuICAgICAgb3B0cyA9IF8uY2xvbmUob3B0cyB8fCB7fSk7XG5cbiAgICAgIHZhciBwYXJlbnQ7XG4gICAgICBpZiAob3B0cy5wYXJlbnQpIHtcbiAgICAgICAgcGFyZW50ID0gUmVmKG9wdHMucGFyZW50KTtcbiAgICAgICAgZGVsZXRlKG9wdHMucGFyZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmVudCA9IFJlZi5kZWxlZ2F0aW5nKHRoaXMuX3Jvb3RMb2dnZXIpO1xuICAgICAgfVxuXG4gICAgICBvcHRzLnJlZlBhcmVudCA9IHBhcmVudDtcblxuICAgICAgb3B0cy5uYW1lID0gbmFtZTtcblxuICAgICAgcmV0dXJuIG5ldyBMb2dnZXIob3B0cyk7XG4gICAgfSxcblxuICAgIHJvb3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Jvb3RMb2dnZXIuZ2V0KCk7XG4gICAgfSxcblxuICAgIHJlc2V0Um9vdExvZ2dlcjogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9yb290TG9nZ2VyLnNldChuZXcgTG9nZ2VyKHtcbiAgICAgICAgbmFtZTogXCJSb290XCJcbiAgICAgIH0pKTtcbiAgICB9XG4gIH0pO1xuXG5cbiAgTG9nVXRpbC5fTGFiZWwgPSBfLnJlZHVjZShMb2dVdGlsLkxldmVsLCBmdW5jdGlvbihtZW1vLCB2YWwsIGtleSkge1xuICAgIG1lbW9bdmFsXSA9IGtleTtcbiAgICByZXR1cm4gbWVtbztcbiAgfSwge30pO1xuXG4gIHJldHVybiBuZXcgTG9nVXRpbCgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vcmVmXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBNLFxuICBVVUlELFxuICBPcHRpb25zLFxuICBTdGF0ZUd1YXJkXG4pIHtcblxuICAvKipcbiAgICogQSBjaGFubmVsIGlzIGEgcGF0aCB0aHJvdWdoIHdoaWNoIG1lc3NhZ2VzIGZsb3cuXG4gICAqXG4gICAqIENoYW5uZWxzIGFyZSBtZWFudCB0byBoYXZlIGEgc2luZ2xlIHB1Ymxpc2hlciwgbXVsdGlwbGUgc3Vic2NyaWJlcnMuXG4gICAqXG4gICAqIFRoaXMgaXMgXCJlbmZvcmNlZFwiIHVzaW5nIGEgc2VudGluZWwuIFRoZSBzYW1lIHNlbnRpbmVsIHByb3ZpZGVkIGR1cmluZ1xuICAgKiBpbnN0YW50aWF0aW9uIG11c3QgYmUgdXNlZCB3aGVuIGNhbGxpbmcgYHB1Ymxpc2hgLCBlbHNlIGFuIGV4Y2VwdGlvblxuICAgKiBpcyByYWlzZWQuXG4gICAqXG4gICAqL1xuICB2YXIgQ2hhbm5lbCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENoYW5uZWwucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5fc2VudGluZWwgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcInNlbnRpbmVsXCIpO1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZCAgICA9IG5ldyBTdGF0ZUd1YXJkKFtcImRpc3Bvc2VkXCJdKTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBNLmhhc2hfbWFwKCk7XG4gICAgfSxcblxuICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIE0uZWFjaCh0aGlzLl9zdWJzY3JpcHRpb25zLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uaGFzaF9tYXAoKTtcbiAgICB9LFxuXG4gICAgcHVibGlzaDogZnVuY3Rpb24oc2VudGluZWwsIG1zZykge1xuICAgICAgcmV0dXJuIHRoaXMuX3B1Ymxpc2guYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG5cbiAgICBzdWJzY3JpYmU6IGZ1bmN0aW9uKGhhbmRsZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuXG4gICAgaXNEaXNwb3NlZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIik7XG4gICAgfSxcblxuXG4gICAgX3B1Ymxpc2g6IGZ1bmN0aW9uKHNlbnRpbmVsLCBtc2cpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBpZiAodGhpcy5fc2VudGluZWwgIT09IHNlbnRpbmVsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgc2VudGluZWwgcHJvdmlkZWQ7IHB1Ymxpc2hlciBtdXN0IGhhdmUgc2FtZSBzZW50aW5lbCBwcm92aWRlZCBkdXJpbmcgaW5zdGFudGlhdGlvbi5cIik7XG4gICAgICB9XG4gICAgICB0aGlzLl9kaXNwYXRjaChtc2cpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcblxuXG4gICAgX3N1YnNjcmliZTogZnVuY3Rpb24oaGFuZGxlcikge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIHZhciBzdWIgPSBuZXcgU3Vic2NyaXB0aW9uKHRoaXMsIGhhbmRsZXIpLFxuICAgICAgICAgIGlkICA9IHN1Yi5pZCgpO1xuXG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gTS5hc3NvYyh0aGlzLl9zdWJzY3JpcHRpb25zLCBpZCwgc3ViKTtcblxuICAgICAgcmV0dXJuIHN1YjtcbiAgICB9LFxuXG5cbiAgICBfZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBHbmFybHksIGFzIHRoaXMgaG9wcyBiYWNrIGFuZCBmb3J0aCBiZXR3ZWVuIHRoZSBjaGFubmVsIGFuZCB0aGUgc3ViLCBidXRcbiAgICAgIC8vIGVhc2llciB0aGFuIHNwbGl0dGluZyB0aGUgZGlzcG9zZSBsb2dpYyBpbnRvIHR3byBtZXRob2RzIGluIHRoZSBzdWIuXG4gICAgICBNLmVhY2godGhpcy5fc3Vic2NyaXB0aW9ucywgZnVuY3Rpb24ocGFpcikge1xuICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwb3NlKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG5cblxuICAgIF9kaXNwYXRjaDogZnVuY3Rpb24obXNnKSB7XG4gICAgICBNLmVhY2godGhpcy5fc3Vic2NyaXB0aW9ucywgZnVuY3Rpb24ocGFpcikge1xuICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwYXRjaChtc2cpO1xuICAgICAgfSk7XG4gICAgfSxcblxuXG4gICAgX2Rpc3Bvc2VIYW5kbGU6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gTS5kaXNzb2ModGhpcy5fc3Vic2NyaXB0aW9ucywgaWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKFN1YnNjcmlwdGlvbi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihjaGFubmVsLCBoYW5kbGVyKSB7XG4gICAgICB0aGlzLl9pZCAgICAgICAgID0gVVVJRC52NCgpO1xuICAgICAgdGhpcy5fY2hhbm5lbCAgICA9IGNoYW5uZWw7XG4gICAgICB0aGlzLl9oYW5kbGVyICAgID0gaGFuZGxlcjtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG5cbiAgICAgIF8uYmluZEFsbCh0aGlzLCBcImRpc3Bvc2VcIik7XG4gICAgfSxcblxuXG4gICAgZGlzcG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9jaGFubmVsLl9kaXNwb3NlSGFuZGxlKHRoaXMuX2lkKTtcblxuICAgICAgdGhpcy5faGFuZGxlciA9IG51bGw7XG4gICAgICB0aGlzLl9jaGFubmVsID0gbnVsbDtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG5cblxuICAgIGlkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pZDtcbiAgICB9LFxuXG5cbiAgICBkaXNwYXRjaDogZnVuY3Rpb24obXNnKSB7XG4gICAgICBpZiAodGhpcy5fc3RhdGVHdWFyZC5hcHBsaWVkKFwiZGlzcG9zZWRcIikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9oYW5kbGVyKG1zZyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ2hhbm5lbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL3N0YXRlLWd1YXJkXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE0sXG4gIE9wdGlvbnMsXG4gIENoYW5uZWxcbikge1xuXG4gIC8vIEZJWE1FOiBEZWxldGUgdGhpcyBpbiBmYXZvciBvZiBDb21wb3NpdGVDaGFubmVsXG4gIHZhciBDaGFpbmVkQ2hhbm5lbCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKENoYWluZWRDaGFubmVsLnByb3RvdHlwZSwgQ2hhbm5lbC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBDaGFubmVsLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICBfLmJpbmRBbGwodGhpcywgXCJfZm9yd2FyZFwiKTtcbiAgICAgIHRoaXMuX2NoYWluZWRTdWJzID0gTS52ZWN0b3IoKTtcblxuICAgICAgdmFyIGluaXRpYWxseUNoYWluZWRUbyA9IG9wdHMuZ2V0T3JFbHNlKFwiY2hhaW5Ub1wiKTtcbiAgICAgIGlmIChpbml0aWFsbHlDaGFpbmVkVG8pIHtcbiAgICAgICAgdGhpcy5jaGFpblRvKGluaXRpYWxseUNoYWluZWRUbyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNoYWluVG86IGZ1bmN0aW9uKG90aGVyQ2hhbm5lbCkge1xuICAgICAgdGhpcy5fY2hhaW5lZFN1YnMgPSBNLmNvbmoodGhpcy5fY2hhaW5lZFN1YnMsIG90aGVyQ2hhbm5lbC5zdWJzY3JpYmUodGhpcy5fZm9yd2FyZCkpO1xuICAgIH0sXG5cbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzdWJzID0gdGhpcy5fY2hhaW5lZFN1YnM7XG5cbiAgICAgIHRoaXMuX2NoYWluZWRTdWJzID0gTS52ZWN0b3IoKTtcblxuICAgICAgTS5lYWNoKHN1YnMsIGZ1bmN0aW9uKHN1Yikge1xuICAgICAgICBzdWIuZGlzcG9zZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIF9mb3J3YXJkOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgIHRoaXMuX3B1Ymxpc2godGhpcy5fc2VudGluZWwsIG1zZyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ2hhaW5lZENoYW5uZWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vY2hhbm5lbFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBNLFxuICBPcHRpb25zLFxuICBDaGFubmVsXG4pIHtcblxuICAvKipcbiAgICogQSBjaGFubmVsIHdoaWNoIGxpc3RlbnMgdG8gb3RoZXIgY2hhbm5lbHMsIGFuZCBmb3J3YXJkcyB0aGVpciBtZXNzYWdlcyBhcyB0aHJvdWdoIHB1Ymxpc2hlZCB0byB0aGlzIGNoYW5uZWxcbiAgICpcbiAgICovXG4gIHZhciBDb21wb3NpdGVDaGFubmVsID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQ29tcG9zaXRlQ2hhbm5lbC5wcm90b3R5cGUsIENoYW5uZWwucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgQ2hhbm5lbC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgdmFyIGxpc3RlbiA9IG9wdHMuZ2V0T3JFbHNlKFwibGlzdGVuXCIsIFtdKTtcbiAgICAgIGlmICghXy5pc0FycmF5KGxpc3RlbikpIHtcbiAgICAgICAgbGlzdGVuID0gW2xpc3Rlbl07XG4gICAgICB9XG5cbiAgICAgIF8uZWFjaChsaXN0ZW4sIF8uYmluZChmdW5jdGlvbihjKSB7XG4gICAgICAgIHRoaXMubGlzdGVuKGMpO1xuICAgICAgfSwgdGhpcykpO1xuICAgIH0sXG5cblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgQ2hhbm5lbC5wcm90b3R5cGUuZGlzcG9zZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgdmFyIGZvcndhcmRpbmcgPSB0aGlzLl9mb3J3YXJkaW5nO1xuICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uaGFzaF9tYXAoKTtcblxuICAgICAgTS5lYWNoKGZvcndhcmRpbmcsIF8uYmluZChmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIE0ubnRoKHBhaXIsIDEpLmRpc3Bvc2UoKTtcbiAgICAgIH0sIHRoaXMpKTtcbiAgICB9LFxuXG5cbiAgICBsaXN0ZW46IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICAgIHZhciBzdWIgPSBjaGFubmVsLnN1YnNjcmliZShfLmJpbmQoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHRoaXMuX2ZvcndhcmQobXNnKVxuICAgICAgfSwgdGhpcykpO1xuICAgICAgdGhpcy5fZm9yd2FyZGluZyA9IE0uYXNzb2ModGhpcy5fZm9yd2FyZGluZywgY2hhbm5lbCwgc3ViKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGlzcG9zZTogXy5iaW5kKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX2ZvcndhcmRpbmcgPSBNLmRpc3NvYyh0aGlzLl9mb3J3YXJkaW5nLCBjaGFubmVsKTtcbiAgICAgICAgICBzdWIuZGlzcG9zZSgpO1xuICAgICAgICB9LCB0aGlzKVxuICAgICAgfTtcbiAgICB9LFxuXG5cbiAgICBfZm9yd2FyZDogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLnB1Ymxpc2godGhpcy5fc2VudGluZWwsIG1zZyk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29tcG9zaXRlQ2hhbm5lbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIm1vcmlcIiksXG4gIHJlcXVpcmUoXCIuLi9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9jaGFubmVsXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFVVSUQsXG4gIFN0YXRlR3VhcmQsXG4gIExvZ2dlclxuKSB7XG5cbiAgLyoqXG4gICAqIEEgZmliZXIgZGljdGF0ZXMgaG93IGFuIEV4Y2hhbmdlJ3MgbWVzc2FnZXMgYXJlIGFjdHVhbGx5IHNlbnQuIFdoZW4gc29tZW9uZSByZXF1ZXN0cyBhIG1haWxib3ggZnJvbSBhbiBFeGNoYW5nZSxcbiAgICogdGhhdCBleGNoYW5nZSByZWdpc3RlcnMgaXRzZWxmIGFzIGFuIGVudGl0eSB3aXRoIHRoYXQgYWRkcmVzcyBvbiB0aGUgbWFpbGJveCdzIGJlaGFsZi4gV2hlbiBhIG1lc3NhZ2UgZm9yIHRoYXRcbiAgICogYWRkcmVzcyBpcyByZWNlaXZlZCBieSB0aGUgZmliZXIsIGl0IHJvdXRlcyBpdCB0byB0aGUgZXhjaGFuZ2UsIHdoaWNoIGZvcndhcmRzIGl0IHRvIHRoZSBtYWlsYm94LCBhbmQgb253YXJkLlxuICAgKlxuICAgKiBUaGVyZSdzIGEgcGljdHVyZSBpbiBgQ291cmllcmAgdGhhdCBpbGx1c3RyYXRlcyB0aGUgY29tcG9uZW50IGxheW91dC5cbiAgICpcbiAgICogQW4gYEluTWVtb3J5RmliZXJgIG9ubHkgaGFzIGxvY2FsIGVudGl0aWVzLCBhbmQgb25seSBwZXJmb3JtcyBsb2NhbCBkaXNwYXRjaC4gQSBgTGlua2FibGVGaWJlcmAgaXMgYW5cbiAgICogYEluTWVtb3J5RmliZXJgIHdoaWNoIHdpbGwgZm9yd2FyZCBtZXNzYWdlcyB0byBpdHMgbGlua2VkIGZpYmVycyBpbiB0aGUgZXZlbnQgYSBsb2NhbCBlbnRpdHkgaGFzbid0IGJlZW5cbiAgICogcmVnaXN0ZXJlZCB3aXRoIHRoZSBhZGRyZXNzIGZvciB3aGljaCBhIG1lc3NhZ2UgaXMgYm91bmQuXG4gICAqL1xuICB2YXIgSW5NZW1vcnlGaWJlciA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgS2xhc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG5cbiAgICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkluTWVtb3J5TG9nZ2VyXCIpO1xuXG4gICAgXy5leHRlbmQoS2xhc3MucHJvdG90eXBlLCB7XG4gICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgICAgdGhpcy5fZW50aXRpZXMgPSBNLmhhc2hfbWFwKCk7XG4gICAgICAgIHRoaXMuX2lkZW50aXR5ID0gb3B0cy5nZXRPckVsc2UoXCJpZGVudGl0eVwiLCBVVUlELnY0KCkpO1xuXG4gICAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG5cbiAgICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX3JlY2VpdmVcIik7XG4gICAgICB9LFxuXG5cbiAgICAgIGlkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkZW50aXR5O1xuICAgICAgfSxcblxuXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2UoKTtcbiAgICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgICAgfSxcblxuICAgICAgX2Rpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIHZhciBlbnRpdGllcyA9IHRoaXMuX2VudGl0aWVzO1xuICAgICAgICBNLmVhY2goZW50aXRpZXMsIGZ1bmN0aW9uKHBhaXIpIHtcbiAgICAgICAgICBNLm50aChwYWlyLCAxKS5kaXNwb3NlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2VudGl0aWVzID0gbnVsbDtcbiAgICAgIH0sXG5cbiAgICAgIHJlZ2lzdGVyRW50aXR5OiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgICAgdmFyIGlkZW50aXR5ID0gb3B0cy5nZXRPckVycm9yKFwiaWRlbnRpdHlcIiksXG4gICAgICAgICAgICBlbnRpdHkgICA9IG5ldyBMb2NhbEVudGl0eSh7XG4gICAgICAgICAgICAgIGlkZW50aXR5OiBpZGVudGl0eSxcbiAgICAgICAgICAgICAgZGVsZWdhdGU6IG9wdHMuZ2V0T3JFcnJvcihcImRlbGVnYXRlXCIpXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9lbnRpdGllcyA9IE0uYXNzb2ModGhpcy5fZW50aXRpZXMsIGlkZW50aXR5LCBlbnRpdHkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0sXG5cbiAgICAgIC8qKlxuICAgICAgICogUmV0dXJucyBhIHByb21pc2Ugd2hpY2ggaXMgZnVsZmlsbGVkIHdoZW4gdGhlIG1lc3NhZ2UgaXNcbiAgICAgICAqIHNlbnQsIG5vdCByZWNlaXZlZCBieSB0aGUgcmVtb3RlIGVuZC4gVGhpcyB0byBsZXQgdGhlXG4gICAgICAgKiBjYWxsZXIga25vdyB3aGV0aGVyIG9yIG5vdCB0aGUgbWVzc2FnZSBpcyBzdHVja1xuICAgICAgICogaW4gYSBidWZmZXIgc29tZXdoZXJlIHdoZW4gY2FsY3VsYXRpbmcgaXRzIHRpbWVvdXRzLlxuICAgICAgICovXG4gICAgICBzZW5kOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihvcHRzKSB7XG4gICAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICAgIHZhciBmcm9tICAgPSBvcHRzLmdldE9yRXJyb3IoXCJmcm9tXCIpLFxuICAgICAgICAgICAgdG8gICAgID0gb3B0cy5nZXRPckVycm9yKFwidG9cIiksXG4gICAgICAgICAgICBib2R5ICAgPSBvcHRzLmdldE9yRXJyb3IoXCJib2R5XCIpLFxuICAgICAgICAgICAgbXNnSWQgID0gb3B0cy5nZXRPckVycm9yKFwibXNnSWRcIiksXG5cbiAgICAgICAgICAgIG1UICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwibVRcIiksXG4gICAgICAgICAgICByTXNnSWQgPSBvcHRzLmdldE9yRWxzZShcInJNc2dJZFwiKTtcblxuXG4gICAgICAgIC8vWFhYOiBUaGlzIGlzIGluLW1lbW9yeSwgc28gaXQncyBhcyBzaW1wbGVcbiAgICAgICAgLy8gYXMgaW52b2tpbmcgX3JlY2VpdmUgaW4gYSBmdXR1cmUgY2FsbCBzdGFja1xuICAgICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfLmRlZmVyKHRoaXMuX3JlY2VpdmUsIHtcbiAgICAgICAgICAgICAgZnJvbTogICBmcm9tLFxuICAgICAgICAgICAgICB0bzogICAgIHRvLFxuICAgICAgICAgICAgICBib2R5OiAgIGJvZHksXG4gICAgICAgICAgICAgIG1zZ0lkOiAgbXNnSWQsXG4gICAgICAgICAgICAgIG1UOiAgICAgbVQsXG4gICAgICAgICAgICAgIHJNc2dJZDogck1zZ0lkLFxuICAgICAgICAgICAgICBvRmliOiAgIHRoaXMuX2lkZW50aXR5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG1zZ0lkO1xuICAgICAgICAgIH0pO1xuICAgICAgfSksXG5cbiAgICAgIF9yZWNlaXZlOiBmdW5jdGlvbihlbnYpIHtcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZW52ID0gT3B0aW9ucy5mcm9tT2JqZWN0KGVudik7XG4gICAgICAgIHZhciB0bywgZnJvbSwgYm9keSwgbXNnSWQsIG9yaWdpbkZpYmVyLCBtVCwgck1zZ0lkO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdG8gICAgICAgICAgPSBlbnYuZ2V0T3JFcnJvcihcInRvXCIpO1xuICAgICAgICAgIGZyb20gICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJmcm9tXCIpO1xuICAgICAgICAgIGJvZHkgICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJib2R5XCIpO1xuICAgICAgICAgIG1zZ0lkICAgICAgID0gZW52LmdldE9yRXJyb3IoXCJtc2dJZFwiKTtcblxuICAgICAgICAgIC8vIEZ1dHVyZS1wcm9vZmluZyBmb3IgbXVsdGktZmliZXIgZmFicmljLlxuICAgICAgICAgIG9yaWdpbkZpYmVyID0gZW52LmdldE9yRXJyb3IoXCJvRmliXCIpO1xuXG4gICAgICAgICAgbVQgICAgID0gZW52LmdldE9yRWxzZShcIm1UXCIpO1xuICAgICAgICAgIHJNc2dJZCA9IGVudi5nZXRPckVsc2UoXCJyTXNnSWRcIik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBMb2cuZXJyb3IoXCJSZWNlaXZlZCBtYWxmb3JtZWQgbWVzc2FnZVwiLCBlbnYpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGVudGl0eSA9IE0uZ2V0KHRoaXMuX2VudGl0aWVzLCB0byk7XG5cbiAgICAgICAgaWYgKGVudGl0eSkge1xuICAgICAgICAgIGVudGl0eS5kaXNwYXRjaCh7XG4gICAgICAgICAgICB0bzogICAgIHRvLFxuICAgICAgICAgICAgZnJvbTogICBmcm9tLFxuICAgICAgICAgICAgYm9keTogICBib2R5LFxuICAgICAgICAgICAgbXNnSWQ6ICBtc2dJZCxcbiAgICAgICAgICAgIHJNc2dJZDogck1zZ0lkLFxuICAgICAgICAgICAgb0ZpYjogICBvcmlnaW5GaWJlcixcbiAgICAgICAgICAgIGhGaWI6ICAgdGhpcy5faWRlbnRpdHksXG4gICAgICAgICAgICBtVDogbVRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIEtsYXNzO1xuICB9KSgpO1xuXG5cblxuICB2YXIgTG9jYWxFbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChMb2NhbEVudGl0eS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB0aGlzLl9pZGVudGl0eSA9IG9wdHMuZ2V0T3JFcnJvcihcImlkZW50aXR5XCIpO1xuICAgICAgdGhpcy5fZGVsZWdhdGUgPSBvcHRzLmdldE9yRXJyb3IoXCJkZWxlZ2F0ZVwiKTtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQgPSBuZXcgU3RhdGVHdWFyZChbXCJkaXNwb3NlZFwiXSk7XG4gICAgfSxcbiAgICBkaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9zdGF0ZUd1YXJkLmFwcGxpZWQoXCJkaXNwb3NlZFwiKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcblxuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5hcHBseShcImRpc3Bvc2VkXCIpO1xuICAgIH0sXG4gICAgZGlzcGF0Y2g6IGZ1bmN0aW9uKGVudikge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIHRoaXMuX2RlbGVnYXRlLnJlY2VpdmVGaWJlck1lc3NhZ2UoZW52KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBJbk1lbW9yeUZpYmVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9zdGF0ZS1ndWFyZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUHJvbWlzZSxcbiAgTSxcbiAgT3B0aW9ucyxcbiAgSW5NZW1vcnlGaWJlcixcbiAgQ2hhbm5lbCxcbiAgQ29tcG9zaXRlQ2hhbm5lbFxuKSB7XG5cbiAgLyoqXG4gICAqIExpbmthYmxlRmliZXIgaXMgYSByZWZlcmVuY2UgaW1wbGVtZW50YXRpb24gZm9yIGltcGxlbWVudGluZyBhIG11bHRpLWZpYmVyIFwiZmFicmljXCIuIFdoZXJlYXMgYW4gYEluTWVtb3J5RmliZXJgXG4gICAqIG9ubHkgaGFzIGxvY2FsIGVudGl0aWVzLCBhbmQgb25seSBwZXJmb3JtcyBsb2NhbCBkaXNwYXRjaCwgYSBgTGlua2FibGVGaWJlcmAgaXMgYW4gYEluTWVtb3J5RmliZXJgIHdoaWNoIHdpbGxcbiAgICogZm9yd2FyZCBtZXNzYWdlcyB0byBpdHMgbGlua2VkIGZpYmVycyBpbiB0aGUgZXZlbnQgYSBsb2NhbCBlbnRpdHkgaGFzbid0IGJlZW4gcmVnaXN0ZXJlZCB3aXRoIHRoZSBhZGRyZXNzIGZvclxuICAgKiB3aGljaCBhIG1lc3NhZ2UgaXMgYm91bmQuXG4gICAqXG4gICAqIEZvciBhbiBleGFtcGxlIG9mIGhvdyB0aGlzIG1pZ2h0IHdvcmsgaW4gYSBtdWx0aS1wcm9jZXNzIG9yIG11bHRpLW1hY2hpbmUgZW52aXJvbm1lbnQsIHNlZSB0aGVcbiAgICogYHRoaWNrZXQtem1xLWZpYmVyYCBub2RlIG1vZHVsZS5cbiAgICovXG4gIHZhciBMaW5rYWJsZUZpYmVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTGlua2FibGVGaWJlci5wcm90b3R5cGUsIEluTWVtb3J5RmliZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgSW5NZW1vcnlGaWJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuXG4gICAgICB0aGlzLl9sb2NhbERpc3BhdGNoICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbCA9IG5ldyBDb21wb3NpdGVDaGFubmVsKHtcbiAgICAgICAgc2VudGluZWw6IHRoaXMsXG4gICAgICAgIGxpc3RlbjogICB0aGlzLl9sb2NhbERpc3BhdGNoXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fZWdyZXNzQ2hhbm5lbCAgPSBuZXcgQ2hhbm5lbCh7IHNlbnRpbmVsOiB0aGlzIH0pO1xuXG4gICAgICAvLyBfcmVjZWl2ZSBpcyBkZWZpbmVkIGFuZCBib3VuZCBpbiBJbk1lbW9yeUZpYmVyIChcInByb3RlY3RlZFwiIG1ldGhvZClcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsLnN1YnNjcmliZSh0aGlzLl9yZWNlaXZlKTtcbiAgICB9LFxuXG5cbiAgICBsaXN0ZW46IGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsLmxpc3RlbihjaGFubmVsKTtcbiAgICB9LFxuXG5cbiAgICBlZ3Jlc3NDaGFubmVsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9lZ3Jlc3NDaGFubmVsO1xuICAgIH0sXG5cblxuICAgIF9kaXNwb3NlOiBmdW5jdGlvbigpIHtcbiAgICAgIEluTWVtb3J5RmliZXIucHJvdG90eXBlLl9kaXNwb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSxcblxuICAgIHNlbmQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuXG4gICAgICB2YXIgZnJvbSAgID0gb3B0cy5nZXRPckVycm9yKFwiZnJvbVwiKSxcbiAgICAgICAgICB0byAgICAgPSBvcHRzLmdldE9yRXJyb3IoXCJ0b1wiKSxcbiAgICAgICAgICBib2R5ICAgPSBvcHRzLmdldE9yRXJyb3IoXCJib2R5XCIpLFxuICAgICAgICAgIG1zZ0lkICA9IG9wdHMuZ2V0T3JFcnJvcihcIm1zZ0lkXCIpLFxuICAgICAgICAgIG1UICAgICA9IG9wdHMuZ2V0T3JFbHNlKFwibVRcIiksXG4gICAgICAgICAgck1zZ0lkID0gb3B0cy5nZXRPckVsc2UoXCJyTXNnSWRcIiksXG4gICAgICAgICAgY2hhbiAgID0gbnVsbDtcblxuICAgICAgdmFyIG1zZyA9IHtcbiAgICAgICAgZnJvbTogICBmcm9tLFxuICAgICAgICB0bzogICAgIHRvLFxuICAgICAgICBib2R5OiAgIGJvZHksXG4gICAgICAgIG1zZ0lkOiAgbXNnSWQsXG4gICAgICAgIG1UOiAgICAgbVQsXG4gICAgICAgIHJNc2dJZDogck1zZ0lkLFxuICAgICAgICBvRmliOiAgIHRoaXMuX2lkZW50aXR5XG4gICAgICB9O1xuXG4gICAgICAvLyBMb2NhbCBkaXNwYXRjaCwgc2tpcCB0aGUgcm91bmQtdHJpcFxuICAgICAgaWYgKE0uZ2V0KHRoaXMuX2VudGl0aWVzLCB0bykpIHtcbiAgICAgICAgY2hhbiA9IHRoaXMuX2xvY2FsRGlzcGF0Y2g7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGFuID0gdGhpcy5fZWdyZXNzQ2hhbm5lbDtcbiAgICAgIH1cblxuICAgICAgXy5kZWZlcihfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGNoYW4ucHVibGlzaCh0aGlzLCBtc2cpO1xuICAgICAgfSwgdGhpcykpO1xuXG4gICAgICByZXR1cm4gbXNnSWQ7XG4gICAgfSlcblxuXG4gIH0pO1xuXG4gIHJldHVybiBMaW5rYWJsZUZpYmVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi9pbi1tZW1vcnktZmliZXJcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2NoYW5uZWwvY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jb21wb3NpdGUtY2hhbm5lbFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICogQSAnc2VyZGUnIGlzIGEgdGhpbmcgdGhhdCBjYW4gXCJzZXJcIi1pYWxpemUgYW5kIFwiZGVcIi1lcmlhbGl6ZSBhbiBvYmplY3QuIFRoaXMgb25lIGp1c3QgZG9lcyBKU09OLCBhbmQgaWdub3Jlc1xuICAgKiBhbnkgYWRkaXRpb25hbCBvcHRpb25zLlxuICAgKlxuICAgKlxuICAgKi9cbiAgdmFyIEpTT05TZXJkZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEpTT05TZXJkZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHt9LFxuXG4gICAgc2VyaWFsaXplOiBmdW5jdGlvbihwYXlsb2FkLCBvcHRzKSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocGF5bG9hZCk7XG4gICAgfSxcblxuICAgIGRlc2VyaWFsaXplOiBmdW5jdGlvbihwYXlsb2FkLCBvcHRzKSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShwYXlsb2FkKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBKU09OU2VyZGU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9ucyxcbiAgTWV0aG9kU3BlY1xuKSB7XG5cbiAgdmFyIENsaWVudFNwZWMgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDbGllbnRTcGVjLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9tZXRob2RTcGVjcyA9IF8ucmVkdWNlKG9wdHMuZ2V0T3JFbHNlKFwibWV0aG9kc1wiLCB7fSksIGZ1bmN0aW9uKG1lbW8sIHNwZWMsIG5hbWUpIHtcbiAgICAgICAgbWVtb1tuYW1lXSA9IG5ldyBNZXRob2RTcGVjKHNwZWMpO1xuICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgIH0sIHt9KTtcbiAgICAgIHRoaXMuX2luaXRPcHRpb25zID0gb3B0cy5nZXRPckVsc2UoXCJpbml0T3B0aW9uc1wiLCB7fSk7XG4gICAgfSxcblxuICAgIG1ldGhvZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX21ldGhvZFNwZWNzO1xuICAgIH0sXG5cbiAgICBpbml0T3B0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5faW5pdE9wdGlvbnM7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ2xpZW50U3BlYztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vbWV0aG9kLXNwZWNcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgT3B0aW9ucyxcbiAgQmFzZUNsaWVudFxuKSB7XG5cbiAgdmFyIENsaWVudEJ1aWxkZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChDbGllbnRCdWlsZGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9zcGVjID0gb3B0cy5nZXRPckVycm9yKFwic3BlY1wiKTtcbiAgICB9LFxuXG4gICAgYnVpbGQ6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIHZhciBjID0gbmV3IEJhc2VDbGllbnQoXy5leHRlbmQoe30sIHRoaXMuX3NwZWMuaW5pdE9wdGlvbnMoKSwgb3B0cykpO1xuICAgICAgXy5lYWNoKHRoaXMuX3NwZWMubWV0aG9kcygpLCBmdW5jdGlvbihzcGVjLCBuYW1lKSB7XG4gICAgICAgIGMuX19yZWdpc3Rlck1ldGhvZChuYW1lLCBzcGVjKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGM7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ2xpZW50QnVpbGRlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4vYmFzZS1jbGllbnRcIilcbik7XG5cbn0pKCkiLCIoZnVuY3Rpb24oKXsvKmdsb2JhbCByZXF1aXJlOiBmYWxzZSwgbW9kdWxlOiBmYWxzZSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBtb2QgPSBmdW5jdGlvbihcbiAgXyxcbiAgUmVmLFxuICBEZWxlZ2F0aW5nUmVmXG4pIHtcblxuICB2YXIgaGVscGVyID0gZnVuY3Rpb24odmFsKSB7XG4gICAgcmV0dXJuIG5ldyBSZWYodmFsKTtcbiAgfTtcblxuICBoZWxwZXIuZGVsZWdhdGluZyA9IGZ1bmN0aW9uKHJlZikge1xuICAgIHJldHVybiBuZXcgRGVsZWdhdGluZ1JlZihyZWYpO1xuICB9O1xuXG4gIHJldHVybiBoZWxwZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuL3JlZlwiKSxcbiAgcmVxdWlyZShcIi4vZGVsZWdhdGluZy1yZWZcIilcbik7XG5cbn0pKCkiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIFByb21pc2UgPSByZXF1aXJlKFwiLi9wcm9taXNlLmpzXCIpKCk7XG5tb2R1bGUuZXhwb3J0cyA9IFByb21pc2U7IiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIC8qKlxuICAgKiBBbiBhcHBlbmRlciB3aGljaCBsb2dzIHRvIHRoZSBnbG9iYWwgYGNvbnNvbGVgLlxuICAgKlxuICAgKi9cbiAgdmFyIENvbnNvbGVMb2dBcHBlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIHZhciBwID0gZnVuY3Rpb24obnVtKSB7XG4gICAgaWYgKChcIlwiICsgbnVtKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJldHVybiBcIjBcIiArIG51bTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bTtcbiAgICB9XG4gIH07XG5cbiAgXy5leHRlbmQoQ29uc29sZUxvZ0FwcGVuZGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jb25zb2xlID0gb3B0cy5nZXRPckVsc2UoXCJjb25zb2xlXCIsIGNvbnNvbGUpO1xuICAgICAgdGhpcy5fdGltZURlbGVnYXRlID0gb3B0cy5nZXRPckVsc2UoXCJ0aW1lRGVsZWdhdGVcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpO1xuICAgICAgICByZXR1cm4gW2QuZ2V0VVRDRnVsbFllYXIoKSwgcChkLmdldFVUQ01vbnRoKCkpLCBwKGQuZ2V0VVRDRGF5KCkpXS5qb2luKFwiL1wiKSArXG4gICAgICAgICAgXCIgXCIgKyBbcChkLmdldFVUQ0hvdXJzKCkpLCBwKGQuZ2V0VVRDTWludXRlcygpKSwgcChkLmdldFVUQ1NlY29uZHMoKSldLmpvaW4oXCI6XCIpICtcbiAgICAgICAgICBcIi5cIiArIGQuZ2V0VVRDTWlsbGlzZWNvbmRzKCk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgbG9nOiBmdW5jdGlvbihsb2dnZXJOYW1lLCBkZXNjZW5kYW50cywgbG9nTGV2ZWwsIGxvZ0xldmVsTmFtZSwgYXJncykge1xuICAgICAgLy8gVXNlIHRoZSBmdXJ0aGVzdCBhbmNlc3RvciBhcyB0aGUgbG9nZ2VkIG5hbWUgKHNpbmNlIGl0IG9yaWdpbmF0ZWQgdGhlcmUpXG4gICAgICB2YXIgZnVydGhlc3RBbmNlc3RvciA9IGRlc2NlbmRhbnRzW2Rlc2NlbmRhbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgaWYgKGZ1cnRoZXN0QW5jZXN0b3IpIHtcbiAgICAgICAgbG9nZ2VyTmFtZSA9IGZ1cnRoZXN0QW5jZXN0b3I7XG4gICAgICB9XG4gICAgICB0aGlzLl9sb2coW1wiW1wiK2xvZ0xldmVsTmFtZStcIl1bXCIrdGhpcy5fZ2V0VGltZSgpK1wiXVtcIitsb2dnZXJOYW1lK1wiXVwiXS5jb25jYXQoYXJncykpO1xuICAgIH0sXG5cbiAgICBfZ2V0VGltZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGltZURlbGVnYXRlKCk7XG4gICAgfSxcblxuICAgIF9sb2c6IGZ1bmN0aW9uKGxvZ0l0ZW1zKSB7XG4gICAgICAvLyBXaHkgZG9lcyBoZSBkbyB0aGlzPyBJcyBoZSBpbnNhbmU/IFdlbGwsIHllcy5cbiAgICAgIC8vXG4gICAgICAvLyBCdXQgbW9zdGx5LCBJIGRvIHRoaXMgYmVjYXVzZSBjb25zb2xlLmxvZyBpc24ndCwgaW4gYWxsIGNhc2VzLFxuICAgICAgLy8gc29tZXRoaW5nIHlvdSBjYW4gY2FsbCAuYXBwbHkgb24uIExhc3QgSSBjaGVja2VkLCBpbiBJRSBjYWxsaW5nXG4gICAgICAvLyBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBbXSkgd2lsbCB0aHJvdyBhbiBlcnJvci4gU28gdGhhdCdzIHdoeSB0aGVcbiAgICAgIC8vIGJpZyB1Z2x5IHN3aXRjaC5cbiAgICAgIC8vXG4gICAgICAvLyBJZiB5b3UgbmVlZCBtb3JlIHRoYW4gNyBpdGVtcywgd2VsbCwgSSBjYW4ndCBoZWxwIHlvdSAoYnV0IHlvdSBjYW4gLSBhZGQgYW5vdGhlclxuICAgICAgLy8gc3dpdGNoIGNhc2UpLlxuICAgICAgc3dpdGNoKGxvZ0l0ZW1zLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgdGhpcy5fY29uc29sZS5sb2coKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdLCBsb2dJdGVtc1s0XSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICB0aGlzLl9jb25zb2xlLmxvZyhsb2dJdGVtc1swXSwgbG9nSXRlbXNbMV0sIGxvZ0l0ZW1zWzJdLCBsb2dJdGVtc1szXSwgbG9nSXRlbXNbNF0sIGxvZ0l0ZW1zWzVdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxvZ0l0ZW1zWzBdLCBsb2dJdGVtc1sxXSwgbG9nSXRlbXNbMl0sIGxvZ0l0ZW1zWzNdLCBsb2dJdGVtc1s0XSwgbG9nSXRlbXNbNV0sIGxvZ0l0ZW1zWzZdKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB2YXIgbGFiZWwgPSBsb2dJdGVtcy5zaGlmdCgpO1xuICAgICAgICAgIHRoaXMuX2NvbnNvbGUubG9nKGxhYmVsLCBsb2dJdGVtcyk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gQ29uc29sZUxvZ0FwcGVuZGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vb3B0aW9uc1wiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE9wdGlvbnMsXG4gIExvZ2dlcixcbiAgQ29uZmlndXJhdGlvbk1hZ2ljLFxuICBBcHBDb250YWluZXJcbikge1xuICB2YXIgTG9nID0gTG9nZ2VyLmNyZWF0ZShcIkJvb3RzdHJhcHBlclwiKTtcblxuICB2YXIgQm9vdHN0cmFwcGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoQm9vdHN0cmFwcGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG4gICAgICB0aGlzLl9jb25maWdzID0gb3B0cy5nZXRPckVycm9yKFwiY29uZmlndXJhdGlvbnNcIik7XG4gICAgICB0aGlzLl9zY29wZXMgPSBvcHRzLmdldE9yRXJyb3IoXCJzY29wZXNcIik7XG4gICAgICB0aGlzLl9hcHBLbGFzcyA9IG9wdHMuZ2V0T3JFcnJvcihcImFwcGxpY2F0aW9uQ29uc3RydWN0b3JcIik7XG4gICAgfSxcbiAgICBib290c3RyYXA6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFByb21pc2VcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGNvbmZpZyAgICAgICA9IENvbmZpZ3VyYXRpb25NYWdpYy5yZXNvbHZlQ29uZmlnKHRoaXMuX3Njb3BlcywgdGhpcy5fY29uZmlncyksXG4gICAgICAgICAgICAgIEFwcEtsYXNzICAgICA9IHRoaXMuX2FwcEtsYXNzO1xuXG4gICAgICAgICAgTG9nLmluZm8oXCJVc2luZyByZXNvbHZlZCBjb25maWd1cmF0aW9uOiBcIiwgSlNPTi5zdHJpbmdpZnkoY29uZmlnKSk7XG5cbiAgICAgICAgICB2YXIgYXBwICAgICAgICAgID0gbmV3IEFwcEtsYXNzKHtjb25maWd1cmF0aW9uOiBjb25maWd9KSxcbiAgICAgICAgICAgICAgYXBwQ29udGFpbmVyID0gbmV3IEFwcENvbnRhaW5lcih7YXBwOiBhcHB9KTtcblxuICAgICAgICAgIHJldHVybiBhcHBDb250YWluZXI7XG4gICAgICAgIH0pO1xuICAgIH0pXG4gIH0pO1xuXG4gIHJldHVybiBCb290c3RyYXBwZXI7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvbG9nZ2luZy9sb2dnZXJcIiksXG4gIHJlcXVpcmUoXCIuL2NvbmZpZ3VyYXRpb24tbWFnaWNcIiksXG4gIHJlcXVpcmUoXCIuL3dlYi1hcHAtY29udGFpbmVyXCIpXG4pO1xuIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UsIHByb2Nlc3M6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBMb2dnZXJcbikge1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiQXBwQ29udGFpbmVyXCIpO1xuXG4gIHZhciBXZWJBcHBDb250YWluZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChXZWJBcHBDb250YWluZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKVxuICAgICAgdGhpcy5fYXBwID0gb3B0cy5nZXRPckVycm9yKFwiYXBwXCIpO1xuICAgIH0sXG5cbiAgICBzdGFydDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVxuICAgICAgICAuYmluZCh0aGlzKVxuICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwLnN0YXJ0KCk7XG4gICAgICAgIH0pO1xuICAgIH0pLFxuXG4gICAgc3RvcDogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICByZXR1cm4gdGhpcy5fYXBwLnN0b3AoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocmVhc29uKSB7XG4gICAgICAgICAgTG9nLmVycm9yKFwiU3RvcHBpbmcgZHVlIHRvIHJlYXNvbjpcIiwgcmVhc29uKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSlcbiAgfSk7XG5cbiAgcmV0dXJuIFdlYkFwcENvbnRhaW5lcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcImJsdWViaXJkXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9sb2dnaW5nL2xvZ2dlclwiKVxuKTtcblxufSkoKSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIHZhciBXZWJTY2hlZHVsZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfTtcblxuICBfLmV4dGVuZChXZWJTY2hlZHVsZXIucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7fSxcblxuICAgIHJ1blNvb246IGZ1bmN0aW9uKGZuKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlKGZuKTtcbiAgICB9LFxuXG4gICAgc2NoZWR1bGU6IGZ1bmN0aW9uKGZuLCBkZWxheSkge1xuICAgICAgZGVsYXkgPSBkZWxheSB8fCAxO1xuICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIGRlbGF5KTtcbiAgICB9LFxuXG4gICAgdW5zY2hlZHVsZTogZnVuY3Rpb24oaWQpIHtcbiAgICAgIHJldHVybiBjbGVhclRpbWVvdXQoaWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFdlYlNjaGVkdWxlcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcbiIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBPcHRpb25zLFxuICBSZWYsXG4gIFNldFRpbWVvdXRTY2hlZHVsZXJcbikge1xuXG4gIHZhciBEZWZhdWx0UnVudGltZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKERlZmF1bHRSdW50aW1lLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBPcHRpb25zLmZyb21PYmplY3Qob3B0cyk7XG5cbiAgICAgIHRoaXMuX3NjaGVkdWxlclJlZiA9IFJlZihvcHRzLmdldE9yRWxzZUZuKFwic2NoZWR1bGVyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFNldFRpbWVvdXRTY2hlZHVsZXIoKTtcbiAgICAgIH0pKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge1JlZjxTY2hlZHVsZXI+fVxuICAgICAqL1xuICAgIHNjaGVkdWxlcjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gUmVmLmRlbGVnYXRpbmcodGhpcy5fc2NoZWR1bGVyUmVmKTtcbiAgICB9LFxuXG4gICAgc2V0U2NoZWR1bGVyOiBmdW5jdGlvbihzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuX3NjaGVkdWxlclJlZi5zZXQoc2NoZWR1bGVyKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWZhdWx0UnVudGltZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uL2NvcmUvcmVmXCIpLFxuICByZXF1aXJlKFwiLi4vY29yZS9zY2hlZHVsZXIvc2V0LXRpbWVvdXQtc2NoZWR1bGVyXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIE9wdGlvbnNcbikge1xuXG4gIHZhciBTdG9yZUVudHJ5ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoU3RvcmVFbnRyeS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgLy8gUGVyZmVjdGx5IGFjY2VwdGFibGUgdG8gcGFzcyBpbiB1bmRlZmluZWQuLi5cbiAgICAgIHRoaXMuX3ZhbHVlID0gb3B0cy5nZXRPckVsc2UoXCJ2YWx1ZVwiLCB1bmRlZmluZWQpO1xuICAgICAgdGhpcy5fbGFzdFNlcXVlbmNlID0gb3B0cy5nZXRPckVycm9yKFwiaW5pdGlhbFNlcXVlbmNlXCIpO1xuXG4gICAgICB0aGlzLl90dGwgPSBvcHRzLmdldE9yRWxzZShcInR0bFwiKTtcbiAgICB9LFxuXG4gICAgaXNFeHBpcmVkOiBmdW5jdGlvbihzZXF1ZW5jZSwgZmFsbGJhY2tUdGwpIHtcbiAgICAgIHZhciB0dGwgPSB0aGlzLl90dGwgfHwgZmFsbGJhY2tUdGw7XG4gICAgICBpZiAoIXR0bCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBUVEwgc3BlY2lmaWVkIVwiKTtcbiAgICAgIH1cbiAgICAgIC8vIEUuZy4sIGxhc3RTZXF1ZW5jZSA9IDQsIHR0bCA9IDEsIHNlcXVlbmNlID0gNTogZXhwaXJlZFxuICAgICAgLy8gICAgICAgbGFzdFNlcXVlbmNlID0gNCwgdHRsID0gMSwgc2VxdWVuY2UgPSA0OiBub3QgZXhwaXJlZFxuICAgICAgLy8gICAgICAgbGFzdFNlcXVlbmNlID0gNCwgdHRsID0gMiwgc2VxdWVuY2UgPSA1OiBub3QgZXhwaXJlZFxuICAgICAgcmV0dXJuICEodGhpcy5fbGFzdFNlcXVlbmNlICsgdHRsID4gc2VxdWVuY2UpO1xuICAgIH0sXG5cbiAgICB0b3VjaDogZnVuY3Rpb24oc2VxdWVuY2UpIHtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IHNlcXVlbmNlO1xuICAgIH0sXG5cbiAgICB1cGRhdGU6IGZ1bmN0aW9uKHZhbCwgc2VxdWVuY2UsIG9wdHMpIHtcbiAgICAgIHRoaXMuX3ZhbHVlICAgICAgICA9IHZhbDtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IHNlcXVlbmNlO1xuXG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fdHRsID0gb3B0cy5nZXRPckVsc2UoXCJ0dGxcIik7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fdmFsdWUgICAgICAgID0gbnVsbDtcbiAgICAgIHRoaXMuX2xhc3RTZXF1ZW5jZSA9IG51bGw7XG4gICAgfSxcblxuICAgIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTdG9yZUVudHJ5O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIExvZ2dlcixcbiAgT3B0aW9uc1xuKSB7XG5cbiAgdmFyIFRFTl9NSU5VVEVTX0lOX01JTExJU0VDT05EUyA9IDYwICogMTAwMCAqIDEwO1xuXG4gIHZhciBMb2cgPSBMb2dnZXIuY3JlYXRlKFwiUHJvY2Vzc0tlZXBBbGl2ZVwiKTtcblxuICAvKipcbiAgICogS2VlcHMgYSAobm9kZSkgcHJvY2VzcyBcImFsaXZlXCIgYnkga2VlcGluZyBhdCBsZWFzdCBvbmUgYml0IG9mIChub29wKSB3b3JrIHNjaGVkdWxlZCBmb3IgZXhlY3V0aW9uLlxuICAgKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBQcm9jZXNzS2VlcEFsaXZlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoUHJvY2Vzc0tlZXBBbGl2ZS5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5fc2NoZWR1bGVyID0gb3B0cy5nZXRPckVycm9yKFwic2NoZWR1bGVyXCIpO1xuICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcblxuICAgICAgXy5iaW5kQWxsKHRoaXMsIFwiX2N5Y2xlXCIpO1xuICAgIH0sXG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgTG9nLmRlYnVnKFwiU3RhcnRpbmcgUHJvY2Vzc0tlZXBBbGl2ZVwiKTtcbiAgICAgIHRoaXMuX2N5Y2xlKCk7XG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgIExvZy5kZWJ1ZyhcIlN0b3BwaW5nIFByb2Nlc3NLZWVwQWxpdmVcIik7XG4gICAgICBpZiAodGhpcy5fdGltZW91dElkKSB7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlci5nZXQoKS51bnNjaGVkdWxlKHRoaXMuX3RpbWVvdXRJZCk7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG4gICAgICB9XG4gICAgfSxcbiAgICBfY3ljbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5fdGltZW91dElkID0gdGhpcy5fc2NoZWR1bGVyLmdldCgpLnNjaGVkdWxlKFxuICAgICAgICB0aGlzLl9jeWNsZSxcbiAgICAgICAgVEVOX01JTlVURVNfSU5fTUlMTElTRUNPTkRTXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFByb2Nlc3NLZWVwQWxpdmU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCIuLi8uLi9jb3JlL2xvZ2dpbmcvbG9nZ2VyXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpXG4pO1xuXG59KSgpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF8sXG4gIFByb21pc2UsXG4gIE0sXG4gIE9wdGlvbnMsXG4gIFVVSUQsXG4gIENoYWluZWRDaGFubmVsLFxuICBDaGFubmVsLFxuICBDb21wb3NpdGVDaGFubmVsLFxuICBTdGF0ZUd1YXJkXG4pIHtcblxuXG4gIHZhciBNYWlsYm94ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoTWFpbGJveC5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG4gICAgICBvcHRzID0gT3B0aW9ucy5mcm9tT2JqZWN0KG9wdHMpO1xuICAgICAgdGhpcy5faWQgICAgICAgICAgICAgICAgICAgID0gVVVJRC52NCgpO1xuICAgICAgdGhpcy5fb3duZXJJZGVudGl0eSAgICAgICAgID0gb3B0cy5nZXRPckVycm9yKFwib3duZXJJZGVudGl0eVwiKTtcbiAgICAgIHRoaXMuX2V4Y2hhbmdlICAgICAgICAgICAgICA9IG9wdHMuZ2V0T3JFcnJvcihcImV4Y2hhbmdlXCIpO1xuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwgICAgICAgID0gbmV3IENoYW5uZWwoeyBzZW50aW5lbDogdGhpcyB9KTtcbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWwgICA9IG5ldyBDaGFubmVsKHsgc2VudGluZWw6IHRoaXMgfSk7XG4gICAgICB0aGlzLl9pbmdyZXNzQ2hhbm5lbCAgICAgICAgPSBuZXcgQ29tcG9zaXRlQ2hhbm5lbCh7XG4gICAgICAgIHNlbnRpbmVsOiB0aGlzLFxuICAgICAgICBsaXN0ZW46IFt0aGlzLl9vbmVTaG90Q2hhbm5lbCwgdGhpcy5fcmVxdWVzdFJlcGx5Q2hhbm5lbF1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZCAgICAgICAgICAgID0gbmV3IFN0YXRlR3VhcmQoW1wiZGlzcG9zZWRcIl0pO1xuXG4gICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLnNldCgpO1xuICAgIH0sXG5cbiAgICBpZDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfSxcblxuICAgIG93bmVySWRlbnRpdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX293bmVySWRlbnRpdHk7XG4gICAgfSxcblxuICAgIGRpc3Bvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3N0YXRlR3VhcmQuYXBwbGllZChcImRpc3Bvc2VkXCIpKXtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9vbmVTaG90Q2hhbm5lbC5kaXNwb3NlKCk7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2luZ3Jlc3NDaGFubmVsLmRpc3Bvc2UoKTtcblxuICAgICAgLy8gQXR0ZW1wdCB0byBjYW5jZWwgYWxsIG91dHN0YW5kaW5nIHJlcXVlc3RzLlxuICAgICAgLy8gVGhpcyBpcyBhbiBhc3luYyByZXF1ZXN0LCBzbyB3ZSBqdXN0IGhhdmUgdG8gZmlyZSBhbmRcbiAgICAgIC8vIGZvcmdlIHRoZW0uXG4gICAgICAvL1xuICAgICAgLy8gSWYgeW91J3JlIGRpc3Bvc2luZyBvZiBhIG1haWxib3ggYmVmb3JlIHJlcXVlc3RzXG4gICAgICAvLyBjb21wbGV0ZSwgeW91IG1pZ2h0IGhhdmUgYSBiYWQgdGltZS4gVGhlIGdvb2RcbiAgICAgIC8vIG5ld3MgaXMgYmVjYXVzZSByZXNwb25zZXMgYXJlIGZlcnJpZWQgYmFjayBmcm9tIHRoZSBmaWJlclxuICAgICAgLy8gdG8gdGhlIG1haWxib3ggY2FsbGVyIHZpYSB0aGUgUHJvbWlzZSBpbnRlcmZhY2UgcmF0aGVyXG4gICAgICAvLyB0aGFuIGNoYW5uZWxzLCB0aGV5IHNob3VsZCBzdGlsbCBnZXQgQ2FuY2VsbGF0aW9uRXJyb3JzXG4gICAgICB2YXIgcmVxcyA9IHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcztcbiAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uc2V0KCk7XG5cbiAgICAgIE0uZWFjaChyZXFzLCBfLmJpbmQoZnVuY3Rpb24ocmVxSWQpIHtcbiAgICAgICAgdGhpcy5fZXhjaGFuZ2UuY2FuY2VsU2VuZEFuZFJlY2VpdmUocmVxSWQpO1xuICAgICAgfSwgdGhpcykpO1xuXG4gICAgICB0aGlzLl9vbmVTaG90Q2hhbm5lbCAgICAgID0gbnVsbDtcbiAgICAgIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWwgPSBudWxsO1xuICAgICAgdGhpcy5faW5ncmVzc0NoYW5uZWwgICAgICA9IG51bGw7XG5cbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuYXBwbHkoXCJkaXNwb3NlZFwiKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBDaGFpbmVkQ2hhbm5lbCBjaGFpbmVkIHRvIHRoaXMgTWFpbGJveCdzXG4gICAgICogcHJpdmF0ZWx5LW93bmVkIGluYm91bmQgQ2hhbm5lbC5cbiAgICAgKiBAcmV0dXJucyB7Q2hhaW5lZENoYW5uZWx9XG4gICAgICovXG4gICAgaW5ncmVzc0NoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2luZ3Jlc3NDaGFubmVsO1xuICAgIH0sXG5cbiAgICBvbmVTaG90Q2hhbm5lbDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5fb25lU2hvdENoYW5uZWw7XG4gICAgfSxcblxuICAgIHJlcXVlc3RSZXBseUNoYW5uZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3RSZXBseUNoYW5uZWw7XG4gICAgfSxcblxuICAgIHNlbmQ6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKGVudikge1xuICAgICAgdGhpcy5fc3RhdGVHdWFyZC5kZW55KFwiZGlzcG9zZWRcIik7XG5cbiAgICAgIGVudiA9IF8uZXh0ZW5kKHt9LCBlbnYgfHwge30sIHtcbiAgICAgICAgZnJvbTogdGhpcy5fb3duZXJJZGVudGl0eVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2Uuc2VuZChlbnYpO1xuICAgIH0pLFxuXG4gICAgcmVwbHk6IFByb21pc2UubWV0aG9kKGZ1bmN0aW9uKG1zZ0lkLCBlbnYpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICBlbnYgPSBfLmV4dGVuZCh7fSwgZW52IHx8IHt9LCB7XG4gICAgICAgIHJNc2dJZDogbXNnSWQsXG4gICAgICAgIGZyb206IHRoaXMuX293bmVySWRlbnRpdHlcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2UucmVwbHkoZW52KTtcbiAgICB9KSxcblxuICAgIHNlbmRBbmRSZWNlaXZlOiBQcm9taXNlLm1ldGhvZChmdW5jdGlvbihlbnYsIG9wdHMpIHtcbiAgICAgIHRoaXMuX3N0YXRlR3VhcmQuZGVueShcImRpc3Bvc2VkXCIpO1xuXG4gICAgICB2YXIgcmVxSWQgPSAob3B0cyB8fCB7fSkucmVxSWQgfHwgVVVJRC52NCgpO1xuXG4gICAgICBlbnYgPSBfLmV4dGVuZCh7fSwgZW52IHx8IHt9LCB7XG4gICAgICAgIGZyb206IHRoaXMuX293bmVySWRlbnRpdHlcbiAgICAgIH0pO1xuXG4gICAgICBvcHRzID0gXy5leHRlbmQoe30sIG9wdHMgfHwge30sIHtcbiAgICAgICAgcmVxSWQ6IHJlcUlkXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzID0gTS5jb25qKHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcywgcmVxSWQpO1xuXG4gICAgICByZXR1cm4gdGhpcy5fZXhjaGFuZ2VcbiAgICAgICAgLnNlbmRBbmRSZWNlaXZlKGVudiwgb3B0cylcbiAgICAgICAgLmJpbmQodGhpcylcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcCkge1xuICAgICAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uZGlzaih0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMsIHJlcUlkKTtcbiAgICAgICAgICByZXR1cm4gcmVzcDtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdWdodChQcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9KVxuICAgICAgICAuY2F1Z2h0KFByb21pc2UuVGltZW91dEVycm9yLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICB0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMgPSBNLmRpc2oodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzLCByZXFJZCk7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9KTtcbiAgICB9KSxcblxuXG4gICAgb3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE0uY291bnQodGhpcy5fb3V0c3RhbmRpbmdSZXF1ZXN0SWRzKTtcbiAgICB9LFxuXG5cbiAgICBjYW5jZWxTZW5kQW5kUmVjZWl2ZTogUHJvbWlzZS5tZXRob2QoZnVuY3Rpb24ocmVxSWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9leGNoYW5nZVxuICAgICAgICAuY2FuY2VsU2VuZEFuZFJlY2VpdmUocmVxSWQpXG4gICAgICAgIC5iaW5kKHRoaXMpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuX291dHN0YW5kaW5nUmVxdWVzdElkcyA9IE0uZGlzaih0aGlzLl9vdXRzdGFuZGluZ1JlcXVlc3RJZHMsIHJlcUlkKTtcbiAgICAgICAgfSk7XG4gICAgfSksXG5cbiAgICBfcmVjZWl2ZU9uZVNob3Q6IGZ1bmN0aW9uKG1zZykge1xuICAgICAgdGhpcy5fb25lU2hvdENoYW5uZWwucHVibGlzaCh0aGlzLCBtc2cpO1xuICAgIH0sXG5cbiAgICBfcmVjZWl2ZVJlcXVlc3RSZXBseTogZnVuY3Rpb24obXNnKSB7XG4gICAgICB0aGlzLl9yZXF1ZXN0UmVwbHlDaGFubmVsLnB1Ymxpc2godGhpcywgbXNnKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBNYWlsYm94O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpLFxuICByZXF1aXJlKFwiYmx1ZWJpcmRcIiksXG4gIHJlcXVpcmUoXCJtb3JpXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9vcHRpb25zXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS91dWlkXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NoYWluZWQtY2hhbm5lbFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvY2hhbm5lbC9jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9jaGFubmVsL2NvbXBvc2l0ZS1jaGFubmVsXCIpLFxuICByZXF1aXJlKFwiLi4vLi4vY29yZS9zdGF0ZS1ndWFyZFwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfLFxuICBQcm9taXNlLFxuICBPcHRpb25zLFxuICBMYW5nLFxuICBVVUlELFxuICBDb3VyaWVyXG4pIHtcblxuICB2YXIgQmFzZUNsaWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9O1xuXG4gIF8uZXh0ZW5kKEJhc2VDbGllbnQucHJvdG90eXBlLCB7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuICAgICAgb3B0cyA9IE9wdGlvbnMuZnJvbU9iamVjdChvcHRzKTtcblxuICAgICAgdGhpcy5fZXhjaGFuZ2UgPSBvcHRzLmdldE9yRXJyb3IoXCJleGNoYW5nZVwiKTtcbiAgICAgIHRoaXMuX2lkZW50aXR5ID0gb3B0cy5nZXRPckVsc2VGbihcImlkZW50aXR5XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gVVVJRC52NCgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLl9zZXJ2aWNlSWRlbnRpdHkgPSBvcHRzLmdldE9yRXJyb3IoXCJzZXJ2aWNlSWRlbnRpdHlcIik7XG4gICAgICB0aGlzLl9tYWlsYm94ICAgICAgICAgPSB0aGlzLl9leGNoYW5nZS5tYWlsYm94KHRoaXMuX2lkZW50aXR5KTtcbiAgICAgIHRoaXMuX2NvdXJpZXIgICAgICAgICA9IG5ldyBDb3VyaWVyKHtcbiAgICAgICAgZGVsZWdhdGU6IHRoaXMsXG4gICAgICAgIG1haWxib3g6IHRoaXMuX21haWxib3hcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfX3JlZ2lzdGVyTWV0aG9kOiBmdW5jdGlvbihuYW1lLCBtZXRob2RTcGVjKSB7XG4gICAgICB2YXIgYXJncyAgICAgICAgICA9IG1ldGhvZFNwZWMuYXJncygpLFxuICAgICAgICAgIGRlZmF1bHRzICAgICAgPSBtZXRob2RTcGVjLmRlZmF1bHRzKCksXG4gICAgICAgICAgbVR5cGUgICAgICAgICA9IG1ldGhvZFNwZWMubVR5cGUoKSB8fCBuYW1lLFxuICAgICAgICAgIGNvdXJpZXJNZXRob2QgPSBtZXRob2RTcGVjLnJlcXVlc3RSZXBseSgpID8gXCJzZW5kQW5kUmVjZWl2ZVwiIDogXCJzZW5kXCI7XG5cbiAgICAgIHZhciBnZXRBcmdzID0gXy5iaW5kKGZ1bmN0aW9uKGRlZmF1bHRzLCBtZXRob2RBcmdzKSB7XG4gICAgICAgIHZhciBmaW5hbEFyZ3MgPSB7fSwgYXJnTmFtZSwgYXJnVmFsO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBhcmdOYW1lID0gYXJnc1tpXTtcbiAgICAgICAgICBhcmdWYWwgPSBtZXRob2RBcmdzW2ldO1xuICAgICAgICAgIGlmICh0eXBlb2YgYXJnVmFsID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBpZiAoZGVmYXVsdHMuaGFzT3duUHJvcGVydHkoYXJnTmFtZSkpIHtcbiAgICAgICAgICAgICAgZmluYWxBcmdzW2FyZ05hbWVdID0gZGVmYXVsdHNbYXJnTmFtZV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IuQXJndW1lbnRNaXNzaW5nRXJyb3IoXCJhcmd1bWVudCBtaXNzaW5nOiBcIiArIGFyZ05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaW5hbEFyZ3NbYXJnTmFtZV0gPSBhcmdWYWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaW5hbEFyZ3M7XG4gICAgICB9LCBudWxsLCBkZWZhdWx0cyk7XG5cbiAgICAgIHRoaXNbbmFtZV0gPSBQcm9taXNlLm1ldGhvZChfLmJpbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtc2cgPSBfLmV4dGVuZCh7XG4gICAgICAgICAgbVQ6IG1UeXBlXG4gICAgICAgIH0sIGdldEFyZ3MoXy50b0FycmF5KGFyZ3VtZW50cykpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvdXJpZXJbY291cmllck1ldGhvZF0odGhpcy5fc2VydmljZUlkZW50aXR5LCBtc2cpO1xuICAgICAgfSwgdGhpcykpO1xuXG4gICAgfVxuICB9KTtcblxuICB2YXIgRXJyb3IgPSB7XG4gICAgQXJndW1lbnRNaXNzaW5nRXJyb3I6IExhbmcubWFrZUVycm9yQ2xhc3MoXCJBcmd1bWVudE1pc3NpbmdFcnJvclwiLCBcImFyZ3VtZW50IG1pc3NpbmdcIilcbiAgfTtcblxuICBCYXNlQ2xpZW50LkVycm9yID0gRXJyb3I7XG5cbiAgcmV0dXJuIEJhc2VDbGllbnQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZChcbiAgcmVxdWlyZShcInVuZGVyc2NvcmVcIiksXG4gIHJlcXVpcmUoXCJibHVlYmlyZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvb3B0aW9uc1wiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvbGFuZ1wiKSxcbiAgcmVxdWlyZShcIi4uLy4uL2NvcmUvdXVpZFwiKSxcbiAgcmVxdWlyZShcIi4uLy4uL21lc3NhZ2luZy9jb3VyaWVyXCIpXG4pO1xuXG59KSgpIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxucHJvY2Vzcy5uZXh0VGljayA9IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNhblNldEltbWVkaWF0ZSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgJiYgd2luZG93LnNldEltbWVkaWF0ZTtcbiAgICB2YXIgY2FuUG9zdCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgJiYgd2luZG93LnBvc3RNZXNzYWdlICYmIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyXG4gICAgO1xuXG4gICAgaWYgKGNhblNldEltbWVkaWF0ZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHdpbmRvdy5zZXRJbW1lZGlhdGUoZikgfTtcbiAgICB9XG5cbiAgICBpZiAoY2FuUG9zdCkge1xuICAgICAgICB2YXIgcXVldWUgPSBbXTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBldi5zb3VyY2U7XG4gICAgICAgICAgICBpZiAoKHNvdXJjZSA9PT0gd2luZG93IHx8IHNvdXJjZSA9PT0gbnVsbCkgJiYgZXYuZGF0YSA9PT0gJ3Byb2Nlc3MtdGljaycpIHtcbiAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBxdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGZuKTtcbiAgICAgICAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSgncHJvY2Vzcy10aWNrJywgJyonKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICAgICAgc2V0VGltZW91dChmbiwgMCk7XG4gICAgfTtcbn0pKCk7XG5cbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn1cblxuLy8gVE9ETyhzaHR5bG1hbilcbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuIiwiKGZ1bmN0aW9uKHByb2Nlc3Mpey8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgb2xkO1xuaWYgKHR5cGVvZiBQcm9taXNlICE9PSBcInVuZGVmaW5lZFwiKSBvbGQgPSBQcm9taXNlO1xuZnVuY3Rpb24gbm9Db25mbGljdChibHVlYmlyZCkge1xuICAgIHRyeSB7IGlmIChQcm9taXNlID09PSBibHVlYmlyZCkgUHJvbWlzZSA9IG9sZDsgfVxuICAgIGNhdGNoIChlKSB7fVxuICAgIHJldHVybiBibHVlYmlyZDtcbn1cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgYXN5bmMgPSByZXF1aXJlKFwiLi9hc3luYy5qc1wiKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKFwiLi9lcnJvcnMuanNcIik7XG5cbnZhciBJTlRFUk5BTCA9IGZ1bmN0aW9uKCl7fTtcbnZhciBBUFBMWSA9IHt9O1xudmFyIE5FWFRfRklMVEVSID0ge2U6IG51bGx9O1xuXG52YXIgY2FzdCA9IHJlcXVpcmUoXCIuL3RoZW5hYmxlcy5qc1wiKShQcm9taXNlLCBJTlRFUk5BTCk7XG52YXIgUHJvbWlzZUFycmF5ID0gcmVxdWlyZShcIi4vcHJvbWlzZV9hcnJheS5qc1wiKShQcm9taXNlLCBJTlRFUk5BTCwgY2FzdCk7XG52YXIgQ2FwdHVyZWRUcmFjZSA9IHJlcXVpcmUoXCIuL2NhcHR1cmVkX3RyYWNlLmpzXCIpKCk7XG52YXIgQ2F0Y2hGaWx0ZXIgPSByZXF1aXJlKFwiLi9jYXRjaF9maWx0ZXIuanNcIikoTkVYVF9GSUxURVIpO1xudmFyIFByb21pc2VSZXNvbHZlciA9IHJlcXVpcmUoXCIuL3Byb21pc2VfcmVzb2x2ZXIuanNcIik7XG5cbnZhciBpc0FycmF5ID0gdXRpbC5pc0FycmF5O1xuXG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIHRyeUNhdGNoMiA9IHV0aWwudHJ5Q2F0Y2gyO1xudmFyIHRyeUNhdGNoQXBwbHkgPSB1dGlsLnRyeUNhdGNoQXBwbHk7XG52YXIgUmFuZ2VFcnJvciA9IGVycm9ycy5SYW5nZUVycm9yO1xudmFyIFR5cGVFcnJvciA9IGVycm9ycy5UeXBlRXJyb3I7XG52YXIgQ2FuY2VsbGF0aW9uRXJyb3IgPSBlcnJvcnMuQ2FuY2VsbGF0aW9uRXJyb3I7XG52YXIgVGltZW91dEVycm9yID0gZXJyb3JzLlRpbWVvdXRFcnJvcjtcbnZhciBPcGVyYXRpb25hbEVycm9yID0gZXJyb3JzLk9wZXJhdGlvbmFsRXJyb3I7XG52YXIgb3JpZ2luYXRlc0Zyb21SZWplY3Rpb24gPSBlcnJvcnMub3JpZ2luYXRlc0Zyb21SZWplY3Rpb247XG52YXIgbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uID0gZXJyb3JzLm1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbjtcbnZhciBjYW5BdHRhY2ggPSBlcnJvcnMuY2FuQXR0YWNoO1xudmFyIHRocm93ZXIgPSB1dGlsLnRocm93ZXI7XG52YXIgYXBpUmVqZWN0aW9uID0gcmVxdWlyZShcIi4vZXJyb3JzX2FwaV9yZWplY3Rpb25cIikoUHJvbWlzZSk7XG5cblxudmFyIG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yID0gZnVuY3Rpb24gUHJvbWlzZSRfbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IoKSB7XG4gICAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoXCJjaXJjdWxhciBwcm9taXNlIHJlc29sdXRpb24gY2hhaW5cIik7XG59O1xuXG5mdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gICAgaWYgKHR5cGVvZiByZXNvbHZlciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvciByZXF1aXJlcyBhIHJlc29sdmVyIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciAhPT0gUHJvbWlzZSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwidGhlIHByb21pc2UgY29uc3RydWN0b3IgY2Fubm90IGJlIGludm9rZWQgZGlyZWN0bHlcIik7XG4gICAgfVxuICAgIHRoaXMuX2JpdEZpZWxkID0gMDtcbiAgICB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gdm9pZCAwO1xuICAgIHRoaXMuX3JlamVjdGlvbkhhbmRsZXIwID0gdm9pZCAwO1xuICAgIHRoaXMuX3Byb21pc2UwID0gdm9pZCAwO1xuICAgIHRoaXMuX3JlY2VpdmVyMCA9IHZvaWQgMDtcbiAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSB2b2lkIDA7XG4gICAgdGhpcy5fYm91bmRUbyA9IHZvaWQgMDtcbiAgICBpZiAocmVzb2x2ZXIgIT09IElOVEVSTkFMKSB0aGlzLl9yZXNvbHZlRnJvbVJlc29sdmVyKHJlc29sdmVyKTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIFByb21pc2UkYmluZCh0aGlzQXJnKSB7XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX2ZvbGxvdyh0aGlzKTtcbiAgICByZXQuX3Byb3BhZ2F0ZUZyb20odGhpcywgMiB8IDEpO1xuICAgIHJldC5fc2V0Qm91bmRUbyh0aGlzQXJnKTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiBQcm9taXNlJHRvU3RyaW5nKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgUHJvbWlzZV1cIjtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmNhdWdodCA9IFByb21pc2UucHJvdG90eXBlW1wiY2F0Y2hcIl0gPVxuZnVuY3Rpb24gUHJvbWlzZSRjYXRjaChmbikge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIGlmIChsZW4gPiAxKSB7XG4gICAgICAgIHZhciBjYXRjaEluc3RhbmNlcyA9IG5ldyBBcnJheShsZW4gLSAxKSxcbiAgICAgICAgICAgIGogPSAwLCBpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuIC0gMTsgKytpKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgY2F0Y2hJbnN0YW5jZXNbaisrXSA9IGl0ZW07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBjYXRjaEZpbHRlclR5cGVFcnJvciA9XG4gICAgICAgICAgICAgICAgICAgIG5ldyBUeXBlRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkEgY2F0Y2ggZmlsdGVyIG11c3QgYmUgYW4gZXJyb3IgY29uc3RydWN0b3IgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICsgXCJvciBhIGZpbHRlciBmdW5jdGlvblwiKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaEV4dHJhVHJhY2UoY2F0Y2hGaWx0ZXJUeXBlRXJyb3IpO1xuICAgICAgICAgICAgICAgIGFzeW5jLmludm9rZSh0aGlzLl9yZWplY3QsIHRoaXMsIGNhdGNoRmlsdGVyVHlwZUVycm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2hJbnN0YW5jZXMubGVuZ3RoID0gajtcbiAgICAgICAgZm4gPSBhcmd1bWVudHNbaV07XG5cbiAgICAgICAgdGhpcy5fcmVzZXRUcmFjZSgpO1xuICAgICAgICB2YXIgY2F0Y2hGaWx0ZXIgPSBuZXcgQ2F0Y2hGaWx0ZXIoY2F0Y2hJbnN0YW5jZXMsIGZuLCB0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4odm9pZCAwLCBjYXRjaEZpbHRlci5kb0ZpbHRlciwgdm9pZCAwLFxuICAgICAgICAgICAgY2F0Y2hGaWx0ZXIsIHZvaWQgMCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl90aGVuKHZvaWQgMCwgZm4sIHZvaWQgMCwgdm9pZCAwLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9XG5mdW5jdGlvbiBQcm9taXNlJHRoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcykge1xuICAgIHJldHVybiB0aGlzLl90aGVuKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MsXG4gICAgICAgIHZvaWQgMCwgdm9pZCAwKTtcbn07XG5cblxuUHJvbWlzZS5wcm90b3R5cGUuZG9uZSA9XG5mdW5jdGlvbiBQcm9taXNlJGRvbmUoZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCBkaWRQcm9ncmVzcykge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLFxuICAgICAgICB2b2lkIDAsIHZvaWQgMCk7XG4gICAgcHJvbWlzZS5fc2V0SXNGaW5hbCgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuc3ByZWFkID0gZnVuY3Rpb24gUHJvbWlzZSRzcHJlYWQoZGlkRnVsZmlsbCwgZGlkUmVqZWN0KSB7XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oZGlkRnVsZmlsbCwgZGlkUmVqZWN0LCB2b2lkIDAsXG4gICAgICAgIEFQUExZLCB2b2lkIDApO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuaXNDYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkaXNDYW5jZWxsYWJsZSgpIHtcbiAgICByZXR1cm4gIXRoaXMuaXNSZXNvbHZlZCgpICYmXG4gICAgICAgIHRoaXMuX2NhbmNlbGxhYmxlKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiBQcm9taXNlJHRvSlNPTigpIHtcbiAgICB2YXIgcmV0ID0ge1xuICAgICAgICBpc0Z1bGZpbGxlZDogZmFsc2UsXG4gICAgICAgIGlzUmVqZWN0ZWQ6IGZhbHNlLFxuICAgICAgICBmdWxmaWxsbWVudFZhbHVlOiB2b2lkIDAsXG4gICAgICAgIHJlamVjdGlvblJlYXNvbjogdm9pZCAwXG4gICAgfTtcbiAgICBpZiAodGhpcy5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgIHJldC5mdWxmaWxsbWVudFZhbHVlID0gdGhpcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICByZXQuaXNGdWxmaWxsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgcmV0LnJlamVjdGlvblJlYXNvbiA9IHRoaXMuX3NldHRsZWRWYWx1ZTtcbiAgICAgICAgcmV0LmlzUmVqZWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuYWxsID0gZnVuY3Rpb24gUHJvbWlzZSRhbGwoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlQXJyYXkodGhpcykucHJvbWlzZSgpO1xufTtcblxuXG5Qcm9taXNlLmlzID0gZnVuY3Rpb24gUHJvbWlzZSRJcyh2YWwpIHtcbiAgICByZXR1cm4gdmFsIGluc3RhbmNlb2YgUHJvbWlzZTtcbn07XG5cblByb21pc2UuYWxsID0gZnVuY3Rpb24gUHJvbWlzZSRBbGwocHJvbWlzZXMpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2VBcnJheShwcm9taXNlcykucHJvbWlzZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiBQcm9taXNlJF9lcnJvcihmbikge1xuICAgIHJldHVybiB0aGlzLmNhdWdodChvcmlnaW5hdGVzRnJvbVJlamVjdGlvbiwgZm4pO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Jlc29sdmVGcm9tU3luY1ZhbHVlID1cbmZ1bmN0aW9uIFByb21pc2UkX3Jlc29sdmVGcm9tU3luY1ZhbHVlKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09PSBlcnJvck9iaikge1xuICAgICAgICB0aGlzLl9jbGVhblZhbHVlcygpO1xuICAgICAgICB0aGlzLl9zZXRSZWplY3RlZCgpO1xuICAgICAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSB2YWx1ZS5lO1xuICAgICAgICB0aGlzLl9lbnN1cmVQb3NzaWJsZVJlamVjdGlvbkhhbmRsZWQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdCh2YWx1ZSwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZvbGxvdyhtYXliZVByb21pc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuX3NldEZ1bGZpbGxlZCgpO1xuICAgICAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Qcm9taXNlLm1ldGhvZCA9IGZ1bmN0aW9uIFByb21pc2UkX01ldGhvZChmbikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfbWV0aG9kKCkge1xuICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgIHN3aXRjaChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDogdmFsdWUgPSB0cnlDYXRjaDEoZm4sIHRoaXMsIHZvaWQgMCk7IGJyZWFrO1xuICAgICAgICBjYXNlIDE6IHZhbHVlID0gdHJ5Q2F0Y2gxKGZuLCB0aGlzLCBhcmd1bWVudHNbMF0pOyBicmVhaztcbiAgICAgICAgY2FzZSAyOiB2YWx1ZSA9IHRyeUNhdGNoMihmbiwgdGhpcywgYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0pOyBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHZhciAkX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGg7dmFyIGFyZ3MgPSBuZXcgQXJyYXkoJF9sZW4pOyBmb3IodmFyICRfaSA9IDA7ICRfaSA8ICRfbGVuOyArKyRfaSkge2FyZ3NbJF9pXSA9IGFyZ3VtZW50c1skX2ldO31cbiAgICAgICAgICAgIHZhbHVlID0gdHJ5Q2F0Y2hBcHBseShmbiwgYXJncywgdGhpcyk7IGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICAgICAgcmV0Ll9yZXNvbHZlRnJvbVN5bmNWYWx1ZSh2YWx1ZSk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcbn07XG5cblByb21pc2UuYXR0ZW1wdCA9IFByb21pc2VbXCJ0cnlcIl0gPSBmdW5jdGlvbiBQcm9taXNlJF9UcnkoZm4sIGFyZ3MsIGN0eCkge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICB2YXIgdmFsdWUgPSBpc0FycmF5KGFyZ3MpXG4gICAgICAgID8gdHJ5Q2F0Y2hBcHBseShmbiwgYXJncywgY3R4KVxuICAgICAgICA6IHRyeUNhdGNoMShmbiwgY3R4LCBhcmdzKTtcblxuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgcmV0Ll9zZXRUcmFjZSh2b2lkIDApO1xuICAgIHJldC5fcmVzb2x2ZUZyb21TeW5jVmFsdWUodmFsdWUpO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLmRlZmVyID0gUHJvbWlzZS5wZW5kaW5nID0gZnVuY3Rpb24gUHJvbWlzZSREZWZlcigpIHtcbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZVJlc29sdmVyKHByb21pc2UpO1xufTtcblxuUHJvbWlzZS5iaW5kID0gZnVuY3Rpb24gUHJvbWlzZSRCaW5kKHRoaXNBcmcpIHtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICByZXQuX3NldEZ1bGZpbGxlZCgpO1xuICAgIHJldC5fc2V0Qm91bmRUbyh0aGlzQXJnKTtcbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5jYXN0ID0gZnVuY3Rpb24gUHJvbWlzZSRfQ2FzdChvYmopIHtcbiAgICB2YXIgcmV0ID0gY2FzdChvYmosIHZvaWQgMCk7XG4gICAgaWYgKCEocmV0IGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgdmFyIHZhbCA9IHJldDtcbiAgICAgICAgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgIHJldC5fc2V0RnVsZmlsbGVkKCk7XG4gICAgICAgIHJldC5fY2xlYW5WYWx1ZXMoKTtcbiAgICAgICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSB2YWw7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5Qcm9taXNlLnJlc29sdmUgPSBQcm9taXNlLmZ1bGZpbGxlZCA9IFByb21pc2UuY2FzdDtcblxuUHJvbWlzZS5yZWplY3QgPSBQcm9taXNlLnJlamVjdGVkID0gZnVuY3Rpb24gUHJvbWlzZSRSZWplY3QocmVhc29uKSB7XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgbWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKHJlYXNvbik7XG4gICAgcmV0Ll9jbGVhblZhbHVlcygpO1xuICAgIHJldC5fc2V0UmVqZWN0ZWQoKTtcbiAgICByZXQuX3NldHRsZWRWYWx1ZSA9IHJlYXNvbjtcbiAgICBpZiAoIWNhbkF0dGFjaChyZWFzb24pKSB7XG4gICAgICAgIHZhciB0cmFjZSA9IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKTtcbiAgICAgICAgcmV0Ll9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSk7XG4gICAgfVxuICAgIHJldC5fZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkKCk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2Uub25Qb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9XG5mdW5jdGlvbiBQcm9taXNlJE9uUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24oZm4pIHtcbiAgICAgICAgQ2FwdHVyZWRUcmFjZS5wb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBmbiA6IHZvaWQgMDtcbn07XG5cbnZhciB1bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkO1xuUHJvbWlzZS5vblVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRvblVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQoZm4pIHtcbiAgICB1bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkID0gdHlwZW9mIGZuID09PSBcImZ1bmN0aW9uXCIgPyBmbiA6IHZvaWQgMDtcbn07XG5cbnZhciBkZWJ1Z2dpbmcgPSBmYWxzZSB8fCAhIShcbiAgICB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBwcm9jZXNzLmV4ZWNQYXRoID09PSBcInN0cmluZ1wiICYmXG4gICAgdHlwZW9mIHByb2Nlc3MuZW52ID09PSBcIm9iamVjdFwiICYmXG4gICAgKHByb2Nlc3MuZW52W1wiQkxVRUJJUkRfREVCVUdcIl0gfHxcbiAgICAgICAgcHJvY2Vzcy5lbnZbXCJOT0RFX0VOVlwiXSA9PT0gXCJkZXZlbG9wbWVudFwiKVxuKTtcblxuXG5Qcm9taXNlLmxvbmdTdGFja1RyYWNlcyA9IGZ1bmN0aW9uIFByb21pc2UkTG9uZ1N0YWNrVHJhY2VzKCkge1xuICAgIGlmIChhc3luYy5oYXZlSXRlbXNRdWV1ZWQoKSAmJlxuICAgICAgICBkZWJ1Z2dpbmcgPT09IGZhbHNlXG4gICApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2Fubm90IGVuYWJsZSBsb25nIHN0YWNrIHRyYWNlcyBhZnRlciBwcm9taXNlcyBoYXZlIGJlZW4gY3JlYXRlZFwiKTtcbiAgICB9XG4gICAgZGVidWdnaW5nID0gQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCgpO1xufTtcblxuUHJvbWlzZS5oYXNMb25nU3RhY2tUcmFjZXMgPSBmdW5jdGlvbiBQcm9taXNlJEhhc0xvbmdTdGFja1RyYWNlcygpIHtcbiAgICByZXR1cm4gZGVidWdnaW5nICYmIENhcHR1cmVkVHJhY2UuaXNTdXBwb3J0ZWQoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl90aGVuID1cbmZ1bmN0aW9uIFByb21pc2UkX3RoZW4oXG4gICAgZGlkRnVsZmlsbCxcbiAgICBkaWRSZWplY3QsXG4gICAgZGlkUHJvZ3Jlc3MsXG4gICAgcmVjZWl2ZXIsXG4gICAgaW50ZXJuYWxEYXRhXG4pIHtcbiAgICB2YXIgaGF2ZUludGVybmFsRGF0YSA9IGludGVybmFsRGF0YSAhPT0gdm9pZCAwO1xuICAgIHZhciByZXQgPSBoYXZlSW50ZXJuYWxEYXRhID8gaW50ZXJuYWxEYXRhIDogbmV3IFByb21pc2UoSU5URVJOQUwpO1xuXG4gICAgaWYgKCFoYXZlSW50ZXJuYWxEYXRhKSB7XG4gICAgICAgIGlmIChkZWJ1Z2dpbmcpIHtcbiAgICAgICAgICAgIHZhciBoYXZlU2FtZUNvbnRleHQgPSB0aGlzLl9wZWVrQ29udGV4dCgpID09PSB0aGlzLl90cmFjZVBhcmVudDtcbiAgICAgICAgICAgIHJldC5fdHJhY2VQYXJlbnQgPSBoYXZlU2FtZUNvbnRleHQgPyB0aGlzLl90cmFjZVBhcmVudCA6IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0Ll9wcm9wYWdhdGVGcm9tKHRoaXMsIDcpO1xuICAgIH1cblxuICAgIHZhciBjYWxsYmFja0luZGV4ID1cbiAgICAgICAgdGhpcy5fYWRkQ2FsbGJhY2tzKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MsIHJldCwgcmVjZWl2ZXIpO1xuXG4gICAgaWYgKHRoaXMuaXNSZXNvbHZlZCgpKSB7XG4gICAgICAgIGFzeW5jLmludm9rZSh0aGlzLl9xdWV1ZVNldHRsZUF0LCB0aGlzLCBjYWxsYmFja0luZGV4KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmV0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2xlbmd0aCA9IGZ1bmN0aW9uIFByb21pc2UkX2xlbmd0aCgpIHtcbiAgICByZXR1cm4gdGhpcy5fYml0RmllbGQgJiAyNjIxNDM7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfaXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDkzOTUyNDA5NikgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2lzRm9sbG93aW5nID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNGb2xsb3dpbmcoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDUzNjg3MDkxMikgPT09IDUzNjg3MDkxMjtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRMZW5ndGggPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRMZW5ndGgobGVuKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSAodGhpcy5fYml0RmllbGQgJiAtMjYyMTQ0KSB8XG4gICAgICAgIChsZW4gJiAyNjIxNDMpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldEZ1bGZpbGxlZCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldEZ1bGZpbGxlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMjY4NDM1NDU2O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFJlamVjdGVkID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0UmVqZWN0ZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDEzNDIxNzcyODtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRGb2xsb3dpbmcgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRGb2xsb3dpbmcoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDUzNjg3MDkxMjtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRJc0ZpbmFsID0gZnVuY3Rpb24gUHJvbWlzZSRfc2V0SXNGaW5hbCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMzM1NTQ0MzI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNGaW5hbCA9IGZ1bmN0aW9uIFByb21pc2UkX2lzRmluYWwoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDMzNTU0NDMyKSA+IDA7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fY2FuY2VsbGFibGUgPSBmdW5jdGlvbiBQcm9taXNlJF9jYW5jZWxsYWJsZSgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgNjcxMDg4NjQpID4gMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRDYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkX3NldENhbmNlbGxhYmxlKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA2NzEwODg2NDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldENhbmNlbGxhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRDYW5jZWxsYWJsZSgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH42NzEwODg2NCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCB8IDIwOTcxNTI7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjIwOTcxNTIpO1xuICAgIGlmICh0aGlzLl9pc1VuaGFuZGxlZFJlamVjdGlvbk5vdGlmaWVkKCkpIHtcbiAgICAgICAgdGhpcy5fdW5zZXRVbmhhbmRsZWRSZWplY3Rpb25Jc05vdGlmaWVkKCk7XG4gICAgICAgIHRoaXMuX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbklzSGFuZGxlZCgpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc1JlamVjdGlvblVuaGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9pc1JlamVjdGlvblVuaGFuZGxlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMjA5NzE1MikgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgNTI0Mjg4O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCA9XG5mdW5jdGlvbiBQcm9taXNlJF91bnNldFVuaGFuZGxlZFJlamVjdGlvbklzTm90aWZpZWQoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+NTI0Mjg4KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc1VuaGFuZGxlZFJlamVjdGlvbk5vdGlmaWVkID1cbmZ1bmN0aW9uIFByb21pc2UkX2lzVW5oYW5kbGVkUmVqZWN0aW9uTm90aWZpZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDUyNDI4OCkgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldENhcnJpZWRTdGFja1RyYWNlID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldENhcnJpZWRTdGFja1RyYWNlKGNhcHR1cmVkVHJhY2UpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMTA0ODU3NjtcbiAgICB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gY2FwdHVyZWRUcmFjZTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldENhcnJpZWRTdGFja1RyYWNlID1cbmZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0Q2FycmllZFN0YWNrVHJhY2UoKSB7XG4gICAgdGhpcy5fYml0RmllbGQgPSB0aGlzLl9iaXRGaWVsZCAmICh+MTA0ODU3Nik7XG4gICAgdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMCA9IHZvaWQgMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlJF9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMTA0ODU3NikgPiAwO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2dldENhcnJpZWRTdGFja1RyYWNlID1cbmZ1bmN0aW9uIFByb21pc2UkX2dldENhcnJpZWRTdGFja1RyYWNlKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0NhcnJ5aW5nU3RhY2tUcmFjZSgpXG4gICAgICAgID8gdGhpcy5fZnVsZmlsbG1lbnRIYW5kbGVyMFxuICAgICAgICA6IHZvaWQgMDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWNlaXZlckF0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcmVjZWl2ZXJBdChpbmRleCkge1xuICAgIHZhciByZXQgPSBpbmRleCA9PT0gMFxuICAgICAgICA/IHRoaXMuX3JlY2VpdmVyMFxuICAgICAgICA6IHRoaXNbKGluZGV4IDw8IDIpICsgaW5kZXggLSA1ICsgNF07XG4gICAgaWYgKHRoaXMuX2lzQm91bmQoKSAmJiByZXQgPT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm91bmRUbztcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm9taXNlQXQgPSBmdW5jdGlvbiBQcm9taXNlJF9wcm9taXNlQXQoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9wcm9taXNlMFxuICAgICAgICA6IHRoaXNbKGluZGV4IDw8IDIpICsgaW5kZXggLSA1ICsgM107XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZnVsZmlsbG1lbnRIYW5kbGVyQXQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfZnVsZmlsbG1lbnRIYW5kbGVyQXQoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAwXTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3Rpb25IYW5kbGVyQXQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0aW9uSGFuZGxlckF0KGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ID09PSAwXG4gICAgICAgID8gdGhpcy5fcmVqZWN0aW9uSGFuZGxlcjBcbiAgICAgICAgOiB0aGlzWyhpbmRleCA8PCAyKSArIGluZGV4IC0gNSArIDFdO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2FkZENhbGxiYWNrcyA9IGZ1bmN0aW9uIFByb21pc2UkX2FkZENhbGxiYWNrcyhcbiAgICBmdWxmaWxsLFxuICAgIHJlamVjdCxcbiAgICBwcm9ncmVzcyxcbiAgICBwcm9taXNlLFxuICAgIHJlY2VpdmVyXG4pIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLl9sZW5ndGgoKTtcblxuICAgIGlmIChpbmRleCA+PSAyNjIxNDMgLSA1KSB7XG4gICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fc2V0TGVuZ3RoKDApO1xuICAgIH1cblxuICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICB0aGlzLl9wcm9taXNlMCA9IHByb21pc2U7XG4gICAgICAgIGlmIChyZWNlaXZlciAhPT0gdm9pZCAwKSB0aGlzLl9yZWNlaXZlcjAgPSByZWNlaXZlcjtcbiAgICAgICAgaWYgKHR5cGVvZiBmdWxmaWxsID09PSBcImZ1bmN0aW9uXCIgJiYgIXRoaXMuX2lzQ2FycnlpbmdTdGFja1RyYWNlKCkpXG4gICAgICAgICAgICB0aGlzLl9mdWxmaWxsbWVudEhhbmRsZXIwID0gZnVsZmlsbDtcbiAgICAgICAgaWYgKHR5cGVvZiByZWplY3QgPT09IFwiZnVuY3Rpb25cIikgdGhpcy5fcmVqZWN0aW9uSGFuZGxlcjAgPSByZWplY3Q7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvZ3Jlc3MgPT09IFwiZnVuY3Rpb25cIikgdGhpcy5fcHJvZ3Jlc3NIYW5kbGVyMCA9IHByb2dyZXNzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBiYXNlID0gKGluZGV4IDw8IDIpICsgaW5kZXggLSA1O1xuICAgICAgICB0aGlzW2Jhc2UgKyAzXSA9IHByb21pc2U7XG4gICAgICAgIHRoaXNbYmFzZSArIDRdID0gcmVjZWl2ZXI7XG4gICAgICAgIHRoaXNbYmFzZSArIDBdID0gdHlwZW9mIGZ1bGZpbGwgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGZ1bGZpbGwgOiB2b2lkIDA7XG4gICAgICAgIHRoaXNbYmFzZSArIDFdID0gdHlwZW9mIHJlamVjdCA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcmVqZWN0IDogdm9pZCAwO1xuICAgICAgICB0aGlzW2Jhc2UgKyAyXSA9IHR5cGVvZiBwcm9ncmVzcyA9PT0gXCJmdW5jdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcHJvZ3Jlc3MgOiB2b2lkIDA7XG4gICAgfVxuICAgIHRoaXMuX3NldExlbmd0aChpbmRleCArIDEpO1xuICAgIHJldHVybiBpbmRleDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRQcm94eUhhbmRsZXJzID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldFByb3h5SGFuZGxlcnMocmVjZWl2ZXIsIHByb21pc2VTbG90VmFsdWUpIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLl9sZW5ndGgoKTtcblxuICAgIGlmIChpbmRleCA+PSAyNjIxNDMgLSA1KSB7XG4gICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fc2V0TGVuZ3RoKDApO1xuICAgIH1cbiAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZTAgPSBwcm9taXNlU2xvdFZhbHVlO1xuICAgICAgICB0aGlzLl9yZWNlaXZlcjAgPSByZWNlaXZlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgYmFzZSA9IChpbmRleCA8PCAyKSArIGluZGV4IC0gNTtcbiAgICAgICAgdGhpc1tiYXNlICsgM10gPSBwcm9taXNlU2xvdFZhbHVlO1xuICAgICAgICB0aGlzW2Jhc2UgKyA0XSA9IHJlY2VpdmVyO1xuICAgICAgICB0aGlzW2Jhc2UgKyAwXSA9XG4gICAgICAgIHRoaXNbYmFzZSArIDFdID1cbiAgICAgICAgdGhpc1tiYXNlICsgMl0gPSB2b2lkIDA7XG4gICAgfVxuICAgIHRoaXMuX3NldExlbmd0aChpbmRleCArIDEpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb3h5UHJvbWlzZUFycmF5ID1cbmZ1bmN0aW9uIFByb21pc2UkX3Byb3h5UHJvbWlzZUFycmF5KHByb21pc2VBcnJheSwgaW5kZXgpIHtcbiAgICB0aGlzLl9zZXRQcm94eUhhbmRsZXJzKHByb21pc2VBcnJheSwgaW5kZXgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Byb3h5UHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2UkX3Byb3h5UHJvbWlzZShwcm9taXNlKSB7XG4gICAgcHJvbWlzZS5fc2V0UHJveGllZCgpO1xuICAgIHRoaXMuX3NldFByb3h5SGFuZGxlcnMocHJvbWlzZSwgLTEpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldEJvdW5kVG8gPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRCb3VuZFRvKG9iaikge1xuICAgIGlmIChvYmogIT09IHZvaWQgMCkge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgODM4ODYwODtcbiAgICAgICAgdGhpcy5fYm91bmRUbyA9IG9iajtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH44Mzg4NjA4KTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5faXNCb3VuZCA9IGZ1bmN0aW9uIFByb21pc2UkX2lzQm91bmQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDgzODg2MDgpID09PSA4Mzg4NjA4O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Jlc29sdmVGcm9tUmVzb2x2ZXIgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVzb2x2ZUZyb21SZXNvbHZlcihyZXNvbHZlcikge1xuICAgIHZhciBwcm9taXNlID0gdGhpcztcbiAgICB0aGlzLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgIHRoaXMuX3B1c2hDb250ZXh0KCk7XG5cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9yZXNvbHZlcih2YWwpIHtcbiAgICAgICAgaWYgKHByb21pc2UuX3RyeUZvbGxvdyh2YWwpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcHJvbWlzZS5fZnVsZmlsbCh2YWwpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9yZWplY3Rlcih2YWwpIHtcbiAgICAgICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKHZhbCkgPyB2YWwgOiBuZXcgRXJyb3IodmFsICsgXCJcIik7XG4gICAgICAgIHByb21pc2UuX2F0dGFjaEV4dHJhVHJhY2UodHJhY2UpO1xuICAgICAgICBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24odmFsKTtcbiAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHZhbCwgdHJhY2UgPT09IHZhbCA/IHZvaWQgMCA6IHRyYWNlKTtcbiAgICB9XG4gICAgdmFyIHIgPSB0cnlDYXRjaDIocmVzb2x2ZXIsIHZvaWQgMCwgUHJvbWlzZSRfcmVzb2x2ZXIsIFByb21pc2UkX3JlamVjdGVyKTtcbiAgICB0aGlzLl9wb3BDb250ZXh0KCk7XG5cbiAgICBpZiAociAhPT0gdm9pZCAwICYmIHIgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIHZhciBlID0gci5lO1xuICAgICAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2goZSkgPyBlIDogbmV3IEVycm9yKGUgKyBcIlwiKTtcbiAgICAgICAgcHJvbWlzZS5fcmVqZWN0KGUsIHRyYWNlKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc3ByZWFkU2xvd0Nhc2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfc3ByZWFkU2xvd0Nhc2UodGFyZ2V0Rm4sIHByb21pc2UsIHZhbHVlcywgYm91bmRUbykge1xuICAgIHZhciBwcm9taXNlRm9yQWxsID0gbmV3IFByb21pc2VBcnJheSh2YWx1ZXMpLnByb21pc2UoKTtcbiAgICB2YXIgcHJvbWlzZTIgPSBwcm9taXNlRm9yQWxsLl90aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGFyZ2V0Rm4uYXBwbHkoYm91bmRUbywgYXJndW1lbnRzKTtcbiAgICB9LCB2b2lkIDAsIHZvaWQgMCwgQVBQTFksIHZvaWQgMCk7XG4gICAgcHJvbWlzZS5fZm9sbG93KHByb21pc2UyKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9jYWxsU3ByZWFkID1cbmZ1bmN0aW9uIFByb21pc2UkX2NhbGxTcHJlYWQoaGFuZGxlciwgcHJvbWlzZSwgdmFsdWUpIHtcbiAgICB2YXIgYm91bmRUbyA9IHRoaXMuX2JvdW5kVG87XG4gICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB2YWx1ZS5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgICAgICAgICAgaWYgKGNhc3QodmFsdWVbaV0sIHZvaWQgMCkgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3ByZWFkU2xvd0Nhc2UoaGFuZGxlciwgcHJvbWlzZSwgdmFsdWUsIGJvdW5kVG8pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9taXNlLl9wdXNoQ29udGV4dCgpO1xuICAgIHJldHVybiB0cnlDYXRjaEFwcGx5KGhhbmRsZXIsIHZhbHVlLCBib3VuZFRvKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9jYWxsSGFuZGxlciA9XG5mdW5jdGlvbiBQcm9taXNlJF9jYWxsSGFuZGxlcihcbiAgICBoYW5kbGVyLCByZWNlaXZlciwgcHJvbWlzZSwgdmFsdWUpIHtcbiAgICB2YXIgeDtcbiAgICBpZiAocmVjZWl2ZXIgPT09IEFQUExZICYmICF0aGlzLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICB4ID0gdGhpcy5fY2FsbFNwcmVhZChoYW5kbGVyLCBwcm9taXNlLCB2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcHJvbWlzZS5fcHVzaENvbnRleHQoKTtcbiAgICAgICAgeCA9IHRyeUNhdGNoMShoYW5kbGVyLCByZWNlaXZlciwgdmFsdWUpO1xuICAgIH1cbiAgICBwcm9taXNlLl9wb3BDb250ZXh0KCk7XG4gICAgcmV0dXJuIHg7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZUZyb21IYW5kbGVyID1cbmZ1bmN0aW9uIFByb21pc2UkX3NldHRsZVByb21pc2VGcm9tSGFuZGxlcihcbiAgICBoYW5kbGVyLCByZWNlaXZlciwgdmFsdWUsIHByb21pc2Vcbikge1xuICAgIGlmICghKHByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICBoYW5kbGVyLmNhbGwocmVjZWl2ZXIsIHZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgeCA9IHRoaXMuX2NhbGxIYW5kbGVyKGhhbmRsZXIsIHJlY2VpdmVyLCBwcm9taXNlLCB2YWx1ZSk7XG4gICAgaWYgKHByb21pc2UuX2lzRm9sbG93aW5nKCkpIHJldHVybjtcblxuICAgIGlmICh4ID09PSBlcnJvck9iaiB8fCB4ID09PSBwcm9taXNlIHx8IHggPT09IE5FWFRfRklMVEVSKSB7XG4gICAgICAgIHZhciBlcnIgPSB4ID09PSBwcm9taXNlXG4gICAgICAgICAgICAgICAgICAgID8gbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IoKVxuICAgICAgICAgICAgICAgICAgICA6IHguZTtcbiAgICAgICAgdmFyIHRyYWNlID0gY2FuQXR0YWNoKGVycikgPyBlcnIgOiBuZXcgRXJyb3IoZXJyICsgXCJcIik7XG4gICAgICAgIGlmICh4ICE9PSBORVhUX0ZJTFRFUikgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgIHByb21pc2UuX3JlamVjdFVuY2hlY2tlZChlcnIsIHRyYWNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgY2FzdFZhbHVlID0gY2FzdCh4LCBwcm9taXNlKTtcbiAgICAgICAgaWYgKGNhc3RWYWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIGlmIChjYXN0VmFsdWUuaXNSZWplY3RlZCgpICYmXG4gICAgICAgICAgICAgICAgIWNhc3RWYWx1ZS5faXNDYXJyeWluZ1N0YWNrVHJhY2UoKSAmJlxuICAgICAgICAgICAgICAgICFjYW5BdHRhY2goY2FzdFZhbHVlLl9zZXR0bGVkVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYWNlID0gbmV3IEVycm9yKGNhc3RWYWx1ZS5fc2V0dGxlZFZhbHVlICsgXCJcIik7XG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICAgICAgY2FzdFZhbHVlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcm9taXNlLl9mb2xsb3coY2FzdFZhbHVlKTtcbiAgICAgICAgICAgIHByb21pc2UuX3Byb3BhZ2F0ZUZyb20oY2FzdFZhbHVlLCAxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGxVbmNoZWNrZWQoeCk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZm9sbG93ID1cbmZ1bmN0aW9uIFByb21pc2UkX2ZvbGxvdyhwcm9taXNlKSB7XG4gICAgdGhpcy5fc2V0Rm9sbG93aW5nKCk7XG5cbiAgICBpZiAocHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICB0aGlzLl9wcm9wYWdhdGVGcm9tKHByb21pc2UsIDEpO1xuICAgICAgICBwcm9taXNlLl9wcm94eVByb21pc2UodGhpcyk7XG4gICAgfSBlbHNlIGlmIChwcm9taXNlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgdGhpcy5fZnVsZmlsbFVuY2hlY2tlZChwcm9taXNlLl9zZXR0bGVkVmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3JlamVjdFVuY2hlY2tlZChwcm9taXNlLl9zZXR0bGVkVmFsdWUsXG4gICAgICAgICAgICBwcm9taXNlLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpKTtcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZS5faXNSZWplY3Rpb25VbmhhbmRsZWQoKSkgcHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuXG4gICAgaWYgKGRlYnVnZ2luZyAmJlxuICAgICAgICBwcm9taXNlLl90cmFjZVBhcmVudCA9PSBudWxsKSB7XG4gICAgICAgIHByb21pc2UuX3RyYWNlUGFyZW50ID0gdGhpcztcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fdHJ5Rm9sbG93ID1cbmZ1bmN0aW9uIFByb21pc2UkX3RyeUZvbGxvdyh2YWx1ZSkge1xuICAgIGlmICh0aGlzLl9pc0ZvbGxvd2luZ09yRnVsZmlsbGVkT3JSZWplY3RlZCgpIHx8XG4gICAgICAgIHZhbHVlID09PSB0aGlzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWUsIHZvaWQgMCk7XG4gICAgaWYgKCEobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0aGlzLl9mb2xsb3cobWF5YmVQcm9taXNlKTtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZXNldFRyYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRfcmVzZXRUcmFjZSgpIHtcbiAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgIHRoaXMuX3RyYWNlID0gbmV3IENhcHR1cmVkVHJhY2UodGhpcy5fcGVla0NvbnRleHQoKSA9PT0gdm9pZCAwKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0VHJhY2UgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRUcmFjZShwYXJlbnQpIHtcbiAgICBpZiAoZGVidWdnaW5nKSB7XG4gICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fcGVla0NvbnRleHQoKTtcbiAgICAgICAgdGhpcy5fdHJhY2VQYXJlbnQgPSBjb250ZXh0O1xuICAgICAgICB2YXIgaXNUb3BMZXZlbCA9IGNvbnRleHQgPT09IHZvaWQgMDtcbiAgICAgICAgaWYgKHBhcmVudCAhPT0gdm9pZCAwICYmXG4gICAgICAgICAgICBwYXJlbnQuX3RyYWNlUGFyZW50ID09PSBjb250ZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl90cmFjZSA9IHBhcmVudC5fdHJhY2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl90cmFjZSA9IG5ldyBDYXB0dXJlZFRyYWNlKGlzVG9wTGV2ZWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2F0dGFjaEV4dHJhVHJhY2UgPVxuZnVuY3Rpb24gUHJvbWlzZSRfYXR0YWNoRXh0cmFUcmFjZShlcnJvcikge1xuICAgIGlmIChkZWJ1Z2dpbmcpIHtcbiAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzO1xuICAgICAgICB2YXIgc3RhY2sgPSBlcnJvci5zdGFjaztcbiAgICAgICAgc3RhY2sgPSB0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIgPyBzdGFjay5zcGxpdChcIlxcblwiKSA6IFtdO1xuICAgICAgICBDYXB0dXJlZFRyYWNlLnByb3RlY3RFcnJvck1lc3NhZ2VOZXdsaW5lcyhzdGFjayk7XG4gICAgICAgIHZhciBoZWFkZXJMaW5lQ291bnQgPSAxO1xuICAgICAgICB2YXIgY29tYmluZWRUcmFjZXMgPSAxO1xuICAgICAgICB3aGlsZShwcm9taXNlICE9IG51bGwgJiZcbiAgICAgICAgICAgIHByb21pc2UuX3RyYWNlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0YWNrID0gQ2FwdHVyZWRUcmFjZS5jb21iaW5lKFxuICAgICAgICAgICAgICAgIHN0YWNrLFxuICAgICAgICAgICAgICAgIHByb21pc2UuX3RyYWNlLnN0YWNrLnNwbGl0KFwiXFxuXCIpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcHJvbWlzZSA9IHByb21pc2UuX3RyYWNlUGFyZW50O1xuICAgICAgICAgICAgY29tYmluZWRUcmFjZXMrKztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzdGFja1RyYWNlTGltaXQgPSBFcnJvci5zdGFja1RyYWNlTGltaXQgfHwgMTA7XG4gICAgICAgIHZhciBtYXggPSAoc3RhY2tUcmFjZUxpbWl0ICsgaGVhZGVyTGluZUNvdW50KSAqIGNvbWJpbmVkVHJhY2VzO1xuICAgICAgICB2YXIgbGVuID0gc3RhY2subGVuZ3RoO1xuICAgICAgICBpZiAobGVuID4gbWF4KSB7XG4gICAgICAgICAgICBzdGFjay5sZW5ndGggPSBtYXg7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobGVuID4gMClcbiAgICAgICAgICAgIHN0YWNrWzBdID0gc3RhY2tbMF0uc3BsaXQoXCJcXHUwMDAyXFx1MDAwMFxcdTAwMDFcIikuam9pbihcIlxcblwiKTtcblxuICAgICAgICBpZiAoc3RhY2subGVuZ3RoIDw9IGhlYWRlckxpbmVDb3VudCkge1xuICAgICAgICAgICAgZXJyb3Iuc3RhY2sgPSBcIihObyBzdGFjayB0cmFjZSlcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVycm9yLnN0YWNrID0gc3RhY2suam9pbihcIlxcblwiKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9jbGVhblZhbHVlcyA9IGZ1bmN0aW9uIFByb21pc2UkX2NsZWFuVmFsdWVzKCkge1xuICAgIGlmICh0aGlzLl9jYW5jZWxsYWJsZSgpKSB7XG4gICAgICAgIHRoaXMuX2NhbmNlbGxhdGlvblBhcmVudCA9IHZvaWQgMDtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvcGFnYXRlRnJvbSA9XG5mdW5jdGlvbiBQcm9taXNlJF9wcm9wYWdhdGVGcm9tKHBhcmVudCwgZmxhZ3MpIHtcbiAgICBpZiAoKGZsYWdzICYgMSkgPiAwICYmIHBhcmVudC5fY2FuY2VsbGFibGUoKSkge1xuICAgICAgICB0aGlzLl9zZXRDYW5jZWxsYWJsZSgpO1xuICAgICAgICB0aGlzLl9jYW5jZWxsYXRpb25QYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuICAgIGlmICgoZmxhZ3MgJiA0KSA+IDApIHtcbiAgICAgICAgdGhpcy5fc2V0Qm91bmRUbyhwYXJlbnQuX2JvdW5kVG8pO1xuICAgIH1cbiAgICBpZiAoKGZsYWdzICYgMikgPiAwKSB7XG4gICAgICAgIHRoaXMuX3NldFRyYWNlKHBhcmVudCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGwgPSBmdW5jdGlvbiBQcm9taXNlJF9mdWxmaWxsKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuX2lzRm9sbG93aW5nT3JGdWxmaWxsZWRPclJlamVjdGVkKCkpIHJldHVybjtcbiAgICB0aGlzLl9mdWxmaWxsVW5jaGVja2VkKHZhbHVlKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9yZWplY3QgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0KHJlYXNvbiwgY2FycmllZFN0YWNrVHJhY2UpIHtcbiAgICBpZiAodGhpcy5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3JlamVjdFVuY2hlY2tlZChyZWFzb24sIGNhcnJpZWRTdGFja1RyYWNlKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXR0bGVQcm9taXNlQXQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXR0bGVQcm9taXNlQXQoaW5kZXgpIHtcbiAgICB2YXIgaGFuZGxlciA9IHRoaXMuaXNGdWxmaWxsZWQoKVxuICAgICAgICA/IHRoaXMuX2Z1bGZpbGxtZW50SGFuZGxlckF0KGluZGV4KVxuICAgICAgICA6IHRoaXMuX3JlamVjdGlvbkhhbmRsZXJBdChpbmRleCk7XG5cbiAgICB2YXIgdmFsdWUgPSB0aGlzLl9zZXR0bGVkVmFsdWU7XG4gICAgdmFyIHJlY2VpdmVyID0gdGhpcy5fcmVjZWl2ZXJBdChpbmRleCk7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLl9wcm9taXNlQXQoaW5kZXgpO1xuXG4gICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhpcy5fc2V0dGxlUHJvbWlzZUZyb21IYW5kbGVyKGhhbmRsZXIsIHJlY2VpdmVyLCB2YWx1ZSwgcHJvbWlzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGRvbmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzRnVsZmlsbGVkID0gdGhpcy5pc0Z1bGZpbGxlZCgpO1xuICAgICAgICBpZiAocmVjZWl2ZXIgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgaWYgKHJlY2VpdmVyIGluc3RhbmNlb2YgUHJvbWlzZSAmJlxuICAgICAgICAgICAgICAgIHJlY2VpdmVyLl9pc1Byb3hpZWQoKSkge1xuICAgICAgICAgICAgICAgIHJlY2VpdmVyLl91bnNldFByb3hpZWQoKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc0Z1bGZpbGxlZCkgcmVjZWl2ZXIuX2Z1bGZpbGxVbmNoZWNrZWQodmFsdWUpO1xuICAgICAgICAgICAgICAgIGVsc2UgcmVjZWl2ZXIuX3JlamVjdFVuY2hlY2tlZCh2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZ2V0Q2FycmllZFN0YWNrVHJhY2UoKSk7XG4gICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyIGluc3RhbmNlb2YgUHJvbWlzZUFycmF5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzRnVsZmlsbGVkKSByZWNlaXZlci5fcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgZWxzZSByZWNlaXZlci5fcHJvbWlzZVJlamVjdGVkKHZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZG9uZSkge1xuICAgICAgICAgICAgaWYgKGlzRnVsZmlsbGVkKSBwcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbiAgICAgICAgICAgIGVsc2UgcHJvbWlzZS5fcmVqZWN0KHZhbHVlLCB0aGlzLl9nZXRDYXJyaWVkU3RhY2tUcmFjZSgpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpbmRleCA+PSAyNTYpIHtcbiAgICAgICAgdGhpcy5fcXVldWVHQygpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc1Byb3hpZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9pc1Byb3hpZWQoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDQxOTQzMDQpID09PSA0MTk0MzA0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3NldFByb3hpZWQgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXRQcm94aWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCA0MTk0MzA0O1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3Vuc2V0UHJveGllZCA9IGZ1bmN0aW9uIFByb21pc2UkX3Vuc2V0UHJveGllZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH40MTk0MzA0KTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9pc0djUXVldWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNHY1F1ZXVlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgLTEwNzM3NDE4MjQpID09PSAtMTA3Mzc0MTgyNDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9zZXRHY1F1ZXVlZCA9IGZ1bmN0aW9uIFByb21pc2UkX3NldEdjUXVldWVkKCkge1xuICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgfCAtMTA3Mzc0MTgyNDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl91bnNldEdjUXVldWVkID0gZnVuY3Rpb24gUHJvbWlzZSRfdW5zZXRHY1F1ZXVlZCgpIHtcbiAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkICYgKH4tMTA3Mzc0MTgyNCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcXVldWVHQyA9IGZ1bmN0aW9uIFByb21pc2UkX3F1ZXVlR0MoKSB7XG4gICAgaWYgKHRoaXMuX2lzR2NRdWV1ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3NldEdjUXVldWVkKCk7XG4gICAgYXN5bmMuaW52b2tlTGF0ZXIodGhpcy5fZ2MsIHRoaXMsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fZ2MgPSBmdW5jdGlvbiBQcm9taXNlJGdjKCkge1xuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKSAqIDU7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBkZWxldGUgdGhpc1tpXTtcbiAgICB9XG4gICAgdGhpcy5fc2V0TGVuZ3RoKDApO1xuICAgIHRoaXMuX3Vuc2V0R2NRdWV1ZWQoKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9xdWV1ZVNldHRsZUF0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcXVldWVTZXR0bGVBdChpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1JlamVjdGlvblVuaGFuZGxlZCgpKSB0aGlzLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgYXN5bmMuaW52b2tlKHRoaXMuX3NldHRsZVByb21pc2VBdCwgdGhpcywgaW5kZXgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGxVbmNoZWNrZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfZnVsZmlsbFVuY2hlY2tlZCh2YWx1ZSkge1xuICAgIGlmICghdGhpcy5pc1BlbmRpbmcoKSkgcmV0dXJuO1xuICAgIGlmICh2YWx1ZSA9PT0gdGhpcykge1xuICAgICAgICB2YXIgZXJyID0gbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IoKTtcbiAgICAgICAgdGhpcy5fYXR0YWNoRXh0cmFUcmFjZShlcnIpO1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0VW5jaGVja2VkKGVyciwgdm9pZCAwKTtcbiAgICB9XG4gICAgdGhpcy5fY2xlYW5WYWx1ZXMoKTtcbiAgICB0aGlzLl9zZXRGdWxmaWxsZWQoKTtcbiAgICB0aGlzLl9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICB2YXIgbGVuID0gdGhpcy5fbGVuZ3RoKCk7XG5cbiAgICBpZiAobGVuID4gMCkge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fc2V0dGxlUHJvbWlzZXMsIHRoaXMsIGxlbik7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3JlamVjdFVuY2hlY2tlZENoZWNrRXJyb3IgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0VW5jaGVja2VkQ2hlY2tFcnJvcihyZWFzb24pIHtcbiAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2gocmVhc29uKSA/IHJlYXNvbiA6IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKTtcbiAgICB0aGlzLl9yZWplY3RVbmNoZWNrZWQocmVhc29uLCB0cmFjZSA9PT0gcmVhc29uID8gdm9pZCAwIDogdHJhY2UpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3JlamVjdFVuY2hlY2tlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9yZWplY3RVbmNoZWNrZWQocmVhc29uLCB0cmFjZSkge1xuICAgIGlmICghdGhpcy5pc1BlbmRpbmcoKSkgcmV0dXJuO1xuICAgIGlmIChyZWFzb24gPT09IHRoaXMpIHtcbiAgICAgICAgdmFyIGVyciA9IG1ha2VTZWxmUmVzb2x1dGlvbkVycm9yKCk7XG4gICAgICAgIHRoaXMuX2F0dGFjaEV4dHJhVHJhY2UoZXJyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdFVuY2hlY2tlZChlcnIpO1xuICAgIH1cbiAgICB0aGlzLl9jbGVhblZhbHVlcygpO1xuICAgIHRoaXMuX3NldFJlamVjdGVkKCk7XG4gICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gcmVhc29uO1xuXG4gICAgaWYgKHRoaXMuX2lzRmluYWwoKSkge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aHJvd2VyLCB2b2lkIDAsIHRyYWNlID09PSB2b2lkIDAgPyByZWFzb24gOiB0cmFjZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGxlbiA9IHRoaXMuX2xlbmd0aCgpO1xuXG4gICAgaWYgKHRyYWNlICE9PSB2b2lkIDApIHRoaXMuX3NldENhcnJpZWRTdGFja1RyYWNlKHRyYWNlKTtcblxuICAgIGlmIChsZW4gPiAwKSB7XG4gICAgICAgIGFzeW5jLmludm9rZSh0aGlzLl9yZWplY3RQcm9taXNlcywgdGhpcywgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fZW5zdXJlUG9zc2libGVSZWplY3Rpb25IYW5kbGVkKCk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX3JlamVjdFByb21pc2VzID0gZnVuY3Rpb24gUHJvbWlzZSRfcmVqZWN0UHJvbWlzZXMoKSB7XG4gICAgdGhpcy5fc2V0dGxlUHJvbWlzZXMoKTtcbiAgICB0aGlzLl91bnNldENhcnJpZWRTdGFja1RyYWNlKCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZXMgPSBmdW5jdGlvbiBQcm9taXNlJF9zZXR0bGVQcm9taXNlcygpIHtcbiAgICB2YXIgbGVuID0gdGhpcy5fbGVuZ3RoKCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB0aGlzLl9zZXR0bGVQcm9taXNlQXQoaSk7XG4gICAgfVxufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2Vuc3VyZVBvc3NpYmxlUmVqZWN0aW9uSGFuZGxlZCA9XG5mdW5jdGlvbiBQcm9taXNlJF9lbnN1cmVQb3NzaWJsZVJlamVjdGlvbkhhbmRsZWQoKSB7XG4gICAgdGhpcy5fc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICBpZiAoQ2FwdHVyZWRUcmFjZS5wb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGFzeW5jLmludm9rZUxhdGVyKHRoaXMuX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbiwgdGhpcywgdm9pZCAwKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uSXNIYW5kbGVkID1cbmZ1bmN0aW9uIFByb21pc2UkX25vdGlmeVVuaGFuZGxlZFJlamVjdGlvbklzSGFuZGxlZCgpIHtcbiAgICBpZiAodHlwZW9mIHVuaGFuZGxlZFJlamVjdGlvbkhhbmRsZWQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih1bmhhbmRsZWRSZWplY3Rpb25IYW5kbGVkLCB2b2lkIDAsIHRoaXMpO1xuICAgIH1cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9ub3RpZnlVbmhhbmRsZWRSZWplY3Rpb24gPVxuZnVuY3Rpb24gUHJvbWlzZSRfbm90aWZ5VW5oYW5kbGVkUmVqZWN0aW9uKCkge1xuICAgIGlmICh0aGlzLl9pc1JlamVjdGlvblVuaGFuZGxlZCgpKSB7XG4gICAgICAgIHZhciByZWFzb24gPSB0aGlzLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgIHZhciB0cmFjZSA9IHRoaXMuX2dldENhcnJpZWRTdGFja1RyYWNlKCk7XG5cbiAgICAgICAgdGhpcy5fc2V0VW5oYW5kbGVkUmVqZWN0aW9uSXNOb3RpZmllZCgpO1xuXG4gICAgICAgIGlmICh0cmFjZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICB0aGlzLl91bnNldENhcnJpZWRTdGFja1RyYWNlKCk7XG4gICAgICAgICAgICByZWFzb24gPSB0cmFjZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIENhcHR1cmVkVHJhY2UucG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgQ2FwdHVyZWRUcmFjZS5wb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbihyZWFzb24sIHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIGNvbnRleHRTdGFjayA9IFtdO1xuUHJvbWlzZS5wcm90b3R5cGUuX3BlZWtDb250ZXh0ID0gZnVuY3Rpb24gUHJvbWlzZSRfcGVla0NvbnRleHQoKSB7XG4gICAgdmFyIGxhc3RJbmRleCA9IGNvbnRleHRTdGFjay5sZW5ndGggLSAxO1xuICAgIGlmIChsYXN0SW5kZXggPj0gMCkge1xuICAgICAgICByZXR1cm4gY29udGV4dFN0YWNrW2xhc3RJbmRleF07XG4gICAgfVxuICAgIHJldHVybiB2b2lkIDA7XG5cbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wdXNoQ29udGV4dCA9IGZ1bmN0aW9uIFByb21pc2UkX3B1c2hDb250ZXh0KCkge1xuICAgIGlmICghZGVidWdnaW5nKSByZXR1cm47XG4gICAgY29udGV4dFN0YWNrLnB1c2godGhpcyk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcG9wQ29udGV4dCA9IGZ1bmN0aW9uIFByb21pc2UkX3BvcENvbnRleHQoKSB7XG4gICAgaWYgKCFkZWJ1Z2dpbmcpIHJldHVybjtcbiAgICBjb250ZXh0U3RhY2sucG9wKCk7XG59O1xuXG5Qcm9taXNlLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiBQcm9taXNlJE5vQ29uZmxpY3QoKSB7XG4gICAgcmV0dXJuIG5vQ29uZmxpY3QoUHJvbWlzZSk7XG59O1xuXG5Qcm9taXNlLnNldFNjaGVkdWxlciA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZm4gbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO1xuICAgIGFzeW5jLl9zY2hlZHVsZSA9IGZuO1xufTtcblxuaWYgKCFDYXB0dXJlZFRyYWNlLmlzU3VwcG9ydGVkKCkpIHtcbiAgICBQcm9taXNlLmxvbmdTdGFja1RyYWNlcyA9IGZ1bmN0aW9uKCl7fTtcbiAgICBkZWJ1Z2dpbmcgPSBmYWxzZTtcbn1cblxuUHJvbWlzZS5fbWFrZVNlbGZSZXNvbHV0aW9uRXJyb3IgPSBtYWtlU2VsZlJlc29sdXRpb25FcnJvcjtcbnJlcXVpcmUoXCIuL2ZpbmFsbHkuanNcIikoUHJvbWlzZSwgTkVYVF9GSUxURVIsIGNhc3QpO1xucmVxdWlyZShcIi4vZGlyZWN0X3Jlc29sdmUuanNcIikoUHJvbWlzZSk7XG5yZXF1aXJlKFwiLi9zeW5jaHJvbm91c19pbnNwZWN0aW9uLmpzXCIpKFByb21pc2UpO1xucmVxdWlyZShcIi4vam9pbi5qc1wiKShQcm9taXNlLCBQcm9taXNlQXJyYXksIGNhc3QsIElOVEVSTkFMKTtcblByb21pc2UuUmFuZ2VFcnJvciA9IFJhbmdlRXJyb3I7XG5Qcm9taXNlLkNhbmNlbGxhdGlvbkVycm9yID0gQ2FuY2VsbGF0aW9uRXJyb3I7XG5Qcm9taXNlLlRpbWVvdXRFcnJvciA9IFRpbWVvdXRFcnJvcjtcblByb21pc2UuVHlwZUVycm9yID0gVHlwZUVycm9yO1xuUHJvbWlzZS5PcGVyYXRpb25hbEVycm9yID0gT3BlcmF0aW9uYWxFcnJvcjtcblByb21pc2UuUmVqZWN0aW9uRXJyb3IgPSBPcGVyYXRpb25hbEVycm9yO1xuUHJvbWlzZS5BZ2dyZWdhdGVFcnJvciA9IGVycm9ycy5BZ2dyZWdhdGVFcnJvcjtcblxudXRpbC50b0Zhc3RQcm9wZXJ0aWVzKFByb21pc2UpO1xudXRpbC50b0Zhc3RQcm9wZXJ0aWVzKFByb21pc2UucHJvdG90eXBlKTtcblByb21pc2UuUHJvbWlzZSA9IFByb21pc2U7XG5yZXF1aXJlKCcuL3RpbWVycy5qcycpKFByb21pc2UsSU5URVJOQUwsY2FzdCk7XG5yZXF1aXJlKCcuL3JhY2UuanMnKShQcm9taXNlLElOVEVSTkFMLGNhc3QpO1xucmVxdWlyZSgnLi9jYWxsX2dldC5qcycpKFByb21pc2UpO1xucmVxdWlyZSgnLi9nZW5lcmF0b3JzLmpzJykoUHJvbWlzZSxhcGlSZWplY3Rpb24sSU5URVJOQUwsY2FzdCk7XG5yZXF1aXJlKCcuL21hcC5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5LGFwaVJlamVjdGlvbixjYXN0LElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vbm9kZWlmeS5qcycpKFByb21pc2UpO1xucmVxdWlyZSgnLi9wcm9taXNpZnkuanMnKShQcm9taXNlLElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vcHJvcHMuanMnKShQcm9taXNlLFByb21pc2VBcnJheSxjYXN0KTtcbnJlcXVpcmUoJy4vcmVkdWNlLmpzJykoUHJvbWlzZSxQcm9taXNlQXJyYXksYXBpUmVqZWN0aW9uLGNhc3QsSU5URVJOQUwpO1xucmVxdWlyZSgnLi9zZXR0bGUuanMnKShQcm9taXNlLFByb21pc2VBcnJheSk7XG5yZXF1aXJlKCcuL3NvbWUuanMnKShQcm9taXNlLFByb21pc2VBcnJheSxhcGlSZWplY3Rpb24pO1xucmVxdWlyZSgnLi9wcm9ncmVzcy5qcycpKFByb21pc2UsUHJvbWlzZUFycmF5KTtcbnJlcXVpcmUoJy4vY2FuY2VsLmpzJykoUHJvbWlzZSxJTlRFUk5BTCk7XG5yZXF1aXJlKCcuL2ZpbHRlci5qcycpKFByb21pc2UsSU5URVJOQUwpO1xucmVxdWlyZSgnLi9hbnkuanMnKShQcm9taXNlLFByb21pc2VBcnJheSk7XG5yZXF1aXJlKCcuL2VhY2guanMnKShQcm9taXNlLElOVEVSTkFMKTtcbnJlcXVpcmUoJy4vdXNpbmcuanMnKShQcm9taXNlLGFwaVJlamVjdGlvbixjYXN0KTtcblxuUHJvbWlzZS5wcm90b3R5cGUgPSBQcm9taXNlLnByb3RvdHlwZTtcbnJldHVybiBQcm9taXNlO1xuXG59O1xuXG59KShyZXF1aXJlKFwiX19icm93c2VyaWZ5X3Byb2Nlc3NcIikpIiwiKGZ1bmN0aW9uKCl7LypnbG9iYWwgcmVxdWlyZTogZmFsc2UsIG1vZHVsZTogZmFsc2UgKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIC8qKlxuICAgKiBBIGJhc2ljIFJlZiBzZXJ2ZXMgYXMgYSBtZWFucyBvZiBpbmRpcmVjdGlvbiBiZXR3ZWVuIHJlZmVyZW5jZXMgYW5kIHRoZWlyXG4gICAqIHZhbHVlcywgYWxsb3dpbmcgYW4gb3V0c2lkZSBhZ2VudCB0byBtb2RpZnkgdGhlIHVuZGVybHlpbmcgdmFsdWUuXG4gICAqL1xuICB2YXIgUmVmID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoUmVmLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgdGhpcy5fdmFsID0gdmFsO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHZhbHVlIGJveGVkIGJ5IHRoaXMgUmVmXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7ZHluYW1pY31cbiAgICAgKi9cbiAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3ZhbDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IGEgbmV3IGJveGVkIHZhbHVlLiBOb3RlIHRoaXMgbWV0aG9kIGlzIHNwZWNpZmljIHRvIHRoaXMgUmVmXG4gICAgICogaW1wbGVtZW50YXRpb24sIGFuZCBub3QgdGhlIFJlZiBwcm90b2NvbCwgd2hpY2ggb25seSBkZWZpbmVzXG4gICAgICogYFJlZiNnZXQoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmV3VmFsIHtkeW5hbWljfSB0aGUgdmFsdWUgdG8gYm94XG4gICAgICovXG4gICAgc2V0OiBmdW5jdGlvbihuZXdWYWwpIHtcbiAgICAgIGlmIChuZXdWYWwgaW5zdGFuY2VvZiBSZWYpIHtcbiAgICAgICAgdGhpcy5fdmFsID0gbmV3VmFsLmdldCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fdmFsID0gbmV3VmFsO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIFJlZjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbW9kKFxuICByZXF1aXJlKFwidW5kZXJzY29yZVwiKVxuKTtcblxufSkoKSIsIihmdW5jdGlvbigpey8qZ2xvYmFsIHJlcXVpcmU6IGZhbHNlLCBtb2R1bGU6IGZhbHNlICovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIG1vZCA9IGZ1bmN0aW9uKFxuICBfXG4pIHtcblxuICAvKipcbiAgICogQSByZWYgd2hvc2UgYm94ZWQgdmFsdWUgaXMgYW5vdGhlciByZWZcbiAgICovXG4gIHZhciBEZWxlZ2F0aW5nUmVmID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH07XG5cbiAgXy5leHRlbmQoRGVsZWdhdGluZ1JlZi5wcm90b3R5cGUsIHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihyZWYpIHtcbiAgICAgIHRoaXMuX2RlbGVnYXRlUmVmID0gcmVmO1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl9kZWxlZ2F0ZVJlZi5nZXQoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBEZWxlZ2F0aW5nUmVmO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuXG59KSgpIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xuZnVuY3Rpb24gUHJvbWlzZUluc3BlY3Rpb24ocHJvbWlzZSkge1xuICAgIGlmIChwcm9taXNlICE9PSB2b2lkIDApIHtcbiAgICAgICAgdGhpcy5fYml0RmllbGQgPSBwcm9taXNlLl9iaXRGaWVsZDtcbiAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gcHJvbWlzZS5pc1Jlc29sdmVkKClcbiAgICAgICAgICAgID8gcHJvbWlzZS5fc2V0dGxlZFZhbHVlXG4gICAgICAgICAgICA6IHZvaWQgMDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gMDtcbiAgICAgICAgdGhpcy5fc2V0dGxlZFZhbHVlID0gdm9pZCAwO1xuICAgIH1cbn1cblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmlzRnVsZmlsbGVkID1cblByb21pc2UucHJvdG90eXBlLmlzRnVsZmlsbGVkID0gZnVuY3Rpb24gUHJvbWlzZSRpc0Z1bGZpbGxlZCgpIHtcbiAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMjY4NDM1NDU2KSA+IDA7XG59O1xuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuaXNSZWplY3RlZCA9XG5Qcm9taXNlLnByb3RvdHlwZS5pc1JlamVjdGVkID0gZnVuY3Rpb24gUHJvbWlzZSRpc1JlamVjdGVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiAxMzQyMTc3MjgpID4gMDtcbn07XG5cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5pc1BlbmRpbmcgPVxuUHJvbWlzZS5wcm90b3R5cGUuaXNQZW5kaW5nID0gZnVuY3Rpb24gUHJvbWlzZSRpc1BlbmRpbmcoKSB7XG4gICAgcmV0dXJuICh0aGlzLl9iaXRGaWVsZCAmIDQwMjY1MzE4NCkgPT09IDA7XG59O1xuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUudmFsdWUgPVxuUHJvbWlzZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiBQcm9taXNlJHZhbHVlKCkge1xuICAgIGlmICghdGhpcy5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJjYW5ub3QgZ2V0IGZ1bGZpbGxtZW50IHZhbHVlIG9mIGEgbm9uLWZ1bGZpbGxlZCBwcm9taXNlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fc2V0dGxlZFZhbHVlO1xufTtcblxuUHJvbWlzZUluc3BlY3Rpb24ucHJvdG90eXBlLmVycm9yID1cblByb21pc2VJbnNwZWN0aW9uLnByb3RvdHlwZS5yZWFzb24gPVxuUHJvbWlzZS5wcm90b3R5cGUucmVhc29uID0gZnVuY3Rpb24gUHJvbWlzZSRyZWFzb24oKSB7XG4gICAgaWYgKCF0aGlzLmlzUmVqZWN0ZWQoKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2Fubm90IGdldCByZWplY3Rpb24gcmVhc29uIG9mIGEgbm9uLXJlamVjdGVkIHByb21pc2VcIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9zZXR0bGVkVmFsdWU7XG59O1xuXG5Qcm9taXNlSW5zcGVjdGlvbi5wcm90b3R5cGUuaXNSZXNvbHZlZCA9XG5Qcm9taXNlLnByb3RvdHlwZS5pc1Jlc29sdmVkID0gZnVuY3Rpb24gUHJvbWlzZSRpc1Jlc29sdmVkKCkge1xuICAgIHJldHVybiAodGhpcy5fYml0RmllbGQgJiA0MDI2NTMxODQpID4gMDtcbn07XG5cblByb21pc2UuUHJvbWlzZUluc3BlY3Rpb24gPSBQcm9taXNlSW5zcGVjdGlvbjtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCkge1xudmFyIFByb21pc2VNYXAgPSBQcm9taXNlLm1hcDtcblxuUHJvbWlzZS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gUHJvbWlzZSRmaWx0ZXIoZm4sIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gUHJvbWlzZU1hcCh0aGlzLCBmbiwgb3B0aW9ucywgSU5URVJOQUwpO1xufTtcblxuUHJvbWlzZS5maWx0ZXIgPSBmdW5jdGlvbiBQcm9taXNlJEZpbHRlcihwcm9taXNlcywgZm4sIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gUHJvbWlzZU1hcChwcm9taXNlcywgZm4sIG9wdGlvbnMsIElOVEVSTkFMKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIFNvbWVQcm9taXNlQXJyYXkgPSBQcm9taXNlLl9Tb21lUHJvbWlzZUFycmF5O1xuZnVuY3Rpb24gUHJvbWlzZSRfQW55KHByb21pc2VzKSB7XG4gICAgdmFyIHJldCA9IG5ldyBTb21lUHJvbWlzZUFycmF5KHByb21pc2VzKTtcbiAgICB2YXIgcHJvbWlzZSA9IHJldC5wcm9taXNlKCk7XG4gICAgaWYgKHByb21pc2UuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICByZXQuc2V0SG93TWFueSgxKTtcbiAgICByZXQuc2V0VW53cmFwKCk7XG4gICAgcmV0LmluaXQoKTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cblxuUHJvbWlzZS5hbnkgPSBmdW5jdGlvbiBQcm9taXNlJEFueShwcm9taXNlcykge1xuICAgIHJldHVybiBQcm9taXNlJF9BbnkocHJvbWlzZXMpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuYW55ID0gZnVuY3Rpb24gUHJvbWlzZSRhbnkoKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX0FueSh0aGlzKTtcbn07XG5cbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCkge1xudmFyIFByb21pc2VSZWR1Y2UgPSBQcm9taXNlLnJlZHVjZTtcblxuUHJvbWlzZS5wcm90b3R5cGUuZWFjaCA9IGZ1bmN0aW9uIFByb21pc2UkZWFjaChmbikge1xuICAgIHJldHVybiBQcm9taXNlUmVkdWNlKHRoaXMsIGZuLCBudWxsLCBJTlRFUk5BTCk7XG59O1xuXG5Qcm9taXNlLmVhY2ggPSBmdW5jdGlvbiBQcm9taXNlJEVhY2gocHJvbWlzZXMsIGZuKSB7XG4gICAgcmV0dXJuIFByb21pc2VSZWR1Y2UocHJvbWlzZXMsIGZuLCBudWxsLCBJTlRFUk5BTCk7XG59O1xufTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgbW9kID0gZnVuY3Rpb24oXG4gIF9cbikge1xuXG4gIHZhciBTZXRUaW1lb3V0U2NoZWR1bGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICBfLmV4dGVuZChTZXRUaW1lb3V0U2NoZWR1bGVyLnByb3RvdHlwZSwge1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge30sXG5cbiAgICBydW5Tb29uOiBmdW5jdGlvbihmbikge1xuICAgICAgdGhpcy5zY2hlZHVsZShmbik7XG4gICAgfSxcblxuICAgIHNjaGVkdWxlOiBmdW5jdGlvbihmbiwgZGVsYXkpIHtcbiAgICAgIGRlbGF5ID0gZGVsYXkgfHwgMTtcbiAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZuLCBkZWxheSk7XG4gICAgfSxcblxuICAgIHVuc2NoZWR1bGU6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KGlkKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBTZXRUaW1lb3V0U2NoZWR1bGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBtb2QoXG4gIHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpXG4pO1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBlczUgPSByZXF1aXJlKFwiLi9lczUuanNcIik7XG52YXIgaGF2ZUdldHRlcnMgPSAoZnVuY3Rpb24oKXtcbiAgICB0cnkge1xuICAgICAgICB2YXIgbyA9IHt9O1xuICAgICAgICBlczUuZGVmaW5lUHJvcGVydHkobywgXCJmXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG8uZiA9PT0gMztcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxufSkoKTtcbnZhciBjYW5FdmFsdWF0ZSA9IHR5cGVvZiBuYXZpZ2F0b3IgPT0gXCJ1bmRlZmluZWRcIjtcbnZhciBlcnJvck9iaiA9IHtlOiB7fX07XG5mdW5jdGlvbiB0cnlDYXRjaDEoZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaDIoZm4sIHJlY2VpdmVyLCBhcmcsIGFyZzIpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnLCBhcmcyKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaDMoZm4sIHJlY2VpdmVyLCBhcmcsIGFyZzIsIGFyZzMpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnLCBhcmcyLCBhcmczKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaDQoZm4sIHJlY2VpdmVyLCBhcmcsIGFyZzIsIGFyZzMsIGFyZzQpIHtcbiAgICB0cnkgeyByZXR1cm4gZm4uY2FsbChyZWNlaXZlciwgYXJnLCBhcmcyLCBhcmczLCBhcmc0KTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBlO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0cnlDYXRjaEFwcGx5KGZuLCBhcmdzLCByZWNlaXZlcikge1xuICAgIHRyeSB7IHJldHVybiBmbi5hcHBseShyZWNlaXZlciwgYXJncyk7IH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxudmFyIGluaGVyaXRzID0gZnVuY3Rpb24oQ2hpbGQsIFBhcmVudCkge1xuICAgIHZhciBoYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHk7XG5cbiAgICBmdW5jdGlvbiBUKCkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yID0gQ2hpbGQ7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3IkID0gUGFyZW50O1xuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eU5hbWUgaW4gUGFyZW50LnByb3RvdHlwZSkge1xuICAgICAgICAgICAgaWYgKGhhc1Byb3AuY2FsbChQYXJlbnQucHJvdG90eXBlLCBwcm9wZXJ0eU5hbWUpICYmXG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lLmNoYXJBdChwcm9wZXJ0eU5hbWUubGVuZ3RoLTEpICE9PSBcIiRcIlxuICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BlcnR5TmFtZSArIFwiJFwiXSA9IFBhcmVudC5wcm90b3R5cGVbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBULnByb3RvdHlwZSA9IFBhcmVudC5wcm90b3R5cGU7XG4gICAgQ2hpbGQucHJvdG90eXBlID0gbmV3IFQoKTtcbiAgICByZXR1cm4gQ2hpbGQucHJvdG90eXBlO1xufTtcblxuZnVuY3Rpb24gYXNTdHJpbmcodmFsKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIgPyB2YWwgOiAoXCJcIiArIHZhbCk7XG59XG5cbmZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbCkge1xuICAgIHJldHVybiB2YWwgPT0gbnVsbCB8fCB2YWwgPT09IHRydWUgfHwgdmFsID09PSBmYWxzZSB8fFxuICAgICAgICB0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiB2YWwgPT09IFwibnVtYmVyXCI7XG5cbn1cblxuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gIWlzUHJpbWl0aXZlKHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gbWF5YmVXcmFwQXNFcnJvcihtYXliZUVycm9yKSB7XG4gICAgaWYgKCFpc1ByaW1pdGl2ZShtYXliZUVycm9yKSkgcmV0dXJuIG1heWJlRXJyb3I7XG5cbiAgICByZXR1cm4gbmV3IEVycm9yKGFzU3RyaW5nKG1heWJlRXJyb3IpKTtcbn1cblxuZnVuY3Rpb24gd2l0aEFwcGVuZGVkKHRhcmdldCwgYXBwZW5kZWUpIHtcbiAgICB2YXIgbGVuID0gdGFyZ2V0Lmxlbmd0aDtcbiAgICB2YXIgcmV0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgICByZXRbaV0gPSB0YXJnZXRbaV07XG4gICAgfVxuICAgIHJldFtpXSA9IGFwcGVuZGVlO1xuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdChvYmosIGtleSwgZGVmYXVsdFZhbHVlKSB7XG4gICAgaWYgKGVzNS5pc0VTNSkge1xuICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpO1xuICAgICAgICBpZiAoZGVzYyAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVzYy5nZXQgPT0gbnVsbCAmJiBkZXNjLnNldCA9PSBudWxsXG4gICAgICAgICAgICAgICAgICAgID8gZGVzYy52YWx1ZVxuICAgICAgICAgICAgICAgICAgICA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSA/IG9ialtrZXldIDogdm9pZCAwO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbm90RW51bWVyYWJsZVByb3Aob2JqLCBuYW1lLCB2YWx1ZSkge1xuICAgIGlmIChpc1ByaW1pdGl2ZShvYmopKSByZXR1cm4gb2JqO1xuICAgIHZhciBkZXNjcmlwdG9yID0ge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfTtcbiAgICBlczUuZGVmaW5lUHJvcGVydHkob2JqLCBuYW1lLCBkZXNjcmlwdG9yKTtcbiAgICByZXR1cm4gb2JqO1xufVxuXG5cbnZhciB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyID0gKGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzICE9PSBcInN0cmluZ1wiO1xufSkuY2FsbChcInN0cmluZ1wiKTtcblxuZnVuY3Rpb24gdGhyb3dlcihyKSB7XG4gICAgdGhyb3cgcjtcbn1cblxudmFyIGluaGVyaXRlZERhdGFLZXlzID0gKGZ1bmN0aW9uKCkge1xuICAgIGlmIChlczUuaXNFUzUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgb3B0cykge1xuICAgICAgICAgICAgdmFyIHJldCA9IFtdO1xuICAgICAgICAgICAgdmFyIHZpc2l0ZWRLZXlzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgICAgIHZhciBnZXRLZXlzID0gT2JqZWN0KG9wdHMpLmluY2x1ZGVIaWRkZW5cbiAgICAgICAgICAgICAgICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzXG4gICAgICAgICAgICAgICAgOiBPYmplY3Qua2V5cztcbiAgICAgICAgICAgIHdoaWxlIChvYmogIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBrZXlzO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGtleXMgPSBnZXRLZXlzKG9iaik7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aXNpdGVkS2V5c1trZXldKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgdmlzaXRlZEtleXNba2V5XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXNjICE9IG51bGwgJiYgZGVzYy5nZXQgPT0gbnVsbCAmJiBkZXNjLnNldCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXQucHVzaChrZXkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9iaiA9IGVzNS5nZXRQcm90b3R5cGVPZihvYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgICAgICAvKmpzaGludCBmb3JpbjpmYWxzZSAqL1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9O1xuICAgIH1cblxufSkoKTtcblxuZnVuY3Rpb24gaXNDbGFzcyhmbikge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgZm4gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIGtleXMgPSBlczUua2V5cyhmbi5wcm90b3R5cGUpO1xuICAgICAgICAgICAgcmV0dXJuIGtleXMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgICAgICAgICAgICEoa2V5cy5sZW5ndGggPT09IDEgJiYga2V5c1swXSA9PT0gXCJjb25zdHJ1Y3RvclwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0b0Zhc3RQcm9wZXJ0aWVzKG9iaikge1xuICAgIC8qanNoaW50IC1XMDI3Ki9cbiAgICBmdW5jdGlvbiBmKCkge31cbiAgICBmLnByb3RvdHlwZSA9IG9iajtcbiAgICByZXR1cm4gZjtcbiAgICBldmFsKG9iaik7XG59XG5cbnZhciByaWRlbnQgPSAvXlthLXokX11bYS16JF8wLTldKiQvaTtcbmZ1bmN0aW9uIGlzSWRlbnRpZmllcihzdHIpIHtcbiAgICByZXR1cm4gcmlkZW50LnRlc3Qoc3RyKTtcbn1cblxuZnVuY3Rpb24gZmlsbGVkUmFuZ2UoY291bnQsIHByZWZpeCwgc3VmZml4KSB7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShjb3VudCk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGNvdW50OyArK2kpIHtcbiAgICAgICAgcmV0W2ldID0gcHJlZml4ICsgaSArIHN1ZmZpeDtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxudmFyIHJldCA9IHtcbiAgICBpc0NsYXNzOiBpc0NsYXNzLFxuICAgIGlzSWRlbnRpZmllcjogaXNJZGVudGlmaWVyLFxuICAgIGluaGVyaXRlZERhdGFLZXlzOiBpbmhlcml0ZWREYXRhS2V5cyxcbiAgICBnZXREYXRhUHJvcGVydHlPckRlZmF1bHQ6IGdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdCxcbiAgICB0aHJvd2VyOiB0aHJvd2VyLFxuICAgIGlzQXJyYXk6IGVzNS5pc0FycmF5LFxuICAgIGhhdmVHZXR0ZXJzOiBoYXZlR2V0dGVycyxcbiAgICBub3RFbnVtZXJhYmxlUHJvcDogbm90RW51bWVyYWJsZVByb3AsXG4gICAgaXNQcmltaXRpdmU6IGlzUHJpbWl0aXZlLFxuICAgIGlzT2JqZWN0OiBpc09iamVjdCxcbiAgICBjYW5FdmFsdWF0ZTogY2FuRXZhbHVhdGUsXG4gICAgZXJyb3JPYmo6IGVycm9yT2JqLFxuICAgIHRyeUNhdGNoMTogdHJ5Q2F0Y2gxLFxuICAgIHRyeUNhdGNoMjogdHJ5Q2F0Y2gyLFxuICAgIHRyeUNhdGNoMzogdHJ5Q2F0Y2gzLFxuICAgIHRyeUNhdGNoNDogdHJ5Q2F0Y2g0LFxuICAgIHRyeUNhdGNoQXBwbHk6IHRyeUNhdGNoQXBwbHksXG4gICAgaW5oZXJpdHM6IGluaGVyaXRzLFxuICAgIHdpdGhBcHBlbmRlZDogd2l0aEFwcGVuZGVkLFxuICAgIGFzU3RyaW5nOiBhc1N0cmluZyxcbiAgICBtYXliZVdyYXBBc0Vycm9yOiBtYXliZVdyYXBBc0Vycm9yLFxuICAgIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXI6IHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIsXG4gICAgdG9GYXN0UHJvcGVydGllczogdG9GYXN0UHJvcGVydGllcyxcbiAgICBmaWxsZWRSYW5nZTogZmlsbGVkUmFuZ2Vcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcmV0O1xuIiwiKGZ1bmN0aW9uKHByb2Nlc3Mpey8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgc2NoZWR1bGUgPSByZXF1aXJlKFwiLi9zY2hlZHVsZS5qc1wiKTtcbnZhciBRdWV1ZSA9IHJlcXVpcmUoXCIuL3F1ZXVlLmpzXCIpO1xudmFyIGVycm9yT2JqID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5lcnJvck9iajtcbnZhciB0cnlDYXRjaDEgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLnRyeUNhdGNoMTtcbnZhciBfcHJvY2VzcyA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiID8gcHJvY2VzcyA6IHZvaWQgMDtcblxuZnVuY3Rpb24gQXN5bmMoKSB7XG4gICAgdGhpcy5faXNUaWNrVXNlZCA9IGZhbHNlO1xuICAgIHRoaXMuX3NjaGVkdWxlID0gc2NoZWR1bGU7XG4gICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICB0aGlzLl9sYXRlQnVmZmVyID0gbmV3IFF1ZXVlKDE2KTtcbiAgICB0aGlzLl9mdW5jdGlvbkJ1ZmZlciA9IG5ldyBRdWV1ZSg2NTUzNik7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuY29uc3VtZUZ1bmN0aW9uQnVmZmVyID0gZnVuY3Rpb24gQXN5bmMkY29uc3VtZUZ1bmN0aW9uQnVmZmVyKCkge1xuICAgICAgICBzZWxmLl9jb25zdW1lRnVuY3Rpb25CdWZmZXIoKTtcbiAgICB9O1xufVxuXG5Bc3luYy5wcm90b3R5cGUuaGF2ZUl0ZW1zUXVldWVkID0gZnVuY3Rpb24gQXN5bmMkaGF2ZUl0ZW1zUXVldWVkKCkge1xuICAgIHJldHVybiB0aGlzLl9sZW5ndGggPiAwO1xufTtcblxuQXN5bmMucHJvdG90eXBlLmludm9rZUxhdGVyID0gZnVuY3Rpb24gQXN5bmMkaW52b2tlTGF0ZXIoZm4sIHJlY2VpdmVyLCBhcmcpIHtcbiAgICBpZiAoX3Byb2Nlc3MgIT09IHZvaWQgMCAmJlxuICAgICAgICBfcHJvY2Vzcy5kb21haW4gIT0gbnVsbCAmJlxuICAgICAgICAhZm4uZG9tYWluKSB7XG4gICAgICAgIGZuID0gX3Byb2Nlc3MuZG9tYWluLmJpbmQoZm4pO1xuICAgIH1cbiAgICB0aGlzLl9sYXRlQnVmZmVyLnB1c2goZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgIHRoaXMuX3F1ZXVlVGljaygpO1xufTtcblxuQXN5bmMucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uIEFzeW5jJGludm9rZShmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgIGlmIChfcHJvY2VzcyAhPT0gdm9pZCAwICYmXG4gICAgICAgIF9wcm9jZXNzLmRvbWFpbiAhPSBudWxsICYmXG4gICAgICAgICFmbi5kb21haW4pIHtcbiAgICAgICAgZm4gPSBfcHJvY2Vzcy5kb21haW4uYmluZChmbik7XG4gICAgfVxuICAgIHZhciBmdW5jdGlvbkJ1ZmZlciA9IHRoaXMuX2Z1bmN0aW9uQnVmZmVyO1xuICAgIGZ1bmN0aW9uQnVmZmVyLnB1c2goZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgIHRoaXMuX2xlbmd0aCA9IGZ1bmN0aW9uQnVmZmVyLmxlbmd0aCgpO1xuICAgIHRoaXMuX3F1ZXVlVGljaygpO1xufTtcblxuQXN5bmMucHJvdG90eXBlLl9jb25zdW1lRnVuY3Rpb25CdWZmZXIgPVxuZnVuY3Rpb24gQXN5bmMkX2NvbnN1bWVGdW5jdGlvbkJ1ZmZlcigpIHtcbiAgICB2YXIgZnVuY3Rpb25CdWZmZXIgPSB0aGlzLl9mdW5jdGlvbkJ1ZmZlcjtcbiAgICB3aGlsZSAoZnVuY3Rpb25CdWZmZXIubGVuZ3RoKCkgPiAwKSB7XG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uQnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciByZWNlaXZlciA9IGZ1bmN0aW9uQnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciBhcmcgPSBmdW5jdGlvbkJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICBmbi5jYWxsKHJlY2VpdmVyLCBhcmcpO1xuICAgIH1cbiAgICB0aGlzLl9yZXNldCgpO1xuICAgIHRoaXMuX2NvbnN1bWVMYXRlQnVmZmVyKCk7XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX2NvbnN1bWVMYXRlQnVmZmVyID0gZnVuY3Rpb24gQXN5bmMkX2NvbnN1bWVMYXRlQnVmZmVyKCkge1xuICAgIHZhciBidWZmZXIgPSB0aGlzLl9sYXRlQnVmZmVyO1xuICAgIHdoaWxlKGJ1ZmZlci5sZW5ndGgoKSA+IDApIHtcbiAgICAgICAgdmFyIGZuID0gYnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciByZWNlaXZlciA9IGJ1ZmZlci5zaGlmdCgpO1xuICAgICAgICB2YXIgYXJnID0gYnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgIHZhciByZXMgPSB0cnlDYXRjaDEoZm4sIHJlY2VpdmVyLCBhcmcpO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgdGhpcy5fcXVldWVUaWNrKCk7XG4gICAgICAgICAgICBpZiAoZm4uZG9tYWluICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBmbi5kb21haW4uZW1pdChcImVycm9yXCIsIHJlcy5lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgcmVzLmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX3F1ZXVlVGljayA9IGZ1bmN0aW9uIEFzeW5jJF9xdWV1ZSgpIHtcbiAgICBpZiAoIXRoaXMuX2lzVGlja1VzZWQpIHtcbiAgICAgICAgdGhpcy5fc2NoZWR1bGUodGhpcy5jb25zdW1lRnVuY3Rpb25CdWZmZXIpO1xuICAgICAgICB0aGlzLl9pc1RpY2tVc2VkID0gdHJ1ZTtcbiAgICB9XG59O1xuXG5Bc3luYy5wcm90b3R5cGUuX3Jlc2V0ID0gZnVuY3Rpb24gQXN5bmMkX3Jlc2V0KCkge1xuICAgIHRoaXMuX2lzVGlja1VzZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9sZW5ndGggPSAwO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgQXN5bmMoKTtcblxufSkocmVxdWlyZShcIl9fYnJvd3NlcmlmeV9wcm9jZXNzXCIpKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgT2JqZWN0ZnJlZXplID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpLmZyZWV6ZTtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBpbmhlcml0cyA9IHV0aWwuaW5oZXJpdHM7XG52YXIgbm90RW51bWVyYWJsZVByb3AgPSB1dGlsLm5vdEVudW1lcmFibGVQcm9wO1xuXG5mdW5jdGlvbiBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24oZSkge1xuICAgIHRyeSB7XG4gICAgICAgIG5vdEVudW1lcmFibGVQcm9wKGUsIFwiaXNPcGVyYXRpb25hbFwiLCB0cnVlKTtcbiAgICB9XG4gICAgY2F0Y2goaWdub3JlKSB7fVxufVxuXG5mdW5jdGlvbiBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbihlKSB7XG4gICAgaWYgKGUgPT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiAoKGUgaW5zdGFuY2VvZiBPcGVyYXRpb25hbEVycm9yKSB8fFxuICAgICAgICBlW1wiaXNPcGVyYXRpb25hbFwiXSA9PT0gdHJ1ZSk7XG59XG5cbmZ1bmN0aW9uIGlzRXJyb3Iob2JqKSB7XG4gICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIEVycm9yO1xufVxuXG5mdW5jdGlvbiBjYW5BdHRhY2gob2JqKSB7XG4gICAgcmV0dXJuIGlzRXJyb3Iob2JqKTtcbn1cblxuZnVuY3Rpb24gc3ViRXJyb3IobmFtZVByb3BlcnR5LCBkZWZhdWx0TWVzc2FnZSkge1xuICAgIGZ1bmN0aW9uIFN1YkVycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFN1YkVycm9yKSkgcmV0dXJuIG5ldyBTdWJFcnJvcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gdHlwZW9mIG1lc3NhZ2UgPT09IFwic3RyaW5nXCIgPyBtZXNzYWdlIDogZGVmYXVsdE1lc3NhZ2U7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWVQcm9wZXJ0eTtcbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbmhlcml0cyhTdWJFcnJvciwgRXJyb3IpO1xuICAgIHJldHVybiBTdWJFcnJvcjtcbn1cblxudmFyIF9UeXBlRXJyb3IsIF9SYW5nZUVycm9yO1xudmFyIENhbmNlbGxhdGlvbkVycm9yID0gc3ViRXJyb3IoXCJDYW5jZWxsYXRpb25FcnJvclwiLCBcImNhbmNlbGxhdGlvbiBlcnJvclwiKTtcbnZhciBUaW1lb3V0RXJyb3IgPSBzdWJFcnJvcihcIlRpbWVvdXRFcnJvclwiLCBcInRpbWVvdXQgZXJyb3JcIik7XG52YXIgQWdncmVnYXRlRXJyb3IgPSBzdWJFcnJvcihcIkFnZ3JlZ2F0ZUVycm9yXCIsIFwiYWdncmVnYXRlIGVycm9yXCIpO1xudHJ5IHtcbiAgICBfVHlwZUVycm9yID0gVHlwZUVycm9yO1xuICAgIF9SYW5nZUVycm9yID0gUmFuZ2VFcnJvcjtcbn0gY2F0Y2goZSkge1xuICAgIF9UeXBlRXJyb3IgPSBzdWJFcnJvcihcIlR5cGVFcnJvclwiLCBcInR5cGUgZXJyb3JcIik7XG4gICAgX1JhbmdlRXJyb3IgPSBzdWJFcnJvcihcIlJhbmdlRXJyb3JcIiwgXCJyYW5nZSBlcnJvclwiKTtcbn1cblxudmFyIG1ldGhvZHMgPSAoXCJqb2luIHBvcCBwdXNoIHNoaWZ0IHVuc2hpZnQgc2xpY2UgZmlsdGVyIGZvckVhY2ggc29tZSBcIiArXG4gICAgXCJldmVyeSBtYXAgaW5kZXhPZiBsYXN0SW5kZXhPZiByZWR1Y2UgcmVkdWNlUmlnaHQgc29ydCByZXZlcnNlXCIpLnNwbGl0KFwiIFwiKTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRob2RzLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKHR5cGVvZiBBcnJheS5wcm90b3R5cGVbbWV0aG9kc1tpXV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBBZ2dyZWdhdGVFcnJvci5wcm90b3R5cGVbbWV0aG9kc1tpXV0gPSBBcnJheS5wcm90b3R5cGVbbWV0aG9kc1tpXV07XG4gICAgfVxufVxuXG5BZ2dyZWdhdGVFcnJvci5wcm90b3R5cGUubGVuZ3RoID0gMDtcbkFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZVtcImlzT3BlcmF0aW9uYWxcIl0gPSB0cnVlO1xudmFyIGxldmVsID0gMDtcbkFnZ3JlZ2F0ZUVycm9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpbmRlbnQgPSBBcnJheShsZXZlbCAqIDQgKyAxKS5qb2luKFwiIFwiKTtcbiAgICB2YXIgcmV0ID0gXCJcXG5cIiArIGluZGVudCArIFwiQWdncmVnYXRlRXJyb3Igb2Y6XCIgKyBcIlxcblwiO1xuICAgIGxldmVsKys7XG4gICAgaW5kZW50ID0gQXJyYXkobGV2ZWwgKiA0ICsgMSkuam9pbihcIiBcIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciBzdHIgPSB0aGlzW2ldID09PSB0aGlzID8gXCJbQ2lyY3VsYXIgQWdncmVnYXRlRXJyb3JdXCIgOiB0aGlzW2ldICsgXCJcIjtcbiAgICAgICAgdmFyIGxpbmVzID0gc3RyLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxpbmVzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICBsaW5lc1tqXSA9IGluZGVudCArIGxpbmVzW2pdO1xuICAgICAgICB9XG4gICAgICAgIHN0ciA9IGxpbmVzLmpvaW4oXCJcXG5cIik7XG4gICAgICAgIHJldCArPSBzdHIgKyBcIlxcblwiO1xuICAgIH1cbiAgICBsZXZlbC0tO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5mdW5jdGlvbiBPcGVyYXRpb25hbEVycm9yKG1lc3NhZ2UpIHtcbiAgICB0aGlzLm5hbWUgPSBcIk9wZXJhdGlvbmFsRXJyb3JcIjtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMuY2F1c2UgPSBtZXNzYWdlO1xuICAgIHRoaXNbXCJpc09wZXJhdGlvbmFsXCJdID0gdHJ1ZTtcblxuICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZS5tZXNzYWdlO1xuICAgICAgICB0aGlzLnN0YWNrID0gbWVzc2FnZS5zdGFjaztcbiAgICB9IGVsc2UgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgIH1cblxufVxuaW5oZXJpdHMoT3BlcmF0aW9uYWxFcnJvciwgRXJyb3IpO1xuXG52YXIga2V5ID0gXCJfX0JsdWViaXJkRXJyb3JUeXBlc19fXCI7XG52YXIgZXJyb3JUeXBlcyA9IEVycm9yW2tleV07XG5pZiAoIWVycm9yVHlwZXMpIHtcbiAgICBlcnJvclR5cGVzID0gT2JqZWN0ZnJlZXplKHtcbiAgICAgICAgQ2FuY2VsbGF0aW9uRXJyb3I6IENhbmNlbGxhdGlvbkVycm9yLFxuICAgICAgICBUaW1lb3V0RXJyb3I6IFRpbWVvdXRFcnJvcixcbiAgICAgICAgT3BlcmF0aW9uYWxFcnJvcjogT3BlcmF0aW9uYWxFcnJvcixcbiAgICAgICAgUmVqZWN0aW9uRXJyb3I6IE9wZXJhdGlvbmFsRXJyb3IsXG4gICAgICAgIEFnZ3JlZ2F0ZUVycm9yOiBBZ2dyZWdhdGVFcnJvclxuICAgIH0pO1xuICAgIG5vdEVudW1lcmFibGVQcm9wKEVycm9yLCBrZXksIGVycm9yVHlwZXMpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBFcnJvcjogRXJyb3IsXG4gICAgVHlwZUVycm9yOiBfVHlwZUVycm9yLFxuICAgIFJhbmdlRXJyb3I6IF9SYW5nZUVycm9yLFxuICAgIENhbmNlbGxhdGlvbkVycm9yOiBlcnJvclR5cGVzLkNhbmNlbGxhdGlvbkVycm9yLFxuICAgIE9wZXJhdGlvbmFsRXJyb3I6IGVycm9yVHlwZXMuT3BlcmF0aW9uYWxFcnJvcixcbiAgICBUaW1lb3V0RXJyb3I6IGVycm9yVHlwZXMuVGltZW91dEVycm9yLFxuICAgIEFnZ3JlZ2F0ZUVycm9yOiBlcnJvclR5cGVzLkFnZ3JlZ2F0ZUVycm9yLFxuICAgIG9yaWdpbmF0ZXNGcm9tUmVqZWN0aW9uOiBvcmlnaW5hdGVzRnJvbVJlamVjdGlvbixcbiAgICBtYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb246IG1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbixcbiAgICBjYW5BdHRhY2g6IGNhbkF0dGFjaFxufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgY2FuQXR0YWNoID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLmNhbkF0dGFjaDtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgaXNPYmplY3QgPSB1dGlsLmlzT2JqZWN0O1xuXG5mdW5jdGlvbiBnZXRUaGVuKG9iaikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBvYmoudGhlbjtcbiAgICB9XG4gICAgY2F0Y2goZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUHJvbWlzZSRfQ2FzdChvYmosIG9yaWdpbmFsUHJvbWlzZSkge1xuICAgIGlmIChpc09iamVjdChvYmopKSB7XG4gICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQW55Qmx1ZWJpcmRQcm9taXNlKG9iaikpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgICAgICAgICByZXQuX3NldFRyYWNlKHZvaWQgMCk7XG4gICAgICAgICAgICBvYmouX3RoZW4oXG4gICAgICAgICAgICAgICAgcmV0Ll9mdWxmaWxsVW5jaGVja2VkLFxuICAgICAgICAgICAgICAgIHJldC5fcmVqZWN0VW5jaGVja2VkQ2hlY2tFcnJvcixcbiAgICAgICAgICAgICAgICByZXQuX3Byb2dyZXNzVW5jaGVja2VkLFxuICAgICAgICAgICAgICAgIHJldCxcbiAgICAgICAgICAgICAgICBudWxsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0Ll9zZXRGb2xsb3dpbmcoKTtcbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRoZW4gPSBnZXRUaGVuKG9iaik7XG4gICAgICAgIGlmICh0aGVuID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgaWYgKG9yaWdpbmFsUHJvbWlzZSAhPT0gdm9pZCAwICYmIGNhbkF0dGFjaCh0aGVuLmUpKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxQcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRoZW4uZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QodGhlbi5lKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhlbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZSRfZG9UaGVuYWJsZShvYmosIHRoZW4sIG9yaWdpbmFsUHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iajtcbn1cblxudmFyIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbmZ1bmN0aW9uIGlzQW55Qmx1ZWJpcmRQcm9taXNlKG9iaikge1xuICAgIHJldHVybiBoYXNQcm9wLmNhbGwob2JqLCBcIl9wcm9taXNlMFwiKTtcbn1cblxuZnVuY3Rpb24gUHJvbWlzZSRfZG9UaGVuYWJsZSh4LCB0aGVuLCBvcmlnaW5hbFByb21pc2UpIHtcbiAgICB2YXIgcmVzb2x2ZXIgPSBQcm9taXNlLmRlZmVyKCk7XG4gICAgdmFyIGNhbGxlZCA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICAgIHRoZW4uY2FsbChcbiAgICAgICAgICAgIHgsXG4gICAgICAgICAgICBQcm9taXNlJF9yZXNvbHZlRnJvbVRoZW5hYmxlLFxuICAgICAgICAgICAgUHJvbWlzZSRfcmVqZWN0RnJvbVRoZW5hYmxlLFxuICAgICAgICAgICAgUHJvbWlzZSRfcHJvZ3Jlc3NGcm9tVGhlbmFibGVcbiAgICAgICAgKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgaWYgKCFjYWxsZWQpIHtcbiAgICAgICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2goZSkgPyBlIDogbmV3IEVycm9yKGUgKyBcIlwiKTtcbiAgICAgICAgICAgIGlmIChvcmlnaW5hbFByb21pc2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsUHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlci5wcm9taXNlLl9yZWplY3QoZSwgdHJhY2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXNvbHZlci5wcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfcmVzb2x2ZUZyb21UaGVuYWJsZSh5KSB7XG4gICAgICAgIGlmIChjYWxsZWQpIHJldHVybjtcbiAgICAgICAgY2FsbGVkID0gdHJ1ZTtcblxuICAgICAgICBpZiAoeCA9PT0geSkge1xuICAgICAgICAgICAgdmFyIGUgPSBQcm9taXNlLl9tYWtlU2VsZlJlc29sdXRpb25FcnJvcigpO1xuICAgICAgICAgICAgaWYgKG9yaWdpbmFsUHJvbWlzZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxQcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZXIucHJvbWlzZS5fcmVqZWN0KGUsIHZvaWQgMCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZXIucmVzb2x2ZSh5KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9yZWplY3RGcm9tVGhlbmFibGUocikge1xuICAgICAgICBpZiAoY2FsbGVkKSByZXR1cm47XG4gICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICAgIHZhciB0cmFjZSA9IGNhbkF0dGFjaChyKSA/IHIgOiBuZXcgRXJyb3IociArIFwiXCIpO1xuICAgICAgICBpZiAob3JpZ2luYWxQcm9taXNlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIG9yaWdpbmFsUHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZXIucHJvbWlzZS5fcmVqZWN0KHIsIHRyYWNlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBQcm9taXNlJF9wcm9ncmVzc0Zyb21UaGVuYWJsZSh2KSB7XG4gICAgICAgIGlmIChjYWxsZWQpIHJldHVybjtcbiAgICAgICAgdmFyIHByb21pc2UgPSByZXNvbHZlci5wcm9taXNlO1xuICAgICAgICBpZiAodHlwZW9mIHByb21pc2UuX3Byb2dyZXNzID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHYpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5yZXR1cm4gUHJvbWlzZSRfQ2FzdDtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgY2FzdCkge1xudmFyIGNhbkF0dGFjaCA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5jYW5BdHRhY2g7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgaXNBcnJheSA9IHV0aWwuaXNBcnJheTtcblxuZnVuY3Rpb24gdG9SZXNvbHV0aW9uVmFsdWUodmFsKSB7XG4gICAgc3dpdGNoKHZhbCkge1xuICAgIGNhc2UgLTE6IHJldHVybiB2b2lkIDA7XG4gICAgY2FzZSAtMjogcmV0dXJuIFtdO1xuICAgIGNhc2UgLTM6IHJldHVybiB7fTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFByb21pc2VBcnJheSh2YWx1ZXMpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMuX3Byb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgdmFyIHBhcmVudCA9IHZvaWQgMDtcbiAgICBpZiAodmFsdWVzIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICBwYXJlbnQgPSB2YWx1ZXM7XG4gICAgICAgIHByb21pc2UuX3Byb3BhZ2F0ZUZyb20ocGFyZW50LCAxIHwgNCk7XG4gICAgfVxuICAgIHByb21pc2UuX3NldFRyYWNlKHBhcmVudCk7XG4gICAgdGhpcy5fdmFsdWVzID0gdmFsdWVzO1xuICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgdGhpcy5fdG90YWxSZXNvbHZlZCA9IDA7XG4gICAgdGhpcy5faW5pdCh2b2lkIDAsIC0yKTtcbn1cblByb21pc2VBcnJheS5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JGxlbmd0aCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGVuZ3RoO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5wcm9taXNlID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JHByb21pc2UoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Byb21pc2U7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfaW5pdChfLCByZXNvbHZlVmFsdWVJZkVtcHR5KSB7XG4gICAgdmFyIHZhbHVlcyA9IGNhc3QodGhpcy5fdmFsdWVzLCB2b2lkIDApO1xuICAgIGlmICh2YWx1ZXMgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgdmFsdWVzLl9zZXRCb3VuZFRvKHRoaXMuX3Byb21pc2UuX2JvdW5kVG8pO1xuICAgICAgICBpZiAodmFsdWVzLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5fc2V0dGxlZFZhbHVlO1xuICAgICAgICAgICAgaWYgKCFpc0FycmF5KHZhbHVlcykpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyID0gbmV3IFByb21pc2UuVHlwZUVycm9yKFwiZXhwZWN0aW5nIGFuIGFycmF5LCBhIHByb21pc2Ugb3IgYSB0aGVuYWJsZVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9faGFyZFJlamVjdF9fKGVycik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlcy5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgdmFsdWVzLl90aGVuKFxuICAgICAgICAgICAgICAgIFByb21pc2VBcnJheSRfaW5pdCxcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWplY3QsXG4gICAgICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZVZhbHVlSWZFbXB0eVxuICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVzLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICB0aGlzLl9yZWplY3QodmFsdWVzLl9zZXR0bGVkVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICghaXNBcnJheSh2YWx1ZXMpKSB7XG4gICAgICAgIHZhciBlcnIgPSBuZXcgUHJvbWlzZS5UeXBlRXJyb3IoXCJleHBlY3RpbmcgYW4gYXJyYXksIGEgcHJvbWlzZSBvciBhIHRoZW5hYmxlXCIpO1xuICAgICAgICB0aGlzLl9faGFyZFJlamVjdF9fKGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBpZiAocmVzb2x2ZVZhbHVlSWZFbXB0eSA9PT0gLTUpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVFbXB0eUFycmF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHRvUmVzb2x1dGlvblZhbHVlKHJlc29sdmVWYWx1ZUlmRW1wdHkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsZW4gPSB0aGlzLmdldEFjdHVhbExlbmd0aCh2YWx1ZXMubGVuZ3RoKTtcbiAgICB2YXIgbmV3TGVuID0gbGVuO1xuICAgIHZhciBuZXdWYWx1ZXMgPSB0aGlzLnNob3VsZENvcHlWYWx1ZXMoKSA/IG5ldyBBcnJheShsZW4pIDogdGhpcy5fdmFsdWVzO1xuICAgIHZhciBpc0RpcmVjdFNjYW5OZWVkZWQgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlc1tpXSwgdm9pZCAwKTtcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgIGlmIChtYXliZVByb21pc2UuaXNQZW5kaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Byb3h5UHJvbWlzZUFycmF5KHRoaXMsIGkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICBpc0RpcmVjdFNjYW5OZWVkZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNEaXJlY3RTY2FuTmVlZGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBuZXdWYWx1ZXNbaV0gPSBtYXliZVByb21pc2U7XG4gICAgfVxuICAgIHRoaXMuX3ZhbHVlcyA9IG5ld1ZhbHVlcztcbiAgICB0aGlzLl9sZW5ndGggPSBuZXdMZW47XG4gICAgaWYgKGlzRGlyZWN0U2Nhbk5lZWRlZCkge1xuICAgICAgICB0aGlzLl9zY2FuRGlyZWN0VmFsdWVzKGxlbik7XG4gICAgfVxufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fc2V0dGxlUHJvbWlzZUF0ID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfc2V0dGxlUHJvbWlzZUF0KGluZGV4KSB7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5fdmFsdWVzW2luZGV4XTtcbiAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KTtcbiAgICB9IGVsc2UgaWYgKHZhbHVlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZS5fc2V0dGxlZFZhbHVlLCBpbmRleCk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgdGhpcy5fcHJvbWlzZVJlamVjdGVkKHZhbHVlLl9zZXR0bGVkVmFsdWUsIGluZGV4KTtcbiAgICB9XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9zY2FuRGlyZWN0VmFsdWVzID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfc2NhbkRpcmVjdFZhbHVlcyhsZW4pIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldHRsZVByb21pc2VBdChpKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9pc1Jlc29sdmVkID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9pc1Jlc29sdmVkKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZXMgPT09IG51bGw7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9yZXNvbHZlID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9yZXNvbHZlKHZhbHVlKSB7XG4gICAgdGhpcy5fdmFsdWVzID0gbnVsbDtcbiAgICB0aGlzLl9wcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuX19oYXJkUmVqZWN0X18gPVxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcmVqZWN0ID0gZnVuY3Rpb24gUHJvbWlzZUFycmF5JF9yZWplY3QocmVhc29uKSB7XG4gICAgdGhpcy5fdmFsdWVzID0gbnVsbDtcbiAgICB2YXIgdHJhY2UgPSBjYW5BdHRhY2gocmVhc29uKSA/IHJlYXNvbiA6IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKTtcbiAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICB0aGlzLl9wcm9taXNlLl9yZWplY3QocmVhc29uLCB0cmFjZSk7XG59O1xuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUHJvZ3Jlc3NlZCA9XG5mdW5jdGlvbiBQcm9taXNlQXJyYXkkX3Byb21pc2VQcm9ncmVzc2VkKHByb2dyZXNzVmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3Byb21pc2UuX3Byb2dyZXNzKHtcbiAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICB2YWx1ZTogcHJvZ3Jlc3NWYWx1ZVxuICAgIH0pO1xufTtcblxuXG5Qcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgIGlmICh0b3RhbFJlc29sdmVkID49IHRoaXMuX2xlbmd0aCkge1xuICAgICAgICB0aGlzLl9yZXNvbHZlKHRoaXMuX3ZhbHVlcyk7XG4gICAgfVxufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZVJlamVjdGVkID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfcHJvbWlzZVJlamVjdGVkKHJlYXNvbiwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fdG90YWxSZXNvbHZlZCsrO1xuICAgIHRoaXMuX3JlamVjdChyZWFzb24pO1xufTtcblxuUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zaG91bGRDb3B5VmFsdWVzID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRfc2hvdWxkQ29weVZhbHVlcygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cblByb21pc2VBcnJheS5wcm90b3R5cGUuZ2V0QWN0dWFsTGVuZ3RoID1cbmZ1bmN0aW9uIFByb21pc2VBcnJheSRnZXRBY3R1YWxMZW5ndGgobGVuKSB7XG4gICAgcmV0dXJuIGxlbjtcbn07XG5cbnJldHVybiBQcm9taXNlQXJyYXk7XG59O1xuIiwiKGZ1bmN0aW9uKCl7LyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG52YXIgaW5oZXJpdHMgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpLmluaGVyaXRzO1xudmFyIGRlZmluZVByb3BlcnR5ID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpLmRlZmluZVByb3BlcnR5O1xuXG52YXIgcmlnbm9yZSA9IG5ldyBSZWdFeHAoXG4gICAgXCJcXFxcYig/OlthLXpBLVowLTkuXStcXFxcJF9cXFxcdyt8XCIgK1xuICAgIFwidHJ5Q2F0Y2goPzoxfDJ8M3w0fEFwcGx5KXxuZXcgXFxcXHcqUHJvbWlzZUFycmF5fFwiICtcbiAgICBcIlxcXFx3KlByb21pc2VBcnJheVxcXFwuXFxcXHcqUHJvbWlzZUFycmF5fFwiICtcbiAgICBcInNldFRpbWVvdXR8Q2F0Y2hGaWx0ZXJcXFxcJF9cXFxcdyt8bWFrZU5vZGVQcm9taXNpZmllZHxwcm9jZXNzSW1tZWRpYXRlfFwiICtcbiAgICBcInByb2Nlc3MuX3RpY2tDYWxsYmFja3xuZXh0VGlja3xBc3luY1xcXFwkXFxcXHcrKVxcXFxiXCJcbik7XG5cbnZhciBydHJhY2VsaW5lID0gbnVsbDtcbnZhciBmb3JtYXRTdGFjayA9IG51bGw7XG5cbmZ1bmN0aW9uIGZvcm1hdE5vbkVycm9yKG9iaikge1xuICAgIHZhciBzdHI7XG4gICAgaWYgKHR5cGVvZiBvYmogPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBzdHIgPSBcIltmdW5jdGlvbiBcIiArXG4gICAgICAgICAgICAob2JqLm5hbWUgfHwgXCJhbm9ueW1vdXNcIikgK1xuICAgICAgICAgICAgXCJdXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc3RyID0gb2JqLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciBydXNlbGVzc1RvU3RyaW5nID0gL1xcW29iamVjdCBbYS16QS1aMC05JF9dK1xcXS87XG4gICAgICAgIGlmIChydXNlbGVzc1RvU3RyaW5nLnRlc3Qoc3RyKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3U3RyID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgICAgICAgICBzdHIgPSBuZXdTdHI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaChlKSB7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc3RyID0gXCIoZW1wdHkgYXJyYXkpXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIChcIig8XCIgKyBzbmlwKHN0cikgKyBcIj4sIG5vIHN0YWNrIHRyYWNlKVwiKTtcbn1cblxuZnVuY3Rpb24gc25pcChzdHIpIHtcbiAgICB2YXIgbWF4Q2hhcnMgPSA0MTtcbiAgICBpZiAoc3RyLmxlbmd0aCA8IG1heENoYXJzKSB7XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICAgIHJldHVybiBzdHIuc3Vic3RyKDAsIG1heENoYXJzIC0gMykgKyBcIi4uLlwiO1xufVxuXG5mdW5jdGlvbiBDYXB0dXJlZFRyYWNlKGlnbm9yZVVudGlsLCBpc1RvcExldmVsKSB7XG4gICAgdGhpcy5jYXB0dXJlU3RhY2tUcmFjZShDYXB0dXJlZFRyYWNlLCBpc1RvcExldmVsKTtcblxufVxuaW5oZXJpdHMoQ2FwdHVyZWRUcmFjZSwgRXJyb3IpO1xuXG5DYXB0dXJlZFRyYWNlLnByb3RvdHlwZS5jYXB0dXJlU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBDYXB0dXJlZFRyYWNlJGNhcHR1cmVTdGFja1RyYWNlKGlnbm9yZVVudGlsLCBpc1RvcExldmVsKSB7XG4gICAgY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgaWdub3JlVW50aWwsIGlzVG9wTGV2ZWwpO1xufTtcblxuQ2FwdHVyZWRUcmFjZS5wb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9XG5mdW5jdGlvbiBDYXB0dXJlZFRyYWNlJFBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKHJlYXNvbikge1xuICAgIGlmICh0eXBlb2YgY29uc29sZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgaWYgKHR5cGVvZiByZWFzb24gPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIHJlYXNvbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIgc3RhY2sgPSByZWFzb24uc3RhY2s7XG4gICAgICAgICAgICBtZXNzYWdlID0gXCJQb3NzaWJseSB1bmhhbmRsZWQgXCIgKyBmb3JtYXRTdGFjayhzdGFjaywgcmVhc29uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBcIlBvc3NpYmx5IHVuaGFuZGxlZCBcIiArIFN0cmluZyhyZWFzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgICAgICAgICB0eXBlb2YgY29uc29sZS5lcnJvciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY29uc29sZS5sb2cgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICAgICAgICAgdHlwZW9mIGNvbnNvbGUubG9nID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbkNhcHR1cmVkVHJhY2UuY29tYmluZSA9IGZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkQ29tYmluZShjdXJyZW50LCBwcmV2KSB7XG4gICAgdmFyIGN1ckxhc3QgPSBjdXJyZW50Lmxlbmd0aCAtIDE7XG4gICAgZm9yICh2YXIgaSA9IHByZXYubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGxpbmUgPSBwcmV2W2ldO1xuICAgICAgICBpZiAoY3VycmVudFtjdXJMYXN0XSA9PT0gbGluZSkge1xuICAgICAgICAgICAgY3VycmVudC5wb3AoKTtcbiAgICAgICAgICAgIGN1ckxhc3QtLTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY3VycmVudC5wdXNoKFwiRnJvbSBwcmV2aW91cyBldmVudDpcIik7XG4gICAgdmFyIGxpbmVzID0gY3VycmVudC5jb25jYXQocHJldik7XG5cbiAgICB2YXIgcmV0ID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGluZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcblxuICAgICAgICBpZiAoKHJpZ25vcmUudGVzdChsaW5lc1tpXSkgfHxcbiAgICAgICAgICAgIChpID4gMCAmJiAhcnRyYWNlbGluZS50ZXN0KGxpbmVzW2ldKSkgJiZcbiAgICAgICAgICAgIGxpbmVzW2ldICE9PSBcIkZyb20gcHJldmlvdXMgZXZlbnQ6XCIpXG4gICAgICAgKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICByZXQucHVzaChsaW5lc1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5DYXB0dXJlZFRyYWNlLnByb3RlY3RFcnJvck1lc3NhZ2VOZXdsaW5lcyA9IGZ1bmN0aW9uKHN0YWNrKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGFjay5sZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAocnRyYWNlbGluZS50ZXN0KHN0YWNrW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaSA8PSAxKSByZXR1cm47XG5cbiAgICB2YXIgZXJyb3JNZXNzYWdlTGluZXMgPSBbXTtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGk7ICsraikge1xuICAgICAgICBlcnJvck1lc3NhZ2VMaW5lcy5wdXNoKHN0YWNrLnNoaWZ0KCkpO1xuICAgIH1cbiAgICBzdGFjay51bnNoaWZ0KGVycm9yTWVzc2FnZUxpbmVzLmpvaW4oXCJcXHUwMDAyXFx1MDAwMFxcdTAwMDFcIikpO1xufTtcblxuQ2FwdHVyZWRUcmFjZS5pc1N1cHBvcnRlZCA9IGZ1bmN0aW9uIENhcHR1cmVkVHJhY2UkSXNTdXBwb3J0ZWQoKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBjYXB0dXJlU3RhY2tUcmFjZSA9PT0gXCJmdW5jdGlvblwiO1xufTtcblxudmFyIGNhcHR1cmVTdGFja1RyYWNlID0gKGZ1bmN0aW9uIHN0YWNrRGV0ZWN0aW9uKCkge1xuICAgIGlmICh0eXBlb2YgRXJyb3Iuc3RhY2tUcmFjZUxpbWl0ID09PSBcIm51bWJlclwiICYmXG4gICAgICAgIHR5cGVvZiBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJ0cmFjZWxpbmUgPSAvXlxccyphdFxccyovO1xuICAgICAgICBmb3JtYXRTdGFjayA9IGZ1bmN0aW9uKHN0YWNrLCBlcnJvcikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdGFjayA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIHN0YWNrO1xuXG4gICAgICAgICAgICBpZiAoZXJyb3IubmFtZSAhPT0gdm9pZCAwICYmXG4gICAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yLm5hbWUgKyBcIi4gXCIgKyBlcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE5vbkVycm9yKGVycm9yKTtcblxuXG4gICAgICAgIH07XG4gICAgICAgIHZhciBjYXB0dXJlU3RhY2tUcmFjZSA9IEVycm9yLmNhcHR1cmVTdGFja1RyYWNlO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gQ2FwdHVyZWRUcmFjZSRfY2FwdHVyZVN0YWNrVHJhY2UoXG4gICAgICAgICAgICByZWNlaXZlciwgaWdub3JlVW50aWwpIHtcbiAgICAgICAgICAgIGNhcHR1cmVTdGFja1RyYWNlKHJlY2VpdmVyLCBpZ25vcmVVbnRpbCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoKTtcblxuICAgIGlmICh0eXBlb2YgZXJyLnN0YWNrID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgIHR5cGVvZiBcIlwiLnN0YXJ0c1dpdGggPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgICAoZXJyLnN0YWNrLnN0YXJ0c1dpdGgoXCJzdGFja0RldGVjdGlvbkBcIikpICYmXG4gICAgICAgIHN0YWNrRGV0ZWN0aW9uLm5hbWUgPT09IFwic3RhY2tEZXRlY3Rpb25cIikge1xuXG4gICAgICAgIGRlZmluZVByb3BlcnR5KEVycm9yLCBcInN0YWNrVHJhY2VMaW1pdFwiLCB7XG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHZhbHVlOiAyNVxuICAgICAgICB9KTtcbiAgICAgICAgcnRyYWNlbGluZSA9IC9ALztcbiAgICAgICAgdmFyIHJsaW5lID0gL1tAXFxuXS87XG5cbiAgICAgICAgZm9ybWF0U3RhY2sgPSBmdW5jdGlvbihzdGFjaywgZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGVycm9yLm5hbWUgKyBcIi4gXCIgKyBlcnJvci5tZXNzYWdlICsgXCJcXG5cIiArIHN0YWNrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGVycm9yLm5hbWUgIT09IHZvaWQgMCAmJlxuICAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlcnJvci5uYW1lICsgXCIuIFwiICsgZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmb3JtYXROb25FcnJvcihlcnJvcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGNhcHR1cmVTdGFja1RyYWNlKG8pIHtcbiAgICAgICAgICAgIHZhciBzdGFjayA9IG5ldyBFcnJvcigpLnN0YWNrO1xuICAgICAgICAgICAgdmFyIHNwbGl0ID0gc3RhY2suc3BsaXQocmxpbmUpO1xuICAgICAgICAgICAgdmFyIGxlbiA9IHNwbGl0Lmxlbmd0aDtcbiAgICAgICAgICAgIHZhciByZXQgPSBcIlwiO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgICAgICAgICAgICAgIHJldCArPSBzcGxpdFtpXTtcbiAgICAgICAgICAgICAgICByZXQgKz0gXCJAXCI7XG4gICAgICAgICAgICAgICAgcmV0ICs9IHNwbGl0W2kgKyAxXTtcbiAgICAgICAgICAgICAgICByZXQgKz0gXCJcXG5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG8uc3RhY2sgPSByZXQ7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9ybWF0U3RhY2sgPSBmdW5jdGlvbihzdGFjaywgZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIpIHJldHVybiBzdGFjaztcblxuICAgICAgICAgICAgaWYgKCh0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgfHxcbiAgICAgICAgICAgICAgICB0eXBlb2YgZXJyb3IgPT09IFwiZnVuY3Rpb25cIikgJiZcbiAgICAgICAgICAgICAgICBlcnJvci5uYW1lICE9PSB2b2lkIDAgJiZcbiAgICAgICAgICAgICAgICBlcnJvci5tZXNzYWdlICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IubmFtZSArIFwiLiBcIiArIGVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Tm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn0pKCk7XG5cbnJldHVybiBDYXB0dXJlZFRyYWNlO1xufTtcblxufSkoKSIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE5FWFRfRklMVEVSKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcbnZhciBrZXlzID0gcmVxdWlyZShcIi4vZXM1LmpzXCIpLmtleXM7XG52YXIgVHlwZUVycm9yID0gZXJyb3JzLlR5cGVFcnJvcjtcblxuZnVuY3Rpb24gQ2F0Y2hGaWx0ZXIoaW5zdGFuY2VzLCBjYWxsYmFjaywgcHJvbWlzZSkge1xuICAgIHRoaXMuX2luc3RhbmNlcyA9IGluc3RhbmNlcztcbiAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIHRoaXMuX3Byb21pc2UgPSBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBDYXRjaEZpbHRlciRfc2FmZVByZWRpY2F0ZShwcmVkaWNhdGUsIGUpIHtcbiAgICB2YXIgc2FmZU9iamVjdCA9IHt9O1xuICAgIHZhciByZXRmaWx0ZXIgPSB0cnlDYXRjaDEocHJlZGljYXRlLCBzYWZlT2JqZWN0LCBlKTtcblxuICAgIGlmIChyZXRmaWx0ZXIgPT09IGVycm9yT2JqKSByZXR1cm4gcmV0ZmlsdGVyO1xuXG4gICAgdmFyIHNhZmVLZXlzID0ga2V5cyhzYWZlT2JqZWN0KTtcbiAgICBpZiAoc2FmZUtleXMubGVuZ3RoKSB7XG4gICAgICAgIGVycm9yT2JqLmUgPSBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgXCJDYXRjaCBmaWx0ZXIgbXVzdCBpbmhlcml0IGZyb20gRXJyb3IgXCJcbiAgICAgICAgICArIFwib3IgYmUgYSBzaW1wbGUgcHJlZGljYXRlIGZ1bmN0aW9uXCIpO1xuICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG4gICAgfVxuICAgIHJldHVybiByZXRmaWx0ZXI7XG59XG5cbkNhdGNoRmlsdGVyLnByb3RvdHlwZS5kb0ZpbHRlciA9IGZ1bmN0aW9uIENhdGNoRmlsdGVyJF9kb0ZpbHRlcihlKSB7XG4gICAgdmFyIGNiID0gdGhpcy5fY2FsbGJhY2s7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLl9wcm9taXNlO1xuICAgIHZhciBib3VuZFRvID0gcHJvbWlzZS5fYm91bmRUbztcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5faW5zdGFuY2VzLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciBpdGVtID0gdGhpcy5faW5zdGFuY2VzW2ldO1xuICAgICAgICB2YXIgaXRlbUlzRXJyb3JUeXBlID0gaXRlbSA9PT0gRXJyb3IgfHxcbiAgICAgICAgICAgIChpdGVtICE9IG51bGwgJiYgaXRlbS5wcm90b3R5cGUgaW5zdGFuY2VvZiBFcnJvcik7XG5cbiAgICAgICAgaWYgKGl0ZW1Jc0Vycm9yVHlwZSAmJiBlIGluc3RhbmNlb2YgaXRlbSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IHRyeUNhdGNoMShjYiwgYm91bmRUbywgZSk7XG4gICAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICAgIE5FWFRfRklMVEVSLmUgPSByZXQuZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gTkVYVF9GSUxURVI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtID09PSBcImZ1bmN0aW9uXCIgJiYgIWl0ZW1Jc0Vycm9yVHlwZSkge1xuICAgICAgICAgICAgdmFyIHNob3VsZEhhbmRsZSA9IENhdGNoRmlsdGVyJF9zYWZlUHJlZGljYXRlKGl0ZW0sIGUpO1xuICAgICAgICAgICAgaWYgKHNob3VsZEhhbmRsZSA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKGVycm9yT2JqLmUpXG4gICAgICAgICAgICAgICAgICAgID8gZXJyb3JPYmouZVxuICAgICAgICAgICAgICAgICAgICA6IG5ldyBFcnJvcihlcnJvck9iai5lICsgXCJcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICAgICAgZSA9IGVycm9yT2JqLmU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZEhhbmRsZSkge1xuICAgICAgICAgICAgICAgIHZhciByZXQgPSB0cnlDYXRjaDEoY2IsIGJvdW5kVG8sIGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIE5FWFRfRklMVEVSLmUgPSByZXQuZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5FWFRfRklMVEVSO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIE5FWFRfRklMVEVSLmUgPSBlO1xuICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbn07XG5cbnJldHVybiBDYXRjaEZpbHRlcjtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIG1heWJlV3JhcEFzRXJyb3IgPSB1dGlsLm1heWJlV3JhcEFzRXJyb3I7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIFRpbWVvdXRFcnJvciA9IGVycm9ycy5UaW1lb3V0RXJyb3I7XG52YXIgT3BlcmF0aW9uYWxFcnJvciA9IGVycm9ycy5PcGVyYXRpb25hbEVycm9yO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgaGF2ZUdldHRlcnMgPSB1dGlsLmhhdmVHZXR0ZXJzO1xudmFyIGVzNSA9IHJlcXVpcmUoXCIuL2VzNS5qc1wiKTtcblxuZnVuY3Rpb24gaXNVbnR5cGVkRXJyb3Iob2JqKSB7XG4gICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIEVycm9yICYmXG4gICAgICAgIGVzNS5nZXRQcm90b3R5cGVPZihvYmopID09PSBFcnJvci5wcm90b3R5cGU7XG59XG5cbmZ1bmN0aW9uIHdyYXBBc09wZXJhdGlvbmFsRXJyb3Iob2JqKSB7XG4gICAgdmFyIHJldDtcbiAgICBpZiAoaXNVbnR5cGVkRXJyb3Iob2JqKSkge1xuICAgICAgICByZXQgPSBuZXcgT3BlcmF0aW9uYWxFcnJvcihvYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldCA9IG9iajtcbiAgICB9XG4gICAgZXJyb3JzLm1hcmtBc09yaWdpbmF0aW5nRnJvbVJlamVjdGlvbihyZXQpO1xuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKSB7XG4gICAgZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJF9jYWxsYmFjayhlcnIsIHZhbHVlKSB7XG4gICAgICAgIGlmIChwcm9taXNlID09PSBudWxsKSByZXR1cm47XG5cbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSB3cmFwQXNPcGVyYXRpb25hbEVycm9yKG1heWJlV3JhcEFzRXJyb3IoZXJyKSk7XG4gICAgICAgICAgICBwcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHdyYXBwZWQpO1xuICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpO1xuICAgICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuIC0gMSk7IGZvcih2YXIgJF9pID0gMTsgJF9pIDwgJF9sZW47ICsrJF9pKSB7YXJnc1skX2kgLSAxXSA9IGFyZ3VtZW50c1skX2ldO31cbiAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGwoYXJncyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZVJlc29sdmVyJF9jYWxsYmFjaztcbn1cblxuXG52YXIgUHJvbWlzZVJlc29sdmVyO1xuaWYgKCFoYXZlR2V0dGVycykge1xuICAgIFByb21pc2VSZXNvbHZlciA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlcihwcm9taXNlKSB7XG4gICAgICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7XG4gICAgICAgIHRoaXMuYXNDYWxsYmFjayA9IG5vZGViYWNrRm9yUHJvbWlzZShwcm9taXNlKTtcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IHRoaXMuYXNDYWxsYmFjaztcbiAgICB9O1xufVxuZWxzZSB7XG4gICAgUHJvbWlzZVJlc29sdmVyID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyKHByb21pc2UpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgICB9O1xufVxuaWYgKGhhdmVHZXR0ZXJzKSB7XG4gICAgdmFyIHByb3AgPSB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZWJhY2tGb3JQcm9taXNlKHRoaXMucHJvbWlzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGVzNS5kZWZpbmVQcm9wZXJ0eShQcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLCBcImFzQ2FsbGJhY2tcIiwgcHJvcCk7XG4gICAgZXM1LmRlZmluZVByb3BlcnR5KFByb21pc2VSZXNvbHZlci5wcm90b3R5cGUsIFwiY2FsbGJhY2tcIiwgcHJvcCk7XG59XG5cblByb21pc2VSZXNvbHZlci5fbm9kZWJhY2tGb3JQcm9taXNlID0gbm9kZWJhY2tGb3JQcm9taXNlO1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gUHJvbWlzZVJlc29sdmVyJHRvU3RyaW5nKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgUHJvbWlzZVJlc29sdmVyXVwiO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlID1cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUuZnVsZmlsbCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRyZXNvbHZlKHZhbHVlKSB7XG4gICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFByb21pc2VSZXNvbHZlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIklsbGVnYWwgaW52b2NhdGlvbiwgcmVzb2x2ZXIgcmVzb2x2ZS9yZWplY3QgbXVzdCBiZSBjYWxsZWQgd2l0aGluIGEgcmVzb2x2ZXIgY29udGV4dC4gQ29uc2lkZXIgdXNpbmcgdGhlIHByb21pc2UgY29uc3RydWN0b3IgaW5zdGVhZC5cIik7XG4gICAgfVxuXG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG4gICAgaWYgKHByb21pc2UuX3RyeUZvbGxvdyh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhc3luYy5pbnZva2UocHJvbWlzZS5fZnVsZmlsbCwgcHJvbWlzZSwgdmFsdWUpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS5yZWplY3QgPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkcmVqZWN0KHJlYXNvbikge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlUmVzb2x2ZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbGxlZ2FsIGludm9jYXRpb24sIHJlc29sdmVyIHJlc29sdmUvcmVqZWN0IG11c3QgYmUgY2FsbGVkIHdpdGhpbiBhIHJlc29sdmVyIGNvbnRleHQuIENvbnNpZGVyIHVzaW5nIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGluc3RlYWQuXCIpO1xuICAgIH1cblxuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuICAgIGVycm9ycy5tYXJrQXNPcmlnaW5hdGluZ0Zyb21SZWplY3Rpb24ocmVhc29uKTtcbiAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKHJlYXNvbikgPyByZWFzb24gOiBuZXcgRXJyb3IocmVhc29uICsgXCJcIik7XG4gICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgYXN5bmMuaW52b2tlKHByb21pc2UuX3JlamVjdCwgcHJvbWlzZSwgcmVhc29uKTtcbiAgICBpZiAodHJhY2UgIT09IHJlYXNvbikge1xuICAgICAgICBhc3luYy5pbnZva2UodGhpcy5fc2V0Q2FycmllZFN0YWNrVHJhY2UsIHRoaXMsIHRyYWNlKTtcbiAgICB9XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLnByb2dyZXNzID1cbmZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRwcm9ncmVzcyh2YWx1ZSkge1xuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlUmVzb2x2ZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbGxlZ2FsIGludm9jYXRpb24sIHJlc29sdmVyIHJlc29sdmUvcmVqZWN0IG11c3QgYmUgY2FsbGVkIHdpdGhpbiBhIHJlc29sdmVyIGNvbnRleHQuIENvbnNpZGVyIHVzaW5nIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yIGluc3RlYWQuXCIpO1xuICAgIH1cbiAgICBhc3luYy5pbnZva2UodGhpcy5wcm9taXNlLl9wcm9ncmVzcywgdGhpcy5wcm9taXNlLCB2YWx1ZSk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRjYW5jZWwoKSB7XG4gICAgYXN5bmMuaW52b2tlKHRoaXMucHJvbWlzZS5jYW5jZWwsIHRoaXMucHJvbWlzZSwgdm9pZCAwKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUudGltZW91dCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciR0aW1lb3V0KCkge1xuICAgIHRoaXMucmVqZWN0KG5ldyBUaW1lb3V0RXJyb3IoXCJ0aW1lb3V0XCIpKTtcbn07XG5cblByb21pc2VSZXNvbHZlci5wcm90b3R5cGUuaXNSZXNvbHZlZCA9IGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlciRpc1Jlc29sdmVkKCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2UuaXNSZXNvbHZlZCgpO1xufTtcblxuUHJvbWlzZVJlc29sdmVyLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkdG9KU09OKCkge1xuICAgIHJldHVybiB0aGlzLnByb21pc2UudG9KU09OKCk7XG59O1xuXG5Qcm9taXNlUmVzb2x2ZXIucHJvdG90eXBlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSA9XG5mdW5jdGlvbiBQcm9taXNlUmVzb2x2ZXIkX3NldENhcnJpZWRTdGFja1RyYWNlKHRyYWNlKSB7XG4gICAgaWYgKHRoaXMucHJvbWlzZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlLl9zZXRDYXJyaWVkU3RhY2tUcmFjZSh0cmFjZSk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlUmVzb2x2ZXI7XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBORVhUX0ZJTFRFUiwgY2FzdCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgPSB1dGlsLndyYXBzUHJpbWl0aXZlUmVjZWl2ZXI7XG52YXIgaXNQcmltaXRpdmUgPSB1dGlsLmlzUHJpbWl0aXZlO1xudmFyIHRocm93ZXIgPSB1dGlsLnRocm93ZXI7XG5cbmZ1bmN0aW9uIHJldHVyblRoaXMoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG59XG5mdW5jdGlvbiB0aHJvd1RoaXMoKSB7XG4gICAgdGhyb3cgdGhpcztcbn1cbmZ1bmN0aW9uIHJldHVybiQocikge1xuICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF9yZXR1cm5lcigpIHtcbiAgICAgICAgcmV0dXJuIHI7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRocm93JChyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX3Rocm93ZXIoKSB7XG4gICAgICAgIHRocm93IHI7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHByb21pc2VkRmluYWxseShyZXQsIHJlYXNvbk9yVmFsdWUsIGlzRnVsZmlsbGVkKSB7XG4gICAgdmFyIHRoZW47XG4gICAgaWYgKHdyYXBzUHJpbWl0aXZlUmVjZWl2ZXIgJiYgaXNQcmltaXRpdmUocmVhc29uT3JWYWx1ZSkpIHtcbiAgICAgICAgdGhlbiA9IGlzRnVsZmlsbGVkID8gcmV0dXJuJChyZWFzb25PclZhbHVlKSA6IHRocm93JChyZWFzb25PclZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGVuID0gaXNGdWxmaWxsZWQgPyByZXR1cm5UaGlzIDogdGhyb3dUaGlzO1xuICAgIH1cbiAgICByZXR1cm4gcmV0Ll90aGVuKHRoZW4sIHRocm93ZXIsIHZvaWQgMCwgcmVhc29uT3JWYWx1ZSwgdm9pZCAwKTtcbn1cblxuZnVuY3Rpb24gZmluYWxseUhhbmRsZXIocmVhc29uT3JWYWx1ZSkge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuICAgIHZhciBoYW5kbGVyID0gdGhpcy5oYW5kbGVyO1xuXG4gICAgdmFyIHJldCA9IHByb21pc2UuX2lzQm91bmQoKVxuICAgICAgICAgICAgICAgICAgICA/IGhhbmRsZXIuY2FsbChwcm9taXNlLl9ib3VuZFRvKVxuICAgICAgICAgICAgICAgICAgICA6IGhhbmRsZXIoKTtcblxuICAgIGlmIChyZXQgIT09IHZvaWQgMCkge1xuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXQsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZWRGaW5hbGx5KG1heWJlUHJvbWlzZSwgcmVhc29uT3JWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UuaXNGdWxmaWxsZWQoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZS5pc1JlamVjdGVkKCkpIHtcbiAgICAgICAgTkVYVF9GSUxURVIuZSA9IHJlYXNvbk9yVmFsdWU7XG4gICAgICAgIHJldHVybiBORVhUX0ZJTFRFUjtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVhc29uT3JWYWx1ZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRhcEhhbmRsZXIodmFsdWUpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcbiAgICB2YXIgaGFuZGxlciA9IHRoaXMuaGFuZGxlcjtcblxuICAgIHZhciByZXQgPSBwcm9taXNlLl9pc0JvdW5kKClcbiAgICAgICAgICAgICAgICAgICAgPyBoYW5kbGVyLmNhbGwocHJvbWlzZS5fYm91bmRUbywgdmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIDogaGFuZGxlcih2YWx1ZSk7XG5cbiAgICBpZiAocmV0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmV0LCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgcmV0dXJuIHByb21pc2VkRmluYWxseShtYXliZVByb21pc2UsIHZhbHVlLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5cblByb21pc2UucHJvdG90eXBlLl9wYXNzVGhyb3VnaEhhbmRsZXIgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcGFzc1Rocm91Z2hIYW5kbGVyKGhhbmRsZXIsIGlzRmluYWxseSkge1xuICAgIGlmICh0eXBlb2YgaGFuZGxlciAhPT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdGhpcy50aGVuKCk7XG5cbiAgICB2YXIgcHJvbWlzZUFuZEhhbmRsZXIgPSB7XG4gICAgICAgIHByb21pc2U6IHRoaXMsXG4gICAgICAgIGhhbmRsZXI6IGhhbmRsZXJcbiAgICB9O1xuXG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oXG4gICAgICAgICAgICBpc0ZpbmFsbHkgPyBmaW5hbGx5SGFuZGxlciA6IHRhcEhhbmRsZXIsXG4gICAgICAgICAgICBpc0ZpbmFsbHkgPyBmaW5hbGx5SGFuZGxlciA6IHZvaWQgMCwgdm9pZCAwLFxuICAgICAgICAgICAgcHJvbWlzZUFuZEhhbmRsZXIsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5sYXN0bHkgPVxuUHJvbWlzZS5wcm90b3R5cGVbXCJmaW5hbGx5XCJdID0gZnVuY3Rpb24gUHJvbWlzZSRmaW5hbGx5KGhhbmRsZXIpIHtcbiAgICByZXR1cm4gdGhpcy5fcGFzc1Rocm91Z2hIYW5kbGVyKGhhbmRsZXIsIHRydWUpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudGFwID0gZnVuY3Rpb24gUHJvbWlzZSR0YXAoaGFuZGxlcikge1xuICAgIHJldHVybiB0aGlzLl9wYXNzVGhyb3VnaEhhbmRsZXIoaGFuZGxlciwgZmFsc2UpO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGlzUHJpbWl0aXZlID0gdXRpbC5pc1ByaW1pdGl2ZTtcbnZhciB3cmFwc1ByaW1pdGl2ZVJlY2VpdmVyID0gdXRpbC53cmFwc1ByaW1pdGl2ZVJlY2VpdmVyO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UpIHtcbnZhciByZXR1cm5lciA9IGZ1bmN0aW9uIFByb21pc2UkX3JldHVybmVyKCkge1xuICAgIHJldHVybiB0aGlzO1xufTtcbnZhciB0aHJvd2VyID0gZnVuY3Rpb24gUHJvbWlzZSRfdGhyb3dlcigpIHtcbiAgICB0aHJvdyB0aGlzO1xufTtcblxudmFyIHdyYXBwZXIgPSBmdW5jdGlvbiBQcm9taXNlJF93cmFwcGVyKHZhbHVlLCBhY3Rpb24pIHtcbiAgICBpZiAoYWN0aW9uID09PSAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBQcm9taXNlJF90aHJvd2VyKCkge1xuICAgICAgICAgICAgdGhyb3cgdmFsdWU7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IDIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIFByb21pc2UkX3JldHVybmVyKCkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9O1xuICAgIH1cbn07XG5cblxuUHJvbWlzZS5wcm90b3R5cGVbXCJyZXR1cm5cIl0gPVxuUHJvbWlzZS5wcm90b3R5cGUudGhlblJldHVybiA9XG5mdW5jdGlvbiBQcm9taXNlJHRoZW5SZXR1cm4odmFsdWUpIHtcbiAgICBpZiAod3JhcHNQcmltaXRpdmVSZWNlaXZlciAmJiBpc1ByaW1pdGl2ZSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RoZW4oXG4gICAgICAgICAgICB3cmFwcGVyKHZhbHVlLCAyKSxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIHZvaWQgMFxuICAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl90aGVuKHJldHVybmVyLCB2b2lkIDAsIHZvaWQgMCwgdmFsdWUsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZVtcInRocm93XCJdID1cblByb21pc2UucHJvdG90eXBlLnRoZW5UaHJvdyA9XG5mdW5jdGlvbiBQcm9taXNlJHRoZW5UaHJvdyhyZWFzb24pIHtcbiAgICBpZiAod3JhcHNQcmltaXRpdmVSZWNlaXZlciAmJiBpc1ByaW1pdGl2ZShyZWFzb24pKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90aGVuKFxuICAgICAgICAgICAgd3JhcHBlcihyZWFzb24sIDEpLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdm9pZCAwXG4gICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4odGhyb3dlciwgdm9pZCAwLCB2b2lkIDAsIHJlYXNvbiwgdm9pZCAwKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID1cbmZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgY2FzdCwgSU5URVJOQUwpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBjYW5FdmFsdWF0ZSA9IHV0aWwuY2FuRXZhbHVhdGU7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuXG5cbmlmIChjYW5FdmFsdWF0ZSkge1xuICAgIHZhciB0aGVuQ2FsbGJhY2sgPSBmdW5jdGlvbihpKSB7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJ2YWx1ZVwiLCBcImhvbGRlclwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGhvbGRlci5wSW5kZXggPSB2YWx1ZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIGhvbGRlci5jaGVja0Z1bGZpbGxtZW50KHRoaXMpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiLnJlcGxhY2UoL0luZGV4L2csIGkpKTtcbiAgICB9O1xuXG4gICAgdmFyIGNhbGxlciA9IGZ1bmN0aW9uKGNvdW50KSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gY291bnQ7ICsraSkgdmFsdWVzLnB1c2goXCJob2xkZXIucFwiICsgaSk7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJob2xkZXJcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBob2xkZXIuZm47ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsdWVzKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIi5yZXBsYWNlKC92YWx1ZXMvZywgdmFsdWVzLmpvaW4oXCIsIFwiKSkpO1xuICAgIH07XG4gICAgdmFyIHRoZW5DYWxsYmFja3MgPSBbXTtcbiAgICB2YXIgY2FsbGVycyA9IFt2b2lkIDBdO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IDU7ICsraSkge1xuICAgICAgICB0aGVuQ2FsbGJhY2tzLnB1c2godGhlbkNhbGxiYWNrKGkpKTtcbiAgICAgICAgY2FsbGVycy5wdXNoKGNhbGxlcihpKSk7XG4gICAgfVxuXG4gICAgdmFyIEhvbGRlciA9IGZ1bmN0aW9uKHRvdGFsLCBmbikge1xuICAgICAgICB0aGlzLnAxID0gdGhpcy5wMiA9IHRoaXMucDMgPSB0aGlzLnA0ID0gdGhpcy5wNSA9IG51bGw7XG4gICAgICAgIHRoaXMuZm4gPSBmbjtcbiAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICAgICAgICB0aGlzLm5vdyA9IDA7XG4gICAgfTtcblxuICAgIEhvbGRlci5wcm90b3R5cGUuY2FsbGVycyA9IGNhbGxlcnM7XG4gICAgSG9sZGVyLnByb3RvdHlwZS5jaGVja0Z1bGZpbGxtZW50ID0gZnVuY3Rpb24ocHJvbWlzZSkge1xuICAgICAgICB2YXIgbm93ID0gdGhpcy5ub3c7XG4gICAgICAgIG5vdysrO1xuICAgICAgICB2YXIgdG90YWwgPSB0aGlzLnRvdGFsO1xuICAgICAgICBpZiAobm93ID49IHRvdGFsKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuY2FsbGVyc1t0b3RhbF07XG4gICAgICAgICAgICB2YXIgcmV0ID0gdHJ5Q2F0Y2gxKGhhbmRsZXIsIHZvaWQgMCwgdGhpcyk7XG4gICAgICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICAgICAgICAgIHByb21pc2UuX3JlamVjdFVuY2hlY2tlZChyZXQuZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFwcm9taXNlLl90cnlGb2xsb3cocmV0KSkge1xuICAgICAgICAgICAgICAgIHByb21pc2UuX2Z1bGZpbGxVbmNoZWNrZWQocmV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm93ID0gbm93O1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuXG5cblxuUHJvbWlzZS5qb2luID0gZnVuY3Rpb24gUHJvbWlzZSRKb2luKCkge1xuICAgIHZhciBsYXN0ID0gYXJndW1lbnRzLmxlbmd0aCAtIDE7XG4gICAgdmFyIGZuO1xuICAgIGlmIChsYXN0ID4gMCAmJiB0eXBlb2YgYXJndW1lbnRzW2xhc3RdID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZm4gPSBhcmd1bWVudHNbbGFzdF07XG4gICAgICAgIGlmIChsYXN0IDwgNiAmJiBjYW5FdmFsdWF0ZSkge1xuICAgICAgICAgICAgdmFyIHJldCA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICAgICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICAgICAgICAgIHZhciBob2xkZXIgPSBuZXcgSG9sZGVyKGxhc3QsIGZuKTtcbiAgICAgICAgICAgIHZhciByZWplY3QgPSByZXQuX3JlamVjdDtcbiAgICAgICAgICAgIHZhciBjYWxsYmFja3MgPSB0aGVuQ2FsbGJhY2tzO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsYXN0OyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChhcmd1bWVudHNbaV0sIHZvaWQgMCk7XG4gICAgICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl90aGVuKGNhbGxiYWNrc1tpXSwgcmVqZWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCwgcmV0LCBob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1heWJlUHJvbWlzZS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3NbaV0uY2FsbChyZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3NldHRsZWRWYWx1ZSwgaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldC5fcmVqZWN0KG1heWJlUHJvbWlzZS5fc2V0dGxlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGwocmV0LCBtYXliZVByb21pc2UsIGhvbGRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgJF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoO3ZhciBhcmdzID0gbmV3IEFycmF5KCRfbGVuKTsgZm9yKHZhciAkX2kgPSAwOyAkX2kgPCAkX2xlbjsgKyskX2kpIHthcmdzWyRfaV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlQXJyYXkoYXJncykucHJvbWlzZSgpO1xuICAgIHJldHVybiBmbiAhPT0gdm9pZCAwID8gcmV0LnNwcmVhZChmbikgOiByZXQ7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgSU5URVJOQUwsIGNhc3QpIHtcbnZhciBhcGlSZWplY3Rpb24gPSByZXF1aXJlKFwiLi9lcnJvcnNfYXBpX3JlamVjdGlvbi5qc1wiKShQcm9taXNlKTtcbnZhciBpc0FycmF5ID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5pc0FycmF5O1xuXG52YXIgcmFjZUxhdGVyID0gZnVuY3Rpb24gUHJvbWlzZSRfcmFjZUxhdGVyKHByb21pc2UpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlJF9SYWNlKGFycmF5LCBwcm9taXNlKTtcbiAgICB9KTtcbn07XG5cbnZhciBoYXNPd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbmZ1bmN0aW9uIFByb21pc2UkX1JhY2UocHJvbWlzZXMsIHBhcmVudCkge1xuICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHByb21pc2VzLCB2b2lkIDApO1xuXG4gICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuIHJhY2VMYXRlcihtYXliZVByb21pc2UpO1xuICAgIH0gZWxzZSBpZiAoIWlzQXJyYXkocHJvbWlzZXMpKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJleHBlY3RpbmcgYW4gYXJyYXksIGEgcHJvbWlzZSBvciBhIHRoZW5hYmxlXCIpO1xuICAgIH1cblxuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG4gICAgaWYgKHBhcmVudCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHJldC5fcHJvcGFnYXRlRnJvbShwYXJlbnQsIDcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldC5fc2V0VHJhY2Uodm9pZCAwKTtcbiAgICB9XG4gICAgdmFyIGZ1bGZpbGwgPSByZXQuX2Z1bGZpbGw7XG4gICAgdmFyIHJlamVjdCA9IHJldC5fcmVqZWN0O1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBwcm9taXNlcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgICAgICB2YXIgdmFsID0gcHJvbWlzZXNbaV07XG5cbiAgICAgICAgaWYgKHZhbCA9PT0gdm9pZCAwICYmICEoaGFzT3duLmNhbGwocHJvbWlzZXMsIGkpKSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBQcm9taXNlLmNhc3QodmFsKS5fdGhlbihmdWxmaWxsLCByZWplY3QsIHZvaWQgMCwgcmV0LCBudWxsKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRSYWNlKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1JhY2UocHJvbWlzZXMsIHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5yYWNlID0gZnVuY3Rpb24gUHJvbWlzZSRyYWNlKCkge1xuICAgIHJldHVybiBQcm9taXNlJF9SYWNlKHRoaXMsIHZvaWQgMCk7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBjciA9IE9iamVjdC5jcmVhdGU7XG5pZiAoY3IpIHtcbiAgICB2YXIgY2FsbGVyQ2FjaGUgPSBjcihudWxsKTtcbiAgICB2YXIgZ2V0dGVyQ2FjaGUgPSBjcihudWxsKTtcbiAgICBjYWxsZXJDYWNoZVtcIiBzaXplXCJdID0gZ2V0dGVyQ2FjaGVbXCIgc2l6ZVwiXSA9IDA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbnZhciBpc0lkZW50aWZpZXIgPSB1dGlsLmlzSWRlbnRpZmllcjtcblxuZnVuY3Rpb24gbWFrZU1ldGhvZENhbGxlciAobWV0aG9kTmFtZSkge1xuICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJvYmpcIiwgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAndXNlIHN0cmljdCcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBzd2l0Y2gobGVuKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUodGhpc1swXSk7ICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUodGhpc1swXSwgdGhpc1sxXSk7ICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUodGhpc1swXSwgdGhpc1sxXSwgdGhpc1syXSk7ICAgICAgICBcXG5cXFxuICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gb2JqLm1ldGhvZE5hbWUoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIG9iai5tZXRob2ROYW1lLmFwcGx5KG9iaiwgdGhpcyk7ICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBcIi5yZXBsYWNlKC9tZXRob2ROYW1lL2csIG1ldGhvZE5hbWUpKTtcbn1cblxuZnVuY3Rpb24gbWFrZUdldHRlciAocHJvcGVydHlOYW1lKSB7XG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIm9ialwiLCBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICd1c2Ugc3RyaWN0JzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldHVybiBvYmoucHJvcGVydHlOYW1lOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiLnJlcGxhY2UoXCJwcm9wZXJ0eU5hbWVcIiwgcHJvcGVydHlOYW1lKSk7XG59XG5cbmZ1bmN0aW9uIGdldENvbXBpbGVkKG5hbWUsIGNvbXBpbGVyLCBjYWNoZSkge1xuICAgIHZhciByZXQgPSBjYWNoZVtuYW1lXTtcbiAgICBpZiAodHlwZW9mIHJldCAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGlmICghaXNJZGVudGlmaWVyKG5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXQgPSBjb21waWxlcihuYW1lKTtcbiAgICAgICAgY2FjaGVbbmFtZV0gPSByZXQ7XG4gICAgICAgIGNhY2hlW1wiIHNpemVcIl0rKztcbiAgICAgICAgaWYgKGNhY2hlW1wiIHNpemVcIl0gPiA1MTIpIHtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoY2FjaGUpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkgZGVsZXRlIGNhY2hlW2tleXNbaV1dO1xuICAgICAgICAgICAgY2FjaGVbXCIgc2l6ZVwiXSA9IGtleXMubGVuZ3RoIC0gMjU2O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGdldE1ldGhvZENhbGxlcihuYW1lKSB7XG4gICAgcmV0dXJuIGdldENvbXBpbGVkKG5hbWUsIG1ha2VNZXRob2RDYWxsZXIsIGNhbGxlckNhY2hlKTtcbn1cblxuZnVuY3Rpb24gZ2V0R2V0dGVyKG5hbWUpIHtcbiAgICByZXR1cm4gZ2V0Q29tcGlsZWQobmFtZSwgbWFrZUdldHRlciwgZ2V0dGVyQ2FjaGUpO1xufVxuXG5mdW5jdGlvbiBjYWxsZXIob2JqKSB7XG4gICAgcmV0dXJuIG9ialt0aGlzLnBvcCgpXS5hcHBseShvYmosIHRoaXMpO1xufVxuUHJvbWlzZS5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIFByb21pc2UkY2FsbChtZXRob2ROYW1lKSB7XG4gICAgdmFyICRfbGVuID0gYXJndW1lbnRzLmxlbmd0aDt2YXIgYXJncyA9IG5ldyBBcnJheSgkX2xlbiAtIDEpOyBmb3IodmFyICRfaSA9IDE7ICRfaSA8ICRfbGVuOyArKyRfaSkge2FyZ3NbJF9pIC0gMV0gPSBhcmd1bWVudHNbJF9pXTt9XG4gICAgaWYgKGNhbkV2YWx1YXRlKSB7XG4gICAgICAgIHZhciBtYXliZUNhbGxlciA9IGdldE1ldGhvZENhbGxlcihtZXRob2ROYW1lKTtcbiAgICAgICAgaWYgKG1heWJlQ2FsbGVyICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGhlbihtYXliZUNhbGxlciwgdm9pZCAwLCB2b2lkIDAsIGFyZ3MsIHZvaWQgMCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXJncy5wdXNoKG1ldGhvZE5hbWUpO1xuICAgIHJldHVybiB0aGlzLl90aGVuKGNhbGxlciwgdm9pZCAwLCB2b2lkIDAsIGFyZ3MsIHZvaWQgMCk7XG59O1xuXG5mdW5jdGlvbiBuYW1lZEdldHRlcihvYmopIHtcbiAgICByZXR1cm4gb2JqW3RoaXNdO1xufVxuZnVuY3Rpb24gaW5kZXhlZEdldHRlcihvYmopIHtcbiAgICByZXR1cm4gb2JqW3RoaXNdO1xufVxuUHJvbWlzZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gUHJvbWlzZSRnZXQocHJvcGVydHlOYW1lKSB7XG4gICAgdmFyIGlzSW5kZXggPSAodHlwZW9mIHByb3BlcnR5TmFtZSA9PT0gXCJudW1iZXJcIik7XG4gICAgdmFyIGdldHRlcjtcbiAgICBpZiAoIWlzSW5kZXgpIHtcbiAgICAgICAgaWYgKGNhbkV2YWx1YXRlKSB7XG4gICAgICAgICAgICB2YXIgbWF5YmVHZXR0ZXIgPSBnZXRHZXR0ZXIocHJvcGVydHlOYW1lKTtcbiAgICAgICAgICAgIGdldHRlciA9IG1heWJlR2V0dGVyICE9PSBudWxsID8gbWF5YmVHZXR0ZXIgOiBuYW1lZEdldHRlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdldHRlciA9IG5hbWVkR2V0dGVyO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZ2V0dGVyID0gaW5kZXhlZEdldHRlcjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4oZ2V0dGVyLCB2b2lkIDAsIHZvaWQgMCwgcHJvcGVydHlOYW1lLCB2b2lkIDApO1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBhcGlSZWplY3Rpb24sIElOVEVSTkFMLCBjYXN0KSB7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIFR5cGVFcnJvciA9IGVycm9ycy5UeXBlRXJyb3I7XG52YXIgZGVwcmVjYXRlZCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIikuZGVwcmVjYXRlZDtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgeWllbGRIYW5kbGVycyA9IFtdO1xuXG5mdW5jdGlvbiBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcih2YWx1ZSwgeWllbGRIYW5kbGVycykge1xuICAgIHZhciBfZXJyb3JPYmogPSBlcnJvck9iajtcbiAgICB2YXIgX1Byb21pc2UgPSBQcm9taXNlO1xuICAgIHZhciBsZW4gPSB5aWVsZEhhbmRsZXJzLmxlbmd0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaDEoeWllbGRIYW5kbGVyc1tpXSwgdm9pZCAwLCB2YWx1ZSk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IF9lcnJvck9iaikge1xuICAgICAgICAgICAgcmV0dXJuIF9Qcm9taXNlLnJlamVjdChfZXJyb3JPYmouZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmVzdWx0LCBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcik7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBfUHJvbWlzZSkgcmV0dXJuIG1heWJlUHJvbWlzZTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIFByb21pc2VTcGF3bihnZW5lcmF0b3JGdW5jdGlvbiwgcmVjZWl2ZXIsIHlpZWxkSGFuZGxlcikge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgIHRoaXMuX2dlbmVyYXRvckZ1bmN0aW9uID0gZ2VuZXJhdG9yRnVuY3Rpb247XG4gICAgdGhpcy5fcmVjZWl2ZXIgPSByZWNlaXZlcjtcbiAgICB0aGlzLl9nZW5lcmF0b3IgPSB2b2lkIDA7XG4gICAgdGhpcy5feWllbGRIYW5kbGVycyA9IHR5cGVvZiB5aWVsZEhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICA/IFt5aWVsZEhhbmRsZXJdLmNvbmNhdCh5aWVsZEhhbmRsZXJzKVxuICAgICAgICA6IHlpZWxkSGFuZGxlcnM7XG59XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRwcm9taXNlKCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9taXNlO1xufTtcblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fcnVuID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJF9ydW4oKSB7XG4gICAgdGhpcy5fZ2VuZXJhdG9yID0gdGhpcy5fZ2VuZXJhdG9yRnVuY3Rpb24uY2FsbCh0aGlzLl9yZWNlaXZlcik7XG4gICAgdGhpcy5fcmVjZWl2ZXIgPVxuICAgICAgICB0aGlzLl9nZW5lcmF0b3JGdW5jdGlvbiA9IHZvaWQgMDtcbiAgICB0aGlzLl9uZXh0KHZvaWQgMCk7XG59O1xuXG5Qcm9taXNlU3Bhd24ucHJvdG90eXBlLl9jb250aW51ZSA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRfY29udGludWUocmVzdWx0KSB7XG4gICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgdGhpcy5fZ2VuZXJhdG9yID0gdm9pZCAwO1xuICAgICAgICB2YXIgdHJhY2UgPSBlcnJvcnMuY2FuQXR0YWNoKHJlc3VsdC5lKVxuICAgICAgICAgICAgPyByZXN1bHQuZSA6IG5ldyBFcnJvcihyZXN1bHQuZSArIFwiXCIpO1xuICAgICAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHRyYWNlKTtcbiAgICAgICAgdGhpcy5fcHJvbWlzZS5fcmVqZWN0KHJlc3VsdC5lLCB0cmFjZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgaWYgKHJlc3VsdC5kb25lID09PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRvciA9IHZvaWQgMDtcbiAgICAgICAgaWYgKCF0aGlzLl9wcm9taXNlLl90cnlGb2xsb3codmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9taXNlLl9mdWxmaWxsKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHZhbHVlLCB2b2lkIDApO1xuICAgICAgICBpZiAoIShtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgICAgICAgICAgbWF5YmVQcm9taXNlID1cbiAgICAgICAgICAgICAgICBwcm9taXNlRnJvbVlpZWxkSGFuZGxlcihtYXliZVByb21pc2UsIHRoaXMuX3lpZWxkSGFuZGxlcnMpO1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Rocm93KG5ldyBUeXBlRXJyb3IoXCJBIHZhbHVlIHdhcyB5aWVsZGVkIHRoYXQgY291bGQgbm90IGJlIHRyZWF0ZWQgYXMgYSBwcm9taXNlXCIpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbWF5YmVQcm9taXNlLl90aGVuKFxuICAgICAgICAgICAgdGhpcy5fbmV4dCxcbiAgICAgICAgICAgIHRoaXMuX3Rocm93LFxuICAgICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgIG51bGxcbiAgICAgICApO1xuICAgIH1cbn07XG5cblByb21pc2VTcGF3bi5wcm90b3R5cGUuX3Rocm93ID0gZnVuY3Rpb24gUHJvbWlzZVNwYXduJF90aHJvdyhyZWFzb24pIHtcbiAgICBpZiAoZXJyb3JzLmNhbkF0dGFjaChyZWFzb24pKVxuICAgICAgICB0aGlzLl9wcm9taXNlLl9hdHRhY2hFeHRyYVRyYWNlKHJlYXNvbik7XG4gICAgdGhpcy5fY29udGludWUoXG4gICAgICAgIHRyeUNhdGNoMSh0aGlzLl9nZW5lcmF0b3JbXCJ0aHJvd1wiXSwgdGhpcy5fZ2VuZXJhdG9yLCByZWFzb24pXG4gICApO1xufTtcblxuUHJvbWlzZVNwYXduLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uIFByb21pc2VTcGF3biRfbmV4dCh2YWx1ZSkge1xuICAgIHRoaXMuX2NvbnRpbnVlKFxuICAgICAgICB0cnlDYXRjaDEodGhpcy5fZ2VuZXJhdG9yLm5leHQsIHRoaXMuX2dlbmVyYXRvciwgdmFsdWUpXG4gICApO1xufTtcblxuUHJvbWlzZS5jb3JvdXRpbmUgPVxuZnVuY3Rpb24gUHJvbWlzZSRDb3JvdXRpbmUoZ2VuZXJhdG9yRnVuY3Rpb24sIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIGdlbmVyYXRvckZ1bmN0aW9uICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImdlbmVyYXRvckZ1bmN0aW9uIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB9XG4gICAgdmFyIHlpZWxkSGFuZGxlciA9IE9iamVjdChvcHRpb25zKS55aWVsZEhhbmRsZXI7XG4gICAgdmFyIFByb21pc2VTcGF3biQgPSBQcm9taXNlU3Bhd247XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdlbmVyYXRvciA9IGdlbmVyYXRvckZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBzcGF3biA9IG5ldyBQcm9taXNlU3Bhd24kKHZvaWQgMCwgdm9pZCAwLCB5aWVsZEhhbmRsZXIpO1xuICAgICAgICBzcGF3bi5fZ2VuZXJhdG9yID0gZ2VuZXJhdG9yO1xuICAgICAgICBzcGF3bi5fbmV4dCh2b2lkIDApO1xuICAgICAgICByZXR1cm4gc3Bhd24ucHJvbWlzZSgpO1xuICAgIH07XG59O1xuXG5Qcm9taXNlLmNvcm91dGluZS5hZGRZaWVsZEhhbmRsZXIgPSBmdW5jdGlvbihmbikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB5aWVsZEhhbmRsZXJzLnB1c2goZm4pO1xufTtcblxuUHJvbWlzZS5zcGF3biA9IGZ1bmN0aW9uIFByb21pc2UkU3Bhd24oZ2VuZXJhdG9yRnVuY3Rpb24pIHtcbiAgICBkZXByZWNhdGVkKFwiUHJvbWlzZS5zcGF3biBpcyBkZXByZWNhdGVkLiBVc2UgUHJvbWlzZS5jb3JvdXRpbmUgaW5zdGVhZC5cIik7XG4gICAgaWYgKHR5cGVvZiBnZW5lcmF0b3JGdW5jdGlvbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBhcGlSZWplY3Rpb24oXCJnZW5lcmF0b3JGdW5jdGlvbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIHZhciBzcGF3biA9IG5ldyBQcm9taXNlU3Bhd24oZ2VuZXJhdG9yRnVuY3Rpb24sIHRoaXMpO1xuICAgIHZhciByZXQgPSBzcGF3bi5wcm9taXNlKCk7XG4gICAgc3Bhd24uX3J1bihQcm9taXNlLnNwYXduKTtcbiAgICByZXR1cm4gcmV0O1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXksIGFwaVJlamVjdGlvbiwgY2FzdCwgSU5URVJOQUwpIHtcbnZhciB1dGlsID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKTtcbnZhciB0cnlDYXRjaDMgPSB1dGlsLnRyeUNhdGNoMztcbnZhciBlcnJvck9iaiA9IHV0aWwuZXJyb3JPYmo7XG52YXIgUEVORElORyA9IHt9O1xudmFyIEVNUFRZX0FSUkFZID0gW107XG5cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkocHJvbWlzZXMsIGZuLCBsaW1pdCwgX2ZpbHRlcikge1xuICAgIHRoaXMuY29uc3RydWN0b3IkKHByb21pc2VzKTtcbiAgICB0aGlzLl9jYWxsYmFjayA9IGZuO1xuICAgIHRoaXMuX3ByZXNlcnZlZFZhbHVlcyA9IF9maWx0ZXIgPT09IElOVEVSTkFMXG4gICAgICAgID8gbmV3IEFycmF5KHRoaXMubGVuZ3RoKCkpXG4gICAgICAgIDogbnVsbDtcbiAgICB0aGlzLl9saW1pdCA9IGxpbWl0O1xuICAgIHRoaXMuX2luRmxpZ2h0ID0gMDtcbiAgICB0aGlzLl9xdWV1ZSA9IGxpbWl0ID49IDEgPyBbXSA6IEVNUFRZX0FSUkFZO1xuICAgIHRoaXMuX2luaXQkKHZvaWQgMCwgLTIpO1xufVxudXRpbC5pbmhlcml0cyhNYXBwaW5nUHJvbWlzZUFycmF5LCBQcm9taXNlQXJyYXkpO1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX2luaXQoKSB7fTtcblxuTWFwcGluZ1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gTWFwcGluZ1Byb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICB2YXIgdmFsdWVzID0gdGhpcy5fdmFsdWVzO1xuICAgIGlmICh2YWx1ZXMgPT09IG51bGwpIHJldHVybjtcblxuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xuICAgIHZhciBwcmVzZXJ2ZWRWYWx1ZXMgPSB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXM7XG4gICAgdmFyIGxpbWl0ID0gdGhpcy5fbGltaXQ7XG4gICAgaWYgKHZhbHVlc1tpbmRleF0gPT09IFBFTkRJTkcpIHtcbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgICAgICBpZiAobGltaXQgPj0gMSkge1xuICAgICAgICAgICAgdGhpcy5faW5GbGlnaHQtLTtcbiAgICAgICAgICAgIHRoaXMuX2RyYWluUXVldWUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChsaW1pdCA+PSAxICYmIHRoaXMuX2luRmxpZ2h0ID49IGxpbWl0KSB7XG4gICAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9xdWV1ZS5wdXNoKGluZGV4KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJlc2VydmVkVmFsdWVzICE9PSBudWxsKSBwcmVzZXJ2ZWRWYWx1ZXNbaW5kZXhdID0gdmFsdWU7XG5cbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5fY2FsbGJhY2s7XG4gICAgICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3Byb21pc2UuX2JvdW5kVG87XG4gICAgICAgIHZhciByZXQgPSB0cnlDYXRjaDMoY2FsbGJhY2ssIHJlY2VpdmVyLCB2YWx1ZSwgaW5kZXgsIGxlbmd0aCk7XG4gICAgICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSByZXR1cm4gdGhpcy5fcmVqZWN0KHJldC5lKTtcblxuICAgICAgICB2YXIgbWF5YmVQcm9taXNlID0gY2FzdChyZXQsIHZvaWQgMCk7XG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbWl0ID49IDEpIHRoaXMuX2luRmxpZ2h0Kys7XG4gICAgICAgICAgICAgICAgdmFsdWVzW2luZGV4XSA9IFBFTkRJTkc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZS5fcHJveHlQcm9taXNlQXJyYXkodGhpcywgaW5kZXgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldCA9IG1heWJlUHJvbWlzZS52YWx1ZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX3Vuc2V0UmVqZWN0aW9uSXNVbmhhbmRsZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVqZWN0KG1heWJlUHJvbWlzZS5yZWFzb24oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWVzW2luZGV4XSA9IHJldDtcbiAgICB9XG4gICAgdmFyIHRvdGFsUmVzb2x2ZWQgPSArK3RoaXMuX3RvdGFsUmVzb2x2ZWQ7XG4gICAgaWYgKHRvdGFsUmVzb2x2ZWQgPj0gbGVuZ3RoKSB7XG4gICAgICAgIGlmIChwcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbHRlcih2YWx1ZXMsIHByZXNlcnZlZFZhbHVlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgIH1cblxuICAgIH1cbn07XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLl9kcmFpblF1ZXVlID1cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX2RyYWluUXVldWUoKSB7XG4gICAgdmFyIHF1ZXVlID0gdGhpcy5fcXVldWU7XG4gICAgdmFyIGxpbWl0ID0gdGhpcy5fbGltaXQ7XG4gICAgdmFyIHZhbHVlcyA9IHRoaXMuX3ZhbHVlcztcbiAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCAmJiB0aGlzLl9pbkZsaWdodCA8IGxpbWl0KSB7XG4gICAgICAgIHZhciBpbmRleCA9IHF1ZXVlLnBvcCgpO1xuICAgICAgICB0aGlzLl9wcm9taXNlRnVsZmlsbGVkKHZhbHVlc1tpbmRleF0sIGluZGV4KTtcbiAgICB9XG59O1xuXG5NYXBwaW5nUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZmlsdGVyID1cbmZ1bmN0aW9uIE1hcHBpbmdQcm9taXNlQXJyYXkkX2ZpbHRlcihib29sZWFucywgdmFsdWVzKSB7XG4gICAgdmFyIGxlbiA9IHZhbHVlcy5sZW5ndGg7XG4gICAgdmFyIHJldCA9IG5ldyBBcnJheShsZW4pO1xuICAgIHZhciBqID0gMDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgIGlmIChib29sZWFuc1tpXSkgcmV0W2orK10gPSB2YWx1ZXNbaV07XG4gICAgfVxuICAgIHJldC5sZW5ndGggPSBqO1xuICAgIHRoaXMuX3Jlc29sdmUocmV0KTtcbn07XG5cbk1hcHBpbmdQcm9taXNlQXJyYXkucHJvdG90eXBlLnByZXNlcnZlZFZhbHVlcyA9XG5mdW5jdGlvbiBNYXBwaW5nUHJvbWlzZUFycmF5JHByZXNlcnZlVmFsdWVzKCkge1xuICAgIHJldHVybiB0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXM7XG59O1xuXG5mdW5jdGlvbiBtYXAocHJvbWlzZXMsIGZuLCBvcHRpb25zLCBfZmlsdGVyKSB7XG4gICAgdmFyIGxpbWl0ID0gdHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucyAhPT0gbnVsbFxuICAgICAgICA/IG9wdGlvbnMuY29uY3VycmVuY3lcbiAgICAgICAgOiAwO1xuICAgIGxpbWl0ID0gdHlwZW9mIGxpbWl0ID09PSBcIm51bWJlclwiICYmXG4gICAgICAgIGlzRmluaXRlKGxpbWl0KSAmJiBsaW1pdCA+PSAxID8gbGltaXQgOiAwO1xuICAgIHJldHVybiBuZXcgTWFwcGluZ1Byb21pc2VBcnJheShwcm9taXNlcywgZm4sIGxpbWl0LCBfZmlsdGVyKTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gUHJvbWlzZSRtYXAoZm4sIG9wdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG5cbiAgICByZXR1cm4gbWFwKHRoaXMsIGZuLCBvcHRpb25zLCBudWxsKS5wcm9taXNlKCk7XG59O1xuXG5Qcm9taXNlLm1hcCA9IGZ1bmN0aW9uIFByb21pc2UkTWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgX2ZpbHRlcikge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICByZXR1cm4gbWFwKHByb21pc2VzLCBmbiwgb3B0aW9ucywgX2ZpbHRlcikucHJvbWlzZSgpO1xufTtcblxuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgdHJ5Q2F0Y2gyID0gdXRpbC50cnlDYXRjaDI7XG52YXIgdHJ5Q2F0Y2gxID0gdXRpbC50cnlDYXRjaDE7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuXG5mdW5jdGlvbiB0aHJvd2VyKHIpIHtcbiAgICB0aHJvdyByO1xufVxuXG5mdW5jdGlvbiBQcm9taXNlJF9zcHJlYWRBZGFwdGVyKHZhbCwgcmVjZWl2ZXIpIHtcbiAgICBpZiAoIXV0aWwuaXNBcnJheSh2YWwpKSByZXR1cm4gUHJvbWlzZSRfc3VjY2Vzc0FkYXB0ZXIodmFsLCByZWNlaXZlcik7XG4gICAgdmFyIHJldCA9IHV0aWwudHJ5Q2F0Y2hBcHBseSh0aGlzLCBbbnVsbF0uY29uY2F0KHZhbCksIHJlY2VpdmVyKTtcbiAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aHJvd2VyLCB2b2lkIDAsIHJldC5lKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFByb21pc2UkX3N1Y2Nlc3NBZGFwdGVyKHZhbCwgcmVjZWl2ZXIpIHtcbiAgICB2YXIgbm9kZWJhY2sgPSB0aGlzO1xuICAgIHZhciByZXQgPSB2YWwgPT09IHZvaWQgMFxuICAgICAgICA/IHRyeUNhdGNoMShub2RlYmFjaywgcmVjZWl2ZXIsIG51bGwpXG4gICAgICAgIDogdHJ5Q2F0Y2gyKG5vZGViYWNrLCByZWNlaXZlciwgbnVsbCwgdmFsKTtcbiAgICBpZiAocmV0ID09PSBlcnJvck9iaikge1xuICAgICAgICBhc3luYy5pbnZva2VMYXRlcih0aHJvd2VyLCB2b2lkIDAsIHJldC5lKTtcbiAgICB9XG59XG5mdW5jdGlvbiBQcm9taXNlJF9lcnJvckFkYXB0ZXIocmVhc29uLCByZWNlaXZlcikge1xuICAgIHZhciBub2RlYmFjayA9IHRoaXM7XG4gICAgdmFyIHJldCA9IHRyeUNhdGNoMShub2RlYmFjaywgcmVjZWl2ZXIsIHJlYXNvbik7XG4gICAgaWYgKHJldCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgYXN5bmMuaW52b2tlTGF0ZXIodGhyb3dlciwgdm9pZCAwLCByZXQuZSk7XG4gICAgfVxufVxuXG5Qcm9taXNlLnByb3RvdHlwZS5ub2RlaWZ5ID0gZnVuY3Rpb24gUHJvbWlzZSRub2RlaWZ5KG5vZGViYWNrLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBub2RlYmFjayA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdmFyIGFkYXB0ZXIgPSBQcm9taXNlJF9zdWNjZXNzQWRhcHRlcjtcbiAgICAgICAgaWYgKG9wdGlvbnMgIT09IHZvaWQgMCAmJiBPYmplY3Qob3B0aW9ucykuc3ByZWFkKSB7XG4gICAgICAgICAgICBhZGFwdGVyID0gUHJvbWlzZSRfc3ByZWFkQWRhcHRlcjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90aGVuKFxuICAgICAgICAgICAgYWRhcHRlcixcbiAgICAgICAgICAgIFByb21pc2UkX2Vycm9yQWRhcHRlcixcbiAgICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICAgIG5vZGViYWNrLFxuICAgICAgICAgICAgdGhpcy5fYm91bmRUb1xuICAgICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSwgUHJvbWlzZUFycmF5LCBhcGlSZWplY3Rpb24sIGNhc3QsIElOVEVSTkFMKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgdHJ5Q2F0Y2g0ID0gdXRpbC50cnlDYXRjaDQ7XG52YXIgdHJ5Q2F0Y2gzID0gdXRpbC50cnlDYXRjaDM7XG52YXIgZXJyb3JPYmogPSB1dGlsLmVycm9yT2JqO1xuZnVuY3Rpb24gUmVkdWN0aW9uUHJvbWlzZUFycmF5KHByb21pc2VzLCBmbiwgYWNjdW0sIF9lYWNoKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQocHJvbWlzZXMpO1xuICAgIHRoaXMuX3ByZXNlcnZlZFZhbHVlcyA9IF9lYWNoID09PSBJTlRFUk5BTCA/IFtdIDogbnVsbDtcbiAgICB0aGlzLl96ZXJvdGhJc0FjY3VtID0gKGFjY3VtID09PSB2b2lkIDApO1xuICAgIHRoaXMuX2dvdEFjY3VtID0gZmFsc2U7XG4gICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9ICh0aGlzLl96ZXJvdGhJc0FjY3VtID8gMSA6IDApO1xuICAgIHRoaXMuX3ZhbHVlc1BoYXNlID0gdW5kZWZpbmVkO1xuXG4gICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QoYWNjdW0sIHZvaWQgMCk7XG4gICAgdmFyIHJlamVjdGVkID0gZmFsc2U7XG4gICAgdmFyIGlzUHJvbWlzZSA9IG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2U7XG4gICAgaWYgKGlzUHJvbWlzZSkge1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICBtYXliZVByb21pc2UuX3Byb3h5UHJvbWlzZUFycmF5KHRoaXMsIC0xKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXliZVByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgICAgICAgICAgYWNjdW0gPSBtYXliZVByb21pc2UudmFsdWUoKTtcbiAgICAgICAgICAgIHRoaXMuX2dvdEFjY3VtID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgdGhpcy5fcmVqZWN0KG1heWJlUHJvbWlzZS5yZWFzb24oKSk7XG4gICAgICAgICAgICByZWplY3RlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCEoaXNQcm9taXNlIHx8IHRoaXMuX3plcm90aElzQWNjdW0pKSB0aGlzLl9nb3RBY2N1bSA9IHRydWU7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSBmbjtcbiAgICB0aGlzLl9hY2N1bSA9IGFjY3VtO1xuICAgIGlmICghcmVqZWN0ZWQpIHRoaXMuX2luaXQkKHZvaWQgMCwgLTUpO1xufVxudXRpbC5pbmhlcml0cyhSZWR1Y3Rpb25Qcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblJlZHVjdGlvblByb21pc2VBcnJheS5wcm90b3R5cGUuX2luaXQgPVxuZnVuY3Rpb24gUmVkdWN0aW9uUHJvbWlzZUFycmF5JF9pbml0KCkge307XG5cblJlZHVjdGlvblByb21pc2VBcnJheS5wcm90b3R5cGUuX3Jlc29sdmVFbXB0eUFycmF5ID1cbmZ1bmN0aW9uIFJlZHVjdGlvblByb21pc2VBcnJheSRfcmVzb2x2ZUVtcHR5QXJyYXkoKSB7XG4gICAgaWYgKHRoaXMuX2dvdEFjY3VtIHx8IHRoaXMuX3plcm90aElzQWNjdW0pIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl9wcmVzZXJ2ZWRWYWx1ZXMgIT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgID8gW10gOiB0aGlzLl9hY2N1bSk7XG4gICAgfVxufTtcblxuUmVkdWN0aW9uUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fcHJvbWlzZUZ1bGZpbGxlZCA9XG5mdW5jdGlvbiBSZWR1Y3Rpb25Qcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgdmFyIHZhbHVlcyA9IHRoaXMuX3ZhbHVlcztcbiAgICBpZiAodmFsdWVzID09PSBudWxsKSByZXR1cm47XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoKCk7XG4gICAgdmFyIHByZXNlcnZlZFZhbHVlcyA9IHRoaXMuX3ByZXNlcnZlZFZhbHVlcztcbiAgICB2YXIgaXNFYWNoID0gcHJlc2VydmVkVmFsdWVzICE9PSBudWxsO1xuICAgIHZhciBnb3RBY2N1bSA9IHRoaXMuX2dvdEFjY3VtO1xuICAgIHZhciB2YWx1ZXNQaGFzZSA9IHRoaXMuX3ZhbHVlc1BoYXNlO1xuICAgIHZhciB2YWx1ZXNQaGFzZUluZGV4O1xuICAgIGlmICghdmFsdWVzUGhhc2UpIHtcbiAgICAgICAgdmFsdWVzUGhhc2UgPSB0aGlzLl92YWx1ZXNQaGFzZSA9IEFycmF5KGxlbmd0aCk7XG4gICAgICAgIGZvciAodmFsdWVzUGhhc2VJbmRleD0wOyB2YWx1ZXNQaGFzZUluZGV4PGxlbmd0aDsgKyt2YWx1ZXNQaGFzZUluZGV4KSB7XG4gICAgICAgICAgICB2YWx1ZXNQaGFzZVt2YWx1ZXNQaGFzZUluZGV4XSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFsdWVzUGhhc2VJbmRleCA9IHZhbHVlc1BoYXNlW2luZGV4XTtcblxuICAgIGlmIChpbmRleCA9PT0gMCAmJiB0aGlzLl96ZXJvdGhJc0FjY3VtKSB7XG4gICAgICAgIGlmICghZ290QWNjdW0pIHtcbiAgICAgICAgICAgIHRoaXMuX2FjY3VtID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9nb3RBY2N1bSA9IGdvdEFjY3VtID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YWx1ZXNQaGFzZVtpbmRleF0gPSAoKHZhbHVlc1BoYXNlSW5kZXggPT09IDApXG4gICAgICAgICAgICA/IDEgOiAyKTtcbiAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgICBpZiAoIWdvdEFjY3VtKSB7XG4gICAgICAgICAgICB0aGlzLl9hY2N1bSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fZ290QWNjdW0gPSBnb3RBY2N1bSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodmFsdWVzUGhhc2VJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgdmFsdWVzUGhhc2VbaW5kZXhdID0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlc1BoYXNlW2luZGV4XSA9IDI7XG4gICAgICAgICAgICBpZiAoZ290QWNjdW0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY2N1bSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghZ290QWNjdW0pIHJldHVybjtcblxuICAgIHZhciBjYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrO1xuICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3Byb21pc2UuX2JvdW5kVG87XG4gICAgdmFyIHJldDtcblxuICAgIGZvciAodmFyIGkgPSB0aGlzLl9yZWR1Y2luZ0luZGV4OyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFsdWVzUGhhc2VJbmRleCA9IHZhbHVlc1BoYXNlW2ldO1xuICAgICAgICBpZiAodmFsdWVzUGhhc2VJbmRleCA9PT0gMikge1xuICAgICAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9IGkgKyAxO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlc1BoYXNlSW5kZXggIT09IDEpIHJldHVybjtcblxuICAgICAgICB2YWx1ZSA9IHZhbHVlc1tpXTtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLl9zZXR0bGVkVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLmlzUGVuZGluZygpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZS5fdW5zZXRSZWplY3Rpb25Jc1VuaGFuZGxlZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3QodmFsdWUucmVhc29uKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzRWFjaCkge1xuICAgICAgICAgICAgcHJlc2VydmVkVmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgcmV0ID0gdHJ5Q2F0Y2gzKGNhbGxiYWNrLCByZWNlaXZlciwgdmFsdWUsIGksIGxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXQgPSB0cnlDYXRjaDQoY2FsbGJhY2ssIHJlY2VpdmVyLCB0aGlzLl9hY2N1bSwgdmFsdWUsIGksIGxlbmd0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmV0ID09PSBlcnJvck9iaikgcmV0dXJuIHRoaXMuX3JlamVjdChyZXQuZSk7XG5cbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QocmV0LCB2b2lkIDApO1xuICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZS5pc1BlbmRpbmcoKSkge1xuICAgICAgICAgICAgICAgIHZhbHVlc1BoYXNlW2ldID0gNDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl9wcm94eVByb21pc2VBcnJheSh0aGlzLCBpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF5YmVQcm9taXNlLmlzRnVsZmlsbGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXQgPSBtYXliZVByb21pc2UudmFsdWUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlLl91bnNldFJlamVjdGlvbklzVW5oYW5kbGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdChtYXliZVByb21pc2UucmVhc29uKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcmVkdWNpbmdJbmRleCA9IGkgKyAxO1xuICAgICAgICB0aGlzLl9hY2N1bSA9IHJldDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fcmVkdWNpbmdJbmRleCA8IGxlbmd0aCkgcmV0dXJuO1xuICAgIHRoaXMuX3Jlc29sdmUoaXNFYWNoID8gcHJlc2VydmVkVmFsdWVzIDogdGhpcy5fYWNjdW0pO1xufTtcblxuZnVuY3Rpb24gcmVkdWNlKHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCkge1xuICAgIGlmICh0eXBlb2YgZm4gIT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIGFwaVJlamVjdGlvbihcImZuIG11c3QgYmUgYSBmdW5jdGlvblwiKTtcbiAgICB2YXIgYXJyYXkgPSBuZXcgUmVkdWN0aW9uUHJvbWlzZUFycmF5KHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCk7XG4gICAgcmV0dXJuIGFycmF5LnByb21pc2UoKTtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUucmVkdWNlID0gZnVuY3Rpb24gUHJvbWlzZSRyZWR1Y2UoZm4sIGluaXRpYWxWYWx1ZSkge1xuICAgIHJldHVybiByZWR1Y2UodGhpcywgZm4sIGluaXRpYWxWYWx1ZSwgbnVsbCk7XG59O1xuXG5Qcm9taXNlLnJlZHVjZSA9IGZ1bmN0aW9uIFByb21pc2UkUmVkdWNlKHByb21pc2VzLCBmbiwgaW5pdGlhbFZhbHVlLCBfZWFjaCkge1xuICAgIHJldHVybiByZWR1Y2UocHJvbWlzZXMsIGZuLCBpbml0aWFsVmFsdWUsIF9lYWNoKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID1cbiAgICBmdW5jdGlvbihQcm9taXNlLCBQcm9taXNlQXJyYXkpIHtcbnZhciBQcm9taXNlSW5zcGVjdGlvbiA9IFByb21pc2UuUHJvbWlzZUluc3BlY3Rpb247XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG5cbmZ1bmN0aW9uIFNldHRsZWRQcm9taXNlQXJyYXkodmFsdWVzKSB7XG4gICAgdGhpcy5jb25zdHJ1Y3RvciQodmFsdWVzKTtcbn1cbnV0aWwuaW5oZXJpdHMoU2V0dGxlZFByb21pc2VBcnJheSwgUHJvbWlzZUFycmF5KTtcblxuU2V0dGxlZFByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VSZXNvbHZlZCA9XG5mdW5jdGlvbiBTZXR0bGVkUHJvbWlzZUFycmF5JF9wcm9taXNlUmVzb2x2ZWQoaW5kZXgsIGluc3BlY3Rpb24pIHtcbiAgICB0aGlzLl92YWx1ZXNbaW5kZXhdID0gaW5zcGVjdGlvbjtcbiAgICB2YXIgdG90YWxSZXNvbHZlZCA9ICsrdGhpcy5fdG90YWxSZXNvbHZlZDtcbiAgICBpZiAodG90YWxSZXNvbHZlZCA+PSB0aGlzLl9sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXMpO1xuICAgIH1cbn07XG5cblNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFNldHRsZWRQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUsIGluZGV4KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHZhciByZXQgPSBuZXcgUHJvbWlzZUluc3BlY3Rpb24oKTtcbiAgICByZXQuX2JpdEZpZWxkID0gMjY4NDM1NDU2O1xuICAgIHJldC5fc2V0dGxlZFZhbHVlID0gdmFsdWU7XG4gICAgdGhpcy5fcHJvbWlzZVJlc29sdmVkKGluZGV4LCByZXQpO1xufTtcblNldHRsZWRQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlUmVqZWN0ZWQgPVxuZnVuY3Rpb24gU2V0dGxlZFByb21pc2VBcnJheSRfcHJvbWlzZVJlamVjdGVkKHJlYXNvbiwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdmFyIHJldCA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgIHJldC5fYml0RmllbGQgPSAxMzQyMTc3Mjg7XG4gICAgcmV0Ll9zZXR0bGVkVmFsdWUgPSByZWFzb247XG4gICAgdGhpcy5fcHJvbWlzZVJlc29sdmVkKGluZGV4LCByZXQpO1xufTtcblxuUHJvbWlzZS5zZXR0bGUgPSBmdW5jdGlvbiBQcm9taXNlJFNldHRsZShwcm9taXNlcykge1xuICAgIHJldHVybiBuZXcgU2V0dGxlZFByb21pc2VBcnJheShwcm9taXNlcykucHJvbWlzZSgpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUuc2V0dGxlID0gZnVuY3Rpb24gUHJvbWlzZSRzZXR0bGUoKSB7XG4gICAgcmV0dXJuIG5ldyBTZXR0bGVkUHJvbWlzZUFycmF5KHRoaXMpLnByb21pc2UoKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID1cbmZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgYXBpUmVqZWN0aW9uKSB7XG52YXIgdXRpbCA9IHJlcXVpcmUoXCIuL3V0aWwuanNcIik7XG52YXIgUmFuZ2VFcnJvciA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5SYW5nZUVycm9yO1xudmFyIEFnZ3JlZ2F0ZUVycm9yID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpLkFnZ3JlZ2F0ZUVycm9yO1xudmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXk7XG5cblxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSh2YWx1ZXMpIHtcbiAgICB0aGlzLmNvbnN0cnVjdG9yJCh2YWx1ZXMpO1xuICAgIHRoaXMuX2hvd01hbnkgPSAwO1xuICAgIHRoaXMuX3Vud3JhcCA9IGZhbHNlO1xuICAgIHRoaXMuX2luaXRpYWxpemVkID0gZmFsc2U7XG59XG51dGlsLmluaGVyaXRzKFNvbWVQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfaW5pdCgpIHtcbiAgICBpZiAoIXRoaXMuX2luaXRpYWxpemVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuX2hvd01hbnkgPT09IDApIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZShbXSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5faW5pdCQodm9pZCAwLCAtNSk7XG4gICAgdmFyIGlzQXJyYXlSZXNvbHZlZCA9IGlzQXJyYXkodGhpcy5fdmFsdWVzKTtcbiAgICBpZiAoIXRoaXMuX2lzUmVzb2x2ZWQoKSAmJlxuICAgICAgICBpc0FycmF5UmVzb2x2ZWQgJiZcbiAgICAgICAgdGhpcy5faG93TWFueSA+IHRoaXMuX2NhblBvc3NpYmx5RnVsZmlsbCgpKSB7XG4gICAgICAgIHRoaXMuX3JlamVjdCh0aGlzLl9nZXRSYW5nZUVycm9yKHRoaXMubGVuZ3RoKCkpKTtcbiAgICB9XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRpbml0KCkge1xuICAgIHRoaXMuX2luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB0aGlzLl9pbml0KCk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zZXRVbndyYXAgPSBmdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JHNldFVud3JhcCgpIHtcbiAgICB0aGlzLl91bndyYXAgPSB0cnVlO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuaG93TWFueSA9IGZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkaG93TWFueSgpIHtcbiAgICByZXR1cm4gdGhpcy5faG93TWFueTtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLnNldEhvd01hbnkgPVxuZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRzZXRIb3dNYW55KGNvdW50KSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX2hvd01hbnkgPSBjb3VudDtcbn07XG5cblNvbWVQcm9taXNlQXJyYXkucHJvdG90eXBlLl9wcm9taXNlRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX3Byb21pc2VGdWxmaWxsZWQodmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fYWRkRnVsZmlsbGVkKHZhbHVlKTtcbiAgICBpZiAodGhpcy5fZnVsZmlsbGVkKCkgPT09IHRoaXMuaG93TWFueSgpKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlcy5sZW5ndGggPSB0aGlzLmhvd01hbnkoKTtcbiAgICAgICAgaWYgKHRoaXMuaG93TWFueSgpID09PSAxICYmIHRoaXMuX3Vud3JhcCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLl92YWx1ZXMpO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VSZWplY3RlZCA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9wcm9taXNlUmVqZWN0ZWQocmVhc29uKSB7XG4gICAgaWYgKHRoaXMuX2lzUmVzb2x2ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX2FkZFJlamVjdGVkKHJlYXNvbik7XG4gICAgaWYgKHRoaXMuaG93TWFueSgpID4gdGhpcy5fY2FuUG9zc2libHlGdWxmaWxsKCkpIHtcbiAgICAgICAgdmFyIGUgPSBuZXcgQWdncmVnYXRlRXJyb3IoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMubGVuZ3RoKCk7IGkgPCB0aGlzLl92YWx1ZXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIGUucHVzaCh0aGlzLl92YWx1ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlamVjdChlKTtcbiAgICB9XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZnVsZmlsbGVkID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfZnVsZmlsbGVkKCkge1xuICAgIHJldHVybiB0aGlzLl90b3RhbFJlc29sdmVkO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3JlamVjdGVkID0gZnVuY3Rpb24gU29tZVByb21pc2VBcnJheSRfcmVqZWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlcy5sZW5ndGggLSB0aGlzLmxlbmd0aCgpO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX2FkZFJlamVjdGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2FkZFJlamVjdGVkKHJlYXNvbikge1xuICAgIHRoaXMuX3ZhbHVlcy5wdXNoKHJlYXNvbik7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fYWRkRnVsZmlsbGVkID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2FkZEZ1bGZpbGxlZCh2YWx1ZSkge1xuICAgIHRoaXMuX3ZhbHVlc1t0aGlzLl90b3RhbFJlc29sdmVkKytdID0gdmFsdWU7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fY2FuUG9zc2libHlGdWxmaWxsID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX2NhblBvc3NpYmx5RnVsZmlsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5sZW5ndGgoKSAtIHRoaXMuX3JlamVjdGVkKCk7XG59O1xuXG5Tb21lUHJvbWlzZUFycmF5LnByb3RvdHlwZS5fZ2V0UmFuZ2VFcnJvciA9XG5mdW5jdGlvbiBTb21lUHJvbWlzZUFycmF5JF9nZXRSYW5nZUVycm9yKGNvdW50KSB7XG4gICAgdmFyIG1lc3NhZ2UgPSBcIklucHV0IGFycmF5IG11c3QgY29udGFpbiBhdCBsZWFzdCBcIiArXG4gICAgICAgICAgICB0aGlzLl9ob3dNYW55ICsgXCIgaXRlbXMgYnV0IGNvbnRhaW5zIG9ubHkgXCIgKyBjb3VudCArIFwiIGl0ZW1zXCI7XG4gICAgcmV0dXJuIG5ldyBSYW5nZUVycm9yKG1lc3NhZ2UpO1xufTtcblxuU29tZVByb21pc2VBcnJheS5wcm90b3R5cGUuX3Jlc29sdmVFbXB0eUFycmF5ID1cbmZ1bmN0aW9uIFNvbWVQcm9taXNlQXJyYXkkX3Jlc29sdmVFbXB0eUFycmF5KCkge1xuICAgIHRoaXMuX3JlamVjdCh0aGlzLl9nZXRSYW5nZUVycm9yKDApKTtcbn07XG5cbmZ1bmN0aW9uIFByb21pc2UkX1NvbWUocHJvbWlzZXMsIGhvd01hbnkpIHtcbiAgICBpZiAoKGhvd01hbnkgfCAwKSAhPT0gaG93TWFueSB8fCBob3dNYW55IDwgMCkge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiZXhwZWN0aW5nIGEgcG9zaXRpdmUgaW50ZWdlclwiKTtcbiAgICB9XG4gICAgdmFyIHJldCA9IG5ldyBTb21lUHJvbWlzZUFycmF5KHByb21pc2VzKTtcbiAgICB2YXIgcHJvbWlzZSA9IHJldC5wcm9taXNlKCk7XG4gICAgaWYgKHByb21pc2UuaXNSZWplY3RlZCgpKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH1cbiAgICByZXQuc2V0SG93TWFueShob3dNYW55KTtcbiAgICByZXQuaW5pdCgpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuXG5Qcm9taXNlLnNvbWUgPSBmdW5jdGlvbiBQcm9taXNlJFNvbWUocHJvbWlzZXMsIGhvd01hbnkpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfU29tZShwcm9taXNlcywgaG93TWFueSk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5zb21lID0gZnVuY3Rpb24gUHJvbWlzZSRzb21lKGhvd01hbnkpIHtcbiAgICByZXR1cm4gUHJvbWlzZSRfU29tZSh0aGlzLCBob3dNYW55KTtcbn07XG5cblByb21pc2UuX1NvbWVQcm9taXNlQXJyYXkgPSBTb21lUHJvbWlzZUFycmF5O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFzeW5jID0gcmVxdWlyZShcIi4vYXN5bmMuanNcIik7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIHRyeUNhdGNoMSA9IHV0aWwudHJ5Q2F0Y2gxO1xudmFyIGVycm9yT2JqID0gdXRpbC5lcnJvck9iajtcblxuUHJvbWlzZS5wcm90b3R5cGUucHJvZ3Jlc3NlZCA9IGZ1bmN0aW9uIFByb21pc2UkcHJvZ3Jlc3NlZChoYW5kbGVyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3RoZW4odm9pZCAwLCB2b2lkIDAsIGhhbmRsZXIsIHZvaWQgMCwgdm9pZCAwKTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9wcm9ncmVzcyA9IGZ1bmN0aW9uIFByb21pc2UkX3Byb2dyZXNzKHByb2dyZXNzVmFsdWUpIHtcbiAgICBpZiAodGhpcy5faXNGb2xsb3dpbmdPckZ1bGZpbGxlZE9yUmVqZWN0ZWQoKSkgcmV0dXJuO1xuICAgIHRoaXMuX3Byb2dyZXNzVW5jaGVja2VkKHByb2dyZXNzVmFsdWUpO1xuXG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvZ3Jlc3NIYW5kbGVyQXQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJvZ3Jlc3NIYW5kbGVyQXQoaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggPT09IDBcbiAgICAgICAgPyB0aGlzLl9wcm9ncmVzc0hhbmRsZXIwXG4gICAgICAgIDogdGhpc1soaW5kZXggPDwgMikgKyBpbmRleCAtIDUgKyAyXTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLl9kb1Byb2dyZXNzV2l0aCA9XG5mdW5jdGlvbiBQcm9taXNlJF9kb1Byb2dyZXNzV2l0aChwcm9ncmVzc2lvbikge1xuICAgIHZhciBwcm9ncmVzc1ZhbHVlID0gcHJvZ3Jlc3Npb24udmFsdWU7XG4gICAgdmFyIGhhbmRsZXIgPSBwcm9ncmVzc2lvbi5oYW5kbGVyO1xuICAgIHZhciBwcm9taXNlID0gcHJvZ3Jlc3Npb24ucHJvbWlzZTtcbiAgICB2YXIgcmVjZWl2ZXIgPSBwcm9ncmVzc2lvbi5yZWNlaXZlcjtcblxuICAgIHZhciByZXQgPSB0cnlDYXRjaDEoaGFuZGxlciwgcmVjZWl2ZXIsIHByb2dyZXNzVmFsdWUpO1xuICAgIGlmIChyZXQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIGlmIChyZXQuZSAhPSBudWxsICYmXG4gICAgICAgICAgICByZXQuZS5uYW1lICE9PSBcIlN0b3BQcm9ncmVzc1Byb3BhZ2F0aW9uXCIpIHtcbiAgICAgICAgICAgIHZhciB0cmFjZSA9IGVycm9ycy5jYW5BdHRhY2gocmV0LmUpXG4gICAgICAgICAgICAgICAgPyByZXQuZSA6IG5ldyBFcnJvcihyZXQuZSArIFwiXCIpO1xuICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh0cmFjZSk7XG4gICAgICAgICAgICBwcm9taXNlLl9wcm9ncmVzcyhyZXQuZSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHJldCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0Ll90aGVuKHByb21pc2UuX3Byb2dyZXNzLCBudWxsLCBudWxsLCBwcm9taXNlLCB2b2lkIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHByb21pc2UuX3Byb2dyZXNzKHJldCk7XG4gICAgfVxufTtcblxuXG5Qcm9taXNlLnByb3RvdHlwZS5fcHJvZ3Jlc3NVbmNoZWNrZWQgPVxuZnVuY3Rpb24gUHJvbWlzZSRfcHJvZ3Jlc3NVbmNoZWNrZWQocHJvZ3Jlc3NWYWx1ZSkge1xuICAgIGlmICghdGhpcy5pc1BlbmRpbmcoKSkgcmV0dXJuO1xuICAgIHZhciBsZW4gPSB0aGlzLl9sZW5ndGgoKTtcbiAgICB2YXIgcHJvZ3Jlc3MgPSB0aGlzLl9wcm9ncmVzcztcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gdGhpcy5fcHJvZ3Jlc3NIYW5kbGVyQXQoaSk7XG4gICAgICAgIHZhciBwcm9taXNlID0gdGhpcy5fcHJvbWlzZUF0KGkpO1xuICAgICAgICBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcbiAgICAgICAgICAgIHZhciByZWNlaXZlciA9IHRoaXMuX3JlY2VpdmVyQXQoaSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGhhbmRsZXIuY2FsbChyZWNlaXZlciwgcHJvZ3Jlc3NWYWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyIGluc3RhbmNlb2YgUHJvbWlzZSAmJiByZWNlaXZlci5faXNQcm94aWVkKCkpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlci5fcHJvZ3Jlc3NVbmNoZWNrZWQocHJvZ3Jlc3NWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyIGluc3RhbmNlb2YgUHJvbWlzZUFycmF5KSB7XG4gICAgICAgICAgICAgICAgcmVjZWl2ZXIuX3Byb21pc2VQcm9ncmVzc2VkKHByb2dyZXNzVmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgYXN5bmMuaW52b2tlKHRoaXMuX2RvUHJvZ3Jlc3NXaXRoLCB0aGlzLCB7XG4gICAgICAgICAgICAgICAgaGFuZGxlcjogaGFuZGxlcixcbiAgICAgICAgICAgICAgICBwcm9taXNlOiBwcm9taXNlLFxuICAgICAgICAgICAgICAgIHJlY2VpdmVyOiB0aGlzLl9yZWNlaXZlckF0KGkpLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBwcm9ncmVzc1ZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFzeW5jLmludm9rZShwcm9ncmVzcywgcHJvbWlzZSwgcHJvZ3Jlc3NWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgZXJyb3JzID0gcmVxdWlyZShcIi4vZXJyb3JzLmpzXCIpO1xudmFyIGNhbkF0dGFjaCA9IGVycm9ycy5jYW5BdHRhY2g7XG52YXIgYXN5bmMgPSByZXF1aXJlKFwiLi9hc3luYy5qc1wiKTtcbnZhciBDYW5jZWxsYXRpb25FcnJvciA9IGVycm9ycy5DYW5jZWxsYXRpb25FcnJvcjtcblxuUHJvbWlzZS5wcm90b3R5cGUuX2NhbmNlbCA9IGZ1bmN0aW9uIFByb21pc2UkX2NhbmNlbChyZWFzb24pIHtcbiAgICBpZiAoIXRoaXMuaXNDYW5jZWxsYWJsZSgpKSByZXR1cm4gdGhpcztcbiAgICB2YXIgcGFyZW50O1xuICAgIHZhciBwcm9taXNlVG9SZWplY3QgPSB0aGlzO1xuICAgIHdoaWxlICgocGFyZW50ID0gcHJvbWlzZVRvUmVqZWN0Ll9jYW5jZWxsYXRpb25QYXJlbnQpICE9PSB2b2lkIDAgJiZcbiAgICAgICAgcGFyZW50LmlzQ2FuY2VsbGFibGUoKSkge1xuICAgICAgICBwcm9taXNlVG9SZWplY3QgPSBwYXJlbnQ7XG4gICAgfVxuICAgIHByb21pc2VUb1JlamVjdC5fYXR0YWNoRXh0cmFUcmFjZShyZWFzb24pO1xuICAgIHByb21pc2VUb1JlamVjdC5fcmVqZWN0VW5jaGVja2VkKHJlYXNvbik7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiBQcm9taXNlJGNhbmNlbChyZWFzb24pIHtcbiAgICBpZiAoIXRoaXMuaXNDYW5jZWxsYWJsZSgpKSByZXR1cm4gdGhpcztcbiAgICByZWFzb24gPSByZWFzb24gIT09IHZvaWQgMFxuICAgICAgICA/IChjYW5BdHRhY2gocmVhc29uKSA/IHJlYXNvbiA6IG5ldyBFcnJvcihyZWFzb24gKyBcIlwiKSlcbiAgICAgICAgOiBuZXcgQ2FuY2VsbGF0aW9uRXJyb3IoKTtcbiAgICBhc3luYy5pbnZva2VMYXRlcih0aGlzLl9jYW5jZWwsIHRoaXMsIHJlYXNvbik7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS5jYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkY2FuY2VsbGFibGUoKSB7XG4gICAgaWYgKHRoaXMuX2NhbmNlbGxhYmxlKCkpIHJldHVybiB0aGlzO1xuICAgIHRoaXMuX3NldENhbmNlbGxhYmxlKCk7XG4gICAgdGhpcy5fY2FuY2VsbGF0aW9uUGFyZW50ID0gdm9pZCAwO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudW5jYW5jZWxsYWJsZSA9IGZ1bmN0aW9uIFByb21pc2UkdW5jYW5jZWxsYWJsZSgpIHtcbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCAyIHwgNCk7XG4gICAgcmV0Ll9mb2xsb3codGhpcyk7XG4gICAgcmV0Ll91bnNldENhbmNlbGxhYmxlKCk7XG4gICAgcmV0dXJuIHJldDtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmZvcmsgPVxuZnVuY3Rpb24gUHJvbWlzZSRmb3JrKGRpZEZ1bGZpbGwsIGRpZFJlamVjdCwgZGlkUHJvZ3Jlc3MpIHtcbiAgICB2YXIgcmV0ID0gdGhpcy5fdGhlbihkaWRGdWxmaWxsLCBkaWRSZWplY3QsIGRpZFByb2dyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCwgdm9pZCAwKTtcblxuICAgIHJldC5fc2V0Q2FuY2VsbGFibGUoKTtcbiAgICByZXQuX2NhbmNlbGxhdGlvblBhcmVudCA9IHZvaWQgMDtcbiAgICByZXR1cm4gcmV0O1xufTtcbn07XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoUHJvbWlzZSwgYXBpUmVqZWN0aW9uLCBjYXN0KSB7XG4gICAgdmFyIFR5cGVFcnJvciA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKS5UeXBlRXJyb3I7XG4gICAgdmFyIGluaGVyaXRzID0gcmVxdWlyZShcIi4vdXRpbC5qc1wiKS5pbmhlcml0cztcbiAgICB2YXIgUHJvbWlzZUluc3BlY3Rpb24gPSBQcm9taXNlLlByb21pc2VJbnNwZWN0aW9uO1xuXG4gICAgZnVuY3Rpb24gaW5zcGVjdGlvbk1hcHBlcihpbnNwZWN0aW9ucykge1xuICAgICAgICB2YXIgbGVuID0gaW5zcGVjdGlvbnMubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IGluc3BlY3Rpb25zW2ldO1xuICAgICAgICAgICAgaWYgKGluc3BlY3Rpb24uaXNSZWplY3RlZCgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGluc3BlY3Rpb24uZXJyb3IoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnNwZWN0aW9uc1tpXSA9IGluc3BlY3Rpb24udmFsdWUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zcGVjdGlvbnM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdGhyb3dlcihlKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aHJvdyBlO30sIDApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3Bvc2UocmVzb3VyY2VzLCBpbnNwZWN0aW9uKSB7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGxlbiA9IHJlc291cmNlcy5sZW5ndGg7XG4gICAgICAgIHZhciByZXQgPSBQcm9taXNlLmRlZmVyKCk7XG4gICAgICAgIGZ1bmN0aW9uIGl0ZXJhdG9yKCkge1xuICAgICAgICAgICAgaWYgKGkgPj0gbGVuKSByZXR1cm4gcmV0LnJlc29sdmUoKTtcbiAgICAgICAgICAgIHZhciBtYXliZVByb21pc2UgPSBjYXN0KHJlc291cmNlc1tpKytdLCB2b2lkIDApO1xuICAgICAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UgJiZcbiAgICAgICAgICAgICAgICBtYXliZVByb21pc2UuX2lzRGlzcG9zYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbWF5YmVQcm9taXNlID0gY2FzdChtYXliZVByb21pc2UuX2dldERpc3Bvc2VyKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudHJ5RGlzcG9zZShpbnNwZWN0aW9uKSwgdm9pZCAwKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aHJvd2VyKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF5YmVQcm9taXNlLl90aGVuKGl0ZXJhdG9yLCB0aHJvd2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGl0ZXJhdG9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaXRlcmF0b3IoKTtcbiAgICAgICAgcmV0dXJuIHJldC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3Bvc2VyU3VjY2Vzcyh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zcGVjdGlvbiA9IG5ldyBQcm9taXNlSW5zcGVjdGlvbigpO1xuICAgICAgICBpbnNwZWN0aW9uLl9zZXR0bGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaW5zcGVjdGlvbi5fYml0RmllbGQgPSAyNjg0MzU0NTY7XG4gICAgICAgIHJldHVybiBkaXNwb3NlKHRoaXMsIGluc3BlY3Rpb24pLnRoZW5SZXR1cm4odmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc3Bvc2VyRmFpbChyZWFzb24pIHtcbiAgICAgICAgdmFyIGluc3BlY3Rpb24gPSBuZXcgUHJvbWlzZUluc3BlY3Rpb24oKTtcbiAgICAgICAgaW5zcGVjdGlvbi5fc2V0dGxlZFZhbHVlID0gcmVhc29uO1xuICAgICAgICBpbnNwZWN0aW9uLl9iaXRGaWVsZCA9IDEzNDIxNzcyODtcbiAgICAgICAgcmV0dXJuIGRpc3Bvc2UodGhpcywgaW5zcGVjdGlvbikudGhlblRocm93KHJlYXNvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gRGlzcG9zZXIoZGF0YSwgcHJvbWlzZSkge1xuICAgICAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy5fcHJvbWlzZSA9IHByb21pc2U7XG4gICAgfVxuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLmRhdGEgPSBmdW5jdGlvbiBEaXNwb3NlciRkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9O1xuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLnByb21pc2UgPSBmdW5jdGlvbiBEaXNwb3NlciRwcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZTtcbiAgICB9O1xuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLnJlc291cmNlID0gZnVuY3Rpb24gRGlzcG9zZXIkcmVzb3VyY2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb21pc2UoKS5pc0Z1bGZpbGxlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9taXNlKCkudmFsdWUoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgRGlzcG9zZXIucHJvdG90eXBlLnRyeURpc3Bvc2UgPSBmdW5jdGlvbihpbnNwZWN0aW9uKSB7XG4gICAgICAgIHZhciByZXNvdXJjZSA9IHRoaXMucmVzb3VyY2UoKTtcbiAgICAgICAgdmFyIHJldCA9IHJlc291cmNlICE9PSBudWxsXG4gICAgICAgICAgICA/IHRoaXMuZG9EaXNwb3NlKHJlc291cmNlLCBpbnNwZWN0aW9uKSA6IG51bGw7XG4gICAgICAgIHRoaXMuX3Byb21pc2UuX3Vuc2V0RGlzcG9zYWJsZSgpO1xuICAgICAgICB0aGlzLl9kYXRhID0gdGhpcy5fcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEZ1bmN0aW9uRGlzcG9zZXIoZm4sIHByb21pc2UpIHtcbiAgICAgICAgdGhpcy5jb25zdHJ1Y3RvciQoZm4sIHByb21pc2UpO1xuICAgIH1cbiAgICBpbmhlcml0cyhGdW5jdGlvbkRpc3Bvc2VyLCBEaXNwb3Nlcik7XG5cbiAgICBGdW5jdGlvbkRpc3Bvc2VyLnByb3RvdHlwZS5kb0Rpc3Bvc2UgPSBmdW5jdGlvbiAocmVzb3VyY2UsIGluc3BlY3Rpb24pIHtcbiAgICAgICAgdmFyIGZuID0gdGhpcy5kYXRhKCk7XG4gICAgICAgIHJldHVybiBmbi5jYWxsKHJlc291cmNlLCByZXNvdXJjZSwgaW5zcGVjdGlvbik7XG4gICAgfTtcblxuICAgIFByb21pc2UudXNpbmcgPSBmdW5jdGlvbiBQcm9taXNlJHVzaW5nKCkge1xuICAgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA8IDIpIHJldHVybiBhcGlSZWplY3Rpb24oXG4gICAgICAgICAgICAgICAgICAgICAgICBcInlvdSBtdXN0IHBhc3MgYXQgbGVhc3QgMiBhcmd1bWVudHMgdG8gUHJvbWlzZS51c2luZ1wiKTtcbiAgICAgICAgdmFyIGZuID0gYXJndW1lbnRzW2xlbiAtIDFdO1xuICAgICAgICBpZiAodHlwZW9mIGZuICE9PSBcImZ1bmN0aW9uXCIpIHJldHVybiBhcGlSZWplY3Rpb24oXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgICAgIGxlbi0tO1xuICAgICAgICB2YXIgcmVzb3VyY2VzID0gbmV3IEFycmF5KGxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgICAgIHZhciByZXNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgIGlmIChyZXNvdXJjZSBpbnN0YW5jZW9mIERpc3Bvc2VyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpc3Bvc2VyID0gcmVzb3VyY2U7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UgPSByZXNvdXJjZS5wcm9taXNlKCk7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UuX3NldERpc3Bvc2FibGUoZGlzcG9zZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb3VyY2VzW2ldID0gcmVzb3VyY2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5zZXR0bGUocmVzb3VyY2VzKVxuICAgICAgICAgICAgLnRoZW4oaW5zcGVjdGlvbk1hcHBlcilcbiAgICAgICAgICAgIC5zcHJlYWQoZm4pXG4gICAgICAgICAgICAuX3RoZW4oZGlzcG9zZXJTdWNjZXNzLCBkaXNwb3NlckZhaWwsIHZvaWQgMCwgcmVzb3VyY2VzLCB2b2lkIDApO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5fc2V0RGlzcG9zYWJsZSA9XG4gICAgZnVuY3Rpb24gUHJvbWlzZSRfc2V0RGlzcG9zYWJsZShkaXNwb3Nlcikge1xuICAgICAgICB0aGlzLl9iaXRGaWVsZCA9IHRoaXMuX2JpdEZpZWxkIHwgMjYyMTQ0O1xuICAgICAgICB0aGlzLl9kaXNwb3NlciA9IGRpc3Bvc2VyO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5faXNEaXNwb3NhYmxlID0gZnVuY3Rpb24gUHJvbWlzZSRfaXNEaXNwb3NhYmxlKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX2JpdEZpZWxkICYgMjYyMTQ0KSA+IDA7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLl9nZXREaXNwb3NlciA9IGZ1bmN0aW9uIFByb21pc2UkX2dldERpc3Bvc2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlzcG9zZXI7XG4gICAgfTtcblxuICAgIFByb21pc2UucHJvdG90eXBlLl91bnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiBQcm9taXNlJF91bnNldERpc3Bvc2FibGUoKSB7XG4gICAgICAgIHRoaXMuX2JpdEZpZWxkID0gdGhpcy5fYml0RmllbGQgJiAofjI2MjE0NCk7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VyID0gdm9pZCAwO1xuICAgIH07XG5cbiAgICBQcm9taXNlLnByb3RvdHlwZS5kaXNwb3NlciA9IGZ1bmN0aW9uIFByb21pc2UkZGlzcG9zZXIoZm4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uRGlzcG9zZXIoZm4sIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcbiAgICB9O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbnZhciBfc2V0VGltZW91dCA9IGZ1bmN0aW9uKGZuLCBtcykge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIHZhciBhcmcwID0gYXJndW1lbnRzWzJdO1xuICAgIHZhciBhcmcxID0gYXJndW1lbnRzWzNdO1xuICAgIHZhciBhcmcyID0gbGVuID49IDUgPyBhcmd1bWVudHNbNF0gOiB2b2lkIDA7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZm4oYXJnMCwgYXJnMSwgYXJnMik7XG4gICAgfSwgbXMpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihQcm9taXNlLCBJTlRFUk5BTCwgY2FzdCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoXCIuL2Vycm9ycy5qc1wiKTtcbnZhciBhcGlSZWplY3Rpb24gPSByZXF1aXJlKFwiLi9lcnJvcnNfYXBpX3JlamVjdGlvblwiKShQcm9taXNlKTtcbnZhciBUaW1lb3V0RXJyb3IgPSBQcm9taXNlLlRpbWVvdXRFcnJvcjtcblxudmFyIGFmdGVyVGltZW91dCA9IGZ1bmN0aW9uIFByb21pc2UkX2FmdGVyVGltZW91dChwcm9taXNlLCBtZXNzYWdlLCBtcykge1xuICAgIGlmICghcHJvbWlzZS5pc1BlbmRpbmcoKSkgcmV0dXJuO1xuICAgIGlmICh0eXBlb2YgbWVzc2FnZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtZXNzYWdlID0gXCJvcGVyYXRpb24gdGltZWQgb3V0IGFmdGVyXCIgKyBcIiBcIiArIG1zICsgXCIgbXNcIlxuICAgIH1cbiAgICB2YXIgZXJyID0gbmV3IFRpbWVvdXRFcnJvcihtZXNzYWdlKTtcbiAgICBlcnJvcnMubWFya0FzT3JpZ2luYXRpbmdGcm9tUmVqZWN0aW9uKGVycik7XG4gICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZShlcnIpO1xuICAgIHByb21pc2UuX2NhbmNlbChlcnIpO1xufTtcblxudmFyIGFmdGVyRGVsYXkgPSBmdW5jdGlvbiBQcm9taXNlJF9hZnRlckRlbGF5KHZhbHVlLCBwcm9taXNlKSB7XG4gICAgcHJvbWlzZS5fZnVsZmlsbCh2YWx1ZSk7XG59O1xuXG52YXIgZGVsYXkgPSBQcm9taXNlLmRlbGF5ID0gZnVuY3Rpb24gUHJvbWlzZSREZWxheSh2YWx1ZSwgbXMpIHtcbiAgICBpZiAobXMgPT09IHZvaWQgMCkge1xuICAgICAgICBtcyA9IHZhbHVlO1xuICAgICAgICB2YWx1ZSA9IHZvaWQgMDtcbiAgICB9XG4gICAgbXMgPSArbXM7XG4gICAgdmFyIG1heWJlUHJvbWlzZSA9IGNhc3QodmFsdWUsIHZvaWQgMCk7XG4gICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG5cbiAgICBpZiAobWF5YmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICBwcm9taXNlLl9wcm9wYWdhdGVGcm9tKG1heWJlUHJvbWlzZSwgNyk7XG4gICAgICAgIHByb21pc2UuX2ZvbGxvdyhtYXliZVByb21pc2UpO1xuICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5kZWxheSh2YWx1ZSwgbXMpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICBfc2V0VGltZW91dChhZnRlckRlbGF5LCBtcywgdmFsdWUsIHByb21pc2UpO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn07XG5cblByb21pc2UucHJvdG90eXBlLmRlbGF5ID0gZnVuY3Rpb24gUHJvbWlzZSRkZWxheShtcykge1xuICAgIHJldHVybiBkZWxheSh0aGlzLCBtcyk7XG59O1xuXG5Qcm9taXNlLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24gUHJvbWlzZSR0aW1lb3V0KG1zLCBtZXNzYWdlKSB7XG4gICAgbXMgPSArbXM7XG5cbiAgICB2YXIgcmV0ID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgIHJldC5fcHJvcGFnYXRlRnJvbSh0aGlzLCA3KTtcbiAgICByZXQuX2ZvbGxvdyh0aGlzKTtcbiAgICBfc2V0VGltZW91dChhZnRlclRpbWVvdXQsIG1zLCByZXQsIG1lc3NhZ2UsIG1zKTtcbiAgICByZXR1cm4gcmV0LmNhbmNlbGxhYmxlKCk7XG59O1xuXG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUHJvbWlzZSkge1xudmFyIFR5cGVFcnJvciA9IHJlcXVpcmUoJy4vZXJyb3JzLmpzJykuVHlwZUVycm9yO1xuXG5mdW5jdGlvbiBhcGlSZWplY3Rpb24obXNnKSB7XG4gICAgdmFyIGVycm9yID0gbmV3IFR5cGVFcnJvcihtc2cpO1xuICAgIHZhciByZXQgPSBQcm9taXNlLnJlamVjdGVkKGVycm9yKTtcbiAgICB2YXIgcGFyZW50ID0gcmV0Ll9wZWVrQ29udGV4dCgpO1xuICAgIGlmIChwYXJlbnQgIT0gbnVsbCkge1xuICAgICAgICBwYXJlbnQuX2F0dGFjaEV4dHJhVHJhY2UoZXJyb3IpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0O1xufVxuXG5yZXR1cm4gYXBpUmVqZWN0aW9uO1xufTtcbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIElOVEVSTkFMKSB7XG52YXIgVEhJUyA9IHt9O1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIG5vZGViYWNrRm9yUHJvbWlzZSA9IHJlcXVpcmUoXCIuL3Byb21pc2VfcmVzb2x2ZXIuanNcIilcbiAgICAuX25vZGViYWNrRm9yUHJvbWlzZTtcbnZhciB3aXRoQXBwZW5kZWQgPSB1dGlsLndpdGhBcHBlbmRlZDtcbnZhciBtYXliZVdyYXBBc0Vycm9yID0gdXRpbC5tYXliZVdyYXBBc0Vycm9yO1xudmFyIGNhbkV2YWx1YXRlID0gdXRpbC5jYW5FdmFsdWF0ZTtcbnZhciBUeXBlRXJyb3IgPSByZXF1aXJlKFwiLi9lcnJvcnNcIikuVHlwZUVycm9yO1xudmFyIGRlZmF1bHRTdWZmaXggPSBcIkFzeW5jXCI7XG52YXIgZGVmYXVsdEZpbHRlciA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHtcbiAgICByZXR1cm4gdXRpbC5pc0lkZW50aWZpZXIobmFtZSkgJiZcbiAgICAgICAgbmFtZS5jaGFyQXQoMCkgIT09IFwiX1wiICYmXG4gICAgICAgICF1dGlsLmlzQ2xhc3MoZnVuYyk7XG59O1xudmFyIGRlZmF1bHRQcm9taXNpZmllZCA9IHtfX2lzUHJvbWlzaWZpZWRfXzogdHJ1ZX07XG5cblxuZnVuY3Rpb24gZXNjYXBlSWRlbnRSZWdleChzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbJF0pLywgXCJcXFxcJFwiKTtcbn1cblxuZnVuY3Rpb24gaXNQcm9taXNpZmllZChmbikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBmbi5fX2lzUHJvbWlzaWZpZWRfXyA9PT0gdHJ1ZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaGFzUHJvbWlzaWZpZWQob2JqLCBrZXksIHN1ZmZpeCkge1xuICAgIHZhciB2YWwgPSB1dGlsLmdldERhdGFQcm9wZXJ0eU9yRGVmYXVsdChvYmosIGtleSArIHN1ZmZpeCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFByb21pc2lmaWVkKTtcbiAgICByZXR1cm4gdmFsID8gaXNQcm9taXNpZmllZCh2YWwpIDogZmFsc2U7XG59XG5mdW5jdGlvbiBjaGVja1ZhbGlkKHJldCwgc3VmZml4LCBzdWZmaXhSZWdleHApIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJldC5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICB2YXIga2V5ID0gcmV0W2ldO1xuICAgICAgICBpZiAoc3VmZml4UmVnZXhwLnRlc3Qoa2V5KSkge1xuICAgICAgICAgICAgdmFyIGtleVdpdGhvdXRBc3luY1N1ZmZpeCA9IGtleS5yZXBsYWNlKHN1ZmZpeFJlZ2V4cCwgXCJcIik7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJldC5sZW5ndGg7IGogKz0gMikge1xuICAgICAgICAgICAgICAgIGlmIChyZXRbal0gPT09IGtleVdpdGhvdXRBc3luY1N1ZmZpeCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHByb21pc2lmeSBhbiBBUEkgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aGF0IGhhcyBub3JtYWwgbWV0aG9kcyB3aXRoICdcIitzdWZmaXgrXCInLXN1ZmZpeFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByb21pc2lmaWFibGVNZXRob2RzKG9iaiwgc3VmZml4LCBzdWZmaXhSZWdleHAsIGZpbHRlcikge1xuICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyhvYmopO1xuICAgIHZhciByZXQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgICAgICFpc1Byb21pc2lmaWVkKHZhbHVlKSAmJlxuICAgICAgICAgICAgIWhhc1Byb21pc2lmaWVkKG9iaiwga2V5LCBzdWZmaXgpICYmXG4gICAgICAgICAgICBmaWx0ZXIoa2V5LCB2YWx1ZSwgb2JqKSkge1xuICAgICAgICAgICAgcmV0LnB1c2goa2V5LCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2hlY2tWYWxpZChyZXQsIHN1ZmZpeCwgc3VmZml4UmVnZXhwKTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihsaWtlbHlBcmd1bWVudENvdW50KSB7XG4gICAgdmFyIHJldCA9IFtsaWtlbHlBcmd1bWVudENvdW50XTtcbiAgICB2YXIgbWluID0gTWF0aC5tYXgoMCwgbGlrZWx5QXJndW1lbnRDb3VudCAtIDEgLSA1KTtcbiAgICBmb3IodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50IC0gMTsgaSA+PSBtaW47IC0taSkge1xuICAgICAgICBpZiAoaSA9PT0gbGlrZWx5QXJndW1lbnRDb3VudCkgY29udGludWU7XG4gICAgICAgIHJldC5wdXNoKGkpO1xuICAgIH1cbiAgICBmb3IodmFyIGkgPSBsaWtlbHlBcmd1bWVudENvdW50ICsgMTsgaSA8PSA1OyArK2kpIHtcbiAgICAgICAgcmV0LnB1c2goaSk7XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGFyZ3VtZW50U2VxdWVuY2UoYXJndW1lbnRDb3VudCkge1xuICAgIHJldHVybiB1dGlsLmZpbGxlZFJhbmdlKGFyZ3VtZW50Q291bnQsIFwiYXJndW1lbnRzW1wiLCBcIl1cIik7XG59XG5cbmZ1bmN0aW9uIHBhcmFtZXRlckRlY2xhcmF0aW9uKHBhcmFtZXRlckNvdW50KSB7XG4gICAgcmV0dXJuIHV0aWwuZmlsbGVkUmFuZ2UocGFyYW1ldGVyQ291bnQsIFwiX2FyZ1wiLCBcIlwiKTtcbn1cblxuZnVuY3Rpb24gcGFyYW1ldGVyQ291bnQoZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoTWF0aC5taW4oZm4ubGVuZ3RoLCAxMDIzICsgMSksIDApO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVQcm9wZXJ0eUFjY2VzcyhrZXkpIHtcbiAgICBpZiAodXRpbC5pc0lkZW50aWZpZXIoa2V5KSkge1xuICAgICAgICByZXR1cm4gXCIuXCIgKyBrZXk7XG4gICAgfVxuICAgIGVsc2UgcmV0dXJuIFwiWydcIiArIGtleS5yZXBsYWNlKC8oWydcXFxcXSkvZywgXCJcXFxcJDFcIikgKyBcIiddXCI7XG59XG5cbmZ1bmN0aW9uIG1ha2VOb2RlUHJvbWlzaWZpZWRFdmFsKGNhbGxiYWNrLCByZWNlaXZlciwgb3JpZ2luYWxOYW1lLCBmbiwgc3VmZml4KSB7XG4gICAgdmFyIG5ld1BhcmFtZXRlckNvdW50ID0gTWF0aC5tYXgoMCwgcGFyYW1ldGVyQ291bnQoZm4pIC0gMSk7XG4gICAgdmFyIGFyZ3VtZW50T3JkZXIgPSBzd2l0Y2hDYXNlQXJndW1lbnRPcmRlcihuZXdQYXJhbWV0ZXJDb3VudCk7XG4gICAgdmFyIGNhbGxiYWNrTmFtZSA9XG4gICAgICAgICh0eXBlb2Ygb3JpZ2luYWxOYW1lID09PSBcInN0cmluZ1wiICYmIHV0aWwuaXNJZGVudGlmaWVyKG9yaWdpbmFsTmFtZSlcbiAgICAgICAgICAgID8gb3JpZ2luYWxOYW1lICsgc3VmZml4XG4gICAgICAgICAgICA6IFwicHJvbWlzaWZpZWRcIik7XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZUNhbGxGb3JBcmd1bWVudENvdW50KGNvdW50KSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRTZXF1ZW5jZShjb3VudCkuam9pbihcIiwgXCIpO1xuICAgICAgICB2YXIgY29tbWEgPSBjb3VudCA+IDAgPyBcIiwgXCIgOiBcIlwiO1xuICAgICAgICB2YXIgcmV0O1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICByZXQgPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIHRoaXMubWV0aG9kKGFyZ3MsIGZuKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCIucmVwbGFjZShcIi5tZXRob2RcIiwgZ2VuZXJhdGVQcm9wZXJ0eUFjY2VzcyhjYWxsYmFjaykpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlY2VpdmVyID09PSBUSElTKSB7XG4gICAgICAgICAgICByZXQgPSAgXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgYXJncywgZm4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCI7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgcmV0ID0gIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHJlY2VpdmVyLCBhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gIFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhhcmdzLCBmbik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgICAgICBicmVhazsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXFxuXFxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXQucmVwbGFjZShcImFyZ3NcIiwgYXJncykucmVwbGFjZShcIiwgXCIsIGNvbW1hKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5lcmF0ZUFyZ3VtZW50U3dpdGNoQ2FzZSgpIHtcbiAgICAgICAgdmFyIHJldCA9IFwiXCI7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBhcmd1bWVudE9yZGVyLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICByZXQgKz0gXCJjYXNlIFwiICsgYXJndW1lbnRPcmRlcltpXSArXCI6XCIgK1xuICAgICAgICAgICAgICAgIGdlbmVyYXRlQ2FsbEZvckFyZ3VtZW50Q291bnQoYXJndW1lbnRPcmRlcltpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvZGVGb3JDYWxsO1xuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb2RlRm9yQ2FsbCA9IFwiICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuYXBwbHkodGhpcywgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIi5wcm9wZXJ0eVwiLCBnZW5lcmF0ZVByb3BlcnR5QWNjZXNzKGNhbGxiYWNrKSk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVjZWl2ZXIgPT09IFRISVMpIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvZGVGb3JDYWxsID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkocmVjZWl2ZXIsIGFyZ3MpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldCArPSBcIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBkZWZhdWx0OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkobGVuICsgMSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgdmFyIGkgPSAwOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgYXJnc1tpXSA9IGZuOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgW0NvZGVGb3JDYWxsXSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICAgICAgYnJlYWs7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXG5cXFxuICAgICAgICBcIi5yZXBsYWNlKFwiW0NvZGVGb3JDYWxsXVwiLCBjb2RlRm9yQ2FsbCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbihcIlByb21pc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjZWl2ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2l0aEFwcGVuZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heWJlV3JhcEFzRXJyb3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZWJhY2tGb3JQcm9taXNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIklOVEVSTkFMXCIsXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHZhciByZXQgPSBmdW5jdGlvbiBGdW5jdGlvbk5hbWUoUGFyYW1ldGVycykgeyAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB2YXIgZm4gPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB0cnkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgc3dpdGNoKGxlbikgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgICAgIFtDb2RlRm9yU3dpdGNoQ2FzZV0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSBtYXliZVdyYXBBc0Vycm9yKGUpOyAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTsgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5fcmVqZWN0KHdyYXBwZWQpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIH07ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldC5fX2lzUHJvbWlzaWZpZWRfXyA9IHRydWU7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIHJldHVybiByZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxcblxcXG4gICAgICAgIFwiXG4gICAgICAgIC5yZXBsYWNlKFwiRnVuY3Rpb25OYW1lXCIsIGNhbGxiYWNrTmFtZSlcbiAgICAgICAgLnJlcGxhY2UoXCJQYXJhbWV0ZXJzXCIsIHBhcmFtZXRlckRlY2xhcmF0aW9uKG5ld1BhcmFtZXRlckNvdW50KSlcbiAgICAgICAgLnJlcGxhY2UoXCJbQ29kZUZvclN3aXRjaENhc2VdXCIsIGdlbmVyYXRlQXJndW1lbnRTd2l0Y2hDYXNlKCkpKShcbiAgICAgICAgICAgIFByb21pc2UsXG4gICAgICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgICAgIHJlY2VpdmVyLFxuICAgICAgICAgICAgd2l0aEFwcGVuZGVkLFxuICAgICAgICAgICAgbWF5YmVXcmFwQXNFcnJvcixcbiAgICAgICAgICAgIG5vZGViYWNrRm9yUHJvbWlzZSxcbiAgICAgICAgICAgIElOVEVSTkFMXG4gICAgICAgICk7XG59XG5cbmZ1bmN0aW9uIG1ha2VOb2RlUHJvbWlzaWZpZWRDbG9zdXJlKGNhbGxiYWNrLCByZWNlaXZlcikge1xuICAgIGZ1bmN0aW9uIHByb21pc2lmaWVkKCkge1xuICAgICAgICB2YXIgX3JlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgICAgIGlmIChyZWNlaXZlciA9PT0gVEhJUykgX3JlY2VpdmVyID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSBfcmVjZWl2ZXJbY2FsbGJhY2tdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICAgICAgICBwcm9taXNlLl9zZXRUcmFjZSh2b2lkIDApO1xuICAgICAgICB2YXIgZm4gPSBub2RlYmFja0ZvclByb21pc2UocHJvbWlzZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShfcmVjZWl2ZXIsIHdpdGhBcHBlbmRlZChhcmd1bWVudHMsIGZuKSk7XG4gICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQgPSBtYXliZVdyYXBBc0Vycm9yKGUpO1xuICAgICAgICAgICAgcHJvbWlzZS5fYXR0YWNoRXh0cmFUcmFjZSh3cmFwcGVkKTtcbiAgICAgICAgICAgIHByb21pc2UuX3JlamVjdCh3cmFwcGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9XG4gICAgcHJvbWlzaWZpZWQuX19pc1Byb21pc2lmaWVkX18gPSB0cnVlO1xuICAgIHJldHVybiBwcm9taXNpZmllZDtcbn1cblxudmFyIG1ha2VOb2RlUHJvbWlzaWZpZWQgPSBjYW5FdmFsdWF0ZVxuICAgID8gbWFrZU5vZGVQcm9taXNpZmllZEV2YWxcbiAgICA6IG1ha2VOb2RlUHJvbWlzaWZpZWRDbG9zdXJlO1xuXG5mdW5jdGlvbiBwcm9taXNpZnlBbGwob2JqLCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpIHtcbiAgICB2YXIgc3VmZml4UmVnZXhwID0gbmV3IFJlZ0V4cChlc2NhcGVJZGVudFJlZ2V4KHN1ZmZpeCkgKyBcIiRcIik7XG4gICAgdmFyIG1ldGhvZHMgPVxuICAgICAgICBwcm9taXNpZmlhYmxlTWV0aG9kcyhvYmosIHN1ZmZpeCwgc3VmZml4UmVnZXhwLCBmaWx0ZXIpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG1ldGhvZHMubGVuZ3RoOyBpIDwgbGVuOyBpKz0gMikge1xuICAgICAgICB2YXIga2V5ID0gbWV0aG9kc1tpXTtcbiAgICAgICAgdmFyIGZuID0gbWV0aG9kc1tpKzFdO1xuICAgICAgICB2YXIgcHJvbWlzaWZpZWRLZXkgPSBrZXkgKyBzdWZmaXg7XG4gICAgICAgIG9ialtwcm9taXNpZmllZEtleV0gPSBwcm9taXNpZmllciA9PT0gbWFrZU5vZGVQcm9taXNpZmllZFxuICAgICAgICAgICAgICAgID8gbWFrZU5vZGVQcm9taXNpZmllZChrZXksIFRISVMsIGtleSwgZm4sIHN1ZmZpeClcbiAgICAgICAgICAgICAgICA6IHByb21pc2lmaWVyKGZuKTtcbiAgICB9XG4gICAgdXRpbC50b0Zhc3RQcm9wZXJ0aWVzKG9iaik7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gcHJvbWlzaWZ5KGNhbGxiYWNrLCByZWNlaXZlcikge1xuICAgIHJldHVybiBtYWtlTm9kZVByb21pc2lmaWVkKGNhbGxiYWNrLCByZWNlaXZlciwgdm9pZCAwLCBjYWxsYmFjayk7XG59XG5cblByb21pc2UucHJvbWlzaWZ5ID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9taXNpZnkoZm4sIHJlY2VpdmVyKSB7XG4gICAgaWYgKHR5cGVvZiBmbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJmbiBtdXN0IGJlIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGlmIChpc1Byb21pc2lmaWVkKGZuKSkge1xuICAgICAgICByZXR1cm4gZm47XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNpZnkoZm4sIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gVEhJUyA6IHJlY2VpdmVyKTtcbn07XG5cblByb21pc2UucHJvbWlzaWZ5QWxsID0gZnVuY3Rpb24gUHJvbWlzZSRQcm9taXNpZnlBbGwodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJ0aGUgdGFyZ2V0IG9mIHByb21pc2lmeUFsbCBtdXN0IGJlIGFuIG9iamVjdCBvciBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgICBvcHRpb25zID0gT2JqZWN0KG9wdGlvbnMpO1xuICAgIHZhciBzdWZmaXggPSBvcHRpb25zLnN1ZmZpeDtcbiAgICBpZiAodHlwZW9mIHN1ZmZpeCAhPT0gXCJzdHJpbmdcIikgc3VmZml4ID0gZGVmYXVsdFN1ZmZpeDtcbiAgICB2YXIgZmlsdGVyID0gb3B0aW9ucy5maWx0ZXI7XG4gICAgaWYgKHR5cGVvZiBmaWx0ZXIgIT09IFwiZnVuY3Rpb25cIikgZmlsdGVyID0gZGVmYXVsdEZpbHRlcjtcbiAgICB2YXIgcHJvbWlzaWZpZXIgPSBvcHRpb25zLnByb21pc2lmaWVyO1xuICAgIGlmICh0eXBlb2YgcHJvbWlzaWZpZXIgIT09IFwiZnVuY3Rpb25cIikgcHJvbWlzaWZpZXIgPSBtYWtlTm9kZVByb21pc2lmaWVkO1xuXG4gICAgaWYgKCF1dGlsLmlzSWRlbnRpZmllcihzdWZmaXgpKSB7XG4gICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKFwic3VmZml4IG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyXCIpO1xuICAgIH1cblxuICAgIHZhciBrZXlzID0gdXRpbC5pbmhlcml0ZWREYXRhS2V5cyh0YXJnZXQsIHtpbmNsdWRlSGlkZGVuOiB0cnVlfSk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRhcmdldFtrZXlzW2ldXTtcbiAgICAgICAgaWYgKGtleXNbaV0gIT09IFwiY29uc3RydWN0b3JcIiAmJlxuICAgICAgICAgICAgdXRpbC5pc0NsYXNzKHZhbHVlKSkge1xuICAgICAgICAgICAgcHJvbWlzaWZ5QWxsKHZhbHVlLnByb3RvdHlwZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgICAgIHByb21pc2lmeUFsbCh2YWx1ZSwgc3VmZml4LCBmaWx0ZXIsIHByb21pc2lmaWVyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNpZnlBbGwodGFyZ2V0LCBzdWZmaXgsIGZpbHRlciwgcHJvbWlzaWZpZXIpO1xufTtcbn07XG5cbiIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFBldGthIEFudG9ub3ZcbiAqIFxuICogUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4gKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOjwvcD5cbiAqIFxuICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbiAqIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuICogXG4gKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4gKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuICBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKiBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKFByb21pc2UsIFByb21pc2VBcnJheSwgY2FzdCkge1xudmFyIHV0aWwgPSByZXF1aXJlKFwiLi91dGlsLmpzXCIpO1xudmFyIGFwaVJlamVjdGlvbiA9IHJlcXVpcmUoXCIuL2Vycm9yc19hcGlfcmVqZWN0aW9uXCIpKFByb21pc2UpO1xudmFyIGlzT2JqZWN0ID0gdXRpbC5pc09iamVjdDtcbnZhciBlczUgPSByZXF1aXJlKFwiLi9lczUuanNcIik7XG5cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkob2JqKSB7XG4gICAgdmFyIGtleXMgPSBlczUua2V5cyhvYmopO1xuICAgIHZhciBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgdmFsdWVzID0gbmV3IEFycmF5KGxlbiAqIDIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhbHVlc1tpXSA9IG9ialtrZXldO1xuICAgICAgICB2YWx1ZXNbaSArIGxlbl0gPSBrZXk7XG4gICAgfVxuICAgIHRoaXMuY29uc3RydWN0b3IkKHZhbHVlcyk7XG59XG51dGlsLmluaGVyaXRzKFByb3BlcnRpZXNQcm9taXNlQXJyYXksIFByb21pc2VBcnJheSk7XG5cblByb3BlcnRpZXNQcm9taXNlQXJyYXkucHJvdG90eXBlLl9pbml0ID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX2luaXQoKSB7XG4gICAgdGhpcy5faW5pdCQodm9pZCAwLCAtMykgO1xufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VGdWxmaWxsZWQgPVxuZnVuY3Rpb24gUHJvcGVydGllc1Byb21pc2VBcnJheSRfcHJvbWlzZUZ1bGZpbGxlZCh2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAodGhpcy5faXNSZXNvbHZlZCgpKSByZXR1cm47XG4gICAgdGhpcy5fdmFsdWVzW2luZGV4XSA9IHZhbHVlO1xuICAgIHZhciB0b3RhbFJlc29sdmVkID0gKyt0aGlzLl90b3RhbFJlc29sdmVkO1xuICAgIGlmICh0b3RhbFJlc29sdmVkID49IHRoaXMuX2xlbmd0aCkge1xuICAgICAgICB2YXIgdmFsID0ge307XG4gICAgICAgIHZhciBrZXlPZmZzZXQgPSB0aGlzLmxlbmd0aCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5sZW5ndGgoKTsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICB2YWxbdGhpcy5fdmFsdWVzW2kgKyBrZXlPZmZzZXRdXSA9IHRoaXMuX3ZhbHVlc1tpXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXNvbHZlKHZhbCk7XG4gICAgfVxufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuX3Byb21pc2VQcm9ncmVzc2VkID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX3Byb21pc2VQcm9ncmVzc2VkKHZhbHVlLCBpbmRleCkge1xuICAgIGlmICh0aGlzLl9pc1Jlc29sdmVkKCkpIHJldHVybjtcblxuICAgIHRoaXMuX3Byb21pc2UuX3Byb2dyZXNzKHtcbiAgICAgICAga2V5OiB0aGlzLl92YWx1ZXNbaW5kZXggKyB0aGlzLmxlbmd0aCgpXSxcbiAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgfSk7XG59O1xuXG5Qcm9wZXJ0aWVzUHJvbWlzZUFycmF5LnByb3RvdHlwZS5zaG91bGRDb3B5VmFsdWVzID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkX3Nob3VsZENvcHlWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuUHJvcGVydGllc1Byb21pc2VBcnJheS5wcm90b3R5cGUuZ2V0QWN0dWFsTGVuZ3RoID1cbmZ1bmN0aW9uIFByb3BlcnRpZXNQcm9taXNlQXJyYXkkZ2V0QWN0dWFsTGVuZ3RoKGxlbikge1xuICAgIHJldHVybiBsZW4gPj4gMTtcbn07XG5cbmZ1bmN0aW9uIFByb21pc2UkX1Byb3BzKHByb21pc2VzKSB7XG4gICAgdmFyIHJldDtcbiAgICB2YXIgY2FzdFZhbHVlID0gY2FzdChwcm9taXNlcywgdm9pZCAwKTtcblxuICAgIGlmICghaXNPYmplY3QoY2FzdFZhbHVlKSkge1xuICAgICAgICByZXR1cm4gYXBpUmVqZWN0aW9uKFwiY2Fubm90IGF3YWl0IHByb3BlcnRpZXMgb2YgYSBub24tb2JqZWN0XCIpO1xuICAgIH0gZWxzZSBpZiAoY2FzdFZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICByZXQgPSBjYXN0VmFsdWUuX3RoZW4oUHJvbWlzZS5wcm9wcywgdm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgdm9pZCAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXQgPSBuZXcgUHJvcGVydGllc1Byb21pc2VBcnJheShjYXN0VmFsdWUpLnByb21pc2UoKTtcbiAgICB9XG5cbiAgICBpZiAoY2FzdFZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICByZXQuX3Byb3BhZ2F0ZUZyb20oY2FzdFZhbHVlLCA0KTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUucHJvcHMgPSBmdW5jdGlvbiBQcm9taXNlJHByb3BzKCkge1xuICAgIHJldHVybiBQcm9taXNlJF9Qcm9wcyh0aGlzKTtcbn07XG5cblByb21pc2UucHJvcHMgPSBmdW5jdGlvbiBQcm9taXNlJFByb3BzKHByb21pc2VzKSB7XG4gICAgcmV0dXJuIFByb21pc2UkX1Byb3BzKHByb21pc2VzKTtcbn07XG59O1xuIiwiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgUGV0a2EgQW50b25vdlxuICogXG4gKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG4gKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG4gKiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG4gKiBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbiAqIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6PC9wPlxuICogXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKiBcbiAqIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcbiAqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuICogQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbiAqIFRIRSBTT0ZUV0FSRS5cbiAqIFxuICovXG5cInVzZSBzdHJpY3RcIjtcbmZ1bmN0aW9uIGFycmF5Q29weShzcmMsIHNyY0luZGV4LCBkc3QsIGRzdEluZGV4LCBsZW4pIHtcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxlbjsgKytqKSB7XG4gICAgICAgIGRzdFtqICsgZHN0SW5kZXhdID0gc3JjW2ogKyBzcmNJbmRleF07XG4gICAgfVxufVxuXG5mdW5jdGlvbiBRdWV1ZShjYXBhY2l0eSkge1xuICAgIHRoaXMuX2NhcGFjaXR5ID0gY2FwYWNpdHk7XG4gICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICB0aGlzLl9mcm9udCA9IDA7XG4gICAgdGhpcy5fbWFrZUNhcGFjaXR5KCk7XG59XG5cblF1ZXVlLnByb3RvdHlwZS5fd2lsbEJlT3ZlckNhcGFjaXR5ID1cbmZ1bmN0aW9uIFF1ZXVlJF93aWxsQmVPdmVyQ2FwYWNpdHkoc2l6ZSkge1xuICAgIHJldHVybiB0aGlzLl9jYXBhY2l0eSA8IHNpemU7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX3B1c2hPbmUgPSBmdW5jdGlvbiBRdWV1ZSRfcHVzaE9uZShhcmcpIHtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcbiAgICB0aGlzLl9jaGVja0NhcGFjaXR5KGxlbmd0aCArIDEpO1xuICAgIHZhciBpID0gKHRoaXMuX2Zyb250ICsgbGVuZ3RoKSAmICh0aGlzLl9jYXBhY2l0eSAtIDEpO1xuICAgIHRoaXNbaV0gPSBhcmc7XG4gICAgdGhpcy5fbGVuZ3RoID0gbGVuZ3RoICsgMTtcbn07XG5cblF1ZXVlLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gUXVldWUkcHVzaChmbiwgcmVjZWl2ZXIsIGFyZykge1xuICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpICsgMztcbiAgICBpZiAodGhpcy5fd2lsbEJlT3ZlckNhcGFjaXR5KGxlbmd0aCkpIHtcbiAgICAgICAgdGhpcy5fcHVzaE9uZShmbik7XG4gICAgICAgIHRoaXMuX3B1c2hPbmUocmVjZWl2ZXIpO1xuICAgICAgICB0aGlzLl9wdXNoT25lKGFyZyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGogPSB0aGlzLl9mcm9udCArIGxlbmd0aCAtIDM7XG4gICAgdGhpcy5fY2hlY2tDYXBhY2l0eShsZW5ndGgpO1xuICAgIHZhciB3cmFwTWFzayA9IHRoaXMuX2NhcGFjaXR5IC0gMTtcbiAgICB0aGlzWyhqICsgMCkgJiB3cmFwTWFza10gPSBmbjtcbiAgICB0aGlzWyhqICsgMSkgJiB3cmFwTWFza10gPSByZWNlaXZlcjtcbiAgICB0aGlzWyhqICsgMikgJiB3cmFwTWFza10gPSBhcmc7XG4gICAgdGhpcy5fbGVuZ3RoID0gbGVuZ3RoO1xufTtcblxuUXVldWUucHJvdG90eXBlLnNoaWZ0ID0gZnVuY3Rpb24gUXVldWUkc2hpZnQoKSB7XG4gICAgdmFyIGZyb250ID0gdGhpcy5fZnJvbnQsXG4gICAgICAgIHJldCA9IHRoaXNbZnJvbnRdO1xuXG4gICAgdGhpc1tmcm9udF0gPSB2b2lkIDA7XG4gICAgdGhpcy5fZnJvbnQgPSAoZnJvbnQgKyAxKSAmICh0aGlzLl9jYXBhY2l0eSAtIDEpO1xuICAgIHRoaXMuX2xlbmd0aC0tO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gUXVldWUkbGVuZ3RoKCkge1xuICAgIHJldHVybiB0aGlzLl9sZW5ndGg7XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX21ha2VDYXBhY2l0eSA9IGZ1bmN0aW9uIFF1ZXVlJF9tYWtlQ2FwYWNpdHkoKSB7XG4gICAgdmFyIGxlbiA9IHRoaXMuX2NhcGFjaXR5O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgICAgdGhpc1tpXSA9IHZvaWQgMDtcbiAgICB9XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX2NoZWNrQ2FwYWNpdHkgPSBmdW5jdGlvbiBRdWV1ZSRfY2hlY2tDYXBhY2l0eShzaXplKSB7XG4gICAgaWYgKHRoaXMuX2NhcGFjaXR5IDwgc2l6ZSkge1xuICAgICAgICB0aGlzLl9yZXNpemVUbyh0aGlzLl9jYXBhY2l0eSA8PCAzKTtcbiAgICB9XG59O1xuXG5RdWV1ZS5wcm90b3R5cGUuX3Jlc2l6ZVRvID0gZnVuY3Rpb24gUXVldWUkX3Jlc2l6ZVRvKGNhcGFjaXR5KSB7XG4gICAgdmFyIG9sZEZyb250ID0gdGhpcy5fZnJvbnQ7XG4gICAgdmFyIG9sZENhcGFjaXR5ID0gdGhpcy5fY2FwYWNpdHk7XG4gICAgdmFyIG9sZFF1ZXVlID0gbmV3IEFycmF5KG9sZENhcGFjaXR5KTtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGgoKTtcblxuICAgIGFycmF5Q29weSh0aGlzLCAwLCBvbGRRdWV1ZSwgMCwgb2xkQ2FwYWNpdHkpO1xuICAgIHRoaXMuX2NhcGFjaXR5ID0gY2FwYWNpdHk7XG4gICAgdGhpcy5fbWFrZUNhcGFjaXR5KCk7XG4gICAgdGhpcy5fZnJvbnQgPSAwO1xuICAgIGlmIChvbGRGcm9udCArIGxlbmd0aCA8PSBvbGRDYXBhY2l0eSkge1xuICAgICAgICBhcnJheUNvcHkob2xkUXVldWUsIG9sZEZyb250LCB0aGlzLCAwLCBsZW5ndGgpO1xuICAgIH0gZWxzZSB7ICAgICAgICB2YXIgbGVuZ3RoQmVmb3JlV3JhcHBpbmcgPVxuICAgICAgICAgICAgbGVuZ3RoIC0gKChvbGRGcm9udCArIGxlbmd0aCkgJiAob2xkQ2FwYWNpdHkgLSAxKSk7XG5cbiAgICAgICAgYXJyYXlDb3B5KG9sZFF1ZXVlLCBvbGRGcm9udCwgdGhpcywgMCwgbGVuZ3RoQmVmb3JlV3JhcHBpbmcpO1xuICAgICAgICBhcnJheUNvcHkob2xkUXVldWUsIDAsIHRoaXMsIGxlbmd0aEJlZm9yZVdyYXBwaW5nLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGggLSBsZW5ndGhCZWZvcmVXcmFwcGluZyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBRdWV1ZTtcbiIsIihmdW5jdGlvbihwcm9jZXNzKXsvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIHNjaGVkdWxlO1xudmFyIF9NdXRhdGlvbk9ic2VydmVyO1xuaWYgKHR5cGVvZiBwcm9jZXNzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBwcm9jZXNzLnZlcnNpb24gPT09IFwic3RyaW5nXCIpIHtcbiAgICBzY2hlZHVsZSA9IGZ1bmN0aW9uIFByb21pc2UkX1NjaGVkdWxlcihmbikge1xuICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZuKTtcbiAgICB9O1xufVxuZWxzZSBpZiAoKHR5cGVvZiBNdXRhdGlvbk9ic2VydmVyICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgICAoX011dGF0aW9uT2JzZXJ2ZXIgPSBNdXRhdGlvbk9ic2VydmVyKSkgfHxcbiAgICAgICAgICh0eXBlb2YgV2ViS2l0TXV0YXRpb25PYnNlcnZlciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICAgKF9NdXRhdGlvbk9ic2VydmVyID0gV2ViS2l0TXV0YXRpb25PYnNlcnZlcikpKSB7XG4gICAgc2NoZWR1bGUgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YXIgcXVldWVkRm4gPSB2b2lkIDA7XG4gICAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBfTXV0YXRpb25PYnNlcnZlcihcbiAgICAgICAgICAgIGZ1bmN0aW9uIFByb21pc2UkX1NjaGVkdWxlcigpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm4gPSBxdWV1ZWRGbjtcbiAgICAgICAgICAgICAgICBxdWV1ZWRGbiA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICk7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUoZGl2LCB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gUHJvbWlzZSRfU2NoZWR1bGVyKGZuKSB7XG4gICAgICAgICAgICBxdWV1ZWRGbiA9IGZuO1xuICAgICAgICAgICAgZGl2LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiZm9vXCIpO1xuICAgICAgICB9O1xuXG4gICAgfSkoKTtcbn1cbmVsc2UgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgc2NoZWR1bGUgPSBmdW5jdGlvbiBQcm9taXNlJF9TY2hlZHVsZXIoZm4pIHtcbiAgICAgICAgc2V0VGltZW91dChmbiwgMCk7XG4gICAgfTtcbn1cbmVsc2UgdGhyb3cgbmV3IEVycm9yKFwibm8gYXN5bmMgc2NoZWR1bGVyIGF2YWlsYWJsZVwiKTtcbm1vZHVsZS5leHBvcnRzID0gc2NoZWR1bGU7XG5cbn0pKHJlcXVpcmUoXCJfX2Jyb3dzZXJpZnlfcHJvY2Vzc1wiKSkiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNCBQZXRrYSBBbnRvbm92XG4gKiBcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczo8L3A+XG4gKiBcbiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4gKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAqIFxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiAgSU4gTk8gRVZFTlQgU0hBTEwgVEhFXG4gKiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxuICogVEhFIFNPRlRXQVJFLlxuICogXG4gKi9cbnZhciBpc0VTNSA9IChmdW5jdGlvbigpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHJldHVybiB0aGlzID09PSB2b2lkIDA7XG59KSgpO1xuXG5pZiAoaXNFUzUpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICAgICAgZnJlZXplOiBPYmplY3QuZnJlZXplLFxuICAgICAgICBkZWZpbmVQcm9wZXJ0eTogT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgICAgICBrZXlzOiBPYmplY3Qua2V5cyxcbiAgICAgICAgZ2V0UHJvdG90eXBlT2Y6IE9iamVjdC5nZXRQcm90b3R5cGVPZixcbiAgICAgICAgaXNBcnJheTogQXJyYXkuaXNBcnJheSxcbiAgICAgICAgaXNFUzU6IGlzRVM1XG4gICAgfTtcbn0gZWxzZSB7XG4gICAgdmFyIGhhcyA9IHt9Lmhhc093blByb3BlcnR5O1xuICAgIHZhciBzdHIgPSB7fS50b1N0cmluZztcbiAgICB2YXIgcHJvdG8gPSB7fS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG5cbiAgICB2YXIgT2JqZWN0S2V5cyA9IGZ1bmN0aW9uIE9iamVjdEtleXMobykge1xuICAgICAgICB2YXIgcmV0ID0gW107XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvKSB7XG4gICAgICAgICAgICBpZiAoaGFzLmNhbGwobywga2V5KSkge1xuICAgICAgICAgICAgICAgIHJldC5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICB2YXIgT2JqZWN0RGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBPYmplY3REZWZpbmVQcm9wZXJ0eShvLCBrZXksIGRlc2MpIHtcbiAgICAgICAgb1trZXldID0gZGVzYy52YWx1ZTtcbiAgICAgICAgcmV0dXJuIG87XG4gICAgfVxuXG4gICAgdmFyIE9iamVjdEZyZWV6ZSA9IGZ1bmN0aW9uIE9iamVjdEZyZWV6ZShvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICB2YXIgT2JqZWN0R2V0UHJvdG90eXBlT2YgPSBmdW5jdGlvbiBPYmplY3RHZXRQcm90b3R5cGVPZihvYmopIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qob2JqKS5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm90bztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBBcnJheUlzQXJyYXkgPSBmdW5jdGlvbiBBcnJheUlzQXJyYXkob2JqKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyLmNhbGwob2JqKSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgICBpc0FycmF5OiBBcnJheUlzQXJyYXksXG4gICAgICAgIGtleXM6IE9iamVjdEtleXMsXG4gICAgICAgIGRlZmluZVByb3BlcnR5OiBPYmplY3REZWZpbmVQcm9wZXJ0eSxcbiAgICAgICAgZnJlZXplOiBPYmplY3RGcmVlemUsXG4gICAgICAgIGdldFByb3RvdHlwZU9mOiBPYmplY3RHZXRQcm90b3R5cGVPZixcbiAgICAgICAgaXNFUzU6IGlzRVM1XG4gICAgfTtcbn1cbiJdfQ==
;